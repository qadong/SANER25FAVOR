Running experiment with knn_temp=10, lmbda=0.2, k=16
2024-10-12 06:41:10.741248: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 06:41:10.760799: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 06:41:10.782655: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 06:41:10.789288: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 06:41:10.805267: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 06:41:11.806346: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 06:41:13 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.2, knn_temp=10, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 06:41:13 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:35:41,  2.20it/s]
Adding feature api:   4%|▍         | 7237/187062 [00:00<00:10, 17318.35it/s]
Adding feature api:   8%|▊         | 15482/187062 [00:00<00:05, 33911.94it/s]
Adding feature api:  13%|█▎        | 23741/187062 [00:00<00:03, 46900.35it/s]
Adding feature api:  17%|█▋        | 32006/187062 [00:00<00:02, 56766.42it/s]
Adding feature api:  22%|██▏       | 40344/187062 [00:00<00:02, 64291.76it/s]
Adding feature api:  26%|██▌       | 48689/187062 [00:01<00:01, 69803.63it/s]
Adding feature api:  30%|███       | 57017/187062 [00:01<00:01, 73727.78it/s]
Adding feature api:  35%|███▍      | 65329/187062 [00:01<00:01, 76487.11it/s]
Adding feature api:  39%|███▉      | 73650/187062 [00:01<00:01, 78473.62it/s]
Adding feature api:  44%|████▍     | 81998/187062 [00:01<00:01, 79958.15it/s]
Adding feature api:  48%|████▊     | 90314/187062 [00:01<00:01, 80911.11it/s]
Adding feature api:  53%|█████▎    | 98578/187062 [00:01<00:01, 80891.13it/s]
Adding feature api:  57%|█████▋    | 106905/187062 [00:01<00:00, 81597.91it/s]
Adding feature api:  62%|██████▏   | 115239/187062 [00:01<00:00, 82115.82it/s]
Adding feature api:  66%|██████▌   | 123571/187062 [00:01<00:00, 82472.42it/s]
Adding feature api:  71%|███████   | 131893/187062 [00:02<00:00, 82694.25it/s]
Adding feature api:  75%|███████▍  | 140226/187062 [00:02<00:00, 82881.89it/s]
Adding feature api:  79%|███████▉  | 148535/187062 [00:02<00:00, 82885.77it/s]
Adding feature api:  84%|████████▍ | 156875/187062 [00:02<00:00, 83039.00it/s]
Adding feature api:  88%|████████▊ | 165212/187062 [00:02<00:00, 83137.57it/s]
Adding feature api:  93%|█████████▎| 173533/187062 [00:02<00:00, 83048.37it/s]
Adding feature api:  97%|█████████▋| 181843/187062 [00:02<00:00, 63038.66it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 63773.00it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:41:21,  2.19it/s]
Adding feature datatype:   4%|▍         | 7032/187062 [00:00<00:10, 16776.54it/s]
Adding feature datatype:   8%|▊         | 15070/187062 [00:00<00:05, 32943.68it/s]
Adding feature datatype:  12%|█▏        | 23127/187062 [00:00<00:03, 45630.50it/s]
Adding feature datatype:  17%|█▋        | 31140/187062 [00:00<00:02, 55139.59it/s]
Adding feature datatype:  21%|██        | 39217/187062 [00:00<00:02, 62379.43it/s]
Adding feature datatype:  25%|██▌       | 47317/187062 [00:01<00:02, 67730.98it/s]
Adding feature datatype:  30%|██▉       | 55392/187062 [00:01<00:01, 71518.92it/s]
Adding feature datatype:  34%|███▍      | 63453/187062 [00:01<00:01, 74187.08it/s]
Adding feature datatype:  38%|███▊      | 71495/187062 [00:01<00:01, 76026.56it/s]
Adding feature datatype:  43%|████▎     | 79530/187062 [00:01<00:01, 77308.10it/s]
Adding feature datatype:  47%|████▋     | 87578/187062 [00:01<00:01, 78250.04it/s]
Adding feature datatype:  51%|█████     | 95607/187062 [00:01<00:01, 78856.88it/s]
Adding feature datatype:  55%|█████▌    | 103698/187062 [00:01<00:01, 79468.97it/s]
Adding feature datatype:  60%|█████▉    | 111728/187062 [00:01<00:00, 79698.84it/s]
Adding feature datatype:  64%|██████▍   | 119779/187062 [00:01<00:00, 79940.31it/s]
Adding feature datatype:  68%|██████▊   | 127871/187062 [00:02<00:00, 80230.40it/s]
Adding feature datatype:  73%|███████▎  | 135923/187062 [00:02<00:00, 80164.68it/s]
Adding feature datatype:  77%|███████▋  | 143966/187062 [00:02<00:00, 80242.93it/s]
Adding feature datatype:  81%|████████▏ | 152040/187062 [00:02<00:00, 80390.02it/s]
Adding feature datatype:  86%|████████▌ | 160089/187062 [00:02<00:00, 80358.11it/s]
Adding feature datatype:  90%|████████▉ | 168132/187062 [00:02<00:00, 80361.65it/s]
Adding feature datatype:  94%|█████████▍| 176173/187062 [00:02<00:00, 79906.28it/s]
Adding feature datatype:  98%|█████████▊| 184168/187062 [00:02<00:00, 54845.29it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 62343.28it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:17:30,  2.23it/s]
Adding feature literal:   4%|▍         | 7017/187062 [00:00<00:10, 16957.32it/s]
Adding feature literal:   8%|▊         | 15067/187062 [00:00<00:05, 33264.10it/s]
Adding feature literal:  12%|█▏        | 23112/187062 [00:00<00:03, 45921.24it/s]
Adding feature literal:  17%|█▋        | 31177/187062 [00:00<00:02, 55541.56it/s]
Adding feature literal:  21%|██        | 39181/187062 [00:00<00:02, 62487.81it/s]
Adding feature literal:  25%|██▌       | 47258/187062 [00:01<00:02, 67756.86it/s]
Adding feature literal:  29%|██▉       | 55174/187062 [00:01<00:01, 71080.46it/s]
Adding feature literal:  34%|███▍      | 63273/187062 [00:01<00:01, 73994.15it/s]
Adding feature literal:  38%|███▊      | 71373/187062 [00:01<00:01, 76066.28it/s]
Adding feature literal:  42%|████▏     | 79476/187062 [00:01<00:01, 77538.96it/s]
Adding feature literal:  47%|████▋     | 87527/187062 [00:01<00:01, 78423.66it/s]
Adding feature literal:  51%|█████     | 95627/187062 [00:01<00:01, 79190.12it/s]
Adding feature literal:  55%|█████▌    | 103685/187062 [00:01<00:01, 79602.92it/s]
Adding feature literal:  60%|█████▉    | 111776/187062 [00:01<00:00, 79993.16it/s]
Adding feature literal:  64%|██████▍   | 119833/187062 [00:01<00:00, 80157.24it/s]
Adding feature literal:  68%|██████▊   | 127889/187062 [00:02<00:00, 80249.56it/s]
Adding feature literal:  73%|███████▎  | 135993/187062 [00:02<00:00, 80483.98it/s]
Adding feature literal:  77%|███████▋  | 144104/187062 [00:02<00:00, 80669.52it/s]
Adding feature literal:  81%|████████▏ | 152201/187062 [00:02<00:00, 80758.37it/s]
Adding feature literal:  86%|████████▌ | 160287/187062 [00:02<00:00, 80204.94it/s]
Adding feature literal:  90%|████████▉ | 168329/187062 [00:02<00:00, 80265.83it/s]
Adding feature literal:  94%|█████████▍| 176399/187062 [00:02<00:00, 80394.12it/s]
Adding feature literal:  99%|█████████▊| 184443/187062 [00:02<00:00, 54787.33it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 62623.78it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:17:44,  2.23it/s]
Adding feature operator:   4%|▍         | 7066/187062 [00:00<00:10, 17073.42it/s]
Adding feature operator:   8%|▊         | 15158/187062 [00:00<00:05, 33456.98it/s]
Adding feature operator:  12%|█▏        | 23246/187062 [00:00<00:03, 46176.76it/s]
Adding feature operator:  17%|█▋        | 31103/187062 [00:00<00:02, 55150.02it/s]
Adding feature operator:  21%|██        | 39170/187062 [00:00<00:02, 62385.60it/s]
Adding feature operator:  25%|██▌       | 47277/187062 [00:01<00:02, 67770.48it/s]
Adding feature operator:  30%|██▉       | 55383/187062 [00:01<00:01, 71644.51it/s]
Adding feature operator:  34%|███▍      | 63514/187062 [00:01<00:01, 74485.60it/s]
Adding feature operator:  38%|███▊      | 71663/187062 [00:01<00:01, 76555.92it/s]
Adding feature operator:  43%|████▎     | 79683/187062 [00:01<00:01, 77627.17it/s]
Adding feature operator:  47%|████▋     | 87797/187062 [00:01<00:01, 78672.24it/s]
Adding feature operator:  51%|█████▏    | 95904/187062 [00:01<00:01, 79386.34it/s]
Adding feature operator:  56%|█████▌    | 103966/187062 [00:01<00:01, 79754.57it/s]
Adding feature operator:  60%|█████▉    | 112091/187062 [00:01<00:00, 80199.28it/s]
Adding feature operator:  64%|██████▍   | 120215/187062 [00:01<00:00, 80507.54it/s]
Adding feature operator:  69%|██████▊   | 128351/187062 [00:02<00:00, 80761.25it/s]
Adding feature operator:  73%|███████▎  | 136456/187062 [00:02<00:00, 80172.39it/s]
Adding feature operator:  77%|███████▋  | 144580/187062 [00:02<00:00, 80488.39it/s]
Adding feature operator:  82%|████████▏ | 152710/187062 [00:02<00:00, 80729.18it/s]
Adding feature operator:  86%|████████▌ | 160809/187062 [00:02<00:00, 80804.95it/s]
Adding feature operator:  90%|█████████ | 168897/187062 [00:02<00:00, 80715.63it/s]
Adding feature operator:  95%|█████████▍| 176974/187062 [00:02<00:00, 80644.93it/s]
Adding feature operator:  99%|█████████▉| 185043/187062 [00:02<00:00, 53957.47it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 62748.95it/s]
[2024-10-12 06:41:56,920] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 06:41:58 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 06:41:58 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 419.12 examples/s]
Map:   1%|▏         | 90/6548 [00:00<00:25, 252.57 examples/s]
Map:   2%|▏         | 129/6548 [00:00<00:21, 294.51 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:18, 340.20 examples/s]
Map:   3%|▎         | 226/6548 [00:00<00:16, 382.73 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:16, 374.22 examples/s]
Map:   5%|▌         | 334/6548 [00:00<00:17, 347.15 examples/s]
Map:   6%|▌         | 374/6548 [00:01<00:17, 356.40 examples/s]
Map:   7%|▋         | 426/6548 [00:01<00:15, 397.32 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:16, 362.30 examples/s]
Map:   8%|▊         | 512/6548 [00:01<00:16, 369.49 examples/s]
Map:   9%|▊         | 566/6548 [00:01<00:14, 411.03 examples/s]
Map:   9%|▉         | 620/6548 [00:01<00:15, 373.92 examples/s]
Map:  10%|█         | 666/6548 [00:01<00:16, 346.81 examples/s]
Map:  11%|█         | 710/6548 [00:01<00:15, 367.12 examples/s]
Map:  12%|█▏        | 758/6548 [00:02<00:14, 391.95 examples/s]
Map:  12%|█▏        | 813/6548 [00:02<00:13, 425.63 examples/s]
Map:  13%|█▎        | 876/6548 [00:02<00:13, 413.73 examples/s]
Map:  14%|█▍        | 925/6548 [00:02<00:14, 379.94 examples/s]
Map:  15%|█▍        | 970/6548 [00:02<00:14, 377.06 examples/s]
Map:  16%|█▌        | 1015/6548 [00:02<00:23, 239.41 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:20, 264.90 examples/s]
Map:  17%|█▋        | 1100/6548 [00:03<00:18, 299.69 examples/s]
Map:  18%|█▊        | 1147/6548 [00:03<00:16, 336.51 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 349.78 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:14, 359.23 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:14, 370.07 examples/s]
Map:  21%|██        | 1352/6548 [00:03<00:15, 327.57 examples/s]
Map:  21%|██▏       | 1398/6548 [00:04<00:16, 311.75 examples/s]
Map:  22%|██▏       | 1436/6548 [00:04<00:17, 295.81 examples/s]
Map:  23%|██▎       | 1480/6548 [00:04<00:16, 302.17 examples/s]
Map:  23%|██▎       | 1516/6548 [00:04<00:16, 313.73 examples/s]
Map:  24%|██▍       | 1560/6548 [00:04<00:16, 303.99 examples/s]
Map:  24%|██▍       | 1596/6548 [00:04<00:15, 310.71 examples/s]
Map:  25%|██▌       | 1644/6548 [00:04<00:16, 296.33 examples/s]
Map:  26%|██▌       | 1676/6548 [00:05<00:18, 263.13 examples/s]
Map:  26%|██▌       | 1717/6548 [00:05<00:16, 292.90 examples/s]
Map:  27%|██▋       | 1766/6548 [00:05<00:14, 335.58 examples/s]
Map:  28%|██▊       | 1807/6548 [00:05<00:13, 349.25 examples/s]
Map:  28%|██▊       | 1849/6548 [00:05<00:12, 367.50 examples/s]
Map:  29%|██▉       | 1901/6548 [00:05<00:13, 351.13 examples/s]
Map:  30%|██▉       | 1961/6548 [00:05<00:12, 362.67 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:18, 244.90 examples/s]
Map:  31%|███       | 2030/6548 [00:06<00:17, 254.72 examples/s]
Map:  32%|███▏      | 2065/6548 [00:06<00:16, 273.98 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:15, 288.19 examples/s]
Map:  33%|███▎      | 2136/6548 [00:06<00:15, 293.44 examples/s]
Map:  33%|███▎      | 2184/6548 [00:06<00:16, 269.50 examples/s]
Map:  34%|███▍      | 2230/6548 [00:06<00:15, 281.00 examples/s]
Map:  35%|███▍      | 2272/6548 [00:07<00:15, 275.98 examples/s]
Map:  35%|███▌      | 2305/6548 [00:07<00:14, 285.16 examples/s]
Map:  36%|███▌      | 2350/6548 [00:07<00:13, 315.81 examples/s]
Map:  37%|███▋      | 2402/6548 [00:07<00:12, 323.60 examples/s]
Map:  37%|███▋      | 2438/6548 [00:07<00:13, 311.46 examples/s]
Map:  38%|███▊      | 2477/6548 [00:07<00:12, 322.21 examples/s]
Map:  38%|███▊      | 2517/6548 [00:07<00:12, 315.84 examples/s]
Map:  39%|███▉      | 2558/6548 [00:07<00:11, 338.00 examples/s]
Map:  40%|███▉      | 2603/6548 [00:07<00:10, 365.38 examples/s]
Map:  40%|████      | 2647/6548 [00:08<00:10, 382.45 examples/s]
Map:  41%|████      | 2687/6548 [00:08<00:11, 324.21 examples/s]
Map:  42%|████▏     | 2740/6548 [00:08<00:11, 331.18 examples/s]
Map:  42%|████▏     | 2776/6548 [00:08<00:11, 337.06 examples/s]
Map:  43%|████▎     | 2823/6548 [00:08<00:11, 320.91 examples/s]
Map:  44%|████▎     | 2862/6548 [00:08<00:13, 281.38 examples/s]
Map:  44%|████▍     | 2900/6548 [00:08<00:12, 290.77 examples/s]
Map:  45%|████▌     | 2949/6548 [00:09<00:12, 294.01 examples/s]
Map:  46%|████▌     | 2987/6548 [00:09<00:11, 312.25 examples/s]
Map:  46%|████▌     | 3021/6548 [00:09<00:21, 160.72 examples/s]
Map:  47%|████▋     | 3058/6548 [00:09<00:18, 190.59 examples/s]
Map:  47%|████▋     | 3091/6548 [00:09<00:16, 214.09 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 255.10 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:13, 256.59 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 252.62 examples/s]
Map:  49%|████▉     | 3237/6548 [00:10<00:12, 270.54 examples/s]
Map:  50%|████▉     | 3271/6548 [00:10<00:11, 283.66 examples/s]
Map:  50%|█████     | 3306/6548 [00:10<00:10, 295.24 examples/s]
Map:  51%|█████     | 3348/6548 [00:10<00:10, 315.85 examples/s]
Map:  52%|█████▏    | 3388/6548 [00:10<00:10, 288.52 examples/s]
Map:  52%|█████▏    | 3425/6548 [00:11<00:11, 273.76 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 267.52 examples/s]
Map:  53%|█████▎    | 3486/6548 [00:11<00:11, 274.09 examples/s]
Map:  54%|█████▍    | 3533/6548 [00:11<00:09, 321.92 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:11<00:08, 350.31 examples/s]
Map:  55%|█████▌    | 3621/6548 [00:11<00:07, 374.39 examples/s]
Map:  56%|█████▌    | 3660/6548 [00:11<00:07, 373.69 examples/s]
Map:  57%|█████▋    | 3704/6548 [00:11<00:07, 391.33 examples/s]
Map:  57%|█████▋    | 3753/6548 [00:11<00:07, 363.32 examples/s]
Map:  58%|█████▊    | 3800/6548 [00:12<00:07, 390.14 examples/s]
Map:  59%|█████▊    | 3841/6548 [00:12<00:08, 332.22 examples/s]
Map:  59%|█████▉    | 3894/6548 [00:12<00:07, 337.10 examples/s]
Map:  60%|██████    | 3940/6548 [00:12<00:08, 308.10 examples/s]
Map:  61%|██████    | 3973/6548 [00:12<00:08, 307.27 examples/s]
Map:  62%|██████▏   | 4030/6548 [00:13<00:10, 237.96 examples/s]
Map:  62%|██████▏   | 4079/6548 [00:13<00:08, 282.08 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 306.54 examples/s]
Map:  64%|██████▎   | 4161/6548 [00:13<00:08, 290.88 examples/s]
Map:  64%|██████▍   | 4199/6548 [00:13<00:07, 308.22 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:07, 316.03 examples/s]
Map:  65%|██████▌   | 4282/6548 [00:13<00:06, 346.56 examples/s]
Map:  66%|██████▌   | 4325/6548 [00:13<00:06, 359.54 examples/s]
Map:  67%|██████▋   | 4370/6548 [00:13<00:06, 337.65 examples/s]
Map:  67%|██████▋   | 4406/6548 [00:14<00:06, 341.93 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:05, 370.95 examples/s]
Map:  69%|██████▊   | 4498/6548 [00:14<00:06, 323.29 examples/s]
Map:  69%|██████▉   | 4546/6548 [00:14<00:06, 315.88 examples/s]
Map:  70%|███████   | 4584/6548 [00:14<00:06, 323.35 examples/s]
Map:  71%|███████   | 4633/6548 [00:14<00:05, 357.13 examples/s]
Map:  71%|███████▏  | 4673/6548 [00:14<00:05, 366.73 examples/s]
Map:  72%|███████▏  | 4717/6548 [00:14<00:04, 383.00 examples/s]
Map:  73%|███████▎  | 4787/6548 [00:15<00:04, 411.08 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 409.43 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 382.78 examples/s]
Map:  76%|███████▌  | 4955/6548 [00:15<00:03, 407.20 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:15<00:06, 256.81 examples/s]
Map:  77%|███████▋  | 5038/6548 [00:15<00:05, 278.39 examples/s]
Map:  78%|███████▊  | 5082/6548 [00:16<00:05, 279.91 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 285.74 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 296.44 examples/s]
Map:  79%|███████▉  | 5189/6548 [00:16<00:04, 294.65 examples/s]
Map:  80%|███████▉  | 5225/6548 [00:16<00:04, 307.42 examples/s]
Map:  80%|████████  | 5261/6548 [00:16<00:04, 318.97 examples/s]
Map:  81%|████████  | 5314/6548 [00:16<00:03, 374.62 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:16<00:03, 307.70 examples/s]
Map:  83%|████████▎ | 5406/6548 [00:17<00:03, 291.25 examples/s]
Map:  83%|████████▎ | 5450/6548 [00:17<00:03, 322.51 examples/s]
Map:  84%|████████▍ | 5500/6548 [00:17<00:03, 323.71 examples/s]
Map:  85%|████████▍ | 5539/6548 [00:17<00:02, 338.37 examples/s]
Map:  85%|████████▌ | 5579/6548 [00:17<00:03, 304.55 examples/s]
Map:  86%|████████▌ | 5614/6548 [00:17<00:02, 314.08 examples/s]
Map:  86%|████████▋ | 5651/6548 [00:17<00:02, 320.95 examples/s]
Map:  87%|████████▋ | 5697/6548 [00:18<00:02, 311.19 examples/s]
Map:  88%|████████▊ | 5740/6548 [00:18<00:02, 335.27 examples/s]
Map:  88%|████████▊ | 5781/6548 [00:18<00:02, 342.03 examples/s]
Map:  89%|████████▉ | 5825/6548 [00:18<00:02, 345.60 examples/s]
Map:  90%|████████▉ | 5866/6548 [00:18<00:01, 356.14 examples/s]
Map:  90%|█████████ | 5908/6548 [00:18<00:01, 369.81 examples/s]
Map:  91%|█████████ | 5960/6548 [00:18<00:01, 359.87 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 222.74 examples/s]
Map:  92%|█████████▏| 6041/6548 [00:19<00:01, 256.12 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 285.82 examples/s]
Map:  93%|█████████▎| 6120/6548 [00:19<00:01, 271.54 examples/s]
Map:  94%|█████████▍| 6158/6548 [00:19<00:01, 294.91 examples/s]
Map:  95%|█████████▍| 6212/6548 [00:19<00:01, 314.01 examples/s]
Map:  95%|█████████▌| 6247/6548 [00:19<00:00, 320.38 examples/s]
Map:  96%|█████████▋| 6304/6548 [00:19<00:00, 333.16 examples/s]
Map:  97%|█████████▋| 6340/6548 [00:20<00:00, 338.49 examples/s]
Map:  98%|█████████▊| 6386/6548 [00:20<00:00, 360.04 examples/s]
Map:  98%|█████████▊| 6428/6548 [00:20<00:00, 371.34 examples/s]
Map:  99%|█████████▉| 6477/6548 [00:20<00:00, 399.80 examples/s]
Map: 100%|█████████▉| 6529/6548 [00:20<00:00, 377.75 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 316.26 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▎         | 33/903 [00:00<00:02, 309.01 examples/s]
Map:   7%|▋         | 67/903 [00:00<00:02, 323.16 examples/s]
Map:  13%|█▎        | 118/903 [00:00<00:02, 319.73 examples/s]
Map:  18%|█▊        | 163/903 [00:00<00:02, 357.46 examples/s]
Map:  23%|██▎       | 211/903 [00:00<00:01, 386.79 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 392.00 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 386.88 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 330.37 examples/s]
Map:  44%|████▎     | 395/903 [00:01<00:01, 298.31 examples/s]
Map:  48%|████▊     | 436/903 [00:01<00:01, 303.48 examples/s]
Map:  53%|█████▎    | 475/903 [00:01<00:01, 318.70 examples/s]
Map:  59%|█████▉    | 531/903 [00:01<00:01, 331.02 examples/s]
Map:  63%|██████▎   | 569/903 [00:01<00:00, 338.30 examples/s]
Map:  68%|██████▊   | 613/903 [00:01<00:00, 359.88 examples/s]
Map:  74%|███████▎  | 665/903 [00:01<00:00, 349.40 examples/s]
Map:  78%|███████▊  | 706/903 [00:02<00:00, 358.03 examples/s]
Map:  84%|████████▎ | 756/903 [00:02<00:00, 394.07 examples/s]
Map:  90%|████████▉ | 811/903 [00:02<00:00, 378.50 examples/s]
Map:  95%|█████████▌| 860/903 [00:02<00:00, 404.81 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 221.05 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 317.45 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 37/1882 [00:00<00:06, 280.73 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 346.62 examples/s]
Map:   7%|▋         | 127/1882 [00:00<00:05, 309.65 examples/s]
Map:   9%|▉         | 171/1882 [00:00<00:05, 335.37 examples/s]
Map:  12%|█▏        | 228/1882 [00:00<00:04, 351.23 examples/s]
Map:  14%|█▍        | 270/1882 [00:00<00:04, 368.40 examples/s]
Map:  18%|█▊        | 330/1882 [00:00<00:04, 364.93 examples/s]
Map:  20%|█▉        | 376/1882 [00:01<00:04, 306.70 examples/s]
Map:  22%|██▏       | 415/1882 [00:01<00:05, 288.93 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 296.31 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 331.00 examples/s]
Map:  28%|██▊       | 532/1882 [00:01<00:04, 286.91 examples/s]
Map:  30%|███       | 570/1882 [00:01<00:04, 303.08 examples/s]
Map:  32%|███▏      | 605/1882 [00:01<00:04, 312.74 examples/s]
Map:  35%|███▍      | 653/1882 [00:02<00:03, 346.57 examples/s]
Map:  37%|███▋      | 696/1882 [00:02<00:03, 366.39 examples/s]
Map:  39%|███▉      | 734/1882 [00:02<00:03, 367.11 examples/s]
Map:  41%|████      | 773/1882 [00:02<00:03, 352.97 examples/s]
Map:  44%|████▎     | 822/1882 [00:02<00:03, 340.29 examples/s]
Map:  46%|████▋     | 874/1882 [00:02<00:03, 335.46 examples/s]
Map:  49%|████▊     | 917/1882 [00:02<00:02, 355.07 examples/s]
Map:  51%|█████▏    | 966/1882 [00:02<00:02, 386.35 examples/s]
Map:  54%|█████▍    | 1016/1882 [00:03<00:03, 243.85 examples/s]
Map:  56%|█████▌    | 1054/1882 [00:03<00:03, 265.77 examples/s]
Map:  58%|█████▊    | 1089/1882 [00:03<00:02, 279.39 examples/s]
Map:  60%|██████    | 1130/1882 [00:03<00:02, 274.98 examples/s]
Map:  62%|██████▏   | 1164/1882 [00:03<00:02, 286.86 examples/s]
Map:  64%|██████▍   | 1203/1882 [00:03<00:02, 262.39 examples/s]
Map:  66%|██████▌   | 1242/1882 [00:03<00:02, 285.66 examples/s]
Map:  68%|██████▊   | 1278/1882 [00:04<00:01, 302.06 examples/s]
Map:  70%|███████   | 1322/1882 [00:04<00:01, 332.56 examples/s]
Map:  72%|███████▏  | 1360/1882 [00:04<00:01, 334.04 examples/s]
Map:  75%|███████▌  | 1413/1882 [00:04<00:01, 335.92 examples/s]
Map:  78%|███████▊  | 1467/1882 [00:04<00:01, 298.66 examples/s]
Map:  80%|████████  | 1507/1882 [00:04<00:01, 267.04 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 279.48 examples/s]
Map:  84%|████████▍ | 1581/1882 [00:05<00:01, 295.34 examples/s]
Map:  86%|████████▌ | 1622/1882 [00:05<00:00, 318.66 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 324.34 examples/s]
Map:  91%|█████████ | 1710/1882 [00:05<00:00, 321.11 examples/s]
Map:  93%|█████████▎| 1748/1882 [00:05<00:00, 275.76 examples/s]
Map:  95%|█████████▍| 1785/1882 [00:05<00:00, 260.00 examples/s]
Map:  97%|█████████▋| 1830/1882 [00:05<00:00, 300.76 examples/s]
Map: 100%|█████████▉| 1875/1882 [00:06<00:00, 333.94 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 301.36 examples/s]
10/12/2024 06:42:59 - INFO - __main__ -     ***** Testing *****
10/12/2024 06:42:59 - INFO - __main__ -     Batch size = 8
10/12/2024 06:42:59 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 06:43:00 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 06:43:00 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 06:43:01 - INFO - knnlm -   Reading datastore took 0.9521884918212891 s
10/12/2024 06:43:02 - INFO - knnlm -   Moving index to GPU took 0.980863094329834 s
10/12/2024 06:43:02 - INFO - __main__ -   ******************************break-into
10/12/2024 06:43:02 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 06:43:02 - INFO - __main__ -     Num examples = 236
10/12/2024 06:43:02 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<32:29,  8.30s/it]
test ppl:   1%|          | 2/236 [00:10<18:31,  4.75s/it]
test ppl:   1%|▏         | 3/236 [00:12<12:48,  3.30s/it]
test ppl:   2%|▏         | 4/236 [00:18<16:57,  4.39s/it]
test ppl:   2%|▏         | 5/236 [00:24<19:05,  4.96s/it]
test ppl:   3%|▎         | 6/236 [00:26<15:37,  4.08s/it]
test ppl:   3%|▎         | 7/236 [00:28<12:53,  3.38s/it]
test ppl:   3%|▎         | 8/236 [00:33<14:29,  3.82s/it]
test ppl:   4%|▍         | 9/236 [00:39<16:59,  4.49s/it]
test ppl:   4%|▍         | 10/236 [00:42<15:34,  4.14s/it]
test ppl:   5%|▍         | 11/236 [00:44<13:31,  3.61s/it]
test ppl:   5%|▌         | 12/236 [00:49<14:55,  4.00s/it]
test ppl:   6%|▌         | 13/236 [00:55<17:02,  4.59s/it]
test ppl:   6%|▌         | 14/236 [01:01<18:33,  5.01s/it]
test ppl:   6%|▋         | 15/236 [01:05<16:40,  4.53s/it]
test ppl:   7%|▋         | 16/236 [01:07<13:46,  3.76s/it]
test ppl:   7%|▋         | 17/236 [01:10<13:35,  3.72s/it]
test ppl:   8%|▊         | 18/236 [01:12<11:19,  3.12s/it]
test ppl:   8%|▊         | 19/236 [01:17<12:47,  3.54s/it]
test ppl:   8%|▊         | 20/236 [01:18<10:51,  3.02s/it]
test ppl:   9%|▉         | 21/236 [01:21<10:02,  2.80s/it]
test ppl:   9%|▉         | 22/236 [01:27<13:23,  3.76s/it]
test ppl:  10%|▉         | 23/236 [01:29<12:09,  3.43s/it]
test ppl:  10%|█         | 24/236 [01:32<11:36,  3.28s/it]
test ppl:  11%|█         | 25/236 [01:34<10:03,  2.86s/it]
test ppl:  11%|█         | 26/236 [01:39<12:02,  3.44s/it]
test ppl:  11%|█▏        | 27/236 [01:43<12:46,  3.67s/it]
test ppl:  12%|█▏        | 28/236 [01:44<10:23,  3.00s/it]
test ppl:  12%|█▏        | 29/236 [01:47<10:06,  2.93s/it]
test ppl:  13%|█▎        | 30/236 [01:49<08:54,  2.59s/it]
test ppl:  13%|█▎        | 31/236 [01:51<08:38,  2.53s/it]
test ppl:  14%|█▎        | 32/236 [01:55<09:57,  2.93s/it]
test ppl:  14%|█▍        | 33/236 [02:02<14:06,  4.17s/it]
test ppl:  14%|█▍        | 34/236 [02:07<14:42,  4.37s/it]
test ppl:  15%|█▍        | 35/236 [02:10<13:16,  3.96s/it]
test ppl:  15%|█▌        | 36/236 [02:17<16:18,  4.89s/it]
test ppl:  16%|█▌        | 37/236 [02:24<18:27,  5.57s/it]
test ppl:  16%|█▌        | 38/236 [02:27<15:07,  4.59s/it]
test ppl:  17%|█▋        | 39/236 [02:28<12:06,  3.69s/it]
test ppl:  17%|█▋        | 40/236 [02:31<11:01,  3.38s/it]
test ppl:  17%|█▋        | 41/236 [02:33<09:32,  2.93s/it]
test ppl:  18%|█▊        | 42/236 [02:39<12:29,  3.86s/it]
test ppl:  18%|█▊        | 43/236 [02:45<14:20,  4.46s/it]
test ppl:  19%|█▊        | 44/236 [02:47<12:11,  3.81s/it]
test ppl:  19%|█▉        | 45/236 [02:49<10:21,  3.26s/it]
test ppl:  19%|█▉        | 46/236 [02:53<10:40,  3.37s/it]
test ppl:  20%|█▉        | 47/236 [02:55<09:22,  2.98s/it]
test ppl:  20%|██        | 48/236 [03:01<12:00,  3.84s/it]
test ppl:  21%|██        | 49/236 [03:04<11:54,  3.82s/it]
test ppl:  21%|██        | 50/236 [03:10<13:47,  4.45s/it]
test ppl:  22%|██▏       | 51/236 [03:15<13:42,  4.45s/it]
test ppl:  22%|██▏       | 52/236 [03:21<14:56,  4.87s/it]
test ppl:  22%|██▏       | 53/236 [03:26<15:01,  4.93s/it]
test ppl:  23%|██▎       | 54/236 [03:27<11:51,  3.91s/it]
test ppl:  23%|██▎       | 55/236 [03:33<13:18,  4.41s/it]
test ppl:  24%|██▎       | 56/236 [03:36<12:21,  4.12s/it]
test ppl:  24%|██▍       | 57/236 [03:39<10:54,  3.66s/it]
test ppl:  25%|██▍       | 58/236 [03:41<09:31,  3.21s/it]
test ppl:  25%|██▌       | 59/236 [03:47<11:48,  4.00s/it]
test ppl:  25%|██▌       | 60/236 [03:49<10:19,  3.52s/it]
test ppl:  26%|██▌       | 61/236 [03:55<12:17,  4.22s/it]
test ppl:  26%|██▋       | 62/236 [03:59<12:07,  4.18s/it]
test ppl:  27%|██▋       | 63/236 [04:02<10:33,  3.66s/it]
test ppl:  27%|██▋       | 64/236 [04:03<08:39,  3.02s/it]
test ppl:  28%|██▊       | 65/236 [04:04<07:12,  2.53s/it]
test ppl:  28%|██▊       | 66/236 [04:07<07:32,  2.66s/it]
test ppl:  28%|██▊       | 67/236 [04:10<07:11,  2.55s/it]
test ppl:  29%|██▉       | 68/236 [04:16<09:55,  3.55s/it]
test ppl:  29%|██▉       | 69/236 [04:20<10:42,  3.85s/it]
test ppl:  30%|██▉       | 70/236 [04:22<08:46,  3.17s/it]
test ppl:  30%|███       | 71/236 [04:26<09:53,  3.60s/it]
test ppl:  31%|███       | 72/236 [04:30<09:59,  3.66s/it]
test ppl:  31%|███       | 73/236 [04:35<10:33,  3.89s/it]
test ppl:  31%|███▏      | 74/236 [04:36<08:34,  3.17s/it]
test ppl:  32%|███▏      | 75/236 [04:42<10:40,  3.98s/it]
test ppl:  32%|███▏      | 76/236 [04:44<09:22,  3.51s/it]
test ppl:  33%|███▎      | 77/236 [04:47<08:19,  3.14s/it]
test ppl:  33%|███▎      | 78/236 [04:48<07:03,  2.68s/it]
test ppl:  33%|███▎      | 79/236 [04:53<08:49,  3.37s/it]
test ppl:  34%|███▍      | 80/236 [04:55<07:32,  2.90s/it]
test ppl:  34%|███▍      | 81/236 [05:01<09:46,  3.78s/it]
test ppl:  35%|███▍      | 82/236 [05:07<11:20,  4.42s/it]
test ppl:  35%|███▌      | 83/236 [05:10<10:20,  4.05s/it]
test ppl:  36%|███▌      | 84/236 [05:12<08:34,  3.39s/it]
test ppl:  36%|███▌      | 85/236 [05:16<09:04,  3.61s/it]
test ppl:  36%|███▋      | 86/236 [05:18<07:42,  3.08s/it]
test ppl:  37%|███▋      | 87/236 [05:20<06:54,  2.78s/it]
test ppl:  37%|███▋      | 88/236 [05:26<09:07,  3.70s/it]
test ppl:  38%|███▊      | 89/236 [05:28<07:47,  3.18s/it]
test ppl:  38%|███▊      | 90/236 [05:33<09:40,  3.98s/it]
test ppl:  39%|███▊      | 91/236 [05:38<10:13,  4.23s/it]
test ppl:  39%|███▉      | 92/236 [05:41<09:07,  3.80s/it]
test ppl:  39%|███▉      | 93/236 [05:47<10:31,  4.42s/it]
test ppl:  40%|███▉      | 94/236 [05:53<11:28,  4.85s/it]
test ppl:  40%|████      | 95/236 [05:55<09:32,  4.06s/it]
test ppl:  41%|████      | 96/236 [05:58<08:41,  3.73s/it]
test ppl:  41%|████      | 97/236 [06:04<10:06,  4.36s/it]
test ppl:  42%|████▏     | 98/236 [06:10<11:03,  4.81s/it]
test ppl:  42%|████▏     | 99/236 [06:16<11:41,  5.12s/it]
test ppl:  42%|████▏     | 100/236 [06:17<09:01,  3.98s/it]
test ppl:  43%|████▎     | 101/236 [06:22<10:02,  4.46s/it]
test ppl:  43%|████▎     | 102/236 [06:26<09:23,  4.21s/it]
test ppl:  44%|████▎     | 103/236 [06:28<07:54,  3.56s/it]
test ppl:  44%|████▍     | 104/236 [06:32<08:17,  3.77s/it]
test ppl:  44%|████▍     | 105/236 [06:36<08:19,  3.81s/it]
test ppl:  45%|████▍     | 106/236 [06:42<09:17,  4.29s/it]
test ppl:  45%|████▌     | 107/236 [06:44<07:46,  3.62s/it]
test ppl:  46%|████▌     | 108/236 [06:49<09:01,  4.23s/it]
test ppl:  46%|████▌     | 109/236 [06:54<09:13,  4.36s/it]
test ppl:  47%|████▋     | 110/236 [06:56<07:24,  3.52s/it]
test ppl:  47%|████▋     | 111/236 [07:01<08:47,  4.22s/it]
test ppl:  47%|████▋     | 112/236 [07:06<08:42,  4.21s/it]
test ppl:  48%|████▊     | 113/236 [07:07<07:07,  3.48s/it]
test ppl:  48%|████▊     | 114/236 [07:11<06:58,  3.43s/it]
test ppl:  49%|████▊     | 115/236 [07:14<07:04,  3.51s/it]
test ppl:  49%|████▉     | 116/236 [07:20<08:13,  4.11s/it]
test ppl:  50%|████▉     | 117/236 [07:22<06:48,  3.43s/it]
test ppl:  50%|█████     | 118/236 [07:26<07:17,  3.71s/it]
test ppl:  50%|█████     | 119/236 [07:28<06:14,  3.20s/it]
test ppl:  51%|█████     | 120/236 [07:30<05:13,  2.71s/it]
test ppl:  51%|█████▏    | 121/236 [07:36<07:00,  3.65s/it]
test ppl:  52%|█████▏    | 122/236 [07:40<07:35,  4.00s/it]
test ppl:  52%|█████▏    | 123/236 [07:43<06:29,  3.45s/it]
test ppl:  53%|█████▎    | 124/236 [07:45<05:50,  3.13s/it]
test ppl:  53%|█████▎    | 125/236 [07:47<05:26,  2.94s/it]
test ppl:  53%|█████▎    | 126/236 [07:53<07:00,  3.83s/it]
test ppl:  54%|█████▍    | 127/236 [07:55<05:53,  3.24s/it]
test ppl:  54%|█████▍    | 128/236 [07:57<05:17,  2.94s/it]
test ppl:  55%|█████▍    | 129/236 [08:01<05:20,  2.99s/it]
test ppl:  55%|█████▌    | 130/236 [08:04<05:18,  3.00s/it]
test ppl:  56%|█████▌    | 131/236 [08:09<06:45,  3.86s/it]
test ppl:  56%|█████▌    | 132/236 [08:12<05:58,  3.44s/it]
test ppl:  56%|█████▋    | 133/236 [08:16<06:08,  3.58s/it]
test ppl:  57%|█████▋    | 134/236 [08:20<06:14,  3.67s/it]
test ppl:  57%|█████▋    | 135/236 [08:26<07:16,  4.32s/it]
test ppl:  58%|█████▊    | 136/236 [08:27<05:41,  3.41s/it]
test ppl:  58%|█████▊    | 137/236 [08:33<06:51,  4.15s/it]
test ppl:  58%|█████▊    | 138/236 [08:39<07:37,  4.67s/it]
test ppl:  59%|█████▉    | 139/236 [08:41<06:32,  4.04s/it]
test ppl:  59%|█████▉    | 140/236 [08:43<05:32,  3.46s/it]
test ppl:  60%|█████▉    | 141/236 [08:46<05:12,  3.29s/it]
test ppl:  60%|██████    | 142/236 [08:48<04:36,  2.94s/it]
test ppl:  61%|██████    | 143/236 [08:54<05:55,  3.82s/it]
test ppl:  61%|██████    | 144/236 [08:57<05:21,  3.50s/it]
test ppl:  61%|██████▏   | 145/236 [09:02<06:12,  4.09s/it]
test ppl:  62%|██████▏   | 146/236 [09:07<06:21,  4.24s/it]
test ppl:  62%|██████▏   | 147/236 [09:13<07:01,  4.73s/it]
test ppl:  63%|██████▎   | 148/236 [09:19<07:29,  5.11s/it]
test ppl:  63%|██████▎   | 149/236 [09:22<06:39,  4.59s/it]
test ppl:  64%|██████▎   | 150/236 [09:26<06:08,  4.28s/it]
test ppl:  64%|██████▍   | 151/236 [09:32<06:44,  4.76s/it]
test ppl:  64%|██████▍   | 152/236 [09:38<07:18,  5.22s/it]
test ppl:  65%|██████▍   | 153/236 [09:44<07:29,  5.41s/it]
test ppl:  65%|██████▌   | 154/236 [09:46<06:12,  4.54s/it]
test ppl:  66%|██████▌   | 155/236 [09:49<05:22,  3.98s/it]
test ppl:  66%|██████▌   | 156/236 [09:51<04:34,  3.44s/it]
test ppl:  67%|██████▋   | 157/236 [09:53<04:04,  3.09s/it]
test ppl:  67%|██████▋   | 158/236 [09:59<05:05,  3.92s/it]
test ppl:  67%|██████▋   | 159/236 [10:00<03:57,  3.09s/it]
test ppl:  68%|██████▊   | 160/236 [10:02<03:10,  2.51s/it]
test ppl:  68%|██████▊   | 161/236 [10:03<02:42,  2.17s/it]
test ppl:  69%|██████▊   | 162/236 [10:06<02:55,  2.37s/it]
test ppl:  69%|██████▉   | 163/236 [10:08<02:53,  2.37s/it]
test ppl:  69%|██████▉   | 164/236 [10:13<03:36,  3.00s/it]
test ppl:  70%|██████▉   | 165/236 [10:17<03:59,  3.37s/it]
test ppl:  70%|███████   | 166/236 [10:19<03:20,  2.86s/it]
test ppl:  71%|███████   | 167/236 [10:20<02:48,  2.45s/it]
test ppl:  71%|███████   | 168/236 [10:25<03:42,  3.27s/it]
test ppl:  72%|███████▏  | 169/236 [10:30<04:12,  3.76s/it]
test ppl:  72%|███████▏  | 170/236 [10:36<04:50,  4.40s/it]
test ppl:  72%|███████▏  | 171/236 [10:37<03:48,  3.52s/it]
test ppl:  73%|███████▎  | 172/236 [10:40<03:21,  3.15s/it]
test ppl:  73%|███████▎  | 173/236 [10:45<03:50,  3.66s/it]
test ppl:  74%|███████▎  | 174/236 [10:48<03:40,  3.56s/it]
test ppl:  74%|███████▍  | 175/236 [10:50<03:05,  3.04s/it]
test ppl:  75%|███████▍  | 176/236 [10:55<03:34,  3.58s/it]
test ppl:  75%|███████▌  | 177/236 [11:00<04:11,  4.27s/it]
test ppl:  75%|███████▌  | 178/236 [11:06<04:35,  4.75s/it]
test ppl:  76%|███████▌  | 179/236 [11:12<04:50,  5.09s/it]
test ppl:  76%|███████▋  | 180/236 [11:16<04:17,  4.59s/it]
test ppl:  77%|███████▋  | 181/236 [11:22<04:33,  4.97s/it]
test ppl:  77%|███████▋  | 182/236 [11:23<03:38,  4.05s/it]
test ppl:  78%|███████▊  | 183/236 [11:26<03:06,  3.52s/it]
test ppl:  78%|███████▊  | 184/236 [11:27<02:30,  2.89s/it]
test ppl:  78%|███████▊  | 185/236 [11:31<02:43,  3.20s/it]
test ppl:  79%|███████▉  | 186/236 [11:37<03:19,  4.00s/it]
test ppl:  79%|███████▉  | 187/236 [11:43<03:44,  4.58s/it]
test ppl:  80%|███████▉  | 188/236 [11:49<03:58,  4.97s/it]
test ppl:  80%|████████  | 189/236 [11:55<04:06,  5.24s/it]
test ppl:  81%|████████  | 190/236 [11:58<03:39,  4.76s/it]
test ppl:  81%|████████  | 191/236 [12:03<03:28,  4.63s/it]
test ppl:  81%|████████▏ | 192/236 [12:05<02:57,  4.03s/it]
test ppl:  82%|████████▏ | 193/236 [12:11<03:16,  4.58s/it]
test ppl:  82%|████████▏ | 194/236 [12:14<02:47,  3.98s/it]
test ppl:  83%|████████▎ | 195/236 [12:17<02:31,  3.70s/it]
test ppl:  83%|████████▎ | 196/236 [12:19<02:07,  3.19s/it]
test ppl:  83%|████████▎ | 197/236 [12:21<01:52,  2.87s/it]
test ppl:  84%|████████▍ | 198/236 [12:27<02:23,  3.77s/it]
test ppl:  84%|████████▍ | 199/236 [12:29<02:07,  3.44s/it]
test ppl:  85%|████████▍ | 200/236 [12:35<02:29,  4.16s/it]
test ppl:  85%|████████▌ | 201/236 [12:37<02:03,  3.52s/it]
test ppl:  86%|████████▌ | 202/236 [12:43<02:20,  4.12s/it]
test ppl:  86%|████████▌ | 203/236 [12:49<02:33,  4.65s/it]
test ppl:  86%|████████▋ | 204/236 [12:51<02:04,  3.88s/it]
test ppl:  87%|████████▋ | 205/236 [12:57<02:19,  4.49s/it]
test ppl:  87%|████████▋ | 206/236 [13:00<02:04,  4.14s/it]
test ppl:  88%|████████▊ | 207/236 [13:06<02:14,  4.65s/it]
test ppl:  88%|████████▊ | 208/236 [13:09<01:53,  4.07s/it]
test ppl:  89%|████████▊ | 209/236 [13:14<02:04,  4.62s/it]
test ppl:  89%|████████▉ | 210/236 [13:17<01:42,  3.93s/it]
test ppl:  89%|████████▉ | 211/236 [13:21<01:40,  4.00s/it]
test ppl:  90%|████████▉ | 212/236 [13:26<01:44,  4.35s/it]
test ppl:  90%|█████████ | 213/236 [13:32<01:50,  4.80s/it]
test ppl:  91%|█████████ | 214/236 [13:34<01:24,  3.85s/it]
test ppl:  91%|█████████ | 215/236 [13:39<01:33,  4.45s/it]
test ppl:  92%|█████████▏| 216/236 [13:41<01:12,  3.61s/it]
test ppl:  92%|█████████▏| 217/236 [13:47<01:21,  4.31s/it]
test ppl:  92%|█████████▏| 218/236 [13:49<01:06,  3.68s/it]
test ppl:  93%|█████████▎| 219/236 [13:55<01:13,  4.34s/it]
test ppl:  93%|█████████▎| 220/236 [14:01<01:16,  4.79s/it]
test ppl:  94%|█████████▎| 221/236 [14:05<01:08,  4.54s/it]
test ppl:  94%|█████████▍| 222/236 [14:11<01:09,  4.93s/it]
test ppl:  94%|█████████▍| 223/236 [14:15<01:00,  4.66s/it]
test ppl:  95%|█████████▍| 224/236 [14:17<00:45,  3.79s/it]
test ppl:  95%|█████████▌| 225/236 [14:22<00:48,  4.40s/it]
test ppl:  96%|█████████▌| 226/236 [14:25<00:39,  3.97s/it]
test ppl:  96%|█████████▌| 227/236 [14:28<00:32,  3.60s/it]
test ppl:  97%|█████████▋| 228/236 [14:30<00:24,  3.02s/it]
test ppl:  97%|█████████▋| 229/236 [14:36<00:27,  3.86s/it]
test ppl:  97%|█████████▋| 230/236 [14:39<00:22,  3.75s/it]
test ppl:  98%|█████████▊| 231/236 [14:42<00:18,  3.62s/it]
test ppl:  98%|█████████▊| 232/236 [14:44<00:12,  3.06s/it]
test ppl:  99%|█████████▊| 233/236 [14:46<00:08,  2.78s/it]
test ppl:  99%|█████████▉| 234/236 [14:48<00:04,  2.41s/it]
test ppl: 100%|█████████▉| 235/236 [14:54<00:03,  3.44s/it]
test ppl: 100%|██████████| 236/236 [14:54<00:00,  2.60s/it]
test ppl: 100%|██████████| 236/236 [14:54<00:00,  3.79s/it]
10/12/2024 06:57:57 - INFO - __main__ -    em: 0.2109
10/12/2024 06:57:57 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.2 10:  em: 0.2109

--------------------------------------------------------------------------------
Running experiment with knn_temp=10, lmbda=0.2, k=32
2024-10-12 06:58:04.256746: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 06:58:04.276176: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 06:58:04.297988: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 06:58:04.304594: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 06:58:04.320574: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 06:58:05.315163: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 06:58:06 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.2, knn_temp=10, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 06:58:06 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:32:48,  2.21it/s]
Adding feature api:   4%|▍         | 7289/187062 [00:00<00:10, 17469.43it/s]
Adding feature api:   8%|▊         | 15422/187062 [00:00<00:05, 33757.63it/s]
Adding feature api:  13%|█▎        | 23858/187062 [00:00<00:03, 47270.31it/s]
Adding feature api:  17%|█▋        | 32256/187062 [00:00<00:02, 57406.88it/s]
Adding feature api:  22%|██▏       | 40675/187062 [00:00<00:02, 64981.81it/s]
Adding feature api:  26%|██▌       | 49084/187062 [00:01<00:01, 70480.98it/s]
Adding feature api:  31%|███       | 57285/187062 [00:01<00:01, 73838.64it/s]
Adding feature api:  35%|███▌      | 65702/187062 [00:01<00:01, 76872.64it/s]
Adding feature api:  40%|███▉      | 74173/187062 [00:01<00:01, 79187.57it/s]
Adding feature api:  44%|████▍     | 82685/187062 [00:01<00:01, 80946.00it/s]
Adding feature api:  49%|████▊     | 91027/187062 [00:01<00:01, 81394.67it/s]
Adding feature api:  53%|█████▎    | 99470/187062 [00:01<00:01, 82295.46it/s]
Adding feature api:  58%|█████▊    | 107938/187062 [00:01<00:00, 83004.36it/s]
Adding feature api:  62%|██████▏   | 116411/187062 [00:01<00:00, 83517.00it/s]
Adding feature api:  67%|██████▋   | 124824/187062 [00:01<00:00, 83175.80it/s]
Adding feature api:  71%|███████   | 133239/187062 [00:02<00:00, 83465.01it/s]
Adding feature api:  76%|███████▌  | 141710/187062 [00:02<00:00, 83834.39it/s]
Adding feature api:  80%|████████  | 150115/187062 [00:02<00:00, 83859.55it/s]
Adding feature api:  85%|████████▍ | 158539/187062 [00:02<00:00, 83971.15it/s]
Adding feature api:  89%|████████▉ | 166947/187062 [00:02<00:00, 83470.08it/s]
Adding feature api:  94%|█████████▎| 175363/187062 [00:02<00:00, 83672.63it/s]
Adding feature api:  98%|█████████▊| 183736/187062 [00:02<00:00, 57685.57it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64296.76it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:20:50,  2.23it/s]
Adding feature datatype:   4%|▍         | 7018/187062 [00:00<00:10, 16929.17it/s]
Adding feature datatype:   8%|▊         | 15185/187062 [00:00<00:05, 33520.94it/s]
Adding feature datatype:  12%|█▏        | 23243/187062 [00:00<00:03, 46131.46it/s]
Adding feature datatype:  17%|█▋        | 31103/187062 [00:00<00:02, 55119.04it/s]
Adding feature datatype:  21%|██        | 39264/187062 [00:00<00:02, 62626.17it/s]
Adding feature datatype:  25%|██▌       | 47449/187062 [00:01<00:02, 68163.46it/s]
Adding feature datatype:  30%|██▉       | 55655/187062 [00:01<00:01, 72214.15it/s]
Adding feature datatype:  34%|███▍      | 63856/187062 [00:01<00:01, 75092.01it/s]
Adding feature datatype:  38%|███▊      | 71838/187062 [00:01<00:01, 76138.46it/s]
Adding feature datatype:  43%|████▎     | 80049/187062 [00:01<00:01, 77905.08it/s]
Adding feature datatype:  47%|████▋     | 88245/187062 [00:01<00:01, 79107.09it/s]
Adding feature datatype:  52%|█████▏    | 96396/187062 [00:01<00:01, 79821.75it/s]
Adding feature datatype:  56%|█████▌    | 104496/187062 [00:01<00:01, 79405.41it/s]
Adding feature datatype:  60%|██████    | 112693/187062 [00:01<00:00, 80163.79it/s]
Adding feature datatype:  65%|██████▍   | 120858/187062 [00:01<00:00, 80604.91it/s]
Adding feature datatype:  69%|██████▉   | 129065/187062 [00:02<00:00, 81040.34it/s]
Adding feature datatype:  73%|███████▎  | 137301/187062 [00:02<00:00, 81434.37it/s]
Adding feature datatype:  78%|███████▊  | 145504/187062 [00:02<00:00, 81611.54it/s]
Adding feature datatype:  82%|████████▏ | 153680/187062 [00:02<00:00, 80705.59it/s]
Adding feature datatype:  87%|████████▋ | 161954/187062 [00:02<00:00, 81308.90it/s]
Adding feature datatype:  91%|█████████ | 170194/187062 [00:02<00:00, 81633.51it/s]
Adding feature datatype:  95%|█████████▌| 178365/187062 [00:02<00:00, 77950.95it/s]
Adding feature datatype: 100%|█████████▉| 186199/187062 [00:02<00:00, 51966.50it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 62868.99it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:14:12,  2.24it/s]
Adding feature literal:   4%|▍         | 7020/187062 [00:00<00:10, 16995.02it/s]
Adding feature literal:   8%|▊         | 15086/187062 [00:00<00:05, 33355.08it/s]
Adding feature literal:  12%|█▏        | 23204/187062 [00:00<00:03, 46195.92it/s]
Adding feature literal:  17%|█▋        | 31346/187062 [00:00<00:02, 55960.49it/s]
Adding feature literal:  21%|██        | 39517/187062 [00:00<00:02, 63264.07it/s]
Adding feature literal:  26%|██▌       | 47727/187062 [00:01<00:02, 68695.19it/s]
Adding feature literal:  30%|██▉       | 55874/187062 [00:01<00:01, 72421.86it/s]
Adding feature literal:  34%|███▍      | 64061/187062 [00:01<00:01, 75198.10it/s]
Adding feature literal:  39%|███▊      | 72244/187062 [00:01<00:01, 77159.32it/s]
Adding feature literal:  43%|████▎     | 80396/187062 [00:01<00:01, 78453.81it/s]
Adding feature literal:  47%|████▋     | 88641/187062 [00:01<00:01, 79641.82it/s]
Adding feature literal:  52%|█████▏    | 96824/187062 [00:01<00:01, 80294.60it/s]
Adding feature literal:  56%|█████▌    | 105037/187062 [00:01<00:01, 80841.50it/s]
Adding feature literal:  61%|██████    | 113317/187062 [00:01<00:00, 81425.01it/s]
Adding feature literal:  65%|██████▍   | 121526/187062 [00:01<00:00, 81621.69it/s]
Adding feature literal:  69%|██████▉   | 129729/187062 [00:02<00:00, 81637.10it/s]
Adding feature literal:  74%|███████▎  | 137922/187062 [00:02<00:00, 81712.94it/s]
Adding feature literal:  78%|███████▊  | 146114/187062 [00:02<00:00, 81630.97it/s]
Adding feature literal:  82%|████████▏ | 154297/187062 [00:02<00:00, 81688.83it/s]
Adding feature literal:  87%|████████▋ | 162497/187062 [00:02<00:00, 81779.84it/s]
Adding feature literal:  91%|█████████▏| 170746/187062 [00:02<00:00, 81989.63it/s]
Adding feature literal:  96%|█████████▌| 178950/187062 [00:02<00:00, 75628.81it/s]
Adding feature literal: 100%|█████████▉| 186614/187062 [00:02<00:00, 51734.44it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63270.55it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:22:45,  2.22it/s]
Adding feature operator:   4%|▍         | 7085/187062 [00:00<00:10, 17072.73it/s]
Adding feature operator:   8%|▊         | 15154/187062 [00:00<00:05, 33364.51it/s]
Adding feature operator:  12%|█▏        | 23285/187062 [00:00<00:03, 46205.59it/s]
Adding feature operator:  17%|█▋        | 31464/187062 [00:00<00:02, 56052.91it/s]
Adding feature operator:  21%|██        | 39668/187062 [00:00<00:02, 63415.43it/s]
Adding feature operator:  25%|██▌       | 47687/187062 [00:01<00:02, 68247.12it/s]
Adding feature operator:  30%|██▉       | 55873/187062 [00:01<00:01, 72213.38it/s]
Adding feature operator:  34%|███▍      | 64089/187062 [00:01<00:01, 75130.23it/s]
Adding feature operator:  39%|███▊      | 72308/187062 [00:01<00:01, 77216.77it/s]
Adding feature operator:  43%|████▎     | 80529/187062 [00:01<00:01, 78697.74it/s]
Adding feature operator:  47%|████▋     | 88693/187062 [00:01<00:01, 79573.68it/s]
Adding feature operator:  52%|█████▏    | 96855/187062 [00:01<00:01, 80182.49it/s]
Adding feature operator:  56%|█████▌    | 105050/187062 [00:01<00:01, 80709.44it/s]
Adding feature operator:  61%|██████    | 113237/187062 [00:01<00:00, 81054.19it/s]
Adding feature operator:  65%|██████▍   | 121475/187062 [00:01<00:00, 81448.65it/s]
Adding feature operator:  69%|██████▉   | 129661/187062 [00:02<00:00, 81529.82it/s]
Adding feature operator:  74%|███████▎  | 137843/187062 [00:02<00:00, 81598.08it/s]
Adding feature operator:  78%|███████▊  | 146037/187062 [00:02<00:00, 81699.76it/s]
Adding feature operator:  82%|████████▏ | 154252/187062 [00:02<00:00, 81832.88it/s]
Adding feature operator:  87%|████████▋ | 162469/187062 [00:02<00:00, 81933.17it/s]
Adding feature operator:  91%|█████████ | 170670/187062 [00:02<00:00, 81861.88it/s]
Adding feature operator:  96%|█████████▌| 178862/187062 [00:02<00:00, 75823.78it/s]
Adding feature operator: 100%|█████████▉| 186537/187062 [00:02<00:00, 51830.62it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63205.26it/s]
[2024-10-12 06:58:50,588] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 06:58:52 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 06:58:52 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 417.28 examples/s]
Map:   2%|▏         | 108/6548 [00:00<00:25, 250.52 examples/s]
Map:   2%|▏         | 152/6548 [00:00<00:21, 298.10 examples/s]
Map:   3%|▎         | 197/6548 [00:00<00:19, 324.81 examples/s]
Map:   4%|▎         | 240/6548 [00:00<00:17, 350.78 examples/s]
Map:   4%|▍         | 291/6548 [00:00<00:18, 343.43 examples/s]
Map:   5%|▌         | 330/6548 [00:01<00:20, 310.25 examples/s]
Map:   6%|▌         | 365/6548 [00:01<00:19, 317.37 examples/s]
Map:   6%|▋         | 420/6548 [00:01<00:16, 375.15 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:17, 341.40 examples/s]
Map:   8%|▊         | 527/6548 [00:01<00:17, 348.22 examples/s]
Map:   9%|▉         | 575/6548 [00:01<00:16, 368.68 examples/s]
Map:   9%|▉         | 621/6548 [00:01<00:17, 344.75 examples/s]
Map:  10%|█         | 660/6548 [00:02<00:19, 298.95 examples/s]
Map:  11%|█         | 706/6548 [00:02<00:17, 332.85 examples/s]
Map:  11%|█▏        | 749/6548 [00:02<00:16, 351.82 examples/s]
Map:  12%|█▏        | 802/6548 [00:02<00:14, 394.20 examples/s]
Map:  13%|█▎        | 859/6548 [00:02<00:14, 386.12 examples/s]
Map:  14%|█▍        | 914/6548 [00:02<00:15, 374.09 examples/s]
Map:  15%|█▍        | 957/6548 [00:02<00:14, 380.54 examples/s]
Map:  15%|█▌        | 1000/6548 [00:03<00:23, 231.75 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:21, 255.23 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:19, 279.96 examples/s]
Map:  17%|█▋        | 1124/6548 [00:03<00:16, 321.37 examples/s]
Map:  18%|█▊        | 1164/6548 [00:03<00:15, 337.24 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:14, 356.96 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:14, 365.86 examples/s]
Map:  20%|█▉        | 1289/6548 [00:03<00:14, 370.62 examples/s]
Map:  20%|██        | 1334/6548 [00:04<00:15, 327.21 examples/s]
Map:  21%|██        | 1379/6548 [00:04<00:17, 298.84 examples/s]
Map:  22%|██▏       | 1430/6548 [00:04<00:16, 308.36 examples/s]
Map:  23%|██▎       | 1480/6548 [00:04<00:17, 283.17 examples/s]
Map:  23%|██▎       | 1512/6548 [00:04<00:17, 288.84 examples/s]
Map:  24%|██▍       | 1559/6548 [00:04<00:17, 285.06 examples/s]
Map:  24%|██▍       | 1593/6548 [00:04<00:16, 296.78 examples/s]
Map:  25%|██▍       | 1628/6548 [00:05<00:18, 268.96 examples/s]
Map:  25%|██▌       | 1665/6548 [00:05<00:19, 253.05 examples/s]
Map:  26%|██▌       | 1703/6548 [00:05<00:17, 278.59 examples/s]
Map:  27%|██▋       | 1745/6548 [00:05<00:15, 306.98 examples/s]
Map:  27%|██▋       | 1791/6548 [00:05<00:14, 339.43 examples/s]
Map:  28%|██▊       | 1851/6548 [00:05<00:13, 349.22 examples/s]
Map:  29%|██▉       | 1899/6548 [00:05<00:13, 336.56 examples/s]
Map:  30%|██▉       | 1953/6548 [00:06<00:13, 342.73 examples/s]
Map:  30%|███       | 1996/6548 [00:06<00:12, 355.78 examples/s]
Map:  31%|███▏      | 2049/6548 [00:06<00:19, 230.92 examples/s]
Map:  32%|███▏      | 2092/6548 [00:06<00:17, 260.43 examples/s]
Map:  32%|███▏      | 2126/6548 [00:06<00:16, 273.08 examples/s]
Map:  33%|███▎      | 2172/6548 [00:06<00:16, 269.22 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 281.26 examples/s]
Map:  34%|███▍      | 2258/6548 [00:07<00:15, 283.94 examples/s]
Map:  35%|███▌      | 2309/6548 [00:07<00:14, 294.34 examples/s]
Map:  36%|███▌      | 2350/6548 [00:07<00:13, 316.78 examples/s]
Map:  37%|███▋      | 2401/6548 [00:07<00:12, 321.53 examples/s]
Map:  37%|███▋      | 2438/6548 [00:07<00:13, 311.14 examples/s]
Map:  38%|███▊      | 2477/6548 [00:07<00:12, 320.29 examples/s]
Map:  38%|███▊      | 2517/6548 [00:08<00:12, 334.85 examples/s]
Map:  39%|███▉      | 2562/6548 [00:08<00:11, 357.64 examples/s]
Map:  40%|███▉      | 2606/6548 [00:08<00:10, 378.21 examples/s]
Map:  41%|████      | 2652/6548 [00:08<00:09, 392.92 examples/s]
Map:  41%|████▏     | 2709/6548 [00:08<00:11, 341.22 examples/s]
Map:  42%|████▏     | 2746/6548 [00:08<00:10, 346.05 examples/s]
Map:  43%|████▎     | 2783/6548 [00:08<00:10, 348.93 examples/s]
Map:  43%|████▎     | 2828/6548 [00:08<00:12, 288.44 examples/s]
Map:  44%|████▎     | 2860/6548 [00:09<00:12, 293.16 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 298.21 examples/s]
Map:  45%|████▌     | 2949/6548 [00:09<00:12, 297.15 examples/s]
Map:  46%|████▌     | 2986/6548 [00:09<00:11, 313.01 examples/s]
Map:  46%|████▌     | 3026/6548 [00:09<00:21, 167.17 examples/s]
Map:  47%|████▋     | 3062/6548 [00:10<00:17, 194.21 examples/s]
Map:  47%|████▋     | 3093/6548 [00:10<00:16, 213.18 examples/s]
Map:  48%|████▊     | 3132/6548 [00:10<00:14, 243.71 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:14, 240.95 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:14, 233.14 examples/s]
Map:  49%|████▉     | 3238/6548 [00:10<00:12, 254.97 examples/s]
Map:  50%|████▉     | 3272/6548 [00:10<00:12, 270.76 examples/s]
Map:  50%|█████     | 3306/6548 [00:10<00:11, 285.62 examples/s]
Map:  51%|█████     | 3348/6548 [00:11<00:10, 307.03 examples/s]
Map:  52%|█████▏    | 3391/6548 [00:11<00:10, 291.55 examples/s]
Map:  53%|█████▎    | 3440/6548 [00:11<00:10, 297.91 examples/s]
Map:  53%|█████▎    | 3482/6548 [00:11<00:11, 273.90 examples/s]
Map:  54%|█████▍    | 3528/6548 [00:11<00:09, 312.52 examples/s]
Map:  55%|█████▍    | 3571/6548 [00:11<00:08, 336.74 examples/s]
Map:  55%|█████▌    | 3617/6548 [00:11<00:08, 366.26 examples/s]
Map:  56%|█████▌    | 3667/6548 [00:12<00:08, 346.62 examples/s]
Map:  57%|█████▋    | 3712/6548 [00:12<00:07, 370.18 examples/s]
Map:  57%|█████▋    | 3752/6548 [00:12<00:07, 363.69 examples/s]
Map:  58%|█████▊    | 3800/6548 [00:12<00:07, 391.99 examples/s]
Map:  59%|█████▊    | 3841/6548 [00:12<00:08, 334.50 examples/s]
Map:  59%|█████▉    | 3894/6548 [00:12<00:07, 335.70 examples/s]
Map:  60%|██████    | 3938/6548 [00:12<00:08, 305.05 examples/s]
Map:  61%|██████    | 3978/6548 [00:12<00:07, 324.27 examples/s]
Map:  62%|██████▏   | 4029/6548 [00:13<00:10, 243.75 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 287.92 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 311.29 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:08, 294.23 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:13<00:07, 311.89 examples/s]
Map:  65%|██████▌   | 4259/6548 [00:13<00:06, 348.13 examples/s]
Map:  66%|██████▌   | 4298/6548 [00:13<00:06, 348.94 examples/s]
Map:  66%|██████▋   | 4345/6548 [00:14<00:05, 378.33 examples/s]
Map:  67%|██████▋   | 4399/6548 [00:14<00:05, 370.59 examples/s]
Map:  68%|██████▊   | 4440/6548 [00:14<00:05, 378.66 examples/s]
Map:  68%|██████▊   | 4483/6548 [00:14<00:06, 337.06 examples/s]
Map:  69%|██████▉   | 4526/6548 [00:14<00:06, 312.36 examples/s]
Map:  70%|██████▉   | 4576/6548 [00:14<00:06, 313.82 examples/s]
Map:  71%|███████   | 4627/6548 [00:14<00:06, 317.40 examples/s]
Map:  71%|███████▏  | 4670/6548 [00:15<00:05, 337.92 examples/s]
Map:  72%|███████▏  | 4712/6548 [00:15<00:05, 352.66 examples/s]
Map:  73%|███████▎  | 4751/6548 [00:15<00:05, 358.93 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 412.32 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 398.79 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 374.26 examples/s]
Map:  76%|███████▌  | 4959/6548 [00:15<00:03, 415.44 examples/s]
Map:  76%|███████▋  | 5005/6548 [00:16<00:06, 223.55 examples/s]
Map:  77%|███████▋  | 5052/6548 [00:16<00:05, 261.29 examples/s]
Map:  78%|███████▊  | 5101/6548 [00:16<00:05, 271.01 examples/s]
Map:  79%|███████▊  | 5155/6548 [00:16<00:04, 280.55 examples/s]
Map:  80%|███████▉  | 5207/6548 [00:16<00:04, 288.55 examples/s]
Map:  80%|████████  | 5246/6548 [00:16<00:04, 305.24 examples/s]
Map:  81%|████████  | 5286/6548 [00:17<00:03, 323.18 examples/s]
Map:  81%|████████▏ | 5322/6548 [00:17<00:03, 330.18 examples/s]
Map:  82%|████████▏ | 5379/6548 [00:17<00:03, 301.01 examples/s]
Map:  83%|████████▎ | 5430/6548 [00:17<00:03, 295.85 examples/s]
Map:  84%|████████▎ | 5471/6548 [00:17<00:03, 315.47 examples/s]
Map:  84%|████████▍ | 5509/6548 [00:17<00:03, 323.25 examples/s]
Map:  85%|████████▍ | 5553/6548 [00:17<00:02, 350.31 examples/s]
Map:  85%|████████▌ | 5594/6548 [00:18<00:02, 319.73 examples/s]
Map:  86%|████████▌ | 5642/6548 [00:18<00:02, 355.71 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 312.71 examples/s]
Map:  87%|████████▋ | 5721/6548 [00:18<00:02, 332.86 examples/s]
Map:  88%|████████▊ | 5762/6548 [00:18<00:02, 350.10 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 350.81 examples/s]
Map:  89%|████████▉ | 5844/6548 [00:18<00:02, 348.11 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:18<00:01, 351.87 examples/s]
Map:  90%|█████████ | 5923/6548 [00:18<00:01, 362.47 examples/s]
Map:  91%|█████████ | 5966/6548 [00:19<00:01, 331.96 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 238.49 examples/s]
Map:  93%|█████████▎| 6073/6548 [00:19<00:01, 254.68 examples/s]
Map:  93%|█████████▎| 6117/6548 [00:19<00:01, 254.13 examples/s]
Map:  94%|█████████▍| 6154/6548 [00:19<00:01, 274.47 examples/s]
Map:  95%|█████████▍| 6190/6548 [00:19<00:01, 288.51 examples/s]
Map:  95%|█████████▌| 6228/6548 [00:20<00:01, 307.25 examples/s]
Map:  96%|█████████▌| 6272/6548 [00:20<00:00, 298.79 examples/s]
Map:  96%|█████████▋| 6310/6548 [00:20<00:00, 315.87 examples/s]
Map:  97%|█████████▋| 6365/6548 [00:20<00:00, 362.47 examples/s]
Map:  98%|█████████▊| 6421/6548 [00:20<00:00, 354.96 examples/s]
Map:  99%|█████████▉| 6471/6548 [00:20<00:00, 386.54 examples/s]
Map:  99%|█████████▉| 6515/6548 [00:20<00:00, 383.17 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 311.17 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   3%|▎         | 28/903 [00:00<00:03, 245.22 examples/s]
Map:   7%|▋         | 59/903 [00:00<00:03, 268.11 examples/s]
Map:  11%|█         | 96/903 [00:00<00:02, 296.34 examples/s]
Map:  14%|█▍        | 126/903 [00:00<00:02, 295.92 examples/s]
Map:  19%|█▉        | 175/903 [00:00<00:02, 356.29 examples/s]
Map:  24%|██▎       | 213/903 [00:00<00:01, 360.56 examples/s]
Map:  28%|██▊       | 256/903 [00:00<00:01, 377.16 examples/s]
Map:  34%|███▍      | 310/903 [00:00<00:01, 363.72 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 318.21 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 298.28 examples/s]
Map:  50%|█████     | 455/903 [00:01<00:01, 290.87 examples/s]
Map:  54%|█████▍    | 486/903 [00:01<00:01, 290.26 examples/s]
Map:  59%|█████▉    | 531/903 [00:01<00:01, 322.50 examples/s]
Map:  63%|██████▎   | 569/903 [00:01<00:00, 335.95 examples/s]
Map:  68%|██████▊   | 614/903 [00:01<00:00, 358.01 examples/s]
Map:  72%|███████▏  | 651/903 [00:01<00:00, 358.35 examples/s]
Map:  77%|███████▋  | 696/903 [00:02<00:00, 374.22 examples/s]
Map:  82%|████████▏ | 742/903 [00:02<00:00, 394.74 examples/s]
Map:  89%|████████▊ | 800/903 [00:02<00:00, 380.68 examples/s]
Map:  93%|█████████▎| 840/903 [00:02<00:00, 383.31 examples/s]
Map:  98%|█████████▊| 883/903 [00:02<00:00, 387.05 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 315.46 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 301.21 examples/s]
Map:   4%|▍         | 82/1882 [00:00<00:04, 372.25 examples/s]
Map:   7%|▋         | 135/1882 [00:00<00:05, 343.90 examples/s]
Map:  10%|▉         | 179/1882 [00:00<00:04, 374.29 examples/s]
Map:  13%|█▎        | 236/1882 [00:00<00:04, 375.05 examples/s]
Map:  15%|█▍        | 278/1882 [00:00<00:04, 383.17 examples/s]
Map:  18%|█▊        | 334/1882 [00:00<00:04, 365.85 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:04, 332.16 examples/s]
Map:  22%|██▏       | 414/1882 [00:01<00:04, 303.29 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 308.30 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 342.65 examples/s]
Map:  29%|██▉       | 543/1882 [00:01<00:04, 326.16 examples/s]
Map:  31%|███       | 587/1882 [00:01<00:03, 351.88 examples/s]
Map:  34%|███▍      | 644/1882 [00:01<00:03, 400.43 examples/s]
Map:  37%|███▋      | 704/1882 [00:01<00:03, 385.96 examples/s]
Map:  40%|███▉      | 744/1882 [00:02<00:02, 388.06 examples/s]
Map:  42%|████▏     | 795/1882 [00:02<00:02, 366.98 examples/s]
Map:  45%|████▌     | 848/1882 [00:02<00:03, 342.02 examples/s]
Map:  48%|████▊     | 900/1882 [00:02<00:02, 340.93 examples/s]
Map:  50%|█████     | 946/1882 [00:02<00:02, 362.67 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 370.30 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 240.28 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 253.70 examples/s]
Map:  59%|█████▉    | 1117/1882 [00:03<00:02, 261.24 examples/s]
Map:  62%|██████▏   | 1165/1882 [00:03<00:02, 276.79 examples/s]
Map:  64%|██████▍   | 1204/1882 [00:03<00:02, 260.55 examples/s]
Map:  66%|██████▌   | 1242/1882 [00:03<00:02, 281.24 examples/s]
Map:  68%|██████▊   | 1279/1882 [00:03<00:02, 299.92 examples/s]
Map:  70%|███████   | 1322/1882 [00:04<00:01, 329.26 examples/s]
Map:  72%|███████▏  | 1360/1882 [00:04<00:01, 331.57 examples/s]
Map:  75%|███████▌  | 1413/1882 [00:04<00:01, 334.11 examples/s]
Map:  77%|███████▋  | 1449/1882 [00:04<00:01, 294.29 examples/s]
Map:  79%|███████▉  | 1490/1882 [00:04<00:01, 283.07 examples/s]
Map:  81%|████████  | 1524/1882 [00:04<00:01, 264.26 examples/s]
Map:  83%|████████▎ | 1557/1882 [00:04<00:01, 278.38 examples/s]
Map:  85%|████████▌ | 1608/1882 [00:04<00:00, 329.96 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 333.79 examples/s]
Map:  91%|█████████ | 1716/1882 [00:05<00:00, 337.13 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 291.44 examples/s]
Map:  95%|█████████▍| 1785/1882 [00:05<00:00, 292.19 examples/s]
Map:  97%|█████████▋| 1830/1882 [00:05<00:00, 328.43 examples/s]
Map: 100%|█████████▉| 1874/1882 [00:05<00:00, 355.23 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 311.89 examples/s]
10/12/2024 06:59:54 - INFO - __main__ -     ***** Testing *****
10/12/2024 06:59:54 - INFO - __main__ -     Batch size = 8
10/12/2024 06:59:54 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 06:59:54 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 06:59:54 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 06:59:55 - INFO - knnlm -   Reading datastore took 0.8746206760406494 s
10/12/2024 06:59:56 - INFO - knnlm -   Moving index to GPU took 0.9927897453308105 s
10/12/2024 06:59:56 - INFO - __main__ -   ******************************break-into
10/12/2024 06:59:56 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 06:59:56 - INFO - __main__ -     Num examples = 236
10/12/2024 06:59:56 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:11,  7.45s/it]
test ppl:   1%|          | 2/236 [00:09<16:25,  4.21s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:32,  2.97s/it]
test ppl:   2%|▏         | 4/236 [00:16<15:53,  4.11s/it]
test ppl:   2%|▏         | 5/236 [00:22<18:16,  4.75s/it]
test ppl:   3%|▎         | 6/236 [00:24<15:00,  3.92s/it]
test ppl:   3%|▎         | 7/236 [00:26<12:25,  3.26s/it]
test ppl:   3%|▎         | 8/236 [00:31<13:36,  3.58s/it]
test ppl:   4%|▍         | 9/236 [00:33<11:49,  3.13s/it]
test ppl:   4%|▍         | 10/236 [00:36<12:00,  3.19s/it]
test ppl:   5%|▍         | 11/236 [00:38<11:01,  2.94s/it]
test ppl:   5%|▌         | 12/236 [00:41<10:31,  2.82s/it]
test ppl:   6%|▌         | 13/236 [00:47<13:55,  3.75s/it]
test ppl:   6%|▌         | 14/236 [00:53<16:16,  4.40s/it]
test ppl:   6%|▋         | 15/236 [00:56<15:00,  4.08s/it]
test ppl:   7%|▋         | 16/236 [00:58<12:30,  3.41s/it]
test ppl:   7%|▋         | 17/236 [01:02<12:38,  3.47s/it]
test ppl:   8%|▊         | 18/236 [01:03<10:39,  2.94s/it]
test ppl:   8%|▊         | 19/236 [01:08<12:16,  3.39s/it]
test ppl:   8%|▊         | 20/236 [01:09<10:28,  2.91s/it]
test ppl:   9%|▉         | 21/236 [01:12<09:45,  2.72s/it]
test ppl:   9%|▉         | 22/236 [01:18<13:04,  3.66s/it]
test ppl:  10%|▉         | 23/236 [01:20<11:53,  3.35s/it]
test ppl:  10%|█         | 24/236 [01:23<11:21,  3.21s/it]
test ppl:  11%|█         | 25/236 [01:25<09:51,  2.80s/it]
test ppl:  11%|█         | 26/236 [01:30<11:49,  3.38s/it]
test ppl:  11%|█▏        | 27/236 [01:34<12:35,  3.62s/it]
test ppl:  12%|█▏        | 28/236 [01:35<10:01,  2.89s/it]
test ppl:  12%|█▏        | 29/236 [01:37<09:23,  2.72s/it]
test ppl:  13%|█▎        | 30/236 [01:39<08:07,  2.37s/it]
test ppl:  13%|█▎        | 31/236 [01:41<07:43,  2.26s/it]
test ppl:  14%|█▎        | 32/236 [01:44<08:40,  2.55s/it]
test ppl:  14%|█▍        | 33/236 [01:50<12:03,  3.56s/it]
test ppl:  14%|█▍        | 34/236 [01:54<12:26,  3.70s/it]
test ppl:  15%|█▍        | 35/236 [01:57<11:13,  3.35s/it]
test ppl:  15%|█▌        | 36/236 [02:03<13:41,  4.11s/it]
test ppl:  16%|█▌        | 37/236 [02:08<15:26,  4.66s/it]
test ppl:  16%|█▌        | 38/236 [02:11<12:48,  3.88s/it]
test ppl:  17%|█▋        | 39/236 [02:12<10:27,  3.18s/it]
test ppl:  17%|█▋        | 40/236 [02:15<09:50,  3.01s/it]
test ppl:  17%|█▋        | 41/236 [02:17<08:40,  2.67s/it]
test ppl:  18%|█▊        | 42/236 [02:23<11:46,  3.64s/it]
test ppl:  18%|█▊        | 43/236 [02:28<13:52,  4.31s/it]
test ppl:  19%|█▊        | 44/236 [02:31<11:52,  3.71s/it]
test ppl:  19%|█▉        | 45/236 [02:33<10:09,  3.19s/it]
test ppl:  19%|█▉        | 46/236 [02:36<10:31,  3.32s/it]
test ppl:  20%|█▉        | 47/236 [02:38<09:16,  2.95s/it]
test ppl:  20%|██        | 48/236 [02:44<11:58,  3.82s/it]
test ppl:  21%|██        | 49/236 [02:48<11:53,  3.82s/it]
test ppl:  21%|██        | 50/236 [02:54<13:48,  4.45s/it]
test ppl:  22%|██▏       | 51/236 [02:58<13:43,  4.45s/it]
test ppl:  22%|██▏       | 52/236 [03:04<14:59,  4.89s/it]
test ppl:  22%|██▏       | 53/236 [03:09<15:05,  4.95s/it]
test ppl:  23%|██▎       | 54/236 [03:11<11:54,  3.93s/it]
test ppl:  23%|██▎       | 55/236 [03:17<13:23,  4.44s/it]
test ppl:  24%|██▎       | 56/236 [03:20<12:23,  4.13s/it]
test ppl:  24%|██▍       | 57/236 [03:23<10:54,  3.66s/it]
test ppl:  25%|██▍       | 58/236 [03:25<09:31,  3.21s/it]
test ppl:  25%|██▌       | 59/236 [03:31<11:49,  4.01s/it]
test ppl:  25%|██▌       | 60/236 [03:33<10:21,  3.53s/it]
test ppl:  26%|██▌       | 61/236 [03:39<12:21,  4.23s/it]
test ppl:  26%|██▋       | 62/236 [03:43<12:11,  4.20s/it]
test ppl:  27%|██▋       | 63/236 [03:45<10:36,  3.68s/it]
test ppl:  27%|██▋       | 64/236 [03:47<08:41,  3.03s/it]
test ppl:  28%|██▊       | 65/236 [03:48<07:10,  2.52s/it]
test ppl:  28%|██▊       | 66/236 [03:51<07:30,  2.65s/it]
test ppl:  28%|██▊       | 67/236 [03:54<07:10,  2.55s/it]
test ppl:  29%|██▉       | 68/236 [03:59<09:56,  3.55s/it]
test ppl:  29%|██▉       | 69/236 [04:04<10:44,  3.86s/it]
test ppl:  30%|██▉       | 70/236 [04:06<08:48,  3.18s/it]
test ppl:  30%|███       | 71/236 [04:10<09:55,  3.61s/it]
test ppl:  31%|███       | 72/236 [04:14<10:01,  3.67s/it]
test ppl:  31%|███       | 73/236 [04:19<10:49,  3.99s/it]
test ppl:  31%|███▏      | 74/236 [04:20<08:45,  3.25s/it]
test ppl:  32%|███▏      | 75/236 [04:26<10:50,  4.04s/it]
test ppl:  32%|███▏      | 76/236 [04:29<09:27,  3.55s/it]
test ppl:  33%|███▎      | 77/236 [04:31<08:24,  3.17s/it]
test ppl:  33%|███▎      | 78/236 [04:33<07:06,  2.70s/it]
test ppl:  33%|███▎      | 79/236 [04:38<08:53,  3.40s/it]
test ppl:  34%|███▍      | 80/236 [04:39<07:36,  2.93s/it]
test ppl:  34%|███▍      | 81/236 [04:45<09:50,  3.81s/it]
test ppl:  35%|███▍      | 82/236 [04:51<11:24,  4.45s/it]
test ppl:  35%|███▌      | 83/236 [04:54<09:51,  3.87s/it]
test ppl:  36%|███▌      | 84/236 [04:56<08:14,  3.26s/it]
test ppl:  36%|███▌      | 85/236 [05:00<08:50,  3.52s/it]
test ppl:  36%|███▋      | 86/236 [05:02<07:33,  3.02s/it]
test ppl:  37%|███▋      | 87/236 [05:04<06:49,  2.75s/it]
test ppl:  37%|███▋      | 88/236 [05:09<09:05,  3.69s/it]
test ppl:  38%|███▊      | 89/236 [05:11<07:47,  3.18s/it]
test ppl:  38%|███▊      | 90/236 [05:17<09:42,  3.99s/it]
test ppl:  39%|███▊      | 91/236 [05:22<10:16,  4.25s/it]
test ppl:  39%|███▉      | 92/236 [05:25<09:09,  3.82s/it]
test ppl:  39%|███▉      | 93/236 [05:31<10:33,  4.43s/it]
test ppl:  40%|███▉      | 94/236 [05:37<11:30,  4.86s/it]
test ppl:  40%|████      | 95/236 [05:39<09:34,  4.07s/it]
test ppl:  41%|████      | 96/236 [05:42<08:43,  3.74s/it]
test ppl:  41%|████      | 97/236 [05:48<10:09,  4.38s/it]
test ppl:  42%|████▏     | 98/236 [05:54<11:07,  4.84s/it]
test ppl:  42%|████▏     | 99/236 [06:00<11:46,  5.16s/it]
test ppl:  42%|████▏     | 100/236 [06:01<09:05,  4.01s/it]
test ppl:  43%|████▎     | 101/236 [06:07<10:06,  4.49s/it]
test ppl:  43%|████▎     | 102/236 [06:10<09:27,  4.23s/it]
test ppl:  44%|████▎     | 103/236 [06:12<07:57,  3.59s/it]
test ppl:  44%|████▍     | 104/236 [06:17<08:21,  3.80s/it]
test ppl:  44%|████▍     | 105/236 [06:21<08:22,  3.84s/it]
test ppl:  45%|████▍     | 106/236 [06:26<09:20,  4.31s/it]
test ppl:  45%|████▌     | 107/236 [06:28<07:48,  3.63s/it]
test ppl:  46%|████▌     | 108/236 [06:34<09:04,  4.26s/it]
test ppl:  46%|████▌     | 109/236 [06:38<09:16,  4.38s/it]
test ppl:  47%|████▋     | 110/236 [06:40<07:26,  3.54s/it]
test ppl:  47%|████▋     | 111/236 [06:44<07:38,  3.67s/it]
test ppl:  47%|████▋     | 112/236 [06:48<07:54,  3.83s/it]
test ppl:  48%|████▊     | 113/236 [06:50<06:34,  3.21s/it]
test ppl:  48%|████▊     | 114/236 [06:53<06:36,  3.25s/it]
test ppl:  49%|████▊     | 115/236 [06:57<06:50,  3.39s/it]
test ppl:  49%|████▉     | 116/236 [07:02<08:04,  4.03s/it]
test ppl:  50%|████▉     | 117/236 [07:04<06:42,  3.38s/it]
test ppl:  50%|█████     | 118/236 [07:09<07:13,  3.68s/it]
test ppl:  50%|█████     | 119/236 [07:11<06:11,  3.17s/it]
test ppl:  51%|█████     | 120/236 [07:12<05:11,  2.69s/it]
test ppl:  51%|█████▏    | 121/236 [07:18<06:58,  3.64s/it]
test ppl:  52%|█████▏    | 122/236 [07:23<07:34,  3.98s/it]
test ppl:  52%|█████▏    | 123/236 [07:25<06:28,  3.44s/it]
test ppl:  53%|█████▎    | 124/236 [07:27<05:50,  3.13s/it]
test ppl:  53%|█████▎    | 125/236 [07:30<05:26,  2.94s/it]
test ppl:  53%|█████▎    | 126/236 [07:36<07:01,  3.83s/it]
test ppl:  54%|█████▍    | 127/236 [07:38<05:53,  3.24s/it]
test ppl:  54%|█████▍    | 128/236 [07:40<05:18,  2.95s/it]
test ppl:  55%|█████▍    | 129/236 [07:43<05:21,  3.00s/it]
test ppl:  55%|█████▌    | 130/236 [07:46<05:19,  3.01s/it]
test ppl:  56%|█████▌    | 131/236 [07:52<06:46,  3.87s/it]
test ppl:  56%|█████▌    | 132/236 [07:55<05:59,  3.46s/it]
test ppl:  56%|█████▋    | 133/236 [07:58<06:10,  3.59s/it]
test ppl:  57%|█████▋    | 134/236 [08:02<06:15,  3.68s/it]
test ppl:  57%|█████▋    | 135/236 [08:08<07:17,  4.34s/it]
test ppl:  58%|█████▊    | 136/236 [08:10<05:42,  3.42s/it]
test ppl:  58%|█████▊    | 137/236 [08:15<06:52,  4.17s/it]
test ppl:  58%|█████▊    | 138/236 [08:21<07:38,  4.68s/it]
test ppl:  59%|█████▉    | 139/236 [08:24<06:33,  4.06s/it]
test ppl:  59%|█████▉    | 140/236 [08:26<05:33,  3.47s/it]
test ppl:  60%|█████▉    | 141/236 [08:29<05:13,  3.30s/it]
test ppl:  60%|██████    | 142/236 [08:31<04:37,  2.95s/it]
test ppl:  61%|██████    | 143/236 [08:37<05:57,  3.84s/it]
test ppl:  61%|██████    | 144/236 [08:40<05:22,  3.51s/it]
test ppl:  61%|██████▏   | 145/236 [08:45<06:13,  4.10s/it]
test ppl:  62%|██████▏   | 146/236 [08:50<06:19,  4.22s/it]
test ppl:  62%|██████▏   | 147/236 [08:56<07:00,  4.72s/it]
test ppl:  63%|██████▎   | 148/236 [09:03<08:08,  5.55s/it]
test ppl:  63%|██████▎   | 149/236 [09:07<07:29,  5.17s/it]
test ppl:  64%|██████▎   | 150/236 [09:15<08:24,  5.86s/it]
test ppl:  64%|██████▍   | 151/236 [09:22<09:02,  6.38s/it]
test ppl:  64%|██████▍   | 152/236 [09:30<09:23,  6.71s/it]
test ppl:  65%|██████▍   | 153/236 [09:37<09:37,  6.96s/it]
test ppl:  65%|██████▌   | 154/236 [09:40<07:43,  5.66s/it]
test ppl:  66%|██████▌   | 155/236 [09:43<06:25,  4.76s/it]
test ppl:  66%|██████▌   | 156/236 [09:45<05:18,  3.98s/it]
test ppl:  67%|██████▋   | 157/236 [09:47<04:33,  3.46s/it]
test ppl:  67%|██████▋   | 158/236 [09:53<05:26,  4.18s/it]
test ppl:  67%|██████▋   | 159/236 [09:59<06:01,  4.69s/it]
test ppl:  68%|██████▊   | 160/236 [10:00<04:36,  3.63s/it]
test ppl:  68%|██████▊   | 161/236 [10:01<03:41,  2.95s/it]
test ppl:  69%|██████▊   | 162/236 [10:04<03:36,  2.92s/it]
test ppl:  69%|██████▉   | 163/236 [10:07<03:21,  2.76s/it]
test ppl:  69%|██████▉   | 164/236 [10:11<03:56,  3.28s/it]
test ppl:  70%|██████▉   | 165/236 [10:16<04:17,  3.62s/it]
test ppl:  70%|███████   | 166/236 [10:17<03:33,  3.05s/it]
test ppl:  71%|███████   | 167/236 [10:19<02:57,  2.58s/it]
test ppl:  71%|███████   | 168/236 [10:24<03:48,  3.36s/it]
test ppl:  72%|███████▏  | 169/236 [10:29<04:17,  3.84s/it]
test ppl:  72%|███████▏  | 170/236 [10:35<04:53,  4.45s/it]
test ppl:  72%|███████▏  | 171/236 [10:36<03:51,  3.56s/it]
test ppl:  73%|███████▎  | 172/236 [10:39<03:23,  3.18s/it]
test ppl:  73%|███████▎  | 173/236 [10:43<03:52,  3.68s/it]
test ppl:  74%|███████▎  | 174/236 [10:47<03:42,  3.58s/it]
test ppl:  74%|███████▍  | 175/236 [10:49<03:06,  3.06s/it]
test ppl:  75%|███████▍  | 176/236 [10:53<03:35,  3.59s/it]
test ppl:  75%|███████▌  | 177/236 [10:59<04:12,  4.27s/it]
test ppl:  75%|███████▌  | 178/236 [11:05<04:35,  4.75s/it]
test ppl:  76%|███████▌  | 179/236 [11:11<04:49,  5.08s/it]
test ppl:  76%|███████▋  | 180/236 [11:14<04:17,  4.59s/it]
test ppl:  77%|███████▋  | 181/236 [11:20<04:33,  4.97s/it]
test ppl:  77%|███████▋  | 182/236 [11:22<03:38,  4.04s/it]
test ppl:  78%|███████▊  | 183/236 [11:24<03:06,  3.51s/it]
test ppl:  78%|███████▊  | 184/236 [11:26<02:30,  2.89s/it]
test ppl:  78%|███████▊  | 185/236 [11:30<02:43,  3.20s/it]
test ppl:  79%|███████▉  | 186/236 [11:36<03:19,  4.00s/it]
test ppl:  79%|███████▉  | 187/236 [11:42<03:44,  4.58s/it]
test ppl:  80%|███████▉  | 188/236 [11:47<03:58,  4.97s/it]
test ppl:  80%|████████  | 189/236 [11:53<04:06,  5.24s/it]
test ppl:  81%|████████  | 190/236 [11:57<03:39,  4.77s/it]
test ppl:  81%|████████  | 191/236 [12:01<03:28,  4.64s/it]
test ppl:  81%|████████▏ | 192/236 [12:04<02:57,  4.03s/it]
test ppl:  82%|████████▏ | 193/236 [12:10<03:17,  4.58s/it]
test ppl:  82%|████████▏ | 194/236 [12:12<02:47,  3.99s/it]
test ppl:  83%|████████▎ | 195/236 [12:16<02:32,  3.71s/it]
test ppl:  83%|████████▎ | 196/236 [12:18<02:07,  3.20s/it]
test ppl:  83%|████████▎ | 197/236 [12:20<01:52,  2.88s/it]
test ppl:  84%|████████▍ | 198/236 [12:26<02:23,  3.78s/it]
test ppl:  84%|████████▍ | 199/236 [12:28<02:07,  3.45s/it]
test ppl:  85%|████████▍ | 200/236 [12:34<02:30,  4.17s/it]
test ppl:  85%|████████▌ | 201/236 [12:36<02:03,  3.53s/it]
test ppl:  86%|████████▌ | 202/236 [12:42<02:20,  4.13s/it]
test ppl:  86%|████████▌ | 203/236 [12:47<02:29,  4.54s/it]
test ppl:  86%|████████▋ | 204/236 [12:49<02:00,  3.78s/it]
test ppl:  87%|████████▋ | 205/236 [12:55<02:16,  4.42s/it]
test ppl:  87%|████████▋ | 206/236 [12:58<02:02,  4.08s/it]
test ppl:  88%|████████▊ | 207/236 [13:04<02:11,  4.55s/it]
test ppl:  88%|████████▊ | 208/236 [13:07<01:54,  4.08s/it]
test ppl:  89%|████████▊ | 209/236 [13:13<02:05,  4.63s/it]
test ppl:  89%|████████▉ | 210/236 [13:15<01:42,  3.94s/it]
test ppl:  89%|████████▉ | 211/236 [13:19<01:40,  4.01s/it]
test ppl:  90%|████████▉ | 212/236 [13:25<01:44,  4.35s/it]
test ppl:  90%|█████████ | 213/236 [13:30<01:50,  4.80s/it]
test ppl:  91%|█████████ | 214/236 [13:32<01:24,  3.85s/it]
test ppl:  91%|█████████ | 215/236 [13:38<01:33,  4.45s/it]
test ppl:  92%|█████████▏| 216/236 [13:40<01:12,  3.61s/it]
test ppl:  92%|█████████▏| 217/236 [13:45<01:21,  4.31s/it]
test ppl:  92%|█████████▏| 218/236 [13:48<01:06,  3.68s/it]
test ppl:  93%|█████████▎| 219/236 [13:54<01:13,  4.34s/it]
test ppl:  93%|█████████▎| 220/236 [13:59<01:16,  4.79s/it]
test ppl:  94%|█████████▎| 221/236 [14:03<01:07,  4.53s/it]
test ppl:  94%|█████████▍| 222/236 [14:09<01:09,  4.93s/it]
test ppl:  94%|█████████▍| 223/236 [14:13<01:00,  4.66s/it]
test ppl:  95%|█████████▍| 224/236 [14:15<00:45,  3.80s/it]
test ppl:  95%|█████████▌| 225/236 [14:21<00:48,  4.40s/it]
test ppl:  96%|█████████▌| 226/236 [14:24<00:39,  3.97s/it]
test ppl:  96%|█████████▌| 227/236 [14:26<00:32,  3.60s/it]
test ppl:  97%|█████████▋| 228/236 [14:28<00:24,  3.02s/it]
test ppl:  97%|█████████▋| 229/236 [14:34<00:27,  3.86s/it]
test ppl:  97%|█████████▋| 230/236 [14:37<00:22,  3.76s/it]
test ppl:  98%|█████████▊| 231/236 [14:41<00:18,  3.63s/it]
test ppl:  98%|█████████▊| 232/236 [14:43<00:12,  3.06s/it]
test ppl:  99%|█████████▊| 233/236 [14:45<00:08,  2.78s/it]
test ppl:  99%|█████████▉| 234/236 [14:46<00:04,  2.41s/it]
test ppl: 100%|█████████▉| 235/236 [14:52<00:03,  3.45s/it]
test ppl: 100%|██████████| 236/236 [14:53<00:00,  2.61s/it]
test ppl: 100%|██████████| 236/236 [14:53<00:00,  3.78s/it]
10/12/2024 07:14:49 - INFO - __main__ -    em: 0.2109
10/12/2024 07:14:49 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.2 10:  em: 0.2109

--------------------------------------------------------------------------------
Running experiment with knn_temp=10, lmbda=0.2, k=64
2024-10-12 07:14:56.757316: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 07:14:56.776886: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 07:14:56.798535: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 07:14:56.805189: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 07:14:56.821049: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 07:14:57.812396: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 07:14:59 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.2, knn_temp=10, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 07:14:59 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:38:35,  2.20it/s]
Adding feature api:   4%|▍         | 7211/187062 [00:00<00:10, 17229.01it/s]
Adding feature api:   8%|▊         | 15466/187062 [00:00<00:05, 33850.94it/s]
Adding feature api:  13%|█▎        | 23740/187062 [00:00<00:03, 46884.06it/s]
Adding feature api:  17%|█▋        | 32039/187062 [00:00<00:02, 56840.62it/s]
Adding feature api:  22%|██▏       | 40369/187062 [00:00<00:02, 64316.87it/s]
Adding feature api:  26%|██▌       | 48739/187062 [00:01<00:01, 69890.15it/s]
Adding feature api:  31%|███       | 57093/187062 [00:01<00:01, 73862.75it/s]
Adding feature api:  35%|███▍      | 65443/187062 [00:01<00:01, 76693.19it/s]
Adding feature api:  39%|███▉      | 73782/187062 [00:01<00:01, 78671.31it/s]
Adding feature api:  44%|████▍     | 82155/187062 [00:01<00:01, 80172.75it/s]
Adding feature api:  48%|████▊     | 90504/187062 [00:01<00:01, 81157.66it/s]
Adding feature api:  53%|█████▎    | 98794/187062 [00:01<00:01, 81175.51it/s]
Adding feature api:  57%|█████▋    | 107130/187062 [00:01<00:00, 81824.45it/s]
Adding feature api:  62%|██████▏   | 115528/187062 [00:01<00:00, 82466.15it/s]
Adding feature api:  66%|██████▌   | 123865/187062 [00:01<00:00, 82735.21it/s]
Adding feature api:  71%|███████   | 132242/187062 [00:02<00:00, 83041.80it/s]
Adding feature api:  75%|███████▌  | 140576/187062 [00:02<00:00, 83115.98it/s]
Adding feature api:  80%|███████▉  | 148909/187062 [00:02<00:00, 83167.52it/s]
Adding feature api:  84%|████████▍ | 157272/187062 [00:02<00:00, 83303.69it/s]
Adding feature api:  89%|████████▊ | 165613/187062 [00:02<00:00, 83332.13it/s]
Adding feature api:  93%|█████████▎| 173987/187062 [00:02<00:00, 83451.34it/s]
Adding feature api:  97%|█████████▋| 182338/187062 [00:02<00:00, 61940.20it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 63956.06it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:36:44,  2.20it/s]
Adding feature datatype:   4%|▍         | 7065/187062 [00:00<00:10, 16896.99it/s]
Adding feature datatype:   8%|▊         | 15096/187062 [00:00<00:05, 33045.39it/s]
Adding feature datatype:  12%|█▏        | 23199/187062 [00:00<00:03, 45845.19it/s]
Adding feature datatype:  17%|█▋        | 31252/187062 [00:00<00:02, 55414.64it/s]
Adding feature datatype:  21%|██        | 39336/187062 [00:00<00:02, 62601.21it/s]
Adding feature datatype:  25%|██▌       | 47441/187062 [00:01<00:02, 67906.04it/s]
Adding feature datatype:  30%|██▉       | 55538/187062 [00:01<00:01, 71709.49it/s]
Adding feature datatype:  34%|███▍      | 63634/187062 [00:01<00:01, 74426.64it/s]
Adding feature datatype:  38%|███▊      | 71647/187062 [00:01<00:01, 76110.83it/s]
Adding feature datatype:  43%|████▎     | 79734/187062 [00:01<00:01, 77521.61it/s]
Adding feature datatype:  47%|████▋     | 87848/187062 [00:01<00:01, 78597.28it/s]
Adding feature datatype:  51%|█████▏    | 95981/187062 [00:01<00:01, 79411.44it/s]
Adding feature datatype:  56%|█████▌    | 104060/187062 [00:01<00:01, 79822.36it/s]
Adding feature datatype:  60%|█████▉    | 112197/187062 [00:01<00:00, 80285.00it/s]
Adding feature datatype:  64%|██████▍   | 120363/187062 [00:01<00:00, 80692.42it/s]
Adding feature datatype:  69%|██████▊   | 128474/187062 [00:02<00:00, 80772.26it/s]
Adding feature datatype:  73%|███████▎  | 136580/187062 [00:02<00:00, 80718.38it/s]
Adding feature datatype:  77%|███████▋  | 144701/187062 [00:02<00:00, 80862.40it/s]
Adding feature datatype:  82%|████████▏ | 152817/187062 [00:02<00:00, 80950.65it/s]
Adding feature datatype:  86%|████████▌ | 160993/187062 [00:02<00:00, 81190.32it/s]
Adding feature datatype:  90%|█████████ | 169168/187062 [00:02<00:00, 81356.14it/s]
Adding feature datatype:  95%|█████████▍| 177309/187062 [00:02<00:00, 81026.34it/s]
Adding feature datatype:  99%|█████████▉| 185416/187062 [00:02<00:00, 53312.01it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 62732.36it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:14:43,  2.24it/s]
Adding feature literal:   4%|▍         | 7033/187062 [00:00<00:10, 17021.42it/s]
Adding feature literal:   8%|▊         | 15133/187062 [00:00<00:05, 33458.14it/s]
Adding feature literal:  12%|█▏        | 23227/187062 [00:00<00:03, 46205.60it/s]
Adding feature literal:  17%|█▋        | 31401/187062 [00:00<00:02, 56055.30it/s]
Adding feature literal:  21%|██        | 39535/187062 [00:00<00:02, 63226.38it/s]
Adding feature literal:  26%|██▌       | 47710/187062 [00:01<00:02, 68566.72it/s]
Adding feature literal:  30%|██▉       | 55859/187062 [00:01<00:01, 72335.59it/s]
Adding feature literal:  34%|███▍      | 64031/187062 [00:01<00:01, 75094.50it/s]
Adding feature literal:  39%|███▊      | 72043/187062 [00:01<00:01, 76580.16it/s]
Adding feature literal:  43%|████▎     | 80223/187062 [00:01<00:01, 78127.69it/s]
Adding feature literal:  47%|████▋     | 88271/187062 [00:01<00:01, 78806.06it/s]
Adding feature literal:  52%|█████▏    | 96406/187062 [00:01<00:01, 79564.23it/s]
Adding feature literal:  56%|█████▌    | 104548/187062 [00:01<00:01, 80116.13it/s]
Adding feature literal:  60%|██████    | 112676/187062 [00:01<00:00, 80461.47it/s]
Adding feature literal:  65%|██████▍   | 120791/187062 [00:01<00:00, 80664.23it/s]
Adding feature literal:  69%|██████▉   | 128939/187062 [00:02<00:00, 80905.33it/s]
Adding feature literal:  73%|███████▎  | 137058/187062 [00:02<00:00, 80886.40it/s]
Adding feature literal:  78%|███████▊  | 145188/187062 [00:02<00:00, 81008.29it/s]
Adding feature literal:  82%|████████▏ | 153303/187062 [00:02<00:00, 80922.25it/s]
Adding feature literal:  86%|████████▋ | 161456/187062 [00:02<00:00, 81101.77it/s]
Adding feature literal:  91%|█████████ | 169616/187062 [00:02<00:00, 81247.87it/s]
Adding feature literal:  95%|█████████▌| 177746/187062 [00:02<00:00, 80836.88it/s]
Adding feature literal:  99%|█████████▉| 185834/187062 [00:02<00:00, 52582.64it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63002.34it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:13:40,  2.24it/s]
Adding feature operator:   4%|▍         | 7054/187062 [00:00<00:10, 17082.40it/s]
Adding feature operator:   8%|▊         | 15173/187062 [00:00<00:05, 33559.66it/s]
Adding feature operator:  12%|█▏        | 23320/187062 [00:00<00:03, 46426.59it/s]
Adding feature operator:  17%|█▋        | 31510/187062 [00:00<00:02, 56261.72it/s]
Adding feature operator:  21%|██        | 39685/187062 [00:00<00:02, 63491.62it/s]
Adding feature operator:  25%|██▌       | 47670/187062 [00:01<00:02, 68208.02it/s]
Adding feature operator:  30%|██▉       | 55828/187062 [00:01<00:01, 72108.25it/s]
Adding feature operator:  34%|███▍      | 64005/187062 [00:01<00:01, 74947.61it/s]
Adding feature operator:  39%|███▊      | 72164/187062 [00:01<00:01, 76911.54it/s]
Adding feature operator:  43%|████▎     | 80399/187062 [00:01<00:01, 78525.82it/s]
Adding feature operator:  47%|████▋     | 88560/187062 [00:01<00:01, 79443.49it/s]
Adding feature operator:  52%|█████▏    | 96764/187062 [00:01<00:01, 80215.69it/s]
Adding feature operator:  56%|█████▌    | 104905/187062 [00:01<00:01, 80572.23it/s]
Adding feature operator:  60%|██████    | 113061/187062 [00:01<00:00, 80867.42it/s]
Adding feature operator:  65%|██████▍   | 121220/187062 [00:01<00:00, 81082.53it/s]
Adding feature operator:  69%|██████▉   | 129408/187062 [00:02<00:00, 81319.48it/s]
Adding feature operator:  74%|███████▎  | 137569/187062 [00:02<00:00, 81299.85it/s]
Adding feature operator:  78%|███████▊  | 145760/187062 [00:02<00:00, 81480.55it/s]
Adding feature operator:  82%|████████▏ | 153922/187062 [00:02<00:00, 80910.05it/s]
Adding feature operator:  87%|████████▋ | 162102/187062 [00:02<00:00, 81174.12it/s]
Adding feature operator:  91%|█████████ | 170271/187062 [00:02<00:00, 81326.46it/s]
Adding feature operator:  95%|█████████▌| 178410/187062 [00:02<00:00, 77358.93it/s]
Adding feature operator: 100%|█████████▉| 186190/187062 [00:02<00:00, 52477.13it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63185.42it/s]
[2024-10-12 07:15:42,716] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 07:15:44 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 07:15:44 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 39/6548 [00:00<00:18, 347.24 examples/s]
Map:   1%|▏         | 86/6548 [00:00<00:30, 213.12 examples/s]
Map:   2%|▏         | 125/6548 [00:00<00:24, 260.99 examples/s]
Map:   3%|▎         | 173/6548 [00:00<00:19, 321.66 examples/s]
Map:   3%|▎         | 213/6548 [00:00<00:18, 343.81 examples/s]
Map:   4%|▍         | 264/6548 [00:00<00:18, 337.61 examples/s]
Map:   5%|▍         | 302/6548 [00:00<00:19, 327.09 examples/s]
Map:   5%|▌         | 347/6548 [00:01<00:19, 310.17 examples/s]
Map:   6%|▌         | 380/6548 [00:01<00:20, 308.02 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:17, 350.80 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 325.01 examples/s]
Map:   8%|▊         | 506/6548 [00:01<00:18, 327.26 examples/s]
Map:   9%|▊         | 563/6548 [00:01<00:15, 378.06 examples/s]
Map:   9%|▉         | 606/6548 [00:01<00:15, 388.50 examples/s]
Map:  10%|▉         | 646/6548 [00:01<00:17, 331.28 examples/s]
Map:  11%|█         | 691/6548 [00:02<00:16, 357.01 examples/s]
Map:  11%|█         | 731/6548 [00:02<00:16, 363.20 examples/s]
Map:  12%|█▏        | 785/6548 [00:02<00:14, 403.89 examples/s]
Map:  13%|█▎        | 831/6548 [00:02<00:14, 404.33 examples/s]
Map:  13%|█▎        | 875/6548 [00:02<00:13, 412.23 examples/s]
Map:  14%|█▍        | 920/6548 [00:02<00:15, 360.63 examples/s]
Map:  15%|█▍        | 965/6548 [00:02<00:14, 381.70 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:24, 225.70 examples/s]
Map:  16%|█▌        | 1054/6548 [00:03<00:21, 251.59 examples/s]
Map:  17%|█▋        | 1098/6548 [00:03<00:19, 285.50 examples/s]
Map:  17%|█▋        | 1144/6548 [00:03<00:16, 323.12 examples/s]
Map:  18%|█▊        | 1203/6548 [00:03<00:15, 343.68 examples/s]
Map:  19%|█▉        | 1258/6548 [00:03<00:15, 346.77 examples/s]
Map:  20%|█▉        | 1301/6548 [00:03<00:14, 359.70 examples/s]
Map:  21%|██        | 1347/6548 [00:04<00:15, 325.18 examples/s]
Map:  21%|██        | 1385/6548 [00:04<00:17, 294.74 examples/s]
Map:  22%|██▏       | 1417/6548 [00:04<00:17, 297.70 examples/s]
Map:  22%|██▏       | 1461/6548 [00:04<00:18, 275.55 examples/s]
Map:  23%|██▎       | 1507/6548 [00:04<00:17, 280.49 examples/s]
Map:  24%|██▎       | 1546/6548 [00:04<00:18, 270.27 examples/s]
Map:  24%|██▍       | 1579/6548 [00:04<00:17, 280.62 examples/s]
Map:  25%|██▍       | 1610/6548 [00:05<00:18, 273.10 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:17, 277.47 examples/s]
Map:  26%|██▌       | 1685/6548 [00:05<00:17, 272.44 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:15, 301.67 examples/s]
Map:  27%|██▋       | 1769/6548 [00:05<00:14, 330.71 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 338.15 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 337.42 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 338.67 examples/s]
Map:  30%|██▉       | 1947/6548 [00:06<00:13, 353.18 examples/s]
Map:  30%|███       | 1990/6548 [00:06<00:12, 369.55 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:20, 223.18 examples/s]
Map:  32%|███▏      | 2071/6548 [00:06<00:17, 254.59 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 264.91 examples/s]
Map:  33%|███▎      | 2136/6548 [00:06<00:16, 274.52 examples/s]
Map:  33%|███▎      | 2181/6548 [00:07<00:15, 273.67 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 282.19 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:15, 283.64 examples/s]
Map:  35%|███▌      | 2292/6548 [00:07<00:14, 290.54 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:13, 314.98 examples/s]
Map:  36%|███▌      | 2369/6548 [00:07<00:14, 297.44 examples/s]
Map:  37%|███▋      | 2412/6548 [00:07<00:12, 327.54 examples/s]
Map:  38%|███▊      | 2460/6548 [00:07<00:12, 316.78 examples/s]
Map:  38%|███▊      | 2497/6548 [00:08<00:12, 320.66 examples/s]
Map:  39%|███▉      | 2557/6548 [00:08<00:11, 343.82 examples/s]
Map:  40%|███▉      | 2601/6548 [00:08<00:10, 365.67 examples/s]
Map:  40%|████      | 2640/6548 [00:08<00:10, 370.35 examples/s]
Map:  41%|████      | 2698/6548 [00:08<00:10, 362.55 examples/s]
Map:  42%|████▏     | 2737/6548 [00:08<00:10, 354.78 examples/s]
Map:  42%|████▏     | 2775/6548 [00:08<00:10, 358.12 examples/s]
Map:  43%|████▎     | 2822/6548 [00:08<00:11, 338.72 examples/s]
Map:  44%|████▍     | 2873/6548 [00:09<00:13, 275.43 examples/s]
Map:  44%|████▍     | 2909/6548 [00:09<00:13, 260.48 examples/s]
Map:  45%|████▌     | 2953/6548 [00:09<00:12, 289.75 examples/s]
Map:  46%|████▌     | 2988/6548 [00:09<00:11, 299.94 examples/s]
Map:  46%|████▌     | 3026/6548 [00:10<00:21, 164.15 examples/s]
Map:  47%|████▋     | 3061/6548 [00:10<00:18, 190.38 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 203.90 examples/s]
Map:  48%|████▊     | 3135/6548 [00:10<00:13, 249.75 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:14, 241.10 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 239.42 examples/s]
Map:  50%|████▉     | 3245/6548 [00:10<00:13, 243.45 examples/s]
Map:  50%|█████     | 3277/6548 [00:10<00:12, 259.19 examples/s]
Map:  51%|█████     | 3311/6548 [00:11<00:11, 276.49 examples/s]
Map:  51%|█████     | 3350/6548 [00:11<00:10, 296.87 examples/s]
Map:  52%|█████▏    | 3392/6548 [00:11<00:10, 287.60 examples/s]
Map:  52%|█████▏    | 3425/6548 [00:11<00:10, 296.05 examples/s]
Map:  53%|█████▎    | 3459/6548 [00:11<00:11, 259.09 examples/s]
Map:  53%|█████▎    | 3490/6548 [00:11<00:11, 269.72 examples/s]
Map:  54%|█████▍    | 3541/6548 [00:11<00:09, 328.09 examples/s]
Map:  55%|█████▍    | 3585/6548 [00:11<00:08, 355.61 examples/s]
Map:  55%|█████▌    | 3628/6548 [00:11<00:07, 370.33 examples/s]
Map:  56%|█████▌    | 3667/6548 [00:12<00:07, 364.01 examples/s]
Map:  57%|█████▋    | 3711/6548 [00:12<00:07, 382.68 examples/s]
Map:  57%|█████▋    | 3752/6548 [00:12<00:07, 368.64 examples/s]
Map:  58%|█████▊    | 3799/6548 [00:12<00:06, 393.58 examples/s]
Map:  59%|█████▊    | 3841/6548 [00:12<00:08, 336.20 examples/s]
Map:  59%|█████▉    | 3891/6548 [00:12<00:07, 333.73 examples/s]
Map:  60%|██████    | 3932/6548 [00:12<00:08, 297.93 examples/s]
Map:  61%|██████    | 3976/6548 [00:13<00:08, 320.83 examples/s]
Map:  62%|██████▏   | 4030/6548 [00:13<00:10, 246.61 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 287.97 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 311.91 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:08, 290.11 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:13<00:07, 308.37 examples/s]
Map:  65%|██████▌   | 4260/6548 [00:13<00:06, 346.13 examples/s]
Map:  66%|██████▌   | 4298/6548 [00:14<00:06, 345.76 examples/s]
Map:  66%|██████▋   | 4344/6548 [00:14<00:05, 373.50 examples/s]
Map:  67%|██████▋   | 4398/6548 [00:14<00:05, 366.30 examples/s]
Map:  68%|██████▊   | 4438/6548 [00:14<00:05, 373.64 examples/s]
Map:  68%|██████▊   | 4483/6548 [00:14<00:06, 337.55 examples/s]
Map:  69%|██████▉   | 4526/6548 [00:14<00:06, 319.30 examples/s]
Map:  70%|██████▉   | 4577/6548 [00:14<00:06, 324.27 examples/s]
Map:  71%|███████   | 4626/6548 [00:15<00:06, 313.60 examples/s]
Map:  71%|███████▏  | 4668/6548 [00:15<00:05, 336.45 examples/s]
Map:  72%|███████▏  | 4704/6548 [00:15<00:05, 339.92 examples/s]
Map:  73%|███████▎  | 4750/6548 [00:15<00:05, 354.70 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 405.68 examples/s]
Map:  74%|███████▍  | 4853/6548 [00:15<00:04, 349.40 examples/s]
Map:  75%|███████▍  | 4902/6548 [00:15<00:04, 382.43 examples/s]
Map:  76%|███████▌  | 4970/6548 [00:15<00:03, 403.24 examples/s]
Map:  77%|███████▋  | 5013/6548 [00:16<00:06, 224.02 examples/s]
Map:  77%|███████▋  | 5054/6548 [00:16<00:05, 253.09 examples/s]
Map:  78%|███████▊  | 5099/6548 [00:16<00:05, 262.88 examples/s]
Map:  79%|███████▊  | 5142/6548 [00:16<00:05, 265.05 examples/s]
Map:  79%|███████▉  | 5180/6548 [00:16<00:04, 286.04 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:17<00:04, 285.06 examples/s]
Map:  80%|████████  | 5256/6548 [00:17<00:04, 289.07 examples/s]
Map:  81%|████████  | 5304/6548 [00:17<00:03, 333.16 examples/s]
Map:  82%|████████▏ | 5346/6548 [00:17<00:04, 296.34 examples/s]
Map:  82%|████████▏ | 5383/6548 [00:17<00:03, 311.94 examples/s]
Map:  83%|████████▎ | 5425/6548 [00:17<00:03, 281.35 examples/s]
Map:  83%|████████▎ | 5463/6548 [00:17<00:03, 303.46 examples/s]
Map:  84%|████████▍ | 5500/6548 [00:17<00:03, 317.79 examples/s]
Map:  85%|████████▍ | 5538/6548 [00:18<00:03, 331.78 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:18<00:03, 304.63 examples/s]
Map:  86%|████████▌ | 5638/6548 [00:18<00:02, 354.56 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 317.23 examples/s]
Map:  87%|████████▋ | 5720/6548 [00:18<00:02, 333.13 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 348.50 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 351.57 examples/s]
Map:  89%|████████▉ | 5846/6548 [00:18<00:01, 355.06 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:19<00:01, 357.70 examples/s]
Map:  90%|█████████ | 5923/6548 [00:19<00:01, 364.62 examples/s]
Map:  91%|█████████ | 5967/6548 [00:19<00:01, 335.01 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 228.73 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 261.13 examples/s]
Map:  94%|█████████▎| 6123/6548 [00:19<00:01, 260.31 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:20<00:01, 279.79 examples/s]
Map:  95%|█████████▍| 6206/6548 [00:20<00:01, 300.21 examples/s]
Map:  95%|█████████▌| 6247/6548 [00:20<00:00, 324.03 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 330.41 examples/s]
Map:  97%|█████████▋| 6341/6548 [00:20<00:00, 304.94 examples/s]
Map:  98%|█████████▊| 6385/6548 [00:20<00:00, 330.09 examples/s]
Map:  98%|█████████▊| 6423/6548 [00:20<00:00, 340.18 examples/s]
Map:  99%|█████████▉| 6471/6548 [00:20<00:00, 372.90 examples/s]
Map: 100%|█████████▉| 6529/6548 [00:21<00:00, 359.14 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 307.79 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▎         | 32/903 [00:00<00:03, 282.83 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 317.56 examples/s]
Map:  13%|█▎        | 113/903 [00:00<00:02, 291.29 examples/s]
Map:  16%|█▌        | 143/903 [00:00<00:02, 292.49 examples/s]
Map:  21%|██        | 191/903 [00:00<00:02, 347.58 examples/s]
Map:  25%|██▌       | 230/903 [00:00<00:01, 359.07 examples/s]
Map:  30%|██▉       | 270/903 [00:00<00:01, 369.28 examples/s]
Map:  34%|███▍      | 309/903 [00:00<00:01, 363.65 examples/s]
Map:  39%|███▉      | 350/903 [00:01<00:01, 320.73 examples/s]
Map:  43%|████▎     | 390/903 [00:01<00:01, 258.09 examples/s]
Map:  48%|████▊     | 432/903 [00:01<00:01, 292.33 examples/s]
Map:  53%|█████▎    | 475/903 [00:01<00:01, 288.98 examples/s]
Map:  59%|█████▉    | 531/903 [00:01<00:01, 310.95 examples/s]
Map:  63%|██████▎   | 569/903 [00:01<00:01, 324.86 examples/s]
Map:  68%|██████▊   | 614/903 [00:01<00:00, 346.55 examples/s]
Map:  72%|███████▏  | 653/903 [00:02<00:00, 354.73 examples/s]
Map:  77%|███████▋  | 691/903 [00:02<00:00, 355.37 examples/s]
Map:  81%|████████  | 729/903 [00:02<00:00, 352.32 examples/s]
Map:  86%|████████▌ | 773/903 [00:02<00:00, 371.49 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 342.67 examples/s]
Map:  96%|█████████▌| 868/903 [00:02<00:00, 360.80 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 305.55 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 34/1882 [00:00<00:07, 263.76 examples/s]
Map:   4%|▍         | 79/1882 [00:00<00:05, 358.27 examples/s]
Map:   7%|▋         | 124/1882 [00:00<00:05, 307.84 examples/s]
Map:   9%|▉         | 167/1882 [00:00<00:04, 345.68 examples/s]
Map:  11%|█▏        | 215/1882 [00:00<00:05, 323.88 examples/s]
Map:  14%|█▍        | 261/1882 [00:00<00:04, 358.26 examples/s]
Map:  17%|█▋        | 315/1882 [00:00<00:04, 355.35 examples/s]
Map:  19%|█▉        | 362/1882 [00:01<00:04, 321.24 examples/s]
Map:  21%|██        | 397/1882 [00:01<00:05, 281.79 examples/s]
Map:  23%|██▎       | 433/1882 [00:01<00:04, 293.96 examples/s]
Map:  25%|██▍       | 469/1882 [00:01<00:04, 308.23 examples/s]
Map:  27%|██▋       | 507/1882 [00:01<00:04, 314.89 examples/s]
Map:  30%|██▉       | 561/1882 [00:01<00:04, 327.44 examples/s]
Map:  32%|███▏      | 608/1882 [00:01<00:03, 359.92 examples/s]
Map:  35%|███▍      | 653/1882 [00:01<00:03, 377.15 examples/s]
Map:  37%|███▋      | 695/1882 [00:02<00:03, 388.07 examples/s]
Map:  40%|████      | 758/1882 [00:02<00:02, 394.96 examples/s]
Map:  43%|████▎     | 800/1882 [00:02<00:03, 333.28 examples/s]
Map:  45%|████▍     | 845/1882 [00:02<00:02, 358.90 examples/s]
Map:  48%|████▊     | 900/1882 [00:02<00:02, 357.20 examples/s]
Map:  50%|█████     | 946/1882 [00:02<00:02, 376.50 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 382.61 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 246.18 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 259.50 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 271.31 examples/s]
Map:  61%|██████    | 1139/1882 [00:03<00:02, 279.27 examples/s]
Map:  62%|██████▏   | 1175/1882 [00:03<00:02, 295.24 examples/s]
Map:  65%|██████▌   | 1226/1882 [00:03<00:02, 273.79 examples/s]
Map:  67%|██████▋   | 1259/1882 [00:03<00:02, 285.33 examples/s]
Map:  69%|██████▉   | 1306/1882 [00:04<00:01, 327.33 examples/s]
Map:  72%|███████▏  | 1346/1882 [00:04<00:01, 337.64 examples/s]
Map:  74%|███████▎  | 1386/1882 [00:04<00:01, 305.50 examples/s]
Map:  76%|███████▌  | 1431/1882 [00:04<00:01, 282.38 examples/s]
Map:  78%|███████▊  | 1473/1882 [00:04<00:01, 308.26 examples/s]
Map:  80%|████████  | 1506/1882 [00:04<00:01, 259.03 examples/s]
Map:  82%|████████▏ | 1535/1882 [00:04<00:01, 261.89 examples/s]
Map:  84%|████████▎ | 1575/1882 [00:05<00:01, 288.64 examples/s]
Map:  86%|████████▌ | 1619/1882 [00:05<00:00, 319.18 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 319.89 examples/s]
Map:  91%|█████████ | 1710/1882 [00:05<00:00, 316.69 examples/s]
Map:  93%|█████████▎| 1748/1882 [00:05<00:00, 271.35 examples/s]
Map:  95%|█████████▍| 1787/1882 [00:05<00:00, 263.02 examples/s]
Map:  97%|█████████▋| 1833/1882 [00:05<00:00, 305.09 examples/s]
Map: 100%|█████████▉| 1875/1882 [00:05<00:00, 330.54 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 303.26 examples/s]
10/12/2024 07:16:46 - INFO - __main__ -     ***** Testing *****
10/12/2024 07:16:46 - INFO - __main__ -     Batch size = 8
10/12/2024 07:16:46 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 07:16:47 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 07:16:47 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 07:16:47 - INFO - knnlm -   Reading datastore took 0.929753303527832 s
10/12/2024 07:16:48 - INFO - knnlm -   Moving index to GPU took 0.9073944091796875 s
10/12/2024 07:16:48 - INFO - __main__ -   ******************************break-into
10/12/2024 07:16:48 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 07:16:48 - INFO - __main__ -     Num examples = 236
10/12/2024 07:16:48 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:55,  7.89s/it]
test ppl:   1%|          | 2/236 [00:10<17:35,  4.51s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:12,  3.14s/it]
test ppl:   2%|▏         | 4/236 [00:17<16:21,  4.23s/it]
test ppl:   2%|▏         | 5/236 [00:23<18:37,  4.84s/it]
test ppl:   3%|▎         | 6/236 [00:25<15:16,  3.99s/it]
test ppl:   3%|▎         | 7/236 [00:27<12:36,  3.30s/it]
test ppl:   3%|▎         | 8/236 [00:31<13:46,  3.62s/it]
test ppl:   4%|▍         | 9/236 [00:37<16:25,  4.34s/it]
test ppl:   4%|▍         | 10/236 [00:41<15:13,  4.04s/it]
test ppl:   5%|▍         | 11/236 [00:43<13:14,  3.53s/it]
test ppl:   5%|▌         | 12/236 [00:48<14:35,  3.91s/it]
test ppl:   6%|▌         | 13/236 [00:54<16:47,  4.52s/it]
test ppl:   6%|▌         | 14/236 [01:00<18:16,  4.94s/it]
test ppl:   6%|▋         | 15/236 [01:03<16:25,  4.46s/it]
test ppl:   7%|▋         | 16/236 [01:05<13:29,  3.68s/it]
test ppl:   7%|▋         | 17/236 [01:09<13:22,  3.66s/it]
test ppl:   8%|▊         | 18/236 [01:10<11:10,  3.08s/it]
test ppl:   8%|▊         | 19/236 [01:15<12:38,  3.49s/it]
test ppl:   8%|▊         | 20/236 [01:16<10:43,  2.98s/it]
test ppl:   9%|▉         | 21/236 [01:19<09:55,  2.77s/it]
test ppl:   9%|▉         | 22/236 [01:25<13:15,  3.72s/it]
test ppl:  10%|▉         | 23/236 [01:27<12:01,  3.39s/it]
test ppl:  10%|█         | 24/236 [01:30<11:29,  3.25s/it]
test ppl:  11%|█         | 25/236 [01:32<09:57,  2.83s/it]
test ppl:  11%|█         | 26/236 [01:37<11:56,  3.41s/it]
test ppl:  11%|█▏        | 27/236 [01:41<12:42,  3.65s/it]
test ppl:  12%|█▏        | 28/236 [01:42<10:06,  2.92s/it]
test ppl:  12%|█▏        | 29/236 [01:45<09:28,  2.75s/it]
test ppl:  13%|█▎        | 30/236 [01:46<08:10,  2.38s/it]
test ppl:  13%|█▎        | 31/236 [01:48<07:45,  2.27s/it]
test ppl:  14%|█▎        | 32/236 [01:51<08:43,  2.57s/it]
test ppl:  14%|█▍        | 33/236 [01:57<12:06,  3.58s/it]
test ppl:  14%|█▍        | 34/236 [02:01<12:31,  3.72s/it]
test ppl:  15%|█▍        | 35/236 [02:04<11:16,  3.37s/it]
test ppl:  15%|█▌        | 36/236 [02:10<13:46,  4.13s/it]
test ppl:  16%|█▌        | 37/236 [02:16<15:29,  4.67s/it]
test ppl:  16%|█▌        | 38/236 [02:18<12:50,  3.89s/it]
test ppl:  17%|█▋        | 39/236 [02:19<10:28,  3.19s/it]
test ppl:  17%|█▋        | 40/236 [02:22<09:51,  3.02s/it]
test ppl:  17%|█▋        | 41/236 [02:24<08:41,  2.68s/it]
test ppl:  18%|█▊        | 42/236 [02:30<11:48,  3.65s/it]
test ppl:  18%|█▊        | 43/236 [02:36<13:55,  4.33s/it]
test ppl:  19%|█▊        | 44/236 [02:38<11:35,  3.62s/it]
test ppl:  19%|█▉        | 45/236 [02:40<09:57,  3.13s/it]
test ppl:  19%|█▉        | 46/236 [02:43<10:24,  3.28s/it]
test ppl:  20%|█▉        | 47/236 [02:45<09:12,  2.92s/it]
test ppl:  20%|██        | 48/236 [02:51<11:57,  3.81s/it]
test ppl:  21%|██        | 49/236 [02:55<11:54,  3.82s/it]
test ppl:  21%|██        | 50/236 [03:01<13:49,  4.46s/it]
test ppl:  22%|██▏       | 51/236 [03:06<13:45,  4.46s/it]
test ppl:  22%|██▏       | 52/236 [03:11<15:00,  4.90s/it]
test ppl:  22%|██▏       | 53/236 [03:17<15:08,  4.97s/it]
test ppl:  23%|██▎       | 54/236 [03:18<11:56,  3.94s/it]
test ppl:  23%|██▎       | 55/236 [03:24<13:31,  4.48s/it]
test ppl:  24%|██▎       | 56/236 [03:27<12:29,  4.17s/it]
test ppl:  24%|██▍       | 57/236 [03:30<10:59,  3.69s/it]
test ppl:  25%|██▍       | 58/236 [03:32<09:36,  3.24s/it]
test ppl:  25%|██▌       | 59/236 [03:38<11:55,  4.04s/it]
test ppl:  25%|██▌       | 60/236 [03:40<10:26,  3.56s/it]
test ppl:  26%|██▌       | 61/236 [03:46<12:26,  4.27s/it]
test ppl:  26%|██▋       | 62/236 [03:51<12:18,  4.24s/it]
test ppl:  27%|██▋       | 63/236 [03:53<10:42,  3.72s/it]
test ppl:  27%|██▋       | 64/236 [03:55<08:46,  3.06s/it]
test ppl:  28%|██▊       | 65/236 [03:56<07:14,  2.54s/it]
test ppl:  28%|██▊       | 66/236 [03:59<07:35,  2.68s/it]
test ppl:  28%|██▊       | 67/236 [04:01<07:15,  2.58s/it]
test ppl:  29%|██▉       | 68/236 [04:07<10:01,  3.58s/it]
test ppl:  29%|██▉       | 69/236 [04:12<10:49,  3.89s/it]
test ppl:  30%|██▉       | 70/236 [04:13<08:51,  3.20s/it]
test ppl:  30%|███       | 71/236 [04:18<09:59,  3.63s/it]
test ppl:  31%|███       | 72/236 [04:22<10:06,  3.70s/it]
test ppl:  31%|███       | 73/236 [04:27<10:54,  4.02s/it]
test ppl:  31%|███▏      | 74/236 [04:28<08:49,  3.27s/it]
test ppl:  32%|███▏      | 75/236 [04:34<10:54,  4.06s/it]
test ppl:  32%|███▏      | 76/236 [04:36<09:30,  3.57s/it]
test ppl:  33%|███▎      | 77/236 [04:39<08:26,  3.18s/it]
test ppl:  33%|███▎      | 78/236 [04:40<07:08,  2.71s/it]
test ppl:  33%|███▎      | 79/236 [04:45<08:54,  3.40s/it]
test ppl:  34%|███▍      | 80/236 [04:47<07:37,  2.93s/it]
test ppl:  34%|███▍      | 81/236 [04:53<09:52,  3.82s/it]
test ppl:  35%|███▍      | 82/236 [04:59<11:27,  4.46s/it]
test ppl:  35%|███▌      | 83/236 [05:02<09:53,  3.88s/it]
test ppl:  36%|███▌      | 84/236 [05:03<08:16,  3.26s/it]
test ppl:  36%|███▌      | 85/236 [05:08<08:53,  3.53s/it]
test ppl:  36%|███▋      | 86/236 [05:09<07:35,  3.03s/it]
test ppl:  37%|███▋      | 87/236 [05:12<06:50,  2.76s/it]
test ppl:  37%|███▋      | 88/236 [05:17<09:08,  3.71s/it]
test ppl:  38%|███▊      | 89/236 [05:19<07:49,  3.19s/it]
test ppl:  38%|███▊      | 90/236 [05:25<09:45,  4.01s/it]
test ppl:  39%|███▊      | 91/236 [05:31<10:46,  4.46s/it]
test ppl:  39%|███▉      | 92/236 [05:34<09:32,  3.97s/it]
test ppl:  39%|███▉      | 93/236 [05:40<10:51,  4.56s/it]
test ppl:  40%|███▉      | 94/236 [05:46<11:45,  4.97s/it]
test ppl:  40%|████      | 95/236 [05:48<09:44,  4.15s/it]
test ppl:  41%|████      | 96/236 [05:51<08:51,  3.80s/it]
test ppl:  41%|████      | 97/236 [05:57<10:17,  4.44s/it]
test ppl:  42%|████▏     | 98/236 [06:03<11:15,  4.89s/it]
test ppl:  42%|████▏     | 99/236 [06:09<11:53,  5.21s/it]
test ppl:  42%|████▏     | 100/236 [06:10<09:10,  4.05s/it]
test ppl:  43%|████▎     | 101/236 [06:16<10:11,  4.53s/it]
test ppl:  43%|████▎     | 102/236 [06:19<09:31,  4.27s/it]
test ppl:  44%|████▎     | 103/236 [06:21<08:00,  3.62s/it]
test ppl:  44%|████▍     | 104/236 [06:26<08:24,  3.82s/it]
test ppl:  44%|████▍     | 105/236 [06:30<08:25,  3.86s/it]
test ppl:  45%|████▍     | 106/236 [06:35<09:23,  4.33s/it]
test ppl:  45%|████▌     | 107/236 [06:37<07:51,  3.65s/it]
test ppl:  46%|████▌     | 108/236 [06:43<09:08,  4.28s/it]
test ppl:  46%|████▌     | 109/236 [06:48<09:20,  4.41s/it]
test ppl:  47%|████▋     | 110/236 [06:49<07:29,  3.57s/it]
test ppl:  47%|████▋     | 111/236 [06:53<07:41,  3.69s/it]
test ppl:  47%|████▋     | 112/236 [06:57<07:58,  3.86s/it]
test ppl:  48%|████▊     | 113/236 [06:59<06:37,  3.24s/it]
test ppl:  48%|████▊     | 114/236 [07:03<06:40,  3.28s/it]
test ppl:  49%|████▊     | 115/236 [07:06<06:53,  3.41s/it]
test ppl:  49%|████▉     | 116/236 [07:12<08:08,  4.07s/it]
test ppl:  50%|████▉     | 117/236 [07:14<06:45,  3.41s/it]
test ppl:  50%|█████     | 118/236 [07:18<07:18,  3.72s/it]
test ppl:  50%|█████     | 119/236 [07:20<06:15,  3.21s/it]
test ppl:  51%|█████     | 120/236 [07:22<05:15,  2.72s/it]
test ppl:  51%|█████▏    | 121/236 [07:24<04:43,  2.47s/it]
test ppl:  52%|█████▏    | 122/236 [07:29<06:02,  3.18s/it]
test ppl:  52%|█████▏    | 123/236 [07:31<05:24,  2.87s/it]
test ppl:  53%|█████▎    | 124/236 [07:33<05:07,  2.74s/it]
test ppl:  53%|█████▎    | 125/236 [07:36<04:56,  2.67s/it]
test ppl:  53%|█████▎    | 126/236 [07:42<06:44,  3.68s/it]
test ppl:  54%|█████▍    | 127/236 [07:44<05:43,  3.15s/it]
test ppl:  54%|█████▍    | 128/236 [07:46<05:11,  2.89s/it]
test ppl:  55%|█████▍    | 129/236 [07:49<05:17,  2.97s/it]
test ppl:  55%|█████▌    | 130/236 [07:52<05:17,  2.99s/it]
test ppl:  56%|█████▌    | 131/236 [07:58<06:46,  3.87s/it]
test ppl:  56%|█████▌    | 132/236 [08:00<05:59,  3.46s/it]
test ppl:  56%|█████▋    | 133/236 [08:04<06:10,  3.60s/it]
test ppl:  57%|█████▋    | 134/236 [08:08<06:17,  3.70s/it]
test ppl:  57%|█████▋    | 135/236 [08:14<07:20,  4.36s/it]
test ppl:  58%|█████▊    | 136/236 [08:16<05:44,  3.45s/it]
test ppl:  58%|█████▊    | 137/236 [08:21<06:55,  4.20s/it]
test ppl:  58%|█████▊    | 138/236 [08:27<07:42,  4.72s/it]
test ppl:  59%|█████▉    | 139/236 [08:30<06:36,  4.08s/it]
test ppl:  59%|█████▉    | 140/236 [08:32<05:35,  3.49s/it]
test ppl:  60%|█████▉    | 141/236 [08:35<05:15,  3.32s/it]
test ppl:  60%|██████    | 142/236 [08:37<04:39,  2.97s/it]
test ppl:  61%|██████    | 143/236 [08:43<05:58,  3.86s/it]
test ppl:  61%|██████    | 144/236 [08:46<05:24,  3.53s/it]
test ppl:  61%|██████▏   | 145/236 [08:51<06:15,  4.13s/it]
test ppl:  62%|██████▏   | 146/236 [08:56<06:21,  4.24s/it]
test ppl:  62%|██████▏   | 147/236 [09:02<07:02,  4.75s/it]
test ppl:  63%|██████▎   | 148/236 [09:08<07:31,  5.13s/it]
test ppl:  63%|██████▎   | 149/236 [09:11<06:41,  4.62s/it]
test ppl:  64%|██████▎   | 150/236 [09:15<06:23,  4.46s/it]
test ppl:  64%|██████▍   | 151/236 [09:21<06:57,  4.91s/it]
test ppl:  64%|██████▍   | 152/236 [09:27<07:18,  5.22s/it]
test ppl:  65%|██████▍   | 153/236 [09:33<07:30,  5.42s/it]
test ppl:  65%|██████▌   | 154/236 [09:36<06:13,  4.56s/it]
test ppl:  66%|██████▌   | 155/236 [09:38<05:24,  4.00s/it]
test ppl:  66%|██████▌   | 156/236 [09:41<04:36,  3.46s/it]
test ppl:  67%|██████▋   | 157/236 [09:43<04:05,  3.11s/it]
test ppl:  67%|██████▋   | 158/236 [09:49<05:07,  3.95s/it]
test ppl:  67%|██████▋   | 159/236 [09:55<05:49,  4.53s/it]
test ppl:  68%|██████▊   | 160/236 [09:56<04:28,  3.53s/it]
test ppl:  68%|██████▊   | 161/236 [09:57<03:36,  2.88s/it]
test ppl:  69%|██████▊   | 162/236 [10:00<03:33,  2.89s/it]
test ppl:  69%|██████▉   | 163/236 [10:03<03:19,  2.74s/it]
test ppl:  69%|██████▉   | 164/236 [10:07<03:55,  3.28s/it]
test ppl:  70%|██████▉   | 165/236 [10:11<04:14,  3.59s/it]
test ppl:  70%|███████   | 166/236 [10:13<03:30,  3.01s/it]
test ppl:  71%|███████   | 167/236 [10:15<02:56,  2.55s/it]
test ppl:  71%|███████   | 168/236 [10:20<03:47,  3.35s/it]
test ppl:  72%|███████▏  | 169/236 [10:25<04:17,  3.84s/it]
test ppl:  72%|███████▏  | 170/236 [10:31<04:55,  4.48s/it]
test ppl:  72%|███████▏  | 171/236 [10:32<03:52,  3.58s/it]
test ppl:  73%|███████▎  | 172/236 [10:35<03:24,  3.20s/it]
test ppl:  73%|███████▎  | 173/236 [10:39<03:53,  3.71s/it]
test ppl:  74%|███████▎  | 174/236 [10:43<03:43,  3.61s/it]
test ppl:  74%|███████▍  | 175/236 [10:45<03:08,  3.08s/it]
test ppl:  75%|███████▍  | 176/236 [10:50<03:37,  3.63s/it]
test ppl:  75%|███████▌  | 177/236 [10:56<04:15,  4.33s/it]
test ppl:  75%|███████▌  | 178/236 [11:01<04:39,  4.81s/it]
test ppl:  76%|███████▌  | 179/236 [11:07<04:53,  5.15s/it]
test ppl:  76%|███████▋  | 180/236 [11:11<04:20,  4.64s/it]
test ppl:  77%|███████▋  | 181/236 [11:17<04:36,  5.02s/it]
test ppl:  77%|███████▋  | 182/236 [11:19<03:40,  4.09s/it]
test ppl:  78%|███████▊  | 183/236 [11:21<03:08,  3.55s/it]
test ppl:  78%|███████▊  | 184/236 [11:22<02:31,  2.92s/it]
test ppl:  78%|███████▊  | 185/236 [11:26<02:45,  3.24s/it]
test ppl:  79%|███████▉  | 186/236 [11:32<03:22,  4.04s/it]
test ppl:  79%|███████▉  | 187/236 [11:38<03:46,  4.63s/it]
test ppl:  80%|███████▉  | 188/236 [11:44<04:01,  5.02s/it]
test ppl:  80%|████████  | 189/236 [11:50<04:08,  5.30s/it]
test ppl:  81%|████████  | 190/236 [11:54<03:41,  4.82s/it]
test ppl:  81%|████████  | 191/236 [11:58<03:30,  4.69s/it]
test ppl:  81%|████████▏ | 192/236 [12:01<02:59,  4.07s/it]
test ppl:  82%|████████▏ | 193/236 [12:07<03:19,  4.63s/it]
test ppl:  82%|████████▏ | 194/236 [12:09<02:49,  4.03s/it]
test ppl:  83%|████████▎ | 195/236 [12:13<02:33,  3.74s/it]
test ppl:  83%|████████▎ | 196/236 [12:15<02:09,  3.23s/it]
test ppl:  83%|████████▎ | 197/236 [12:17<01:53,  2.91s/it]
test ppl:  84%|████████▍ | 198/236 [12:23<02:24,  3.81s/it]
test ppl:  84%|████████▍ | 199/236 [12:25<02:08,  3.48s/it]
test ppl:  85%|████████▍ | 200/236 [12:31<02:31,  4.21s/it]
test ppl:  85%|████████▌ | 201/236 [12:33<02:04,  3.56s/it]
test ppl:  86%|████████▌ | 202/236 [12:39<02:21,  4.17s/it]
test ppl:  86%|████████▌ | 203/236 [12:45<02:35,  4.70s/it]
test ppl:  86%|████████▋ | 204/236 [12:47<02:04,  3.90s/it]
test ppl:  87%|████████▋ | 205/236 [12:53<02:20,  4.52s/it]
test ppl:  87%|████████▋ | 206/236 [12:56<02:04,  4.16s/it]
test ppl:  88%|████████▊ | 207/236 [13:02<02:14,  4.63s/it]
test ppl:  88%|████████▊ | 208/236 [13:05<01:55,  4.14s/it]
test ppl:  89%|████████▊ | 209/236 [13:11<02:06,  4.70s/it]
test ppl:  89%|████████▉ | 210/236 [13:13<01:43,  4.00s/it]
test ppl:  89%|████████▉ | 211/236 [13:17<01:41,  4.06s/it]
test ppl:  90%|████████▉ | 212/236 [13:23<01:45,  4.41s/it]
test ppl:  90%|█████████ | 213/236 [13:29<01:51,  4.86s/it]
test ppl:  91%|█████████ | 214/236 [13:30<01:25,  3.90s/it]
test ppl:  91%|█████████ | 215/236 [13:36<01:34,  4.51s/it]
test ppl:  92%|█████████▏| 216/236 [13:38<01:13,  3.66s/it]
test ppl:  92%|█████████▏| 217/236 [13:44<01:22,  4.36s/it]
test ppl:  92%|█████████▏| 218/236 [13:46<01:06,  3.72s/it]
test ppl:  93%|█████████▎| 219/236 [13:52<01:14,  4.40s/it]
test ppl:  93%|█████████▎| 220/236 [13:58<01:17,  4.87s/it]
test ppl:  94%|█████████▎| 221/236 [14:02<01:08,  4.60s/it]
test ppl:  94%|█████████▍| 222/236 [14:08<01:10,  5.00s/it]
test ppl:  94%|█████████▍| 223/236 [14:12<01:01,  4.73s/it]
test ppl:  95%|█████████▍| 224/236 [14:14<00:46,  3.85s/it]
test ppl:  95%|█████████▌| 225/236 [14:20<00:49,  4.47s/it]
test ppl:  96%|█████████▌| 226/236 [14:23<00:40,  4.02s/it]
test ppl:  96%|█████████▌| 227/236 [14:25<00:32,  3.65s/it]
test ppl:  97%|█████████▋| 228/236 [14:27<00:24,  3.06s/it]
test ppl:  97%|█████████▋| 229/236 [14:33<00:27,  3.91s/it]
test ppl:  97%|█████████▋| 230/236 [14:37<00:22,  3.80s/it]
test ppl:  98%|█████████▊| 231/236 [14:40<00:18,  3.67s/it]
test ppl:  98%|█████████▊| 232/236 [14:42<00:12,  3.10s/it]
test ppl:  99%|█████████▊| 233/236 [14:46<00:10,  3.40s/it]
test ppl:  99%|█████████▉| 234/236 [14:47<00:05,  2.85s/it]
test ppl: 100%|█████████▉| 235/236 [14:53<00:03,  3.77s/it]
test ppl: 100%|██████████| 236/236 [14:54<00:00,  2.84s/it]
test ppl: 100%|██████████| 236/236 [14:54<00:00,  3.79s/it]
10/12/2024 07:31:43 - INFO - __main__ -    em: 0.2109
10/12/2024 07:31:43 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.2 10:  em: 0.2109

--------------------------------------------------------------------------------
Running experiment with knn_temp=10, lmbda=0.4, k=16
2024-10-12 07:31:50.293652: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 07:31:50.313095: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 07:31:50.334789: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 07:31:50.341416: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 07:31:50.357382: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 07:31:51.358294: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 07:31:52 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.4, knn_temp=10, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 07:31:52 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:44:46,  2.19it/s]
Adding feature api:   3%|▎         | 6346/187062 [00:00<00:11, 15112.24it/s]
Adding feature api:   7%|▋         | 13672/187062 [00:00<00:05, 29872.22it/s]
Adding feature api:  11%|█         | 20841/187062 [00:00<00:04, 40999.26it/s]
Adding feature api:  15%|█▌        | 28174/187062 [00:00<00:03, 49903.98it/s]
Adding feature api:  19%|█▉        | 35575/187062 [00:00<00:02, 56710.25it/s]
Adding feature api:  23%|██▎       | 42994/187062 [00:01<00:02, 61732.51it/s]
Adding feature api:  27%|██▋       | 50199/187062 [00:01<00:02, 64733.01it/s]
Adding feature api:  31%|███       | 57654/187062 [00:01<00:01, 67613.61it/s]
Adding feature api:  35%|███▍      | 65100/187062 [00:01<00:01, 69635.92it/s]
Adding feature api:  39%|███▉      | 72523/187062 [00:01<00:01, 70998.77it/s]
Adding feature api:  43%|████▎     | 79842/187062 [00:01<00:01, 71385.20it/s]
Adding feature api:  47%|████▋     | 87253/187062 [00:01<00:01, 72194.74it/s]
Adding feature api:  51%|█████     | 94706/187062 [00:01<00:01, 72889.97it/s]
Adding feature api:  55%|█████▍    | 102159/187062 [00:01<00:01, 73377.86it/s]
Adding feature api:  59%|█████▊    | 109577/187062 [00:01<00:01, 73615.41it/s]
Adding feature api:  63%|██████▎   | 116977/187062 [00:02<00:00, 73241.61it/s]
Adding feature api:  67%|██████▋   | 124425/187062 [00:02<00:00, 73608.88it/s]
Adding feature api:  71%|███████   | 131895/187062 [00:02<00:00, 73933.80it/s]
Adding feature api:  74%|███████▍  | 139358/187062 [00:02<00:00, 74141.06it/s]
Adding feature api:  78%|███████▊  | 146782/187062 [00:02<00:00, 73572.73it/s]
Adding feature api:  82%|████████▏ | 154225/187062 [00:02<00:00, 73827.00it/s]
Adding feature api:  86%|████████▋ | 161614/187062 [00:02<00:00, 73840.78it/s]
Adding feature api:  90%|█████████ | 169016/187062 [00:02<00:00, 73891.64it/s]
Adding feature api:  94%|█████████▍| 176408/187062 [00:02<00:00, 73435.00it/s]
Adding feature api:  98%|█████████▊| 183754/187062 [00:03<00:00, 50474.59it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 58001.38it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:30:32,  2.21it/s]
Adding feature datatype:   3%|▎         | 6279/187062 [00:00<00:11, 15067.17it/s]
Adding feature datatype:   7%|▋         | 13507/187062 [00:00<00:05, 29673.20it/s]
Adding feature datatype:  11%|█         | 20470/187062 [00:00<00:04, 40349.71it/s]
Adding feature datatype:  15%|█▍        | 27728/187062 [00:00<00:03, 49252.42it/s]
Adding feature datatype:  19%|█▊        | 34994/187062 [00:00<00:02, 55875.67it/s]
Adding feature datatype:  23%|██▎       | 42262/187062 [00:01<00:02, 60713.02it/s]
Adding feature datatype:  26%|██▋       | 49541/187062 [00:01<00:02, 64229.70it/s]
Adding feature datatype:  30%|███       | 56558/187062 [00:01<00:01, 65901.85it/s]
Adding feature datatype:  34%|███▍      | 63838/187062 [00:01<00:01, 67939.39it/s]
Adding feature datatype:  38%|███▊      | 71174/187062 [00:01<00:01, 69545.59it/s]
Adding feature datatype:  42%|████▏     | 78538/187062 [00:01<00:01, 70763.87it/s]
Adding feature datatype:  46%|████▌     | 85808/187062 [00:01<00:01, 71340.11it/s]
Adding feature datatype:  50%|████▉     | 93130/187062 [00:01<00:01, 71900.53it/s]
Adding feature datatype:  54%|█████▎    | 100395/187062 [00:01<00:01, 71474.13it/s]
Adding feature datatype:  58%|█████▊    | 107733/187062 [00:01<00:01, 72038.90it/s]
Adding feature datatype:  62%|██████▏   | 115050/187062 [00:02<00:00, 72374.92it/s]
Adding feature datatype:  65%|██████▌   | 122404/187062 [00:02<00:00, 72720.41it/s]
Adding feature datatype:  69%|██████▉   | 129738/187062 [00:02<00:00, 72905.10it/s]
Adding feature datatype:  73%|███████▎  | 137042/187062 [00:02<00:00, 72199.56it/s]
Adding feature datatype:  77%|███████▋  | 144345/187062 [00:02<00:00, 72443.95it/s]
Adding feature datatype:  81%|████████  | 151701/187062 [00:02<00:00, 72773.19it/s]
Adding feature datatype:  85%|████████▍ | 158999/187062 [00:02<00:00, 72831.46it/s]
Adding feature datatype:  89%|████████▉ | 166298/187062 [00:02<00:00, 72878.23it/s]
Adding feature datatype:  93%|█████████▎| 173589/187062 [00:02<00:00, 72173.69it/s]
Adding feature datatype:  97%|█████████▋| 180810/187062 [00:03<00:00, 59170.87it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 57305.54it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:16:45,  2.23it/s]
Adding feature literal:   3%|▎         | 6185/187062 [00:00<00:12, 14952.71it/s]
Adding feature literal:   7%|▋         | 13278/187062 [00:00<00:05, 29322.07it/s]
Adding feature literal:  11%|█         | 20342/187062 [00:00<00:04, 40407.85it/s]
Adding feature literal:  15%|█▍        | 27513/187062 [00:00<00:03, 49079.71it/s]
Adding feature literal:  19%|█▊        | 34717/187062 [00:00<00:02, 55589.31it/s]
Adding feature literal:  22%|██▏       | 41930/187062 [00:01<00:02, 60357.66it/s]
Adding feature literal:  26%|██▋       | 49147/187062 [00:01<00:02, 63802.77it/s]
Adding feature literal:  30%|███       | 56370/187062 [00:01<00:01, 66279.45it/s]
Adding feature literal:  34%|███▍      | 63613/187062 [00:01<00:01, 68098.89it/s]
Adding feature literal:  38%|███▊      | 70877/187062 [00:01<00:01, 69444.78it/s]
Adding feature literal:  42%|████▏     | 78089/187062 [00:01<00:01, 70240.29it/s]
Adding feature literal:  46%|████▌     | 85284/187062 [00:01<00:01, 70748.45it/s]
Adding feature literal:  49%|████▉     | 92504/187062 [00:01<00:01, 71181.34it/s]
Adding feature literal:  53%|█████▎    | 99769/187062 [00:01<00:01, 71619.68it/s]
Adding feature literal:  57%|█████▋    | 107016/187062 [00:01<00:01, 71872.88it/s]
Adding feature literal:  61%|██████    | 114260/187062 [00:02<00:01, 72041.09it/s]
Adding feature literal:  65%|██████▍   | 121490/187062 [00:02<00:00, 72116.39it/s]
Adding feature literal:  69%|██████▉   | 128720/187062 [00:02<00:00, 72021.14it/s]
Adding feature literal:  73%|███████▎  | 135996/187062 [00:02<00:00, 72239.51it/s]
Adding feature literal:  77%|███████▋  | 143305/187062 [00:02<00:00, 72493.35it/s]
Adding feature literal:  80%|████████  | 150583/187062 [00:02<00:00, 72577.21it/s]
Adding feature literal:  84%|████████▍ | 157846/187062 [00:02<00:00, 72197.10it/s]
Adding feature literal:  88%|████████▊ | 165078/187062 [00:02<00:00, 72232.03it/s]
Adding feature literal:  92%|█████████▏| 172335/187062 [00:02<00:00, 72330.09it/s]
Adding feature literal:  96%|█████████▌| 179570/187062 [00:02<00:00, 63703.80it/s]
Adding feature literal: 100%|█████████▉| 186129/187062 [00:03<00:00, 46159.73it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 57178.20it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:20:29,  2.23it/s]
Adding feature operator:   3%|▎         | 6300/187062 [00:00<00:11, 15199.80it/s]
Adding feature operator:   7%|▋         | 13532/187062 [00:00<00:05, 29840.83it/s]
Adding feature operator:  11%|█         | 20756/187062 [00:00<00:04, 41204.36it/s]
Adding feature operator:  15%|█▍        | 27990/187062 [00:00<00:03, 49823.57it/s]
Adding feature operator:  19%|█▉        | 35306/187062 [00:00<00:02, 56435.67it/s]
Adding feature operator:  23%|██▎       | 42621/187062 [00:01<00:02, 61251.50it/s]
Adding feature operator:  27%|██▋       | 49906/187062 [00:01<00:02, 64632.15it/s]
Adding feature operator:  31%|███       | 57250/187062 [00:01<00:01, 67219.58it/s]
Adding feature operator:  35%|███▍      | 64552/187062 [00:01<00:01, 68932.80it/s]
Adding feature operator:  38%|███▊      | 71827/187062 [00:01<00:01, 70065.96it/s]
Adding feature operator:  42%|████▏     | 79173/187062 [00:01<00:01, 71075.92it/s]
Adding feature operator:  46%|████▌     | 86443/187062 [00:01<00:01, 71560.24it/s]
Adding feature operator:  50%|█████     | 93760/187062 [00:01<00:01, 72039.60it/s]
Adding feature operator:  54%|█████▍    | 101098/187062 [00:01<00:01, 72438.34it/s]
Adding feature operator:  58%|█████▊    | 108436/187062 [00:01<00:01, 72719.60it/s]
Adding feature operator:  62%|██████▏   | 115766/187062 [00:02<00:00, 72892.39it/s]
Adding feature operator:  66%|██████▌   | 123081/187062 [00:02<00:00, 72868.86it/s]
Adding feature operator:  70%|██████▉   | 130411/187062 [00:02<00:00, 72996.66it/s]
Adding feature operator:  74%|███████▎  | 137753/187062 [00:02<00:00, 73122.87it/s]
Adding feature operator:  78%|███████▊  | 145075/187062 [00:02<00:00, 73124.36it/s]
Adding feature operator:  81%|████████▏ | 152448/187062 [00:02<00:00, 73302.83it/s]
Adding feature operator:  85%|████████▌ | 159798/187062 [00:02<00:00, 73360.50it/s]
Adding feature operator:  89%|████████▉ | 167138/187062 [00:02<00:00, 73288.90it/s]
Adding feature operator:  93%|█████████▎| 174515/187062 [00:02<00:00, 73429.99it/s]
Adding feature operator:  97%|█████████▋| 181860/187062 [00:03<00:00, 55417.25it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 57764.59it/s]
[2024-10-12 07:32:37,950] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 07:32:39 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 07:32:39 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:17, 381.90 examples/s]
Map:   1%|▏         | 83/6548 [00:00<00:31, 204.86 examples/s]
Map:   2%|▏         | 125/6548 [00:00<00:24, 261.47 examples/s]
Map:   3%|▎         | 173/6548 [00:00<00:19, 322.35 examples/s]
Map:   4%|▎         | 231/6548 [00:00<00:18, 339.38 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:18, 344.67 examples/s]
Map:   5%|▌         | 334/6548 [00:01<00:18, 329.41 examples/s]
Map:   6%|▌         | 390/6548 [00:01<00:18, 340.85 examples/s]
Map:   7%|▋         | 433/6548 [00:01<00:17, 359.20 examples/s]
Map:   7%|▋         | 473/6548 [00:01<00:18, 323.46 examples/s]
Map:   8%|▊         | 512/6548 [00:01<00:17, 337.22 examples/s]
Map:   9%|▊         | 565/6548 [00:01<00:15, 384.77 examples/s]
Map:   9%|▉         | 607/6548 [00:01<00:15, 374.28 examples/s]
Map:  10%|█         | 658/6548 [00:02<00:18, 314.20 examples/s]
Map:  11%|█         | 703/6548 [00:02<00:16, 344.40 examples/s]
Map:  12%|█▏        | 762/6548 [00:02<00:16, 357.50 examples/s]
Map:  12%|█▏        | 813/6548 [00:02<00:14, 391.41 examples/s]
Map:  13%|█▎        | 873/6548 [00:02<00:14, 379.31 examples/s]
Map:  14%|█▍        | 920/6548 [00:02<00:16, 349.34 examples/s]
Map:  15%|█▍        | 969/6548 [00:02<00:14, 376.71 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:24, 230.41 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 256.08 examples/s]
Map:  17%|█▋        | 1100/6548 [00:03<00:18, 290.47 examples/s]
Map:  18%|█▊        | 1149/6548 [00:03<00:16, 330.45 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 345.05 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:14, 354.83 examples/s]
Map:  20%|█▉        | 1294/6548 [00:03<00:14, 368.08 examples/s]
Map:  20%|██        | 1334/6548 [00:04<00:16, 316.82 examples/s]
Map:  21%|██        | 1375/6548 [00:04<00:17, 300.48 examples/s]
Map:  22%|██▏       | 1430/6548 [00:04<00:16, 314.63 examples/s]
Map:  22%|██▏       | 1466/6548 [00:04<00:18, 275.83 examples/s]
Map:  23%|██▎       | 1497/6548 [00:04<00:17, 281.07 examples/s]
Map:  23%|██▎       | 1533/6548 [00:04<00:17, 289.99 examples/s]
Map:  24%|██▍       | 1566/6548 [00:04<00:16, 299.26 examples/s]
Map:  24%|██▍       | 1598/6548 [00:04<00:16, 302.17 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:17, 285.85 examples/s]
Map:  26%|██▌       | 1689/6548 [00:05<00:17, 284.00 examples/s]
Map:  26%|██▋       | 1728/6548 [00:05<00:15, 305.91 examples/s]
Map:  27%|██▋       | 1775/6548 [00:05<00:13, 344.61 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:13, 344.36 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 355.70 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 352.15 examples/s]
Map:  30%|██▉       | 1958/6548 [00:06<00:13, 343.98 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:19, 236.12 examples/s]
Map:  31%|███       | 2041/6548 [00:06<00:18, 242.98 examples/s]
Map:  32%|███▏      | 2081/6548 [00:06<00:16, 271.80 examples/s]
Map:  32%|███▏      | 2124/6548 [00:06<00:15, 288.28 examples/s]
Map:  33%|███▎      | 2165/6548 [00:06<00:17, 256.16 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 275.04 examples/s]
Map:  34%|███▍      | 2254/6548 [00:07<00:16, 267.75 examples/s]
Map:  35%|███▌      | 2304/6548 [00:07<00:15, 275.66 examples/s]
Map:  36%|███▌      | 2344/6548 [00:07<00:13, 300.43 examples/s]
Map:  36%|███▋      | 2389/6548 [00:07<00:14, 282.63 examples/s]
Map:  37%|███▋      | 2431/6548 [00:07<00:13, 310.51 examples/s]
Map:  38%|███▊      | 2477/6548 [00:07<00:13, 300.22 examples/s]
Map:  38%|███▊      | 2517/6548 [00:08<00:13, 308.30 examples/s]
Map:  39%|███▉      | 2562/6548 [00:08<00:11, 338.29 examples/s]
Map:  40%|███▉      | 2608/6548 [00:08<00:10, 365.49 examples/s]
Map:  41%|████      | 2654/6548 [00:08<00:10, 386.30 examples/s]
Map:  41%|████▏     | 2704/6548 [00:08<00:10, 358.84 examples/s]
Map:  42%|████▏     | 2742/6548 [00:08<00:10, 361.07 examples/s]
Map:  43%|████▎     | 2788/6548 [00:08<00:11, 337.06 examples/s]
Map:  43%|████▎     | 2828/6548 [00:09<00:13, 275.63 examples/s]
Map:  44%|████▎     | 2862/6548 [00:09<00:12, 287.22 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 294.31 examples/s]
Map:  45%|████▌     | 2949/6548 [00:09<00:12, 289.73 examples/s]
Map:  46%|████▌     | 2987/6548 [00:09<00:11, 309.11 examples/s]
Map:  46%|████▌     | 3027/6548 [00:10<00:21, 167.35 examples/s]
Map:  47%|████▋     | 3064/6548 [00:10<00:17, 197.08 examples/s]
Map:  47%|████▋     | 3099/6548 [00:10<00:15, 222.37 examples/s]
Map:  48%|████▊     | 3140/6548 [00:10<00:13, 256.71 examples/s]
Map:  49%|████▊     | 3183/6548 [00:10<00:13, 242.80 examples/s]
Map:  49%|████▉     | 3216/6548 [00:10<00:13, 244.13 examples/s]
Map:  50%|████▉     | 3247/6548 [00:10<00:12, 257.60 examples/s]
Map:  50%|█████     | 3284/6548 [00:10<00:11, 277.57 examples/s]
Map:  51%|█████     | 3326/6548 [00:11<00:10, 311.60 examples/s]
Map:  52%|█████▏    | 3378/6548 [00:11<00:10, 314.24 examples/s]
Map:  52%|█████▏    | 3419/6548 [00:11<00:11, 282.02 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 269.05 examples/s]
Map:  53%|█████▎    | 3485/6548 [00:11<00:11, 274.28 examples/s]
Map:  54%|█████▍    | 3530/6548 [00:11<00:09, 313.89 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:11<00:08, 344.03 examples/s]
Map:  55%|█████▌    | 3622/6548 [00:11<00:07, 369.87 examples/s]
Map:  56%|█████▌    | 3683/6548 [00:12<00:07, 380.15 examples/s]
Map:  57%|█████▋    | 3727/6548 [00:12<00:07, 394.48 examples/s]
Map:  58%|█████▊    | 3787/6548 [00:12<00:07, 393.73 examples/s]
Map:  58%|█████▊    | 3830/6548 [00:12<00:08, 339.03 examples/s]
Map:  59%|█████▉    | 3871/6548 [00:12<00:08, 317.17 examples/s]
Map:  60%|█████▉    | 3914/6548 [00:12<00:07, 329.85 examples/s]
Map:  60%|██████    | 3955/6548 [00:12<00:08, 302.87 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 226.06 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 281.40 examples/s]
Map:  63%|██████▎   | 4096/6548 [00:13<00:07, 308.49 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 318.61 examples/s]
Map:  64%|██████▍   | 4193/6548 [00:13<00:07, 319.72 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:07, 327.90 examples/s]
Map:  65%|██████▌   | 4282/6548 [00:13<00:06, 354.88 examples/s]
Map:  66%|██████▌   | 4325/6548 [00:14<00:06, 366.34 examples/s]
Map:  67%|██████▋   | 4367/6548 [00:14<00:06, 359.90 examples/s]
Map:  68%|██████▊   | 4431/6548 [00:14<00:05, 374.49 examples/s]
Map:  68%|██████▊   | 4478/6548 [00:14<00:06, 336.75 examples/s]
Map:  69%|██████▉   | 4523/6548 [00:14<00:06, 322.11 examples/s]
Map:  70%|██████▉   | 4577/6548 [00:14<00:05, 329.94 examples/s]
Map:  71%|███████   | 4624/6548 [00:15<00:06, 318.26 examples/s]
Map:  71%|███████▏  | 4668/6548 [00:15<00:05, 332.71 examples/s]
Map:  72%|███████▏  | 4705/6548 [00:15<00:05, 339.69 examples/s]
Map:  73%|███████▎  | 4751/6548 [00:15<00:05, 355.56 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 408.21 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 396.03 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 361.71 examples/s]
Map:  76%|███████▌  | 4953/6548 [00:15<00:04, 389.98 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:16<00:06, 247.15 examples/s]
Map:  77%|███████▋  | 5041/6548 [00:16<00:05, 268.36 examples/s]
Map:  78%|███████▊  | 5076/6548 [00:16<00:05, 280.58 examples/s]
Map:  78%|███████▊  | 5122/6548 [00:16<00:04, 285.36 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 291.04 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 289.47 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:16<00:04, 302.92 examples/s]
Map:  80%|████████  | 5256/6548 [00:17<00:04, 304.43 examples/s]
Map:  81%|████████  | 5311/6548 [00:17<00:03, 367.69 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 314.67 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 303.07 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 331.53 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 327.98 examples/s]
Map:  85%|████████▍ | 5547/6548 [00:17<00:02, 343.28 examples/s]
Map:  85%|████████▌ | 5584/6548 [00:18<00:03, 308.75 examples/s]
Map:  86%|████████▌ | 5631/6548 [00:18<00:02, 344.30 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 297.46 examples/s]
Map:  87%|████████▋ | 5722/6548 [00:18<00:02, 315.54 examples/s]
Map:  88%|████████▊ | 5765/6548 [00:18<00:02, 340.57 examples/s]
Map:  89%|████████▊ | 5802/6548 [00:18<00:02, 345.63 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:01, 353.92 examples/s]
Map:  90%|████████▉ | 5889/6548 [00:18<00:01, 363.88 examples/s]
Map:  91%|█████████ | 5927/6548 [00:18<00:01, 367.14 examples/s]
Map:  91%|█████████ | 5972/6548 [00:19<00:01, 341.04 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 237.81 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 269.59 examples/s]
Map:  94%|█████████▎| 6124/6548 [00:19<00:01, 268.96 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:19<00:01, 285.29 examples/s]
Map:  95%|█████████▍| 6216/6548 [00:20<00:01, 297.72 examples/s]
Map:  96%|█████████▌| 6255/6548 [00:20<00:00, 313.75 examples/s]
Map:  96%|█████████▌| 6293/6548 [00:20<00:00, 323.14 examples/s]
Map:  97%|█████████▋| 6329/6548 [00:20<00:00, 317.16 examples/s]
Map:  97%|█████████▋| 6368/6548 [00:20<00:00, 331.48 examples/s]
Map:  98%|█████████▊| 6412/6548 [00:20<00:00, 356.94 examples/s]
Map:  99%|█████████▊| 6459/6548 [00:20<00:00, 385.57 examples/s]
Map:  99%|█████████▉| 6515/6548 [00:20<00:00, 377.44 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 310.67 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 319.14 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 315.95 examples/s]
Map:  11%|█▏        | 103/903 [00:00<00:02, 319.98 examples/s]
Map:  16%|█▌        | 143/903 [00:00<00:02, 343.87 examples/s]
Map:  21%|██▏       | 192/903 [00:00<00:01, 391.17 examples/s]
Map:  26%|██▌       | 235/903 [00:00<00:01, 397.88 examples/s]
Map:  31%|███       | 276/903 [00:00<00:01, 398.78 examples/s]
Map:  36%|███▌      | 325/903 [00:00<00:01, 364.03 examples/s]
Map:  41%|████      | 368/903 [00:01<00:01, 315.88 examples/s]
Map:  46%|████▌     | 414/903 [00:01<00:01, 310.58 examples/s]
Map:  50%|█████     | 455/903 [00:01<00:01, 296.47 examples/s]
Map:  54%|█████▍    | 486/903 [00:01<00:01, 293.90 examples/s]
Map:  58%|█████▊    | 527/903 [00:01<00:01, 320.70 examples/s]
Map:  63%|██████▎   | 566/903 [00:01<00:01, 332.82 examples/s]
Map:  68%|██████▊   | 613/903 [00:01<00:00, 364.77 examples/s]
Map:  74%|███████▎  | 665/903 [00:01<00:00, 344.38 examples/s]
Map:  78%|███████▊  | 706/903 [00:02<00:00, 353.90 examples/s]
Map:  84%|████████▎ | 756/903 [00:02<00:00, 389.15 examples/s]
Map:  90%|████████▉ | 811/903 [00:02<00:00, 375.72 examples/s]
Map:  95%|█████████▍| 854/903 [00:02<00:00, 382.05 examples/s]
Map:  99%|█████████▉| 898/903 [00:02<00:00, 333.35 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 318.30 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 35/1882 [00:00<00:06, 273.83 examples/s]
Map:   4%|▍         | 74/1882 [00:00<00:05, 327.20 examples/s]
Map:   6%|▋         | 122/1882 [00:00<00:05, 319.55 examples/s]
Map:   9%|▊         | 164/1882 [00:00<00:04, 347.47 examples/s]
Map:  11%|█         | 203/1882 [00:00<00:05, 329.52 examples/s]
Map:  13%|█▎        | 248/1882 [00:00<00:04, 362.67 examples/s]
Map:  15%|█▌        | 287/1882 [00:00<00:04, 360.93 examples/s]
Map:  17%|█▋        | 325/1882 [00:00<00:04, 355.72 examples/s]
Map:  19%|█▉        | 364/1882 [00:01<00:04, 315.09 examples/s]
Map:  21%|██        | 397/1882 [00:01<00:05, 273.31 examples/s]
Map:  23%|██▎       | 427/1882 [00:01<00:05, 277.87 examples/s]
Map:  24%|██▍       | 461/1882 [00:01<00:05, 281.11 examples/s]
Map:  27%|██▋       | 504/1882 [00:01<00:04, 312.17 examples/s]
Map:  29%|██▉       | 549/1882 [00:01<00:04, 293.59 examples/s]
Map:  31%|███       | 587/1882 [00:01<00:04, 312.80 examples/s]
Map:  34%|███▍      | 644/1882 [00:01<00:03, 374.83 examples/s]
Map:  37%|███▋      | 704/1882 [00:02<00:03, 369.23 examples/s]
Map:  39%|███▉      | 743/1882 [00:02<00:03, 372.73 examples/s]
Map:  42%|████▏     | 795/1882 [00:02<00:03, 358.00 examples/s]
Map:  45%|████▌     | 848/1882 [00:02<00:02, 350.70 examples/s]
Map:  47%|████▋     | 891/1882 [00:02<00:02, 363.61 examples/s]
Map:  49%|████▉     | 931/1882 [00:02<00:02, 363.97 examples/s]
Map:  52%|█████▏    | 982/1882 [00:02<00:02, 398.93 examples/s]
Map:  55%|█████▌    | 1039/1882 [00:03<00:03, 253.01 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 264.76 examples/s]
Map:  59%|█████▉    | 1107/1882 [00:03<00:02, 277.82 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 286.72 examples/s]
Map:  63%|██████▎   | 1177/1882 [00:03<00:02, 278.49 examples/s]
Map:  65%|██████▌   | 1229/1882 [00:03<00:02, 298.13 examples/s]
Map:  67%|██████▋   | 1266/1882 [00:03<00:01, 313.49 examples/s]
Map:  69%|██████▉   | 1307/1882 [00:04<00:01, 336.62 examples/s]
Map:  72%|███████▏  | 1347/1882 [00:04<00:01, 331.93 examples/s]
Map:  74%|███████▍  | 1391/1882 [00:04<00:01, 315.79 examples/s]
Map:  76%|███████▌  | 1429/1882 [00:04<00:01, 281.18 examples/s]
Map:  78%|███████▊  | 1471/1882 [00:04<00:01, 306.10 examples/s]
Map:  81%|████████  | 1517/1882 [00:04<00:01, 273.49 examples/s]
Map:  82%|████████▏ | 1549/1882 [00:04<00:01, 282.50 examples/s]
Map:  84%|████████▍ | 1589/1882 [00:05<00:00, 308.93 examples/s]
Map:  87%|████████▋ | 1635/1882 [00:05<00:00, 343.11 examples/s]
Map:  89%|████████▉ | 1673/1882 [00:05<00:00, 306.24 examples/s]
Map:  91%|█████████ | 1713/1882 [00:05<00:00, 325.88 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 279.21 examples/s]
Map:  95%|█████████▍| 1785/1882 [00:05<00:00, 283.26 examples/s]
Map:  97%|█████████▋| 1830/1882 [00:05<00:00, 322.23 examples/s]
Map: 100%|█████████▉| 1874/1882 [00:05<00:00, 351.61 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 306.72 examples/s]
10/12/2024 07:33:41 - INFO - __main__ -     ***** Testing *****
10/12/2024 07:33:41 - INFO - __main__ -     Batch size = 8
10/12/2024 07:33:41 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 07:33:42 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 07:33:42 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 07:33:43 - INFO - knnlm -   Reading datastore took 0.9592435359954834 s
10/12/2024 07:33:43 - INFO - knnlm -   Moving index to GPU took 0.9011495113372803 s
10/12/2024 07:33:43 - INFO - __main__ -   ******************************break-into
10/12/2024 07:33:43 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 07:33:43 - INFO - __main__ -     Num examples = 236
10/12/2024 07:33:43 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<31:42,  8.10s/it]
test ppl:   1%|          | 2/236 [00:09<17:01,  4.37s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:52,  3.06s/it]
test ppl:   2%|▏         | 4/236 [00:17<16:09,  4.18s/it]
test ppl:   2%|▏         | 5/236 [00:23<18:31,  4.81s/it]
test ppl:   3%|▎         | 6/236 [00:27<17:30,  4.57s/it]
test ppl:   3%|▎         | 7/236 [00:33<19:09,  5.02s/it]
test ppl:   3%|▎         | 8/236 [00:39<20:09,  5.30s/it]
test ppl:   4%|▍         | 9/236 [00:40<15:50,  4.19s/it]
test ppl:   4%|▍         | 10/236 [00:43<14:24,  3.83s/it]
test ppl:   5%|▍         | 11/236 [00:46<12:58,  3.46s/it]
test ppl:   5%|▌         | 12/236 [00:52<15:42,  4.21s/it]
test ppl:   6%|▌         | 13/236 [00:58<17:35,  4.73s/it]
test ppl:   6%|▌         | 14/236 [01:04<18:52,  5.10s/it]
test ppl:   6%|▋         | 15/236 [01:07<16:34,  4.50s/it]
test ppl:   7%|▋         | 16/236 [01:09<13:36,  3.71s/it]
test ppl:   7%|▋         | 17/236 [01:12<13:27,  3.69s/it]
test ppl:   8%|▊         | 18/236 [01:14<11:14,  3.09s/it]
test ppl:   8%|▊         | 19/236 [01:20<14:14,  3.94s/it]
test ppl:   8%|▊         | 20/236 [01:23<12:41,  3.53s/it]
test ppl:   9%|▉         | 21/236 [01:29<15:12,  4.25s/it]
test ppl:   9%|▉         | 22/236 [01:34<16:56,  4.75s/it]
test ppl:  10%|▉         | 23/236 [01:37<14:38,  4.12s/it]
test ppl:  10%|█         | 24/236 [01:40<12:51,  3.64s/it]
test ppl:  11%|█         | 25/236 [01:41<10:49,  3.08s/it]
test ppl:  11%|█         | 26/236 [01:47<13:24,  3.83s/it]
test ppl:  11%|█▏        | 27/236 [01:50<12:57,  3.72s/it]
test ppl:  12%|█▏        | 28/236 [01:52<10:47,  3.11s/it]
test ppl:  12%|█▏        | 29/236 [01:54<09:52,  2.86s/it]
test ppl:  13%|█▎        | 30/236 [01:56<08:27,  2.46s/it]
test ppl:  13%|█▎        | 31/236 [01:58<07:57,  2.33s/it]
test ppl:  14%|█▎        | 32/236 [02:03<10:26,  3.07s/it]
test ppl:  14%|█▍        | 33/236 [02:09<13:18,  3.93s/it]
test ppl:  14%|█▍        | 34/236 [02:13<13:20,  3.96s/it]
test ppl:  15%|█▍        | 35/236 [02:19<15:14,  4.55s/it]
test ppl:  15%|█▌        | 36/236 [02:25<16:31,  4.96s/it]
test ppl:  16%|█▌        | 37/236 [02:31<17:26,  5.26s/it]
test ppl:  16%|█▌        | 38/236 [02:33<14:12,  4.31s/it]
test ppl:  17%|█▋        | 39/236 [02:34<11:38,  3.54s/it]
test ppl:  17%|█▋        | 40/236 [02:37<11:02,  3.38s/it]
test ppl:  17%|█▋        | 41/236 [02:39<09:31,  2.93s/it]
test ppl:  18%|█▊        | 42/236 [02:45<12:26,  3.85s/it]
test ppl:  18%|█▊        | 43/236 [02:51<14:23,  4.47s/it]
test ppl:  19%|█▊        | 44/236 [02:54<12:49,  4.01s/it]
test ppl:  19%|█▉        | 45/236 [02:56<10:49,  3.40s/it]
test ppl:  19%|█▉        | 46/236 [03:02<13:13,  4.18s/it]
test ppl:  20%|█▉        | 47/236 [03:04<10:40,  3.39s/it]
test ppl:  20%|██        | 48/236 [03:10<12:58,  4.14s/it]
test ppl:  21%|██        | 49/236 [03:13<12:38,  4.05s/it]
test ppl:  21%|██        | 50/236 [03:19<14:22,  4.63s/it]
test ppl:  22%|██▏       | 51/236 [03:23<13:33,  4.40s/it]
test ppl:  22%|██▏       | 52/236 [03:29<14:53,  4.86s/it]
test ppl:  22%|██▏       | 53/236 [03:33<14:17,  4.69s/it]
test ppl:  23%|██▎       | 54/236 [03:35<11:21,  3.74s/it]
test ppl:  23%|██▎       | 55/236 [03:41<13:03,  4.33s/it]
test ppl:  24%|██▎       | 56/236 [03:47<14:27,  4.82s/it]
test ppl:  24%|██▍       | 57/236 [03:50<13:27,  4.51s/it]
test ppl:  25%|██▍       | 58/236 [03:53<11:19,  3.82s/it]
test ppl:  25%|██▌       | 59/236 [03:59<13:08,  4.45s/it]
test ppl:  25%|██▌       | 60/236 [04:02<12:04,  4.11s/it]
test ppl:  26%|██▌       | 61/236 [04:04<10:40,  3.66s/it]
test ppl:  26%|██▋       | 62/236 [04:09<11:04,  3.82s/it]
test ppl:  27%|██▋       | 63/236 [04:11<09:51,  3.42s/it]
test ppl:  27%|██▋       | 64/236 [04:14<09:00,  3.15s/it]
test ppl:  28%|██▊       | 65/236 [04:15<07:25,  2.60s/it]
test ppl:  28%|██▊       | 66/236 [04:18<07:48,  2.76s/it]
test ppl:  28%|██▊       | 67/236 [04:24<10:28,  3.72s/it]
test ppl:  29%|██▉       | 68/236 [04:30<12:17,  4.39s/it]
test ppl:  29%|██▉       | 69/236 [04:36<13:31,  4.86s/it]
test ppl:  30%|██▉       | 70/236 [04:37<10:29,  3.79s/it]
test ppl:  30%|███       | 71/236 [04:41<10:07,  3.68s/it]
test ppl:  31%|███       | 72/236 [04:45<10:12,  3.74s/it]
test ppl:  31%|███       | 73/236 [04:51<11:56,  4.40s/it]
test ppl:  31%|███▏      | 74/236 [04:56<13:07,  4.86s/it]
test ppl:  32%|███▏      | 75/236 [05:02<13:55,  5.19s/it]
test ppl:  32%|███▏      | 76/236 [05:06<12:34,  4.72s/it]
test ppl:  33%|███▎      | 77/236 [05:08<10:35,  3.99s/it]
test ppl:  33%|███▎      | 78/236 [05:10<08:33,  3.25s/it]
test ppl:  33%|███▎      | 79/236 [05:15<09:38,  3.68s/it]
test ppl:  34%|███▍      | 80/236 [05:16<07:54,  3.04s/it]
test ppl:  34%|███▍      | 81/236 [05:22<10:05,  3.91s/it]
test ppl:  35%|███▍      | 82/236 [05:28<11:38,  4.54s/it]
test ppl:  35%|███▌      | 83/236 [05:33<11:57,  4.69s/it]
test ppl:  36%|███▌      | 84/236 [05:35<10:04,  3.98s/it]
test ppl:  36%|███▌      | 85/236 [05:40<10:12,  4.06s/it]
test ppl:  36%|███▋      | 86/236 [05:42<09:00,  3.60s/it]
test ppl:  37%|███▋      | 87/236 [05:45<08:13,  3.31s/it]
test ppl:  37%|███▋      | 88/236 [05:51<10:06,  4.10s/it]
test ppl:  38%|███▊      | 89/236 [05:53<08:29,  3.47s/it]
test ppl:  38%|███▊      | 90/236 [05:59<10:14,  4.21s/it]
test ppl:  39%|███▊      | 91/236 [06:03<10:19,  4.27s/it]
test ppl:  39%|███▉      | 92/236 [06:06<09:13,  3.84s/it]
test ppl:  39%|███▉      | 93/236 [06:12<10:39,  4.47s/it]
test ppl:  40%|███▉      | 94/236 [06:18<11:38,  4.92s/it]
test ppl:  40%|████      | 95/236 [06:21<10:33,  4.49s/it]
test ppl:  41%|████      | 96/236 [06:25<09:54,  4.24s/it]
test ppl:  41%|████      | 97/236 [06:31<10:59,  4.75s/it]
test ppl:  42%|████▏     | 98/236 [06:37<11:44,  5.11s/it]
test ppl:  42%|████▏     | 99/236 [06:43<12:14,  5.36s/it]
test ppl:  42%|████▏     | 100/236 [06:44<09:21,  4.13s/it]
test ppl:  43%|████▎     | 101/236 [06:50<10:30,  4.67s/it]
test ppl:  43%|████▎     | 102/236 [06:54<09:59,  4.47s/it]
test ppl:  44%|████▎     | 103/236 [06:55<07:53,  3.56s/it]
test ppl:  44%|████▍     | 104/236 [07:00<08:16,  3.77s/it]
test ppl:  44%|████▍     | 105/236 [07:04<08:39,  3.97s/it]
test ppl:  45%|████▍     | 106/236 [07:10<09:34,  4.42s/it]
test ppl:  45%|████▌     | 107/236 [07:12<08:07,  3.78s/it]
test ppl:  46%|████▌     | 108/236 [07:18<09:19,  4.37s/it]
test ppl:  46%|████▌     | 109/236 [07:22<09:02,  4.27s/it]
test ppl:  47%|████▋     | 110/236 [07:23<07:18,  3.48s/it]
test ppl:  47%|████▋     | 111/236 [07:27<07:35,  3.64s/it]
test ppl:  47%|████▋     | 112/236 [07:33<08:56,  4.33s/it]
test ppl:  48%|████▊     | 113/236 [07:35<07:18,  3.56s/it]
test ppl:  48%|████▊     | 114/236 [07:38<07:08,  3.51s/it]
test ppl:  49%|████▊     | 115/236 [07:44<08:32,  4.24s/it]
test ppl:  49%|████▉     | 116/236 [07:50<09:29,  4.75s/it]
test ppl:  50%|████▉     | 117/236 [07:52<07:42,  3.88s/it]
test ppl:  50%|█████     | 118/236 [07:58<08:46,  4.46s/it]
test ppl:  50%|█████     | 119/236 [08:00<07:32,  3.87s/it]
test ppl:  51%|█████     | 120/236 [08:03<06:26,  3.34s/it]
test ppl:  51%|█████▏    | 121/236 [08:08<07:52,  4.11s/it]
test ppl:  52%|█████▏    | 122/236 [08:13<08:13,  4.33s/it]
test ppl:  52%|█████▏    | 123/236 [08:16<07:02,  3.74s/it]
test ppl:  53%|█████▎    | 124/236 [08:19<06:41,  3.59s/it]
test ppl:  53%|█████▎    | 125/236 [08:21<06:02,  3.27s/it]
test ppl:  53%|█████▎    | 126/236 [08:25<06:12,  3.39s/it]
test ppl:  54%|█████▍    | 127/236 [08:27<05:27,  3.01s/it]
test ppl:  54%|█████▍    | 128/236 [08:32<06:12,  3.44s/it]
test ppl:  55%|█████▍    | 129/236 [08:34<05:37,  3.15s/it]
test ppl:  55%|█████▌    | 130/236 [08:38<05:45,  3.25s/it]
test ppl:  56%|█████▌    | 131/236 [08:44<07:06,  4.06s/it]
test ppl:  56%|█████▌    | 132/236 [08:46<06:13,  3.59s/it]
test ppl:  56%|█████▋    | 133/236 [08:50<06:22,  3.72s/it]
test ppl:  57%|█████▋    | 134/236 [08:54<06:11,  3.64s/it]
test ppl:  57%|█████▋    | 135/236 [08:58<06:33,  3.90s/it]
test ppl:  58%|█████▊    | 136/236 [08:59<05:13,  3.13s/it]
test ppl:  58%|█████▊    | 137/236 [09:05<06:34,  3.99s/it]
test ppl:  58%|█████▊    | 138/236 [09:11<07:28,  4.58s/it]
test ppl:  59%|█████▉    | 139/236 [09:14<06:27,  3.99s/it]
test ppl:  59%|█████▉    | 140/236 [09:16<05:21,  3.35s/it]
test ppl:  60%|█████▉    | 141/236 [09:19<05:06,  3.22s/it]
test ppl:  60%|██████    | 142/236 [09:25<06:19,  4.04s/it]
test ppl:  61%|██████    | 143/236 [09:29<06:11,  4.00s/it]
test ppl:  61%|██████    | 144/236 [09:31<05:32,  3.61s/it]
test ppl:  61%|██████▏   | 145/236 [09:37<06:31,  4.31s/it]
test ppl:  62%|██████▏   | 146/236 [09:43<07:11,  4.79s/it]
test ppl:  62%|██████▏   | 147/236 [09:49<07:37,  5.13s/it]
test ppl:  63%|██████▎   | 148/236 [09:55<07:56,  5.42s/it]
test ppl:  63%|██████▎   | 149/236 [09:58<06:47,  4.69s/it]
test ppl:  64%|██████▎   | 150/236 [10:04<07:15,  5.06s/it]
test ppl:  64%|██████▍   | 151/236 [10:10<07:33,  5.34s/it]
test ppl:  64%|██████▍   | 152/236 [10:16<07:42,  5.51s/it]
test ppl:  65%|██████▍   | 153/236 [10:19<06:23,  4.62s/it]
test ppl:  65%|██████▌   | 154/236 [10:21<05:27,  4.00s/it]
test ppl:  66%|██████▌   | 155/236 [10:24<04:52,  3.61s/it]
test ppl:  66%|██████▌   | 156/236 [10:26<04:18,  3.23s/it]
test ppl:  67%|██████▋   | 157/236 [10:28<03:50,  2.92s/it]
test ppl:  67%|██████▋   | 158/236 [10:34<04:59,  3.84s/it]
test ppl:  67%|██████▋   | 159/236 [10:36<04:03,  3.16s/it]
test ppl:  68%|██████▊   | 160/236 [10:37<03:16,  2.58s/it]
test ppl:  68%|██████▊   | 161/236 [10:39<02:47,  2.24s/it]
test ppl:  69%|██████▊   | 162/236 [10:42<03:08,  2.54s/it]
test ppl:  69%|██████▉   | 163/236 [10:44<03:03,  2.51s/it]
test ppl:  69%|██████▉   | 164/236 [10:49<03:40,  3.07s/it]
test ppl:  70%|██████▉   | 165/236 [10:53<03:59,  3.37s/it]
test ppl:  70%|███████   | 166/236 [10:54<03:17,  2.83s/it]
test ppl:  71%|███████   | 167/236 [10:56<02:57,  2.57s/it]
test ppl:  71%|███████   | 168/236 [10:58<02:40,  2.36s/it]
test ppl:  72%|███████▏  | 169/236 [11:01<02:46,  2.49s/it]
test ppl:  72%|███████▏  | 170/236 [11:07<03:57,  3.59s/it]
test ppl:  72%|███████▏  | 171/236 [11:09<03:15,  3.01s/it]
test ppl:  73%|███████▎  | 172/236 [11:11<02:57,  2.78s/it]
test ppl:  73%|███████▎  | 173/236 [11:15<03:10,  3.02s/it]
test ppl:  74%|███████▎  | 174/236 [11:18<03:23,  3.28s/it]
test ppl:  74%|███████▍  | 175/236 [11:20<02:42,  2.67s/it]
test ppl:  75%|███████▍  | 176/236 [11:26<03:40,  3.68s/it]
test ppl:  75%|███████▌  | 177/236 [11:32<04:31,  4.60s/it]
test ppl:  75%|███████▌  | 178/236 [11:41<05:28,  5.66s/it]
test ppl:  76%|███████▌  | 179/236 [11:47<05:30,  5.79s/it]
test ppl:  76%|███████▋  | 180/236 [11:50<04:41,  5.03s/it]
test ppl:  77%|███████▋  | 181/236 [11:56<04:54,  5.35s/it]
test ppl:  77%|███████▋  | 182/236 [11:58<03:54,  4.34s/it]
test ppl:  78%|███████▊  | 183/236 [12:01<03:22,  3.82s/it]
test ppl:  78%|███████▊  | 184/236 [12:03<02:49,  3.26s/it]
test ppl:  78%|███████▊  | 185/236 [12:06<02:50,  3.34s/it]
test ppl:  79%|███████▉  | 186/236 [12:08<02:29,  3.00s/it]
test ppl:  79%|███████▉  | 187/236 [12:10<02:13,  2.73s/it]
test ppl:  80%|███████▉  | 188/236 [12:17<02:59,  3.75s/it]
test ppl:  80%|████████  | 189/236 [12:23<03:29,  4.45s/it]
test ppl:  81%|████████  | 190/236 [12:27<03:23,  4.43s/it]
test ppl:  81%|████████  | 191/236 [12:33<03:43,  4.97s/it]
test ppl:  81%|████████▏ | 192/236 [12:36<03:09,  4.30s/it]
test ppl:  82%|████████▏ | 193/236 [12:42<03:28,  4.85s/it]
test ppl:  82%|████████▏ | 194/236 [12:45<02:56,  4.21s/it]
test ppl:  83%|████████▎ | 195/236 [12:48<02:39,  3.90s/it]
test ppl:  83%|████████▎ | 196/236 [12:50<02:17,  3.44s/it]
test ppl:  83%|████████▎ | 197/236 [12:53<02:01,  3.13s/it]
test ppl:  84%|████████▍ | 198/236 [12:59<02:33,  4.05s/it]
test ppl:  84%|████████▍ | 199/236 [13:02<02:15,  3.67s/it]
test ppl:  85%|████████▍ | 200/236 [13:08<02:38,  4.39s/it]
test ppl:  85%|████████▌ | 201/236 [13:11<02:15,  3.88s/it]
test ppl:  86%|████████▌ | 202/236 [13:15<02:21,  4.17s/it]
test ppl:  86%|████████▌ | 203/236 [13:21<02:37,  4.76s/it]
test ppl:  86%|████████▋ | 204/236 [13:23<02:03,  3.87s/it]
test ppl:  87%|████████▋ | 205/236 [13:29<02:19,  4.50s/it]
test ppl:  87%|████████▋ | 206/236 [13:33<02:06,  4.21s/it]
test ppl:  88%|████████▊ | 207/236 [13:39<02:18,  4.78s/it]
test ppl:  88%|████████▊ | 208/236 [13:43<02:07,  4.57s/it]
test ppl:  89%|████████▊ | 209/236 [13:49<02:16,  5.06s/it]
test ppl:  89%|████████▉ | 210/236 [13:52<01:51,  4.27s/it]
test ppl:  89%|████████▉ | 211/236 [13:56<01:46,  4.24s/it]
test ppl:  90%|████████▉ | 212/236 [14:02<01:55,  4.82s/it]
test ppl:  90%|█████████ | 213/236 [14:08<01:56,  5.08s/it]
test ppl:  91%|█████████ | 214/236 [14:09<01:30,  4.11s/it]
test ppl:  91%|█████████ | 215/236 [14:16<01:38,  4.71s/it]
test ppl:  92%|█████████▏| 216/236 [14:17<01:16,  3.84s/it]
test ppl:  92%|█████████▏| 217/236 [14:24<01:26,  4.55s/it]
test ppl:  92%|█████████▏| 218/236 [14:28<01:19,  4.39s/it]
test ppl:  93%|█████████▎| 219/236 [14:34<01:24,  4.94s/it]
test ppl:  93%|█████████▎| 220/236 [14:38<01:15,  4.70s/it]
test ppl:  94%|█████████▎| 221/236 [14:40<00:56,  3.77s/it]
test ppl:  94%|█████████▍| 222/236 [14:46<01:02,  4.47s/it]
test ppl:  94%|█████████▍| 223/236 [14:52<01:04,  4.97s/it]
test ppl:  95%|█████████▍| 224/236 [14:56<00:56,  4.72s/it]
test ppl:  95%|█████████▌| 225/236 [15:02<00:55,  5.05s/it]
test ppl:  96%|█████████▌| 226/236 [15:04<00:43,  4.31s/it]
test ppl:  96%|█████████▌| 227/236 [15:06<00:32,  3.59s/it]
test ppl:  97%|█████████▋| 228/236 [15:12<00:34,  4.34s/it]
test ppl:  97%|█████████▋| 229/236 [15:18<00:34,  4.86s/it]
test ppl:  97%|█████████▋| 230/236 [15:23<00:27,  4.63s/it]
test ppl:  98%|█████████▊| 231/236 [15:26<00:21,  4.25s/it]
test ppl:  98%|█████████▊| 232/236 [15:28<00:14,  3.64s/it]
test ppl:  99%|█████████▊| 233/236 [15:30<00:09,  3.20s/it]
test ppl:  99%|█████████▉| 234/236 [15:32<00:05,  2.61s/it]
test ppl: 100%|█████████▉| 235/236 [15:37<00:03,  3.61s/it]
test ppl: 100%|██████████| 236/236 [15:38<00:00,  2.82s/it]
test ppl: 100%|██████████| 236/236 [15:38<00:00,  3.98s/it]
10/12/2024 07:49:22 - INFO - __main__ -    em: 0.2099
10/12/2024 07:49:22 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.4 10:  em: 0.2099

--------------------------------------------------------------------------------
Running experiment with knn_temp=10, lmbda=0.4, k=32
2024-10-12 07:49:29.776618: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 07:49:29.796046: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 07:49:29.817897: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 07:49:29.824531: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 07:49:29.840558: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 07:49:30.839041: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 07:49:32 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.4, knn_temp=10, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 07:49:32 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:39:29,  2.20it/s]
Adding feature api:   4%|▍         | 7488/187062 [00:00<00:10, 17882.39it/s]
Adding feature api:   9%|▊         | 16111/187062 [00:00<00:04, 35268.57it/s]
Adding feature api:  13%|█▎        | 24744/187062 [00:00<00:03, 48877.73it/s]
Adding feature api:  18%|█▊        | 33378/187062 [00:00<00:02, 59207.28it/s]
Adding feature api:  22%|██▏       | 41999/187062 [00:00<00:02, 66837.00it/s]
Adding feature api:  27%|██▋       | 50677/187062 [00:01<00:01, 72570.52it/s]
Adding feature api:  32%|███▏      | 59373/187062 [00:01<00:01, 76759.19it/s]
Adding feature api:  36%|███▋      | 68076/187062 [00:01<00:01, 79774.02it/s]
Adding feature api:  41%|████      | 76741/187062 [00:01<00:01, 81803.71it/s]
Adding feature api:  46%|████▌     | 85358/187062 [00:01<00:01, 83098.90it/s]
Adding feature api:  50%|█████     | 93924/187062 [00:01<00:01, 83425.87it/s]
Adding feature api:  55%|█████▍    | 102579/187062 [00:01<00:01, 84354.49it/s]
Adding feature api:  59%|█████▉    | 111253/187062 [00:01<00:00, 85062.76it/s]
Adding feature api:  64%|██████▍   | 119894/187062 [00:01<00:00, 85462.90it/s]
Adding feature api:  69%|██████▊   | 128507/187062 [00:01<00:00, 85660.06it/s]
Adding feature api:  73%|███████▎  | 137163/187062 [00:02<00:00, 85928.51it/s]
Adding feature api:  78%|███████▊  | 145830/187062 [00:02<00:00, 86149.60it/s]
Adding feature api:  83%|████████▎ | 154496/187062 [00:02<00:00, 86301.35it/s]
Adding feature api:  87%|████████▋ | 163142/187062 [00:02<00:00, 86277.46it/s]
Adding feature api:  92%|█████████▏| 171838/187062 [00:02<00:00, 86480.48it/s]
Adding feature api:  96%|█████████▋| 180494/187062 [00:02<00:00, 72551.12it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 65803.45it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:35:31,  2.20it/s]
Adding feature datatype:   4%|▍         | 7171/187062 [00:00<00:10, 17161.94it/s]
Adding feature datatype:   8%|▊         | 15384/187062 [00:00<00:05, 33714.41it/s]
Adding feature datatype:  13%|█▎        | 23701/187062 [00:00<00:03, 46910.19it/s]
Adding feature datatype:  17%|█▋        | 32046/187062 [00:00<00:02, 56992.90it/s]
Adding feature datatype:  22%|██▏       | 40387/187062 [00:00<00:02, 64460.44it/s]
Adding feature datatype:  26%|██▌       | 48791/187062 [00:01<00:01, 70093.28it/s]
Adding feature datatype:  31%|███       | 57117/187062 [00:01<00:01, 73928.27it/s]
Adding feature datatype:  35%|███▍      | 65424/187062 [00:01<00:01, 76613.33it/s]
Adding feature datatype:  39%|███▉      | 73756/187062 [00:01<00:01, 78595.52it/s]
Adding feature datatype:  44%|████▍     | 82056/187062 [00:01<00:01, 79902.56it/s]
Adding feature datatype:  48%|████▊     | 90435/187062 [00:01<00:01, 81060.02it/s]
Adding feature datatype:  53%|█████▎    | 98776/187062 [00:01<00:01, 81760.63it/s]
Adding feature datatype:  57%|█████▋    | 107099/187062 [00:01<00:00, 82198.98it/s]
Adding feature datatype:  62%|██████▏   | 115433/187062 [00:01<00:00, 82537.51it/s]
Adding feature datatype:  66%|██████▌   | 123820/187062 [00:01<00:00, 82935.93it/s]
Adding feature datatype:  71%|███████   | 132193/187062 [00:02<00:00, 83171.38it/s]
Adding feature datatype:  75%|███████▌  | 140540/187062 [00:02<00:00, 83179.72it/s]
Adding feature datatype:  80%|███████▉  | 148903/187062 [00:02<00:00, 83311.55it/s]
Adding feature datatype:  84%|████████▍ | 157285/187062 [00:02<00:00, 83460.39it/s]
Adding feature datatype:  89%|████████▊ | 165653/187062 [00:02<00:00, 83523.92it/s]
Adding feature datatype:  93%|█████████▎| 174041/187062 [00:02<00:00, 83630.06it/s]
Adding feature datatype:  98%|█████████▊| 182409/187062 [00:02<00:00, 61894.31it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 64134.61it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:17:19,  2.23it/s]
Adding feature literal:   4%|▍         | 7192/187062 [00:00<00:10, 17382.05it/s]
Adding feature literal:   8%|▊         | 15460/187062 [00:00<00:05, 34140.84it/s]
Adding feature literal:  13%|█▎        | 23725/187062 [00:00<00:03, 47154.65it/s]
Adding feature literal:  17%|█▋        | 32029/187062 [00:00<00:02, 57095.19it/s]
Adding feature literal:  22%|██▏       | 40346/187062 [00:00<00:02, 64486.70it/s]
Adding feature literal:  26%|██▌       | 48695/187062 [00:01<00:01, 69964.08it/s]
Adding feature literal:  30%|███       | 57046/187062 [00:01<00:01, 73913.11it/s]
Adding feature literal:  35%|███▍      | 65380/187062 [00:01<00:01, 76685.41it/s]
Adding feature literal:  39%|███▉      | 73707/187062 [00:01<00:01, 78619.32it/s]
Adding feature literal:  44%|████▍     | 81910/187062 [00:01<00:01, 79432.35it/s]
Adding feature literal:  48%|████▊     | 90208/187062 [00:01<00:01, 80484.91it/s]
Adding feature literal:  53%|█████▎    | 98425/187062 [00:01<00:01, 80461.26it/s]
Adding feature literal:  57%|█████▋    | 106589/187062 [00:01<00:01, 78136.05it/s]
Adding feature literal:  61%|██████    | 114498/187062 [00:01<00:00, 76830.28it/s]
Adding feature literal:  65%|██████▌   | 122250/187062 [00:01<00:00, 75876.64it/s]
Adding feature literal:  69%|██████▉   | 129886/187062 [00:02<00:00, 75129.69it/s]
Adding feature literal:  73%|███████▎  | 137432/187062 [00:02<00:00, 74540.18it/s]
Adding feature literal:  77%|███████▋  | 144908/187062 [00:02<00:00, 74174.85it/s]
Adding feature literal:  81%|████████▏ | 152341/187062 [00:02<00:00, 73933.70it/s]
Adding feature literal:  85%|████████▌ | 159745/187062 [00:02<00:00, 73769.19it/s]
Adding feature literal:  89%|████████▉ | 167129/187062 [00:02<00:00, 73684.38it/s]
Adding feature literal:  93%|█████████▎| 174503/187062 [00:02<00:00, 73172.01it/s]
Adding feature literal:  97%|█████████▋| 181824/187062 [00:02<00:00, 57147.98it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 61306.96it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:16:48,  2.23it/s]
Adding feature operator:   4%|▍         | 7261/187062 [00:00<00:10, 17553.58it/s]
Adding feature operator:   8%|▊         | 15544/187062 [00:00<00:04, 34309.68it/s]
Adding feature operator:  13%|█▎        | 23901/187062 [00:00<00:03, 47526.99it/s]
Adding feature operator:  17%|█▋        | 32209/187062 [00:00<00:02, 57376.70it/s]
Adding feature operator:  22%|██▏       | 40550/187062 [00:00<00:02, 64758.39it/s]
Adding feature operator:  26%|██▌       | 48730/187062 [00:01<00:01, 69671.14it/s]
Adding feature operator:  30%|███       | 57030/187062 [00:01<00:01, 73557.90it/s]
Adding feature operator:  35%|███▍      | 65446/187062 [00:01<00:01, 76674.30it/s]
Adding feature operator:  39%|███▉      | 73831/187062 [00:01<00:01, 78795.50it/s]
Adding feature operator:  44%|████▍     | 82193/187062 [00:01<00:01, 80226.59it/s]
Adding feature operator:  48%|████▊     | 90495/187062 [00:01<00:01, 81056.80it/s]
Adding feature operator:  53%|█████▎    | 98920/187062 [00:01<00:01, 82007.50it/s]
Adding feature operator:  57%|█████▋    | 107287/187062 [00:01<00:00, 82502.35it/s]
Adding feature operator:  62%|██████▏   | 115622/187062 [00:01<00:00, 82700.30it/s]
Adding feature operator:  66%|██████▋   | 123988/187062 [00:01<00:00, 82985.48it/s]
Adding feature operator:  71%|███████   | 132347/187062 [00:02<00:00, 83163.44it/s]
Adding feature operator:  75%|███████▌  | 140693/187062 [00:02<00:00, 83017.92it/s]
Adding feature operator:  80%|███████▉  | 149043/187062 [00:02<00:00, 83159.45it/s]
Adding feature operator:  84%|████████▍ | 157374/187062 [00:02<00:00, 82645.83it/s]
Adding feature operator:  89%|████████▊ | 165729/187062 [00:02<00:00, 82911.87it/s]
Adding feature operator:  93%|█████████▎| 174064/187062 [00:02<00:00, 83039.51it/s]
Adding feature operator:  97%|█████████▋| 182374/187062 [00:02<00:00, 62071.16it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 64232.80it/s]
[2024-10-12 07:50:15,591] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 07:50:17 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 07:50:17 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 416.00 examples/s]
Map:   2%|▏         | 108/6548 [00:00<00:26, 244.01 examples/s]
Map:   2%|▏         | 148/6548 [00:00<00:22, 283.76 examples/s]
Map:   3%|▎         | 182/6548 [00:00<00:21, 298.74 examples/s]
Map:   3%|▎         | 228/6548 [00:00<00:18, 341.41 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:18, 337.27 examples/s]
Map:   5%|▍         | 324/6548 [00:01<00:21, 288.35 examples/s]
Map:   6%|▌         | 368/6548 [00:01<00:21, 286.62 examples/s]
Map:   6%|▋         | 419/6548 [00:01<00:18, 335.30 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:19, 318.92 examples/s]
Map:   8%|▊         | 535/6548 [00:01<00:17, 341.51 examples/s]
Map:   9%|▉         | 577/6548 [00:01<00:17, 346.18 examples/s]
Map:   9%|▉         | 615/6548 [00:01<00:16, 351.47 examples/s]
Map:  10%|█         | 662/6548 [00:02<00:19, 298.06 examples/s]
Map:  11%|█         | 708/6548 [00:02<00:17, 327.77 examples/s]
Map:  11%|█▏        | 750/6548 [00:02<00:16, 348.79 examples/s]
Map:  12%|█▏        | 801/6548 [00:02<00:14, 386.47 examples/s]
Map:  13%|█▎        | 862/6548 [00:02<00:14, 390.65 examples/s]
Map:  14%|█▍        | 908/6548 [00:02<00:15, 361.30 examples/s]
Map:  14%|█▍        | 947/6548 [00:02<00:15, 362.79 examples/s]
Map:  15%|█▌        | 987/6548 [00:02<00:15, 356.67 examples/s]
Map:  16%|█▌        | 1037/6548 [00:03<00:23, 231.31 examples/s]
Map:  16%|█▋        | 1073/6548 [00:03<00:21, 252.90 examples/s]
Map:  17%|█▋        | 1115/6548 [00:03<00:19, 284.38 examples/s]
Map:  18%|█▊        | 1157/6548 [00:03<00:17, 313.23 examples/s]
Map:  18%|█▊        | 1202/6548 [00:03<00:15, 343.08 examples/s]
Map:  19%|█▉        | 1259/6548 [00:03<00:15, 347.16 examples/s]
Map:  20%|█▉        | 1297/6548 [00:04<00:15, 350.00 examples/s]
Map:  20%|██        | 1341/6548 [00:04<00:15, 329.43 examples/s]
Map:  21%|██        | 1378/6548 [00:04<00:17, 296.41 examples/s]
Map:  22%|██▏       | 1430/6548 [00:04<00:16, 308.03 examples/s]
Map:  22%|██▏       | 1466/6548 [00:04<00:18, 273.07 examples/s]
Map:  23%|██▎       | 1511/6548 [00:04<00:18, 277.90 examples/s]
Map:  24%|██▎       | 1549/6548 [00:04<00:18, 268.38 examples/s]
Map:  24%|██▍       | 1587/6548 [00:05<00:17, 291.63 examples/s]
Map:  25%|██▍       | 1621/6548 [00:05<00:19, 257.78 examples/s]
Map:  25%|██▌       | 1660/6548 [00:05<00:19, 247.04 examples/s]
Map:  26%|██▌       | 1697/6548 [00:05<00:18, 266.84 examples/s]
Map:  27%|██▋       | 1737/6548 [00:05<00:16, 295.02 examples/s]
Map:  27%|██▋       | 1776/6548 [00:05<00:15, 317.22 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 322.74 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:14, 328.26 examples/s]
Map:  29%|██▉       | 1906/6548 [00:06<00:13, 333.53 examples/s]
Map:  30%|██▉       | 1947/6548 [00:06<00:13, 350.28 examples/s]
Map:  30%|███       | 1991/6548 [00:06<00:12, 369.28 examples/s]
Map:  31%|███       | 2030/6548 [00:06<00:19, 226.98 examples/s]
Map:  32%|███▏      | 2066/6548 [00:06<00:17, 251.00 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 269.69 examples/s]
Map:  33%|███▎      | 2136/6548 [00:06<00:15, 278.96 examples/s]
Map:  33%|███▎      | 2180/6548 [00:07<00:15, 273.15 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 277.48 examples/s]
Map:  34%|███▍      | 2255/6548 [00:07<00:16, 268.24 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:15, 272.68 examples/s]
Map:  36%|███▌      | 2331/6548 [00:07<00:13, 308.50 examples/s]
Map:  36%|███▌      | 2368/6548 [00:07<00:14, 281.27 examples/s]
Map:  37%|███▋      | 2408/6548 [00:07<00:13, 304.02 examples/s]
Map:  38%|███▊      | 2459/6548 [00:08<00:13, 313.25 examples/s]
Map:  38%|███▊      | 2497/6548 [00:08<00:12, 322.53 examples/s]
Map:  39%|███▉      | 2538/6548 [00:08<00:11, 342.28 examples/s]
Map:  40%|███▉      | 2592/6548 [00:08<00:10, 390.40 examples/s]
Map:  40%|████      | 2634/6548 [00:08<00:09, 394.58 examples/s]
Map:  41%|████      | 2682/6548 [00:08<00:11, 349.64 examples/s]
Map:  42%|████▏     | 2737/6548 [00:08<00:11, 342.73 examples/s]
Map:  42%|████▏     | 2775/6548 [00:08<00:10, 349.77 examples/s]
Map:  43%|████▎     | 2822/6548 [00:09<00:11, 335.07 examples/s]
Map:  44%|████▎     | 2858/6548 [00:09<00:13, 278.16 examples/s]
Map:  44%|████▍     | 2896/6548 [00:09<00:12, 298.70 examples/s]
Map:  45%|████▌     | 2949/6548 [00:09<00:12, 280.14 examples/s]
Map:  46%|████▌     | 2982/6548 [00:09<00:12, 287.86 examples/s]
Map:  46%|████▌     | 3026/6548 [00:10<00:21, 163.07 examples/s]
Map:  47%|████▋     | 3054/6548 [00:10<00:19, 177.86 examples/s]
Map:  47%|████▋     | 3086/6548 [00:10<00:17, 200.83 examples/s]
Map:  48%|████▊     | 3116/6548 [00:10<00:15, 219.39 examples/s]
Map:  48%|████▊     | 3149/6548 [00:10<00:15, 218.04 examples/s]
Map:  49%|████▊     | 3183/6548 [00:10<00:14, 227.65 examples/s]
Map:  49%|████▉     | 3215/6548 [00:10<00:14, 228.81 examples/s]
Map:  50%|████▉     | 3246/6548 [00:11<00:13, 245.84 examples/s]
Map:  50%|█████     | 3280/6548 [00:11<00:12, 266.31 examples/s]
Map:  51%|█████     | 3322/6548 [00:11<00:10, 300.92 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:11<00:10, 298.69 examples/s]
Map:  52%|█████▏    | 3420/6548 [00:11<00:10, 297.96 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:10, 281.64 examples/s]
Map:  53%|█████▎    | 3498/6548 [00:11<00:10, 284.15 examples/s]
Map:  54%|█████▍    | 3546/6548 [00:11<00:09, 325.19 examples/s]
Map:  55%|█████▍    | 3595/6548 [00:12<00:08, 363.97 examples/s]
Map:  56%|█████▌    | 3639/6548 [00:12<00:07, 376.92 examples/s]
Map:  56%|█████▋    | 3696/6548 [00:12<00:07, 372.17 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:12<00:07, 381.15 examples/s]
Map:  58%|█████▊    | 3792/6548 [00:12<00:07, 368.01 examples/s]
Map:  59%|█████▊    | 3839/6548 [00:12<00:07, 342.32 examples/s]
Map:  59%|█████▉    | 3886/6548 [00:12<00:08, 325.56 examples/s]
Map:  60%|█████▉    | 3923/6548 [00:13<00:08, 311.48 examples/s]
Map:  61%|██████    | 3976/6548 [00:13<00:08, 318.95 examples/s]
Map:  62%|██████▏   | 4030/6548 [00:13<00:10, 249.23 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 289.71 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 314.25 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:08, 292.22 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:14<00:07, 307.35 examples/s]
Map:  65%|██████▌   | 4259/6548 [00:14<00:06, 342.98 examples/s]
Map:  66%|██████▌   | 4298/6548 [00:14<00:06, 344.40 examples/s]
Map:  66%|██████▋   | 4344/6548 [00:14<00:05, 371.92 examples/s]
Map:  67%|██████▋   | 4398/6548 [00:14<00:05, 363.49 examples/s]
Map:  68%|██████▊   | 4438/6548 [00:14<00:05, 371.58 examples/s]
Map:  68%|██████▊   | 4485/6548 [00:14<00:05, 347.92 examples/s]
Map:  69%|██████▉   | 4530/6548 [00:14<00:06, 322.94 examples/s]
Map:  70%|██████▉   | 4570/6548 [00:15<00:05, 338.99 examples/s]
Map:  70%|███████   | 4610/6548 [00:15<00:05, 338.98 examples/s]
Map:  71%|███████   | 4657/6548 [00:15<00:05, 371.74 examples/s]
Map:  72%|███████▏  | 4712/6548 [00:15<00:04, 367.24 examples/s]
Map:  73%|███████▎  | 4777/6548 [00:15<00:04, 381.76 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 388.10 examples/s]
Map:  74%|███████▍  | 4875/6548 [00:15<00:04, 362.01 examples/s]
Map:  75%|███████▌  | 4937/6548 [00:16<00:04, 376.92 examples/s]
Map:  76%|███████▌  | 4980/6548 [00:16<00:04, 388.19 examples/s]
Map:  77%|███████▋  | 5031/6548 [00:16<00:06, 231.34 examples/s]
Map:  77%|███████▋  | 5065/6548 [00:16<00:05, 248.13 examples/s]
Map:  78%|███████▊  | 5101/6548 [00:16<00:05, 263.26 examples/s]
Map:  79%|███████▊  | 5147/6548 [00:16<00:05, 263.83 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:17<00:04, 275.09 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:17<00:04, 290.36 examples/s]
Map:  80%|████████  | 5257/6548 [00:17<00:04, 298.60 examples/s]
Map:  81%|████████  | 5312/6548 [00:17<00:03, 360.03 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 309.41 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 302.19 examples/s]
Map:  83%|████████▎ | 5452/6548 [00:17<00:03, 331.81 examples/s]
Map:  84%|████████▍ | 5489/6548 [00:17<00:03, 339.54 examples/s]
Map:  85%|████████▍ | 5544/6548 [00:18<00:02, 338.53 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:18<00:03, 302.66 examples/s]
Map:  86%|████████▌ | 5639/6548 [00:18<00:02, 353.46 examples/s]
Map:  87%|████████▋ | 5680/6548 [00:18<00:02, 315.91 examples/s]
Map:  88%|████████▊ | 5731/6548 [00:18<00:02, 319.96 examples/s]
Map:  88%|████████▊ | 5767/6548 [00:18<00:02, 326.04 examples/s]
Map:  89%|████████▊ | 5805/6548 [00:18<00:02, 331.09 examples/s]
Map:  89%|████████▉ | 5845/6548 [00:19<00:02, 334.59 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:19<00:01, 335.39 examples/s]
Map:  90%|█████████ | 5923/6548 [00:19<00:01, 350.70 examples/s]
Map:  91%|█████████ | 5960/6548 [00:19<00:01, 345.63 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 198.24 examples/s]
Map:  92%|█████████▏| 6038/6548 [00:19<00:02, 229.48 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 265.05 examples/s]
Map:  94%|█████████▎| 6124/6548 [00:20<00:01, 266.56 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:20<00:01, 284.72 examples/s]
Map:  95%|█████████▍| 6206/6548 [00:20<00:01, 307.72 examples/s]
Map:  95%|█████████▌| 6249/6548 [00:20<00:00, 332.62 examples/s]
Map:  96%|█████████▋| 6304/6548 [00:20<00:00, 342.98 examples/s]
Map:  97%|█████████▋| 6365/6548 [00:20<00:00, 359.34 examples/s]
Map:  98%|█████████▊| 6418/6548 [00:20<00:00, 353.32 examples/s]
Map:  99%|█████████▉| 6469/6548 [00:21<00:00, 387.14 examples/s]
Map: 100%|█████████▉| 6527/6548 [00:21<00:00, 385.43 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 306.51 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 327.60 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 348.04 examples/s]
Map:  13%|█▎        | 115/903 [00:00<00:02, 341.99 examples/s]
Map:  19%|█▉        | 170/903 [00:00<00:02, 350.70 examples/s]
Map:  24%|██▎       | 213/903 [00:00<00:01, 370.41 examples/s]
Map:  28%|██▊       | 256/903 [00:00<00:01, 385.76 examples/s]
Map:  34%|███▍      | 310/903 [00:00<00:01, 367.37 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 322.86 examples/s]
Map:  44%|████▎     | 393/903 [00:01<00:01, 286.99 examples/s]
Map:  48%|████▊     | 429/903 [00:01<00:01, 301.68 examples/s]
Map:  52%|█████▏    | 472/903 [00:01<00:01, 291.94 examples/s]
Map:  56%|█████▋    | 508/903 [00:01<00:01, 296.50 examples/s]
Map:  62%|██████▏   | 557/903 [00:01<00:01, 337.75 examples/s]
Map:  67%|██████▋   | 606/903 [00:01<00:00, 374.15 examples/s]
Map:  72%|███████▏  | 653/903 [00:01<00:00, 347.73 examples/s]
Map:  77%|███████▋  | 696/903 [00:02<00:00, 364.55 examples/s]
Map:  82%|████████▏ | 742/903 [00:02<00:00, 386.75 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 384.11 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 368.32 examples/s]
Map:  98%|█████████▊| 884/903 [00:02<00:00, 371.89 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 317.42 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 291.81 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 355.33 examples/s]
Map:   7%|▋         | 124/1882 [00:00<00:05, 310.42 examples/s]
Map:   9%|▉         | 165/1882 [00:00<00:05, 340.90 examples/s]
Map:  11%|█         | 203/1882 [00:00<00:05, 323.28 examples/s]
Map:  13%|█▎        | 248/1882 [00:00<00:04, 357.61 examples/s]
Map:  15%|█▌        | 287/1882 [00:00<00:04, 357.70 examples/s]
Map:  17%|█▋        | 325/1882 [00:00<00:04, 350.65 examples/s]
Map:  20%|█▉        | 369/1882 [00:01<00:04, 323.40 examples/s]
Map:  22%|██▏       | 411/1882 [00:01<00:04, 296.74 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 303.03 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 337.75 examples/s]
Map:  28%|██▊       | 532/1882 [00:01<00:04, 298.29 examples/s]
Map:  31%|███       | 576/1882 [00:01<00:04, 325.25 examples/s]
Map:  34%|███▎      | 633/1882 [00:01<00:03, 382.72 examples/s]
Map:  36%|███▌      | 677/1882 [00:01<00:03, 385.09 examples/s]
Map:  39%|███▉      | 734/1882 [00:02<00:03, 377.89 examples/s]
Map:  41%|████      | 773/1882 [00:02<00:03, 360.78 examples/s]
Map:  44%|████▎     | 819/1882 [00:02<00:03, 340.49 examples/s]
Map:  45%|████▌     | 855/1882 [00:02<00:03, 341.82 examples/s]
Map:  48%|████▊     | 899/1882 [00:02<00:02, 364.83 examples/s]
Map:  51%|█████     | 960/1882 [00:02<00:02, 378.37 examples/s]
Map:  53%|█████▎    | 1000/1882 [00:03<00:03, 242.56 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 266.04 examples/s]
Map:  58%|█████▊    | 1084/1882 [00:03<00:02, 272.39 examples/s]
Map:  59%|█████▉    | 1116/1882 [00:03<00:02, 272.57 examples/s]
Map:  62%|██████▏   | 1158/1882 [00:03<00:02, 272.84 examples/s]
Map:  64%|██████▍   | 1203/1882 [00:03<00:02, 258.27 examples/s]
Map:  66%|██████▌   | 1244/1882 [00:03<00:02, 286.43 examples/s]
Map:  68%|██████▊   | 1277/1882 [00:04<00:02, 293.97 examples/s]
Map:  70%|███████   | 1318/1882 [00:04<00:01, 321.64 examples/s]
Map:  72%|███████▏  | 1360/1882 [00:04<00:01, 330.41 examples/s]
Map:  75%|███████▌  | 1413/1882 [00:04<00:01, 333.45 examples/s]
Map:  77%|███████▋  | 1458/1882 [00:04<00:01, 312.61 examples/s]
Map:  79%|███████▉  | 1493/1882 [00:04<00:01, 285.29 examples/s]
Map:  81%|████████  | 1524/1882 [00:04<00:01, 281.25 examples/s]
Map:  83%|████████▎ | 1554/1882 [00:04<00:01, 282.89 examples/s]
Map:  85%|████████▍ | 1598/1882 [00:05<00:00, 320.31 examples/s]
Map:  87%|████████▋ | 1639/1882 [00:05<00:00, 332.30 examples/s]
Map:  90%|████████▉ | 1692/1882 [00:05<00:00, 332.31 examples/s]
Map:  92%|█████████▏| 1734/1882 [00:05<00:00, 296.02 examples/s]
Map:  94%|█████████▍| 1775/1882 [00:05<00:00, 287.04 examples/s]
Map:  96%|█████████▌| 1811/1882 [00:05<00:00, 302.53 examples/s]
Map:  99%|█████████▊| 1856/1882 [00:05<00:00, 337.32 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 306.63 examples/s]
10/12/2024 07:51:19 - INFO - __main__ -     ***** Testing *****
10/12/2024 07:51:19 - INFO - __main__ -     Batch size = 8
10/12/2024 07:51:19 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 07:51:19 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 07:51:19 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 07:51:20 - INFO - knnlm -   Reading datastore took 0.9524483680725098 s
10/12/2024 07:51:21 - INFO - knnlm -   Moving index to GPU took 0.9095427989959717 s
10/12/2024 07:51:21 - INFO - __main__ -   ******************************break-into
10/12/2024 07:51:21 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 07:51:21 - INFO - __main__ -     Num examples = 236
10/12/2024 07:51:21 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:24,  7.76s/it]
test ppl:   1%|          | 2/236 [00:09<16:26,  4.22s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:31,  2.97s/it]
test ppl:   2%|▏         | 4/236 [00:16<15:49,  4.09s/it]
test ppl:   2%|▏         | 5/236 [00:22<18:10,  4.72s/it]
test ppl:   3%|▎         | 6/236 [00:26<17:11,  4.49s/it]
test ppl:   3%|▎         | 7/236 [00:32<18:47,  4.92s/it]
test ppl:   3%|▎         | 8/236 [00:38<19:46,  5.20s/it]
test ppl:   4%|▍         | 9/236 [00:39<15:32,  4.11s/it]
test ppl:   4%|▍         | 10/236 [00:42<14:03,  3.73s/it]
test ppl:   5%|▍         | 11/236 [00:45<12:41,  3.38s/it]
test ppl:   5%|▌         | 12/236 [00:51<15:23,  4.12s/it]
test ppl:   6%|▌         | 13/236 [00:57<17:14,  4.64s/it]
test ppl:   6%|▌         | 14/236 [01:02<18:31,  5.01s/it]
test ppl:   6%|▋         | 15/236 [01:04<14:53,  4.04s/it]
test ppl:   7%|▋         | 16/236 [01:06<12:23,  3.38s/it]
test ppl:   7%|▋         | 17/236 [01:10<12:32,  3.44s/it]
test ppl:   8%|▊         | 18/236 [01:11<10:33,  2.91s/it]
test ppl:   8%|▊         | 19/236 [01:17<13:41,  3.79s/it]
test ppl:   8%|▊         | 20/236 [01:20<12:16,  3.41s/it]
test ppl:   9%|▉         | 21/236 [01:26<14:50,  4.14s/it]
test ppl:   9%|▉         | 22/236 [01:31<16:35,  4.65s/it]
test ppl:  10%|▉         | 23/236 [01:34<14:22,  4.05s/it]
test ppl:  10%|█         | 24/236 [01:37<12:38,  3.58s/it]
test ppl:  11%|█         | 25/236 [01:38<10:38,  3.03s/it]
test ppl:  11%|█         | 26/236 [01:44<13:32,  3.87s/it]
test ppl:  11%|█▏        | 27/236 [01:48<13:00,  3.74s/it]
test ppl:  12%|█▏        | 28/236 [01:49<10:48,  3.12s/it]
test ppl:  12%|█▏        | 29/236 [01:52<09:56,  2.88s/it]
test ppl:  13%|█▎        | 30/236 [01:53<08:29,  2.47s/it]
test ppl:  13%|█▎        | 31/236 [01:55<07:56,  2.32s/it]
test ppl:  14%|█▎        | 32/236 [02:00<10:22,  3.05s/it]
test ppl:  14%|█▍        | 33/236 [02:06<13:09,  3.89s/it]
test ppl:  14%|█▍        | 34/236 [02:10<13:10,  3.91s/it]
test ppl:  15%|█▍        | 35/236 [02:12<11:41,  3.49s/it]
test ppl:  15%|█▌        | 36/236 [02:18<14:00,  4.20s/it]
test ppl:  16%|█▌        | 37/236 [02:24<15:36,  4.71s/it]
test ppl:  16%|█▌        | 38/236 [02:26<12:55,  3.91s/it]
test ppl:  17%|█▋        | 39/236 [02:28<10:42,  3.26s/it]
test ppl:  17%|█▋        | 40/236 [02:31<10:21,  3.17s/it]
test ppl:  17%|█▋        | 41/236 [02:32<09:02,  2.78s/it]
test ppl:  18%|█▊        | 42/236 [02:38<12:01,  3.72s/it]
test ppl:  18%|█▊        | 43/236 [02:44<14:00,  4.36s/it]
test ppl:  19%|█▊        | 44/236 [02:47<12:30,  3.91s/it]
test ppl:  19%|█▉        | 45/236 [02:49<10:38,  3.34s/it]
test ppl:  19%|█▉        | 46/236 [02:55<13:00,  4.11s/it]
test ppl:  20%|█▉        | 47/236 [02:57<10:29,  3.33s/it]
test ppl:  20%|██        | 48/236 [03:02<12:46,  4.08s/it]
test ppl:  21%|██        | 49/236 [03:06<12:26,  3.99s/it]
test ppl:  21%|██        | 50/236 [03:12<14:08,  4.56s/it]
test ppl:  22%|██▏       | 51/236 [03:16<13:21,  4.33s/it]
test ppl:  22%|██▏       | 52/236 [03:22<14:40,  4.79s/it]
test ppl:  22%|██▏       | 53/236 [03:28<15:34,  5.11s/it]
test ppl:  23%|██▎       | 54/236 [03:29<12:13,  4.03s/it]
test ppl:  23%|██▎       | 55/236 [03:35<13:34,  4.50s/it]
test ppl:  24%|██▎       | 56/236 [03:41<14:43,  4.91s/it]
test ppl:  24%|██▍       | 57/236 [03:43<12:40,  4.25s/it]
test ppl:  25%|██▍       | 58/236 [03:45<10:44,  3.62s/it]
test ppl:  25%|██▌       | 59/236 [03:51<12:37,  4.28s/it]
test ppl:  25%|██▌       | 60/236 [03:54<11:39,  3.98s/it]
test ppl:  26%|██▌       | 61/236 [03:57<10:21,  3.55s/it]
test ppl:  26%|██▋       | 62/236 [04:03<12:16,  4.24s/it]
test ppl:  27%|██▋       | 63/236 [04:05<10:40,  3.70s/it]
test ppl:  27%|██▋       | 64/236 [04:08<09:32,  3.33s/it]
test ppl:  28%|██▊       | 65/236 [04:09<07:46,  2.73s/it]
test ppl:  28%|██▊       | 66/236 [04:12<08:00,  2.83s/it]
test ppl:  28%|██▊       | 67/236 [04:18<10:30,  3.73s/it]
test ppl:  29%|██▉       | 68/236 [04:24<12:13,  4.37s/it]
test ppl:  29%|██▉       | 69/236 [04:30<13:23,  4.81s/it]
test ppl:  30%|██▉       | 70/236 [04:31<10:22,  3.75s/it]
test ppl:  30%|███       | 71/236 [04:34<10:00,  3.64s/it]
test ppl:  31%|███       | 72/236 [04:38<10:04,  3.69s/it]
test ppl:  31%|███       | 73/236 [04:44<11:46,  4.34s/it]
test ppl:  31%|███▏      | 74/236 [04:50<12:54,  4.78s/it]
test ppl:  32%|███▏      | 75/236 [04:56<13:41,  5.10s/it]
test ppl:  32%|███▏      | 76/236 [04:59<12:21,  4.64s/it]
test ppl:  33%|███▎      | 77/236 [05:01<10:23,  3.92s/it]
test ppl:  33%|███▎      | 78/236 [05:03<08:25,  3.20s/it]
test ppl:  33%|███▎      | 79/236 [05:08<09:28,  3.62s/it]
test ppl:  34%|███▍      | 80/236 [05:13<11:07,  4.28s/it]
test ppl:  34%|███▍      | 81/236 [05:19<12:15,  4.75s/it]
test ppl:  35%|███▍      | 82/236 [05:25<13:02,  5.08s/it]
test ppl:  35%|███▌      | 83/236 [05:31<13:32,  5.31s/it]
test ppl:  36%|███▌      | 84/236 [05:33<11:08,  4.40s/it]
test ppl:  36%|███▌      | 85/236 [05:37<10:53,  4.33s/it]
test ppl:  36%|███▋      | 86/236 [05:40<09:26,  3.77s/it]
test ppl:  37%|███▋      | 87/236 [05:42<08:28,  3.42s/it]
test ppl:  37%|███▋      | 88/236 [05:48<10:12,  4.14s/it]
test ppl:  38%|███▊      | 89/236 [05:50<08:32,  3.49s/it]
test ppl:  38%|███▊      | 90/236 [05:56<10:11,  4.19s/it]
test ppl:  39%|███▊      | 91/236 [06:00<10:14,  4.24s/it]
test ppl:  39%|███▉      | 92/236 [06:03<09:07,  3.80s/it]
test ppl:  39%|███▉      | 93/236 [06:09<10:31,  4.41s/it]
test ppl:  40%|███▉      | 94/236 [06:15<11:26,  4.84s/it]
test ppl:  40%|████      | 95/236 [06:18<10:22,  4.41s/it]
test ppl:  41%|████      | 96/236 [06:21<09:16,  3.97s/it]
test ppl:  41%|████      | 97/236 [06:27<10:29,  4.53s/it]
test ppl:  42%|████▏     | 98/236 [06:33<11:20,  4.93s/it]
test ppl:  42%|████▏     | 99/236 [06:39<11:53,  5.21s/it]
test ppl:  42%|████▏     | 100/236 [06:40<09:06,  4.02s/it]
test ppl:  43%|████▎     | 101/236 [06:46<10:15,  4.56s/it]
test ppl:  43%|████▎     | 102/236 [06:50<09:45,  4.37s/it]
test ppl:  44%|████▎     | 103/236 [06:51<07:43,  3.49s/it]
test ppl:  44%|████▍     | 104/236 [06:55<08:07,  3.69s/it]
test ppl:  44%|████▍     | 105/236 [07:00<08:30,  3.90s/it]
test ppl:  45%|████▍     | 106/236 [07:05<09:23,  4.34s/it]
test ppl:  45%|████▌     | 107/236 [07:07<07:58,  3.71s/it]
test ppl:  46%|████▌     | 108/236 [07:13<09:09,  4.29s/it]
test ppl:  46%|████▌     | 109/236 [07:17<08:52,  4.20s/it]
test ppl:  47%|████▋     | 110/236 [07:19<07:10,  3.41s/it]
test ppl:  47%|████▋     | 111/236 [07:23<07:26,  3.57s/it]
test ppl:  47%|████▋     | 112/236 [07:28<08:46,  4.25s/it]
test ppl:  48%|████▊     | 113/236 [07:30<07:10,  3.50s/it]
test ppl:  48%|████▊     | 114/236 [07:33<07:00,  3.45s/it]
test ppl:  49%|████▊     | 115/236 [07:39<08:23,  4.17s/it]
test ppl:  49%|████▉     | 116/236 [07:45<09:20,  4.67s/it]
test ppl:  50%|████▉     | 117/236 [07:47<07:34,  3.82s/it]
test ppl:  50%|█████     | 118/236 [07:53<08:41,  4.42s/it]
test ppl:  50%|█████     | 119/236 [07:55<07:07,  3.66s/it]
test ppl:  51%|█████     | 120/236 [07:57<06:07,  3.17s/it]
test ppl:  51%|█████▏    | 121/236 [08:02<07:36,  3.97s/it]
test ppl:  52%|█████▏    | 122/236 [08:07<08:04,  4.25s/it]
test ppl:  52%|█████▏    | 123/236 [08:10<06:54,  3.67s/it]
test ppl:  53%|█████▎    | 124/236 [08:12<06:12,  3.33s/it]
test ppl:  53%|█████▎    | 125/236 [08:15<05:41,  3.07s/it]
test ppl:  53%|█████▎    | 126/236 [08:18<05:55,  3.24s/it]
test ppl:  54%|█████▍    | 127/236 [08:20<05:14,  2.89s/it]
test ppl:  54%|█████▍    | 128/236 [08:26<06:47,  3.77s/it]
test ppl:  55%|█████▍    | 129/236 [08:29<06:00,  3.37s/it]
test ppl:  55%|█████▌    | 130/236 [08:32<05:58,  3.38s/it]
test ppl:  56%|█████▌    | 131/236 [08:38<07:12,  4.12s/it]
test ppl:  56%|█████▌    | 132/236 [08:40<06:16,  3.62s/it]
test ppl:  56%|█████▋    | 133/236 [08:44<06:21,  3.70s/it]
test ppl:  57%|█████▋    | 134/236 [08:48<06:07,  3.61s/it]
test ppl:  57%|█████▋    | 135/236 [08:52<06:26,  3.82s/it]
test ppl:  58%|█████▊    | 136/236 [08:53<05:07,  3.08s/it]
test ppl:  58%|█████▊    | 137/236 [08:59<06:27,  3.91s/it]
test ppl:  58%|█████▊    | 138/236 [09:05<07:19,  4.49s/it]
test ppl:  59%|█████▉    | 139/236 [09:08<06:19,  3.91s/it]
test ppl:  59%|█████▉    | 140/236 [09:09<05:15,  3.29s/it]
test ppl:  60%|█████▉    | 141/236 [09:12<05:00,  3.16s/it]
test ppl:  60%|██████    | 142/236 [09:18<06:12,  3.96s/it]
test ppl:  61%|██████    | 143/236 [09:21<05:34,  3.59s/it]
test ppl:  61%|██████    | 144/236 [09:24<05:05,  3.32s/it]
test ppl:  61%|██████▏   | 145/236 [09:29<06:10,  4.07s/it]
test ppl:  62%|██████▏   | 146/236 [09:35<06:53,  4.60s/it]
test ppl:  62%|██████▏   | 147/236 [09:41<07:22,  4.97s/it]
test ppl:  63%|██████▎   | 148/236 [09:47<07:43,  5.27s/it]
test ppl:  63%|██████▎   | 149/236 [09:50<06:37,  4.57s/it]
test ppl:  64%|██████▎   | 150/236 [09:53<05:49,  4.06s/it]
test ppl:  64%|██████▍   | 151/236 [09:59<06:30,  4.59s/it]
test ppl:  64%|██████▍   | 152/236 [10:04<06:56,  4.95s/it]
test ppl:  65%|██████▍   | 153/236 [10:10<07:12,  5.22s/it]
test ppl:  65%|██████▌   | 154/236 [10:13<06:01,  4.40s/it]
test ppl:  66%|██████▌   | 155/236 [10:15<05:15,  3.89s/it]
test ppl:  66%|██████▌   | 156/236 [10:18<04:33,  3.42s/it]
test ppl:  67%|██████▋   | 157/236 [10:21<04:17,  3.25s/it]
test ppl:  67%|██████▋   | 158/236 [10:26<05:14,  4.03s/it]
test ppl:  67%|██████▋   | 159/236 [10:32<05:52,  4.58s/it]
test ppl:  68%|██████▊   | 160/236 [10:34<04:30,  3.56s/it]
test ppl:  68%|██████▊   | 161/236 [10:35<03:37,  2.90s/it]
test ppl:  69%|██████▊   | 162/236 [10:38<03:39,  2.97s/it]
test ppl:  69%|██████▉   | 163/236 [10:40<03:23,  2.78s/it]
test ppl:  69%|██████▉   | 164/236 [10:45<03:50,  3.20s/it]
test ppl:  70%|██████▉   | 165/236 [10:48<04:02,  3.41s/it]
test ppl:  70%|███████   | 166/236 [10:50<03:18,  2.83s/it]
test ppl:  71%|███████   | 167/236 [10:52<02:56,  2.55s/it]
test ppl:  71%|███████   | 168/236 [10:54<02:37,  2.32s/it]
test ppl:  72%|███████▏  | 169/236 [10:56<02:42,  2.42s/it]
test ppl:  72%|███████▏  | 170/236 [11:02<03:49,  3.47s/it]
test ppl:  72%|███████▏  | 171/236 [11:04<03:08,  2.90s/it]
test ppl:  73%|███████▎  | 172/236 [11:06<02:51,  2.68s/it]
test ppl:  73%|███████▎  | 173/236 [11:09<03:03,  2.91s/it]
test ppl:  74%|███████▎  | 174/236 [11:13<03:15,  3.15s/it]
test ppl:  74%|███████▍  | 175/236 [11:15<02:42,  2.67s/it]
test ppl:  75%|███████▍  | 176/236 [11:20<03:36,  3.61s/it]
test ppl:  75%|███████▌  | 177/236 [11:26<04:12,  4.28s/it]
test ppl:  75%|███████▌  | 178/236 [11:32<04:36,  4.76s/it]
test ppl:  76%|███████▌  | 179/236 [11:38<04:49,  5.08s/it]
test ppl:  76%|███████▋  | 180/236 [11:41<04:17,  4.59s/it]
test ppl:  77%|███████▋  | 181/236 [11:45<03:58,  4.34s/it]
test ppl:  77%|███████▋  | 182/236 [11:47<03:14,  3.60s/it]
test ppl:  78%|███████▊  | 183/236 [11:50<02:52,  3.26s/it]
test ppl:  78%|███████▊  | 184/236 [11:51<02:27,  2.83s/it]
test ppl:  78%|███████▊  | 185/236 [11:55<02:32,  3.00s/it]
test ppl:  79%|███████▉  | 186/236 [11:57<02:16,  2.73s/it]
test ppl:  79%|███████▉  | 187/236 [12:03<03:00,  3.69s/it]
test ppl:  80%|███████▉  | 188/236 [12:09<03:28,  4.35s/it]
test ppl:  80%|████████  | 189/236 [12:14<03:45,  4.80s/it]
test ppl:  81%|████████  | 190/236 [12:19<03:32,  4.62s/it]
test ppl:  81%|████████  | 191/236 [12:25<03:44,  4.99s/it]
test ppl:  81%|████████▏ | 192/236 [12:27<03:08,  4.28s/it]
test ppl:  82%|████████▏ | 193/236 [12:33<03:24,  4.76s/it]
test ppl:  82%|████████▏ | 194/236 [12:36<02:52,  4.11s/it]
test ppl:  83%|████████▎ | 195/236 [12:39<02:35,  3.79s/it]
test ppl:  83%|████████▎ | 196/236 [12:41<02:13,  3.33s/it]
test ppl:  83%|████████▎ | 197/236 [12:43<01:57,  3.02s/it]
test ppl:  84%|████████▍ | 198/236 [12:49<02:27,  3.87s/it]
test ppl:  84%|████████▍ | 199/236 [12:52<02:12,  3.58s/it]
test ppl:  85%|████████▍ | 200/236 [12:58<02:33,  4.25s/it]
test ppl:  85%|████████▌ | 201/236 [13:00<02:05,  3.58s/it]
test ppl:  86%|████████▌ | 202/236 [13:06<02:24,  4.25s/it]
test ppl:  86%|████████▌ | 203/236 [13:12<02:36,  4.74s/it]
test ppl:  86%|████████▋ | 204/236 [13:13<02:02,  3.82s/it]
test ppl:  87%|████████▋ | 205/236 [13:19<02:17,  4.44s/it]
test ppl:  87%|████████▋ | 206/236 [13:22<02:02,  4.09s/it]
test ppl:  88%|████████▊ | 207/236 [13:28<02:14,  4.62s/it]
test ppl:  88%|████████▊ | 208/236 [13:32<02:03,  4.42s/it]
test ppl:  89%|████████▊ | 209/236 [13:38<02:11,  4.87s/it]
test ppl:  89%|████████▉ | 210/236 [13:40<01:47,  4.12s/it]
test ppl:  89%|████████▉ | 211/236 [13:44<01:41,  4.08s/it]
test ppl:  90%|████████▉ | 212/236 [13:50<01:50,  4.60s/it]
test ppl:  90%|█████████ | 213/236 [13:56<01:51,  4.86s/it]
test ppl:  91%|█████████ | 214/236 [13:57<01:26,  3.93s/it]
test ppl:  91%|█████████ | 215/236 [14:03<01:34,  4.50s/it]
test ppl:  92%|█████████▏| 216/236 [14:05<01:13,  3.68s/it]
test ppl:  92%|█████████▏| 217/236 [14:11<01:22,  4.35s/it]
test ppl:  92%|█████████▏| 218/236 [14:15<01:15,  4.18s/it]
test ppl:  93%|█████████▎| 219/236 [14:21<01:19,  4.69s/it]
test ppl:  93%|█████████▎| 220/236 [14:25<01:11,  4.46s/it]
test ppl:  94%|█████████▎| 221/236 [14:26<00:52,  3.47s/it]
test ppl:  94%|█████████▍| 222/236 [14:32<00:58,  4.18s/it]
test ppl:  94%|█████████▍| 223/236 [14:37<01:00,  4.68s/it]
test ppl:  95%|█████████▍| 224/236 [14:41<00:53,  4.46s/it]
test ppl:  95%|█████████▌| 225/236 [14:47<00:52,  4.79s/it]
test ppl:  96%|█████████▌| 226/236 [14:49<00:41,  4.10s/it]
test ppl:  96%|█████████▌| 227/236 [14:51<00:30,  3.42s/it]
test ppl:  97%|█████████▋| 228/236 [14:57<00:33,  4.14s/it]
test ppl:  97%|█████████▋| 229/236 [15:03<00:32,  4.65s/it]
test ppl:  97%|█████████▋| 230/236 [15:07<00:26,  4.43s/it]
test ppl:  98%|█████████▊| 231/236 [15:10<00:20,  4.08s/it]
test ppl:  98%|█████████▊| 232/236 [15:12<00:13,  3.49s/it]
test ppl:  99%|█████████▊| 233/236 [15:14<00:09,  3.09s/it]
test ppl:  99%|█████████▉| 234/236 [15:16<00:05,  2.52s/it]
test ppl: 100%|█████████▉| 235/236 [15:21<00:03,  3.52s/it]
test ppl: 100%|██████████| 236/236 [15:22<00:00,  2.76s/it]
test ppl: 100%|██████████| 236/236 [15:22<00:00,  3.91s/it]
10/12/2024 08:06:44 - INFO - __main__ -    em: 0.2094
10/12/2024 08:06:44 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.4 10:  em: 0.2094

--------------------------------------------------------------------------------
Running experiment with knn_temp=10, lmbda=0.4, k=64
2024-10-12 08:06:51.405022: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 08:06:51.424614: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 08:06:51.446432: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 08:06:51.453087: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 08:06:51.469020: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 08:06:52.468799: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 08:06:53 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.4, knn_temp=10, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 08:06:53 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:35:23,  2.20it/s]
Adding feature api:   4%|▍         | 7548/187062 [00:00<00:09, 18065.50it/s]
Adding feature api:   9%|▊         | 16191/187062 [00:00<00:04, 35484.31it/s]
Adding feature api:  13%|█▎        | 24635/187062 [00:00<00:03, 48548.09it/s]
Adding feature api:  18%|█▊        | 33348/187062 [00:00<00:02, 59194.93it/s]
Adding feature api:  22%|██▏       | 41975/187062 [00:00<00:02, 66848.78it/s]
Adding feature api:  27%|██▋       | 50696/187062 [00:01<00:01, 72705.34it/s]
Adding feature api:  32%|███▏      | 59473/187062 [00:01<00:01, 77091.53it/s]
Adding feature api:  36%|███▋      | 68251/187062 [00:01<00:01, 80230.73it/s]
Adding feature api:  41%|████      | 77017/187062 [00:01<00:01, 82424.94it/s]
Adding feature api:  46%|████▌     | 85801/187062 [00:01<00:01, 84029.67it/s]
Adding feature api:  51%|█████     | 94561/187062 [00:01<00:01, 85091.90it/s]
Adding feature api:  55%|█████▌    | 103320/187062 [00:01<00:00, 85836.11it/s]
Adding feature api:  60%|█████▉    | 112058/187062 [00:01<00:00, 86297.17it/s]
Adding feature api:  65%|██████▍   | 120778/187062 [00:01<00:00, 86515.27it/s]
Adding feature api:  69%|██████▉   | 129539/187062 [00:01<00:00, 86842.44it/s]
Adding feature api:  74%|███████▍  | 138268/187062 [00:02<00:00, 86303.48it/s]
Adding feature api:  79%|███████▊  | 147033/187062 [00:02<00:00, 86702.37it/s]
Adding feature api:  83%|████████▎ | 155794/187062 [00:02<00:00, 86972.57it/s]
Adding feature api:  88%|████████▊ | 164508/187062 [00:02<00:00, 86875.00it/s]
Adding feature api:  93%|█████████▎| 173267/187062 [00:02<00:00, 87086.00it/s]
Adding feature api:  97%|█████████▋| 181984/187062 [00:02<00:00, 65823.67it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 66223.45it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:38:46,  2.20it/s]
Adding feature datatype:   4%|▍         | 7221/187062 [00:00<00:10, 17251.51it/s]
Adding feature datatype:   8%|▊         | 15509/187062 [00:00<00:05, 33950.15it/s]
Adding feature datatype:  13%|█▎        | 23868/187062 [00:00<00:03, 47183.11it/s]
Adding feature datatype:  17%|█▋        | 32218/187062 [00:00<00:02, 57197.96it/s]
Adding feature datatype:  22%|██▏       | 40591/187062 [00:00<00:02, 64696.20it/s]
Adding feature datatype:  26%|██▌       | 48985/187062 [00:01<00:01, 70230.00it/s]
Adding feature datatype:  31%|███       | 57427/187062 [00:01<00:01, 74361.99it/s]
Adding feature datatype:  35%|███▌      | 65862/187062 [00:01<00:01, 77294.85it/s]
Adding feature datatype:  40%|███▉      | 74289/187062 [00:01<00:01, 79353.70it/s]
Adding feature datatype:  44%|████▍     | 82722/187062 [00:01<00:01, 80828.88it/s]
Adding feature datatype:  49%|████▊     | 91168/187062 [00:01<00:01, 81908.56it/s]
Adding feature datatype:  53%|█████▎    | 99595/187062 [00:01<00:01, 82611.71it/s]
Adding feature datatype:  58%|█████▊    | 107991/187062 [00:01<00:00, 83011.75it/s]
Adding feature datatype:  62%|██████▏   | 116379/187062 [00:01<00:00, 82959.68it/s]
Adding feature datatype:  67%|██████▋   | 124779/187062 [00:01<00:00, 83267.16it/s]
Adding feature datatype:  71%|███████   | 133183/187062 [00:02<00:00, 83495.52it/s]
Adding feature datatype:  76%|███████▌  | 141631/187062 [00:02<00:00, 83788.50it/s]
Adding feature datatype:  80%|████████  | 150066/187062 [00:02<00:00, 83953.66it/s]
Adding feature datatype:  85%|████████▍ | 158527/187062 [00:02<00:00, 84147.90it/s]
Adding feature datatype:  89%|████████▉ | 166960/187062 [00:02<00:00, 84199.68it/s]
Adding feature datatype:  94%|█████████▍| 175407/187062 [00:02<00:00, 84277.38it/s]
Adding feature datatype:  98%|█████████▊| 183840/187062 [00:02<00:00, 58402.54it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 64505.28it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:15:44,  2.23it/s]
Adding feature literal:   4%|▍         | 7150/187062 [00:00<00:10, 17295.37it/s]
Adding feature literal:   8%|▊         | 15481/187062 [00:00<00:05, 34248.43it/s]
Adding feature literal:  13%|█▎        | 23875/187062 [00:00<00:03, 47584.42it/s]
Adding feature literal:  17%|█▋        | 32279/187062 [00:00<00:02, 57687.35it/s]
Adding feature literal:  22%|██▏       | 40691/187062 [00:00<00:02, 65182.23it/s]
Adding feature literal:  26%|██▌       | 49061/187062 [00:01<00:01, 70520.01it/s]
Adding feature literal:  31%|███       | 57465/187062 [00:01<00:01, 74462.44it/s]
Adding feature literal:  35%|███▌      | 65878/187062 [00:01<00:01, 77304.47it/s]
Adding feature literal:  40%|███▉      | 74291/187062 [00:01<00:01, 79322.45it/s]
Adding feature literal:  44%|████▍     | 82672/187062 [00:01<00:01, 80655.00it/s]
Adding feature literal:  49%|████▊     | 91080/187062 [00:01<00:01, 81675.03it/s]
Adding feature literal:  53%|█████▎    | 99519/187062 [00:01<00:01, 82482.50it/s]
Adding feature literal:  58%|█████▊    | 107888/187062 [00:01<00:00, 79708.06it/s]
Adding feature literal:  62%|██████▏   | 115963/187062 [00:01<00:00, 77371.85it/s]
Adding feature literal:  66%|██████▌   | 123783/187062 [00:01<00:00, 76409.23it/s]
Adding feature literal:  70%|███████   | 131481/187062 [00:02<00:00, 75788.45it/s]
Adding feature literal:  74%|███████▍  | 139099/187062 [00:02<00:00, 75242.27it/s]
Adding feature literal:  78%|███████▊  | 146650/187062 [00:02<00:00, 74740.25it/s]
Adding feature literal:  82%|████████▏ | 154142/187062 [00:02<00:00, 74463.65it/s]
Adding feature literal:  86%|████████▋ | 161600/187062 [00:02<00:00, 74380.80it/s]
Adding feature literal:  90%|█████████ | 169047/187062 [00:02<00:00, 74282.99it/s]
Adding feature literal:  94%|█████████▍| 176481/187062 [00:02<00:00, 74214.19it/s]
Adding feature literal:  98%|█████████▊| 183907/187062 [00:02<00:00, 52474.56it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 61865.88it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:29:32,  2.21it/s]
Adding feature operator:   4%|▍         | 7246/187062 [00:00<00:10, 17396.93it/s]
Adding feature operator:   8%|▊         | 15583/187062 [00:00<00:05, 34246.08it/s]
Adding feature operator:  13%|█▎        | 23932/187062 [00:00<00:03, 47408.79it/s]
Adding feature operator:  17%|█▋        | 32280/187062 [00:00<00:02, 57375.39it/s]
Adding feature operator:  22%|██▏       | 40670/187062 [00:00<00:02, 64880.46it/s]
Adding feature operator:  26%|██▋       | 49129/187062 [00:01<00:01, 70552.63it/s]
Adding feature operator:  31%|███       | 57525/187062 [00:01<00:01, 74457.04it/s]
Adding feature operator:  35%|███▌      | 65897/187062 [00:01<00:01, 77176.57it/s]
Adding feature operator:  40%|███▉      | 74283/187062 [00:01<00:01, 79150.42it/s]
Adding feature operator:  44%|████▍     | 82717/187062 [00:01<00:01, 80689.28it/s]
Adding feature operator:  49%|████▊     | 91123/187062 [00:01<00:01, 81692.09it/s]
Adding feature operator:  53%|█████▎    | 99466/187062 [00:01<00:01, 81744.31it/s]
Adding feature operator:  58%|█████▊    | 107834/187062 [00:01<00:00, 82317.61it/s]
Adding feature operator:  62%|██████▏   | 116261/187062 [00:01<00:00, 82898.33it/s]
Adding feature operator:  67%|██████▋   | 124655/187062 [00:01<00:00, 83208.15it/s]
Adding feature operator:  71%|███████   | 133055/187062 [00:02<00:00, 83443.33it/s]
Adding feature operator:  76%|███████▌  | 141467/187062 [00:02<00:00, 83643.77it/s]
Adding feature operator:  80%|████████  | 149907/187062 [00:02<00:00, 83867.31it/s]
Adding feature operator:  85%|████████▍ | 158311/187062 [00:02<00:00, 83915.37it/s]
Adding feature operator:  89%|████████▉ | 166715/187062 [00:02<00:00, 83950.48it/s]
Adding feature operator:  94%|█████████▎| 175118/187062 [00:02<00:00, 83841.76it/s]
Adding feature operator:  98%|█████████▊| 183508/187062 [00:02<00:00, 58975.65it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 64425.71it/s]
[2024-10-12 08:07:37,161] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 08:07:38 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 08:07:38 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 41/6548 [00:00<00:16, 389.17 examples/s]
Map:   1%|▏         | 90/6548 [00:00<00:27, 230.92 examples/s]
Map:   2%|▏         | 129/6548 [00:00<00:23, 276.67 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:19, 323.43 examples/s]
Map:   3%|▎         | 228/6548 [00:00<00:19, 325.60 examples/s]
Map:   4%|▍         | 286/6548 [00:00<00:18, 341.29 examples/s]
Map:   5%|▌         | 334/6548 [00:01<00:20, 297.40 examples/s]
Map:   6%|▌         | 373/6548 [00:01<00:19, 313.46 examples/s]
Map:   6%|▋         | 425/6548 [00:01<00:17, 360.02 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 335.64 examples/s]
Map:   8%|▊         | 510/6548 [00:01<00:17, 344.14 examples/s]
Map:   9%|▊         | 561/6548 [00:01<00:15, 384.58 examples/s]
Map:   9%|▉         | 604/6548 [00:01<00:15, 377.19 examples/s]
Map:  10%|█         | 660/6548 [00:02<00:18, 322.61 examples/s]
Map:  11%|█         | 701/6548 [00:02<00:17, 338.08 examples/s]
Map:  12%|█▏        | 758/6548 [00:02<00:16, 349.87 examples/s]
Map:  12%|█▏        | 813/6548 [00:02<00:14, 388.40 examples/s]
Map:  13%|█▎        | 870/6548 [00:02<00:15, 369.15 examples/s]
Map:  14%|█▍        | 920/6548 [00:02<00:16, 346.51 examples/s]
Map:  15%|█▍        | 969/6548 [00:02<00:14, 375.76 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:24, 225.21 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 250.93 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:19, 285.17 examples/s]
Map:  18%|█▊        | 1146/6548 [00:03<00:16, 322.71 examples/s]
Map:  18%|█▊        | 1185/6548 [00:03<00:16, 333.15 examples/s]
Map:  19%|█▉        | 1228/6548 [00:03<00:15, 346.65 examples/s]
Map:  19%|█▉        | 1273/6548 [00:03<00:14, 370.45 examples/s]
Map:  20%|██        | 1328/6548 [00:04<00:14, 356.15 examples/s]
Map:  21%|██        | 1369/6548 [00:04<00:16, 318.20 examples/s]
Map:  22%|██▏       | 1420/6548 [00:04<00:15, 320.54 examples/s]
Map:  22%|██▏       | 1459/6548 [00:04<00:16, 299.51 examples/s]
Map:  23%|██▎       | 1497/6548 [00:04<00:17, 281.77 examples/s]
Map:  23%|██▎       | 1533/6548 [00:04<00:17, 289.66 examples/s]
Map:  24%|██▍       | 1579/6548 [00:04<00:16, 293.85 examples/s]
Map:  25%|██▍       | 1610/6548 [00:05<00:17, 281.70 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:17, 284.21 examples/s]
Map:  26%|██▌       | 1688/6548 [00:05<00:17, 279.99 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:15, 304.74 examples/s]
Map:  27%|██▋       | 1770/6548 [00:05<00:14, 335.46 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:13, 342.63 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 340.87 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 341.07 examples/s]
Map:  30%|██▉       | 1947/6548 [00:06<00:12, 355.22 examples/s]
Map:  30%|███       | 1990/6548 [00:06<00:12, 370.83 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:20, 222.76 examples/s]
Map:  32%|███▏      | 2070/6548 [00:06<00:17, 252.58 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 264.55 examples/s]
Map:  33%|███▎      | 2136/6548 [00:06<00:16, 274.74 examples/s]
Map:  33%|███▎      | 2174/6548 [00:06<00:16, 265.99 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 278.78 examples/s]
Map:  34%|███▍      | 2251/6548 [00:07<00:16, 267.28 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:15, 276.26 examples/s]
Map:  36%|███▌      | 2331/6548 [00:07<00:13, 313.90 examples/s]
Map:  36%|███▋      | 2384/6548 [00:07<00:12, 325.37 examples/s]
Map:  37%|███▋      | 2423/6548 [00:07<00:12, 339.79 examples/s]
Map:  38%|███▊      | 2472/6548 [00:07<00:12, 314.86 examples/s]
Map:  38%|███▊      | 2506/6548 [00:08<00:12, 318.93 examples/s]
Map:  39%|███▉      | 2544/6548 [00:08<00:12, 322.99 examples/s]
Map:  40%|███▉      | 2594/6548 [00:08<00:10, 365.09 examples/s]
Map:  40%|████      | 2638/6548 [00:08<00:10, 381.61 examples/s]
Map:  41%|████      | 2698/6548 [00:08<00:10, 358.93 examples/s]
Map:  42%|████▏     | 2737/6548 [00:08<00:10, 349.72 examples/s]
Map:  42%|████▏     | 2773/6548 [00:08<00:10, 345.16 examples/s]
Map:  43%|████▎     | 2823/6548 [00:08<00:11, 334.82 examples/s]
Map:  44%|████▎     | 2860/6548 [00:09<00:13, 282.89 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 291.50 examples/s]
Map:  45%|████▌     | 2952/6548 [00:09<00:11, 306.92 examples/s]
Map:  46%|████▌     | 2988/6548 [00:09<00:11, 308.81 examples/s]
Map:  46%|████▌     | 3022/6548 [00:09<00:21, 163.47 examples/s]
Map:  47%|████▋     | 3058/6548 [00:10<00:18, 191.46 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 214.54 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 255.48 examples/s]
Map:  49%|████▊     | 3183/6548 [00:10<00:13, 251.72 examples/s]
Map:  49%|████▉     | 3219/6548 [00:10<00:12, 257.66 examples/s]
Map:  50%|████▉     | 3250/6548 [00:10<00:12, 266.25 examples/s]
Map:  50%|█████     | 3285/6548 [00:10<00:11, 277.89 examples/s]
Map:  51%|█████     | 3328/6548 [00:10<00:10, 313.55 examples/s]
Map:  52%|█████▏    | 3378/6548 [00:11<00:10, 315.29 examples/s]
Map:  52%|█████▏    | 3412/6548 [00:11<00:11, 281.44 examples/s]
Map:  53%|█████▎    | 3445/6548 [00:11<00:10, 289.37 examples/s]
Map:  53%|█████▎    | 3486/6548 [00:11<00:11, 268.21 examples/s]
Map:  54%|█████▍    | 3532/6548 [00:11<00:09, 311.55 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:11<00:08, 338.55 examples/s]
Map:  55%|█████▌    | 3622/6548 [00:11<00:08, 364.64 examples/s]
Map:  56%|█████▌    | 3682/6548 [00:12<00:07, 375.55 examples/s]
Map:  57%|█████▋    | 3726/6548 [00:12<00:07, 390.64 examples/s]
Map:  58%|█████▊    | 3786/6548 [00:12<00:07, 389.22 examples/s]
Map:  59%|█████▊    | 3839/6548 [00:12<00:07, 343.93 examples/s]
Map:  59%|█████▉    | 3887/6548 [00:12<00:08, 328.94 examples/s]
Map:  60%|██████    | 3929/6548 [00:12<00:07, 329.14 examples/s]
Map:  61%|██████    | 3964/6548 [00:12<00:07, 331.60 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 230.15 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 288.58 examples/s]
Map:  63%|██████▎   | 4095/6548 [00:13<00:07, 313.29 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 324.70 examples/s]
Map:  64%|██████▍   | 4194/6548 [00:13<00:07, 325.96 examples/s]
Map:  65%|██████▍   | 4231/6548 [00:13<00:07, 322.26 examples/s]
Map:  65%|██████▌   | 4276/6548 [00:13<00:06, 351.00 examples/s]
Map:  66%|██████▌   | 4317/6548 [00:13<00:06, 362.17 examples/s]
Map:  67%|██████▋   | 4374/6548 [00:14<00:06, 357.18 examples/s]
Map:  67%|██████▋   | 4411/6548 [00:14<00:05, 357.91 examples/s]
Map:  68%|██████▊   | 4457/6548 [00:14<00:05, 380.91 examples/s]
Map:  69%|██████▊   | 4499/6548 [00:14<00:06, 333.48 examples/s]
Map:  69%|██████▉   | 4547/6548 [00:14<00:06, 325.42 examples/s]
Map:  70%|███████   | 4584/6548 [00:14<00:06, 320.84 examples/s]
Map:  71%|███████   | 4633/6548 [00:14<00:05, 354.68 examples/s]
Map:  71%|███████▏  | 4670/6548 [00:14<00:05, 353.24 examples/s]
Map:  72%|███████▏  | 4712/6548 [00:15<00:05, 364.62 examples/s]
Map:  73%|███████▎  | 4777/6548 [00:15<00:04, 381.10 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 386.78 examples/s]
Map:  74%|███████▍  | 4877/6548 [00:15<00:04, 362.86 examples/s]
Map:  75%|███████▌  | 4931/6548 [00:15<00:04, 377.87 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:03, 396.49 examples/s]
Map:  77%|███████▋  | 5031/6548 [00:16<00:06, 241.46 examples/s]
Map:  78%|███████▊  | 5079/6548 [00:16<00:05, 254.69 examples/s]
Map:  78%|███████▊  | 5112/6548 [00:16<00:05, 266.74 examples/s]
Map:  79%|███████▉  | 5160/6548 [00:16<00:04, 278.09 examples/s]
Map:  80%|███████▉  | 5207/6548 [00:16<00:04, 287.46 examples/s]
Map:  80%|████████  | 5247/6548 [00:16<00:04, 308.32 examples/s]
Map:  81%|████████  | 5286/6548 [00:16<00:03, 325.27 examples/s]
Map:  81%|████████▏ | 5322/6548 [00:17<00:03, 332.64 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 305.39 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 297.65 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 329.04 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 326.54 examples/s]
Map:  85%|████████▍ | 5547/6548 [00:17<00:02, 349.96 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:17<00:03, 303.81 examples/s]
Map:  86%|████████▌ | 5639/6548 [00:18<00:02, 354.94 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 320.00 examples/s]
Map:  88%|████████▊ | 5736/6548 [00:18<00:02, 332.73 examples/s]
Map:  88%|████████▊ | 5774/6548 [00:18<00:02, 341.74 examples/s]
Map:  89%|████████▉ | 5813/6548 [00:18<00:02, 346.23 examples/s]
Map:  89%|████████▉ | 5856/6548 [00:18<00:01, 356.11 examples/s]
Map:  90%|█████████ | 5913/6548 [00:18<00:01, 360.88 examples/s]
Map:  91%|█████████ | 5964/6548 [00:18<00:01, 336.74 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 228.99 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:01, 259.21 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 288.11 examples/s]
Map:  94%|█████████▎| 6124/6548 [00:19<00:01, 281.60 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:19<00:01, 296.36 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:19<00:01, 316.38 examples/s]
Map:  96%|█████████▌| 6262/6548 [00:20<00:00, 326.00 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 342.52 examples/s]
Map:  97%|█████████▋| 6355/6548 [00:20<00:00, 338.98 examples/s]
Map:  98%|█████████▊| 6410/6548 [00:20<00:00, 345.52 examples/s]
Map:  99%|█████████▊| 6455/6548 [00:20<00:00, 368.72 examples/s]
Map:  99%|█████████▉| 6495/6548 [00:20<00:00, 367.49 examples/s]
Map: 100%|█████████▉| 6538/6548 [00:20<00:00, 375.35 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 312.75 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 320.08 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 343.48 examples/s]
Map:  13%|█▎        | 116/903 [00:00<00:02, 338.99 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 352.22 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 403.39 examples/s]
Map:  29%|██▉       | 263/903 [00:00<00:01, 378.21 examples/s]
Map:  34%|███▍      | 308/903 [00:00<00:01, 393.13 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 335.54 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 314.92 examples/s]
Map:  50%|████▉     | 451/903 [00:01<00:01, 294.30 examples/s]
Map:  54%|█████▍    | 486/903 [00:01<00:01, 292.66 examples/s]
Map:  59%|█████▉    | 531/903 [00:01<00:01, 326.40 examples/s]
Map:  63%|██████▎   | 570/903 [00:01<00:00, 339.73 examples/s]
Map:  68%|██████▊   | 614/903 [00:01<00:00, 351.45 examples/s]
Map:  72%|███████▏  | 652/903 [00:01<00:00, 354.94 examples/s]
Map:  77%|███████▋  | 691/903 [00:02<00:00, 361.21 examples/s]
Map:  82%|████████▏ | 736/903 [00:02<00:00, 378.54 examples/s]
Map:  86%|████████▌ | 778/903 [00:02<00:00, 383.76 examples/s]
Map:  91%|█████████ | 822/903 [00:02<00:00, 398.98 examples/s]
Map:  97%|█████████▋| 875/903 [00:02<00:00, 372.50 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 320.77 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 302.17 examples/s]
Map:   4%|▍         | 79/1882 [00:00<00:05, 355.36 examples/s]
Map:   7%|▋         | 124/1882 [00:00<00:05, 324.93 examples/s]
Map:   9%|▉         | 171/1882 [00:00<00:04, 363.20 examples/s]
Map:  12%|█▏        | 223/1882 [00:00<00:04, 338.91 examples/s]
Map:  14%|█▍        | 267/1882 [00:00<00:04, 360.67 examples/s]
Map:  17%|█▋        | 325/1882 [00:00<00:04, 357.16 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:05, 298.67 examples/s]
Map:  22%|██▏       | 417/1882 [00:01<00:05, 289.41 examples/s]
Map:  24%|██▍       | 449/1882 [00:01<00:04, 294.25 examples/s]
Map:  26%|██▋       | 497/1882 [00:01<00:04, 336.60 examples/s]
Map:  29%|██▉       | 543/1882 [00:01<00:04, 320.51 examples/s]
Map:  31%|███       | 586/1882 [00:01<00:03, 344.60 examples/s]
Map:  34%|███▍      | 644/1882 [00:01<00:03, 393.79 examples/s]
Map:  37%|███▋      | 696/1882 [00:02<00:03, 371.34 examples/s]
Map:  40%|████      | 759/1882 [00:02<00:02, 385.47 examples/s]
Map:  42%|████▏     | 799/1882 [00:02<00:03, 322.96 examples/s]
Map:  45%|████▍     | 846/1882 [00:02<00:02, 353.05 examples/s]
Map:  48%|████▊     | 897/1882 [00:02<00:02, 346.82 examples/s]
Map:  50%|████▉     | 940/1882 [00:02<00:02, 364.95 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 379.85 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 247.44 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 260.63 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 273.74 examples/s]
Map:  61%|██████    | 1139/1882 [00:03<00:02, 281.74 examples/s]
Map:  62%|██████▏   | 1176/1882 [00:03<00:02, 301.35 examples/s]
Map:  64%|██████▍   | 1213/1882 [00:03<00:02, 280.26 examples/s]
Map:  67%|██████▋   | 1255/1882 [00:03<00:02, 309.60 examples/s]
Map:  69%|██████▉   | 1307/1882 [00:04<00:01, 317.73 examples/s]
Map:  72%|███████▏  | 1347/1882 [00:04<00:01, 332.35 examples/s]
Map:  74%|███████▍  | 1396/1882 [00:04<00:01, 326.72 examples/s]
Map:  76%|███████▌  | 1430/1882 [00:04<00:01, 282.66 examples/s]
Map:  78%|███████▊  | 1471/1882 [00:04<00:01, 309.38 examples/s]
Map:  80%|███████▉  | 1504/1882 [00:04<00:01, 267.17 examples/s]
Map:  82%|████████▏ | 1547/1882 [00:04<00:01, 271.66 examples/s]
Map:  84%|████████▍ | 1587/1882 [00:05<00:00, 297.68 examples/s]
Map:  87%|████████▋ | 1632/1882 [00:05<00:00, 332.85 examples/s]
Map:  90%|████████▉ | 1686/1882 [00:05<00:00, 300.12 examples/s]
Map:  92%|█████████▏| 1724/1882 [00:05<00:00, 310.69 examples/s]
Map:  94%|█████████▍| 1772/1882 [00:05<00:00, 286.27 examples/s]
Map:  96%|█████████▌| 1807/1882 [00:05<00:00, 296.42 examples/s]
Map:  98%|█████████▊| 1851/1882 [00:05<00:00, 329.08 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 307.56 examples/s]
10/12/2024 08:08:40 - INFO - __main__ -     ***** Testing *****
10/12/2024 08:08:40 - INFO - __main__ -     Batch size = 8
10/12/2024 08:08:40 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 08:08:40 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 08:08:40 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 08:08:41 - INFO - knnlm -   Reading datastore took 0.9656555652618408 s
10/12/2024 08:08:42 - INFO - knnlm -   Moving index to GPU took 0.9210212230682373 s
10/12/2024 08:08:42 - INFO - __main__ -   ******************************break-into
10/12/2024 08:08:42 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 08:08:42 - INFO - __main__ -     Num examples = 236
10/12/2024 08:08:42 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<31:24,  8.02s/it]
test ppl:   1%|          | 2/236 [00:09<16:53,  4.33s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:47,  3.04s/it]
test ppl:   2%|▏         | 4/236 [00:17<16:00,  4.14s/it]
test ppl:   2%|▏         | 5/236 [00:22<18:18,  4.76s/it]
test ppl:   3%|▎         | 6/236 [00:26<17:17,  4.51s/it]
test ppl:   3%|▎         | 7/236 [00:32<18:52,  4.95s/it]
test ppl:   3%|▎         | 8/236 [00:38<19:51,  5.23s/it]
test ppl:   4%|▍         | 9/236 [00:40<15:36,  4.12s/it]
test ppl:   4%|▍         | 10/236 [00:43<14:18,  3.80s/it]
test ppl:   5%|▍         | 11/236 [00:46<12:51,  3.43s/it]
test ppl:   5%|▌         | 12/236 [00:51<15:31,  4.16s/it]
test ppl:   6%|▌         | 13/236 [00:57<17:21,  4.67s/it]
test ppl:   6%|▌         | 14/236 [01:03<18:37,  5.03s/it]
test ppl:   6%|▋         | 15/236 [01:05<14:58,  4.06s/it]
test ppl:   7%|▋         | 16/236 [01:11<16:54,  4.61s/it]
test ppl:   7%|▋         | 17/236 [01:14<15:43,  4.31s/it]
test ppl:   8%|▊         | 18/236 [01:16<12:47,  3.52s/it]
test ppl:   8%|▊         | 19/236 [01:22<15:14,  4.21s/it]
test ppl:   8%|▊         | 20/236 [01:24<13:21,  3.71s/it]
test ppl:   9%|▉         | 21/236 [01:30<15:35,  4.35s/it]
test ppl:   9%|▉         | 22/236 [01:36<17:07,  4.80s/it]
test ppl:  10%|▉         | 23/236 [01:39<14:44,  4.15s/it]
test ppl:  10%|█         | 24/236 [01:41<12:54,  3.66s/it]
test ppl:  11%|█         | 25/236 [01:43<10:50,  3.08s/it]
test ppl:  11%|█         | 26/236 [01:49<13:41,  3.91s/it]
test ppl:  11%|█▏        | 27/236 [01:52<13:07,  3.77s/it]
test ppl:  12%|█▏        | 28/236 [01:54<10:53,  3.14s/it]
test ppl:  12%|█▏        | 29/236 [01:56<09:59,  2.90s/it]
test ppl:  13%|█▎        | 30/236 [01:58<08:31,  2.49s/it]
test ppl:  13%|█▎        | 31/236 [02:00<08:00,  2.34s/it]
test ppl:  14%|█▎        | 32/236 [02:05<10:25,  3.07s/it]
test ppl:  14%|█▍        | 33/236 [02:10<13:13,  3.91s/it]
test ppl:  14%|█▍        | 34/236 [02:14<13:15,  3.94s/it]
test ppl:  15%|█▍        | 35/236 [02:17<11:45,  3.51s/it]
test ppl:  15%|█▌        | 36/236 [02:23<14:01,  4.21s/it]
test ppl:  16%|█▌        | 37/236 [02:29<15:36,  4.71s/it]
test ppl:  16%|█▌        | 38/236 [02:31<12:54,  3.91s/it]
test ppl:  17%|█▋        | 39/236 [02:32<10:42,  3.26s/it]
test ppl:  17%|█▋        | 40/236 [02:35<10:21,  3.17s/it]
test ppl:  17%|█▋        | 41/236 [02:37<09:01,  2.78s/it]
test ppl:  18%|█▊        | 42/236 [02:43<12:00,  3.71s/it]
test ppl:  18%|█▊        | 43/236 [02:49<13:59,  4.35s/it]
test ppl:  19%|█▊        | 44/236 [02:52<12:29,  3.90s/it]
test ppl:  19%|█▉        | 45/236 [02:54<10:34,  3.32s/it]
test ppl:  19%|█▉        | 46/236 [03:00<12:57,  4.09s/it]
test ppl:  20%|█▉        | 47/236 [03:01<10:27,  3.32s/it]
test ppl:  20%|██        | 48/236 [03:07<12:44,  4.07s/it]
test ppl:  21%|██        | 49/236 [03:10<11:22,  3.65s/it]
test ppl:  21%|██        | 50/236 [03:16<13:25,  4.33s/it]
test ppl:  22%|██▏       | 51/236 [03:20<13:40,  4.43s/it]
test ppl:  22%|██▏       | 52/236 [03:26<14:53,  4.86s/it]
test ppl:  22%|██▏       | 53/236 [03:32<15:43,  5.16s/it]
test ppl:  23%|██▎       | 54/236 [03:34<12:20,  4.07s/it]
test ppl:  23%|██▎       | 55/236 [03:39<13:41,  4.54s/it]
test ppl:  24%|██▎       | 56/236 [03:45<14:49,  4.94s/it]
test ppl:  24%|██▍       | 57/236 [03:51<15:33,  5.22s/it]
test ppl:  25%|██▍       | 58/236 [03:53<12:45,  4.30s/it]
test ppl:  25%|██▌       | 59/236 [03:59<14:03,  4.77s/it]
test ppl:  25%|██▌       | 60/236 [04:02<12:39,  4.32s/it]
test ppl:  26%|██▌       | 61/236 [04:05<11:03,  3.79s/it]
test ppl:  26%|██▋       | 62/236 [04:09<11:16,  3.89s/it]
test ppl:  27%|██▋       | 63/236 [04:11<09:58,  3.46s/it]
test ppl:  27%|██▋       | 64/236 [04:14<09:04,  3.16s/it]
test ppl:  28%|██▊       | 65/236 [04:15<07:26,  2.61s/it]
test ppl:  28%|██▊       | 66/236 [04:18<07:47,  2.75s/it]
test ppl:  28%|██▊       | 67/236 [04:24<10:22,  3.68s/it]
test ppl:  29%|██▉       | 68/236 [04:30<12:07,  4.33s/it]
test ppl:  29%|██▉       | 69/236 [04:36<13:20,  4.79s/it]
test ppl:  30%|██▉       | 70/236 [04:37<10:20,  3.74s/it]
test ppl:  30%|███       | 71/236 [04:40<09:59,  3.63s/it]
test ppl:  31%|███       | 72/236 [04:44<10:03,  3.68s/it]
test ppl:  31%|███       | 73/236 [04:50<11:46,  4.33s/it]
test ppl:  31%|███▏      | 74/236 [04:56<12:54,  4.78s/it]
test ppl:  32%|███▏      | 75/236 [05:02<13:41,  5.10s/it]
test ppl:  32%|███▏      | 76/236 [05:05<12:21,  4.64s/it]
test ppl:  33%|███▎      | 77/236 [05:08<10:24,  3.93s/it]
test ppl:  33%|███▎      | 78/236 [05:09<08:25,  3.20s/it]
test ppl:  33%|███▎      | 79/236 [05:14<09:28,  3.62s/it]
test ppl:  34%|███▍      | 80/236 [05:15<07:46,  2.99s/it]
test ppl:  34%|███▍      | 81/236 [05:21<09:56,  3.85s/it]
test ppl:  35%|███▍      | 82/236 [05:27<11:26,  4.46s/it]
test ppl:  35%|███▌      | 83/236 [05:33<12:27,  4.88s/it]
test ppl:  36%|███▌      | 84/236 [05:35<10:23,  4.10s/it]
test ppl:  36%|███▌      | 85/236 [05:39<10:22,  4.12s/it]
test ppl:  36%|███▋      | 86/236 [05:42<09:05,  3.64s/it]
test ppl:  37%|███▋      | 87/236 [05:44<08:15,  3.32s/it]
test ppl:  37%|███▋      | 88/236 [05:50<10:03,  4.08s/it]
test ppl:  38%|███▊      | 89/236 [05:52<08:26,  3.45s/it]
test ppl:  38%|███▊      | 90/236 [05:58<10:08,  4.17s/it]
test ppl:  39%|███▊      | 91/236 [06:02<10:13,  4.23s/it]
test ppl:  39%|███▉      | 92/236 [06:05<09:07,  3.81s/it]
test ppl:  39%|███▉      | 93/236 [06:11<10:32,  4.42s/it]
test ppl:  40%|███▉      | 94/236 [06:17<11:29,  4.86s/it]
test ppl:  40%|████      | 95/236 [06:20<10:25,  4.43s/it]
test ppl:  41%|████      | 96/236 [06:25<10:15,  4.39s/it]
test ppl:  41%|████      | 97/236 [06:31<11:11,  4.83s/it]
test ppl:  42%|████▏     | 98/236 [06:36<11:50,  5.15s/it]
test ppl:  42%|████▏     | 99/236 [06:42<12:14,  5.36s/it]
test ppl:  42%|████▏     | 100/236 [06:44<09:21,  4.13s/it]
test ppl:  43%|████▎     | 101/236 [06:49<10:27,  4.65s/it]
test ppl:  43%|████▎     | 102/236 [06:53<09:54,  4.44s/it]
test ppl:  44%|████▎     | 103/236 [06:55<07:49,  3.53s/it]
test ppl:  44%|████▍     | 104/236 [06:59<08:11,  3.72s/it]
test ppl:  44%|████▍     | 105/236 [07:03<08:34,  3.93s/it]
test ppl:  45%|████▍     | 106/236 [07:09<09:27,  4.36s/it]
test ppl:  45%|████▌     | 107/236 [07:11<08:01,  3.73s/it]
test ppl:  46%|████▌     | 108/236 [07:17<09:13,  4.32s/it]
test ppl:  46%|████▌     | 109/236 [07:21<08:55,  4.22s/it]
test ppl:  47%|████▋     | 110/236 [07:22<07:12,  3.43s/it]
test ppl:  47%|████▋     | 111/236 [07:26<07:28,  3.59s/it]
test ppl:  47%|████▋     | 112/236 [07:32<08:48,  4.26s/it]
test ppl:  48%|████▊     | 113/236 [07:34<07:11,  3.51s/it]
test ppl:  48%|████▊     | 114/236 [07:37<07:02,  3.46s/it]
test ppl:  49%|████▊     | 115/236 [07:43<08:25,  4.18s/it]
test ppl:  49%|████▉     | 116/236 [07:49<09:22,  4.68s/it]
test ppl:  50%|████▉     | 117/236 [07:51<07:36,  3.83s/it]
test ppl:  50%|█████     | 118/236 [07:57<08:43,  4.44s/it]
test ppl:  50%|█████     | 119/236 [07:58<07:08,  3.66s/it]
test ppl:  51%|█████     | 120/236 [08:00<06:08,  3.18s/it]
test ppl:  51%|█████▏    | 121/236 [08:06<07:37,  3.98s/it]
test ppl:  52%|█████▏    | 122/236 [08:11<08:00,  4.22s/it]
test ppl:  52%|█████▏    | 123/236 [08:13<06:52,  3.65s/it]
test ppl:  53%|█████▎    | 124/236 [08:16<06:17,  3.37s/it]
test ppl:  53%|█████▎    | 125/236 [08:20<06:25,  3.48s/it]
test ppl:  53%|█████▎    | 126/236 [08:24<06:27,  3.52s/it]
test ppl:  54%|█████▍    | 127/236 [08:26<05:36,  3.09s/it]
test ppl:  54%|█████▍    | 128/236 [08:31<07:03,  3.92s/it]
test ppl:  55%|█████▍    | 129/236 [08:34<06:12,  3.48s/it]
test ppl:  55%|█████▌    | 130/236 [08:37<06:08,  3.48s/it]
test ppl:  56%|█████▌    | 131/236 [08:43<07:20,  4.20s/it]
test ppl:  56%|█████▌    | 132/236 [08:46<06:22,  3.68s/it]
test ppl:  56%|█████▋    | 133/236 [08:50<06:25,  3.75s/it]
test ppl:  57%|█████▋    | 134/236 [08:53<06:13,  3.66s/it]
test ppl:  57%|█████▋    | 135/236 [08:59<07:11,  4.27s/it]
test ppl:  58%|█████▊    | 136/236 [09:00<05:39,  3.39s/it]
test ppl:  58%|█████▊    | 137/236 [09:06<06:49,  4.14s/it]
test ppl:  58%|█████▊    | 138/236 [09:12<07:36,  4.66s/it]
test ppl:  59%|█████▉    | 139/236 [09:14<06:31,  4.04s/it]
test ppl:  59%|█████▉    | 140/236 [09:16<05:24,  3.38s/it]
test ppl:  60%|█████▉    | 141/236 [09:19<05:06,  3.23s/it]
test ppl:  60%|██████    | 142/236 [09:25<06:17,  4.02s/it]
test ppl:  61%|██████    | 143/236 [09:28<05:57,  3.85s/it]
test ppl:  61%|██████    | 144/236 [09:31<05:21,  3.49s/it]
test ppl:  61%|██████▏   | 145/236 [09:37<06:22,  4.20s/it]
test ppl:  62%|██████▏   | 146/236 [09:43<07:02,  4.70s/it]
test ppl:  62%|██████▏   | 147/236 [09:49<07:29,  5.05s/it]
test ppl:  63%|██████▎   | 148/236 [09:56<08:28,  5.78s/it]
test ppl:  63%|██████▎   | 149/236 [10:00<07:28,  5.16s/it]
test ppl:  64%|██████▎   | 150/236 [10:07<08:22,  5.85s/it]
test ppl:  64%|██████▍   | 151/236 [10:15<08:58,  6.33s/it]
test ppl:  64%|██████▍   | 152/236 [10:22<09:17,  6.64s/it]
test ppl:  65%|██████▍   | 153/236 [10:30<09:29,  6.86s/it]
test ppl:  65%|██████▌   | 154/236 [10:33<07:50,  5.74s/it]
test ppl:  66%|██████▌   | 155/236 [10:36<06:45,  5.01s/it]
test ppl:  66%|██████▌   | 156/236 [10:39<05:49,  4.36s/it]
test ppl:  67%|██████▋   | 157/236 [10:42<05:25,  4.12s/it]
test ppl:  67%|██████▋   | 158/236 [10:50<06:35,  5.07s/it]
test ppl:  67%|██████▋   | 159/236 [10:57<07:21,  5.73s/it]
test ppl:  68%|██████▊   | 160/236 [10:58<05:37,  4.44s/it]
test ppl:  68%|██████▊   | 161/236 [11:00<04:31,  3.61s/it]
test ppl:  69%|██████▊   | 162/236 [11:04<04:32,  3.68s/it]
test ppl:  69%|██████▉   | 163/236 [11:07<04:11,  3.45s/it]
test ppl:  69%|██████▉   | 164/236 [11:12<04:45,  3.97s/it]
test ppl:  70%|██████▉   | 165/236 [11:17<05:00,  4.23s/it]
test ppl:  70%|███████   | 166/236 [11:19<04:05,  3.51s/it]
test ppl:  71%|███████   | 167/236 [11:21<03:38,  3.16s/it]
test ppl:  71%|███████   | 168/236 [11:23<03:15,  2.87s/it]
test ppl:  72%|███████▏  | 169/236 [11:27<03:20,  3.00s/it]
test ppl:  72%|███████▏  | 170/236 [11:34<04:43,  4.29s/it]
test ppl:  72%|███████▏  | 171/236 [11:36<03:53,  3.59s/it]
test ppl:  73%|███████▎  | 172/236 [11:38<03:31,  3.31s/it]
test ppl:  73%|███████▎  | 173/236 [11:43<03:47,  3.60s/it]
test ppl:  74%|███████▎  | 174/236 [11:47<04:01,  3.90s/it]
test ppl:  74%|███████▍  | 175/236 [11:50<03:38,  3.59s/it]
test ppl:  75%|███████▍  | 176/236 [11:57<04:41,  4.68s/it]
test ppl:  75%|███████▌  | 177/236 [12:05<05:22,  5.47s/it]
test ppl:  75%|███████▌  | 178/236 [12:12<05:49,  6.02s/it]
test ppl:  76%|███████▌  | 179/236 [12:19<06:05,  6.40s/it]
test ppl:  76%|███████▋  | 180/236 [12:25<05:42,  6.12s/it]
test ppl:  77%|███████▋  | 181/236 [12:30<05:22,  5.87s/it]
test ppl:  77%|███████▋  | 182/236 [12:32<04:19,  4.81s/it]
test ppl:  78%|███████▊  | 183/236 [12:35<03:47,  4.29s/it]
test ppl:  78%|███████▊  | 184/236 [12:38<03:11,  3.68s/it]
test ppl:  78%|███████▊  | 185/236 [12:41<03:05,  3.63s/it]
test ppl:  79%|███████▉  | 186/236 [12:43<02:39,  3.19s/it]
test ppl:  79%|███████▉  | 187/236 [12:50<03:20,  4.10s/it]
test ppl:  80%|███████▉  | 188/236 [12:56<03:45,  4.69s/it]
test ppl:  80%|████████  | 189/236 [13:02<03:58,  5.07s/it]
test ppl:  81%|████████  | 190/236 [13:06<03:42,  4.84s/it]
test ppl:  81%|████████  | 191/236 [13:12<03:53,  5.18s/it]
test ppl:  81%|████████▏ | 192/236 [13:15<03:15,  4.44s/it]
test ppl:  82%|████████▏ | 193/236 [13:21<03:30,  4.90s/it]
test ppl:  82%|████████▏ | 194/236 [13:23<02:57,  4.23s/it]
test ppl:  83%|████████▎ | 195/236 [13:26<02:39,  3.90s/it]
test ppl:  83%|████████▎ | 196/236 [13:29<02:18,  3.46s/it]
test ppl:  83%|████████▎ | 197/236 [13:31<02:03,  3.16s/it]
test ppl:  84%|████████▍ | 198/236 [13:37<02:32,  4.01s/it]
test ppl:  84%|████████▍ | 199/236 [13:40<02:16,  3.70s/it]
test ppl:  85%|████████▍ | 200/236 [13:46<02:38,  4.39s/it]
test ppl:  85%|████████▌ | 201/236 [13:48<02:08,  3.68s/it]
test ppl:  86%|████████▌ | 202/236 [13:54<02:28,  4.36s/it]
test ppl:  86%|████████▌ | 203/236 [14:00<02:38,  4.81s/it]
test ppl:  86%|████████▋ | 204/236 [14:02<02:03,  3.87s/it]
test ppl:  87%|████████▋ | 205/236 [14:08<02:18,  4.48s/it]
test ppl:  87%|████████▋ | 206/236 [14:11<02:04,  4.13s/it]
test ppl:  88%|████████▊ | 207/236 [14:17<02:14,  4.65s/it]
test ppl:  88%|████████▊ | 208/236 [14:21<02:04,  4.44s/it]
test ppl:  89%|████████▊ | 209/236 [14:27<02:11,  4.88s/it]
test ppl:  89%|████████▉ | 210/236 [14:29<01:47,  4.12s/it]
test ppl:  89%|████████▉ | 211/236 [14:33<01:42,  4.08s/it]
test ppl:  90%|████████▉ | 212/236 [14:39<01:50,  4.60s/it]
test ppl:  90%|█████████ | 213/236 [14:44<01:51,  4.86s/it]
test ppl:  91%|█████████ | 214/236 [14:46<01:26,  3.92s/it]
test ppl:  91%|█████████ | 215/236 [14:52<01:34,  4.49s/it]
test ppl:  92%|█████████▏| 216/236 [14:54<01:13,  3.67s/it]
test ppl:  92%|█████████▏| 217/236 [15:00<01:22,  4.34s/it]
test ppl:  92%|█████████▏| 218/236 [15:03<01:15,  4.18s/it]
test ppl:  93%|█████████▎| 219/236 [15:09<01:19,  4.69s/it]
test ppl:  93%|█████████▎| 220/236 [15:13<01:11,  4.47s/it]
test ppl:  94%|█████████▎| 221/236 [15:14<00:52,  3.47s/it]
test ppl:  94%|█████████▍| 222/236 [15:20<00:58,  4.19s/it]
test ppl:  94%|█████████▍| 223/236 [15:26<01:00,  4.69s/it]
test ppl:  95%|█████████▍| 224/236 [15:30<00:53,  4.47s/it]
test ppl:  95%|█████████▌| 225/236 [15:36<00:52,  4.78s/it]
test ppl:  96%|█████████▌| 226/236 [15:38<00:40,  4.10s/it]
test ppl:  96%|█████████▌| 227/236 [15:40<00:30,  3.42s/it]
test ppl:  97%|█████████▋| 228/236 [15:42<00:23,  2.96s/it]
test ppl:  97%|█████████▋| 229/236 [15:48<00:26,  3.82s/it]
test ppl:  97%|█████████▋| 230/236 [15:51<00:23,  3.84s/it]
test ppl:  98%|█████████▊| 231/236 [15:55<00:18,  3.67s/it]
test ppl:  98%|█████████▊| 232/236 [15:56<00:12,  3.08s/it]
test ppl:  99%|█████████▊| 233/236 [15:59<00:08,  2.80s/it]
test ppl:  99%|█████████▉| 234/236 [16:00<00:04,  2.32s/it]
test ppl: 100%|█████████▉| 235/236 [16:06<00:03,  3.37s/it]
test ppl: 100%|██████████| 236/236 [16:07<00:00,  2.65s/it]
test ppl: 100%|██████████| 236/236 [16:07<00:00,  4.10s/it]
10/12/2024 08:24:49 - INFO - __main__ -    em: 0.2109
10/12/2024 08:24:49 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.4 10:  em: 0.2109

--------------------------------------------------------------------------------
Running experiment with knn_temp=10, lmbda=0.6, k=16
2024-10-12 08:24:57.072771: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 08:24:57.092239: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 08:24:57.114126: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 08:24:57.120736: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 08:24:57.136763: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 08:24:58.130738: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 08:24:59 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.6, knn_temp=10, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 08:24:59 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:34:40,  2.20it/s]
Adding feature api:   4%|▍         | 7226/187062 [00:00<00:10, 17301.10it/s]
Adding feature api:   8%|▊         | 15767/187062 [00:00<00:04, 34659.93it/s]
Adding feature api:  13%|█▎        | 24348/187062 [00:00<00:03, 48311.87it/s]
Adding feature api:  18%|█▊        | 32931/187062 [00:00<00:02, 58668.00it/s]
Adding feature api:  22%|██▏       | 41331/187062 [00:00<00:02, 65830.29it/s]
Adding feature api:  27%|██▋       | 49908/187062 [00:01<00:01, 71566.56it/s]
Adding feature api:  31%|███       | 58427/187062 [00:01<00:01, 75534.30it/s]
Adding feature api:  36%|███▌      | 67015/187062 [00:01<00:01, 78572.60it/s]
Adding feature api:  40%|████      | 75374/187062 [00:01<00:01, 80051.18it/s]
Adding feature api:  45%|████▍     | 83936/187062 [00:01<00:01, 81702.13it/s]
Adding feature api:  49%|████▉     | 92557/187062 [00:01<00:01, 83042.16it/s]
Adding feature api:  54%|█████▍    | 101159/187062 [00:01<00:01, 83929.47it/s]
Adding feature api:  59%|█████▊    | 109677/187062 [00:01<00:00, 83688.67it/s]
Adding feature api:  63%|██████▎   | 118243/187062 [00:01<00:00, 84274.70it/s]
Adding feature api:  68%|██████▊   | 126797/187062 [00:01<00:00, 84651.39it/s]
Adding feature api:  72%|███████▏  | 135408/187062 [00:02<00:00, 85084.62it/s]
Adding feature api:  77%|███████▋  | 143948/187062 [00:02<00:00, 84558.91it/s]
Adding feature api:  82%|████████▏ | 152550/187062 [00:02<00:00, 84991.74it/s]
Adding feature api:  86%|████████▌ | 161179/187062 [00:02<00:00, 85378.72it/s]
Adding feature api:  91%|█████████ | 169729/187062 [00:02<00:00, 84717.84it/s]
Adding feature api:  95%|█████████▌| 178210/187062 [00:02<00:00, 82110.58it/s]
Adding feature api: 100%|█████████▉| 186443/187062 [00:02<00:00, 54031.69it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 65112.15it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:22:44,  2.22it/s]
Adding feature datatype:   4%|▍         | 7261/187062 [00:00<00:10, 17497.12it/s]
Adding feature datatype:   8%|▊         | 15493/187062 [00:00<00:05, 34097.86it/s]
Adding feature datatype:  13%|█▎        | 23756/187062 [00:00<00:03, 47096.74it/s]
Adding feature datatype:  17%|█▋        | 32103/187062 [00:00<00:02, 57161.76it/s]
Adding feature datatype:  21%|██▏       | 40047/187062 [00:00<00:02, 63471.86it/s]
Adding feature datatype:  26%|██▌       | 48309/187062 [00:01<00:02, 68982.98it/s]
Adding feature datatype:  30%|███       | 56663/187062 [00:01<00:01, 73226.25it/s]
Adding feature datatype:  35%|███▍      | 65021/187062 [00:01<00:01, 76269.90it/s]
Adding feature datatype:  39%|███▉      | 73293/187062 [00:01<00:01, 78176.69it/s]
Adding feature datatype:  44%|████▎     | 81452/187062 [00:01<00:01, 78701.75it/s]
Adding feature datatype:  48%|████▊     | 89763/187062 [00:01<00:01, 80005.90it/s]
Adding feature datatype:  52%|█████▏    | 98064/187062 [00:01<00:01, 80898.82it/s]
Adding feature datatype:  57%|█████▋    | 106409/187062 [00:01<00:00, 81658.37it/s]
Adding feature datatype:  61%|██████▏   | 114770/187062 [00:01<00:00, 82238.72it/s]
Adding feature datatype:  66%|██████▌   | 123054/187062 [00:01<00:00, 81455.90it/s]
Adding feature datatype:  70%|███████   | 131349/187062 [00:02<00:00, 81898.22it/s]
Adding feature datatype:  75%|███████▍  | 139625/187062 [00:02<00:00, 82153.71it/s]
Adding feature datatype:  79%|███████▉  | 147863/187062 [00:02<00:00, 82211.98it/s]
Adding feature datatype:  83%|████████▎ | 156100/187062 [00:02<00:00, 81381.01it/s]
Adding feature datatype:  88%|████████▊ | 164413/187062 [00:02<00:00, 81897.18it/s]
Adding feature datatype:  92%|█████████▏| 172755/187062 [00:02<00:00, 82347.20it/s]
Adding feature datatype:  97%|█████████▋| 180997/187062 [00:02<00:00, 66756.95it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63660.42it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:10:13,  2.24it/s]
Adding feature literal:   4%|▍         | 7219/187062 [00:00<00:10, 17514.40it/s]
Adding feature literal:   8%|▊         | 15422/187062 [00:00<00:05, 34119.13it/s]
Adding feature literal:  13%|█▎        | 23665/187062 [00:00<00:03, 47106.44it/s]
Adding feature literal:  17%|█▋        | 31924/187062 [00:00<00:02, 56951.62it/s]
Adding feature literal:  21%|██▏       | 40206/187062 [00:00<00:02, 64292.45it/s]
Adding feature literal:  26%|██▌       | 48530/187062 [00:01<00:01, 69757.11it/s]
Adding feature literal:  30%|███       | 56817/187062 [00:01<00:01, 73582.15it/s]
Adding feature literal:  35%|███▍      | 65122/187062 [00:01<00:01, 76365.21it/s]
Adding feature literal:  39%|███▉      | 73437/187062 [00:01<00:01, 78372.16it/s]
Adding feature literal:  44%|████▎     | 81730/187062 [00:01<00:01, 79724.44it/s]
Adding feature literal:  48%|████▊     | 89941/187062 [00:01<00:01, 79624.35it/s]
Adding feature literal:  52%|█████▏    | 98136/187062 [00:01<00:01, 80311.59it/s]
Adding feature literal:  57%|█████▋    | 106436/187062 [00:01<00:00, 81108.87it/s]
Adding feature literal:  61%|██████▏   | 114783/187062 [00:01<00:00, 81812.23it/s]
Adding feature literal:  66%|██████▌   | 123023/187062 [00:01<00:00, 81667.85it/s]
Adding feature literal:  70%|███████   | 131385/187062 [00:02<00:00, 82249.36it/s]
Adding feature literal:  75%|███████▍  | 139744/187062 [00:02<00:00, 82646.75it/s]
Adding feature literal:  79%|███████▉  | 148092/187062 [00:02<00:00, 82894.40it/s]
Adding feature literal:  84%|████████▎ | 156459/187062 [00:02<00:00, 83124.57it/s]
Adding feature literal:  88%|████████▊ | 164796/187062 [00:02<00:00, 83196.52it/s]
Adding feature literal:  93%|█████████▎| 173148/187062 [00:02<00:00, 83292.18it/s]
Adding feature literal:  97%|█████████▋| 181483/187062 [00:02<00:00, 65193.76it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63948.26it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:09:53,  2.24it/s]
Adding feature operator:   4%|▍         | 7351/187062 [00:00<00:10, 17838.18it/s]
Adding feature operator:   8%|▊         | 15592/187062 [00:00<00:04, 34459.78it/s]
Adding feature operator:  13%|█▎        | 23919/187062 [00:00<00:03, 47582.73it/s]
Adding feature operator:  17%|█▋        | 32247/187062 [00:00<00:02, 57487.66it/s]
Adding feature operator:  22%|██▏       | 40626/187062 [00:00<00:02, 64953.31it/s]
Adding feature operator:  26%|██▌       | 49001/187062 [00:01<00:01, 70375.57it/s]
Adding feature operator:  31%|███       | 57347/187062 [00:01<00:01, 74192.56it/s]
Adding feature operator:  35%|███▌      | 65705/187062 [00:01<00:01, 76953.59it/s]
Adding feature operator:  40%|███▉      | 74092/187062 [00:01<00:01, 78997.67it/s]
Adding feature operator:  44%|████▍     | 82493/187062 [00:01<00:01, 80486.42it/s]
Adding feature operator:  49%|████▊     | 90887/187062 [00:01<00:01, 81514.73it/s]
Adding feature operator:  53%|█████▎    | 99290/187062 [00:01<00:01, 82263.46it/s]
Adding feature operator:  58%|█████▊    | 107656/187062 [00:01<00:00, 82678.11it/s]
Adding feature operator:  62%|██████▏   | 116008/187062 [00:01<00:00, 82927.39it/s]
Adding feature operator:  66%|██████▋   | 124360/187062 [00:01<00:00, 83104.07it/s]
Adding feature operator:  71%|███████   | 132731/187062 [00:02<00:00, 83284.89it/s]
Adding feature operator:  75%|███████▌  | 141089/187062 [00:02<00:00, 83283.91it/s]
Adding feature operator:  80%|███████▉  | 149468/187062 [00:02<00:00, 83433.83it/s]
Adding feature operator:  84%|████████▍ | 157876/187062 [00:02<00:00, 83624.42it/s]
Adding feature operator:  89%|████████▉ | 166272/187062 [00:02<00:00, 83724.09it/s]
Adding feature operator:  93%|█████████▎| 174652/187062 [00:02<00:00, 83623.54it/s]
Adding feature operator:  98%|█████████▊| 183020/187062 [00:02<00:00, 59863.43it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 64501.34it/s]
[2024-10-12 08:25:43,245] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 08:25:44 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 08:25:44 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 413.34 examples/s]
Map:   1%|▏         | 87/6548 [00:00<00:29, 221.84 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:23, 270.33 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:19, 323.54 examples/s]
Map:   3%|▎         | 220/6548 [00:00<00:17, 351.78 examples/s]
Map:   4%|▍         | 281/6548 [00:00<00:17, 356.49 examples/s]
Map:   5%|▌         | 332/6548 [00:01<00:20, 309.36 examples/s]
Map:   6%|▌         | 387/6548 [00:01<00:18, 324.71 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:17, 351.87 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:17, 340.43 examples/s]
Map:   8%|▊         | 512/6548 [00:01<00:17, 351.74 examples/s]
Map:   9%|▊         | 565/6548 [00:01<00:15, 394.38 examples/s]
Map:   9%|▉         | 607/6548 [00:01<00:15, 383.23 examples/s]
Map:  10%|▉         | 653/6548 [00:01<00:17, 340.29 examples/s]
Map:  11%|█         | 693/6548 [00:02<00:16, 354.29 examples/s]
Map:  11%|█         | 734/6548 [00:02<00:15, 366.49 examples/s]
Map:  12%|█▏        | 788/6548 [00:02<00:14, 410.27 examples/s]
Map:  13%|█▎        | 831/6548 [00:02<00:14, 399.40 examples/s]
Map:  13%|█▎        | 876/6548 [00:02<00:13, 407.09 examples/s]
Map:  14%|█▍        | 932/6548 [00:02<00:15, 364.30 examples/s]
Map:  15%|█▍        | 972/6548 [00:02<00:15, 370.88 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:24, 230.53 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 258.07 examples/s]
Map:  17%|█▋        | 1100/6548 [00:03<00:18, 294.70 examples/s]
Map:  18%|█▊        | 1150/6548 [00:03<00:16, 337.27 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 350.04 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:14, 360.07 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:14, 371.88 examples/s]
Map:  20%|██        | 1338/6548 [00:03<00:15, 334.52 examples/s]
Map:  21%|██        | 1381/6548 [00:04<00:16, 311.88 examples/s]
Map:  22%|██▏       | 1420/6548 [00:04<00:15, 327.97 examples/s]
Map:  22%|██▏       | 1458/6548 [00:04<00:16, 304.43 examples/s]
Map:  23%|██▎       | 1498/6548 [00:04<00:17, 290.67 examples/s]
Map:  23%|██▎       | 1533/6548 [00:04<00:16, 296.04 examples/s]
Map:  24%|██▍       | 1576/6548 [00:04<00:17, 290.28 examples/s]
Map:  25%|██▍       | 1610/6548 [00:04<00:17, 282.54 examples/s]
Map:  25%|██▌       | 1640/6548 [00:05<00:17, 279.12 examples/s]
Map:  26%|██▌       | 1673/6548 [00:05<00:18, 257.11 examples/s]
Map:  26%|██▌       | 1712/6548 [00:05<00:16, 288.12 examples/s]
Map:  27%|██▋       | 1755/6548 [00:05<00:14, 322.76 examples/s]
Map:  27%|██▋       | 1799/6548 [00:05<00:13, 350.47 examples/s]
Map:  28%|██▊       | 1843/6548 [00:05<00:12, 368.49 examples/s]
Map:  29%|██▉       | 1891/6548 [00:05<00:13, 340.57 examples/s]
Map:  30%|██▉       | 1933/6548 [00:05<00:12, 359.22 examples/s]
Map:  30%|███       | 1973/6548 [00:05<00:12, 369.29 examples/s]
Map:  31%|███       | 2017/6548 [00:06<00:19, 237.38 examples/s]
Map:  32%|███▏      | 2065/6548 [00:06<00:17, 257.65 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 274.00 examples/s]
Map:  33%|███▎      | 2137/6548 [00:06<00:15, 283.30 examples/s]
Map:  33%|███▎      | 2180/6548 [00:06<00:15, 278.09 examples/s]
Map:  34%|███▍      | 2213/6548 [00:06<00:15, 281.43 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:14, 286.24 examples/s]
Map:  35%|███▌      | 2293/6548 [00:07<00:14, 296.25 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:13, 319.48 examples/s]
Map:  36%|███▋      | 2376/6548 [00:07<00:13, 316.81 examples/s]
Map:  37%|███▋      | 2418/6548 [00:07<00:12, 340.22 examples/s]
Map:  37%|███▋      | 2453/6548 [00:07<00:12, 315.31 examples/s]
Map:  38%|███▊      | 2495/6548 [00:07<00:12, 326.74 examples/s]
Map:  39%|███▊      | 2537/6548 [00:07<00:11, 344.42 examples/s]
Map:  40%|███▉      | 2592/6548 [00:08<00:10, 393.42 examples/s]
Map:  40%|████      | 2634/6548 [00:08<00:09, 396.49 examples/s]
Map:  41%|████      | 2682/6548 [00:08<00:10, 363.02 examples/s]
Map:  42%|████▏     | 2741/6548 [00:08<00:10, 366.82 examples/s]
Map:  43%|████▎     | 2789/6548 [00:08<00:10, 347.45 examples/s]
Map:  43%|████▎     | 2828/6548 [00:08<00:13, 285.02 examples/s]
Map:  44%|████▎     | 2860/6548 [00:08<00:12, 288.49 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 294.44 examples/s]
Map:  45%|████▌     | 2950/6548 [00:09<00:11, 305.43 examples/s]
Map:  46%|████▌     | 2986/6548 [00:09<00:11, 316.97 examples/s]
Map:  46%|████▌     | 3026/6548 [00:09<00:21, 167.48 examples/s]
Map:  47%|████▋     | 3058/6548 [00:09<00:18, 187.54 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 210.91 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 252.03 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:13, 255.31 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 247.53 examples/s]
Map:  50%|████▉     | 3245/6548 [00:10<00:13, 251.97 examples/s]
Map:  50%|█████     | 3278/6548 [00:10<00:12, 268.59 examples/s]
Map:  51%|█████     | 3321/6548 [00:10<00:10, 297.90 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:10<00:10, 298.01 examples/s]
Map:  52%|█████▏    | 3403/6548 [00:11<00:11, 276.19 examples/s]
Map:  53%|█████▎    | 3440/6548 [00:11<00:10, 297.43 examples/s]
Map:  53%|█████▎    | 3485/6548 [00:11<00:11, 275.37 examples/s]
Map:  54%|█████▍    | 3530/6548 [00:11<00:09, 312.67 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:11<00:08, 340.50 examples/s]
Map:  55%|█████▌    | 3620/6548 [00:11<00:08, 362.16 examples/s]
Map:  56%|█████▌    | 3659/6548 [00:11<00:07, 365.45 examples/s]
Map:  57%|█████▋    | 3703/6548 [00:11<00:07, 380.89 examples/s]
Map:  57%|█████▋    | 3743/6548 [00:12<00:07, 383.18 examples/s]
Map:  58%|█████▊    | 3799/6548 [00:12<00:07, 375.28 examples/s]
Map:  59%|█████▉    | 3850/6548 [00:12<00:08, 324.15 examples/s]
Map:  59%|█████▉    | 3887/6548 [00:12<00:08, 329.35 examples/s]
Map:  60%|██████    | 3932/6548 [00:12<00:08, 297.93 examples/s]
Map:  61%|██████    | 3978/6548 [00:12<00:07, 332.40 examples/s]
Map:  62%|██████▏   | 4030/6548 [00:13<00:09, 252.73 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 294.90 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 319.31 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:08, 296.30 examples/s]
Map:  64%|██████▍   | 4205/6548 [00:13<00:07, 311.32 examples/s]
Map:  65%|██████▌   | 4265/6548 [00:13<00:06, 335.27 examples/s]
Map:  66%|██████▌   | 4323/6548 [00:13<00:06, 348.78 examples/s]
Map:  67%|██████▋   | 4378/6548 [00:14<00:06, 352.21 examples/s]
Map:  68%|██████▊   | 4432/6548 [00:14<00:06, 351.37 examples/s]
Map:  68%|██████▊   | 4482/6548 [00:14<00:06, 335.65 examples/s]
Map:  69%|██████▉   | 4526/6548 [00:14<00:06, 315.80 examples/s]
Map:  70%|██████▉   | 4563/6548 [00:14<00:06, 327.20 examples/s]
Map:  71%|███████   | 4619/6548 [00:14<00:05, 338.83 examples/s]
Map:  71%|███████   | 4658/6548 [00:14<00:05, 348.89 examples/s]
Map:  72%|███████▏  | 4712/6548 [00:15<00:05, 339.77 examples/s]
Map:  73%|███████▎  | 4751/6548 [00:15<00:05, 347.32 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 398.95 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 388.28 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 353.57 examples/s]
Map:  76%|███████▌  | 4952/6548 [00:15<00:04, 381.52 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:15<00:06, 241.19 examples/s]
Map:  77%|███████▋  | 5036/6548 [00:16<00:05, 261.84 examples/s]
Map:  77%|███████▋  | 5069/6548 [00:16<00:05, 271.64 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 273.49 examples/s]
Map:  79%|███████▉  | 5174/6548 [00:16<00:04, 291.50 examples/s]
Map:  80%|███████▉  | 5207/6548 [00:16<00:04, 289.48 examples/s]
Map:  80%|████████  | 5247/6548 [00:16<00:04, 310.58 examples/s]
Map:  81%|████████  | 5287/6548 [00:16<00:03, 330.42 examples/s]
Map:  81%|████████▏ | 5336/6548 [00:17<00:03, 321.56 examples/s]
Map:  82%|████████▏ | 5388/6548 [00:17<00:03, 320.73 examples/s]
Map:  83%|████████▎ | 5429/6548 [00:17<00:03, 297.01 examples/s]
Map:  84%|████████▎ | 5472/6548 [00:17<00:03, 322.39 examples/s]
Map:  84%|████████▍ | 5519/6548 [00:17<00:03, 313.26 examples/s]
Map:  85%|████████▍ | 5561/6548 [00:17<00:02, 331.45 examples/s]
Map:  86%|████████▌ | 5610/6548 [00:17<00:02, 316.96 examples/s]
Map:  86%|████████▌ | 5647/6548 [00:18<00:02, 325.68 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 309.94 examples/s]
Map:  87%|████████▋ | 5720/6548 [00:18<00:02, 327.52 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 345.85 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 350.85 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:01, 356.85 examples/s]
Map:  90%|████████▉ | 5889/6548 [00:18<00:01, 365.35 examples/s]
Map:  91%|█████████ | 5927/6548 [00:18<00:01, 366.40 examples/s]
Map:  91%|█████████ | 5973/6548 [00:18<00:01, 342.09 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 239.05 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 270.62 examples/s]
Map:  94%|█████████▎| 6124/6548 [00:19<00:01, 270.73 examples/s]
Map:  94%|█████████▍| 6164/6548 [00:19<00:01, 288.10 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:19<00:01, 306.18 examples/s]
Map:  96%|█████████▌| 6262/6548 [00:19<00:00, 316.99 examples/s]
Map:  96%|█████████▋| 6303/6548 [00:20<00:00, 336.83 examples/s]
Map:  97%|█████████▋| 6365/6548 [00:20<00:00, 359.59 examples/s]
Map:  98%|█████████▊| 6402/6548 [00:20<00:00, 353.58 examples/s]
Map:  98%|█████████▊| 6449/6548 [00:20<00:00, 376.67 examples/s]
Map:  99%|█████████▉| 6495/6548 [00:20<00:00, 377.63 examples/s]
Map: 100%|█████████▉| 6537/6548 [00:20<00:00, 386.56 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 314.24 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 326.20 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 318.48 examples/s]
Map:  13%|█▎        | 118/903 [00:00<00:02, 306.23 examples/s]
Map:  18%|█▊        | 163/903 [00:00<00:02, 347.43 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 375.67 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 386.16 examples/s]
Map:  34%|███▍      | 310/903 [00:00<00:01, 374.61 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 319.81 examples/s]
Map:  44%|████▎     | 393/903 [00:01<00:01, 289.04 examples/s]
Map:  48%|████▊     | 435/903 [00:01<00:01, 317.71 examples/s]
Map:  53%|█████▎    | 478/903 [00:01<00:01, 304.82 examples/s]
Map:  57%|█████▋    | 513/903 [00:01<00:01, 314.96 examples/s]
Map:  62%|██████▏   | 560/903 [00:01<00:00, 349.65 examples/s]
Map:  68%|██████▊   | 610/903 [00:01<00:00, 381.71 examples/s]
Map:  73%|███████▎  | 663/903 [00:01<00:00, 361.54 examples/s]
Map:  80%|███████▉  | 718/903 [00:02<00:00, 360.73 examples/s]
Map:  85%|████████▍ | 766/903 [00:02<00:00, 384.02 examples/s]
Map:  90%|█████████ | 814/903 [00:02<00:00, 358.62 examples/s]
Map:  95%|█████████▌| 862/903 [00:02<00:00, 368.92 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 229.62 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 317.32 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 301.46 examples/s]
Map:   4%|▍         | 81/1882 [00:00<00:04, 367.42 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:04, 352.61 examples/s]
Map:   9%|▊         | 161/1882 [00:00<00:04, 371.75 examples/s]
Map:  11%|█         | 205/1882 [00:00<00:05, 333.51 examples/s]
Map:  14%|█▎        | 255/1882 [00:00<00:04, 379.41 examples/s]
Map:  16%|█▋        | 309/1882 [00:00<00:04, 360.63 examples/s]
Map:  19%|█▉        | 357/1882 [00:01<00:04, 344.01 examples/s]
Map:  21%|██        | 395/1882 [00:01<00:04, 311.01 examples/s]
Map:  23%|██▎       | 439/1882 [00:01<00:04, 299.68 examples/s]
Map:  25%|██▌       | 475/1882 [00:01<00:04, 311.38 examples/s]
Map:  27%|██▋       | 509/1882 [00:01<00:04, 297.88 examples/s]
Map:  29%|██▉       | 552/1882 [00:01<00:04, 320.15 examples/s]
Map:  32%|███▏      | 598/1882 [00:01<00:03, 346.73 examples/s]
Map:  35%|███▍      | 653/1882 [00:01<00:03, 375.70 examples/s]
Map:  37%|███▋      | 696/1882 [00:02<00:03, 387.75 examples/s]
Map:  40%|████      | 761/1882 [00:02<00:02, 399.66 examples/s]
Map:  43%|████▎     | 809/1882 [00:02<00:03, 355.83 examples/s]
Map:  45%|████▌     | 850/1882 [00:02<00:02, 368.22 examples/s]
Map:  47%|████▋     | 891/1882 [00:02<00:02, 378.31 examples/s]
Map:  49%|████▉     | 931/1882 [00:02<00:02, 373.19 examples/s]
Map:  52%|█████▏    | 982/1882 [00:02<00:02, 407.53 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 252.87 examples/s]
Map:  58%|█████▊    | 1085/1882 [00:03<00:03, 264.70 examples/s]
Map:  60%|██████    | 1135/1882 [00:03<00:02, 277.12 examples/s]
Map:  62%|██████▏   | 1173/1882 [00:03<00:02, 292.12 examples/s]
Map:  65%|██████▌   | 1224/1882 [00:03<00:02, 276.14 examples/s]
Map:  67%|██████▋   | 1257/1882 [00:03<00:02, 286.44 examples/s]
Map:  69%|██████▉   | 1300/1882 [00:03<00:01, 317.26 examples/s]
Map:  71%|███████▏  | 1341/1882 [00:04<00:01, 338.52 examples/s]
Map:  74%|███████▎  | 1385/1882 [00:04<00:01, 320.58 examples/s]
Map:  76%|███████▌  | 1424/1882 [00:04<00:01, 298.39 examples/s]
Map:  78%|███████▊  | 1471/1882 [00:04<00:01, 295.03 examples/s]
Map:  80%|████████  | 1507/1882 [00:04<00:01, 266.51 examples/s]
Map:  82%|████████▏ | 1537/1882 [00:04<00:01, 265.75 examples/s]
Map:  84%|████████▎ | 1575/1882 [00:04<00:01, 287.41 examples/s]
Map:  86%|████████▌ | 1619/1882 [00:05<00:00, 320.42 examples/s]
Map:  88%|████████▊ | 1655/1882 [00:05<00:00, 313.07 examples/s]
Map:  91%|█████████ | 1710/1882 [00:05<00:00, 315.25 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 275.28 examples/s]
Map:  95%|█████████▍| 1785/1882 [00:05<00:00, 279.34 examples/s]
Map:  97%|█████████▋| 1830/1882 [00:05<00:00, 317.40 examples/s]
Map: 100%|█████████▉| 1875/1882 [00:05<00:00, 347.36 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 309.69 examples/s]
10/12/2024 08:26:46 - INFO - __main__ -     ***** Testing *****
10/12/2024 08:26:46 - INFO - __main__ -     Batch size = 8
10/12/2024 08:26:46 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 08:26:47 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 08:26:47 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 08:26:48 - INFO - knnlm -   Reading datastore took 0.9634149074554443 s
10/12/2024 08:26:49 - INFO - knnlm -   Moving index to GPU took 0.8925790786743164 s
10/12/2024 08:26:49 - INFO - __main__ -   ******************************break-into
10/12/2024 08:26:49 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 08:26:49 - INFO - __main__ -     Num examples = 236
10/12/2024 08:26:49 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:53,  7.89s/it]
test ppl:   1%|          | 2/236 [00:10<18:42,  4.80s/it]
test ppl:   1%|▏         | 3/236 [00:12<13:15,  3.41s/it]
test ppl:   2%|▏         | 4/236 [00:14<10:40,  2.76s/it]
test ppl:   2%|▏         | 5/236 [00:19<14:55,  3.88s/it]
test ppl:   3%|▎         | 6/236 [00:25<17:28,  4.56s/it]
test ppl:   3%|▎         | 7/236 [00:28<14:48,  3.88s/it]
test ppl:   3%|▎         | 8/236 [00:32<14:40,  3.86s/it]
test ppl:   4%|▍         | 9/236 [00:33<12:07,  3.20s/it]
test ppl:   4%|▍         | 10/236 [00:38<13:39,  3.63s/it]
test ppl:   5%|▍         | 11/236 [00:43<15:14,  4.07s/it]
test ppl:   5%|▌         | 12/236 [00:49<17:14,  4.62s/it]
test ppl:   6%|▌         | 13/236 [00:55<18:35,  5.00s/it]
test ppl:   6%|▌         | 14/236 [01:01<19:30,  5.27s/it]
test ppl:   6%|▋         | 15/236 [01:02<15:14,  4.14s/it]
test ppl:   7%|▋         | 16/236 [01:08<17:08,  4.68s/it]
test ppl:   7%|▋         | 17/236 [01:14<18:12,  4.99s/it]
test ppl:   8%|▊         | 18/236 [01:16<14:34,  4.01s/it]
test ppl:   8%|▊         | 19/236 [01:21<16:31,  4.57s/it]
test ppl:   8%|▊         | 20/236 [01:27<17:52,  4.97s/it]
test ppl:   9%|▉         | 21/236 [01:30<15:33,  4.34s/it]
test ppl:   9%|▉         | 22/236 [01:36<17:09,  4.81s/it]
test ppl:  10%|▉         | 23/236 [01:39<14:58,  4.22s/it]
test ppl:  10%|█         | 24/236 [01:42<13:37,  3.86s/it]
test ppl:  11%|█         | 25/236 [01:44<11:48,  3.36s/it]
test ppl:  11%|█         | 26/236 [01:49<13:09,  3.76s/it]
test ppl:  11%|█▏        | 27/236 [01:53<13:20,  3.83s/it]
test ppl:  12%|█▏        | 28/236 [01:54<11:01,  3.18s/it]
test ppl:  12%|█▏        | 29/236 [01:57<10:22,  3.01s/it]
test ppl:  13%|█▎        | 30/236 [01:59<08:47,  2.56s/it]
test ppl:  13%|█▎        | 31/236 [02:03<11:03,  3.24s/it]
test ppl:  14%|█▎        | 32/236 [02:08<12:51,  3.78s/it]
test ppl:  14%|█▍        | 33/236 [02:12<12:42,  3.75s/it]
test ppl:  14%|█▍        | 34/236 [02:15<12:03,  3.58s/it]
test ppl:  15%|█▍        | 35/236 [02:18<10:57,  3.27s/it]
test ppl:  15%|█▌        | 36/236 [02:24<13:30,  4.05s/it]
test ppl:  16%|█▌        | 37/236 [02:30<15:17,  4.61s/it]
test ppl:  16%|█▌        | 38/236 [02:32<12:55,  3.92s/it]
test ppl:  17%|█▋        | 39/236 [02:35<11:42,  3.57s/it]
test ppl:  17%|█▋        | 40/236 [02:36<09:40,  2.96s/it]
test ppl:  17%|█▋        | 41/236 [02:39<09:47,  3.01s/it]
test ppl:  18%|█▊        | 42/236 [02:45<12:34,  3.89s/it]
test ppl:  18%|█▊        | 43/236 [02:51<14:25,  4.49s/it]
test ppl:  19%|█▊        | 44/236 [02:55<13:29,  4.21s/it]
test ppl:  19%|█▉        | 45/236 [02:57<11:22,  3.57s/it]
test ppl:  19%|█▉        | 46/236 [03:03<13:33,  4.28s/it]
test ppl:  20%|█▉        | 47/236 [03:04<10:52,  3.46s/it]
test ppl:  20%|██        | 48/236 [03:10<13:04,  4.17s/it]
test ppl:  21%|██        | 49/236 [03:15<13:35,  4.36s/it]
test ppl:  21%|██        | 50/236 [03:21<15:00,  4.84s/it]
test ppl:  22%|██▏       | 51/236 [03:24<13:40,  4.43s/it]
test ppl:  22%|██▏       | 52/236 [03:27<12:07,  3.95s/it]
test ppl:  22%|██▏       | 53/236 [03:32<12:27,  4.08s/it]
test ppl:  23%|██▎       | 54/236 [03:38<14:01,  4.62s/it]
test ppl:  23%|██▎       | 55/236 [03:43<15:05,  5.00s/it]
test ppl:  24%|██▎       | 56/236 [03:47<13:59,  4.66s/it]
test ppl:  24%|██▍       | 57/236 [03:53<15:01,  5.03s/it]
test ppl:  25%|██▍       | 58/236 [03:56<12:49,  4.32s/it]
test ppl:  25%|██▌       | 59/236 [04:02<14:09,  4.80s/it]
test ppl:  25%|██▌       | 60/236 [04:04<12:03,  4.11s/it]
test ppl:  26%|██▌       | 61/236 [04:10<13:33,  4.65s/it]
test ppl:  26%|██▋       | 62/236 [04:16<14:35,  5.03s/it]
test ppl:  27%|██▋       | 63/236 [04:19<12:17,  4.26s/it]
test ppl:  27%|██▋       | 64/236 [04:20<10:10,  3.55s/it]
test ppl:  28%|██▊       | 65/236 [04:22<08:17,  2.91s/it]
test ppl:  28%|██▊       | 66/236 [04:28<10:45,  3.79s/it]
test ppl:  28%|██▊       | 67/236 [04:34<12:27,  4.42s/it]
test ppl:  29%|██▉       | 68/236 [04:40<13:37,  4.86s/it]
test ppl:  29%|██▉       | 69/236 [04:45<14:23,  5.17s/it]
test ppl:  30%|██▉       | 70/236 [04:51<14:53,  5.38s/it]
test ppl:  30%|███       | 71/236 [04:54<12:59,  4.72s/it]
test ppl:  31%|███       | 72/236 [04:57<11:25,  4.18s/it]
test ppl:  31%|███       | 73/236 [05:03<12:44,  4.69s/it]
test ppl:  31%|███▏      | 74/236 [05:06<10:56,  4.05s/it]
test ppl:  32%|███▏      | 75/236 [05:12<12:22,  4.61s/it]
test ppl:  32%|███▏      | 76/236 [05:18<13:18,  4.99s/it]
test ppl:  33%|███▎      | 77/236 [05:20<11:00,  4.15s/it]
test ppl:  33%|███▎      | 78/236 [05:21<08:50,  3.36s/it]
test ppl:  33%|███▎      | 79/236 [05:26<09:54,  3.78s/it]
test ppl:  34%|███▍      | 80/236 [05:28<08:29,  3.27s/it]
test ppl:  34%|███▍      | 81/236 [05:34<10:28,  4.05s/it]
test ppl:  35%|███▍      | 82/236 [05:39<11:00,  4.29s/it]
test ppl:  35%|███▌      | 83/236 [05:45<12:11,  4.78s/it]
test ppl:  36%|███▌      | 84/236 [05:47<10:08,  4.01s/it]
test ppl:  36%|███▌      | 85/236 [05:51<10:16,  4.08s/it]
test ppl:  36%|███▋      | 86/236 [05:53<08:39,  3.46s/it]
test ppl:  37%|███▋      | 87/236 [05:56<08:20,  3.36s/it]
test ppl:  37%|███▋      | 88/236 [06:02<10:08,  4.11s/it]
test ppl:  38%|███▊      | 89/236 [06:08<11:23,  4.65s/it]
test ppl:  38%|███▊      | 90/236 [06:14<12:13,  5.02s/it]
test ppl:  39%|███▊      | 91/236 [06:19<12:19,  5.10s/it]
test ppl:  39%|███▉      | 92/236 [06:22<10:31,  4.39s/it]
test ppl:  39%|███▉      | 93/236 [06:28<11:30,  4.83s/it]
test ppl:  40%|███▉      | 94/236 [06:34<12:12,  5.15s/it]
test ppl:  40%|████      | 95/236 [06:40<12:36,  5.37s/it]
test ppl:  41%|████      | 96/236 [06:45<12:20,  5.29s/it]
test ppl:  41%|████      | 97/236 [06:51<12:39,  5.47s/it]
test ppl:  42%|████▏     | 98/236 [06:57<12:52,  5.60s/it]
test ppl:  42%|████▏     | 99/236 [07:02<12:58,  5.68s/it]
test ppl:  42%|████▏     | 100/236 [07:04<10:11,  4.50s/it]
test ppl:  43%|████▎     | 101/236 [07:10<11:02,  4.91s/it]
test ppl:  43%|████▎     | 102/236 [07:14<10:13,  4.58s/it]
test ppl:  44%|████▎     | 103/236 [07:15<08:06,  3.66s/it]
test ppl:  44%|████▍     | 104/236 [07:19<08:10,  3.71s/it]
test ppl:  44%|████▍     | 105/236 [07:23<08:10,  3.75s/it]
test ppl:  45%|████▍     | 106/236 [07:29<09:31,  4.39s/it]
test ppl:  45%|████▌     | 107/236 [07:32<08:21,  3.89s/it]
test ppl:  46%|████▌     | 108/236 [07:37<09:03,  4.25s/it]
test ppl:  46%|████▌     | 109/236 [07:43<10:03,  4.75s/it]
test ppl:  47%|████▋     | 110/236 [07:45<08:16,  3.94s/it]
test ppl:  47%|████▋     | 111/236 [07:51<09:25,  4.53s/it]
test ppl:  47%|████▋     | 112/236 [07:53<07:43,  3.74s/it]
test ppl:  48%|████▊     | 113/236 [07:56<07:11,  3.51s/it]
test ppl:  48%|████▊     | 114/236 [08:01<08:36,  4.23s/it]
test ppl:  49%|████▊     | 115/236 [08:04<07:14,  3.59s/it]
test ppl:  49%|████▉     | 116/236 [08:09<08:35,  4.29s/it]
test ppl:  50%|████▉     | 117/236 [08:13<08:21,  4.21s/it]
test ppl:  50%|█████     | 118/236 [08:19<09:16,  4.72s/it]
test ppl:  50%|█████     | 119/236 [08:21<07:37,  3.91s/it]
test ppl:  51%|█████     | 120/236 [08:25<07:23,  3.82s/it]
test ppl:  51%|█████▏    | 121/236 [08:31<08:30,  4.44s/it]
test ppl:  52%|█████▏    | 122/236 [08:37<09:15,  4.88s/it]
test ppl:  52%|█████▏    | 123/236 [08:39<07:49,  4.15s/it]
test ppl:  53%|█████▎    | 124/236 [08:44<07:50,  4.20s/it]
test ppl:  53%|█████▎    | 125/236 [08:45<06:25,  3.47s/it]
test ppl:  53%|█████▎    | 126/236 [08:51<07:44,  4.22s/it]
test ppl:  54%|█████▍    | 127/236 [08:57<08:34,  4.72s/it]
test ppl:  54%|█████▍    | 128/236 [08:59<06:58,  3.87s/it]
test ppl:  55%|█████▍    | 129/236 [09:02<06:27,  3.62s/it]
test ppl:  55%|█████▌    | 130/236 [09:08<07:36,  4.31s/it]
test ppl:  56%|█████▌    | 131/236 [09:12<07:36,  4.35s/it]
test ppl:  56%|█████▌    | 132/236 [09:18<08:20,  4.81s/it]
test ppl:  56%|█████▋    | 133/236 [09:22<07:49,  4.56s/it]
test ppl:  57%|█████▋    | 134/236 [09:28<08:26,  4.97s/it]
test ppl:  57%|█████▋    | 135/236 [09:34<08:50,  5.25s/it]
test ppl:  58%|█████▊    | 136/236 [09:37<07:33,  4.54s/it]
test ppl:  58%|█████▊    | 137/236 [09:43<08:11,  4.96s/it]
test ppl:  58%|█████▊    | 138/236 [09:49<08:34,  5.25s/it]
test ppl:  59%|█████▉    | 139/236 [09:51<06:58,  4.31s/it]
test ppl:  59%|█████▉    | 140/236 [09:53<05:47,  3.62s/it]
test ppl:  60%|█████▉    | 141/236 [09:56<05:25,  3.43s/it]
test ppl:  60%|██████    | 142/236 [09:58<04:39,  2.98s/it]
test ppl:  61%|██████    | 143/236 [10:04<05:58,  3.86s/it]
test ppl:  61%|██████    | 144/236 [10:07<05:38,  3.67s/it]
test ppl:  61%|██████▏   | 145/236 [10:13<06:36,  4.35s/it]
test ppl:  62%|██████▏   | 146/236 [10:19<07:19,  4.88s/it]
test ppl:  62%|██████▏   | 147/236 [10:25<07:46,  5.24s/it]
test ppl:  63%|██████▎   | 148/236 [10:31<08:06,  5.52s/it]
test ppl:  63%|██████▎   | 149/236 [10:36<07:35,  5.23s/it]
test ppl:  64%|██████▎   | 150/236 [10:42<07:53,  5.50s/it]
test ppl:  64%|██████▍   | 151/236 [10:48<08:02,  5.67s/it]
test ppl:  64%|██████▍   | 152/236 [10:54<08:04,  5.77s/it]
test ppl:  65%|██████▍   | 153/236 [11:00<08:02,  5.81s/it]
test ppl:  65%|██████▌   | 154/236 [11:03<06:51,  5.02s/it]
test ppl:  66%|██████▌   | 155/236 [11:07<06:25,  4.76s/it]
test ppl:  66%|██████▌   | 156/236 [11:10<05:35,  4.19s/it]
test ppl:  67%|██████▋   | 157/236 [11:12<04:41,  3.57s/it]
test ppl:  67%|██████▋   | 158/236 [11:18<05:33,  4.27s/it]
test ppl:  67%|██████▋   | 159/236 [11:20<04:32,  3.54s/it]
test ppl:  68%|██████▊   | 160/236 [11:21<03:37,  2.86s/it]
test ppl:  68%|██████▊   | 161/236 [11:23<02:56,  2.35s/it]
test ppl:  69%|██████▊   | 162/236 [11:29<04:12,  3.42s/it]
test ppl:  69%|██████▉   | 163/236 [11:31<03:57,  3.25s/it]
test ppl:  69%|██████▉   | 164/236 [11:37<04:52,  4.06s/it]
test ppl:  70%|██████▉   | 165/236 [11:43<05:27,  4.62s/it]
test ppl:  70%|███████   | 166/236 [11:47<05:04,  4.35s/it]
test ppl:  71%|███████   | 167/236 [11:48<03:59,  3.48s/it]
test ppl:  71%|███████   | 168/236 [11:50<03:15,  2.88s/it]
test ppl:  72%|███████▏  | 169/236 [11:56<04:14,  3.80s/it]
test ppl:  72%|███████▏  | 170/236 [12:02<04:53,  4.45s/it]
test ppl:  72%|███████▏  | 171/236 [12:03<03:54,  3.60s/it]
test ppl:  73%|███████▎  | 172/236 [12:06<03:36,  3.39s/it]
test ppl:  73%|███████▎  | 173/236 [12:08<03:02,  2.90s/it]
test ppl:  74%|███████▎  | 174/236 [12:13<03:38,  3.53s/it]
test ppl:  74%|███████▍  | 175/236 [12:15<02:58,  2.92s/it]
test ppl:  75%|███████▍  | 176/236 [12:20<03:48,  3.81s/it]
test ppl:  75%|███████▌  | 177/236 [12:26<04:22,  4.45s/it]
test ppl:  75%|███████▌  | 178/236 [12:33<04:47,  4.95s/it]
test ppl:  76%|███████▌  | 179/236 [12:39<05:01,  5.29s/it]
test ppl:  76%|███████▋  | 180/236 [12:41<04:04,  4.36s/it]
test ppl:  77%|███████▋  | 181/236 [12:44<03:36,  3.94s/it]
test ppl:  77%|███████▋  | 182/236 [12:46<03:05,  3.44s/it]
test ppl:  78%|███████▊  | 183/236 [12:49<03:01,  3.42s/it]
test ppl:  78%|███████▊  | 184/236 [12:53<02:56,  3.40s/it]
test ppl:  78%|███████▊  | 185/236 [12:59<03:33,  4.19s/it]
test ppl:  79%|███████▉  | 186/236 [13:01<02:57,  3.56s/it]
test ppl:  79%|███████▉  | 187/236 [13:07<03:29,  4.28s/it]
test ppl:  80%|███████▉  | 188/236 [13:13<03:48,  4.77s/it]
test ppl:  80%|████████  | 189/236 [13:19<04:00,  5.11s/it]
test ppl:  81%|████████  | 190/236 [13:25<04:05,  5.34s/it]
test ppl:  81%|████████  | 191/236 [13:30<04:08,  5.51s/it]
test ppl:  81%|████████▏ | 192/236 [13:33<03:25,  4.67s/it]
test ppl:  82%|████████▏ | 193/236 [13:39<03:36,  5.04s/it]
test ppl:  82%|████████▏ | 194/236 [13:45<03:40,  5.26s/it]
test ppl:  83%|████████▎ | 195/236 [13:47<02:55,  4.29s/it]
test ppl:  83%|████████▎ | 196/236 [13:49<02:24,  3.61s/it]
test ppl:  83%|████████▎ | 197/236 [13:51<02:02,  3.13s/it]
test ppl:  84%|████████▍ | 198/236 [13:57<02:30,  3.96s/it]
test ppl:  84%|████████▍ | 199/236 [14:00<02:19,  3.77s/it]
test ppl:  85%|████████▍ | 200/236 [14:03<02:07,  3.54s/it]
test ppl:  85%|████████▌ | 201/236 [14:05<01:47,  3.08s/it]
test ppl:  86%|████████▌ | 202/236 [14:09<01:56,  3.43s/it]
test ppl:  86%|████████▌ | 203/236 [14:15<02:17,  4.17s/it]
test ppl:  86%|████████▋ | 204/236 [14:19<02:09,  4.03s/it]
test ppl:  87%|████████▋ | 205/236 [14:25<02:23,  4.65s/it]
test ppl:  87%|████████▋ | 206/236 [14:28<02:03,  4.13s/it]
test ppl:  88%|████████▊ | 207/236 [14:34<02:15,  4.66s/it]
test ppl:  88%|████████▊ | 208/236 [14:40<02:20,  5.03s/it]
test ppl:  89%|████████▊ | 209/236 [14:46<02:24,  5.34s/it]
test ppl:  89%|████████▉ | 210/236 [14:49<02:05,  4.82s/it]
test ppl:  89%|████████▉ | 211/236 [14:53<01:54,  4.57s/it]
test ppl:  90%|████████▉ | 212/236 [14:59<01:59,  4.97s/it]
test ppl:  90%|█████████ | 213/236 [15:05<02:00,  5.25s/it]
test ppl:  91%|█████████ | 214/236 [15:07<01:29,  4.07s/it]
test ppl:  91%|█████████ | 215/236 [15:08<01:11,  3.39s/it]
test ppl:  92%|█████████▏| 216/236 [15:11<01:02,  3.13s/it]
test ppl:  92%|█████████▏| 217/236 [15:17<01:16,  4.04s/it]
test ppl:  92%|█████████▏| 218/236 [15:23<01:22,  4.59s/it]
test ppl:  93%|█████████▎| 219/236 [15:29<01:24,  4.99s/it]
test ppl:  93%|█████████▎| 220/236 [15:35<01:25,  5.32s/it]
test ppl:  94%|█████████▎| 221/236 [15:37<01:04,  4.32s/it]
test ppl:  94%|█████████▍| 222/236 [15:43<01:07,  4.80s/it]
test ppl:  94%|█████████▍| 223/236 [15:49<01:06,  5.13s/it]
test ppl:  95%|█████████▍| 224/236 [15:50<00:49,  4.10s/it]
test ppl:  95%|█████████▌| 225/236 [15:56<00:50,  4.63s/it]
test ppl:  96%|█████████▌| 226/236 [15:59<00:40,  4.03s/it]
test ppl:  96%|█████████▌| 227/236 [16:01<00:30,  3.40s/it]
test ppl:  97%|█████████▋| 228/236 [16:07<00:33,  4.14s/it]
test ppl:  97%|█████████▋| 229/236 [16:13<00:32,  4.66s/it]
test ppl:  97%|█████████▋| 230/236 [16:17<00:26,  4.48s/it]
test ppl:  98%|█████████▊| 231/236 [16:19<00:19,  3.92s/it]
test ppl:  98%|█████████▊| 232/236 [16:22<00:14,  3.50s/it]
test ppl:  99%|█████████▊| 233/236 [16:28<00:12,  4.22s/it]
test ppl:  99%|█████████▉| 234/236 [16:34<00:09,  4.71s/it]
test ppl: 100%|█████████▉| 235/236 [16:39<00:05,  5.07s/it]
test ppl: 100%|██████████| 236/236 [16:40<00:00,  3.78s/it]
test ppl: 100%|██████████| 236/236 [16:40<00:00,  4.24s/it]
10/12/2024 08:43:29 - INFO - __main__ -    em: 0.1227
10/12/2024 08:43:29 - INFO - __main__ -   Finish and take 18m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.6 10:  em: 0.1227

--------------------------------------------------------------------------------
Running experiment with knn_temp=10, lmbda=0.6, k=32
2024-10-12 08:43:36.781716: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 08:43:36.801293: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 08:43:36.822939: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 08:43:36.829567: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 08:43:36.845478: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 08:43:37.838889: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 08:43:39 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.6, knn_temp=10, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 08:43:39 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:46:42,  2.19it/s]
Adding feature api:   3%|▎         | 6303/187062 [00:00<00:12, 14993.98it/s]
Adding feature api:   7%|▋         | 13377/187062 [00:00<00:05, 29133.65it/s]
Adding feature api:  11%|█         | 20686/187062 [00:00<00:04, 40823.34it/s]
Adding feature api:  15%|█▍        | 28033/187062 [00:00<00:03, 49810.82it/s]
Adding feature api:  19%|█▉        | 35399/187062 [00:00<00:02, 56542.54it/s]
Adding feature api:  23%|██▎       | 42780/187062 [00:01<00:02, 61502.55it/s]
Adding feature api:  27%|██▋       | 49952/187062 [00:01<00:02, 64475.59it/s]
Adding feature api:  31%|███       | 57347/187062 [00:01<00:01, 67255.86it/s]
Adding feature api:  35%|███▍      | 64723/187062 [00:01<00:01, 69175.94it/s]
Adding feature api:  39%|███▊      | 72176/187062 [00:01<00:01, 70763.64it/s]
Adding feature api:  42%|████▏     | 79472/187062 [00:01<00:01, 71154.91it/s]
Adding feature api:  46%|████▋     | 86863/187062 [00:01<00:01, 71973.06it/s]
Adding feature api:  50%|█████     | 94204/187062 [00:01<00:01, 72401.45it/s]
Adding feature api:  54%|█████▍    | 101586/187062 [00:01<00:01, 72823.75it/s]
Adding feature api:  58%|█████▊    | 108922/187062 [00:01<00:01, 72475.50it/s]
Adding feature api:  62%|██████▏   | 116354/187062 [00:02<00:00, 73023.15it/s]
Adding feature api:  66%|██████▌   | 123767/187062 [00:02<00:00, 73351.19it/s]
Adding feature api:  70%|███████   | 131163/187062 [00:02<00:00, 73530.41it/s]
Adding feature api:  74%|███████▍  | 138573/187062 [00:02<00:00, 73700.11it/s]
Adding feature api:  78%|███████▊  | 145953/187062 [00:02<00:00, 73220.54it/s]
Adding feature api:  82%|████████▏ | 153387/187062 [00:02<00:00, 73544.03it/s]
Adding feature api:  86%|████████▌ | 160765/187062 [00:02<00:00, 73611.44it/s]
Adding feature api:  90%|████████▉ | 168133/187062 [00:02<00:00, 73629.76it/s]
Adding feature api:  94%|█████████▍| 175499/187062 [00:02<00:00, 73081.36it/s]
Adding feature api:  98%|█████████▊| 182810/187062 [00:03<00:00, 52531.19it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 57720.26it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:34:17,  2.20it/s]
Adding feature datatype:   3%|▎         | 6188/187062 [00:00<00:12, 14818.82it/s]
Adding feature datatype:   7%|▋         | 12945/187062 [00:00<00:06, 28265.46it/s]
Adding feature datatype:  11%|█         | 20067/187062 [00:00<00:04, 39731.24it/s]
Adding feature datatype:  15%|█▍        | 27228/187062 [00:00<00:03, 48530.93it/s]
Adding feature datatype:  18%|█▊        | 34452/187062 [00:00<00:02, 55235.57it/s]
Adding feature datatype:  22%|██▏       | 41595/187062 [00:01<00:02, 59894.56it/s]
Adding feature datatype:  26%|██▌       | 48766/187062 [00:01<00:02, 63335.52it/s]
Adding feature datatype:  30%|██▉       | 55737/187062 [00:01<00:02, 65206.26it/s]
Adding feature datatype:  34%|███▎      | 62998/187062 [00:01<00:01, 67394.01it/s]
Adding feature datatype:  38%|███▊      | 70223/187062 [00:01<00:01, 68833.90it/s]
Adding feature datatype:  41%|████▏     | 77393/187062 [00:01<00:01, 69684.59it/s]
Adding feature datatype:  45%|████▌     | 84637/187062 [00:01<00:01, 70504.65it/s]
Adding feature datatype:  49%|████▉     | 91792/187062 [00:01<00:01, 70097.90it/s]
Adding feature datatype:  53%|█████▎    | 98953/187062 [00:01<00:01, 70545.89it/s]
Adding feature datatype:  57%|█████▋    | 106166/187062 [00:01<00:01, 71016.06it/s]
Adding feature datatype:  61%|██████    | 113395/187062 [00:02<00:01, 71395.38it/s]
Adding feature datatype:  64%|██████▍   | 120607/187062 [00:02<00:00, 71608.94it/s]
Adding feature datatype:  68%|██████▊   | 127824/187062 [00:02<00:00, 71775.04it/s]
Adding feature datatype:  72%|███████▏  | 135015/187062 [00:02<00:00, 70962.78it/s]
Adding feature datatype:  76%|███████▌  | 142188/187062 [00:02<00:00, 71187.85it/s]
Adding feature datatype:  80%|███████▉  | 149413/187062 [00:02<00:00, 71502.65it/s]
Adding feature datatype:  84%|████████▎ | 156663/187062 [00:02<00:00, 71798.32it/s]
Adding feature datatype:  88%|████████▊ | 163848/187062 [00:02<00:00, 71035.21it/s]
Adding feature datatype:  91%|█████████▏| 171053/187062 [00:02<00:00, 71335.23it/s]
Adding feature datatype:  95%|█████████▌| 178191/187062 [00:02<00:00, 69203.68it/s]
Adding feature datatype:  99%|█████████▉| 185127/187062 [00:03<00:00, 47008.91it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 56648.79it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:20:41,  2.23it/s]
Adding feature literal:   3%|▎         | 6124/187062 [00:00<00:12, 14773.67it/s]
Adding feature literal:   7%|▋         | 13012/187062 [00:00<00:06, 28640.90it/s]
Adding feature literal:  11%|█         | 20117/187062 [00:00<00:04, 40005.65it/s]
Adding feature literal:  15%|█▍        | 27216/187062 [00:00<00:03, 48583.29it/s]
Adding feature literal:  18%|█▊        | 34325/187062 [00:00<00:02, 54960.90it/s]
Adding feature literal:  22%|██▏       | 41439/187062 [00:01<00:02, 59622.54it/s]
Adding feature literal:  26%|██▌       | 48590/187062 [00:01<00:02, 63088.49it/s]
Adding feature literal:  30%|██▉       | 55727/187062 [00:01<00:02, 65521.63it/s]
Adding feature literal:  34%|███▎      | 62879/187062 [00:01<00:01, 67294.54it/s]
Adding feature literal:  37%|███▋      | 69997/187062 [00:01<00:01, 68446.80it/s]
Adding feature literal:  41%|████      | 77125/187062 [00:01<00:01, 69289.89it/s]
Adding feature literal:  45%|████▌     | 84255/187062 [00:01<00:01, 69886.74it/s]
Adding feature literal:  49%|████▉     | 91410/187062 [00:01<00:01, 70382.62it/s]
Adding feature literal:  53%|█████▎    | 98530/187062 [00:01<00:01, 70626.76it/s]
Adding feature literal:  56%|█████▋    | 105669/187062 [00:01<00:01, 70854.50it/s]
Adding feature literal:  60%|██████    | 112790/187062 [00:02<00:01, 70948.17it/s]
Adding feature literal:  64%|██████▍   | 119910/187062 [00:02<00:00, 70975.44it/s]
Adding feature literal:  68%|██████▊   | 127049/187062 [00:02<00:00, 71099.07it/s]
Adding feature literal:  72%|███████▏  | 134208/187062 [00:02<00:00, 71244.27it/s]
Adding feature literal:  76%|███████▌  | 141341/187062 [00:02<00:00, 71223.41it/s]
Adding feature literal:  79%|███████▉  | 148470/187062 [00:02<00:00, 70826.52it/s]
Adding feature literal:  83%|████████▎ | 155559/187062 [00:02<00:00, 70843.93it/s]
Adding feature literal:  87%|████████▋ | 162647/187062 [00:02<00:00, 70823.33it/s]
Adding feature literal:  91%|█████████ | 169733/187062 [00:02<00:00, 70831.95it/s]
Adding feature literal:  95%|█████████▍| 176818/187062 [00:02<00:00, 70709.10it/s]
Adding feature literal:  98%|█████████▊| 183891/187062 [00:03<00:00, 48234.55it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 56467.95it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:18:12,  2.23it/s]
Adding feature operator:   3%|▎         | 6130/187062 [00:00<00:12, 14808.19it/s]
Adding feature operator:   7%|▋         | 13238/187062 [00:00<00:05, 29245.49it/s]
Adding feature operator:  11%|█         | 20392/187062 [00:00<00:04, 40587.94it/s]
Adding feature operator:  15%|█▍        | 27571/187062 [00:00<00:03, 49229.80it/s]
Adding feature operator:  19%|█▊        | 34763/187062 [00:00<00:02, 55660.74it/s]
Adding feature operator:  22%|██▏       | 41906/187062 [00:01<00:02, 60206.03it/s]
Adding feature operator:  26%|██▌       | 49043/187062 [00:01<00:02, 63460.93it/s]
Adding feature operator:  30%|███       | 56257/187062 [00:01<00:01, 66011.99it/s]
Adding feature operator:  34%|███▍      | 63450/187062 [00:01<00:01, 67759.99it/s]
Adding feature operator:  38%|███▊      | 70596/187062 [00:01<00:01, 68858.48it/s]
Adding feature operator:  42%|████▏     | 77734/187062 [00:01<00:01, 69607.80it/s]
Adding feature operator:  45%|████▌     | 84953/187062 [00:01<00:01, 70376.10it/s]
Adding feature operator:  49%|████▉     | 92108/187062 [00:01<00:01, 70725.27it/s]
Adding feature operator:  53%|█████▎    | 99316/187062 [00:01<00:01, 71129.67it/s]
Adding feature operator:  57%|█████▋    | 106480/187062 [00:01<00:01, 71246.26it/s]
Adding feature operator:  61%|██████    | 113649/187062 [00:02<00:01, 71377.67it/s]
Adding feature operator:  65%|██████▍   | 120826/187062 [00:02<00:00, 71494.39it/s]
Adding feature operator:  68%|██████▊   | 127993/187062 [00:02<00:00, 71487.02it/s]
Adding feature operator:  72%|███████▏  | 135222/187062 [00:02<00:00, 71726.89it/s]
Adding feature operator:  76%|███████▌  | 142444/187062 [00:02<00:00, 71873.49it/s]
Adding feature operator:  80%|███████▉  | 149638/187062 [00:02<00:00, 71867.61it/s]
Adding feature operator:  84%|████████▍ | 156891/187062 [00:02<00:00, 72063.23it/s]
Adding feature operator:  88%|████████▊ | 164113/187062 [00:02<00:00, 72108.35it/s]
Adding feature operator:  92%|█████████▏| 171326/187062 [00:02<00:00, 72063.65it/s]
Adding feature operator:  95%|█████████▌| 178534/187062 [00:02<00:00, 67786.73it/s]
Adding feature operator:  99%|█████████▉| 185366/187062 [00:03<00:00, 46936.46it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 56964.19it/s]
[2024-10-12 08:44:24,620] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 08:44:26 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 08:44:26 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 419.89 examples/s]
Map:   1%|▏         | 90/6548 [00:00<00:27, 233.63 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:24, 262.87 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 317.93 examples/s]
Map:   3%|▎         | 222/6548 [00:00<00:18, 350.96 examples/s]
Map:   4%|▍         | 286/6548 [00:00<00:16, 370.87 examples/s]
Map:   5%|▍         | 325/6548 [00:01<00:19, 313.74 examples/s]
Map:   6%|▌         | 362/6548 [00:01<00:19, 315.52 examples/s]
Map:   6%|▋         | 414/6548 [00:01<00:16, 364.32 examples/s]
Map:   7%|▋         | 464/6548 [00:01<00:17, 349.49 examples/s]
Map:   8%|▊         | 521/6548 [00:01<00:17, 352.45 examples/s]
Map:   9%|▊         | 572/6548 [00:01<00:15, 386.02 examples/s]
Map:   9%|▉         | 622/6548 [00:01<00:16, 358.68 examples/s]
Map:  10%|█         | 679/6548 [00:01<00:16, 358.11 examples/s]
Map:  11%|█         | 722/6548 [00:02<00:15, 373.55 examples/s]
Map:  12%|█▏        | 769/6548 [00:02<00:14, 395.87 examples/s]
Map:  13%|█▎        | 819/6548 [00:02<00:13, 417.57 examples/s]
Map:  13%|█▎        | 876/6548 [00:02<00:14, 399.21 examples/s]
Map:  14%|█▍        | 932/6548 [00:02<00:14, 375.67 examples/s]
Map:  15%|█▍        | 972/6548 [00:02<00:14, 378.58 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:23, 232.53 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 259.31 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:18, 293.71 examples/s]
Map:  18%|█▊        | 1147/6548 [00:03<00:16, 332.91 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 349.14 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:14, 358.56 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:14, 369.71 examples/s]
Map:  21%|██        | 1352/6548 [00:03<00:15, 328.86 examples/s]
Map:  21%|██        | 1390/6548 [00:04<00:17, 294.89 examples/s]
Map:  22%|██▏       | 1430/6548 [00:04<00:16, 315.14 examples/s]
Map:  23%|██▎       | 1474/6548 [00:04<00:18, 277.47 examples/s]
Map:  23%|██▎       | 1511/6548 [00:04<00:17, 294.18 examples/s]
Map:  24%|██▍       | 1560/6548 [00:04<00:16, 295.43 examples/s]
Map:  24%|██▍       | 1596/6548 [00:04<00:16, 302.69 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:16, 291.97 examples/s]
Map:  26%|██▌       | 1694/6548 [00:05<00:16, 300.28 examples/s]
Map:  26%|██▋       | 1732/6548 [00:05<00:15, 316.30 examples/s]
Map:  27%|██▋       | 1776/6548 [00:05<00:13, 344.29 examples/s]
Map:  28%|██▊       | 1827/6548 [00:05<00:13, 341.14 examples/s]
Map:  28%|██▊       | 1866/6548 [00:05<00:14, 334.17 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 345.80 examples/s]
Map:  30%|██▉       | 1947/6548 [00:05<00:12, 360.13 examples/s]
Map:  30%|███       | 1991/6548 [00:05<00:12, 377.00 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:20, 224.73 examples/s]
Map:  32%|███▏      | 2070/6548 [00:06<00:17, 254.94 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 267.52 examples/s]
Map:  33%|███▎      | 2142/6548 [00:06<00:17, 257.70 examples/s]
Map:  33%|███▎      | 2181/6548 [00:06<00:15, 283.20 examples/s]
Map:  34%|███▍      | 2213/6548 [00:06<00:14, 291.61 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:14, 292.40 examples/s]
Map:  35%|███▌      | 2293/6548 [00:07<00:14, 299.84 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:13, 322.50 examples/s]
Map:  36%|███▋      | 2376/6548 [00:07<00:13, 320.45 examples/s]
Map:  37%|███▋      | 2418/6548 [00:07<00:12, 342.96 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:12, 330.55 examples/s]
Map:  38%|███▊      | 2496/6548 [00:07<00:12, 332.77 examples/s]
Map:  39%|███▊      | 2535/6548 [00:07<00:11, 344.00 examples/s]
Map:  40%|███▉      | 2592/6548 [00:07<00:10, 395.33 examples/s]
Map:  40%|████      | 2633/6548 [00:08<00:09, 395.49 examples/s]
Map:  41%|████      | 2682/6548 [00:08<00:10, 361.88 examples/s]
Map:  42%|████▏     | 2730/6548 [00:08<00:11, 339.53 examples/s]
Map:  42%|████▏     | 2771/6548 [00:08<00:10, 344.99 examples/s]
Map:  43%|████▎     | 2817/6548 [00:08<00:11, 329.85 examples/s]
Map:  44%|████▎     | 2862/6548 [00:08<00:12, 288.65 examples/s]
Map:  44%|████▍     | 2900/6548 [00:08<00:12, 294.43 examples/s]
Map:  45%|████▌     | 2949/6548 [00:09<00:12, 285.94 examples/s]
Map:  46%|████▌     | 2980/6548 [00:09<00:12, 288.65 examples/s]
Map:  46%|████▌     | 3012/6548 [00:09<00:22, 155.54 examples/s]
Map:  46%|████▋     | 3044/6548 [00:09<00:19, 179.10 examples/s]
Map:  47%|████▋     | 3074/6548 [00:09<00:17, 199.32 examples/s]
Map:  48%|████▊     | 3115/6548 [00:10<00:14, 236.43 examples/s]
Map:  48%|████▊     | 3149/6548 [00:10<00:14, 238.38 examples/s]
Map:  49%|████▊     | 3183/6548 [00:10<00:13, 257.87 examples/s]
Map:  49%|████▉     | 3218/6548 [00:10<00:12, 259.91 examples/s]
Map:  50%|████▉     | 3252/6548 [00:10<00:11, 276.00 examples/s]
Map:  50%|█████     | 3285/6548 [00:10<00:11, 287.10 examples/s]
Map:  51%|█████     | 3328/6548 [00:10<00:09, 322.25 examples/s]
Map:  52%|█████▏    | 3376/6548 [00:10<00:10, 314.86 examples/s]
Map:  52%|█████▏    | 3412/6548 [00:11<00:11, 274.91 examples/s]
Map:  53%|█████▎    | 3450/6548 [00:11<00:10, 297.67 examples/s]
Map:  53%|█████▎    | 3496/6548 [00:11<00:11, 259.21 examples/s]
Map:  54%|█████▍    | 3545/6548 [00:11<00:09, 307.35 examples/s]
Map:  55%|█████▍    | 3591/6548 [00:11<00:08, 340.14 examples/s]
Map:  56%|█████▌    | 3637/6548 [00:11<00:07, 366.42 examples/s]
Map:  56%|█████▋    | 3688/6548 [00:11<00:08, 354.33 examples/s]
Map:  57%|█████▋    | 3743/6548 [00:12<00:07, 352.62 examples/s]
Map:  58%|█████▊    | 3800/6548 [00:12<00:07, 357.93 examples/s]
Map:  59%|█████▊    | 3843/6548 [00:12<00:08, 301.46 examples/s]
Map:  59%|█████▉    | 3889/6548 [00:12<00:08, 300.57 examples/s]
Map:  60%|██████    | 3929/6548 [00:12<00:08, 306.53 examples/s]
Map:  61%|██████    | 3973/6548 [00:12<00:07, 325.92 examples/s]
Map:  62%|██████▏   | 4030/6548 [00:13<00:10, 247.65 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 288.34 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 313.40 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:08, 295.01 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:13<00:07, 311.96 examples/s]
Map:  65%|██████▍   | 4252/6548 [00:13<00:06, 330.45 examples/s]
Map:  66%|██████▌   | 4290/6548 [00:13<00:06, 336.83 examples/s]
Map:  66%|██████▌   | 4335/6548 [00:13<00:06, 363.41 examples/s]
Map:  67%|██████▋   | 4387/6548 [00:14<00:06, 349.07 examples/s]
Map:  68%|██████▊   | 4432/6548 [00:14<00:05, 365.63 examples/s]
Map:  69%|██████▊   | 4486/6548 [00:14<00:05, 353.99 examples/s]
Map:  69%|██████▉   | 4530/6548 [00:14<00:06, 326.41 examples/s]
Map:  70%|██████▉   | 4572/6548 [00:14<00:05, 335.81 examples/s]
Map:  71%|███████   | 4623/6548 [00:14<00:05, 327.12 examples/s]
Map:  71%|███████▏  | 4668/6548 [00:14<00:05, 343.62 examples/s]
Map:  72%|███████▏  | 4728/6548 [00:15<00:05, 360.77 examples/s]
Map:  73%|███████▎  | 4769/6548 [00:15<00:04, 368.37 examples/s]
Map:  74%|███████▎  | 4820/6548 [00:15<00:04, 402.50 examples/s]
Map:  74%|███████▍  | 4874/6548 [00:15<00:04, 358.31 examples/s]
Map:  75%|███████▌  | 4933/6548 [00:15<00:04, 366.76 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:04, 385.11 examples/s]
Map:  77%|███████▋  | 5031/6548 [00:16<00:06, 233.90 examples/s]
Map:  77%|███████▋  | 5065/6548 [00:16<00:05, 251.02 examples/s]
Map:  78%|███████▊  | 5101/6548 [00:16<00:05, 265.92 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 279.23 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 282.57 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:16<00:04, 296.79 examples/s]
Map:  80%|████████  | 5258/6548 [00:16<00:04, 305.15 examples/s]
Map:  81%|████████  | 5307/6548 [00:16<00:03, 349.77 examples/s]
Map:  82%|████████▏ | 5346/6548 [00:17<00:03, 306.18 examples/s]
Map:  82%|████████▏ | 5388/6548 [00:17<00:03, 329.84 examples/s]
Map:  83%|████████▎ | 5430/6548 [00:17<00:03, 308.13 examples/s]
Map:  84%|████████▎ | 5473/6548 [00:17<00:03, 333.28 examples/s]
Map:  84%|████████▍ | 5509/6548 [00:17<00:03, 334.81 examples/s]
Map:  85%|████████▍ | 5554/6548 [00:17<00:02, 360.45 examples/s]
Map:  86%|████████▌ | 5614/6548 [00:17<00:02, 325.74 examples/s]
Map:  86%|████████▋ | 5651/6548 [00:18<00:02, 329.69 examples/s]
Map:  87%|████████▋ | 5697/6548 [00:18<00:02, 320.38 examples/s]
Map:  88%|████████▊ | 5740/6548 [00:18<00:02, 342.45 examples/s]
Map:  88%|████████▊ | 5781/6548 [00:18<00:02, 347.90 examples/s]
Map:  89%|████████▉ | 5825/6548 [00:18<00:02, 349.22 examples/s]
Map:  90%|████████▉ | 5863/6548 [00:18<00:01, 356.64 examples/s]
Map:  90%|█████████ | 5902/6548 [00:18<00:01, 363.48 examples/s]
Map:  91%|█████████ | 5939/6548 [00:18<00:01, 354.89 examples/s]
Map:  91%|█████████▏| 5987/6548 [00:18<00:01, 340.02 examples/s]
Map:  92%|█████████▏| 6025/6548 [00:19<00:02, 226.22 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 262.84 examples/s]
Map:  94%|█████████▎| 6124/6548 [00:19<00:01, 264.46 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:19<00:01, 282.43 examples/s]
Map:  95%|█████████▍| 6205/6548 [00:19<00:01, 302.52 examples/s]
Map:  95%|█████████▌| 6249/6548 [00:19<00:00, 328.27 examples/s]
Map:  96%|█████████▋| 6303/6548 [00:20<00:00, 336.02 examples/s]
Map:  97%|█████████▋| 6362/6548 [00:20<00:00, 349.88 examples/s]
Map:  98%|█████████▊| 6399/6548 [00:20<00:00, 351.64 examples/s]
Map:  98%|█████████▊| 6438/6548 [00:20<00:00, 353.73 examples/s]
Map:  99%|█████████▉| 6486/6548 [00:20<00:00, 383.69 examples/s]
Map: 100%|█████████▉| 6539/6548 [00:20<00:00, 370.85 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 313.67 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   3%|▎         | 29/903 [00:00<00:03, 276.13 examples/s]
Map:   7%|▋         | 62/903 [00:00<00:02, 294.48 examples/s]
Map:  11%|█         | 96/903 [00:00<00:02, 308.23 examples/s]
Map:  15%|█▍        | 133/903 [00:00<00:02, 324.35 examples/s]
Map:  20%|██        | 182/903 [00:00<00:01, 380.09 examples/s]
Map:  24%|██▍       | 221/903 [00:00<00:01, 378.03 examples/s]
Map:  29%|██▉       | 260/903 [00:00<00:01, 380.13 examples/s]
Map:  35%|███▍      | 314/903 [00:00<00:01, 362.55 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 315.98 examples/s]
Map:  43%|████▎     | 390/903 [00:01<00:01, 291.27 examples/s]
Map:  48%|████▊     | 431/903 [00:01<00:01, 315.67 examples/s]
Map:  52%|█████▏    | 471/903 [00:01<00:01, 297.79 examples/s]
Map:  56%|█████▋    | 508/903 [00:01<00:01, 301.82 examples/s]
Map:  62%|██████▏   | 558/903 [00:01<00:01, 342.43 examples/s]
Map:  66%|██████▌   | 598/903 [00:01<00:00, 356.07 examples/s]
Map:  70%|███████   | 636/903 [00:01<00:00, 359.12 examples/s]
Map:  77%|███████▋  | 695/903 [00:02<00:00, 366.90 examples/s]
Map:  82%|████████▏ | 738/903 [00:02<00:00, 379.81 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 380.67 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 385.25 examples/s]
Map:  97%|█████████▋| 873/903 [00:02<00:00, 404.87 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 320.75 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 35/1882 [00:00<00:06, 272.69 examples/s]
Map:   4%|▍         | 74/1882 [00:00<00:05, 331.24 examples/s]
Map:   6%|▌         | 110/1882 [00:00<00:05, 332.29 examples/s]
Map:   8%|▊         | 147/1882 [00:00<00:05, 343.64 examples/s]
Map:  10%|█         | 189/1882 [00:00<00:04, 354.48 examples/s]
Map:  12%|█▏        | 231/1882 [00:00<00:04, 370.23 examples/s]
Map:  15%|█▍        | 274/1882 [00:00<00:04, 386.38 examples/s]
Map:  18%|█▊        | 334/1882 [00:00<00:04, 370.70 examples/s]
Map:  20%|██        | 378/1882 [00:01<00:04, 341.35 examples/s]
Map:  22%|██▏       | 422/1882 [00:01<00:04, 321.24 examples/s]
Map:  25%|██▌       | 479/1882 [00:01<00:04, 336.90 examples/s]
Map:  28%|██▊       | 532/1882 [00:01<00:04, 323.60 examples/s]
Map:  30%|███       | 572/1882 [00:01<00:03, 338.71 examples/s]
Map:  33%|███▎      | 617/1882 [00:01<00:03, 364.15 examples/s]
Map:  35%|███▍      | 657/1882 [00:01<00:03, 363.64 examples/s]
Map:  37%|███▋      | 699/1882 [00:01<00:03, 377.12 examples/s]
Map:  40%|████      | 760/1882 [00:02<00:02, 381.57 examples/s]
Map:  43%|████▎     | 809/1882 [00:02<00:03, 345.56 examples/s]
Map:  45%|████▌     | 851/1882 [00:02<00:02, 361.58 examples/s]
Map:  48%|████▊     | 905/1882 [00:02<00:02, 357.13 examples/s]
Map:  50%|█████     | 948/1882 [00:02<00:02, 371.52 examples/s]
Map:  53%|█████▎    | 997/1882 [00:02<00:02, 389.40 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 245.16 examples/s]
Map:  58%|█████▊    | 1085/1882 [00:03<00:03, 258.53 examples/s]
Map:  59%|█████▉    | 1116/1882 [00:03<00:02, 266.01 examples/s]
Map:  61%|██████    | 1147/1882 [00:03<00:02, 271.73 examples/s]
Map:  63%|██████▎   | 1184/1882 [00:03<00:02, 255.51 examples/s]
Map:  65%|██████▍   | 1220/1882 [00:03<00:02, 276.36 examples/s]
Map:  67%|██████▋   | 1256/1882 [00:03<00:02, 287.01 examples/s]
Map:  69%|██████▉   | 1298/1882 [00:03<00:01, 317.99 examples/s]
Map:  71%|███████   | 1336/1882 [00:04<00:01, 331.09 examples/s]
Map:  73%|███████▎  | 1381/1882 [00:04<00:01, 317.78 examples/s]
Map:  75%|███████▌  | 1414/1882 [00:04<00:01, 308.97 examples/s]
Map:  77%|███████▋  | 1447/1882 [00:04<00:01, 273.41 examples/s]
Map:  79%|███████▉  | 1490/1882 [00:04<00:01, 269.40 examples/s]
Map:  81%|████████  | 1525/1882 [00:04<00:01, 255.73 examples/s]
Map:  83%|████████▎ | 1559/1882 [00:04<00:01, 274.17 examples/s]
Map:  85%|████████▌ | 1607/1882 [00:05<00:00, 322.60 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 328.93 examples/s]
Map:  91%|█████████ | 1716/1882 [00:05<00:00, 331.71 examples/s]
Map:  93%|█████████▎| 1757/1882 [00:05<00:00, 273.27 examples/s]
Map:  95%|█████████▍| 1787/1882 [00:05<00:00, 276.42 examples/s]
Map:  98%|█████████▊| 1835/1882 [00:05<00:00, 321.09 examples/s]
Map: 100%|█████████▉| 1878/1882 [00:05<00:00, 343.64 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 308.11 examples/s]
10/12/2024 08:45:28 - INFO - __main__ -     ***** Testing *****
10/12/2024 08:45:28 - INFO - __main__ -     Batch size = 8
10/12/2024 08:45:28 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 08:45:28 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 08:45:28 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 08:45:29 - INFO - knnlm -   Reading datastore took 0.9604957103729248 s
10/12/2024 08:45:30 - INFO - knnlm -   Moving index to GPU took 0.9194531440734863 s
10/12/2024 08:45:30 - INFO - __main__ -   ******************************break-into
10/12/2024 08:45:30 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 08:45:30 - INFO - __main__ -     Num examples = 236
10/12/2024 08:45:30 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<31:32,  8.05s/it]
test ppl:   1%|          | 2/236 [00:11<19:46,  5.07s/it]
test ppl:   1%|▏         | 3/236 [00:12<14:03,  3.62s/it]
test ppl:   2%|▏         | 4/236 [00:14<11:16,  2.92s/it]
test ppl:   2%|▏         | 5/236 [00:20<15:35,  4.05s/it]
test ppl:   3%|▎         | 6/236 [00:26<18:07,  4.73s/it]
test ppl:   3%|▎         | 7/236 [00:29<15:17,  4.00s/it]
test ppl:   3%|▎         | 8/236 [00:33<15:56,  4.20s/it]
test ppl:   4%|▍         | 9/236 [00:35<13:12,  3.49s/it]
test ppl:   4%|▍         | 10/236 [00:40<14:27,  3.84s/it]
test ppl:   5%|▍         | 11/236 [00:45<15:54,  4.24s/it]
test ppl:   5%|▌         | 12/236 [00:51<17:49,  4.77s/it]
test ppl:   6%|▌         | 13/236 [00:57<19:07,  5.15s/it]
test ppl:   6%|▌         | 14/236 [01:03<20:03,  5.42s/it]
test ppl:   6%|▋         | 15/236 [01:05<15:46,  4.28s/it]
test ppl:   7%|▋         | 16/236 [01:11<17:39,  4.82s/it]
test ppl:   7%|▋         | 17/236 [01:17<18:52,  5.17s/it]
test ppl:   8%|▊         | 18/236 [01:19<15:04,  4.15s/it]
test ppl:   8%|▊         | 19/236 [01:25<16:58,  4.70s/it]
test ppl:   8%|▊         | 20/236 [01:31<18:37,  5.18s/it]
test ppl:   9%|▉         | 21/236 [01:34<16:42,  4.66s/it]
test ppl:   9%|▉         | 22/236 [01:42<19:30,  5.47s/it]
test ppl:  10%|▉         | 23/236 [01:45<16:51,  4.75s/it]
test ppl:  10%|█         | 24/236 [01:52<19:28,  5.51s/it]
test ppl:  11%|█         | 25/236 [01:55<16:26,  4.68s/it]
test ppl:  11%|█         | 26/236 [02:01<17:35,  5.02s/it]
test ppl:  11%|█▏        | 27/236 [02:06<17:24,  5.00s/it]
test ppl:  12%|█▏        | 28/236 [02:08<14:14,  4.11s/it]
test ppl:  12%|█▏        | 29/236 [02:11<13:15,  3.84s/it]
test ppl:  13%|█▎        | 30/236 [02:13<11:09,  3.25s/it]
test ppl:  13%|█▎        | 31/236 [02:20<15:14,  4.46s/it]
test ppl:  14%|█▎        | 32/236 [02:25<15:49,  4.65s/it]
test ppl:  14%|█▍        | 33/236 [02:32<18:12,  5.38s/it]
test ppl:  14%|█▍        | 34/236 [02:36<16:43,  4.97s/it]
test ppl:  15%|█▍        | 35/236 [02:39<14:12,  4.24s/it]
test ppl:  15%|█▌        | 36/236 [02:45<15:48,  4.74s/it]
test ppl:  16%|█▌        | 37/236 [02:51<16:54,  5.10s/it]
test ppl:  16%|█▌        | 38/236 [02:53<14:02,  4.26s/it]
test ppl:  17%|█▋        | 39/236 [02:56<12:29,  3.81s/it]
test ppl:  17%|█▋        | 40/236 [02:57<10:15,  3.14s/it]
test ppl:  17%|█▋        | 41/236 [03:00<10:11,  3.14s/it]
test ppl:  18%|█▊        | 42/236 [03:06<12:52,  3.98s/it]
test ppl:  18%|█▊        | 43/236 [03:12<14:39,  4.56s/it]
test ppl:  19%|█▊        | 44/236 [03:16<13:38,  4.27s/it]
test ppl:  19%|█▉        | 45/236 [03:18<11:30,  3.62s/it]
test ppl:  19%|█▉        | 46/236 [03:24<13:41,  4.33s/it]
test ppl:  20%|█▉        | 47/236 [03:25<10:59,  3.49s/it]
test ppl:  20%|██        | 48/236 [03:31<13:11,  4.21s/it]
test ppl:  21%|██        | 49/236 [03:35<12:54,  4.14s/it]
test ppl:  21%|██        | 50/236 [03:41<14:33,  4.70s/it]
test ppl:  22%|██▏       | 51/236 [03:45<13:22,  4.34s/it]
test ppl:  22%|██▏       | 52/236 [03:48<11:55,  3.89s/it]
test ppl:  22%|██▏       | 53/236 [03:54<13:41,  4.49s/it]
test ppl:  23%|██▎       | 54/236 [03:59<14:52,  4.91s/it]
test ppl:  23%|██▎       | 55/236 [04:05<15:40,  5.20s/it]
test ppl:  24%|██▎       | 56/236 [04:11<16:15,  5.42s/it]
test ppl:  24%|██▍       | 57/236 [04:17<16:34,  5.56s/it]
test ppl:  25%|██▍       | 58/236 [04:20<13:54,  4.69s/it]
test ppl:  25%|██▌       | 59/236 [04:26<14:53,  5.05s/it]
test ppl:  25%|██▌       | 60/236 [04:28<12:34,  4.29s/it]
test ppl:  26%|██▌       | 61/236 [04:34<13:53,  4.76s/it]
test ppl:  26%|██▋       | 62/236 [04:40<14:47,  5.10s/it]
test ppl:  27%|██▋       | 63/236 [04:42<12:25,  4.31s/it]
test ppl:  27%|██▋       | 64/236 [04:44<10:15,  3.58s/it]
test ppl:  28%|██▊       | 65/236 [04:46<08:20,  2.93s/it]
test ppl:  28%|██▊       | 66/236 [04:52<10:47,  3.81s/it]
test ppl:  28%|██▊       | 67/236 [04:57<12:30,  4.44s/it]
test ppl:  29%|██▉       | 68/236 [05:03<13:39,  4.88s/it]
test ppl:  29%|██▉       | 69/236 [05:09<14:24,  5.18s/it]
test ppl:  30%|██▉       | 70/236 [05:15<14:54,  5.39s/it]
test ppl:  30%|███       | 71/236 [05:18<13:00,  4.73s/it]
test ppl:  31%|███       | 72/236 [05:21<11:22,  4.16s/it]
test ppl:  31%|███       | 73/236 [05:27<12:43,  4.68s/it]
test ppl:  31%|███▏      | 74/236 [05:30<10:55,  4.05s/it]
test ppl:  32%|███▏      | 75/236 [05:36<12:21,  4.61s/it]
test ppl:  32%|███▏      | 76/236 [05:41<13:19,  4.99s/it]
test ppl:  33%|███▎      | 77/236 [05:44<11:01,  4.16s/it]
test ppl:  33%|███▎      | 78/236 [05:45<08:53,  3.38s/it]
test ppl:  33%|███▎      | 79/236 [05:50<09:56,  3.80s/it]
test ppl:  34%|███▍      | 80/236 [05:53<08:58,  3.45s/it]
test ppl:  34%|███▍      | 81/236 [05:59<10:48,  4.18s/it]
test ppl:  35%|███▍      | 82/236 [06:04<12:04,  4.70s/it]
test ppl:  35%|███▌      | 83/236 [06:10<12:55,  5.07s/it]
test ppl:  36%|███▌      | 84/236 [06:13<10:39,  4.21s/it]
test ppl:  36%|███▌      | 85/236 [06:17<10:38,  4.23s/it]
test ppl:  36%|███▋      | 86/236 [06:19<08:54,  3.56s/it]
test ppl:  37%|███▋      | 87/236 [06:22<08:31,  3.43s/it]
test ppl:  37%|███▋      | 88/236 [06:28<10:16,  4.17s/it]
test ppl:  38%|███▊      | 89/236 [06:34<11:28,  4.68s/it]
test ppl:  38%|███▊      | 90/236 [06:40<12:17,  5.05s/it]
test ppl:  39%|███▊      | 91/236 [06:45<12:21,  5.12s/it]
test ppl:  39%|███▉      | 92/236 [06:48<10:33,  4.40s/it]
test ppl:  39%|███▉      | 93/236 [06:54<11:32,  4.85s/it]
test ppl:  40%|███▉      | 94/236 [06:59<12:12,  5.16s/it]
test ppl:  40%|████      | 95/236 [07:05<12:37,  5.37s/it]
test ppl:  41%|████      | 96/236 [07:11<12:53,  5.53s/it]
test ppl:  41%|████      | 97/236 [07:17<13:03,  5.64s/it]
test ppl:  42%|████▏     | 98/236 [07:23<13:09,  5.72s/it]
test ppl:  42%|████▏     | 99/236 [07:29<13:10,  5.77s/it]
test ppl:  42%|████▏     | 100/236 [07:31<10:19,  4.56s/it]
test ppl:  43%|████▎     | 101/236 [07:36<11:08,  4.95s/it]
test ppl:  43%|████▎     | 102/236 [07:40<10:18,  4.62s/it]
test ppl:  44%|████▎     | 103/236 [07:42<08:09,  3.68s/it]
test ppl:  44%|████▍     | 104/236 [07:46<08:12,  3.73s/it]
test ppl:  44%|████▍     | 105/236 [07:49<08:12,  3.76s/it]
test ppl:  45%|████▍     | 106/236 [07:55<09:31,  4.40s/it]
test ppl:  45%|████▌     | 107/236 [07:58<08:21,  3.89s/it]
test ppl:  46%|████▌     | 108/236 [08:03<08:52,  4.16s/it]
test ppl:  46%|████▌     | 109/236 [08:09<09:56,  4.70s/it]
test ppl:  47%|████▋     | 110/236 [08:11<08:12,  3.91s/it]
test ppl:  47%|████▋     | 111/236 [08:17<09:23,  4.51s/it]
test ppl:  47%|████▋     | 112/236 [08:19<07:45,  3.76s/it]
test ppl:  48%|████▊     | 113/236 [08:22<07:24,  3.61s/it]
test ppl:  48%|████▊     | 114/236 [08:26<07:48,  3.84s/it]
test ppl:  49%|████▊     | 115/236 [08:32<08:59,  4.46s/it]
test ppl:  49%|████▉     | 116/236 [08:38<09:46,  4.89s/it]
test ppl:  50%|████▉     | 117/236 [08:42<09:10,  4.63s/it]
test ppl:  50%|█████     | 118/236 [08:48<09:51,  5.01s/it]
test ppl:  50%|█████     | 119/236 [08:50<08:01,  4.11s/it]
test ppl:  51%|█████     | 120/236 [08:54<07:51,  4.06s/it]
test ppl:  51%|█████▏    | 121/236 [09:00<08:50,  4.61s/it]
test ppl:  52%|█████▏    | 122/236 [09:06<09:29,  5.00s/it]
test ppl:  52%|█████▏    | 123/236 [09:08<07:50,  4.16s/it]
test ppl:  53%|█████▎    | 124/236 [09:12<07:47,  4.17s/it]
test ppl:  53%|█████▎    | 125/236 [09:15<06:41,  3.61s/it]
test ppl:  53%|█████▎    | 126/236 [09:21<07:53,  4.30s/it]
test ppl:  54%|█████▍    | 127/236 [09:26<08:41,  4.78s/it]
test ppl:  54%|█████▍    | 128/236 [09:28<07:02,  3.91s/it]
test ppl:  55%|█████▍    | 129/236 [09:31<06:29,  3.64s/it]
test ppl:  55%|█████▌    | 130/236 [09:37<07:38,  4.32s/it]
test ppl:  56%|█████▌    | 131/236 [09:42<07:38,  4.36s/it]
test ppl:  56%|█████▌    | 132/236 [09:48<08:21,  4.82s/it]
test ppl:  56%|█████▋    | 133/236 [09:52<07:47,  4.54s/it]
test ppl:  57%|█████▋    | 134/236 [09:57<08:25,  4.96s/it]
test ppl:  57%|█████▋    | 135/236 [10:03<08:49,  5.25s/it]
test ppl:  58%|█████▊    | 136/236 [10:06<07:32,  4.53s/it]
test ppl:  58%|█████▊    | 137/236 [10:12<08:10,  4.96s/it]
test ppl:  58%|█████▊    | 138/236 [10:18<08:33,  5.24s/it]
test ppl:  59%|█████▉    | 139/236 [10:20<07:06,  4.39s/it]
test ppl:  59%|█████▉    | 140/236 [10:22<05:45,  3.60s/it]
test ppl:  60%|█████▉    | 141/236 [10:25<05:24,  3.41s/it]
test ppl:  60%|██████    | 142/236 [10:27<04:38,  2.96s/it]
test ppl:  61%|██████    | 143/236 [10:33<05:57,  3.84s/it]
test ppl:  61%|██████    | 144/236 [10:36<05:37,  3.66s/it]
test ppl:  61%|██████▏   | 145/236 [10:42<06:34,  4.34s/it]
test ppl:  62%|██████▏   | 146/236 [10:48<07:12,  4.81s/it]
test ppl:  62%|██████▏   | 147/236 [10:54<07:37,  5.14s/it]
test ppl:  63%|██████▎   | 148/236 [11:00<07:55,  5.41s/it]
test ppl:  63%|██████▎   | 149/236 [11:04<07:25,  5.12s/it]
test ppl:  64%|██████▎   | 150/236 [11:09<07:02,  4.92s/it]
test ppl:  64%|██████▍   | 151/236 [11:15<07:22,  5.21s/it]
test ppl:  64%|██████▍   | 152/236 [11:21<07:34,  5.42s/it]
test ppl:  65%|██████▍   | 153/236 [11:27<07:41,  5.56s/it]
test ppl:  65%|██████▌   | 154/236 [11:30<06:40,  4.89s/it]
test ppl:  66%|██████▌   | 155/236 [11:34<06:18,  4.67s/it]
test ppl:  66%|██████▌   | 156/236 [11:37<05:29,  4.12s/it]
test ppl:  67%|██████▋   | 157/236 [11:39<04:38,  3.53s/it]
test ppl:  67%|██████▋   | 158/236 [11:45<05:30,  4.24s/it]
test ppl:  67%|██████▋   | 159/236 [11:47<04:31,  3.52s/it]
test ppl:  68%|██████▊   | 160/236 [11:48<03:36,  2.85s/it]
test ppl:  68%|██████▊   | 161/236 [11:49<02:56,  2.35s/it]
test ppl:  69%|██████▊   | 162/236 [11:54<03:50,  3.12s/it]
test ppl:  69%|██████▉   | 163/236 [11:57<03:41,  3.03s/it]
test ppl:  69%|██████▉   | 164/236 [12:01<04:08,  3.46s/it]
test ppl:  70%|██████▉   | 165/236 [12:07<04:57,  4.20s/it]
test ppl:  70%|███████   | 166/236 [12:11<04:43,  4.05s/it]
test ppl:  71%|███████   | 167/236 [12:13<03:45,  3.27s/it]
test ppl:  71%|███████   | 168/236 [12:14<03:05,  2.73s/it]
test ppl:  72%|███████▏  | 169/236 [12:20<04:07,  3.69s/it]
test ppl:  72%|███████▏  | 170/236 [12:26<04:48,  4.37s/it]
test ppl:  72%|███████▏  | 171/236 [12:28<03:50,  3.54s/it]
test ppl:  73%|███████▎  | 172/236 [12:30<03:34,  3.35s/it]
test ppl:  73%|███████▎  | 173/236 [12:33<03:08,  2.99s/it]
test ppl:  74%|███████▎  | 174/236 [12:38<03:42,  3.59s/it]
test ppl:  74%|███████▍  | 175/236 [12:40<03:26,  3.39s/it]
test ppl:  75%|███████▍  | 176/236 [12:46<04:08,  4.14s/it]
test ppl:  75%|███████▌  | 177/236 [12:52<04:35,  4.67s/it]
test ppl:  75%|███████▌  | 178/236 [12:58<04:52,  5.05s/it]
test ppl:  76%|███████▌  | 179/236 [13:04<05:02,  5.31s/it]
test ppl:  76%|███████▋  | 180/236 [13:09<04:41,  5.03s/it]
test ppl:  77%|███████▋  | 181/236 [13:14<04:50,  5.29s/it]
test ppl:  77%|███████▋  | 182/236 [13:17<03:57,  4.39s/it]
test ppl:  78%|███████▊  | 183/236 [13:20<03:34,  4.06s/it]
test ppl:  78%|███████▊  | 184/236 [13:23<03:18,  3.81s/it]
test ppl:  78%|███████▊  | 185/236 [13:29<03:47,  4.46s/it]
test ppl:  79%|███████▉  | 186/236 [13:31<03:07,  3.74s/it]
test ppl:  79%|███████▉  | 187/236 [13:37<03:35,  4.41s/it]
test ppl:  80%|███████▉  | 188/236 [13:43<03:52,  4.85s/it]
test ppl:  80%|████████  | 189/236 [13:49<04:02,  5.16s/it]
test ppl:  81%|████████  | 190/236 [13:55<04:07,  5.38s/it]
test ppl:  81%|████████  | 191/236 [14:01<04:09,  5.53s/it]
test ppl:  81%|████████▏ | 192/236 [14:03<03:25,  4.68s/it]
test ppl:  82%|████████▏ | 193/236 [14:09<03:36,  5.04s/it]
test ppl:  82%|████████▏ | 194/236 [14:15<03:40,  5.25s/it]
test ppl:  83%|████████▎ | 195/236 [14:17<02:55,  4.28s/it]
test ppl:  83%|████████▎ | 196/236 [14:19<02:24,  3.60s/it]
test ppl:  83%|████████▎ | 197/236 [14:21<02:02,  3.15s/it]
test ppl:  84%|████████▍ | 198/236 [14:27<02:30,  3.96s/it]
test ppl:  84%|████████▍ | 199/236 [14:30<02:19,  3.77s/it]
test ppl:  85%|████████▍ | 200/236 [14:33<02:07,  3.54s/it]
test ppl:  85%|████████▌ | 201/236 [14:36<01:51,  3.19s/it]
test ppl:  86%|████████▌ | 202/236 [14:40<02:00,  3.53s/it]
test ppl:  86%|████████▌ | 203/236 [14:46<02:19,  4.24s/it]
test ppl:  86%|████████▋ | 204/236 [14:50<02:10,  4.07s/it]
test ppl:  87%|████████▋ | 205/236 [14:56<02:23,  4.64s/it]
test ppl:  87%|████████▋ | 206/236 [14:59<02:03,  4.12s/it]
test ppl:  88%|████████▊ | 207/236 [15:04<02:14,  4.65s/it]
test ppl:  88%|████████▊ | 208/236 [15:10<02:20,  5.02s/it]
test ppl:  89%|████████▊ | 209/236 [15:16<02:22,  5.29s/it]
test ppl:  89%|████████▉ | 210/236 [15:20<02:04,  4.78s/it]
test ppl:  89%|████████▉ | 211/236 [15:24<01:53,  4.54s/it]
test ppl:  90%|████████▉ | 212/236 [15:30<01:58,  4.94s/it]
test ppl:  90%|█████████ | 213/236 [15:36<02:00,  5.22s/it]
test ppl:  91%|█████████ | 214/236 [15:37<01:29,  4.06s/it]
test ppl:  91%|█████████ | 215/236 [15:41<01:27,  4.16s/it]
test ppl:  92%|█████████▏| 216/236 [15:44<01:13,  3.67s/it]
test ppl:  92%|█████████▏| 217/236 [15:50<01:22,  4.36s/it]
test ppl:  92%|█████████▏| 218/236 [15:56<01:26,  4.81s/it]
test ppl:  93%|█████████▎| 219/236 [16:02<01:27,  5.14s/it]
test ppl:  93%|█████████▎| 220/236 [16:07<01:25,  5.36s/it]
test ppl:  94%|█████████▎| 221/236 [16:09<01:05,  4.34s/it]
test ppl:  94%|█████████▍| 222/236 [16:15<01:07,  4.80s/it]
test ppl:  94%|█████████▍| 223/236 [16:21<01:06,  5.13s/it]
test ppl:  95%|█████████▍| 224/236 [16:23<00:49,  4.10s/it]
test ppl:  95%|█████████▌| 225/236 [16:29<00:50,  4.62s/it]
test ppl:  96%|█████████▌| 226/236 [16:31<00:40,  4.02s/it]
test ppl:  96%|█████████▌| 227/236 [16:33<00:30,  3.39s/it]
test ppl:  97%|█████████▋| 228/236 [16:39<00:33,  4.13s/it]
test ppl:  97%|█████████▋| 229/236 [16:42<00:25,  3.62s/it]
test ppl:  97%|█████████▋| 230/236 [16:46<00:22,  3.74s/it]
test ppl:  98%|█████████▊| 231/236 [16:48<00:17,  3.41s/it]
test ppl:  98%|█████████▊| 232/236 [16:51<00:12,  3.12s/it]
test ppl:  99%|█████████▊| 233/236 [16:57<00:11,  3.95s/it]
test ppl:  99%|█████████▉| 234/236 [16:58<00:06,  3.16s/it]
test ppl: 100%|█████████▉| 235/236 [17:04<00:03,  3.97s/it]
test ppl: 100%|██████████| 236/236 [17:04<00:00,  3.02s/it]
test ppl: 100%|██████████| 236/236 [17:04<00:00,  4.34s/it]
10/12/2024 09:02:35 - INFO - __main__ -    em: 0.1227
10/12/2024 09:02:35 - INFO - __main__ -   Finish and take 18m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.6 10:  em: 0.1227

--------------------------------------------------------------------------------
Running experiment with knn_temp=10, lmbda=0.6, k=64
2024-10-12 09:02:42.430049: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 09:02:42.450211: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 09:02:42.473055: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 09:02:42.480055: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 09:02:42.496285: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 09:02:43.495120: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 09:02:44 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.6, knn_temp=10, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 09:02:44 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:38:40,  2.20it/s]
Adding feature api:   4%|▍         | 7285/187062 [00:00<00:10, 17405.33it/s]
Adding feature api:   8%|▊         | 15618/187062 [00:00<00:05, 34180.80it/s]
Adding feature api:  13%|█▎        | 24031/187062 [00:00<00:03, 47496.31it/s]
Adding feature api:  17%|█▋        | 32398/187062 [00:00<00:02, 57471.49it/s]
Adding feature api:  22%|██▏       | 40819/187062 [00:00<00:02, 65026.42it/s]
Adding feature api:  26%|██▋       | 49280/187062 [00:01<00:01, 70658.57it/s]
Adding feature api:  31%|███       | 57687/187062 [00:01<00:01, 74562.62it/s]
Adding feature api:  35%|███▌      | 66118/187062 [00:01<00:01, 77425.51it/s]
Adding feature api:  40%|███▉      | 74455/187062 [00:01<00:01, 79182.35it/s]
Adding feature api:  44%|████▍     | 82855/187062 [00:01<00:01, 80611.72it/s]
Adding feature api:  49%|████▊     | 91164/187062 [00:01<00:01, 80992.89it/s]
Adding feature api:  53%|█████▎    | 99557/187062 [00:01<00:01, 81864.68it/s]
Adding feature api:  58%|█████▊    | 107991/187062 [00:01<00:00, 82600.94it/s]
Adding feature api:  62%|██████▏   | 116412/187062 [00:01<00:00, 83081.15it/s]
Adding feature api:  67%|██████▋   | 124781/187062 [00:01<00:00, 83237.66it/s]
Adding feature api:  71%|███████   | 133154/187062 [00:02<00:00, 83382.80it/s]
Adding feature api:  76%|███████▌  | 141522/187062 [00:02<00:00, 83436.39it/s]
Adding feature api:  80%|████████  | 149934/187062 [00:02<00:00, 83640.38it/s]
Adding feature api:  85%|████████▍ | 158313/187062 [00:02<00:00, 83641.73it/s]
Adding feature api:  89%|████████▉ | 166695/187062 [00:02<00:00, 83694.76it/s]
Adding feature api:  94%|█████████▎| 175106/187062 [00:02<00:00, 83816.75it/s]
Adding feature api:  98%|█████████▊| 183493/187062 [00:02<00:00, 58386.69it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64235.34it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:19:56,  2.23it/s]
Adding feature datatype:   4%|▍         | 7078/187062 [00:00<00:10, 17082.23it/s]
Adding feature datatype:   8%|▊         | 15172/187062 [00:00<00:05, 33454.22it/s]
Adding feature datatype:  12%|█▏        | 23332/187062 [00:00<00:03, 46360.63it/s]
Adding feature datatype:  17%|█▋        | 31536/187062 [00:00<00:02, 56240.16it/s]
Adding feature datatype:  21%|██        | 39650/187062 [00:00<00:02, 63296.67it/s]
Adding feature datatype:  26%|██▌       | 47801/187062 [00:01<00:02, 68545.62it/s]
Adding feature datatype:  30%|██▉       | 55977/187062 [00:01<00:01, 72398.16it/s]
Adding feature datatype:  34%|███▍      | 64156/187062 [00:01<00:01, 75159.41it/s]
Adding feature datatype:  39%|███▊      | 72311/187062 [00:01<00:01, 77047.40it/s]
Adding feature datatype:  43%|████▎     | 80434/187062 [00:01<00:01, 78287.41it/s]
Adding feature datatype:  47%|████▋     | 88561/187062 [00:01<00:01, 79172.52it/s]
Adding feature datatype:  52%|█████▏    | 96764/187062 [00:01<00:01, 80023.01it/s]
Adding feature datatype:  56%|█████▌    | 104902/187062 [00:01<00:01, 80426.27it/s]
Adding feature datatype:  60%|██████    | 113041/187062 [00:01<00:00, 80712.75it/s]
Adding feature datatype:  65%|██████▍   | 121197/187062 [00:01<00:00, 80964.78it/s]
Adding feature datatype:  69%|██████▉   | 129351/187062 [00:02<00:00, 81136.17it/s]
Adding feature datatype:  74%|███████▎  | 137516/187062 [00:02<00:00, 81287.66it/s]
Adding feature datatype:  78%|███████▊  | 145676/187062 [00:02<00:00, 81379.46it/s]
Adding feature datatype:  82%|████████▏ | 153867/187062 [00:02<00:00, 81536.54it/s]
Adding feature datatype:  87%|████████▋ | 162066/187062 [00:02<00:00, 81670.74it/s]
Adding feature datatype:  91%|█████████ | 170258/187062 [00:02<00:00, 81743.19it/s]
Adding feature datatype:  95%|█████████▌| 178438/187062 [00:02<00:00, 77015.79it/s]
Adding feature datatype: 100%|█████████▉| 186200/187062 [00:02<00:00, 52324.66it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63138.04it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:14:21,  2.24it/s]
Adding feature literal:   4%|▍         | 7030/187062 [00:00<00:10, 17017.91it/s]
Adding feature literal:   8%|▊         | 15026/187062 [00:00<00:05, 33191.31it/s]
Adding feature literal:  12%|█▏        | 23105/187062 [00:00<00:03, 45971.03it/s]
Adding feature literal:  17%|█▋        | 31183/187062 [00:00<00:02, 55620.85it/s]
Adding feature literal:  21%|██        | 39325/187062 [00:00<00:02, 62938.85it/s]
Adding feature literal:  25%|██▌       | 47489/187062 [00:01<00:02, 68330.85it/s]
Adding feature literal:  30%|██▉       | 55456/187062 [00:01<00:01, 71638.12it/s]
Adding feature literal:  34%|███▍      | 63590/187062 [00:01<00:01, 74491.00it/s]
Adding feature literal:  38%|███▊      | 71728/187062 [00:01<00:01, 76526.82it/s]
Adding feature literal:  43%|████▎     | 79810/187062 [00:01<00:01, 77800.65it/s]
Adding feature literal:  47%|████▋     | 87979/187062 [00:01<00:01, 78957.51it/s]
Adding feature literal:  51%|█████▏    | 96126/187062 [00:01<00:01, 79706.50it/s]
Adding feature literal:  56%|█████▌    | 104327/187062 [00:01<00:01, 80392.97it/s]
Adding feature literal:  60%|██████    | 112525/187062 [00:01<00:00, 80864.68it/s]
Adding feature literal:  65%|██████▍   | 120755/187062 [00:01<00:00, 81293.07it/s]
Adding feature literal:  69%|██████▉   | 128941/187062 [00:02<00:00, 81462.09it/s]
Adding feature literal:  73%|███████▎  | 137146/187062 [00:02<00:00, 81636.59it/s]
Adding feature literal:  78%|███████▊  | 145363/187062 [00:02<00:00, 81794.55it/s]
Adding feature literal:  82%|████████▏ | 153557/187062 [00:02<00:00, 81767.98it/s]
Adding feature literal:  86%|████████▋ | 161744/187062 [00:02<00:00, 81109.48it/s]
Adding feature literal:  91%|█████████ | 169963/187062 [00:02<00:00, 81428.41it/s]
Adding feature literal:  95%|█████████▌| 178112/187062 [00:02<00:00, 79373.25it/s]
Adding feature literal:  99%|█████████▉| 186065/187062 [00:02<00:00, 52616.75it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63089.45it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:16:55,  2.23it/s]
Adding feature operator:   4%|▍         | 7104/187062 [00:00<00:10, 17173.15it/s]
Adding feature operator:   8%|▊         | 15224/187062 [00:00<00:05, 33608.59it/s]
Adding feature operator:  12%|█▏        | 23337/187062 [00:00<00:03, 46359.03it/s]
Adding feature operator:  17%|█▋        | 31466/187062 [00:00<00:02, 56036.94it/s]
Adding feature operator:  21%|██        | 39395/187062 [00:00<00:02, 62628.96it/s]
Adding feature operator:  25%|██▌       | 47580/187062 [00:01<00:02, 68168.18it/s]
Adding feature operator:  30%|██▉       | 55748/187062 [00:01<00:01, 72107.08it/s]
Adding feature operator:  34%|███▍      | 63900/187062 [00:01<00:01, 74873.69it/s]
Adding feature operator:  39%|███▊      | 72069/187062 [00:01<00:01, 76888.02it/s]
Adding feature operator:  43%|████▎     | 80246/187062 [00:01<00:01, 78336.71it/s]
Adding feature operator:  47%|████▋     | 88406/187062 [00:01<00:01, 79308.36it/s]
Adding feature operator:  52%|█████▏    | 96625/187062 [00:01<00:01, 80167.88it/s]
Adding feature operator:  56%|█████▌    | 104857/187062 [00:01<00:01, 80810.85it/s]
Adding feature operator:  60%|██████    | 113088/187062 [00:01<00:00, 81257.35it/s]
Adding feature operator:  65%|██████▍   | 121293/187062 [00:01<00:00, 81493.66it/s]
Adding feature operator:  69%|██████▉   | 129500/187062 [00:02<00:00, 81665.86it/s]
Adding feature operator:  74%|███████▎  | 137697/187062 [00:02<00:00, 81753.48it/s]
Adding feature operator:  78%|███████▊  | 145893/187062 [00:02<00:00, 81034.08it/s]
Adding feature operator:  82%|████████▏ | 154077/187062 [00:02<00:00, 81271.79it/s]
Adding feature operator:  87%|████████▋ | 162306/187062 [00:02<00:00, 81573.01it/s]
Adding feature operator:  91%|█████████ | 170472/187062 [00:02<00:00, 81490.26it/s]
Adding feature operator:  95%|█████████▌| 178627/187062 [00:02<00:00, 76608.17it/s]
Adding feature operator: 100%|█████████▉| 186351/187062 [00:02<00:00, 52230.70it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63196.07it/s]
[2024-10-12 09:03:28,405] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 09:03:29 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 09:03:29 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 41/6548 [00:00<00:16, 389.08 examples/s]
Map:   1%|          | 81/6548 [00:00<00:31, 202.73 examples/s]
Map:   2%|▏         | 121/6548 [00:00<00:24, 259.60 examples/s]
Map:   2%|▏         | 159/6548 [00:00<00:21, 292.93 examples/s]
Map:   3%|▎         | 197/6548 [00:00<00:20, 315.01 examples/s]
Map:   4%|▍         | 247/6548 [00:00<00:17, 360.56 examples/s]
Map:   4%|▍         | 286/6548 [00:00<00:17, 355.05 examples/s]
Map:   5%|▌         | 328/6548 [00:01<00:20, 308.76 examples/s]
Map:   6%|▌         | 364/6548 [00:01<00:19, 320.41 examples/s]
Map:   6%|▋         | 418/6548 [00:01<00:16, 375.53 examples/s]
Map:   7%|▋         | 462/6548 [00:01<00:17, 340.61 examples/s]
Map:   8%|▊         | 508/6548 [00:01<00:18, 323.99 examples/s]
Map:   9%|▊         | 563/6548 [00:01<00:16, 372.62 examples/s]
Map:   9%|▉         | 606/6548 [00:01<00:15, 385.74 examples/s]
Map:  10%|▉         | 649/6548 [00:02<00:19, 306.08 examples/s]
Map:  11%|█         | 691/6548 [00:02<00:17, 330.86 examples/s]
Map:  11%|█         | 731/6548 [00:02<00:16, 342.87 examples/s]
Map:  12%|█▏        | 785/6548 [00:02<00:14, 386.61 examples/s]
Map:  13%|█▎        | 831/6548 [00:02<00:14, 382.52 examples/s]
Map:  13%|█▎        | 874/6548 [00:02<00:14, 389.56 examples/s]
Map:  14%|█▍        | 922/6548 [00:02<00:15, 360.78 examples/s]
Map:  15%|█▍        | 971/6548 [00:02<00:16, 346.42 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:25, 216.73 examples/s]
Map:  16%|█▌        | 1052/6548 [00:03<00:22, 241.62 examples/s]
Map:  17%|█▋        | 1095/6548 [00:03<00:19, 277.24 examples/s]
Map:  17%|█▋        | 1142/6548 [00:03<00:17, 316.60 examples/s]
Map:  18%|█▊        | 1201/6548 [00:03<00:15, 339.75 examples/s]
Map:  19%|█▉        | 1258/6548 [00:03<00:15, 343.14 examples/s]
Map:  20%|█▉        | 1301/6548 [00:03<00:14, 355.14 examples/s]
Map:  21%|██        | 1355/6548 [00:04<00:15, 329.68 examples/s]
Map:  21%|██▏       | 1401/6548 [00:04<00:16, 318.63 examples/s]
Map:  22%|██▏       | 1436/6548 [00:04<00:17, 298.04 examples/s]
Map:  22%|██▏       | 1470/6548 [00:04<00:16, 306.40 examples/s]
Map:  23%|██▎       | 1522/6548 [00:04<00:15, 317.77 examples/s]
Map:  24%|██▍       | 1566/6548 [00:04<00:16, 303.29 examples/s]
Map:  24%|██▍       | 1598/6548 [00:04<00:16, 304.99 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:16, 288.49 examples/s]
Map:  26%|██▌       | 1692/6548 [00:05<00:16, 293.14 examples/s]
Map:  26%|██▋       | 1729/6548 [00:05<00:15, 308.44 examples/s]
Map:  27%|██▋       | 1775/6548 [00:05<00:13, 342.05 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:13, 341.06 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 351.27 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 348.39 examples/s]
Map:  30%|██▉       | 1947/6548 [00:06<00:12, 361.35 examples/s]
Map:  30%|███       | 1991/6548 [00:06<00:12, 377.06 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:20, 224.53 examples/s]
Map:  32%|███▏      | 2070/6548 [00:06<00:17, 254.76 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 267.64 examples/s]
Map:  33%|███▎      | 2142/6548 [00:06<00:17, 256.50 examples/s]
Map:  33%|███▎      | 2179/6548 [00:06<00:15, 278.84 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 282.36 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:15, 285.60 examples/s]
Map:  35%|███▌      | 2292/6548 [00:07<00:14, 294.08 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:13, 318.22 examples/s]
Map:  36%|███▌      | 2373/6548 [00:07<00:13, 307.34 examples/s]
Map:  37%|███▋      | 2416/6548 [00:07<00:12, 336.91 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:13, 313.51 examples/s]
Map:  38%|███▊      | 2493/6548 [00:07<00:12, 317.54 examples/s]
Map:  39%|███▉      | 2538/6548 [00:08<00:13, 298.03 examples/s]
Map:  40%|███▉      | 2591/6548 [00:08<00:11, 348.18 examples/s]
Map:  40%|████      | 2632/6548 [00:08<00:10, 359.14 examples/s]
Map:  41%|████      | 2673/6548 [00:08<00:11, 326.11 examples/s]
Map:  41%|████▏     | 2709/6548 [00:08<00:11, 330.40 examples/s]
Map:  42%|████▏     | 2746/6548 [00:08<00:11, 337.35 examples/s]
Map:  43%|████▎     | 2783/6548 [00:08<00:10, 342.34 examples/s]
Map:  43%|████▎     | 2818/6548 [00:08<00:11, 334.10 examples/s]
Map:  44%|████▎     | 2862/6548 [00:09<00:13, 281.62 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 290.05 examples/s]
Map:  45%|████▌     | 2949/6548 [00:09<00:11, 300.23 examples/s]
Map:  46%|████▌     | 2982/6548 [00:09<00:11, 302.75 examples/s]
Map:  46%|████▌     | 3013/6548 [00:09<00:21, 161.18 examples/s]
Map:  47%|████▋     | 3045/6548 [00:10<00:18, 185.21 examples/s]
Map:  47%|████▋     | 3073/6548 [00:10<00:17, 200.06 examples/s]
Map:  48%|████▊     | 3112/6548 [00:10<00:14, 229.22 examples/s]
Map:  48%|████▊     | 3148/6548 [00:10<00:13, 255.78 examples/s]
Map:  49%|████▊     | 3185/6548 [00:10<00:13, 250.74 examples/s]
Map:  49%|████▉     | 3219/6548 [00:10<00:13, 252.44 examples/s]
Map:  50%|████▉     | 3255/6548 [00:10<00:12, 273.19 examples/s]
Map:  50%|█████     | 3286/6548 [00:10<00:11, 279.01 examples/s]
Map:  51%|█████     | 3331/6548 [00:10<00:10, 313.15 examples/s]
Map:  52%|█████▏    | 3380/6548 [00:11<00:10, 304.95 examples/s]
Map:  52%|█████▏    | 3421/6548 [00:11<00:11, 277.02 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 272.98 examples/s]
Map:  53%|█████▎    | 3496/6548 [00:11<00:11, 271.52 examples/s]
Map:  54%|█████▍    | 3545/6548 [00:11<00:09, 318.09 examples/s]
Map:  55%|█████▍    | 3592/6548 [00:11<00:08, 352.58 examples/s]
Map:  56%|█████▌    | 3638/6548 [00:11<00:07, 379.30 examples/s]
Map:  56%|█████▋    | 3697/6548 [00:12<00:07, 380.51 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:12<00:07, 389.43 examples/s]
Map:  58%|█████▊    | 3802/6548 [00:12<00:06, 395.53 examples/s]
Map:  59%|█████▊    | 3844/6548 [00:12<00:07, 342.24 examples/s]
Map:  59%|█████▉    | 3882/6548 [00:12<00:07, 341.49 examples/s]
Map:  60%|██████    | 3930/6548 [00:12<00:07, 329.76 examples/s]
Map:  61%|██████    | 3967/6548 [00:12<00:07, 338.52 examples/s]
Map:  62%|██████▏   | 4028/6548 [00:13<00:10, 243.91 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 286.46 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 310.39 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:08, 290.39 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:13<00:07, 301.60 examples/s]
Map:  65%|██████▍   | 4250/6548 [00:13<00:07, 322.71 examples/s]
Map:  66%|██████▌   | 4291/6548 [00:13<00:06, 336.08 examples/s]
Map:  66%|██████▋   | 4339/6548 [00:14<00:05, 369.86 examples/s]
Map:  67%|██████▋   | 4398/6548 [00:14<00:06, 337.17 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:06, 340.72 examples/s]
Map:  69%|██████▊   | 4495/6548 [00:14<00:06, 302.97 examples/s]
Map:  69%|██████▉   | 4539/6548 [00:14<00:06, 293.65 examples/s]
Map:  70%|██████▉   | 4579/6548 [00:14<00:06, 315.94 examples/s]
Map:  70%|███████   | 4615/6548 [00:14<00:05, 325.26 examples/s]
Map:  71%|███████   | 4662/6548 [00:15<00:05, 359.81 examples/s]
Map:  72%|███████▏  | 4716/6548 [00:15<00:05, 352.25 examples/s]
Map:  73%|███████▎  | 4783/6548 [00:15<00:04, 380.68 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 386.56 examples/s]
Map:  75%|███████▍  | 4880/6548 [00:15<00:04, 366.97 examples/s]
Map:  75%|███████▌  | 4933/6548 [00:15<00:04, 384.03 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:03, 400.08 examples/s]
Map:  77%|███████▋  | 5041/6548 [00:16<00:06, 249.44 examples/s]
Map:  78%|███████▊  | 5076/6548 [00:16<00:05, 263.46 examples/s]
Map:  78%|███████▊  | 5122/6548 [00:16<00:05, 273.23 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 282.94 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 285.33 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:16<00:04, 300.08 examples/s]
Map:  81%|████████  | 5277/6548 [00:17<00:04, 314.85 examples/s]
Map:  81%|████████  | 5319/6548 [00:17<00:03, 338.49 examples/s]
Map:  82%|████████▏ | 5364/6548 [00:17<00:03, 312.01 examples/s]
Map:  83%|████████▎ | 5404/6548 [00:17<00:03, 294.24 examples/s]
Map:  83%|████████▎ | 5447/6548 [00:17<00:03, 320.41 examples/s]
Map:  84%|████████▍ | 5501/6548 [00:17<00:03, 332.08 examples/s]
Map:  85%|████████▍ | 5540/6548 [00:17<00:02, 343.80 examples/s]
Map:  85%|████████▌ | 5582/6548 [00:18<00:03, 308.79 examples/s]
Map:  86%|████████▌ | 5630/6548 [00:18<00:02, 345.84 examples/s]
Map:  87%|████████▋ | 5677/6548 [00:18<00:02, 329.82 examples/s]
Map:  88%|████████▊ | 5731/6548 [00:18<00:02, 333.55 examples/s]
Map:  88%|████████▊ | 5772/6548 [00:18<00:02, 348.56 examples/s]
Map:  89%|████████▊ | 5808/6548 [00:18<00:02, 348.27 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:01, 356.60 examples/s]
Map:  90%|████████▉ | 5886/6548 [00:18<00:01, 362.97 examples/s]
Map:  90%|█████████ | 5924/6548 [00:18<00:01, 365.34 examples/s]
Map:  91%|█████████ | 5967/6548 [00:19<00:01, 327.67 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 234.88 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 266.96 examples/s]
Map:  94%|█████████▎| 6131/6548 [00:19<00:01, 257.03 examples/s]
Map:  94%|█████████▍| 6167/6548 [00:19<00:01, 275.49 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:20<00:01, 293.69 examples/s]
Map:  96%|█████████▌| 6261/6548 [00:20<00:00, 306.62 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 320.61 examples/s]
Map:  97%|█████████▋| 6364/6548 [00:20<00:00, 343.80 examples/s]
Map:  98%|█████████▊| 6418/6548 [00:20<00:00, 342.76 examples/s]
Map:  99%|█████████▉| 6468/6548 [00:20<00:00, 375.39 examples/s]
Map: 100%|█████████▉| 6525/6548 [00:20<00:00, 373.08 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 310.59 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 318.81 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 341.69 examples/s]
Map:  13%|█▎        | 115/903 [00:00<00:02, 336.20 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 353.68 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 404.49 examples/s]
Map:  29%|██▉       | 263/903 [00:00<00:01, 379.82 examples/s]
Map:  33%|███▎      | 302/903 [00:00<00:01, 376.15 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 304.80 examples/s]
Map:  45%|████▌     | 409/903 [00:01<00:01, 285.73 examples/s]
Map:  50%|█████     | 455/903 [00:01<00:01, 287.24 examples/s]
Map:  54%|█████▍    | 487/903 [00:01<00:01, 288.84 examples/s]
Map:  59%|█████▉    | 536/903 [00:01<00:01, 327.57 examples/s]
Map:  64%|██████▍   | 577/903 [00:01<00:00, 345.48 examples/s]
Map:  68%|██████▊   | 618/903 [00:01<00:00, 359.91 examples/s]
Map:  73%|███████▎  | 658/903 [00:01<00:00, 365.59 examples/s]
Map:  77%|███████▋  | 696/903 [00:02<00:00, 359.81 examples/s]
Map:  82%|████████▏ | 742/903 [00:02<00:00, 383.59 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 381.59 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 383.15 examples/s]
Map:  97%|█████████▋| 879/903 [00:02<00:00, 359.62 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 315.93 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 300.96 examples/s]
Map:   4%|▍         | 81/1882 [00:00<00:04, 368.16 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:04, 353.62 examples/s]
Map:   9%|▊         | 161/1882 [00:00<00:04, 373.79 examples/s]
Map:  11%|█         | 207/1882 [00:00<00:04, 341.67 examples/s]
Map:  14%|█▎        | 258/1882 [00:00<00:04, 385.48 examples/s]
Map:  16%|█▌        | 303/1882 [00:00<00:04, 345.70 examples/s]
Map:  18%|█▊        | 339/1882 [00:00<00:04, 348.67 examples/s]
Map:  20%|██        | 380/1882 [00:01<00:04, 313.43 examples/s]
Map:  22%|██▏       | 423/1882 [00:01<00:04, 295.42 examples/s]
Map:  25%|██▌       | 472/1882 [00:01<00:04, 303.39 examples/s]
Map:  27%|██▋       | 507/1882 [00:01<00:04, 297.67 examples/s]
Map:  30%|██▉       | 556/1882 [00:01<00:04, 303.15 examples/s]
Map:  32%|███▏      | 603/1882 [00:01<00:03, 339.19 examples/s]
Map:  35%|███▍      | 653/1882 [00:01<00:03, 368.01 examples/s]
Map:  37%|███▋      | 696/1882 [00:02<00:03, 381.64 examples/s]
Map:  40%|████      | 761/1882 [00:02<00:02, 396.10 examples/s]
Map:  43%|████▎     | 805/1882 [00:02<00:03, 345.20 examples/s]
Map:  45%|████▌     | 848/1882 [00:02<00:02, 358.67 examples/s]
Map:  47%|████▋     | 892/1882 [00:02<00:02, 373.91 examples/s]
Map:  49%|████▉     | 931/1882 [00:02<00:02, 369.72 examples/s]
Map:  52%|█████▏    | 982/1882 [00:02<00:02, 404.97 examples/s]
Map:  55%|█████▌    | 1039/1882 [00:03<00:03, 254.76 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 261.09 examples/s]
Map:  59%|█████▉    | 1117/1882 [00:03<00:02, 267.99 examples/s]
Map:  62%|██████▏   | 1164/1882 [00:03<00:02, 274.88 examples/s]
Map:  64%|██████▍   | 1200/1882 [00:03<00:02, 250.47 examples/s]
Map:  66%|██████▌   | 1241/1882 [00:03<00:02, 279.38 examples/s]
Map:  68%|██████▊   | 1280/1882 [00:03<00:02, 300.98 examples/s]
Map:  71%|███████   | 1334/1882 [00:04<00:01, 346.53 examples/s]
Map:  73%|███████▎  | 1381/1882 [00:04<00:01, 330.59 examples/s]
Map:  75%|███████▌  | 1419/1882 [00:04<00:01, 297.52 examples/s]
Map:  78%|███████▊  | 1465/1882 [00:04<00:01, 296.79 examples/s]
Map:  80%|████████  | 1506/1882 [00:04<00:01, 265.24 examples/s]
Map:  82%|████████▏ | 1535/1882 [00:04<00:01, 261.52 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:05<00:01, 277.59 examples/s]
Map:  86%|████████▋ | 1625/1882 [00:05<00:00, 307.92 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 314.56 examples/s]
Map:  91%|█████████ | 1716/1882 [00:05<00:00, 321.86 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 277.40 examples/s]
Map:  95%|█████████▍| 1785/1882 [00:05<00:00, 279.04 examples/s]
Map:  97%|█████████▋| 1830/1882 [00:05<00:00, 315.15 examples/s]
Map: 100%|█████████▉| 1874/1882 [00:05<00:00, 345.08 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 305.82 examples/s]
10/12/2024 09:04:31 - INFO - __main__ -     ***** Testing *****
10/12/2024 09:04:31 - INFO - __main__ -     Batch size = 8
10/12/2024 09:04:31 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 09:04:32 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 09:04:32 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 09:04:33 - INFO - knnlm -   Reading datastore took 0.910905122756958 s
10/12/2024 09:04:34 - INFO - knnlm -   Moving index to GPU took 0.9067227840423584 s
10/12/2024 09:04:34 - INFO - __main__ -   ******************************break-into
10/12/2024 09:04:34 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 09:04:34 - INFO - __main__ -     Num examples = 236
10/12/2024 09:04:34 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<31:09,  7.96s/it]
test ppl:   1%|          | 2/236 [00:10<18:52,  4.84s/it]
test ppl:   1%|▏         | 3/236 [00:12<13:18,  3.42s/it]
test ppl:   2%|▏         | 4/236 [00:14<10:45,  2.78s/it]
test ppl:   2%|▏         | 5/236 [00:20<15:07,  3.93s/it]
test ppl:   3%|▎         | 6/236 [00:27<19:34,  5.11s/it]
test ppl:   3%|▎         | 7/236 [00:30<16:56,  4.44s/it]
test ppl:   3%|▎         | 8/236 [00:36<18:25,  4.85s/it]
test ppl:   4%|▍         | 9/236 [00:38<15:27,  4.08s/it]
test ppl:   4%|▍         | 10/236 [00:44<17:15,  4.58s/it]
test ppl:   5%|▍         | 11/236 [00:50<19:08,  5.11s/it]
test ppl:   5%|▌         | 12/236 [00:58<21:35,  5.78s/it]
test ppl:   6%|▌         | 13/236 [01:05<23:13,  6.25s/it]
test ppl:   6%|▌         | 14/236 [01:12<24:13,  6.55s/it]
test ppl:   6%|▋         | 15/236 [01:14<18:47,  5.10s/it]
test ppl:   7%|▋         | 16/236 [01:20<19:35,  5.34s/it]
test ppl:   7%|▋         | 17/236 [01:25<19:52,  5.45s/it]
test ppl:   8%|▊         | 18/236 [01:27<15:46,  4.34s/it]
test ppl:   8%|▊         | 19/236 [01:33<17:14,  4.77s/it]
test ppl:   8%|▊         | 20/236 [01:39<18:33,  5.15s/it]
test ppl:   9%|▉         | 21/236 [01:42<16:04,  4.48s/it]
test ppl:   9%|▉         | 22/236 [01:48<17:28,  4.90s/it]
test ppl:  10%|▉         | 23/236 [01:51<15:11,  4.28s/it]
test ppl:  10%|█         | 24/236 [01:57<16:50,  4.77s/it]
test ppl:  11%|█         | 25/236 [01:59<14:02,  3.99s/it]
test ppl:  11%|█         | 26/236 [02:05<15:58,  4.56s/it]
test ppl:  11%|█▏        | 27/236 [02:09<15:17,  4.39s/it]
test ppl:  12%|█▏        | 28/236 [02:10<12:22,  3.57s/it]
test ppl:  12%|█▏        | 29/236 [02:13<11:18,  3.28s/it]
test ppl:  13%|█▎        | 30/236 [02:14<09:26,  2.75s/it]
test ppl:  13%|█▎        | 31/236 [02:20<12:34,  3.68s/it]
test ppl:  14%|█▎        | 32/236 [02:24<12:58,  3.82s/it]
test ppl:  14%|█▍        | 33/236 [02:28<12:45,  3.77s/it]
test ppl:  14%|█▍        | 34/236 [02:32<12:54,  3.84s/it]
test ppl:  15%|█▍        | 35/236 [02:35<11:31,  3.44s/it]
test ppl:  15%|█▌        | 36/236 [02:40<13:53,  4.17s/it]
test ppl:  16%|█▌        | 37/236 [02:46<15:32,  4.69s/it]
test ppl:  16%|█▌        | 38/236 [02:49<13:05,  3.97s/it]
test ppl:  17%|█▋        | 39/236 [02:51<11:49,  3.60s/it]
test ppl:  17%|█▋        | 40/236 [02:53<09:47,  3.00s/it]
test ppl:  17%|█▋        | 41/236 [02:59<12:31,  3.85s/it]
test ppl:  18%|█▊        | 42/236 [03:05<14:28,  4.47s/it]
test ppl:  18%|█▊        | 43/236 [03:11<15:45,  4.90s/it]
test ppl:  19%|█▊        | 44/236 [03:14<14:24,  4.50s/it]
test ppl:  19%|█▉        | 45/236 [03:16<12:05,  3.80s/it]
test ppl:  19%|█▉        | 46/236 [03:22<14:04,  4.44s/it]
test ppl:  20%|█▉        | 47/236 [03:24<11:14,  3.57s/it]
test ppl:  20%|██        | 48/236 [03:30<13:21,  4.26s/it]
test ppl:  21%|██        | 49/236 [03:34<13:00,  4.17s/it]
test ppl:  21%|██        | 50/236 [03:40<14:35,  4.71s/it]
test ppl:  22%|██▏       | 51/236 [03:43<13:24,  4.35s/it]
test ppl:  22%|██▏       | 52/236 [03:46<11:56,  3.89s/it]
test ppl:  22%|██▏       | 53/236 [03:52<13:42,  4.50s/it]
test ppl:  23%|██▎       | 54/236 [03:58<14:54,  4.91s/it]
test ppl:  23%|██▎       | 55/236 [04:04<15:41,  5.20s/it]
test ppl:  24%|██▎       | 56/236 [04:10<16:17,  5.43s/it]
test ppl:  24%|██▍       | 57/236 [04:15<16:37,  5.57s/it]
test ppl:  25%|██▍       | 58/236 [04:18<13:41,  4.61s/it]
test ppl:  25%|██▌       | 59/236 [04:24<14:44,  5.00s/it]
test ppl:  25%|██▌       | 60/236 [04:27<12:43,  4.34s/it]
test ppl:  26%|██▌       | 61/236 [04:32<14:00,  4.80s/it]
test ppl:  26%|██▋       | 62/236 [04:38<14:52,  5.13s/it]
test ppl:  27%|██▋       | 63/236 [04:41<12:29,  4.33s/it]
test ppl:  27%|██▋       | 64/236 [04:43<10:18,  3.60s/it]
test ppl:  28%|██▊       | 65/236 [04:44<08:23,  2.94s/it]
test ppl:  28%|██▊       | 66/236 [04:50<10:49,  3.82s/it]
test ppl:  28%|██▊       | 67/236 [04:56<12:31,  4.45s/it]
test ppl:  29%|██▉       | 68/236 [05:02<13:40,  4.88s/it]
test ppl:  29%|██▉       | 69/236 [05:08<14:25,  5.18s/it]
test ppl:  30%|██▉       | 70/236 [05:14<14:56,  5.40s/it]
test ppl:  30%|███       | 71/236 [05:17<13:00,  4.73s/it]
test ppl:  31%|███       | 72/236 [05:20<11:25,  4.18s/it]
test ppl:  31%|███       | 73/236 [05:25<12:44,  4.69s/it]
test ppl:  31%|███▏      | 74/236 [05:28<10:56,  4.05s/it]
test ppl:  32%|███▏      | 75/236 [05:34<12:21,  4.61s/it]
test ppl:  32%|███▏      | 76/236 [05:40<13:18,  4.99s/it]
test ppl:  33%|███▎      | 77/236 [05:43<11:36,  4.38s/it]
test ppl:  33%|███▎      | 78/236 [05:44<09:18,  3.53s/it]
test ppl:  33%|███▎      | 79/236 [05:49<10:13,  3.91s/it]
test ppl:  34%|███▍      | 80/236 [05:52<09:09,  3.52s/it]
test ppl:  34%|███▍      | 81/236 [05:58<10:55,  4.23s/it]
test ppl:  35%|███▍      | 82/236 [06:04<12:08,  4.73s/it]
test ppl:  35%|███▌      | 83/236 [06:09<12:57,  5.08s/it]
test ppl:  36%|███▌      | 84/236 [06:12<10:41,  4.22s/it]
test ppl:  36%|███▌      | 85/236 [06:16<10:39,  4.23s/it]
test ppl:  36%|███▋      | 86/236 [06:18<08:55,  3.57s/it]
test ppl:  37%|███▋      | 87/236 [06:24<10:35,  4.26s/it]
test ppl:  37%|███▋      | 88/236 [06:30<11:42,  4.75s/it]
test ppl:  38%|███▊      | 89/236 [06:36<12:30,  5.10s/it]
test ppl:  38%|███▊      | 90/236 [06:43<14:03,  5.78s/it]
test ppl:  39%|███▊      | 91/236 [06:49<13:49,  5.72s/it]
test ppl:  39%|███▉      | 92/236 [06:51<11:38,  4.85s/it]
test ppl:  39%|███▉      | 93/236 [06:57<12:23,  5.20s/it]
test ppl:  40%|███▉      | 94/236 [07:03<12:53,  5.45s/it]
test ppl:  40%|████      | 95/236 [07:07<11:25,  4.86s/it]
test ppl:  41%|████      | 96/236 [07:13<12:11,  5.22s/it]
test ppl:  41%|████      | 97/236 [07:19<12:41,  5.48s/it]
test ppl:  42%|████▏     | 98/236 [07:25<13:00,  5.65s/it]
test ppl:  42%|████▏     | 99/236 [07:31<13:10,  5.77s/it]
test ppl:  42%|████▏     | 100/236 [07:33<10:21,  4.57s/it]
test ppl:  43%|████▎     | 101/236 [07:39<11:17,  5.02s/it]
test ppl:  43%|████▎     | 102/236 [07:43<10:38,  4.76s/it]
test ppl:  44%|████▎     | 103/236 [07:45<08:25,  3.80s/it]
test ppl:  44%|████▍     | 104/236 [07:49<08:29,  3.86s/it]
test ppl:  44%|████▍     | 105/236 [07:53<08:28,  3.88s/it]
test ppl:  45%|████▍     | 106/236 [07:59<09:49,  4.53s/it]
test ppl:  45%|████▌     | 107/236 [08:01<08:36,  4.00s/it]
test ppl:  46%|████▌     | 108/236 [08:06<09:08,  4.28s/it]
test ppl:  46%|████▌     | 109/236 [08:13<10:14,  4.84s/it]
test ppl:  47%|████▋     | 110/236 [08:15<08:27,  4.03s/it]
test ppl:  47%|████▋     | 111/236 [08:21<09:40,  4.65s/it]
test ppl:  47%|████▋     | 112/236 [08:23<07:59,  3.87s/it]
test ppl:  48%|████▊     | 113/236 [08:26<07:36,  3.71s/it]
test ppl:  48%|████▊     | 114/236 [08:31<07:59,  3.93s/it]
test ppl:  49%|████▊     | 115/236 [08:37<09:07,  4.52s/it]
test ppl:  49%|████▉     | 116/236 [08:42<09:52,  4.94s/it]
test ppl:  50%|████▉     | 117/236 [08:46<09:15,  4.67s/it]
test ppl:  50%|█████     | 118/236 [08:52<09:54,  5.04s/it]
test ppl:  50%|█████     | 119/236 [08:54<08:03,  4.13s/it]
test ppl:  51%|█████     | 120/236 [08:56<06:43,  3.47s/it]
test ppl:  51%|█████▏    | 121/236 [09:02<08:01,  4.19s/it]
test ppl:  52%|█████▏    | 122/236 [09:08<08:56,  4.70s/it]
test ppl:  52%|█████▏    | 123/236 [09:14<09:31,  5.06s/it]
test ppl:  53%|█████▎    | 124/236 [09:18<08:57,  4.80s/it]
test ppl:  53%|█████▎    | 125/236 [09:20<07:29,  4.05s/it]
test ppl:  53%|█████▎    | 126/236 [09:26<08:26,  4.61s/it]
test ppl:  54%|█████▍    | 127/236 [09:32<09:04,  5.00s/it]
test ppl:  54%|█████▍    | 128/236 [09:35<07:43,  4.29s/it]
test ppl:  55%|█████▍    | 129/236 [09:38<06:58,  3.91s/it]
test ppl:  55%|█████▌    | 130/236 [09:44<07:58,  4.51s/it]
test ppl:  56%|█████▌    | 131/236 [09:48<07:51,  4.49s/it]
test ppl:  56%|█████▌    | 132/236 [09:54<08:30,  4.91s/it]
test ppl:  56%|█████▋    | 133/236 [09:58<07:53,  4.60s/it]
test ppl:  57%|█████▋    | 134/236 [10:04<08:28,  4.99s/it]
test ppl:  57%|█████▋    | 135/236 [10:10<08:52,  5.27s/it]
test ppl:  58%|█████▊    | 136/236 [10:13<07:34,  4.54s/it]
test ppl:  58%|█████▊    | 137/236 [10:19<08:11,  4.97s/it]
test ppl:  58%|█████▊    | 138/236 [10:25<08:33,  5.24s/it]
test ppl:  59%|█████▉    | 139/236 [10:27<07:05,  4.39s/it]
test ppl:  59%|█████▉    | 140/236 [10:29<05:45,  3.60s/it]
test ppl:  60%|█████▉    | 141/236 [10:34<06:17,  3.97s/it]
test ppl:  60%|██████    | 142/236 [10:35<05:15,  3.36s/it]
test ppl:  61%|██████    | 143/236 [10:41<06:23,  4.12s/it]
test ppl:  61%|██████    | 144/236 [10:45<05:54,  3.86s/it]
test ppl:  61%|██████▏   | 145/236 [10:51<06:46,  4.47s/it]
test ppl:  62%|██████▏   | 146/236 [10:56<07:20,  4.89s/it]
test ppl:  62%|██████▏   | 147/236 [11:02<07:42,  5.20s/it]
test ppl:  63%|██████▎   | 148/236 [11:08<07:58,  5.44s/it]
test ppl:  63%|██████▎   | 149/236 [11:13<07:27,  5.14s/it]
test ppl:  64%|██████▎   | 150/236 [11:19<07:42,  5.38s/it]
test ppl:  64%|██████▍   | 151/236 [11:25<07:50,  5.53s/it]
test ppl:  64%|██████▍   | 152/236 [11:30<07:53,  5.64s/it]
test ppl:  65%|██████▍   | 153/236 [11:36<07:54,  5.71s/it]
test ppl:  65%|██████▌   | 154/236 [11:41<07:17,  5.33s/it]
test ppl:  66%|██████▌   | 155/236 [11:45<06:43,  4.98s/it]
test ppl:  66%|██████▌   | 156/236 [11:48<05:47,  4.34s/it]
test ppl:  67%|██████▋   | 157/236 [11:50<04:50,  3.68s/it]
test ppl:  67%|██████▋   | 158/236 [11:56<05:39,  4.35s/it]
test ppl:  67%|██████▋   | 159/236 [11:58<04:36,  3.59s/it]
test ppl:  68%|██████▊   | 160/236 [11:59<03:40,  2.90s/it]
test ppl:  68%|██████▊   | 161/236 [12:00<02:58,  2.38s/it]
test ppl:  69%|██████▊   | 162/236 [12:06<04:14,  3.43s/it]
test ppl:  69%|██████▉   | 163/236 [12:09<03:57,  3.26s/it]
test ppl:  69%|██████▉   | 164/236 [12:13<04:20,  3.62s/it]
test ppl:  70%|██████▉   | 165/236 [12:19<05:05,  4.30s/it]
test ppl:  70%|███████   | 166/236 [12:23<04:48,  4.12s/it]
test ppl:  71%|███████   | 167/236 [12:24<03:49,  3.32s/it]
test ppl:  71%|███████   | 168/236 [12:26<03:08,  2.77s/it]
test ppl:  72%|███████▏  | 169/236 [12:32<04:09,  3.72s/it]
test ppl:  72%|███████▏  | 170/236 [12:38<04:50,  4.40s/it]
test ppl:  72%|███████▏  | 171/236 [12:39<03:51,  3.56s/it]
test ppl:  73%|███████▎  | 172/236 [12:42<03:35,  3.36s/it]
test ppl:  73%|███████▎  | 173/236 [12:44<03:09,  3.00s/it]
test ppl:  74%|███████▎  | 174/236 [12:49<03:42,  3.60s/it]
test ppl:  74%|███████▍  | 175/236 [12:52<03:11,  3.14s/it]
test ppl:  75%|███████▍  | 176/236 [12:57<03:58,  3.97s/it]
test ppl:  75%|███████▌  | 177/236 [13:03<04:29,  4.57s/it]
test ppl:  75%|███████▌  | 178/236 [13:09<04:48,  4.98s/it]
test ppl:  76%|███████▌  | 179/236 [13:15<05:00,  5.27s/it]
test ppl:  76%|███████▋  | 180/236 [13:20<04:40,  5.01s/it]
test ppl:  77%|███████▋  | 181/236 [13:26<04:50,  5.28s/it]
test ppl:  77%|███████▋  | 182/236 [13:28<03:56,  4.38s/it]
test ppl:  78%|███████▊  | 183/236 [13:31<03:35,  4.06s/it]
test ppl:  78%|███████▊  | 184/236 [13:34<03:18,  3.82s/it]
test ppl:  78%|███████▊  | 185/236 [13:40<03:48,  4.47s/it]
test ppl:  79%|███████▉  | 186/236 [13:43<03:07,  3.76s/it]
test ppl:  79%|███████▉  | 187/236 [13:49<03:37,  4.43s/it]
test ppl:  80%|███████▉  | 188/236 [13:54<03:54,  4.88s/it]
test ppl:  80%|████████  | 189/236 [14:00<04:04,  5.19s/it]
test ppl:  81%|████████  | 190/236 [14:06<04:08,  5.40s/it]
test ppl:  81%|████████  | 191/236 [14:12<04:14,  5.65s/it]
test ppl:  81%|████████▏ | 192/236 [14:16<03:36,  4.92s/it]
test ppl:  82%|████████▏ | 193/236 [14:23<03:59,  5.56s/it]
test ppl:  82%|████████▏ | 194/236 [14:30<04:10,  5.95s/it]
test ppl:  83%|████████▎ | 195/236 [14:32<03:20,  4.90s/it]
test ppl:  83%|████████▎ | 196/236 [14:34<02:46,  4.15s/it]
test ppl:  83%|████████▎ | 197/236 [14:42<03:15,  5.01s/it]
test ppl:  84%|████████▍ | 198/236 [14:49<03:33,  5.62s/it]
test ppl:  84%|████████▍ | 199/236 [14:53<03:09,  5.13s/it]
test ppl:  85%|████████▍ | 200/236 [15:00<03:24,  5.69s/it]
test ppl:  85%|████████▌ | 201/236 [15:02<02:49,  4.84s/it]
test ppl:  86%|████████▌ | 202/236 [15:08<02:48,  4.95s/it]
test ppl:  86%|████████▌ | 203/236 [15:15<03:04,  5.58s/it]
test ppl:  86%|████████▋ | 204/236 [15:19<02:47,  5.22s/it]
test ppl:  87%|████████▋ | 205/236 [15:26<02:59,  5.78s/it]
test ppl:  87%|████████▋ | 206/236 [15:30<02:32,  5.10s/it]
test ppl:  88%|████████▊ | 207/236 [15:37<02:44,  5.68s/it]
test ppl:  88%|████████▊ | 208/236 [15:44<02:50,  6.09s/it]
test ppl:  89%|████████▊ | 209/236 [15:51<02:54,  6.45s/it]
test ppl:  89%|████████▉ | 210/236 [15:55<02:32,  5.86s/it]
test ppl:  89%|████████▉ | 211/236 [16:00<02:19,  5.60s/it]
test ppl:  90%|████████▉ | 212/236 [16:08<02:26,  6.11s/it]
test ppl:  90%|█████████ | 213/236 [16:15<02:28,  6.48s/it]
test ppl:  91%|█████████ | 214/236 [16:17<01:50,  5.03s/it]
test ppl:  91%|█████████ | 215/236 [16:22<01:48,  5.18s/it]
test ppl:  92%|█████████▏| 216/236 [16:25<01:31,  4.56s/it]
test ppl:  92%|█████████▏| 217/236 [16:33<01:42,  5.42s/it]
test ppl:  92%|█████████▏| 218/236 [16:37<01:29,  4.95s/it]
test ppl:  93%|█████████▎| 219/236 [16:44<01:36,  5.67s/it]
test ppl:  93%|█████████▎| 220/236 [16:51<01:38,  6.17s/it]
test ppl:  94%|█████████▎| 221/236 [16:54<01:15,  5.05s/it]
test ppl:  94%|█████████▍| 222/236 [17:01<01:20,  5.74s/it]
test ppl:  94%|█████████▍| 223/236 [17:08<01:20,  6.22s/it]
test ppl:  95%|█████████▍| 224/236 [17:11<01:00,  5.01s/it]
test ppl:  95%|█████████▌| 225/236 [17:18<01:02,  5.70s/it]
test ppl:  96%|█████████▌| 226/236 [17:21<00:49,  4.97s/it]
test ppl:  96%|█████████▌| 227/236 [17:24<00:37,  4.19s/it]
test ppl:  97%|█████████▋| 228/236 [17:27<00:30,  3.80s/it]
test ppl:  97%|█████████▋| 229/236 [17:30<00:24,  3.56s/it]
test ppl:  97%|█████████▋| 230/236 [17:35<00:23,  4.00s/it]
test ppl:  98%|█████████▊| 231/236 [17:38<00:18,  3.77s/it]
test ppl:  98%|█████████▊| 232/236 [17:41<00:14,  3.56s/it]
test ppl:  99%|█████████▊| 233/236 [17:46<00:12,  4.13s/it]
test ppl:  99%|█████████▉| 234/236 [17:48<00:06,  3.38s/it]
test ppl: 100%|█████████▉| 235/236 [17:55<00:04,  4.57s/it]
test ppl: 100%|██████████| 236/236 [17:56<00:00,  3.48s/it]
test ppl: 100%|██████████| 236/236 [17:56<00:00,  4.56s/it]
10/12/2024 09:22:30 - INFO - __main__ -    em: 0.1238
10/12/2024 09:22:30 - INFO - __main__ -   Finish and take 19m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.6 10:  em: 0.1238

--------------------------------------------------------------------------------
Running experiment with knn_temp=20, lmbda=0.2, k=16
2024-10-12 09:22:37.868869: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 09:22:37.888444: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 09:22:37.910153: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 09:22:37.916782: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 09:22:37.932690: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 09:22:38.928295: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 09:22:40 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.2, knn_temp=20, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 09:22:40 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:34:11,  2.20it/s]
Adding feature api:   4%|▎         | 6986/187062 [00:00<00:10, 16730.96it/s]
Adding feature api:   8%|▊         | 15232/187062 [00:00<00:05, 33486.33it/s]
Adding feature api:  13%|█▎        | 23525/187062 [00:00<00:03, 46683.98it/s]
Adding feature api:  17%|█▋        | 31858/187062 [00:00<00:02, 56799.71it/s]
Adding feature api:  21%|██▏       | 39945/187062 [00:00<00:02, 63605.84it/s]
Adding feature api:  26%|██▌       | 48269/187062 [00:01<00:02, 69254.96it/s]
Adding feature api:  30%|███       | 56627/187062 [00:01<00:01, 73427.77it/s]
Adding feature api:  35%|███▍      | 64895/187062 [00:01<00:01, 76144.93it/s]
Adding feature api:  39%|███▉      | 73011/187062 [00:01<00:01, 77624.70it/s]
Adding feature api:  43%|████▎     | 81344/187062 [00:01<00:01, 79316.98it/s]
Adding feature api:  48%|████▊     | 89729/187062 [00:01<00:01, 80665.53it/s]
Adding feature api:  52%|█████▏    | 98131/187062 [00:01<00:01, 81665.50it/s]
Adding feature api:  57%|█████▋    | 106535/187062 [00:01<00:00, 82374.71it/s]
Adding feature api:  61%|██████▏   | 114858/187062 [00:01<00:00, 81831.05it/s]
Adding feature api:  66%|██████▌   | 123199/187062 [00:01<00:00, 82300.19it/s]
Adding feature api:  70%|███████   | 131526/187062 [00:02<00:00, 82586.66it/s]
Adding feature api:  75%|███████▍  | 139879/187062 [00:02<00:00, 82865.12it/s]
Adding feature api:  79%|███████▉  | 148187/187062 [00:02<00:00, 82409.85it/s]
Adding feature api:  84%|████████▎ | 156548/187062 [00:02<00:00, 82766.23it/s]
Adding feature api:  88%|████████▊ | 164920/187062 [00:02<00:00, 83048.13it/s]
Adding feature api:  93%|█████████▎| 173315/187062 [00:02<00:00, 83314.28it/s]
Adding feature api:  97%|█████████▋| 181653/187062 [00:02<00:00, 63951.92it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 63703.63it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:48:04,  2.18it/s]
Adding feature datatype:   4%|▍         | 7075/187062 [00:00<00:10, 16818.82it/s]
Adding feature datatype:   8%|▊         | 14792/187062 [00:00<00:05, 32118.49it/s]
Adding feature datatype:  12%|█▏        | 22848/187062 [00:00<00:03, 44996.46it/s]
Adding feature datatype:  17%|█▋        | 30905/187062 [00:00<00:02, 54787.71it/s]
Adding feature datatype:  21%|██        | 39031/187062 [00:00<00:02, 62257.36it/s]
Adding feature datatype:  25%|██▌       | 47168/187062 [00:01<00:02, 67746.66it/s]
Adding feature datatype:  30%|██▉       | 55298/187062 [00:01<00:01, 71688.12it/s]
Adding feature datatype:  34%|███▍      | 63140/187062 [00:01<00:01, 73436.80it/s]
Adding feature datatype:  38%|███▊      | 71281/187062 [00:01<00:01, 75785.39it/s]
Adding feature datatype:  42%|████▏     | 79397/187062 [00:01<00:01, 77376.91it/s]
Adding feature datatype:  47%|████▋     | 87498/187062 [00:01<00:01, 78456.30it/s]
Adding feature datatype:  51%|█████     | 95644/187062 [00:01<00:01, 79351.44it/s]
Adding feature datatype:  55%|█████▌    | 103699/187062 [00:01<00:01, 78991.33it/s]
Adding feature datatype:  60%|█████▉    | 111809/187062 [00:01<00:00, 79617.21it/s]
Adding feature datatype:  64%|██████▍   | 119967/187062 [00:01<00:00, 80198.94it/s]
Adding feature datatype:  68%|██████▊   | 128029/187062 [00:02<00:00, 80187.22it/s]
Adding feature datatype:  73%|███████▎  | 136166/187062 [00:02<00:00, 80539.65it/s]
Adding feature datatype:  77%|███████▋  | 144310/187062 [00:02<00:00, 80806.24it/s]
Adding feature datatype:  81%|████████▏ | 152406/187062 [00:02<00:00, 79884.22it/s]
Adding feature datatype:  86%|████████▌ | 160534/187062 [00:02<00:00, 80297.45it/s]
Adding feature datatype:  90%|█████████ | 168708/187062 [00:02<00:00, 80726.70it/s]
Adding feature datatype:  95%|█████████▍| 176873/187062 [00:02<00:00, 80999.24it/s]
Adding feature datatype:  99%|█████████▉| 184978/187062 [00:02<00:00, 53547.01it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 62275.34it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:35:13,  2.20it/s]
Adding feature literal:   4%|▎         | 6996/187062 [00:00<00:10, 16745.62it/s]
Adding feature literal:   8%|▊         | 15009/187062 [00:00<00:05, 32896.27it/s]
Adding feature literal:  12%|█▏        | 23039/187062 [00:00<00:03, 45546.19it/s]
Adding feature literal:  17%|█▋        | 31089/187062 [00:00<00:02, 55191.70it/s]
Adding feature literal:  21%|██        | 39119/187062 [00:00<00:02, 62290.36it/s]
Adding feature literal:  25%|██▌       | 47216/187062 [00:01<00:02, 67664.47it/s]
Adding feature literal:  30%|██▉       | 55341/187062 [00:01<00:01, 71620.74it/s]
Adding feature literal:  34%|███▍      | 63415/187062 [00:01<00:01, 74298.13it/s]
Adding feature literal:  38%|███▊      | 71384/187062 [00:01<00:01, 75891.11it/s]
Adding feature literal:  42%|████▏     | 79432/187062 [00:01<00:01, 77253.31it/s]
Adding feature literal:  47%|████▋     | 87511/187062 [00:01<00:01, 78305.71it/s]
Adding feature literal:  51%|█████     | 95603/187062 [00:01<00:01, 79085.35it/s]
Adding feature literal:  55%|█████▌    | 103644/187062 [00:01<00:01, 79480.40it/s]
Adding feature literal:  60%|█████▉    | 111681/187062 [00:01<00:00, 79745.96it/s]
Adding feature literal:  64%|██████▍   | 119782/187062 [00:01<00:00, 80122.42it/s]
Adding feature literal:  68%|██████▊   | 127849/187062 [00:02<00:00, 80283.76it/s]
Adding feature literal:  73%|███████▎  | 135916/187062 [00:02<00:00, 80397.83it/s]
Adding feature literal:  77%|███████▋  | 143976/187062 [00:02<00:00, 80455.76it/s]
Adding feature literal:  81%|████████▏ | 152036/187062 [00:02<00:00, 80479.88it/s]
Adding feature literal:  86%|████████▌ | 160096/187062 [00:02<00:00, 80513.27it/s]
Adding feature literal:  90%|████████▉ | 168162/187062 [00:02<00:00, 80556.03it/s]
Adding feature literal:  94%|█████████▍| 176223/187062 [00:02<00:00, 80558.18it/s]
Adding feature literal:  99%|█████████▊| 184283/187062 [00:02<00:00, 54562.25it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 62361.04it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:33:33,  2.21it/s]
Adding feature operator:   4%|▎         | 6853/187062 [00:00<00:10, 16418.07it/s]
Adding feature operator:   8%|▊         | 14883/187062 [00:00<00:05, 32706.81it/s]
Adding feature operator:  12%|█▏        | 22887/187062 [00:00<00:03, 45344.05it/s]
Adding feature operator:  17%|█▋        | 31004/187062 [00:00<00:02, 55235.03it/s]
Adding feature operator:  21%|██        | 39116/187062 [00:00<00:02, 62556.58it/s]
Adding feature operator:  25%|██▌       | 47239/187062 [00:01<00:02, 67927.78it/s]
Adding feature operator:  30%|██▉       | 55352/187062 [00:01<00:01, 71772.92it/s]
Adding feature operator:  34%|███▍      | 63468/187062 [00:01<00:01, 74528.88it/s]
Adding feature operator:  38%|███▊      | 71581/187062 [00:01<00:01, 76479.67it/s]
Adding feature operator:  43%|████▎     | 79732/187062 [00:01<00:01, 77972.13it/s]
Adding feature operator:  47%|████▋     | 87841/187062 [00:01<00:01, 78898.44it/s]
Adding feature operator:  51%|█████▏    | 96012/187062 [00:01<00:01, 79735.55it/s]
Adding feature operator:  56%|█████▌    | 104117/187062 [00:01<00:01, 80125.14it/s]
Adding feature operator:  60%|██████    | 112278/187062 [00:01<00:00, 80566.98it/s]
Adding feature operator:  64%|██████▍   | 120442/187062 [00:01<00:00, 80886.20it/s]
Adding feature operator:  69%|██████▉   | 128611/187062 [00:02<00:00, 81123.87it/s]
Adding feature operator:  73%|███████▎  | 136767/187062 [00:02<00:00, 81251.25it/s]
Adding feature operator:  77%|███████▋  | 144959/187062 [00:02<00:00, 81448.56it/s]
Adding feature operator:  82%|████████▏ | 153118/187062 [00:02<00:00, 81374.47it/s]
Adding feature operator:  86%|████████▌ | 161309/187062 [00:02<00:00, 81531.56it/s]
Adding feature operator:  91%|█████████ | 169470/187062 [00:02<00:00, 81308.92it/s]
Adding feature operator:  95%|█████████▍| 177616/187062 [00:02<00:00, 81353.10it/s]
Adding feature operator:  99%|█████████▉| 185755/187062 [00:02<00:00, 52550.19it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 62767.60it/s]
[2024-10-12 09:23:24,235] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 09:23:25 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 09:23:25 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 413.48 examples/s]
Map:   1%|▏         | 90/6548 [00:00<00:25, 249.28 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:23, 272.08 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:19, 323.68 examples/s]
Map:   3%|▎         | 220/6548 [00:00<00:18, 351.02 examples/s]
Map:   4%|▍         | 263/6548 [00:00<00:19, 324.18 examples/s]
Map:   5%|▍         | 302/6548 [00:00<00:19, 320.23 examples/s]
Map:   5%|▌         | 351/6548 [00:01<00:19, 317.07 examples/s]
Map:   6%|▌         | 399/6548 [00:01<00:17, 354.71 examples/s]
Map:   7%|▋         | 437/6548 [00:01<00:17, 355.81 examples/s]
Map:   7%|▋         | 488/6548 [00:01<00:17, 339.94 examples/s]
Map:   8%|▊         | 535/6548 [00:01<00:16, 369.52 examples/s]
Map:   9%|▉         | 577/6548 [00:01<00:15, 376.45 examples/s]
Map:   9%|▉         | 618/6548 [00:01<00:15, 379.05 examples/s]
Map:  10%|█         | 658/6548 [00:01<00:18, 324.09 examples/s]
Map:  11%|█         | 704/6548 [00:02<00:16, 356.06 examples/s]
Map:  11%|█▏        | 742/6548 [00:02<00:16, 360.96 examples/s]
Map:  12%|█▏        | 796/6548 [00:02<00:14, 403.35 examples/s]
Map:  13%|█▎        | 860/6548 [00:02<00:13, 410.57 examples/s]
Map:  14%|█▍        | 910/6548 [00:02<00:14, 381.09 examples/s]
Map:  15%|█▍        | 951/6548 [00:02<00:14, 374.36 examples/s]
Map:  15%|█▌        | 1000/6548 [00:03<00:23, 238.56 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:21, 260.75 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:19, 283.99 examples/s]
Map:  17%|█▋        | 1124/6548 [00:03<00:16, 324.69 examples/s]
Map:  18%|█▊        | 1164/6548 [00:03<00:15, 338.83 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:14, 356.29 examples/s]
Map:  19%|█▉        | 1267/6548 [00:03<00:14, 367.55 examples/s]
Map:  20%|██        | 1315/6548 [00:03<00:15, 345.97 examples/s]
Map:  21%|██        | 1359/6548 [00:04<00:15, 325.00 examples/s]
Map:  21%|██▏       | 1407/6548 [00:04<00:16, 314.24 examples/s]
Map:  22%|██▏       | 1452/6548 [00:04<00:17, 292.47 examples/s]
Map:  23%|██▎       | 1493/6548 [00:04<00:17, 281.62 examples/s]
Map:  23%|██▎       | 1529/6548 [00:04<00:16, 296.60 examples/s]
Map:  24%|██▍       | 1577/6548 [00:04<00:16, 299.26 examples/s]
Map:  25%|██▍       | 1610/6548 [00:04<00:17, 287.88 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:17, 286.69 examples/s]
Map:  26%|██▌       | 1676/6548 [00:05<00:19, 256.07 examples/s]
Map:  26%|██▌       | 1715/6548 [00:05<00:16, 285.02 examples/s]
Map:  27%|██▋       | 1762/6548 [00:05<00:14, 328.18 examples/s]
Map:  28%|██▊       | 1804/6548 [00:05<00:13, 350.12 examples/s]
Map:  28%|██▊       | 1844/6548 [00:05<00:12, 362.19 examples/s]
Map:  29%|██▉       | 1885/6548 [00:05<00:14, 318.09 examples/s]
Map:  29%|██▉       | 1919/6548 [00:05<00:14, 315.68 examples/s]
Map:  30%|██▉       | 1961/6548 [00:06<00:13, 338.56 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:20, 220.23 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:19, 234.47 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:16, 267.60 examples/s]
Map:  32%|███▏      | 2107/6548 [00:06<00:15, 283.02 examples/s]
Map:  33%|███▎      | 2139/6548 [00:06<00:16, 273.04 examples/s]
Map:  33%|███▎      | 2186/6548 [00:06<00:15, 283.82 examples/s]
Map:  34%|███▍      | 2229/6548 [00:07<00:14, 289.26 examples/s]
Map:  35%|███▍      | 2271/6548 [00:07<00:15, 278.01 examples/s]
Map:  35%|███▌      | 2307/6548 [00:07<00:14, 295.78 examples/s]
Map:  36%|███▌      | 2350/6548 [00:07<00:13, 318.65 examples/s]
Map:  36%|███▋      | 2389/6548 [00:07<00:14, 290.18 examples/s]
Map:  37%|███▋      | 2431/6548 [00:07<00:12, 319.35 examples/s]
Map:  38%|███▊      | 2477/6548 [00:07<00:13, 303.35 examples/s]
Map:  38%|███▊      | 2517/6548 [00:08<00:12, 311.68 examples/s]
Map:  39%|███▉      | 2562/6548 [00:08<00:11, 339.81 examples/s]
Map:  40%|███▉      | 2608/6548 [00:08<00:10, 366.12 examples/s]
Map:  40%|████      | 2646/6548 [00:08<00:10, 368.11 examples/s]
Map:  41%|████      | 2698/6548 [00:08<00:10, 352.92 examples/s]
Map:  42%|████▏     | 2737/6548 [00:08<00:10, 347.02 examples/s]
Map:  42%|████▏     | 2775/6548 [00:08<00:10, 352.00 examples/s]
Map:  43%|████▎     | 2824/6548 [00:08<00:10, 341.46 examples/s]
Map:  44%|████▍     | 2875/6548 [00:09<00:12, 283.47 examples/s]
Map:  45%|████▍     | 2922/6548 [00:09<00:13, 271.99 examples/s]
Map:  45%|████▌     | 2961/6548 [00:09<00:12, 288.43 examples/s]
Map:  46%|████▌     | 2995/6548 [00:09<00:15, 231.52 examples/s]
Map:  46%|████▋     | 3043/6548 [00:10<00:20, 175.02 examples/s]
Map:  47%|████▋     | 3073/6548 [00:10<00:18, 191.57 examples/s]
Map:  48%|████▊     | 3115/6548 [00:10<00:15, 224.65 examples/s]
Map:  48%|████▊     | 3149/6548 [00:10<00:14, 228.98 examples/s]
Map:  49%|████▊     | 3183/6548 [00:10<00:14, 239.23 examples/s]
Map:  49%|████▉     | 3218/6548 [00:10<00:14, 234.16 examples/s]
Map:  50%|████▉     | 3252/6548 [00:10<00:12, 255.61 examples/s]
Map:  50%|█████     | 3286/6548 [00:10<00:12, 268.17 examples/s]
Map:  51%|█████     | 3331/6548 [00:11<00:10, 304.77 examples/s]
Map:  52%|█████▏    | 3380/6548 [00:11<00:10, 301.41 examples/s]
Map:  52%|█████▏    | 3421/6548 [00:11<00:11, 280.55 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 275.45 examples/s]
Map:  53%|█████▎    | 3486/6548 [00:11<00:10, 278.60 examples/s]
Map:  54%|█████▍    | 3532/6548 [00:11<00:09, 321.00 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:11<00:08, 346.00 examples/s]
Map:  55%|█████▌    | 3622/6548 [00:11<00:07, 370.93 examples/s]
Map:  56%|█████▌    | 3676/6548 [00:12<00:07, 362.28 examples/s]
Map:  57%|█████▋    | 3722/6548 [00:12<00:07, 383.42 examples/s]
Map:  58%|█████▊    | 3772/6548 [00:12<00:07, 363.99 examples/s]
Map:  58%|█████▊    | 3811/6548 [00:12<00:07, 362.11 examples/s]
Map:  59%|█████▉    | 3849/6548 [00:12<00:08, 317.06 examples/s]
Map:  59%|█████▉    | 3887/6548 [00:12<00:08, 326.79 examples/s]
Map:  60%|██████    | 3929/6548 [00:12<00:07, 329.25 examples/s]
Map:  61%|██████    | 3973/6548 [00:12<00:07, 345.05 examples/s]
Map:  62%|██████▏   | 4029/6548 [00:13<00:09, 256.44 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 299.24 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 323.23 examples/s]
Map:  64%|██████▎   | 4167/6548 [00:13<00:07, 314.74 examples/s]
Map:  64%|██████▍   | 4203/6548 [00:13<00:07, 317.40 examples/s]
Map:  65%|██████▌   | 4266/6548 [00:13<00:06, 345.79 examples/s]
Map:  66%|██████▌   | 4323/6548 [00:14<00:06, 355.53 examples/s]
Map:  67%|██████▋   | 4376/6548 [00:14<00:06, 352.31 examples/s]
Map:  67%|██████▋   | 4413/6548 [00:14<00:06, 353.64 examples/s]
Map:  68%|██████▊   | 4457/6548 [00:14<00:05, 373.33 examples/s]
Map:  69%|██████▊   | 4497/6548 [00:14<00:06, 331.41 examples/s]
Map:  69%|██████▉   | 4537/6548 [00:14<00:06, 307.68 examples/s]
Map:  70%|██████▉   | 4570/6548 [00:14<00:06, 308.19 examples/s]
Map:  70%|███████   | 4610/6548 [00:14<00:06, 316.92 examples/s]
Map:  71%|███████   | 4658/6548 [00:15<00:05, 356.67 examples/s]
Map:  72%|███████▏  | 4714/6548 [00:15<00:05, 359.18 examples/s]
Map:  73%|███████▎  | 4752/6548 [00:15<00:04, 362.19 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 410.95 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 398.64 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 369.06 examples/s]
Map:  76%|███████▌  | 4958/6548 [00:15<00:03, 409.53 examples/s]
Map:  77%|███████▋  | 5012/6548 [00:16<00:06, 248.47 examples/s]
Map:  77%|███████▋  | 5052/6548 [00:16<00:05, 271.89 examples/s]
Map:  78%|███████▊  | 5101/6548 [00:16<00:05, 278.51 examples/s]
Map:  79%|███████▊  | 5155/6548 [00:16<00:04, 286.13 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 286.06 examples/s]
Map:  80%|███████▉  | 5220/6548 [00:16<00:04, 292.64 examples/s]
Map:  80%|████████  | 5256/6548 [00:16<00:04, 294.76 examples/s]
Map:  81%|████████  | 5312/6548 [00:17<00:03, 357.80 examples/s]
Map:  82%|████████▏ | 5357/6548 [00:17<00:03, 298.19 examples/s]
Map:  82%|████████▏ | 5392/6548 [00:17<00:03, 289.85 examples/s]
Map:  83%|████████▎ | 5444/6548 [00:17<00:03, 302.67 examples/s]
Map:  84%|████████▍ | 5485/6548 [00:17<00:03, 324.15 examples/s]
Map:  85%|████████▍ | 5544/6548 [00:17<00:03, 332.73 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:18<00:03, 306.88 examples/s]
Map:  86%|████████▌ | 5639/6548 [00:18<00:02, 355.83 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 320.82 examples/s]
Map:  87%|████████▋ | 5722/6548 [00:18<00:02, 334.13 examples/s]
Map:  88%|████████▊ | 5765/6548 [00:18<00:02, 355.46 examples/s]
Map:  89%|████████▉ | 5825/6548 [00:18<00:02, 352.23 examples/s]
Map:  90%|████████▉ | 5866/6548 [00:18<00:01, 360.03 examples/s]
Map:  90%|█████████ | 5908/6548 [00:18<00:01, 372.56 examples/s]
Map:  91%|█████████ | 5961/6548 [00:19<00:01, 362.59 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 228.88 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:01, 258.62 examples/s]
Map:  93%|█████████▎| 6075/6548 [00:19<00:01, 273.80 examples/s]
Map:  93%|█████████▎| 6117/6548 [00:19<00:01, 263.06 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:19<00:01, 279.10 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:20<00:01, 296.21 examples/s]
Map:  96%|█████████▌| 6261/6548 [00:20<00:00, 308.09 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 324.83 examples/s]
Map:  97%|█████████▋| 6340/6548 [00:20<00:00, 334.95 examples/s]
Map:  98%|█████████▊| 6386/6548 [00:20<00:00, 355.13 examples/s]
Map:  98%|█████████▊| 6426/6548 [00:20<00:00, 364.92 examples/s]
Map:  99%|█████████▉| 6475/6548 [00:20<00:00, 397.06 examples/s]
Map: 100%|█████████▉| 6537/6548 [00:20<00:00, 392.68 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 311.37 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 326.52 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 320.74 examples/s]
Map:  13%|█▎        | 118/903 [00:00<00:02, 317.18 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 332.80 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 389.16 examples/s]
Map:  29%|██▉       | 263/903 [00:00<00:01, 370.21 examples/s]
Map:  34%|███▍      | 308/903 [00:00<00:01, 387.87 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 335.14 examples/s]
Map:  44%|████▎     | 393/903 [00:01<00:01, 295.43 examples/s]
Map:  48%|████▊     | 434/903 [00:01<00:01, 320.49 examples/s]
Map:  53%|█████▎    | 475/903 [00:01<00:01, 301.46 examples/s]
Map:  59%|█████▊    | 529/903 [00:01<00:01, 318.07 examples/s]
Map:  63%|██████▎   | 566/903 [00:01<00:01, 317.68 examples/s]
Map:  68%|██████▊   | 613/903 [00:01<00:00, 351.07 examples/s]
Map:  72%|███████▏  | 650/903 [00:01<00:00, 350.76 examples/s]
Map:  77%|███████▋  | 696/903 [00:02<00:00, 368.80 examples/s]
Map:  82%|████████▏ | 742/903 [00:02<00:00, 390.74 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 386.51 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 388.37 examples/s]
Map:  97%|█████████▋| 872/903 [00:02<00:00, 406.00 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 322.70 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 294.54 examples/s]
Map:   4%|▍         | 81/1882 [00:00<00:04, 360.50 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 348.56 examples/s]
Map:   9%|▊         | 161/1882 [00:00<00:04, 369.30 examples/s]
Map:  11%|█▏        | 213/1882 [00:00<00:04, 356.13 examples/s]
Map:  14%|█▍        | 261/1882 [00:00<00:04, 383.95 examples/s]
Map:  17%|█▋        | 315/1882 [00:00<00:04, 369.51 examples/s]
Map:  19%|█▉        | 365/1882 [00:01<00:04, 345.77 examples/s]
Map:  21%|██▏       | 401/1882 [00:01<00:04, 309.37 examples/s]
Map:  23%|██▎       | 439/1882 [00:01<00:04, 322.02 examples/s]
Map:  25%|██▌       | 474/1882 [00:01<00:04, 328.21 examples/s]
Map:  27%|██▋       | 509/1882 [00:01<00:04, 309.36 examples/s]
Map:  29%|██▉       | 552/1882 [00:01<00:03, 338.88 examples/s]
Map:  32%|███▏      | 602/1882 [00:01<00:03, 374.21 examples/s]
Map:  35%|███▍      | 650/1882 [00:01<00:03, 402.32 examples/s]
Map:  37%|███▋      | 704/1882 [00:02<00:03, 365.69 examples/s]
Map:  40%|███▉      | 744/1882 [00:02<00:03, 373.16 examples/s]
Map:  42%|████▏     | 786/1882 [00:02<00:03, 327.55 examples/s]
Map:  45%|████▍     | 840/1882 [00:02<00:03, 334.88 examples/s]
Map:  47%|████▋     | 878/1882 [00:02<00:02, 342.54 examples/s]
Map:  49%|████▉     | 919/1882 [00:02<00:02, 357.63 examples/s]
Map:  51%|█████▏    | 966/1882 [00:02<00:02, 385.45 examples/s]
Map:  54%|█████▍    | 1015/1882 [00:03<00:03, 232.80 examples/s]
Map:  56%|█████▌    | 1053/1882 [00:03<00:03, 254.81 examples/s]
Map:  58%|█████▊    | 1091/1882 [00:03<00:02, 274.40 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 284.64 examples/s]
Map:  63%|██████▎   | 1177/1882 [00:03<00:02, 276.38 examples/s]
Map:  64%|██████▍   | 1211/1882 [00:03<00:02, 257.17 examples/s]
Map:  66%|██████▌   | 1246/1882 [00:03<00:02, 276.37 examples/s]
Map:  68%|██████▊   | 1277/1882 [00:04<00:02, 282.80 examples/s]
Map:  70%|███████   | 1318/1882 [00:04<00:01, 314.27 examples/s]
Map:  72%|███████▏  | 1360/1882 [00:04<00:01, 325.71 examples/s]
Map:  75%|███████▍  | 1405/1882 [00:04<00:01, 313.01 examples/s]
Map:  77%|███████▋  | 1457/1882 [00:04<00:01, 288.93 examples/s]
Map:  79%|███████▉  | 1490/1882 [00:04<00:01, 262.32 examples/s]
Map:  81%|████████  | 1525/1882 [00:04<00:01, 248.47 examples/s]
Map:  83%|████████▎ | 1559/1882 [00:05<00:01, 266.38 examples/s]
Map:  85%|████████▌ | 1607/1882 [00:05<00:00, 314.06 examples/s]
Map:  88%|████████▊ | 1662/1882 [00:05<00:00, 321.70 examples/s]
Map:  91%|█████████ | 1705/1882 [00:05<00:00, 309.20 examples/s]
Map:  93%|█████████▎| 1749/1882 [00:05<00:00, 273.21 examples/s]
Map:  95%|█████████▍| 1780/1882 [00:05<00:00, 277.07 examples/s]
Map:  97%|█████████▋| 1821/1882 [00:05<00:00, 306.19 examples/s]
Map:  99%|█████████▉| 1861/1882 [00:05<00:00, 327.80 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 303.77 examples/s]
10/12/2024 09:24:27 - INFO - __main__ -     ***** Testing *****
10/12/2024 09:24:27 - INFO - __main__ -     Batch size = 8
10/12/2024 09:24:27 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 09:24:28 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 09:24:28 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 09:24:29 - INFO - knnlm -   Reading datastore took 0.9616532325744629 s
10/12/2024 09:24:30 - INFO - knnlm -   Moving index to GPU took 0.9859979152679443 s
10/12/2024 09:24:30 - INFO - __main__ -   ******************************break-into
10/12/2024 09:24:30 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 09:24:30 - INFO - __main__ -     Num examples = 236
10/12/2024 09:24:30 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:35,  7.55s/it]
test ppl:   1%|          | 2/236 [00:09<16:31,  4.24s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:33,  2.98s/it]
test ppl:   2%|▏         | 4/236 [00:12<09:26,  2.44s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:01,  3.64s/it]
test ppl:   3%|▎         | 6/236 [00:20<12:11,  3.18s/it]
test ppl:   3%|▎         | 7/236 [00:23<11:18,  2.96s/it]
test ppl:   3%|▎         | 8/236 [00:27<12:47,  3.37s/it]
test ppl:   4%|▍         | 9/236 [00:33<15:35,  4.12s/it]
test ppl:   4%|▍         | 10/236 [00:36<14:25,  3.83s/it]
test ppl:   5%|▍         | 11/236 [00:38<12:38,  3.37s/it]
test ppl:   5%|▌         | 12/236 [00:44<15:20,  4.11s/it]
test ppl:   6%|▌         | 13/236 [00:50<17:10,  4.62s/it]
test ppl:   6%|▌         | 14/236 [00:56<18:28,  4.99s/it]
test ppl:   6%|▋         | 15/236 [00:58<15:02,  4.08s/it]
test ppl:   7%|▋         | 16/236 [00:59<12:29,  3.41s/it]
test ppl:   7%|▋         | 17/236 [01:03<12:35,  3.45s/it]
test ppl:   8%|▊         | 18/236 [01:05<10:35,  2.92s/it]
test ppl:   8%|▊         | 19/236 [01:09<12:07,  3.35s/it]
test ppl:   8%|▊         | 20/236 [01:11<10:20,  2.87s/it]
test ppl:   9%|▉         | 21/236 [01:13<09:37,  2.68s/it]
test ppl:   9%|▉         | 22/236 [01:19<12:55,  3.62s/it]
test ppl:  10%|▉         | 23/236 [01:21<11:39,  3.28s/it]
test ppl:  10%|█         | 24/236 [01:24<10:36,  3.00s/it]
test ppl:  11%|█         | 25/236 [01:25<09:18,  2.65s/it]
test ppl:  11%|█         | 26/236 [01:31<12:34,  3.59s/it]
test ppl:  11%|█▏        | 27/236 [01:35<13:03,  3.75s/it]
test ppl:  12%|█▏        | 28/236 [01:37<10:19,  2.98s/it]
test ppl:  12%|█▏        | 29/236 [01:39<09:34,  2.78s/it]
test ppl:  13%|█▎        | 30/236 [01:40<08:13,  2.40s/it]
test ppl:  13%|█▎        | 31/236 [01:42<07:44,  2.27s/it]
test ppl:  14%|█▎        | 32/236 [01:45<08:16,  2.44s/it]
test ppl:  14%|█▍        | 33/236 [01:51<11:40,  3.45s/it]
test ppl:  14%|█▍        | 34/236 [01:55<12:08,  3.60s/it]
test ppl:  15%|█▍        | 35/236 [01:57<10:57,  3.27s/it]
test ppl:  15%|█▌        | 36/236 [02:03<13:25,  4.03s/it]
test ppl:  16%|█▌        | 37/236 [02:09<15:07,  4.56s/it]
test ppl:  16%|█▌        | 38/236 [02:11<12:33,  3.81s/it]
test ppl:  17%|█▋        | 39/236 [02:13<10:13,  3.11s/it]
test ppl:  17%|█▋        | 40/236 [02:15<09:43,  2.98s/it]
test ppl:  17%|█▋        | 41/236 [02:17<08:34,  2.64s/it]
test ppl:  18%|█▊        | 42/236 [02:23<11:38,  3.60s/it]
test ppl:  18%|█▊        | 43/236 [02:29<13:41,  4.26s/it]
test ppl:  19%|█▊        | 44/236 [02:31<11:44,  3.67s/it]
test ppl:  19%|█▉        | 45/236 [02:33<10:01,  3.15s/it]
test ppl:  19%|█▉        | 46/236 [02:37<10:23,  3.28s/it]
test ppl:  20%|█▉        | 47/236 [02:42<12:46,  4.06s/it]
test ppl:  20%|██        | 48/236 [02:48<14:20,  4.58s/it]
test ppl:  21%|██        | 49/236 [02:52<13:30,  4.34s/it]
test ppl:  21%|██        | 50/236 [02:58<14:52,  4.80s/it]
test ppl:  22%|██▏       | 51/236 [03:02<14:24,  4.67s/it]
test ppl:  22%|██▏       | 52/236 [03:08<15:21,  5.01s/it]
test ppl:  22%|██▏       | 53/236 [03:12<13:53,  4.56s/it]
test ppl:  23%|██▎       | 54/236 [03:13<11:03,  3.65s/it]
test ppl:  23%|██▎       | 55/236 [03:19<12:44,  4.22s/it]
test ppl:  24%|██▎       | 56/236 [03:22<11:54,  3.97s/it]
test ppl:  24%|██▍       | 57/236 [03:25<10:33,  3.54s/it]
test ppl:  25%|██▍       | 58/236 [03:26<08:42,  2.94s/it]
test ppl:  25%|██▌       | 59/236 [03:31<10:30,  3.56s/it]
test ppl:  25%|██▌       | 60/236 [03:33<09:24,  3.21s/it]
test ppl:  26%|██▌       | 61/236 [03:39<11:37,  3.99s/it]
test ppl:  26%|██▋       | 62/236 [03:43<11:38,  4.01s/it]
test ppl:  27%|██▋       | 63/236 [03:46<10:12,  3.54s/it]
test ppl:  27%|██▋       | 64/236 [03:47<08:23,  2.93s/it]
test ppl:  28%|██▊       | 65/236 [03:49<06:57,  2.44s/it]
test ppl:  28%|██▊       | 66/236 [03:52<07:21,  2.59s/it]
test ppl:  28%|██▊       | 67/236 [03:54<07:29,  2.66s/it]
test ppl:  29%|██▉       | 68/236 [04:00<10:05,  3.60s/it]
test ppl:  29%|██▉       | 69/236 [04:05<10:47,  3.88s/it]
test ppl:  30%|██▉       | 70/236 [04:06<08:49,  3.19s/it]
test ppl:  30%|███       | 71/236 [04:10<09:03,  3.29s/it]
test ppl:  31%|███       | 72/236 [04:14<09:23,  3.44s/it]
test ppl:  31%|███       | 73/236 [04:17<09:38,  3.55s/it]
test ppl:  31%|███▏      | 74/236 [04:19<07:55,  2.93s/it]
test ppl:  32%|███▏      | 75/236 [04:25<10:10,  3.79s/it]
test ppl:  32%|███▏      | 76/236 [04:30<10:55,  4.10s/it]
test ppl:  33%|███▎      | 77/236 [04:32<09:23,  3.54s/it]
test ppl:  33%|███▎      | 78/236 [04:33<07:47,  2.96s/it]
test ppl:  33%|███▎      | 79/236 [04:38<09:18,  3.56s/it]
test ppl:  34%|███▍      | 80/236 [04:40<07:53,  3.04s/it]
test ppl:  34%|███▍      | 81/236 [04:46<09:58,  3.86s/it]
test ppl:  35%|███▍      | 82/236 [04:52<11:25,  4.45s/it]
test ppl:  35%|███▌      | 83/236 [04:54<09:27,  3.71s/it]
test ppl:  36%|███▌      | 84/236 [04:56<07:59,  3.15s/it]
test ppl:  36%|███▌      | 85/236 [05:00<08:36,  3.42s/it]
test ppl:  36%|███▋      | 86/236 [05:02<07:36,  3.04s/it]
test ppl:  37%|███▋      | 87/236 [05:04<06:49,  2.75s/it]
test ppl:  37%|███▋      | 88/236 [05:10<09:00,  3.65s/it]
test ppl:  38%|███▊      | 89/236 [05:12<07:41,  3.14s/it]
test ppl:  38%|███▊      | 90/236 [05:17<09:34,  3.94s/it]
test ppl:  39%|███▊      | 91/236 [05:23<10:49,  4.48s/it]
test ppl:  39%|███▉      | 92/236 [05:26<09:31,  3.97s/it]
test ppl:  39%|███▉      | 93/236 [05:32<10:44,  4.51s/it]
test ppl:  40%|███▉      | 94/236 [05:37<11:34,  4.89s/it]
test ppl:  40%|████      | 95/236 [05:40<09:34,  4.08s/it]
test ppl:  41%|████      | 96/236 [05:43<08:41,  3.73s/it]
test ppl:  41%|████      | 97/236 [05:48<10:03,  4.34s/it]
test ppl:  42%|████▏     | 98/236 [05:54<10:59,  4.78s/it]
test ppl:  42%|████▏     | 99/236 [06:00<11:35,  5.08s/it]
test ppl:  42%|████▏     | 100/236 [06:01<08:56,  3.95s/it]
test ppl:  43%|████▎     | 101/236 [06:07<09:56,  4.42s/it]
test ppl:  43%|████▎     | 102/236 [06:10<09:13,  4.13s/it]
test ppl:  44%|████▎     | 103/236 [06:12<07:46,  3.51s/it]
test ppl:  44%|████▍     | 104/236 [06:16<08:10,  3.72s/it]
test ppl:  44%|████▍     | 105/236 [06:20<08:12,  3.76s/it]
test ppl:  45%|████▍     | 106/236 [06:26<09:09,  4.23s/it]
test ppl:  45%|████▌     | 107/236 [06:28<07:40,  3.57s/it]
test ppl:  46%|████▌     | 108/236 [06:33<08:55,  4.19s/it]
test ppl:  46%|████▌     | 109/236 [06:38<09:07,  4.31s/it]
test ppl:  47%|████▋     | 110/236 [06:39<07:19,  3.49s/it]
test ppl:  47%|████▋     | 111/236 [06:43<07:30,  3.60s/it]
test ppl:  47%|████▋     | 112/236 [06:47<07:47,  3.77s/it]
test ppl:  48%|████▊     | 113/236 [06:49<06:28,  3.16s/it]
test ppl:  48%|████▊     | 114/236 [06:52<06:29,  3.20s/it]
test ppl:  49%|████▊     | 115/236 [06:58<07:59,  3.97s/it]
test ppl:  49%|████▉     | 116/236 [07:04<08:49,  4.41s/it]
test ppl:  50%|████▉     | 117/236 [07:06<07:12,  3.64s/it]
test ppl:  50%|█████     | 118/236 [07:10<07:33,  3.84s/it]
test ppl:  50%|█████     | 119/236 [07:13<07:08,  3.67s/it]
test ppl:  51%|█████     | 120/236 [07:15<05:50,  3.02s/it]
test ppl:  51%|█████▏    | 121/236 [07:20<07:22,  3.84s/it]
test ppl:  52%|█████▏    | 122/236 [07:25<07:48,  4.11s/it]
test ppl:  52%|█████▏    | 123/236 [07:27<06:36,  3.51s/it]
test ppl:  53%|█████▎    | 124/236 [07:30<06:06,  3.27s/it]
test ppl:  53%|█████▎    | 125/236 [07:32<05:36,  3.03s/it]
test ppl:  53%|█████▎    | 126/236 [07:37<06:35,  3.59s/it]
test ppl:  54%|█████▍    | 127/236 [07:39<05:34,  3.07s/it]
test ppl:  54%|█████▍    | 128/236 [07:41<05:03,  2.81s/it]
test ppl:  55%|█████▍    | 129/236 [07:44<05:04,  2.85s/it]
test ppl:  55%|█████▌    | 130/236 [07:47<05:06,  2.89s/it]
test ppl:  56%|█████▌    | 131/236 [07:53<06:35,  3.77s/it]
test ppl:  56%|█████▌    | 132/236 [07:56<05:50,  3.37s/it]
test ppl:  56%|█████▋    | 133/236 [07:59<06:02,  3.52s/it]
test ppl:  57%|█████▋    | 134/236 [08:03<06:08,  3.61s/it]
test ppl:  57%|█████▋    | 135/236 [08:09<07:09,  4.26s/it]
test ppl:  58%|█████▊    | 136/236 [08:10<05:33,  3.34s/it]
test ppl:  58%|█████▊    | 137/236 [08:16<06:43,  4.08s/it]
test ppl:  58%|█████▊    | 138/236 [08:19<06:21,  3.89s/it]
test ppl:  59%|█████▉    | 139/236 [08:22<05:38,  3.48s/it]
test ppl:  59%|█████▉    | 140/236 [08:24<04:43,  2.95s/it]
test ppl:  60%|█████▉    | 141/236 [08:27<04:37,  2.92s/it]
test ppl:  60%|██████    | 142/236 [08:29<04:15,  2.72s/it]
test ppl:  61%|██████    | 143/236 [08:35<05:38,  3.64s/it]
test ppl:  61%|██████    | 144/236 [08:37<05:08,  3.36s/it]
test ppl:  61%|██████▏   | 145/236 [08:43<06:01,  3.97s/it]
test ppl:  62%|██████▏   | 146/236 [08:47<06:09,  4.11s/it]
test ppl:  62%|██████▏   | 147/236 [08:53<06:50,  4.62s/it]
test ppl:  63%|██████▎   | 148/236 [08:59<07:20,  5.00s/it]
test ppl:  63%|██████▎   | 149/236 [09:02<06:30,  4.49s/it]
test ppl:  64%|██████▎   | 150/236 [09:05<05:46,  4.03s/it]
test ppl:  64%|██████▍   | 151/236 [09:11<06:27,  4.55s/it]
test ppl:  64%|██████▍   | 152/236 [09:17<06:52,  4.92s/it]
test ppl:  65%|██████▍   | 153/236 [09:22<07:09,  5.17s/it]
test ppl:  65%|██████▌   | 154/236 [09:25<05:58,  4.37s/it]
test ppl:  66%|██████▌   | 155/236 [09:28<05:12,  3.85s/it]
test ppl:  66%|██████▌   | 156/236 [09:30<04:27,  3.34s/it]
test ppl:  67%|██████▋   | 157/236 [09:32<03:56,  2.99s/it]
test ppl:  67%|██████▋   | 158/236 [09:38<04:58,  3.83s/it]
test ppl:  67%|██████▋   | 159/236 [09:39<03:52,  3.02s/it]
test ppl:  68%|██████▊   | 160/236 [09:40<03:06,  2.45s/it]
test ppl:  68%|██████▊   | 161/236 [09:41<02:39,  2.12s/it]
test ppl:  69%|██████▊   | 162/236 [09:44<02:52,  2.33s/it]
test ppl:  69%|██████▉   | 163/236 [09:47<02:53,  2.38s/it]
test ppl:  69%|██████▉   | 164/236 [09:52<04:05,  3.41s/it]
test ppl:  70%|██████▉   | 165/236 [09:57<04:19,  3.65s/it]
test ppl:  70%|███████   | 166/236 [09:58<03:29,  3.00s/it]
test ppl:  71%|███████   | 167/236 [09:59<02:54,  2.53s/it]
test ppl:  71%|███████   | 168/236 [10:04<03:26,  3.03s/it]
test ppl:  72%|███████▏  | 169/236 [10:09<03:59,  3.58s/it]
test ppl:  72%|███████▏  | 170/236 [10:14<04:40,  4.25s/it]
test ppl:  72%|███████▏  | 171/236 [10:16<03:39,  3.37s/it]
test ppl:  73%|███████▎  | 172/236 [10:21<04:22,  4.10s/it]
test ppl:  73%|███████▎  | 173/236 [10:25<04:08,  3.95s/it]
test ppl:  74%|███████▎  | 174/236 [10:29<04:08,  4.01s/it]
test ppl:  74%|███████▍  | 175/236 [10:31<03:24,  3.35s/it]
test ppl:  75%|███████▍  | 176/236 [10:36<03:46,  3.77s/it]
test ppl:  75%|███████▌  | 177/236 [10:42<04:18,  4.38s/it]
test ppl:  75%|███████▌  | 178/236 [10:47<04:39,  4.81s/it]
test ppl:  76%|███████▌  | 179/236 [10:53<04:51,  5.11s/it]
test ppl:  76%|███████▋  | 180/236 [10:57<04:17,  4.59s/it]
test ppl:  77%|███████▋  | 181/236 [11:02<04:31,  4.94s/it]
test ppl:  77%|███████▋  | 182/236 [11:04<03:37,  4.02s/it]
test ppl:  78%|███████▊  | 183/236 [11:06<03:04,  3.48s/it]
test ppl:  78%|███████▊  | 184/236 [11:08<02:29,  2.87s/it]
test ppl:  78%|███████▊  | 185/236 [11:14<03:11,  3.76s/it]
test ppl:  79%|███████▉  | 186/236 [11:19<03:38,  4.36s/it]
test ppl:  79%|███████▉  | 187/236 [11:25<03:56,  4.82s/it]
test ppl:  80%|███████▉  | 188/236 [11:31<04:05,  5.12s/it]
test ppl:  80%|████████  | 189/236 [11:37<04:10,  5.32s/it]
test ppl:  81%|████████  | 190/236 [11:41<03:41,  4.81s/it]
test ppl:  81%|████████  | 191/236 [11:45<03:29,  4.65s/it]
test ppl:  81%|████████▏ | 192/236 [11:47<02:57,  4.04s/it]
test ppl:  82%|████████▏ | 193/236 [11:53<03:16,  4.57s/it]
test ppl:  82%|████████▏ | 194/236 [11:56<02:46,  3.98s/it]
test ppl:  83%|████████▎ | 195/236 [11:59<02:31,  3.69s/it]
test ppl:  83%|████████▎ | 196/236 [12:01<02:06,  3.17s/it]
test ppl:  83%|████████▎ | 197/236 [12:03<01:51,  2.85s/it]
test ppl:  84%|████████▍ | 198/236 [12:09<02:21,  3.73s/it]
test ppl:  84%|████████▍ | 199/236 [12:11<02:06,  3.41s/it]
test ppl:  85%|████████▍ | 200/236 [12:17<02:28,  4.12s/it]
test ppl:  85%|████████▌ | 201/236 [12:19<02:01,  3.48s/it]
test ppl:  86%|████████▌ | 202/236 [12:24<02:09,  3.80s/it]
test ppl:  86%|████████▌ | 203/236 [12:29<02:24,  4.39s/it]
test ppl:  86%|████████▋ | 204/236 [12:31<01:57,  3.67s/it]
test ppl:  87%|████████▋ | 205/236 [12:37<02:13,  4.32s/it]
test ppl:  87%|████████▋ | 206/236 [12:41<01:59,  4.00s/it]
test ppl:  88%|████████▊ | 207/236 [12:46<02:09,  4.47s/it]
test ppl:  88%|████████▊ | 208/236 [12:49<01:53,  4.06s/it]
test ppl:  89%|████████▊ | 209/236 [12:55<02:04,  4.60s/it]
test ppl:  89%|████████▉ | 210/236 [12:57<01:41,  3.91s/it]
test ppl:  89%|████████▉ | 211/236 [13:02<01:41,  4.05s/it]
test ppl:  90%|████████▉ | 212/236 [13:07<01:44,  4.36s/it]
test ppl:  90%|█████████ | 213/236 [13:13<01:49,  4.78s/it]
test ppl:  91%|█████████ | 214/236 [13:14<01:24,  3.83s/it]
test ppl:  91%|█████████ | 215/236 [13:20<01:32,  4.42s/it]
test ppl:  92%|█████████▏| 216/236 [13:22<01:11,  3.59s/it]
test ppl:  92%|█████████▏| 217/236 [13:28<01:21,  4.28s/it]
test ppl:  92%|█████████▏| 218/236 [13:30<01:05,  3.65s/it]
test ppl:  93%|█████████▎| 219/236 [13:36<01:13,  4.30s/it]
test ppl:  93%|█████████▎| 220/236 [13:41<01:15,  4.75s/it]
test ppl:  94%|█████████▎| 221/236 [13:45<01:07,  4.49s/it]
test ppl:  94%|█████████▍| 222/236 [13:51<01:08,  4.89s/it]
test ppl:  94%|█████████▍| 223/236 [13:57<01:07,  5.16s/it]
test ppl:  95%|█████████▍| 224/236 [13:59<00:49,  4.14s/it]
test ppl:  95%|█████████▌| 225/236 [14:04<00:50,  4.63s/it]
test ppl:  96%|█████████▌| 226/236 [14:08<00:42,  4.29s/it]
test ppl:  96%|█████████▌| 227/236 [14:11<00:34,  3.85s/it]
test ppl:  97%|█████████▋| 228/236 [14:13<00:25,  3.25s/it]
test ppl:  97%|█████████▋| 229/236 [14:18<00:28,  4.00s/it]
test ppl:  97%|█████████▋| 230/236 [14:22<00:23,  3.84s/it]
test ppl:  98%|█████████▊| 231/236 [14:25<00:18,  3.68s/it]
test ppl:  98%|█████████▊| 232/236 [14:27<00:12,  3.09s/it]
test ppl:  99%|█████████▊| 233/236 [14:29<00:08,  2.80s/it]
test ppl:  99%|█████████▉| 234/236 [14:30<00:04,  2.42s/it]
test ppl: 100%|█████████▉| 235/236 [14:36<00:03,  3.43s/it]
test ppl: 100%|██████████| 236/236 [14:37<00:00,  2.60s/it]
test ppl: 100%|██████████| 236/236 [14:37<00:00,  3.72s/it]
10/12/2024 09:39:07 - INFO - __main__ -    em: 0.2109
10/12/2024 09:39:07 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.2 20:  em: 0.2109

--------------------------------------------------------------------------------
Running experiment with knn_temp=20, lmbda=0.2, k=32
2024-10-12 09:39:14.713203: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 09:39:14.732903: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 09:39:14.754861: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 09:39:14.761526: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 09:39:14.777615: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 09:39:15.767495: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 09:39:17 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.2, knn_temp=20, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 09:39:17 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:41:27,  2.19it/s]
Adding feature api:   4%|▍         | 7379/187062 [00:00<00:10, 17603.38it/s]
Adding feature api:   8%|▊         | 15630/187062 [00:00<00:05, 34101.29it/s]
Adding feature api:  13%|█▎        | 24095/187062 [00:00<00:03, 47566.35it/s]
Adding feature api:  17%|█▋        | 32709/187062 [00:00<00:02, 58198.81it/s]
Adding feature api:  22%|██▏       | 41317/187062 [00:00<00:02, 66074.42it/s]
Adding feature api:  27%|██▋       | 49669/187062 [00:01<00:01, 71090.24it/s]
Adding feature api:  31%|███       | 58236/187062 [00:01<00:01, 75334.90it/s]
Adding feature api:  36%|███▌      | 66791/187062 [00:01<00:01, 78334.70it/s]
Adding feature api:  40%|████      | 75337/187062 [00:01<00:01, 80440.20it/s]
Adding feature api:  45%|████▍     | 83826/187062 [00:01<00:01, 81759.49it/s]
Adding feature api:  49%|████▉     | 92254/187062 [00:01<00:01, 81799.54it/s]
Adding feature api:  54%|█████▍    | 100733/187062 [00:01<00:01, 82683.51it/s]
Adding feature api:  58%|█████▊    | 109310/187062 [00:01<00:00, 83600.27it/s]
Adding feature api:  63%|██████▎   | 117842/187062 [00:01<00:00, 84110.32it/s]
Adding feature api:  68%|██████▊   | 126315/187062 [00:01<00:00, 83647.35it/s]
Adding feature api:  72%|███████▏  | 134833/187062 [00:02<00:00, 84102.72it/s]
Adding feature api:  77%|███████▋  | 143328/187062 [00:02<00:00, 84354.58it/s]
Adding feature api:  81%|████████  | 151830/187062 [00:02<00:00, 84552.71it/s]
Adding feature api:  86%|████████▌ | 160301/187062 [00:02<00:00, 84335.36it/s]
Adding feature api:  90%|█████████ | 168860/187062 [00:02<00:00, 84708.16it/s]
Adding feature api:  95%|█████████▍| 177339/187062 [00:02<00:00, 84716.35it/s]
Adding feature api:  99%|█████████▉| 185817/187062 [00:02<00:00, 54559.20it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64804.30it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:26:21,  2.22it/s]
Adding feature datatype:   4%|▍         | 7219/187062 [00:00<00:10, 17362.13it/s]
Adding feature datatype:   8%|▊         | 15417/187062 [00:00<00:05, 33885.62it/s]
Adding feature datatype:  13%|█▎        | 23598/187062 [00:00<00:03, 46707.75it/s]
Adding feature datatype:  17%|█▋        | 31851/187062 [00:00<00:02, 56611.62it/s]
Adding feature datatype:  21%|██▏       | 39769/187062 [00:00<00:02, 63001.61it/s]
Adding feature datatype:  26%|██▌       | 48004/187062 [00:01<00:02, 68572.80it/s]
Adding feature datatype:  30%|███       | 56241/187062 [00:01<00:01, 72593.96it/s]
Adding feature datatype:  35%|███▍      | 64545/187062 [00:01<00:01, 75664.43it/s]
Adding feature datatype:  39%|███▉      | 72812/187062 [00:01<00:01, 77734.92it/s]
Adding feature datatype:  43%|████▎     | 80926/187062 [00:01<00:01, 78153.53it/s]
Adding feature datatype:  48%|████▊     | 89194/187062 [00:01<00:01, 79492.59it/s]
Adding feature datatype:  52%|█████▏    | 97440/187062 [00:01<00:01, 80372.04it/s]
Adding feature datatype:  57%|█████▋    | 105734/187062 [00:01<00:01, 81134.66it/s]
Adding feature datatype:  61%|██████    | 113966/187062 [00:01<00:00, 81487.48it/s]
Adding feature datatype:  65%|██████▌   | 122235/187062 [00:01<00:00, 81846.07it/s]
Adding feature datatype:  70%|██████▉   | 130462/187062 [00:02<00:00, 80949.14it/s]
Adding feature datatype:  74%|███████▍  | 138781/187062 [00:02<00:00, 81612.74it/s]
Adding feature datatype:  79%|███████▊  | 147075/187062 [00:02<00:00, 82007.08it/s]
Adding feature datatype:  83%|████████▎ | 155352/187062 [00:02<00:00, 82232.71it/s]
Adding feature datatype:  87%|████████▋ | 163588/187062 [00:02<00:00, 82268.56it/s]
Adding feature datatype:  92%|█████████▏| 171867/187062 [00:02<00:00, 82421.85it/s]
Adding feature datatype:  96%|█████████▋| 180115/187062 [00:02<00:00, 70282.06it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63402.75it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:16:50,  2.23it/s]
Adding feature literal:   4%|▍         | 7098/187062 [00:00<00:10, 17159.02it/s]
Adding feature literal:   8%|▊         | 15219/187062 [00:00<00:05, 33600.27it/s]
Adding feature literal:  13%|█▎        | 23384/187062 [00:00<00:03, 46491.83it/s]
Adding feature literal:  17%|█▋        | 31519/187062 [00:00<00:02, 56149.84it/s]
Adding feature literal:  21%|██        | 39699/187062 [00:00<00:02, 63422.02it/s]
Adding feature literal:  26%|██▌       | 47971/187062 [00:01<00:02, 68983.60it/s]
Adding feature literal:  30%|███       | 56209/187062 [00:01<00:01, 72890.99it/s]
Adding feature literal:  34%|███▍      | 64453/187062 [00:01<00:01, 75697.31it/s]
Adding feature literal:  39%|███▉      | 72667/187062 [00:01<00:01, 77600.82it/s]
Adding feature literal:  43%|████▎     | 80903/187062 [00:01<00:01, 79013.02it/s]
Adding feature literal:  48%|████▊     | 89177/187062 [00:01<00:01, 80120.73it/s]
Adding feature literal:  52%|█████▏    | 97357/187062 [00:01<00:01, 80471.63it/s]
Adding feature literal:  56%|█████▋    | 105616/187062 [00:01<00:01, 81101.08it/s]
Adding feature literal:  61%|██████    | 113832/187062 [00:01<00:00, 81415.29it/s]
Adding feature literal:  65%|██████▌   | 122071/187062 [00:01<00:00, 81704.30it/s]
Adding feature literal:  70%|██████▉   | 130346/187062 [00:02<00:00, 82016.81it/s]
Adding feature literal:  74%|███████▍  | 138582/187062 [00:02<00:00, 82116.56it/s]
Adding feature literal:  78%|███████▊  | 146814/187062 [00:02<00:00, 82174.39it/s]
Adding feature literal:  83%|████████▎ | 155091/187062 [00:02<00:00, 82352.05it/s]
Adding feature literal:  87%|████████▋ | 163359/187062 [00:02<00:00, 82449.59it/s]
Adding feature literal:  92%|█████████▏| 171640/187062 [00:02<00:00, 82556.46it/s]
Adding feature literal:  96%|█████████▌| 179901/187062 [00:02<00:00, 71604.72it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63543.08it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:17:07,  2.23it/s]
Adding feature operator:   4%|▍         | 7179/187062 [00:00<00:10, 17352.67it/s]
Adding feature operator:   8%|▊         | 15333/187062 [00:00<00:05, 33828.11it/s]
Adding feature operator:  13%|█▎        | 23478/187062 [00:00<00:03, 46603.91it/s]
Adding feature operator:  17%|█▋        | 31693/187062 [00:00<00:02, 56452.11it/s]
Adding feature operator:  21%|██▏       | 39789/187062 [00:00<00:02, 63399.50it/s]
Adding feature operator:  26%|██▌       | 48090/187062 [00:01<00:02, 69051.78it/s]
Adding feature operator:  30%|███       | 56301/187062 [00:01<00:01, 72858.54it/s]
Adding feature operator:  35%|███▍      | 64542/187062 [00:01<00:01, 75665.98it/s]
Adding feature operator:  39%|███▉      | 72811/187062 [00:01<00:01, 77741.18it/s]
Adding feature operator:  43%|████▎     | 81059/187062 [00:01<00:01, 79148.33it/s]
Adding feature operator:  48%|████▊     | 89261/187062 [00:01<00:01, 80001.19it/s]
Adding feature operator:  52%|█████▏    | 97429/187062 [00:01<00:01, 80474.94it/s]
Adding feature operator:  56%|█████▋    | 105687/187062 [00:01<00:01, 81101.78it/s]
Adding feature operator:  61%|██████    | 113930/187062 [00:01<00:00, 81498.49it/s]
Adding feature operator:  65%|██████▌   | 122138/187062 [00:01<00:00, 81514.88it/s]
Adding feature operator:  70%|██████▉   | 130394/187062 [00:02<00:00, 81824.47it/s]
Adding feature operator:  74%|███████▍  | 138657/187062 [00:02<00:00, 82062.48it/s]
Adding feature operator:  79%|███████▊  | 146926/187062 [00:02<00:00, 82249.04it/s]
Adding feature operator:  83%|████████▎ | 155165/187062 [00:02<00:00, 82246.12it/s]
Adding feature operator:  87%|████████▋ | 163437/187062 [00:02<00:00, 82385.69it/s]
Adding feature operator:  92%|█████████▏| 171683/187062 [00:02<00:00, 82345.72it/s]
Adding feature operator:  96%|█████████▌| 179923/187062 [00:02<00:00, 71457.11it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63578.12it/s]
[2024-10-12 09:40:00,736] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 09:40:02 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 09:40:02 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 42/6548 [00:00<00:16, 404.09 examples/s]
Map:   1%|▏         | 90/6548 [00:00<00:30, 214.27 examples/s]
Map:   2%|▏         | 119/6548 [00:00<00:27, 233.67 examples/s]
Map:   2%|▏         | 160/6548 [00:00<00:22, 278.99 examples/s]
Map:   3%|▎         | 219/6548 [00:00<00:19, 319.28 examples/s]
Map:   4%|▍         | 268/6548 [00:00<00:19, 319.20 examples/s]
Map:   5%|▍         | 303/6548 [00:01<00:19, 319.94 examples/s]
Map:   5%|▌         | 346/6548 [00:01<00:20, 299.21 examples/s]
Map:   6%|▌         | 388/6548 [00:01<00:18, 326.80 examples/s]
Map:   7%|▋         | 433/6548 [00:01<00:17, 356.53 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 327.83 examples/s]
Map:   8%|▊         | 527/6548 [00:01<00:17, 338.09 examples/s]
Map:   9%|▉         | 575/6548 [00:01<00:16, 361.92 examples/s]
Map:   9%|▉         | 622/6548 [00:01<00:18, 328.56 examples/s]
Map:  10%|█         | 658/6548 [00:02<00:17, 328.80 examples/s]
Map:  11%|█         | 704/6548 [00:02<00:16, 360.15 examples/s]
Map:  11%|█▏        | 742/6548 [00:02<00:15, 363.50 examples/s]
Map:  12%|█▏        | 796/6548 [00:02<00:14, 405.21 examples/s]
Map:  13%|█▎        | 838/6548 [00:02<00:14, 404.65 examples/s]
Map:  13%|█▎        | 882/6548 [00:02<00:13, 410.84 examples/s]
Map:  14%|█▍        | 931/6548 [00:02<00:14, 375.88 examples/s]
Map:  15%|█▍        | 970/6548 [00:02<00:15, 365.94 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:24, 225.74 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 253.31 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:18, 289.18 examples/s]
Map:  17%|█▋        | 1145/6548 [00:03<00:16, 326.22 examples/s]
Map:  18%|█▊        | 1184/6548 [00:03<00:15, 339.79 examples/s]
Map:  19%|█▉        | 1240/6548 [00:03<00:15, 344.21 examples/s]
Map:  20%|█▉        | 1287/6548 [00:03<00:14, 372.55 examples/s]
Map:  20%|██        | 1334/6548 [00:04<00:15, 326.92 examples/s]
Map:  21%|██        | 1381/6548 [00:04<00:16, 311.61 examples/s]
Map:  22%|██▏       | 1420/6548 [00:04<00:15, 326.34 examples/s]
Map:  22%|██▏       | 1460/6548 [00:04<00:16, 305.22 examples/s]
Map:  23%|██▎       | 1498/6548 [00:04<00:17, 287.45 examples/s]
Map:  23%|██▎       | 1533/6548 [00:04<00:17, 293.87 examples/s]
Map:  24%|██▍       | 1576/6548 [00:04<00:17, 286.96 examples/s]
Map:  25%|██▍       | 1614/6548 [00:05<00:18, 263.24 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:18, 263.31 examples/s]
Map:  26%|██▌       | 1688/6548 [00:05<00:18, 266.70 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:16, 293.14 examples/s]
Map:  27%|██▋       | 1770/6548 [00:05<00:14, 325.38 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 335.70 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 346.11 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 339.08 examples/s]
Map:  30%|██▉       | 1961/6548 [00:06<00:13, 344.75 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:19, 235.16 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:18, 245.37 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:16, 274.50 examples/s]
Map:  32%|███▏      | 2106/6548 [00:06<00:15, 286.60 examples/s]
Map:  33%|███▎      | 2139/6548 [00:06<00:17, 254.36 examples/s]
Map:  33%|███▎      | 2172/6548 [00:07<00:16, 268.23 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 280.57 examples/s]
Map:  34%|███▍      | 2243/6548 [00:07<00:17, 245.74 examples/s]
Map:  35%|███▍      | 2273/6548 [00:07<00:16, 257.81 examples/s]
Map:  35%|███▌      | 2312/6548 [00:07<00:14, 288.19 examples/s]
Map:  36%|███▌      | 2355/6548 [00:07<00:13, 299.77 examples/s]
Map:  37%|███▋      | 2397/6548 [00:07<00:12, 328.72 examples/s]
Map:  37%|███▋      | 2438/6548 [00:07<00:12, 320.28 examples/s]
Map:  38%|███▊      | 2477/6548 [00:08<00:12, 327.06 examples/s]
Map:  38%|███▊      | 2517/6548 [00:08<00:11, 340.02 examples/s]
Map:  39%|███▉      | 2562/6548 [00:08<00:11, 361.93 examples/s]
Map:  40%|███▉      | 2607/6548 [00:08<00:10, 383.50 examples/s]
Map:  40%|████      | 2651/6548 [00:08<00:09, 396.97 examples/s]
Map:  41%|████▏     | 2710/6548 [00:08<00:10, 349.00 examples/s]
Map:  42%|████▏     | 2767/6548 [00:08<00:10, 355.96 examples/s]
Map:  43%|████▎     | 2807/6548 [00:08<00:11, 324.36 examples/s]
Map:  43%|████▎     | 2844/6548 [00:09<00:13, 267.85 examples/s]
Map:  44%|████▍     | 2880/6548 [00:09<00:13, 281.93 examples/s]
Map:  45%|████▍     | 2923/6548 [00:09<00:13, 268.69 examples/s]
Map:  45%|████▌     | 2959/6548 [00:09<00:12, 283.56 examples/s]
Map:  46%|████▌     | 2991/6548 [00:09<00:14, 247.65 examples/s]
Map:  46%|████▌     | 3022/6548 [00:10<00:22, 154.79 examples/s]
Map:  47%|████▋     | 3054/6548 [00:10<00:19, 178.14 examples/s]
Map:  47%|████▋     | 3090/6548 [00:10<00:16, 208.70 examples/s]
Map:  48%|████▊     | 3125/6548 [00:10<00:14, 236.30 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:13, 249.38 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 245.96 examples/s]
Map:  49%|████▉     | 3236/6548 [00:10<00:12, 264.10 examples/s]
Map:  50%|████▉     | 3269/6548 [00:10<00:11, 276.37 examples/s]
Map:  51%|█████     | 3324/6548 [00:11<00:10, 304.27 examples/s]
Map:  51%|█████▏    | 3360/6548 [00:11<00:11, 282.53 examples/s]
Map:  52%|█████▏    | 3404/6548 [00:11<00:11, 279.42 examples/s]
Map:  53%|█████▎    | 3443/6548 [00:11<00:10, 303.57 examples/s]
Map:  53%|█████▎    | 3486/6548 [00:11<00:11, 276.44 examples/s]
Map:  54%|█████▍    | 3532/6548 [00:11<00:09, 316.07 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:11<00:08, 341.34 examples/s]
Map:  55%|█████▌    | 3622/6548 [00:12<00:07, 365.97 examples/s]
Map:  56%|█████▌    | 3682/6548 [00:12<00:07, 375.27 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:12<00:07, 368.89 examples/s]
Map:  58%|█████▊    | 3798/6548 [00:12<00:07, 361.51 examples/s]
Map:  59%|█████▊    | 3840/6548 [00:12<00:08, 334.27 examples/s]
Map:  59%|█████▉    | 3885/6548 [00:12<00:08, 306.75 examples/s]
Map:  60%|█████▉    | 3928/6548 [00:12<00:08, 313.50 examples/s]
Map:  60%|██████    | 3960/6548 [00:13<00:08, 313.70 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 222.94 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 279.83 examples/s]
Map:  63%|██████▎   | 4095/6548 [00:13<00:08, 306.07 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 317.76 examples/s]
Map:  64%|██████▍   | 4187/6548 [00:13<00:07, 306.71 examples/s]
Map:  65%|██████▍   | 4237/6548 [00:14<00:07, 311.03 examples/s]
Map:  65%|██████▌   | 4285/6548 [00:14<00:06, 347.72 examples/s]
Map:  66%|██████▌   | 4323/6548 [00:14<00:06, 355.17 examples/s]
Map:  67%|██████▋   | 4376/6548 [00:14<00:06, 351.17 examples/s]
Map:  67%|██████▋   | 4414/6548 [00:14<00:06, 354.40 examples/s]
Map:  68%|██████▊   | 4457/6548 [00:14<00:05, 372.12 examples/s]
Map:  69%|██████▊   | 4498/6548 [00:14<00:06, 330.73 examples/s]
Map:  69%|██████▉   | 4546/6548 [00:14<00:06, 316.14 examples/s]
Map:  70%|███████   | 4584/6548 [00:15<00:06, 323.28 examples/s]
Map:  71%|███████   | 4633/6548 [00:15<00:05, 357.31 examples/s]
Map:  71%|███████▏  | 4673/6548 [00:15<00:05, 364.76 examples/s]
Map:  72%|███████▏  | 4714/6548 [00:15<00:04, 376.13 examples/s]
Map:  73%|███████▎  | 4782/6548 [00:15<00:04, 401.63 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 401.47 examples/s]
Map:  75%|███████▍  | 4886/6548 [00:15<00:04, 392.29 examples/s]
Map:  75%|███████▌  | 4933/6548 [00:15<00:04, 397.77 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:16<00:03, 410.32 examples/s]
Map:  77%|███████▋  | 5038/6548 [00:16<00:05, 256.05 examples/s]
Map:  78%|███████▊  | 5081/6548 [00:16<00:05, 261.59 examples/s]
Map:  78%|███████▊  | 5116/6548 [00:16<00:05, 277.66 examples/s]
Map:  79%|███████▉  | 5163/6548 [00:16<00:04, 285.62 examples/s]
Map:  80%|███████▉  | 5210/6548 [00:16<00:04, 291.84 examples/s]
Map:  80%|████████  | 5248/6548 [00:17<00:04, 308.74 examples/s]
Map:  81%|████████  | 5287/6548 [00:17<00:03, 326.84 examples/s]
Map:  81%|████████▏ | 5325/6548 [00:17<00:03, 329.45 examples/s]
Map:  82%|████████▏ | 5373/6548 [00:17<00:03, 317.25 examples/s]
Map:  83%|████████▎ | 5406/6548 [00:17<00:04, 284.00 examples/s]
Map:  83%|████████▎ | 5444/6548 [00:17<00:03, 300.85 examples/s]
Map:  84%|████████▎ | 5478/6548 [00:17<00:03, 302.92 examples/s]
Map:  84%|████████▍ | 5514/6548 [00:17<00:03, 314.49 examples/s]
Map:  85%|████████▍ | 5557/6548 [00:18<00:02, 342.71 examples/s]
Map:  86%|████████▌ | 5610/6548 [00:18<00:02, 322.11 examples/s]
Map:  86%|████████▌ | 5647/6548 [00:18<00:02, 328.20 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 318.91 examples/s]
Map:  87%|████████▋ | 5720/6548 [00:18<00:02, 335.01 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 349.16 examples/s]
Map:  89%|████████▊ | 5800/6548 [00:18<00:02, 351.84 examples/s]
Map:  89%|████████▉ | 5856/6548 [00:18<00:01, 353.23 examples/s]
Map:  90%|████████▉ | 5892/6548 [00:19<00:01, 350.35 examples/s]
Map:  91%|█████████ | 5933/6548 [00:19<00:01, 358.86 examples/s]
Map:  91%|█████████▏| 5987/6548 [00:19<00:01, 342.53 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 231.88 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 265.10 examples/s]
Map:  93%|█████████▎| 6113/6548 [00:19<00:01, 245.31 examples/s]
Map:  94%|█████████▍| 6142/6548 [00:20<00:01, 251.05 examples/s]
Map:  94%|█████████▍| 6184/6548 [00:20<00:01, 277.52 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:20<00:01, 305.57 examples/s]
Map:  96%|█████████▌| 6262/6548 [00:20<00:00, 315.95 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 335.81 examples/s]
Map:  97%|█████████▋| 6367/6548 [00:20<00:00, 351.77 examples/s]
Map:  98%|█████████▊| 6420/6548 [00:20<00:00, 350.08 examples/s]
Map:  99%|█████████▉| 6469/6548 [00:20<00:00, 380.52 examples/s]
Map: 100%|█████████▉| 6527/6548 [00:21<00:00, 378.33 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 308.61 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 318.39 examples/s]
Map:   8%|▊         | 73/903 [00:00<00:02, 343.32 examples/s]
Map:  13%|█▎        | 118/903 [00:00<00:02, 311.63 examples/s]
Map:  18%|█▊        | 163/903 [00:00<00:02, 350.43 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 377.43 examples/s]
Map:  29%|██▉       | 260/903 [00:00<00:01, 350.17 examples/s]
Map:  33%|███▎      | 301/903 [00:00<00:01, 349.51 examples/s]
Map:  39%|███▊      | 348/903 [00:01<00:01, 329.19 examples/s]
Map:  43%|████▎     | 390/903 [00:01<00:01, 283.12 examples/s]
Map:  48%|████▊     | 430/903 [00:01<00:01, 305.25 examples/s]
Map:  52%|█████▏    | 472/903 [00:01<00:01, 294.69 examples/s]
Map:  56%|█████▋    | 508/903 [00:01<00:01, 298.55 examples/s]
Map:  62%|██████▏   | 557/903 [00:01<00:01, 338.03 examples/s]
Map:  68%|██████▊   | 613/903 [00:01<00:00, 336.49 examples/s]
Map:  74%|███████▎  | 665/903 [00:02<00:00, 332.02 examples/s]
Map:  78%|███████▊  | 708/903 [00:02<00:00, 348.32 examples/s]
Map:  85%|████████▍ | 765/903 [00:02<00:00, 400.38 examples/s]
Map:  91%|█████████ | 822/903 [00:02<00:00, 385.57 examples/s]
Map:  97%|█████████▋| 875/903 [00:02<00:00, 364.54 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 311.84 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 293.82 examples/s]
Map:   4%|▍         | 81/1882 [00:00<00:04, 361.68 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 347.97 examples/s]
Map:   8%|▊         | 159/1882 [00:00<00:04, 362.71 examples/s]
Map:  10%|█         | 196/1882 [00:00<00:04, 361.69 examples/s]
Map:  13%|█▎        | 236/1882 [00:00<00:04, 372.54 examples/s]
Map:  15%|█▍        | 276/1882 [00:00<00:04, 378.10 examples/s]
Map:  18%|█▊        | 331/1882 [00:00<00:04, 369.83 examples/s]
Map:  20%|█▉        | 371/1882 [00:01<00:04, 328.88 examples/s]
Map:  22%|██▏       | 411/1882 [00:01<00:04, 296.22 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 301.67 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 336.33 examples/s]
Map:  29%|██▉       | 543/1882 [00:01<00:04, 323.76 examples/s]
Map:  31%|███       | 587/1882 [00:01<00:03, 349.59 examples/s]
Map:  34%|███▍      | 644/1882 [00:01<00:03, 398.01 examples/s]
Map:  37%|███▋      | 704/1882 [00:01<00:03, 383.38 examples/s]
Map:  41%|████      | 768/1882 [00:02<00:02, 390.37 examples/s]
Map:  43%|████▎     | 810/1882 [00:02<00:03, 355.14 examples/s]
Map:  45%|████▌     | 853/1882 [00:02<00:02, 357.83 examples/s]
Map:  48%|████▊     | 897/1882 [00:02<00:02, 373.47 examples/s]
Map:  50%|████▉     | 940/1882 [00:02<00:02, 382.86 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 390.15 examples/s]
Map:  55%|█████▌    | 1037/1882 [00:03<00:03, 239.48 examples/s]
Map:  57%|█████▋    | 1072/1882 [00:03<00:03, 255.26 examples/s]
Map:  59%|█████▉    | 1116/1882 [00:03<00:02, 262.02 examples/s]
Map:  62%|██████▏   | 1160/1882 [00:03<00:02, 269.21 examples/s]
Map:  64%|██████▍   | 1206/1882 [00:03<00:02, 264.25 examples/s]
Map:  66%|██████▌   | 1243/1882 [00:03<00:02, 283.58 examples/s]
Map:  68%|██████▊   | 1278/1882 [00:03<00:02, 297.19 examples/s]
Map:  70%|██████▉   | 1314/1882 [00:04<00:01, 310.02 examples/s]
Map:  72%|███████▏  | 1353/1882 [00:04<00:01, 328.73 examples/s]
Map:  75%|███████▍  | 1403/1882 [00:04<00:01, 324.72 examples/s]
Map:  77%|███████▋  | 1452/1882 [00:04<00:01, 289.24 examples/s]
Map:  79%|███████▉  | 1493/1882 [00:04<00:01, 274.42 examples/s]
Map:  81%|████████  | 1524/1882 [00:04<00:01, 267.11 examples/s]
Map:  83%|████████▎ | 1557/1882 [00:04<00:01, 280.22 examples/s]
Map:  85%|████████▌ | 1607/1882 [00:05<00:00, 329.39 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 334.24 examples/s]
Map:  91%|█████████ | 1713/1882 [00:05<00:00, 327.52 examples/s]
Map:  93%|█████████▎| 1748/1882 [00:05<00:00, 278.22 examples/s]
Map:  95%|█████████▍| 1787/1882 [00:05<00:00, 268.90 examples/s]
Map:  98%|█████████▊| 1835/1882 [00:05<00:00, 312.70 examples/s]
Map: 100%|█████████▉| 1878/1882 [00:05<00:00, 337.60 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 308.87 examples/s]
10/12/2024 09:41:04 - INFO - __main__ -     ***** Testing *****
10/12/2024 09:41:04 - INFO - __main__ -     Batch size = 8
10/12/2024 09:41:04 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 09:41:05 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 09:41:05 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 09:41:05 - INFO - knnlm -   Reading datastore took 0.960296630859375 s
10/12/2024 09:41:06 - INFO - knnlm -   Moving index to GPU took 0.9320919513702393 s
10/12/2024 09:41:06 - INFO - __main__ -   ******************************break-into
10/12/2024 09:41:06 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 09:41:06 - INFO - __main__ -     Num examples = 236
10/12/2024 09:41:06 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<34:04,  8.70s/it]
test ppl:   1%|          | 2/236 [00:11<19:26,  4.99s/it]
test ppl:   1%|▏         | 3/236 [00:12<13:47,  3.55s/it]
test ppl:   2%|▏         | 4/236 [00:14<11:23,  2.95s/it]
test ppl:   2%|▏         | 5/236 [00:22<17:19,  4.50s/it]
test ppl:   3%|▎         | 6/236 [00:25<15:05,  3.94s/it]
test ppl:   3%|▎         | 7/236 [00:28<14:00,  3.67s/it]
test ppl:   3%|▎         | 8/236 [00:33<15:54,  4.19s/it]
test ppl:   4%|▍         | 9/236 [00:40<19:29,  5.15s/it]
test ppl:   4%|▍         | 10/236 [00:44<18:01,  4.78s/it]
test ppl:   5%|▍         | 11/236 [00:47<15:46,  4.21s/it]
test ppl:   5%|▌         | 12/236 [00:50<14:29,  3.88s/it]
test ppl:   6%|▌         | 13/236 [00:57<18:13,  4.90s/it]
test ppl:   6%|▌         | 14/236 [01:05<20:47,  5.62s/it]
test ppl:   6%|▋         | 15/236 [01:08<17:43,  4.81s/it]
test ppl:   7%|▋         | 16/236 [01:10<14:50,  4.05s/it]
test ppl:   7%|▋         | 17/236 [01:14<15:13,  4.17s/it]
test ppl:   8%|▊         | 18/236 [01:17<12:51,  3.54s/it]
test ppl:   8%|▊         | 19/236 [01:22<14:54,  4.12s/it]
test ppl:   8%|▊         | 20/236 [01:24<12:43,  3.54s/it]
test ppl:   9%|▉         | 21/236 [01:31<16:38,  4.64s/it]
test ppl:   9%|▉         | 22/236 [01:39<19:21,  5.43s/it]
test ppl:  10%|▉         | 23/236 [01:42<16:46,  4.72s/it]
test ppl:  10%|█         | 24/236 [01:45<14:46,  4.18s/it]
test ppl:  11%|█         | 25/236 [01:47<12:40,  3.60s/it]
test ppl:  11%|█         | 26/236 [01:54<16:28,  4.71s/it]
test ppl:  11%|█▏        | 27/236 [01:59<16:51,  4.84s/it]
test ppl:  12%|█▏        | 28/236 [02:01<13:16,  3.83s/it]
test ppl:  12%|█▏        | 29/236 [02:04<12:12,  3.54s/it]
test ppl:  13%|█▎        | 30/236 [02:06<10:25,  3.03s/it]
test ppl:  13%|█▎        | 31/236 [02:08<09:47,  2.86s/it]
test ppl:  14%|█▎        | 32/236 [02:12<10:25,  3.06s/it]
test ppl:  14%|█▍        | 33/236 [02:19<14:40,  4.34s/it]
test ppl:  14%|█▍        | 34/236 [02:24<15:13,  4.52s/it]
test ppl:  15%|█▍        | 35/236 [02:27<13:43,  4.10s/it]
test ppl:  15%|█▌        | 36/236 [02:34<16:49,  5.05s/it]
test ppl:  16%|█▌        | 37/236 [02:41<18:58,  5.72s/it]
test ppl:  16%|█▌        | 38/236 [02:44<15:43,  4.77s/it]
test ppl:  17%|█▋        | 39/236 [02:46<12:45,  3.89s/it]
test ppl:  17%|█▋        | 40/236 [02:49<12:09,  3.72s/it]
test ppl:  17%|█▋        | 41/236 [02:52<11:29,  3.53s/it]
test ppl:  18%|█▊        | 42/236 [03:00<15:05,  4.67s/it]
test ppl:  18%|█▊        | 43/236 [03:07<17:33,  5.46s/it]
test ppl:  19%|█▊        | 44/236 [03:10<14:57,  4.67s/it]
test ppl:  19%|█▉        | 45/236 [03:12<12:44,  4.00s/it]
test ppl:  19%|█▉        | 46/236 [03:19<15:49,  5.00s/it]
test ppl:  20%|█▉        | 47/236 [03:27<17:56,  5.70s/it]
test ppl:  20%|██        | 48/236 [03:34<19:19,  6.17s/it]
test ppl:  21%|██        | 49/236 [03:40<19:23,  6.22s/it]
test ppl:  21%|██        | 50/236 [03:48<20:19,  6.56s/it]
test ppl:  22%|██▏       | 51/236 [03:55<20:53,  6.78s/it]
test ppl:  22%|██▏       | 52/236 [04:02<21:15,  6.93s/it]
test ppl:  22%|██▏       | 53/236 [04:09<20:56,  6.87s/it]
test ppl:  23%|██▎       | 54/236 [04:11<16:18,  5.37s/it]
test ppl:  23%|██▎       | 55/236 [04:18<17:39,  5.85s/it]
test ppl:  24%|██▎       | 56/236 [04:22<16:03,  5.35s/it]
test ppl:  24%|██▍       | 57/236 [04:25<13:59,  4.69s/it]
test ppl:  25%|██▍       | 58/236 [04:28<12:07,  4.09s/it]
test ppl:  25%|██▌       | 59/236 [04:34<14:00,  4.75s/it]
test ppl:  25%|██▌       | 60/236 [04:38<13:07,  4.48s/it]
test ppl:  26%|██▌       | 61/236 [04:45<15:29,  5.31s/it]
test ppl:  26%|██▋       | 62/236 [04:50<15:12,  5.24s/it]
test ppl:  27%|██▋       | 63/236 [04:53<13:11,  4.58s/it]
test ppl:  27%|██▋       | 64/236 [04:55<10:46,  3.76s/it]
test ppl:  28%|██▊       | 65/236 [04:57<08:52,  3.11s/it]
test ppl:  28%|██▊       | 66/236 [05:01<09:17,  3.28s/it]
test ppl:  28%|██▊       | 67/236 [05:04<09:25,  3.35s/it]
test ppl:  29%|██▉       | 68/236 [05:11<12:39,  4.52s/it]
test ppl:  29%|██▉       | 69/236 [05:17<13:31,  4.86s/it]
test ppl:  30%|██▉       | 70/236 [05:19<11:02,  3.99s/it]
test ppl:  30%|███       | 71/236 [05:23<11:20,  4.12s/it]
test ppl:  31%|███       | 72/236 [05:28<11:44,  4.30s/it]
test ppl:  31%|███       | 73/236 [05:33<12:03,  4.44s/it]
test ppl:  31%|███▏      | 74/236 [05:35<09:53,  3.66s/it]
test ppl:  32%|███▏      | 75/236 [05:42<12:44,  4.75s/it]
test ppl:  32%|███▏      | 76/236 [05:46<12:15,  4.60s/it]
test ppl:  33%|███▎      | 77/236 [05:49<10:45,  4.06s/it]
test ppl:  33%|███▎      | 78/236 [05:51<09:02,  3.43s/it]
test ppl:  33%|███▎      | 79/236 [05:57<11:09,  4.26s/it]
test ppl:  34%|███▍      | 80/236 [05:59<09:31,  3.66s/it]
test ppl:  34%|███▍      | 81/236 [06:07<12:15,  4.75s/it]
test ppl:  35%|███▍      | 82/236 [06:14<14:10,  5.53s/it]
test ppl:  35%|███▌      | 83/236 [06:17<11:44,  4.61s/it]
test ppl:  36%|███▌      | 84/236 [06:19<09:56,  3.92s/it]
test ppl:  36%|███▌      | 85/236 [06:24<10:45,  4.27s/it]
test ppl:  36%|███▋      | 86/236 [06:27<09:29,  3.80s/it]
test ppl:  37%|███▋      | 87/236 [06:29<08:31,  3.44s/it]
test ppl:  37%|███▋      | 88/236 [06:36<11:18,  4.58s/it]
test ppl:  38%|███▊      | 89/236 [06:39<09:38,  3.94s/it]
test ppl:  38%|███▊      | 90/236 [06:46<12:00,  4.94s/it]
test ppl:  39%|███▊      | 91/236 [06:52<12:42,  5.26s/it]
test ppl:  39%|███▉      | 92/236 [06:56<11:19,  4.72s/it]
test ppl:  39%|███▉      | 93/236 [07:03<13:03,  5.48s/it]
test ppl:  40%|███▉      | 94/236 [07:10<14:14,  6.02s/it]
test ppl:  40%|████      | 95/236 [07:13<11:49,  5.03s/it]
test ppl:  41%|████      | 96/236 [07:17<10:46,  4.62s/it]
test ppl:  41%|████      | 97/236 [07:24<12:32,  5.41s/it]
test ppl:  42%|████▏     | 98/236 [07:31<13:44,  5.98s/it]
test ppl:  42%|████▏     | 99/236 [07:38<14:31,  6.36s/it]
test ppl:  42%|████▏     | 100/236 [07:40<11:11,  4.94s/it]
test ppl:  43%|████▎     | 101/236 [07:47<12:27,  5.54s/it]
test ppl:  43%|████▎     | 102/236 [07:51<11:27,  5.13s/it]
test ppl:  44%|████▎     | 103/236 [07:54<09:40,  4.36s/it]
test ppl:  44%|████▍     | 104/236 [07:59<10:11,  4.63s/it]
test ppl:  44%|████▍     | 105/236 [08:04<10:14,  4.69s/it]
test ppl:  45%|████▍     | 106/236 [08:10<11:27,  5.29s/it]
test ppl:  45%|████▌     | 107/236 [08:13<09:34,  4.46s/it]
test ppl:  46%|████▌     | 108/236 [08:20<11:10,  5.24s/it]
test ppl:  46%|████▌     | 109/236 [08:26<11:28,  5.42s/it]
test ppl:  47%|████▋     | 110/236 [08:28<09:11,  4.37s/it]
test ppl:  47%|████▋     | 111/236 [08:33<09:26,  4.53s/it]
test ppl:  47%|████▋     | 112/236 [08:38<09:46,  4.73s/it]
test ppl:  48%|████▊     | 113/236 [08:40<08:06,  3.96s/it]
test ppl:  48%|████▊     | 114/236 [08:44<08:08,  4.01s/it]
test ppl:  49%|████▊     | 115/236 [08:51<10:02,  4.98s/it]
test ppl:  49%|████▉     | 116/236 [08:58<11:04,  5.54s/it]
test ppl:  50%|████▉     | 117/236 [09:01<09:02,  4.56s/it]
test ppl:  50%|█████     | 118/236 [09:06<09:28,  4.82s/it]
test ppl:  50%|█████     | 119/236 [09:10<08:57,  4.59s/it]
test ppl:  51%|█████     | 120/236 [09:12<07:18,  3.78s/it]
test ppl:  51%|█████▏    | 121/236 [09:19<09:14,  4.82s/it]
test ppl:  52%|█████▏    | 122/236 [09:25<09:47,  5.15s/it]
test ppl:  52%|█████▏    | 123/236 [09:28<08:17,  4.40s/it]
test ppl:  53%|█████▎    | 124/236 [09:31<07:39,  4.10s/it]
test ppl:  53%|█████▎    | 125/236 [09:34<07:01,  3.79s/it]
test ppl:  53%|█████▎    | 126/236 [09:40<08:13,  4.49s/it]
test ppl:  54%|█████▍    | 127/236 [09:43<06:57,  3.83s/it]
test ppl:  54%|█████▍    | 128/236 [09:45<06:19,  3.51s/it]
test ppl:  55%|█████▍    | 129/236 [09:49<06:20,  3.56s/it]
test ppl:  55%|█████▌    | 130/236 [09:53<06:23,  3.61s/it]
test ppl:  56%|█████▌    | 131/236 [10:00<08:14,  4.71s/it]
test ppl:  56%|█████▌    | 132/236 [10:03<07:17,  4.21s/it]
test ppl:  56%|█████▋    | 133/236 [10:08<07:33,  4.40s/it]
test ppl:  57%|█████▋    | 134/236 [10:13<07:41,  4.52s/it]
test ppl:  57%|█████▋    | 135/236 [10:20<08:59,  5.34s/it]
test ppl:  58%|█████▊    | 136/236 [10:21<06:57,  4.18s/it]
test ppl:  58%|█████▊    | 137/236 [10:29<08:26,  5.11s/it]
test ppl:  58%|█████▊    | 138/236 [10:33<07:58,  4.88s/it]
test ppl:  59%|█████▉    | 139/236 [10:36<07:03,  4.37s/it]
test ppl:  59%|█████▉    | 140/236 [10:38<05:54,  3.69s/it]
test ppl:  60%|█████▉    | 141/236 [10:42<05:46,  3.65s/it]
test ppl:  60%|██████    | 142/236 [10:45<05:13,  3.34s/it]
test ppl:  61%|██████    | 143/236 [10:52<07:00,  4.52s/it]
test ppl:  61%|██████    | 144/236 [10:55<06:24,  4.17s/it]
test ppl:  61%|██████▏   | 145/236 [11:02<07:30,  4.96s/it]
test ppl:  62%|██████▏   | 146/236 [11:07<07:41,  5.13s/it]
test ppl:  62%|██████▏   | 147/236 [11:15<08:33,  5.77s/it]
test ppl:  63%|██████▎   | 148/236 [11:22<09:10,  6.26s/it]
test ppl:  63%|██████▎   | 149/236 [11:26<08:09,  5.63s/it]
test ppl:  64%|██████▎   | 150/236 [11:30<07:08,  4.99s/it]
test ppl:  64%|██████▍   | 151/236 [11:37<08:01,  5.67s/it]
test ppl:  64%|██████▍   | 152/236 [11:44<08:36,  6.15s/it]
test ppl:  65%|██████▍   | 153/236 [11:52<08:58,  6.49s/it]
test ppl:  65%|██████▌   | 154/236 [11:55<07:28,  5.47s/it]
test ppl:  66%|██████▌   | 155/236 [11:58<06:30,  4.82s/it]
test ppl:  66%|██████▌   | 156/236 [12:01<05:33,  4.17s/it]
test ppl:  67%|██████▋   | 157/236 [12:03<04:54,  3.73s/it]
test ppl:  67%|██████▋   | 158/236 [12:11<06:13,  4.79s/it]
test ppl:  67%|██████▋   | 159/236 [12:18<07:06,  5.54s/it]
test ppl:  68%|██████▊   | 160/236 [12:19<05:27,  4.30s/it]
test ppl:  68%|██████▊   | 161/236 [12:21<04:23,  3.52s/it]
test ppl:  69%|██████▊   | 162/236 [12:25<04:27,  3.62s/it]
test ppl:  69%|██████▉   | 163/236 [12:28<04:13,  3.47s/it]
test ppl:  69%|██████▉   | 164/236 [12:35<05:32,  4.62s/it]
test ppl:  70%|██████▉   | 165/236 [12:41<05:41,  4.81s/it]
test ppl:  70%|███████   | 166/236 [12:42<04:34,  3.92s/it]
test ppl:  71%|███████   | 167/236 [12:44<03:46,  3.28s/it]
test ppl:  71%|███████   | 168/236 [12:49<04:23,  3.88s/it]
test ppl:  72%|███████▏  | 169/236 [12:56<05:16,  4.72s/it]
test ppl:  72%|███████▏  | 170/236 [13:03<06:03,  5.50s/it]
test ppl:  72%|███████▏  | 171/236 [13:05<04:42,  4.34s/it]
test ppl:  73%|███████▎  | 172/236 [13:12<05:34,  5.22s/it]
test ppl:  73%|███████▎  | 173/236 [13:17<05:16,  5.02s/it]
test ppl:  74%|███████▎  | 174/236 [13:22<05:07,  4.96s/it]
test ppl:  74%|███████▍  | 175/236 [13:24<04:13,  4.15s/it]
test ppl:  75%|███████▍  | 176/236 [13:30<04:42,  4.71s/it]
test ppl:  75%|███████▌  | 177/236 [13:37<05:23,  5.49s/it]
test ppl:  75%|███████▌  | 178/236 [13:45<05:49,  6.03s/it]
test ppl:  76%|███████▌  | 179/236 [13:52<06:00,  6.33s/it]
test ppl:  76%|███████▋  | 180/236 [13:56<05:17,  5.66s/it]
test ppl:  77%|███████▋  | 181/236 [14:03<05:33,  6.06s/it]
test ppl:  77%|███████▋  | 182/236 [14:05<04:25,  4.92s/it]
test ppl:  78%|███████▊  | 183/236 [14:08<03:45,  4.26s/it]
test ppl:  78%|███████▊  | 184/236 [14:09<03:01,  3.50s/it]
test ppl:  78%|███████▊  | 185/236 [14:17<03:53,  4.57s/it]
test ppl:  79%|███████▉  | 186/236 [14:24<04:25,  5.30s/it]
test ppl:  79%|███████▉  | 187/236 [14:31<04:46,  5.84s/it]
test ppl:  80%|███████▉  | 188/236 [14:38<04:57,  6.21s/it]
test ppl:  80%|████████  | 189/236 [14:45<05:03,  6.45s/it]
test ppl:  81%|████████  | 190/236 [14:49<04:28,  5.83s/it]
test ppl:  81%|████████  | 191/236 [14:54<04:13,  5.63s/it]
test ppl:  81%|████████▏ | 192/236 [14:57<03:34,  4.88s/it]
test ppl:  82%|████████▏ | 193/236 [15:04<03:57,  5.53s/it]
test ppl:  82%|████████▏ | 194/236 [15:08<03:21,  4.81s/it]
test ppl:  83%|████████▎ | 195/236 [15:11<03:02,  4.46s/it]
test ppl:  83%|████████▎ | 196/236 [15:14<02:33,  3.84s/it]
test ppl:  83%|████████▎ | 197/236 [15:16<02:14,  3.45s/it]
test ppl:  84%|████████▍ | 198/236 [15:23<02:51,  4.52s/it]
test ppl:  84%|████████▍ | 199/236 [15:26<02:32,  4.13s/it]
test ppl:  85%|████████▍ | 200/236 [15:33<02:59,  4.99s/it]
test ppl:  85%|████████▌ | 201/236 [15:36<02:27,  4.22s/it]
test ppl:  86%|████████▌ | 202/236 [15:41<02:36,  4.60s/it]
test ppl:  86%|████████▌ | 203/236 [15:48<02:51,  5.20s/it]
test ppl:  86%|████████▋ | 204/236 [15:50<02:19,  4.36s/it]
test ppl:  87%|████████▋ | 205/236 [15:57<02:40,  5.17s/it]
test ppl:  87%|████████▋ | 206/236 [16:01<02:24,  4.80s/it]
test ppl:  88%|████████▊ | 207/236 [16:08<02:38,  5.47s/it]
test ppl:  88%|████████▊ | 208/236 [16:12<02:18,  4.95s/it]
test ppl:  89%|████████▊ | 209/236 [16:19<02:30,  5.59s/it]
test ppl:  89%|████████▉ | 210/236 [16:22<02:03,  4.75s/it]
test ppl:  89%|████████▉ | 211/236 [16:27<02:02,  4.92s/it]
test ppl:  90%|████████▉ | 212/236 [16:33<02:07,  5.29s/it]
test ppl:  90%|█████████ | 213/236 [16:40<02:13,  5.81s/it]
test ppl:  91%|█████████ | 214/236 [16:42<01:42,  4.65s/it]
test ppl:  91%|█████████ | 215/236 [16:49<01:52,  5.37s/it]
test ppl:  92%|█████████▏| 216/236 [16:51<01:27,  4.35s/it]
test ppl:  92%|█████████▏| 217/236 [16:59<01:38,  5.18s/it]
test ppl:  92%|█████████▏| 218/236 [17:01<01:17,  4.32s/it]
test ppl:  93%|█████████▎| 219/236 [17:08<01:27,  5.14s/it]
test ppl:  93%|█████████▎| 220/236 [17:15<01:31,  5.71s/it]
test ppl:  94%|█████████▎| 221/236 [17:20<01:21,  5.41s/it]
test ppl:  94%|█████████▍| 222/236 [17:27<01:22,  5.90s/it]
test ppl:  94%|█████████▍| 223/236 [17:34<01:21,  6.24s/it]
test ppl:  95%|█████████▍| 224/236 [17:35<00:57,  4.83s/it]
test ppl:  95%|█████████▌| 225/236 [17:42<00:58,  5.31s/it]
test ppl:  96%|█████████▌| 226/236 [17:46<00:49,  4.98s/it]
test ppl:  96%|█████████▌| 227/236 [17:49<00:40,  4.51s/it]
test ppl:  97%|█████████▋| 228/236 [17:52<00:30,  3.83s/it]
test ppl:  97%|█████████▋| 229/236 [17:59<00:33,  4.78s/it]
test ppl:  97%|█████████▋| 230/236 [18:03<00:27,  4.60s/it]
test ppl:  98%|█████████▊| 231/236 [18:07<00:22,  4.42s/it]
test ppl:  98%|█████████▊| 232/236 [18:09<00:14,  3.72s/it]
test ppl:  99%|█████████▊| 233/236 [18:11<00:10,  3.38s/it]
test ppl:  99%|█████████▉| 234/236 [18:13<00:05,  2.92s/it]
test ppl: 100%|█████████▉| 235/236 [18:20<00:04,  4.15s/it]
test ppl: 100%|██████████| 236/236 [18:21<00:00,  3.14s/it]
test ppl: 100%|██████████| 236/236 [18:21<00:00,  4.67s/it]
10/12/2024 09:59:28 - INFO - __main__ -    em: 0.2109
10/12/2024 09:59:28 - INFO - __main__ -   Finish and take 20m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.2 20:  em: 0.2109

--------------------------------------------------------------------------------
Running experiment with knn_temp=20, lmbda=0.2, k=64
2024-10-12 09:59:35.457727: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 09:59:35.477409: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 09:59:35.499245: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 09:59:35.505921: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 09:59:35.522959: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 09:59:36.515066: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 09:59:37 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.2, knn_temp=20, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 09:59:37 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:38:16,  2.20it/s]
Adding feature api:   4%|▍         | 7084/187062 [00:00<00:10, 16928.53it/s]
Adding feature api:   8%|▊         | 15461/187062 [00:00<00:05, 33939.13it/s]
Adding feature api:  13%|█▎        | 23922/187062 [00:00<00:03, 47448.87it/s]
Adding feature api:  17%|█▋        | 32392/187062 [00:00<00:02, 57723.14it/s]
Adding feature api:  22%|██▏       | 40855/187062 [00:00<00:02, 65326.35it/s]
Adding feature api:  26%|██▌       | 49075/187062 [00:01<00:01, 70178.06it/s]
Adding feature api:  31%|███       | 57498/187062 [00:01<00:01, 74268.33it/s]
Adding feature api:  35%|███▌      | 65901/187062 [00:01<00:01, 77133.78it/s]
Adding feature api:  40%|███▉      | 74362/187062 [00:01<00:01, 79343.27it/s]
Adding feature api:  44%|████▍     | 82648/187062 [00:01<00:01, 80173.58it/s]
Adding feature api:  49%|████▊     | 91098/187062 [00:01<00:01, 81459.32it/s]
Adding feature api:  53%|█████▎    | 99586/187062 [00:01<00:01, 82476.21it/s]
Adding feature api:  58%|█████▊    | 108071/187062 [00:01<00:00, 83183.28it/s]
Adding feature api:  62%|██████▏   | 116476/187062 [00:01<00:00, 82922.74it/s]
Adding feature api:  67%|██████▋   | 124942/187062 [00:01<00:00, 83439.27it/s]
Adding feature api:  71%|███████▏  | 133452/187062 [00:02<00:00, 83932.52it/s]
Adding feature api:  76%|███████▌  | 141879/187062 [00:02<00:00, 84030.82it/s]
Adding feature api:  80%|████████  | 150337/187062 [00:02<00:00, 84194.44it/s]
Adding feature api:  85%|████████▍ | 158772/187062 [00:02<00:00, 83558.21it/s]
Adding feature api:  89%|████████▉ | 167249/187062 [00:02<00:00, 83916.91it/s]
Adding feature api:  94%|█████████▍| 175765/187062 [00:02<00:00, 84286.03it/s]
Adding feature api:  98%|█████████▊| 184200/187062 [00:02<00:00, 57383.29it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64451.59it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:24:01,  2.22it/s]
Adding feature datatype:   4%|▍         | 7162/187062 [00:00<00:10, 17246.61it/s]
Adding feature datatype:   8%|▊         | 15287/187062 [00:00<00:05, 33628.53it/s]
Adding feature datatype:  13%|█▎        | 23469/187062 [00:00<00:03, 46531.10it/s]
Adding feature datatype:  17%|█▋        | 31681/187062 [00:00<00:02, 56375.96it/s]
Adding feature datatype:  21%|██        | 39556/187062 [00:00<00:02, 62712.39it/s]
Adding feature datatype:  26%|██▌       | 47723/187062 [00:01<00:02, 68172.64it/s]
Adding feature datatype:  30%|██▉       | 55928/187062 [00:01<00:01, 72217.60it/s]
Adding feature datatype:  34%|███▍      | 64079/187062 [00:01<00:01, 74948.66it/s]
Adding feature datatype:  39%|███▊      | 72298/187062 [00:01<00:01, 77087.55it/s]
Adding feature datatype:  43%|████▎     | 80510/187062 [00:01<00:01, 78580.62it/s]
Adding feature datatype:  47%|████▋     | 88607/187062 [00:01<00:01, 78571.76it/s]
Adding feature datatype:  52%|█████▏    | 96810/187062 [00:01<00:01, 79596.02it/s]
Adding feature datatype:  56%|█████▌    | 105005/187062 [00:01<00:01, 80293.47it/s]
Adding feature datatype:  61%|██████    | 113249/187062 [00:01<00:00, 80933.28it/s]
Adding feature datatype:  65%|██████▍   | 121433/187062 [00:01<00:00, 81201.54it/s]
Adding feature datatype:  69%|██████▉   | 129595/187062 [00:02<00:00, 80528.01it/s]
Adding feature datatype:  74%|███████▎  | 137817/187062 [00:02<00:00, 81027.82it/s]
Adding feature datatype:  78%|███████▊  | 146032/187062 [00:02<00:00, 81359.51it/s]
Adding feature datatype:  82%|████████▏ | 154291/187062 [00:02<00:00, 81726.42it/s]
Adding feature datatype:  87%|████████▋ | 162475/187062 [00:02<00:00, 81750.50it/s]
Adding feature datatype:  91%|█████████ | 170664/187062 [00:02<00:00, 81789.13it/s]
Adding feature datatype:  96%|█████████▌| 178849/187062 [00:02<00:00, 75226.89it/s]
Adding feature datatype: 100%|█████████▉| 186479/187062 [00:02<00:00, 52233.03it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63142.50it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:12:18,  2.24it/s]
Adding feature literal:   4%|▍         | 7160/187062 [00:00<00:10, 17351.95it/s]
Adding feature literal:   8%|▊         | 15323/187062 [00:00<00:05, 33882.12it/s]
Adding feature literal:  13%|█▎        | 23569/187062 [00:00<00:03, 46933.61it/s]
Adding feature literal:  17%|█▋        | 31822/187062 [00:00<00:02, 56804.73it/s]
Adding feature literal:  21%|██▏       | 40070/187062 [00:00<00:02, 64090.53it/s]
Adding feature literal:  26%|██▌       | 48329/187062 [00:01<00:01, 69425.97it/s]
Adding feature literal:  30%|███       | 56577/187062 [00:01<00:01, 73234.66it/s]
Adding feature literal:  35%|███▍      | 64825/187062 [00:01<00:01, 75951.82it/s]
Adding feature literal:  39%|███▉      | 73071/187062 [00:01<00:01, 77874.44it/s]
Adding feature literal:  43%|████▎     | 81356/187062 [00:01<00:01, 79350.03it/s]
Adding feature literal:  48%|████▊     | 89593/187062 [00:01<00:01, 80248.23it/s]
Adding feature literal:  52%|█████▏    | 97827/187062 [00:01<00:01, 80872.00it/s]
Adding feature literal:  57%|█████▋    | 106050/187062 [00:01<00:00, 81277.19it/s]
Adding feature literal:  61%|██████    | 114301/187062 [00:01<00:00, 81644.56it/s]
Adding feature literal:  66%|██████▌   | 122531/187062 [00:01<00:00, 81839.61it/s]
Adding feature literal:  70%|██████▉   | 130803/187062 [00:02<00:00, 82101.03it/s]
Adding feature literal:  74%|███████▍  | 139042/187062 [00:02<00:00, 82097.73it/s]
Adding feature literal:  79%|███████▊  | 147302/187062 [00:02<00:00, 82246.88it/s]
Adding feature literal:  83%|████████▎ | 155541/187062 [00:02<00:00, 82184.97it/s]
Adding feature literal:  88%|████████▊ | 163814/187062 [00:02<00:00, 82347.25it/s]
Adding feature literal:  92%|█████████▏| 172056/187062 [00:02<00:00, 82345.07it/s]
Adding feature literal:  96%|█████████▋| 180296/187062 [00:02<00:00, 70044.28it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63714.87it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:17:02,  2.23it/s]
Adding feature operator:   4%|▍         | 7125/187062 [00:00<00:10, 17222.50it/s]
Adding feature operator:   8%|▊         | 15315/187062 [00:00<00:05, 33823.22it/s]
Adding feature operator:  13%|█▎        | 23492/187062 [00:00<00:03, 46686.32it/s]
Adding feature operator:  17%|█▋        | 31776/187062 [00:00<00:02, 56702.82it/s]
Adding feature operator:  21%|██▏       | 39899/187062 [00:00<00:02, 63656.14it/s]
Adding feature operator:  26%|██▌       | 48151/187062 [00:01<00:02, 69092.13it/s]
Adding feature operator:  30%|███       | 56379/187062 [00:01<00:01, 72938.06it/s]
Adding feature operator:  35%|███▍      | 64665/187062 [00:01<00:01, 75853.32it/s]
Adding feature operator:  39%|███▉      | 72978/187062 [00:01<00:01, 78003.53it/s]
Adding feature operator:  43%|████▎     | 81233/187062 [00:01<00:01, 79353.41it/s]
Adding feature operator:  48%|████▊     | 89457/187062 [00:01<00:01, 80212.42it/s]
Adding feature operator:  52%|█████▏    | 97660/187062 [00:01<00:01, 80752.86it/s]
Adding feature operator:  57%|█████▋    | 105956/187062 [00:01<00:00, 81409.71it/s]
Adding feature operator:  61%|██████    | 114239/187062 [00:01<00:00, 81833.69it/s]
Adding feature operator:  65%|██████▌   | 122524/187062 [00:01<00:00, 82134.87it/s]
Adding feature operator:  70%|██████▉   | 130822/187062 [00:02<00:00, 82386.54it/s]
Adding feature operator:  74%|███████▍  | 139103/187062 [00:02<00:00, 82512.96it/s]
Adding feature operator:  79%|███████▉  | 147380/187062 [00:02<00:00, 82587.10it/s]
Adding feature operator:  83%|████████▎ | 155675/187062 [00:02<00:00, 82693.10it/s]
Adding feature operator:  88%|████████▊ | 163979/187062 [00:02<00:00, 82794.50it/s]
Adding feature operator:  92%|█████████▏| 172268/187062 [00:02<00:00, 82820.44it/s]
Adding feature operator:  97%|█████████▋| 180555/187062 [00:02<00:00, 69262.12it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63776.91it/s]
[2024-10-12 10:00:21,600] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 10:00:23 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 10:00:23 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 408.08 examples/s]
Map:   1%|▏         | 90/6548 [00:00<00:28, 226.74 examples/s]
Map:   2%|▏         | 127/6548 [00:00<00:23, 268.34 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:19, 321.53 examples/s]
Map:   3%|▎         | 225/6548 [00:00<00:17, 364.81 examples/s]
Map:   4%|▍         | 282/6548 [00:00<00:17, 360.42 examples/s]
Map:   5%|▍         | 327/6548 [00:01<00:19, 315.36 examples/s]
Map:   6%|▌         | 363/6548 [00:01<00:19, 322.85 examples/s]
Map:   6%|▋         | 416/6548 [00:01<00:16, 373.11 examples/s]
Map:   7%|▋         | 464/6548 [00:01<00:17, 350.95 examples/s]
Map:   8%|▊         | 521/6548 [00:01<00:17, 353.60 examples/s]
Map:   9%|▊         | 571/6548 [00:01<00:15, 386.18 examples/s]
Map:   9%|▉         | 620/6548 [00:01<00:16, 361.27 examples/s]
Map:  10%|█         | 666/6548 [00:01<00:17, 338.80 examples/s]
Map:  11%|█         | 710/6548 [00:02<00:16, 360.23 examples/s]
Map:  11%|█▏        | 749/6548 [00:02<00:15, 365.38 examples/s]
Map:  12%|█▏        | 800/6548 [00:02<00:14, 401.93 examples/s]
Map:  13%|█▎        | 855/6548 [00:02<00:14, 387.74 examples/s]
Map:  14%|█▍        | 911/6548 [00:02<00:14, 377.42 examples/s]
Map:  15%|█▍        | 956/6548 [00:02<00:14, 384.67 examples/s]
Map:  15%|█▌        | 1000/6548 [00:03<00:23, 239.89 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:21, 262.14 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:19, 285.88 examples/s]
Map:  17%|█▋        | 1126/6548 [00:03<00:16, 327.05 examples/s]
Map:  18%|█▊        | 1166/6548 [00:03<00:15, 342.05 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 355.65 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:14, 364.36 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:14, 374.30 examples/s]
Map:  20%|██        | 1336/6548 [00:03<00:15, 333.96 examples/s]
Map:  21%|██        | 1382/6548 [00:04<00:16, 313.34 examples/s]
Map:  22%|██▏       | 1423/6548 [00:04<00:15, 331.99 examples/s]
Map:  22%|██▏       | 1461/6548 [00:04<00:17, 290.27 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:17, 290.22 examples/s]
Map:  24%|██▎       | 1542/6548 [00:04<00:17, 289.77 examples/s]
Map:  24%|██▍       | 1579/6548 [00:04<00:16, 305.39 examples/s]
Map:  25%|██▍       | 1619/6548 [00:04<00:17, 283.31 examples/s]
Map:  25%|██▌       | 1655/6548 [00:05<00:19, 253.19 examples/s]
Map:  26%|██▌       | 1692/6548 [00:05<00:17, 278.29 examples/s]
Map:  26%|██▋       | 1730/6548 [00:05<00:16, 301.02 examples/s]
Map:  27%|██▋       | 1775/6548 [00:05<00:14, 337.53 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 337.97 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 339.35 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 332.23 examples/s]
Map:  30%|██▉       | 1947/6548 [00:05<00:13, 349.84 examples/s]
Map:  30%|███       | 1991/6548 [00:06<00:12, 367.67 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:19, 225.90 examples/s]
Map:  32%|███▏      | 2064/6548 [00:06<00:18, 244.53 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 265.40 examples/s]
Map:  33%|███▎      | 2137/6548 [00:06<00:15, 276.88 examples/s]
Map:  33%|███▎      | 2181/6548 [00:06<00:15, 275.31 examples/s]
Map:  34%|███▍      | 2213/6548 [00:06<00:15, 282.35 examples/s]
Map:  34%|███▍      | 2255/6548 [00:07<00:15, 270.69 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:15, 275.63 examples/s]
Map:  36%|███▌      | 2331/6548 [00:07<00:13, 313.33 examples/s]
Map:  36%|███▋      | 2382/6548 [00:07<00:12, 321.15 examples/s]
Map:  37%|███▋      | 2422/6548 [00:07<00:12, 337.39 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:12, 321.45 examples/s]
Map:  38%|███▊      | 2496/6548 [00:07<00:12, 325.68 examples/s]
Map:  39%|███▊      | 2537/6548 [00:07<00:11, 343.73 examples/s]
Map:  40%|███▉      | 2589/6548 [00:08<00:10, 383.32 examples/s]
Map:  40%|████      | 2640/6548 [00:08<00:10, 364.69 examples/s]
Map:  41%|████      | 2689/6548 [00:08<00:11, 332.81 examples/s]
Map:  42%|████▏     | 2725/6548 [00:08<00:11, 332.98 examples/s]
Map:  42%|████▏     | 2768/6548 [00:08<00:10, 355.05 examples/s]
Map:  43%|████▎     | 2811/6548 [00:08<00:11, 321.80 examples/s]
Map:  43%|████▎     | 2845/6548 [00:08<00:13, 283.64 examples/s]
Map:  44%|████▍     | 2880/6548 [00:09<00:12, 295.69 examples/s]
Map:  45%|████▍     | 2928/6548 [00:09<00:12, 290.44 examples/s]
Map:  46%|████▌     | 2981/6548 [00:09<00:11, 304.30 examples/s]
Map:  46%|████▌     | 3020/6548 [00:09<00:20, 169.10 examples/s]
Map:  47%|████▋     | 3058/6548 [00:09<00:17, 197.40 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:15, 218.43 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 257.05 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:13, 259.50 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 253.47 examples/s]
Map:  49%|████▉     | 3238/6548 [00:10<00:12, 272.23 examples/s]
Map:  50%|████▉     | 3271/6548 [00:10<00:11, 279.20 examples/s]
Map:  50%|█████     | 3301/6548 [00:10<00:11, 280.97 examples/s]
Map:  51%|█████     | 3339/6548 [00:10<00:10, 304.63 examples/s]
Map:  52%|█████▏    | 3381/6548 [00:11<00:10, 290.97 examples/s]
Map:  52%|█████▏    | 3425/6548 [00:11<00:10, 285.75 examples/s]
Map:  53%|█████▎    | 3462/6548 [00:11<00:11, 262.45 examples/s]
Map:  53%|█████▎    | 3496/6548 [00:11<00:10, 278.75 examples/s]
Map:  54%|█████▍    | 3545/6548 [00:11<00:09, 329.33 examples/s]
Map:  55%|█████▍    | 3592/6548 [00:11<00:08, 363.08 examples/s]
Map:  56%|█████▌    | 3636/6548 [00:11<00:07, 381.95 examples/s]
Map:  56%|█████▋    | 3693/6548 [00:11<00:07, 372.03 examples/s]
Map:  57%|█████▋    | 3738/6548 [00:12<00:07, 390.58 examples/s]
Map:  58%|█████▊    | 3799/6548 [00:12<00:07, 377.45 examples/s]
Map:  59%|█████▊    | 3841/6548 [00:12<00:08, 331.19 examples/s]
Map:  59%|█████▉    | 3882/6548 [00:12<00:07, 334.67 examples/s]
Map:  60%|█████▉    | 3917/6548 [00:12<00:07, 336.61 examples/s]
Map:  60%|██████    | 3952/6548 [00:12<00:07, 325.31 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 236.79 examples/s]
Map:  62%|██████▏   | 4055/6548 [00:13<00:08, 296.34 examples/s]
Map:  63%|██████▎   | 4097/6548 [00:13<00:07, 321.49 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 332.98 examples/s]
Map:  64%|██████▍   | 4195/6548 [00:13<00:07, 334.40 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:06, 339.28 examples/s]
Map:  65%|██████▌   | 4282/6548 [00:13<00:06, 365.56 examples/s]
Map:  66%|██████▌   | 4325/6548 [00:13<00:05, 376.24 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:13<00:06, 362.52 examples/s]
Map:  67%|██████▋   | 4406/6548 [00:14<00:05, 365.66 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:05, 389.39 examples/s]
Map:  69%|██████▊   | 4496/6548 [00:14<00:06, 331.41 examples/s]
Map:  69%|██████▉   | 4545/6548 [00:14<00:06, 320.54 examples/s]
Map:  70%|███████   | 4584/6548 [00:14<00:06, 317.83 examples/s]
Map:  71%|███████   | 4633/6548 [00:14<00:05, 353.61 examples/s]
Map:  71%|███████▏  | 4673/6548 [00:14<00:05, 363.83 examples/s]
Map:  72%|███████▏  | 4712/6548 [00:14<00:05, 360.59 examples/s]
Map:  73%|███████▎  | 4750/6548 [00:15<00:04, 362.22 examples/s]
Map:  73%|███████▎  | 4807/6548 [00:15<00:04, 417.19 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 395.56 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 361.24 examples/s]
Map:  76%|███████▌  | 4955/6548 [00:15<00:04, 393.04 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:15<00:06, 242.21 examples/s]
Map:  77%|███████▋  | 5040/6548 [00:16<00:05, 269.68 examples/s]
Map:  78%|███████▊  | 5082/6548 [00:16<00:05, 270.61 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 276.99 examples/s]
Map:  79%|███████▉  | 5171/6548 [00:16<00:04, 298.78 examples/s]
Map:  80%|███████▉  | 5211/6548 [00:16<00:04, 285.09 examples/s]
Map:  80%|████████  | 5254/6548 [00:16<00:04, 315.75 examples/s]
Map:  81%|████████  | 5289/6548 [00:16<00:03, 322.26 examples/s]
Map:  81%|████████▏ | 5325/6548 [00:16<00:03, 324.77 examples/s]
Map:  82%|████████▏ | 5373/6548 [00:17<00:03, 318.21 examples/s]
Map:  83%|████████▎ | 5422/6548 [00:17<00:03, 284.09 examples/s]
Map:  83%|████████▎ | 5461/6548 [00:17<00:03, 304.02 examples/s]
Map:  84%|████████▍ | 5498/6548 [00:17<00:03, 318.16 examples/s]
Map:  85%|████████▍ | 5534/6548 [00:17<00:03, 325.49 examples/s]
Map:  85%|████████▌ | 5572/6548 [00:17<00:03, 322.85 examples/s]
Map:  86%|████████▌ | 5610/6548 [00:17<00:02, 326.92 examples/s]
Map:  86%|████████▌ | 5647/6548 [00:17<00:02, 336.10 examples/s]
Map:  87%|████████▋ | 5703/6548 [00:18<00:02, 329.65 examples/s]
Map:  88%|████████▊ | 5743/6548 [00:18<00:02, 345.57 examples/s]
Map:  89%|████████▊ | 5797/6548 [00:18<00:02, 342.78 examples/s]
Map:  89%|████████▉ | 5836/6548 [00:18<00:02, 311.93 examples/s]
Map:  90%|████████▉ | 5875/6548 [00:18<00:02, 327.70 examples/s]
Map:  90%|█████████ | 5912/6548 [00:18<00:01, 330.07 examples/s]
Map:  91%|█████████ | 5964/6548 [00:18<00:01, 317.42 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 211.92 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:02, 244.83 examples/s]
Map:  93%|█████████▎| 6071/6548 [00:19<00:01, 253.22 examples/s]
Map:  93%|█████████▎| 6117/6548 [00:19<00:01, 255.73 examples/s]
Map:  94%|█████████▍| 6147/6548 [00:19<00:01, 263.65 examples/s]
Map:  94%|█████████▍| 6185/6548 [00:19<00:01, 289.55 examples/s]
Map:  95%|█████████▌| 6226/6548 [00:19<00:01, 317.53 examples/s]
Map:  96%|█████████▌| 6265/6548 [00:20<00:00, 331.19 examples/s]
Map:  96%|█████████▋| 6305/6548 [00:20<00:00, 347.88 examples/s]
Map:  97%|█████████▋| 6367/6548 [00:20<00:00, 360.84 examples/s]
Map:  98%|█████████▊| 6404/6548 [00:20<00:00, 360.01 examples/s]
Map:  99%|█████████▊| 6465/6548 [00:20<00:00, 373.49 examples/s]
Map: 100%|█████████▉| 6516/6548 [00:20<00:00, 357.94 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 312.73 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 321.77 examples/s]
Map:   8%|▊         | 73/903 [00:00<00:02, 346.53 examples/s]
Map:  14%|█▎        | 122/903 [00:00<00:02, 331.90 examples/s]
Map:  18%|█▊        | 166/903 [00:00<00:02, 366.59 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 384.33 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 389.09 examples/s]
Map:  34%|███▍      | 309/903 [00:00<00:01, 372.07 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 322.70 examples/s]
Map:  45%|████▌     | 409/903 [00:01<00:01, 302.13 examples/s]
Map:  50%|████▉     | 451/903 [00:01<00:01, 294.41 examples/s]
Map:  54%|█████▍    | 486/903 [00:01<00:01, 296.18 examples/s]
Map:  59%|█████▉    | 536/903 [00:01<00:01, 336.07 examples/s]
Map:  64%|██████▍   | 577/903 [00:01<00:00, 353.50 examples/s]
Map:  68%|██████▊   | 618/903 [00:01<00:00, 366.08 examples/s]
Map:  73%|███████▎  | 658/903 [00:01<00:00, 372.63 examples/s]
Map:  79%|███████▉  | 716/903 [00:02<00:00, 368.73 examples/s]
Map:  85%|████████▍ | 766/903 [00:02<00:00, 393.83 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 385.63 examples/s]
Map:  96%|█████████▋| 871/903 [00:02<00:00, 399.69 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 323.61 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 298.99 examples/s]
Map:   4%|▍         | 82/1882 [00:00<00:04, 371.32 examples/s]
Map:   7%|▋         | 128/1882 [00:00<00:05, 323.55 examples/s]
Map:   9%|▉         | 173/1882 [00:00<00:04, 360.36 examples/s]
Map:  12%|█▏        | 231/1882 [00:00<00:04, 367.19 examples/s]
Map:  15%|█▍        | 274/1882 [00:00<00:04, 381.23 examples/s]
Map:  18%|█▊        | 331/1882 [00:00<00:04, 372.58 examples/s]
Map:  20%|██        | 379/1882 [00:01<00:04, 314.13 examples/s]
Map:  22%|██▏       | 421/1882 [00:01<00:04, 300.00 examples/s]
Map:  24%|██▍       | 454/1882 [00:01<00:04, 303.03 examples/s]
Map:  27%|██▋       | 500/1882 [00:01<00:04, 329.48 examples/s]
Map:  29%|██▉       | 552/1882 [00:01<00:04, 319.85 examples/s]
Map:  32%|███▏      | 598/1882 [00:01<00:03, 342.31 examples/s]
Map:  35%|███▍      | 652/1882 [00:01<00:03, 389.89 examples/s]
Map:  38%|███▊      | 706/1882 [00:02<00:03, 374.94 examples/s]
Map:  40%|███▉      | 746/1882 [00:02<00:02, 379.16 examples/s]
Map:  42%|████▏     | 793/1882 [00:02<00:03, 348.55 examples/s]
Map:  45%|████▌     | 849/1882 [00:02<00:02, 355.39 examples/s]
Map:  47%|████▋     | 891/1882 [00:02<00:02, 366.70 examples/s]
Map:  49%|████▉     | 931/1882 [00:02<00:02, 365.11 examples/s]
Map:  52%|█████▏    | 981/1882 [00:02<00:02, 397.79 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 250.43 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 262.63 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 273.24 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 281.99 examples/s]
Map:  63%|██████▎   | 1177/1882 [00:03<00:02, 275.71 examples/s]
Map:  65%|██████▌   | 1228/1882 [00:03<00:02, 293.68 examples/s]
Map:  67%|██████▋   | 1264/1882 [00:03<00:02, 306.56 examples/s]
Map:  69%|██████▉   | 1307/1882 [00:03<00:01, 330.74 examples/s]
Map:  72%|███████▏  | 1347/1882 [00:04<00:01, 343.11 examples/s]
Map:  74%|███████▍  | 1397/1882 [00:04<00:01, 333.27 examples/s]
Map:  77%|███████▋  | 1457/1882 [00:04<00:01, 305.95 examples/s]
Map:  79%|███████▉  | 1493/1882 [00:04<00:01, 282.70 examples/s]
Map:  81%|████████  | 1524/1882 [00:04<00:01, 273.91 examples/s]
Map:  83%|████████▎ | 1558/1882 [00:04<00:01, 287.51 examples/s]
Map:  85%|████████▌ | 1607/1882 [00:04<00:00, 334.24 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 322.00 examples/s]
Map:  91%|█████████ | 1710/1882 [00:05<00:00, 304.87 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 264.73 examples/s]
Map:  95%|█████████▍| 1781/1882 [00:05<00:00, 266.78 examples/s]
Map:  97%|█████████▋| 1824/1882 [00:05<00:00, 298.14 examples/s]
Map:  99%|█████████▉| 1867/1882 [00:05<00:00, 329.02 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 309.70 examples/s]
10/12/2024 10:01:24 - INFO - __main__ -     ***** Testing *****
10/12/2024 10:01:24 - INFO - __main__ -     Batch size = 8
10/12/2024 10:01:24 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 10:01:25 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 10:01:25 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 10:01:26 - INFO - knnlm -   Reading datastore took 0.932528018951416 s
10/12/2024 10:01:27 - INFO - knnlm -   Moving index to GPU took 0.9120430946350098 s
10/12/2024 10:01:27 - INFO - __main__ -   ******************************break-into
10/12/2024 10:01:27 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 10:01:27 - INFO - __main__ -     Num examples = 236
10/12/2024 10:01:27 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:05,  7.68s/it]
test ppl:   1%|          | 2/236 [00:09<16:44,  4.29s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:42,  3.02s/it]
test ppl:   2%|▏         | 4/236 [00:12<09:34,  2.47s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:07,  3.67s/it]
test ppl:   3%|▎         | 6/236 [00:20<12:15,  3.20s/it]
test ppl:   3%|▎         | 7/236 [00:23<11:20,  2.97s/it]
test ppl:   3%|▎         | 8/236 [00:27<12:56,  3.40s/it]
test ppl:   4%|▍         | 9/236 [00:34<17:26,  4.61s/it]
test ppl:   4%|▍         | 10/236 [00:38<16:37,  4.41s/it]
test ppl:   5%|▍         | 11/236 [00:41<14:47,  3.95s/it]
test ppl:   5%|▌         | 12/236 [00:49<18:29,  4.95s/it]
test ppl:   6%|▌         | 13/236 [00:56<21:00,  5.65s/it]
test ppl:   6%|▌         | 14/236 [01:03<22:44,  6.15s/it]
test ppl:   6%|▋         | 15/236 [01:06<19:06,  5.19s/it]
test ppl:   7%|▋         | 16/236 [01:08<15:47,  4.31s/it]
test ppl:   7%|▋         | 17/236 [01:13<15:52,  4.35s/it]
test ppl:   8%|▊         | 18/236 [01:15<13:18,  3.66s/it]
test ppl:   8%|▊         | 19/236 [01:20<15:14,  4.21s/it]
test ppl:   8%|▊         | 20/236 [01:22<12:57,  3.60s/it]
test ppl:   9%|▉         | 21/236 [01:25<12:04,  3.37s/it]
test ppl:   9%|▉         | 22/236 [01:33<16:10,  4.53s/it]
test ppl:  10%|▉         | 23/236 [01:36<14:33,  4.10s/it]
test ppl:  10%|█         | 24/236 [01:39<13:13,  3.74s/it]
test ppl:  11%|█         | 25/236 [01:41<11:35,  3.30s/it]
test ppl:  11%|█         | 26/236 [01:48<15:46,  4.51s/it]
test ppl:  11%|█▏        | 27/236 [01:53<16:21,  4.69s/it]
test ppl:  12%|█▏        | 28/236 [01:55<12:54,  3.73s/it]
test ppl:  12%|█▏        | 29/236 [01:58<11:58,  3.47s/it]
test ppl:  13%|█▎        | 30/236 [01:59<10:15,  2.99s/it]
test ppl:  13%|█▎        | 31/236 [02:02<09:38,  2.82s/it]
test ppl:  14%|█▎        | 32/236 [02:05<10:19,  3.04s/it]
test ppl:  14%|█▍        | 33/236 [02:13<14:34,  4.31s/it]
test ppl:  14%|█▍        | 34/236 [02:18<15:07,  4.49s/it]
test ppl:  15%|█▍        | 35/236 [02:21<13:39,  4.08s/it]
test ppl:  15%|█▌        | 36/236 [02:28<16:45,  5.03s/it]
test ppl:  16%|█▌        | 37/236 [02:35<18:54,  5.70s/it]
test ppl:  16%|█▌        | 38/236 [02:38<15:40,  4.75s/it]
test ppl:  17%|█▋        | 39/236 [02:40<12:43,  3.88s/it]
test ppl:  17%|█▋        | 40/236 [02:43<12:06,  3.71s/it]
test ppl:  17%|█▋        | 41/236 [02:46<11:26,  3.52s/it]
test ppl:  18%|█▊        | 42/236 [02:53<15:04,  4.66s/it]
test ppl:  18%|█▊        | 43/236 [03:01<17:32,  5.45s/it]
test ppl:  19%|█▊        | 44/236 [03:03<14:32,  4.54s/it]
test ppl:  19%|█▉        | 45/236 [03:06<12:27,  3.92s/it]
test ppl:  19%|█▉        | 46/236 [03:12<14:46,  4.67s/it]
test ppl:  20%|█▉        | 47/236 [03:19<17:13,  5.47s/it]
test ppl:  20%|██        | 48/236 [03:27<18:49,  6.01s/it]
test ppl:  21%|██        | 49/236 [03:33<19:04,  6.12s/it]
test ppl:  21%|██        | 50/236 [03:40<20:11,  6.51s/it]
test ppl:  22%|██▏       | 51/236 [03:48<20:50,  6.76s/it]
test ppl:  22%|██▏       | 52/236 [03:55<21:14,  6.93s/it]
test ppl:  22%|██▏       | 53/236 [04:02<20:54,  6.86s/it]
test ppl:  23%|██▎       | 54/236 [04:04<16:16,  5.36s/it]
test ppl:  23%|██▎       | 55/236 [04:11<17:36,  5.84s/it]
test ppl:  24%|██▎       | 56/236 [04:15<16:01,  5.34s/it]
test ppl:  24%|██▍       | 57/236 [04:18<13:58,  4.68s/it]
test ppl:  25%|██▍       | 58/236 [04:21<12:06,  4.08s/it]
test ppl:  25%|██▌       | 59/236 [04:28<14:51,  5.04s/it]
test ppl:  25%|██▌       | 60/236 [04:32<13:43,  4.68s/it]
test ppl:  26%|██▌       | 61/236 [04:39<15:53,  5.45s/it]
test ppl:  26%|██▋       | 62/236 [04:44<15:28,  5.34s/it]
test ppl:  27%|██▋       | 63/236 [04:47<13:23,  4.65s/it]
test ppl:  27%|██▋       | 64/236 [04:49<10:54,  3.81s/it]
test ppl:  28%|██▊       | 65/236 [04:50<08:58,  3.15s/it]
test ppl:  28%|██▊       | 66/236 [04:54<09:21,  3.30s/it]
test ppl:  28%|██▊       | 67/236 [04:57<08:56,  3.17s/it]
test ppl:  29%|██▉       | 68/236 [05:04<12:19,  4.40s/it]
test ppl:  29%|██▉       | 69/236 [05:12<14:41,  5.28s/it]
test ppl:  30%|██▉       | 70/236 [05:14<11:51,  4.28s/it]
test ppl:  30%|███       | 71/236 [05:18<11:55,  4.33s/it]
test ppl:  31%|███       | 72/236 [05:23<12:08,  4.44s/it]
test ppl:  31%|███       | 73/236 [05:28<12:20,  4.54s/it]
test ppl:  31%|███▏      | 74/236 [05:29<10:05,  3.74s/it]
test ppl:  32%|███▏      | 75/236 [05:37<12:52,  4.80s/it]
test ppl:  32%|███▏      | 76/236 [05:41<12:21,  4.63s/it]
test ppl:  33%|███▎      | 77/236 [05:44<10:48,  4.08s/it]
test ppl:  33%|███▎      | 78/236 [05:46<09:04,  3.45s/it]
test ppl:  33%|███▎      | 79/236 [05:52<11:10,  4.27s/it]
test ppl:  34%|███▍      | 80/236 [05:54<09:47,  3.77s/it]
test ppl:  34%|███▍      | 81/236 [06:02<12:25,  4.81s/it]
test ppl:  35%|███▍      | 82/236 [06:09<14:15,  5.56s/it]
test ppl:  35%|███▌      | 83/236 [06:11<11:47,  4.62s/it]
test ppl:  36%|███▌      | 84/236 [06:14<09:58,  3.93s/it]
test ppl:  36%|███▌      | 85/236 [06:19<10:46,  4.28s/it]
test ppl:  36%|███▋      | 86/236 [06:22<09:30,  3.81s/it]
test ppl:  37%|███▋      | 87/236 [06:24<08:32,  3.44s/it]
test ppl:  37%|███▋      | 88/236 [06:31<11:18,  4.59s/it]
test ppl:  38%|███▊      | 89/236 [06:34<09:38,  3.94s/it]
test ppl:  38%|███▊      | 90/236 [06:41<11:46,  4.84s/it]
test ppl:  39%|███▊      | 91/236 [06:47<12:25,  5.14s/it]
test ppl:  39%|███▉      | 92/236 [06:49<10:39,  4.44s/it]
test ppl:  39%|███▉      | 93/236 [06:55<11:34,  4.86s/it]
test ppl:  40%|███▉      | 94/236 [07:01<12:12,  5.16s/it]
test ppl:  40%|████      | 95/236 [07:03<10:02,  4.28s/it]
test ppl:  41%|████      | 96/236 [07:06<09:03,  3.88s/it]
test ppl:  41%|████      | 97/236 [07:12<10:21,  4.47s/it]
test ppl:  42%|████▏     | 98/236 [07:18<11:15,  4.90s/it]
test ppl:  42%|████▏     | 99/236 [07:24<11:51,  5.19s/it]
test ppl:  42%|████▏     | 100/236 [07:25<09:08,  4.03s/it]
test ppl:  43%|████▎     | 101/236 [07:31<10:07,  4.50s/it]
test ppl:  43%|████▎     | 102/236 [07:34<09:18,  4.16s/it]
test ppl:  44%|████▎     | 103/236 [07:36<07:51,  3.54s/it]
test ppl:  44%|████▍     | 104/236 [07:41<08:15,  3.76s/it]
test ppl:  44%|████▍     | 105/236 [07:44<08:18,  3.80s/it]
test ppl:  45%|████▍     | 106/236 [07:50<09:16,  4.28s/it]
test ppl:  45%|████▌     | 107/236 [07:52<07:45,  3.61s/it]
test ppl:  46%|████▌     | 108/236 [07:58<09:02,  4.23s/it]
test ppl:  46%|████▌     | 109/236 [08:02<09:14,  4.37s/it]
test ppl:  47%|████▋     | 110/236 [08:04<07:24,  3.53s/it]
test ppl:  47%|████▋     | 111/236 [08:08<07:36,  3.65s/it]
test ppl:  47%|████▋     | 112/236 [08:12<07:53,  3.82s/it]
test ppl:  48%|████▊     | 113/236 [08:14<06:33,  3.20s/it]
test ppl:  48%|████▊     | 114/236 [08:17<06:35,  3.24s/it]
test ppl:  49%|████▊     | 115/236 [08:23<08:06,  4.02s/it]
test ppl:  49%|████▉     | 116/236 [08:28<08:55,  4.46s/it]
test ppl:  50%|████▉     | 117/236 [08:30<07:18,  3.69s/it]
test ppl:  50%|█████     | 118/236 [08:35<07:40,  3.90s/it]
test ppl:  50%|█████     | 119/236 [08:38<07:15,  3.73s/it]
test ppl:  51%|█████     | 120/236 [08:40<05:55,  3.06s/it]
test ppl:  51%|█████▏    | 121/236 [08:41<05:10,  2.70s/it]
test ppl:  52%|█████▏    | 122/236 [08:46<06:18,  3.32s/it]
test ppl:  52%|█████▏    | 123/236 [08:48<05:35,  2.97s/it]
test ppl:  53%|█████▎    | 124/236 [08:51<05:25,  2.91s/it]
test ppl:  53%|█████▎    | 125/236 [08:54<05:08,  2.78s/it]
test ppl:  53%|█████▎    | 126/236 [08:58<06:16,  3.42s/it]
test ppl:  54%|█████▍    | 127/236 [09:00<05:22,  2.96s/it]
test ppl:  54%|█████▍    | 128/236 [09:03<04:55,  2.74s/it]
test ppl:  55%|█████▍    | 129/236 [09:05<04:59,  2.80s/it]
test ppl:  55%|█████▌    | 130/236 [09:09<05:03,  2.87s/it]
test ppl:  56%|█████▌    | 131/236 [09:14<06:35,  3.76s/it]
test ppl:  56%|█████▌    | 132/236 [09:17<05:50,  3.37s/it]
test ppl:  56%|█████▋    | 133/236 [09:21<06:03,  3.53s/it]
test ppl:  57%|█████▋    | 134/236 [09:25<06:10,  3.63s/it]
test ppl:  57%|█████▋    | 135/236 [09:29<06:44,  4.00s/it]
test ppl:  58%|█████▊    | 136/236 [09:31<05:16,  3.16s/it]
test ppl:  58%|█████▊    | 137/236 [09:37<06:33,  3.97s/it]
test ppl:  58%|█████▊    | 138/236 [09:40<06:06,  3.74s/it]
test ppl:  59%|█████▉    | 139/236 [09:42<05:28,  3.38s/it]
test ppl:  59%|█████▉    | 140/236 [09:44<04:47,  3.00s/it]
test ppl:  60%|█████▉    | 141/236 [09:47<04:41,  2.96s/it]
test ppl:  60%|██████    | 142/236 [09:49<04:14,  2.71s/it]
test ppl:  61%|██████    | 143/236 [09:55<05:39,  3.65s/it]
test ppl:  61%|██████    | 144/236 [09:58<05:10,  3.37s/it]
test ppl:  61%|██████▏   | 145/236 [10:03<06:04,  4.01s/it]
test ppl:  62%|██████▏   | 146/236 [10:08<06:13,  4.15s/it]
test ppl:  62%|██████▏   | 147/236 [10:14<06:55,  4.67s/it]
test ppl:  63%|██████▎   | 148/236 [10:20<07:25,  5.06s/it]
test ppl:  63%|██████▎   | 149/236 [10:23<06:35,  4.55s/it]
test ppl:  64%|██████▎   | 150/236 [10:27<06:18,  4.40s/it]
test ppl:  64%|██████▍   | 151/236 [10:33<06:51,  4.85s/it]
test ppl:  64%|██████▍   | 152/236 [10:39<07:12,  5.15s/it]
test ppl:  65%|██████▍   | 153/236 [10:45<07:24,  5.36s/it]
test ppl:  65%|██████▌   | 154/236 [10:47<06:09,  4.51s/it]
test ppl:  66%|██████▌   | 155/236 [10:50<05:20,  3.96s/it]
test ppl:  66%|██████▌   | 156/236 [10:52<04:33,  3.42s/it]
test ppl:  67%|██████▋   | 157/236 [10:54<04:01,  3.06s/it]
test ppl:  67%|██████▋   | 158/236 [11:00<05:04,  3.91s/it]
test ppl:  67%|██████▋   | 159/236 [11:06<05:45,  4.49s/it]
test ppl:  68%|██████▊   | 160/236 [11:07<04:25,  3.50s/it]
test ppl:  68%|██████▊   | 161/236 [11:09<03:34,  2.86s/it]
test ppl:  69%|██████▊   | 162/236 [11:12<03:31,  2.86s/it]
test ppl:  69%|██████▉   | 163/236 [11:14<03:21,  2.77s/it]
test ppl:  69%|██████▉   | 164/236 [11:20<04:27,  3.71s/it]
test ppl:  70%|██████▉   | 165/236 [11:24<04:35,  3.88s/it]
test ppl:  70%|███████   | 166/236 [11:26<03:41,  3.16s/it]
test ppl:  71%|███████   | 167/236 [11:27<03:03,  2.65s/it]
test ppl:  71%|███████   | 168/236 [11:31<03:33,  3.13s/it]
test ppl:  72%|███████▏  | 169/236 [11:37<04:15,  3.82s/it]
test ppl:  72%|███████▏  | 170/236 [11:43<04:53,  4.44s/it]
test ppl:  72%|███████▏  | 171/236 [11:44<03:48,  3.51s/it]
test ppl:  73%|███████▎  | 172/236 [11:50<04:30,  4.22s/it]
test ppl:  73%|███████▎  | 173/236 [11:54<04:15,  4.05s/it]
test ppl:  74%|███████▎  | 174/236 [11:58<04:08,  4.00s/it]
test ppl:  74%|███████▍  | 175/236 [11:59<03:24,  3.35s/it]
test ppl:  75%|███████▍  | 176/236 [12:04<03:48,  3.80s/it]
test ppl:  75%|███████▌  | 177/236 [12:10<04:21,  4.43s/it]
test ppl:  75%|███████▌  | 178/236 [12:16<04:42,  4.87s/it]
test ppl:  76%|███████▌  | 179/236 [12:22<04:54,  5.17s/it]
test ppl:  76%|███████▋  | 180/236 [12:25<04:20,  4.65s/it]
test ppl:  77%|███████▋  | 181/236 [12:31<04:35,  5.01s/it]
test ppl:  77%|███████▋  | 182/236 [12:33<03:40,  4.08s/it]
test ppl:  78%|███████▊  | 183/236 [12:35<03:07,  3.54s/it]
test ppl:  78%|███████▊  | 184/236 [12:37<02:31,  2.91s/it]
test ppl:  78%|███████▊  | 185/236 [12:41<02:41,  3.17s/it]
test ppl:  79%|███████▉  | 186/236 [12:46<03:18,  3.98s/it]
test ppl:  79%|███████▉  | 187/236 [12:52<03:43,  4.57s/it]
test ppl:  80%|███████▉  | 188/236 [12:58<03:58,  4.97s/it]
test ppl:  80%|████████  | 189/236 [13:04<04:06,  5.24s/it]
test ppl:  81%|████████  | 190/236 [13:08<03:39,  4.77s/it]
test ppl:  81%|████████  | 191/236 [13:12<03:28,  4.64s/it]
test ppl:  81%|████████▏ | 192/236 [13:15<02:57,  4.04s/it]
test ppl:  82%|████████▏ | 193/236 [13:21<03:17,  4.59s/it]
test ppl:  82%|████████▏ | 194/236 [13:23<02:47,  4.00s/it]
test ppl:  83%|████████▎ | 195/236 [13:26<02:32,  3.71s/it]
test ppl:  83%|████████▎ | 196/236 [13:28<02:08,  3.21s/it]
test ppl:  83%|████████▎ | 197/236 [13:30<01:52,  2.89s/it]
test ppl:  84%|████████▍ | 198/236 [13:36<02:23,  3.78s/it]
test ppl:  84%|████████▍ | 199/236 [13:39<02:07,  3.46s/it]
test ppl:  85%|████████▍ | 200/236 [13:45<02:30,  4.18s/it]
test ppl:  85%|████████▌ | 201/236 [13:47<02:03,  3.53s/it]
test ppl:  86%|████████▌ | 202/236 [13:52<02:10,  3.85s/it]
test ppl:  86%|████████▌ | 203/236 [13:57<02:27,  4.46s/it]
test ppl:  86%|████████▋ | 204/236 [13:59<01:59,  3.72s/it]
test ppl:  87%|████████▋ | 205/236 [14:05<02:15,  4.38s/it]
test ppl:  87%|████████▋ | 206/236 [14:09<02:01,  4.06s/it]
test ppl:  88%|████████▊ | 207/236 [14:15<02:13,  4.60s/it]
test ppl:  88%|████████▊ | 208/236 [14:18<01:56,  4.17s/it]
test ppl:  89%|████████▊ | 209/236 [14:24<02:06,  4.70s/it]
test ppl:  89%|████████▉ | 210/236 [14:26<01:43,  3.99s/it]
test ppl:  89%|████████▉ | 211/236 [14:31<01:45,  4.24s/it]
test ppl:  90%|████████▉ | 212/236 [14:36<01:48,  4.53s/it]
test ppl:  90%|█████████ | 213/236 [14:42<01:53,  4.93s/it]
test ppl:  91%|█████████ | 214/236 [14:44<01:26,  3.95s/it]
test ppl:  91%|█████████ | 215/236 [14:49<01:35,  4.53s/it]
test ppl:  92%|█████████▏| 216/236 [14:51<01:13,  3.67s/it]
test ppl:  92%|█████████▏| 217/236 [14:57<01:22,  4.36s/it]
test ppl:  92%|█████████▏| 218/236 [14:59<01:05,  3.63s/it]
test ppl:  93%|█████████▎| 219/236 [15:05<01:13,  4.32s/it]
test ppl:  93%|█████████▎| 220/236 [15:11<01:16,  4.79s/it]
test ppl:  94%|█████████▎| 221/236 [15:15<01:08,  4.54s/it]
test ppl:  94%|█████████▍| 222/236 [15:21<01:09,  4.95s/it]
test ppl:  94%|█████████▍| 223/236 [15:27<01:07,  5.23s/it]
test ppl:  95%|█████████▍| 224/236 [15:28<00:48,  4.05s/it]
test ppl:  95%|█████████▌| 225/236 [15:33<00:48,  4.45s/it]
test ppl:  96%|█████████▌| 226/236 [15:37<00:41,  4.17s/it]
test ppl:  96%|█████████▌| 227/236 [15:40<00:34,  3.78s/it]
test ppl:  97%|█████████▋| 228/236 [15:41<00:25,  3.21s/it]
test ppl:  97%|█████████▋| 229/236 [15:47<00:28,  4.00s/it]
test ppl:  97%|█████████▋| 230/236 [15:51<00:23,  3.85s/it]
test ppl:  98%|█████████▊| 231/236 [15:54<00:18,  3.70s/it]
test ppl:  98%|█████████▊| 232/236 [15:56<00:12,  3.11s/it]
test ppl:  99%|█████████▊| 233/236 [16:00<00:10,  3.40s/it]
test ppl:  99%|█████████▉| 234/236 [16:01<00:05,  2.74s/it]
test ppl: 100%|█████████▉| 235/236 [16:07<00:03,  3.68s/it]
test ppl: 100%|██████████| 236/236 [16:08<00:00,  2.77s/it]
test ppl: 100%|██████████| 236/236 [16:08<00:00,  4.10s/it]
10/12/2024 10:17:35 - INFO - __main__ -    em: 0.2109
10/12/2024 10:17:35 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.2 20:  em: 0.2109

--------------------------------------------------------------------------------
Running experiment with knn_temp=20, lmbda=0.4, k=16
2024-10-12 10:17:42.440169: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 10:17:42.459715: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 10:17:42.481583: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 10:17:42.488281: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 10:17:42.504172: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 10:17:43.501708: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 10:17:44 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.4, knn_temp=20, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 10:17:44 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:35:54,  2.20it/s]
Adding feature api:   4%|▍         | 7314/187062 [00:00<00:10, 17500.31it/s]
Adding feature api:   8%|▊         | 15739/187062 [00:00<00:04, 34504.13it/s]
Adding feature api:  13%|█▎        | 24213/187062 [00:00<00:03, 47906.24it/s]
Adding feature api:  17%|█▋        | 32465/187062 [00:00<00:02, 57457.68it/s]
Adding feature api:  22%|██▏       | 40955/187062 [00:00<00:02, 65216.21it/s]
Adding feature api:  26%|██▋       | 49486/187062 [00:01<00:01, 70996.94it/s]
Adding feature api:  31%|███       | 58046/187062 [00:01<00:01, 75247.86it/s]
Adding feature api:  36%|███▌      | 66468/187062 [00:01<00:01, 77881.95it/s]
Adding feature api:  40%|███▉      | 74754/187062 [00:01<00:01, 79018.96it/s]
Adding feature api:  44%|████▍     | 83222/187062 [00:01<00:01, 80692.40it/s]
Adding feature api:  49%|████▉     | 91704/187062 [00:01<00:01, 81916.71it/s]
Adding feature api:  54%|█████▎    | 100225/187062 [00:01<00:01, 82896.64it/s]
Adding feature api:  58%|█████▊    | 108638/187062 [00:01<00:00, 82747.24it/s]
Adding feature api:  63%|██████▎   | 117121/187062 [00:01<00:00, 83363.93it/s]
Adding feature api:  67%|██████▋   | 125614/187062 [00:01<00:00, 83829.24it/s]
Adding feature api:  72%|███████▏  | 134087/187062 [00:02<00:00, 84098.00it/s]
Adding feature api:  76%|███████▌  | 142528/187062 [00:02<00:00, 83534.74it/s]
Adding feature api:  81%|████████  | 151057/187062 [00:02<00:00, 84054.63it/s]
Adding feature api:  85%|████████▌ | 159493/187062 [00:02<00:00, 84143.58it/s]
Adding feature api:  90%|████████▉ | 167965/187062 [00:02<00:00, 84315.24it/s]
Adding feature api:  94%|█████████▍| 176405/187062 [00:02<00:00, 83741.63it/s]
Adding feature api:  99%|█████████▉| 184786/187062 [00:02<00:00, 56393.22it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64645.54it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:22:13,  2.22it/s]
Adding feature datatype:   4%|▍         | 7102/187062 [00:00<00:10, 17118.75it/s]
Adding feature datatype:   8%|▊         | 15236/187062 [00:00<00:05, 33568.10it/s]
Adding feature datatype:  13%|█▎        | 23423/187062 [00:00<00:03, 46506.99it/s]
Adding feature datatype:  17%|█▋        | 31270/187062 [00:00<00:02, 55352.56it/s]
Adding feature datatype:  21%|██        | 39472/187062 [00:00<00:02, 62906.79it/s]
Adding feature datatype:  26%|██▌       | 47737/187062 [00:01<00:02, 68593.88it/s]
Adding feature datatype:  30%|██▉       | 55876/187062 [00:01<00:01, 72324.63it/s]
Adding feature datatype:  34%|███▍      | 64082/187062 [00:01<00:01, 75184.85it/s]
Adding feature datatype:  39%|███▊      | 72316/187062 [00:01<00:01, 77298.57it/s]
Adding feature datatype:  43%|████▎     | 80383/187062 [00:01<00:01, 77758.79it/s]
Adding feature datatype:  47%|████▋     | 88610/187062 [00:01<00:01, 79094.78it/s]
Adding feature datatype:  52%|█████▏    | 96831/187062 [00:01<00:01, 80021.03it/s]
Adding feature datatype:  56%|█████▌    | 105063/187062 [00:01<00:01, 80706.11it/s]
Adding feature datatype:  61%|██████    | 113293/187062 [00:01<00:00, 81179.29it/s]
Adding feature datatype:  65%|██████▍   | 121470/187062 [00:01<00:00, 80337.57it/s]
Adding feature datatype:  69%|██████▉   | 129667/187062 [00:02<00:00, 80819.80it/s]
Adding feature datatype:  74%|███████▎  | 137933/187062 [00:02<00:00, 81366.76it/s]
Adding feature datatype:  78%|███████▊  | 146175/187062 [00:02<00:00, 81677.64it/s]
Adding feature datatype:  83%|████████▎ | 154407/187062 [00:02<00:00, 81868.07it/s]
Adding feature datatype:  87%|████████▋ | 162605/187062 [00:02<00:00, 81892.76it/s]
Adding feature datatype:  91%|█████████▏| 170802/187062 [00:02<00:00, 81180.73it/s]
Adding feature datatype:  96%|█████████▌| 178927/187062 [00:02<00:00, 75051.43it/s]
Adding feature datatype: 100%|█████████▉| 186526/187062 [00:02<00:00, 51592.51it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63047.20it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:11:02,  2.24it/s]
Adding feature literal:   4%|▍         | 7147/187062 [00:00<00:10, 17332.27it/s]
Adding feature literal:   8%|▊         | 15284/187062 [00:00<00:05, 33808.68it/s]
Adding feature literal:  13%|█▎        | 23538/187062 [00:00<00:03, 46905.92it/s]
Adding feature literal:  17%|█▋        | 31708/187062 [00:00<00:02, 56557.14it/s]
Adding feature literal:  21%|██▏       | 39947/187062 [00:00<00:02, 63887.60it/s]
Adding feature literal:  26%|██▌       | 48183/187062 [00:01<00:02, 69214.82it/s]
Adding feature literal:  30%|███       | 56449/187062 [00:01<00:01, 73138.14it/s]
Adding feature literal:  35%|███▍      | 64651/187062 [00:01<00:01, 75749.19it/s]
Adding feature literal:  39%|███▉      | 72699/187062 [00:01<00:01, 76626.49it/s]
Adding feature literal:  43%|████▎     | 80691/187062 [00:01<00:01, 76077.07it/s]
Adding feature literal:  48%|████▊     | 88909/187062 [00:01<00:01, 77863.07it/s]
Adding feature literal:  52%|█████▏    | 97087/187062 [00:01<00:01, 79016.26it/s]
Adding feature literal:  56%|█████▋    | 105352/187062 [00:01<00:01, 80092.34it/s]
Adding feature literal:  61%|██████    | 113617/187062 [00:01<00:00, 80850.31it/s]
Adding feature literal:  65%|██████▌   | 121892/187062 [00:01<00:00, 81416.26it/s]
Adding feature literal:  70%|██████▉   | 130083/187062 [00:02<00:00, 81563.22it/s]
Adding feature literal:  74%|███████▍  | 138306/187062 [00:02<00:00, 81761.18it/s]
Adding feature literal:  78%|███████▊  | 146504/187062 [00:02<00:00, 81756.05it/s]
Adding feature literal:  83%|████████▎ | 154738/187062 [00:02<00:00, 81927.98it/s]
Adding feature literal:  87%|████████▋ | 162984/187062 [00:02<00:00, 82086.61it/s]
Adding feature literal:  92%|█████████▏| 171200/187062 [00:02<00:00, 82100.30it/s]
Adding feature literal:  96%|█████████▌| 179416/187062 [00:02<00:00, 72823.48it/s]
Adding feature literal: 100%|█████████▉| 186896/187062 [00:02<00:00, 51499.31it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63235.85it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:09:52,  2.24it/s]
Adding feature operator:   4%|▍         | 7213/187062 [00:00<00:10, 17503.48it/s]
Adding feature operator:   8%|▊         | 15471/187062 [00:00<00:05, 34255.36it/s]
Adding feature operator:  13%|█▎        | 23730/187062 [00:00<00:03, 47250.58it/s]
Adding feature operator:  17%|█▋        | 32020/187062 [00:00<00:02, 57141.93it/s]
Adding feature operator:  22%|██▏       | 40345/187062 [00:00<00:02, 64551.70it/s]
Adding feature operator:  26%|██▌       | 48673/187062 [00:01<00:01, 69952.70it/s]
Adding feature operator:  30%|███       | 56953/187062 [00:01<00:01, 73699.39it/s]
Adding feature operator:  35%|███▍      | 65232/187062 [00:01<00:01, 76373.23it/s]
Adding feature operator:  39%|███▉      | 73548/187062 [00:01<00:01, 78380.43it/s]
Adding feature operator:  44%|████▍     | 81886/187062 [00:01<00:01, 79864.27it/s]
Adding feature operator:  48%|████▊     | 90209/187062 [00:01<00:01, 80863.93it/s]
Adding feature operator:  53%|█████▎    | 98554/187062 [00:01<00:01, 81633.91it/s]
Adding feature operator:  57%|█████▋    | 106874/187062 [00:01<00:00, 82101.03it/s]
Adding feature operator:  62%|██████▏   | 115168/187062 [00:01<00:00, 82226.82it/s]
Adding feature operator:  66%|██████▌   | 123513/187062 [00:01<00:00, 82590.27it/s]
Adding feature operator:  70%|███████   | 131875/187062 [00:02<00:00, 82896.49it/s]
Adding feature operator:  75%|███████▍  | 140196/187062 [00:02<00:00, 82987.71it/s]
Adding feature operator:  79%|███████▉  | 148534/187062 [00:02<00:00, 83102.93it/s]
Adding feature operator:  84%|████████▍ | 156904/187062 [00:02<00:00, 83279.21it/s]
Adding feature operator:  88%|████████▊ | 165242/187062 [00:02<00:00, 83163.56it/s]
Adding feature operator:  93%|█████████▎| 173568/187062 [00:02<00:00, 83190.99it/s]
Adding feature operator:  97%|█████████▋| 181892/187062 [00:02<00:00, 63453.60it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 64136.49it/s]
[2024-10-12 10:18:28,719] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 10:18:30 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 10:18:30 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 39/6548 [00:00<00:18, 349.07 examples/s]
Map:   1%|▏         | 90/6548 [00:00<00:27, 236.16 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:24, 265.56 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:19, 319.32 examples/s]
Map:   3%|▎         | 225/6548 [00:00<00:17, 363.85 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:17, 361.97 examples/s]
Map:   5%|▌         | 346/6548 [00:01<00:19, 311.53 examples/s]
Map:   6%|▌         | 387/6548 [00:01<00:18, 332.25 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:17, 358.45 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 331.49 examples/s]
Map:   8%|▊         | 535/6548 [00:01<00:16, 353.78 examples/s]
Map:   9%|▉         | 577/6548 [00:01<00:16, 366.14 examples/s]
Map:   9%|▉         | 622/6548 [00:01<00:17, 336.94 examples/s]
Map:  10%|█         | 669/6548 [00:02<00:17, 326.77 examples/s]
Map:  11%|█         | 712/6548 [00:02<00:16, 347.16 examples/s]
Map:  12%|█▏        | 755/6548 [00:02<00:15, 362.91 examples/s]
Map:  12%|█▏        | 808/6548 [00:02<00:14, 404.72 examples/s]
Map:  13%|█▎        | 854/6548 [00:02<00:14, 396.58 examples/s]
Map:  14%|█▍        | 905/6548 [00:02<00:15, 374.68 examples/s]
Map:  15%|█▍        | 954/6548 [00:02<00:16, 346.91 examples/s]
Map:  15%|█▌        | 999/6548 [00:02<00:16, 327.37 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:24, 223.69 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:21, 251.11 examples/s]
Map:  17%|█▋        | 1125/6548 [00:03<00:18, 295.36 examples/s]
Map:  18%|█▊        | 1164/6548 [00:03<00:17, 314.82 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 338.70 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:14, 353.24 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:14, 366.50 examples/s]
Map:  21%|██        | 1345/6548 [00:04<00:17, 290.60 examples/s]
Map:  21%|██        | 1388/6548 [00:04<00:18, 281.54 examples/s]
Map:  22%|██▏       | 1430/6548 [00:04<00:16, 305.55 examples/s]
Map:  23%|██▎       | 1474/6548 [00:04<00:18, 270.85 examples/s]
Map:  23%|██▎       | 1511/6548 [00:04<00:17, 289.31 examples/s]
Map:  24%|██▍       | 1556/6548 [00:04<00:17, 282.11 examples/s]
Map:  24%|██▍       | 1587/6548 [00:04<00:17, 287.26 examples/s]
Map:  25%|██▍       | 1627/6548 [00:05<00:19, 252.35 examples/s]
Map:  25%|██▌       | 1655/6548 [00:05<00:19, 252.26 examples/s]
Map:  26%|██▌       | 1695/6548 [00:05<00:17, 281.53 examples/s]
Map:  26%|██▋       | 1735/6548 [00:05<00:15, 307.45 examples/s]
Map:  27%|██▋       | 1779/6548 [00:05<00:14, 339.31 examples/s]
Map:  28%|██▊       | 1842/6548 [00:05<00:13, 360.66 examples/s]
Map:  29%|██▉       | 1887/6548 [00:05<00:13, 336.42 examples/s]
Map:  29%|██▉       | 1925/6548 [00:06<00:13, 345.41 examples/s]
Map:  30%|███       | 1967/6548 [00:06<00:12, 359.20 examples/s]
Map:  31%|███       | 2010/6548 [00:06<00:19, 228.74 examples/s]
Map:  31%|███▏      | 2061/6548 [00:06<00:17, 249.80 examples/s]
Map:  32%|███▏      | 2102/6548 [00:06<00:15, 278.38 examples/s]
Map:  33%|███▎      | 2139/6548 [00:06<00:17, 256.87 examples/s]
Map:  33%|███▎      | 2182/6548 [00:07<00:16, 261.87 examples/s]
Map:  34%|███▍      | 2214/6548 [00:07<00:16, 268.58 examples/s]
Map:  34%|███▍      | 2254/6548 [00:07<00:16, 265.93 examples/s]
Map:  35%|███▍      | 2282/6548 [00:07<00:16, 260.24 examples/s]
Map:  36%|███▌      | 2330/6548 [00:07<00:13, 309.84 examples/s]
Map:  36%|███▋      | 2382/6548 [00:07<00:13, 313.59 examples/s]
Map:  37%|███▋      | 2422/6548 [00:07<00:12, 333.21 examples/s]
Map:  38%|███▊      | 2472/6548 [00:08<00:12, 314.72 examples/s]
Map:  38%|███▊      | 2512/6548 [00:08<00:12, 333.65 examples/s]
Map:  39%|███▉      | 2555/6548 [00:08<00:11, 352.88 examples/s]
Map:  40%|███▉      | 2601/6548 [00:08<00:10, 378.50 examples/s]
Map:  40%|████      | 2643/6548 [00:08<00:10, 388.84 examples/s]
Map:  41%|████      | 2700/6548 [00:08<00:10, 372.16 examples/s]
Map:  42%|████▏     | 2758/6548 [00:08<00:10, 366.71 examples/s]
Map:  43%|████▎     | 2810/6548 [00:08<00:10, 355.89 examples/s]
Map:  44%|████▎     | 2860/6548 [00:09<00:12, 288.41 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 293.44 examples/s]
Map:  45%|████▌     | 2950/6548 [00:09<00:12, 295.68 examples/s]
Map:  46%|████▌     | 2981/6548 [00:09<00:12, 296.08 examples/s]
Map:  46%|████▌     | 3012/6548 [00:10<00:22, 156.41 examples/s]
Map:  46%|████▋     | 3044/6548 [00:10<00:19, 179.06 examples/s]
Map:  47%|████▋     | 3071/6548 [00:10<00:17, 194.09 examples/s]
Map:  47%|████▋     | 3097/6548 [00:10<00:16, 206.03 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:14, 242.65 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:13, 249.77 examples/s]
Map:  49%|████▉     | 3201/6548 [00:10<00:12, 257.66 examples/s]
Map:  49%|████▉     | 3236/6548 [00:10<00:13, 247.79 examples/s]
Map:  50%|████▉     | 3270/6548 [00:10<00:12, 267.32 examples/s]
Map:  50%|█████     | 3301/6548 [00:11<00:11, 275.21 examples/s]
Map:  51%|█████     | 3342/6548 [00:11<00:10, 307.86 examples/s]
Map:  52%|█████▏    | 3388/6548 [00:11<00:10, 291.24 examples/s]
Map:  52%|█████▏    | 3420/6548 [00:11<00:10, 286.46 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 273.24 examples/s]
Map:  53%|█████▎    | 3492/6548 [00:11<00:11, 255.41 examples/s]
Map:  54%|█████▍    | 3543/6548 [00:11<00:09, 309.15 examples/s]
Map:  55%|█████▍    | 3591/6548 [00:11<00:08, 345.66 examples/s]
Map:  56%|█████▌    | 3637/6548 [00:12<00:07, 373.12 examples/s]
Map:  56%|█████▋    | 3697/6548 [00:12<00:07, 376.69 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:12<00:07, 386.06 examples/s]
Map:  58%|█████▊    | 3799/6548 [00:12<00:07, 387.31 examples/s]
Map:  59%|█████▊    | 3841/6548 [00:12<00:08, 337.71 examples/s]
Map:  59%|█████▉    | 3882/6548 [00:12<00:07, 340.83 examples/s]
Map:  60%|█████▉    | 3918/6548 [00:12<00:07, 339.58 examples/s]
Map:  60%|██████    | 3956/6548 [00:13<00:07, 334.96 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 237.95 examples/s]
Map:  62%|██████▏   | 4055/6548 [00:13<00:08, 297.87 examples/s]
Map:  63%|██████▎   | 4096/6548 [00:13<00:07, 320.47 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 328.39 examples/s]
Map:  64%|██████▍   | 4195/6548 [00:13<00:07, 331.29 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:06, 336.69 examples/s]
Map:  65%|██████▌   | 4278/6548 [00:14<00:06, 354.60 examples/s]
Map:  66%|██████▌   | 4317/6548 [00:14<00:06, 361.57 examples/s]
Map:  67%|██████▋   | 4374/6548 [00:14<00:06, 357.12 examples/s]
Map:  67%|██████▋   | 4411/6548 [00:14<00:05, 358.75 examples/s]
Map:  68%|██████▊   | 4457/6548 [00:14<00:05, 381.86 examples/s]
Map:  69%|██████▊   | 4498/6548 [00:14<00:06, 338.87 examples/s]
Map:  69%|██████▉   | 4546/6548 [00:14<00:06, 323.50 examples/s]
Map:  70%|███████   | 4584/6548 [00:14<00:06, 318.78 examples/s]
Map:  71%|███████   | 4632/6548 [00:15<00:05, 352.16 examples/s]
Map:  72%|███████▏  | 4682/6548 [00:15<00:05, 341.60 examples/s]
Map:  72%|███████▏  | 4730/6548 [00:15<00:05, 360.97 examples/s]
Map:  73%|███████▎  | 4780/6548 [00:15<00:04, 394.05 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 396.50 examples/s]
Map:  75%|███████▍  | 4887/6548 [00:15<00:04, 388.95 examples/s]
Map:  75%|███████▌  | 4933/6548 [00:15<00:04, 394.66 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:03, 409.07 examples/s]
Map:  77%|███████▋  | 5040/6548 [00:16<00:05, 258.45 examples/s]
Map:  78%|███████▊  | 5082/6548 [00:16<00:05, 262.67 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 271.28 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 284.11 examples/s]
Map:  79%|███████▉  | 5189/6548 [00:16<00:04, 286.41 examples/s]
Map:  80%|███████▉  | 5225/6548 [00:16<00:04, 300.57 examples/s]
Map:  80%|████████  | 5260/6548 [00:17<00:04, 310.81 examples/s]
Map:  81%|████████  | 5314/6548 [00:17<00:03, 368.47 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 306.80 examples/s]
Map:  83%|████████▎ | 5407/6548 [00:17<00:03, 291.06 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 322.83 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 321.04 examples/s]
Map:  85%|████████▍ | 5547/6548 [00:17<00:02, 336.51 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:18<00:03, 303.94 examples/s]
Map:  86%|████████▌ | 5632/6548 [00:18<00:02, 338.04 examples/s]
Map:  87%|████████▋ | 5680/6548 [00:18<00:02, 314.10 examples/s]
Map:  88%|████████▊ | 5733/6548 [00:18<00:02, 323.37 examples/s]
Map:  88%|████████▊ | 5772/6548 [00:18<00:02, 337.46 examples/s]
Map:  89%|████████▊ | 5808/6548 [00:18<00:02, 339.13 examples/s]
Map:  89%|████████▉ | 5844/6548 [00:18<00:02, 340.35 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:18<00:01, 345.81 examples/s]
Map:  90%|█████████ | 5923/6548 [00:19<00:01, 358.28 examples/s]
Map:  91%|█████████ | 5960/6548 [00:19<00:01, 350.45 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 207.60 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:02, 241.34 examples/s]
Map:  93%|█████████▎| 6076/6548 [00:19<00:01, 262.78 examples/s]
Map:  93%|█████████▎| 6120/6548 [00:19<00:01, 267.12 examples/s]
Map:  94%|█████████▍| 6171/6548 [00:20<00:01, 286.38 examples/s]
Map:  95%|█████████▍| 6211/6548 [00:20<00:01, 310.50 examples/s]
Map:  95%|█████████▌| 6251/6548 [00:20<00:00, 330.72 examples/s]
Map:  96%|█████████▋| 6308/6548 [00:20<00:00, 342.78 examples/s]
Map:  97%|█████████▋| 6345/6548 [00:20<00:00, 347.49 examples/s]
Map:  98%|█████████▊| 6400/6548 [00:20<00:00, 348.71 examples/s]
Map:  98%|█████████▊| 6440/6548 [00:20<00:00, 354.33 examples/s]
Map:  99%|█████████▉| 6491/6548 [00:20<00:00, 389.93 examples/s]
Map: 100%|█████████▉| 6538/6548 [00:20<00:00, 357.27 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 309.69 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   3%|▎         | 31/903 [00:00<00:03, 277.46 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 324.30 examples/s]
Map:  13%|█▎        | 114/903 [00:00<00:02, 301.00 examples/s]
Map:  17%|█▋        | 151/903 [00:00<00:02, 323.00 examples/s]
Map:  22%|██▏       | 202/903 [00:00<00:01, 381.82 examples/s]
Map:  29%|██▉       | 260/903 [00:00<00:01, 373.10 examples/s]
Map:  35%|███▍      | 314/903 [00:00<00:01, 346.22 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 319.29 examples/s]
Map:  43%|████▎     | 390/903 [00:01<00:01, 296.50 examples/s]
Map:  48%|████▊     | 434/903 [00:01<00:01, 328.45 examples/s]
Map:  53%|█████▎    | 478/903 [00:01<00:01, 314.24 examples/s]
Map:  59%|█████▉    | 531/903 [00:01<00:01, 322.27 examples/s]
Map:  63%|██████▎   | 570/903 [00:01<00:00, 336.29 examples/s]
Map:  68%|██████▊   | 614/903 [00:01<00:00, 358.69 examples/s]
Map:  72%|███████▏  | 654/903 [00:01<00:00, 366.03 examples/s]
Map:  77%|███████▋  | 698/903 [00:02<00:00, 383.05 examples/s]
Map:  82%|████████▏ | 743/903 [00:02<00:00, 399.32 examples/s]
Map:  89%|████████▉ | 803/903 [00:02<00:00, 389.37 examples/s]
Map:  94%|█████████▍| 848/903 [00:02<00:00, 388.05 examples/s]
Map:  99%|█████████▉| 897/903 [00:02<00:00, 351.78 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 317.68 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 302.83 examples/s]
Map:   4%|▍         | 79/1882 [00:00<00:05, 355.63 examples/s]
Map:   7%|▋         | 123/1882 [00:00<00:05, 320.34 examples/s]
Map:   8%|▊         | 157/1882 [00:00<00:05, 323.66 examples/s]
Map:  10%|█         | 196/1882 [00:00<00:04, 339.41 examples/s]
Map:  13%|█▎        | 237/1882 [00:00<00:04, 359.39 examples/s]
Map:  15%|█▍        | 278/1882 [00:00<00:04, 371.69 examples/s]
Map:  18%|█▊        | 334/1882 [00:00<00:04, 353.63 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:04, 313.40 examples/s]
Map:  22%|██▏       | 417/1882 [00:01<00:04, 298.98 examples/s]
Map:  24%|██▍       | 449/1882 [00:01<00:04, 300.91 examples/s]
Map:  26%|██▋       | 495/1882 [00:01<00:04, 337.66 examples/s]
Map:  29%|██▉       | 543/1882 [00:01<00:04, 321.11 examples/s]
Map:  31%|███       | 584/1882 [00:01<00:03, 340.80 examples/s]
Map:  34%|███▍      | 644/1882 [00:01<00:03, 394.64 examples/s]
Map:  37%|███▋      | 703/1882 [00:02<00:03, 384.85 examples/s]
Map:  41%|████      | 766/1882 [00:02<00:02, 389.55 examples/s]
Map:  43%|████▎     | 807/1882 [00:02<00:03, 346.19 examples/s]
Map:  45%|████▌     | 849/1882 [00:02<00:02, 361.16 examples/s]
Map:  47%|████▋     | 891/1882 [00:02<00:02, 370.22 examples/s]
Map:  49%|████▉     | 931/1882 [00:02<00:02, 366.63 examples/s]
Map:  52%|█████▏    | 982/1882 [00:02<00:02, 400.10 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 243.61 examples/s]
Map:  58%|█████▊    | 1084/1882 [00:03<00:03, 256.39 examples/s]
Map:  60%|█████▉    | 1123/1882 [00:03<00:03, 249.97 examples/s]
Map:  62%|██████▏   | 1172/1882 [00:03<00:02, 267.92 examples/s]
Map:  64%|██████▍   | 1204/1882 [00:03<00:02, 248.27 examples/s]
Map:  66%|██████▌   | 1244/1882 [00:03<00:02, 277.69 examples/s]
Map:  68%|██████▊   | 1282/1882 [00:04<00:02, 299.46 examples/s]
Map:  71%|███████   | 1335/1882 [00:04<00:01, 343.92 examples/s]
Map:  73%|███████▎  | 1380/1882 [00:04<00:01, 320.45 examples/s]
Map:  75%|███████▌  | 1419/1882 [00:04<00:01, 291.52 examples/s]
Map:  78%|███████▊  | 1471/1882 [00:04<00:01, 301.79 examples/s]
Map:  80%|████████  | 1506/1882 [00:04<00:01, 271.19 examples/s]
Map:  82%|████████▏ | 1537/1882 [00:04<00:01, 278.04 examples/s]
Map:  83%|████████▎ | 1569/1882 [00:04<00:01, 286.11 examples/s]
Map:  86%|████████▌ | 1618/1882 [00:05<00:00, 336.61 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 318.48 examples/s]
Map:  90%|█████████ | 1698/1882 [00:05<00:00, 324.96 examples/s]
Map:  92%|█████████▏| 1734/1882 [00:05<00:00, 285.77 examples/s]
Map:  94%|█████████▍| 1772/1882 [00:05<00:00, 295.90 examples/s]
Map:  96%|█████████▌| 1807/1882 [00:05<00:00, 305.64 examples/s]
Map:  98%|█████████▊| 1853/1882 [00:05<00:00, 344.28 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 305.67 examples/s]
10/12/2024 10:19:32 - INFO - __main__ -     ***** Testing *****
10/12/2024 10:19:32 - INFO - __main__ -     Batch size = 8
10/12/2024 10:19:32 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 10:19:33 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 10:19:33 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 10:19:34 - INFO - knnlm -   Reading datastore took 0.9875833988189697 s
10/12/2024 10:19:35 - INFO - knnlm -   Moving index to GPU took 0.993476152420044 s
10/12/2024 10:19:35 - INFO - __main__ -   ******************************break-into
10/12/2024 10:19:35 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 10:19:35 - INFO - __main__ -     Num examples = 236
10/12/2024 10:19:35 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:20,  7.75s/it]
test ppl:   1%|          | 2/236 [00:09<16:59,  4.36s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:06,  3.12s/it]
test ppl:   2%|▏         | 4/236 [00:16<15:14,  3.94s/it]
test ppl:   2%|▏         | 5/236 [00:22<18:01,  4.68s/it]
test ppl:   3%|▎         | 6/236 [00:28<19:38,  5.12s/it]
test ppl:   3%|▎         | 7/236 [00:30<15:35,  4.08s/it]
test ppl:   3%|▎         | 8/236 [00:34<15:50,  4.17s/it]
test ppl:   4%|▍         | 9/236 [00:36<12:53,  3.41s/it]
test ppl:   4%|▍         | 10/236 [00:39<12:31,  3.32s/it]
test ppl:   5%|▍         | 11/236 [00:42<11:22,  3.04s/it]
test ppl:   5%|▌         | 12/236 [00:47<14:33,  3.90s/it]
test ppl:   6%|▌         | 13/236 [00:53<16:44,  4.50s/it]
test ppl:   6%|▌         | 14/236 [00:59<18:15,  4.94s/it]
test ppl:   6%|▋         | 15/236 [01:01<14:08,  3.84s/it]
test ppl:   7%|▋         | 16/236 [01:03<12:09,  3.32s/it]
test ppl:   7%|▋         | 17/236 [01:07<13:10,  3.61s/it]
test ppl:   8%|▊         | 18/236 [01:09<11:19,  3.12s/it]
test ppl:   8%|▊         | 19/236 [01:13<12:39,  3.50s/it]
test ppl:   8%|▊         | 20/236 [01:16<11:36,  3.22s/it]
test ppl:   9%|▉         | 21/236 [01:22<14:19,  4.00s/it]
test ppl:   9%|▉         | 22/236 [01:28<16:13,  4.55s/it]
test ppl:  10%|▉         | 23/236 [01:31<14:51,  4.19s/it]
test ppl:  10%|█         | 24/236 [01:33<12:46,  3.61s/it]
test ppl:  11%|█         | 25/236 [01:35<10:43,  3.05s/it]
test ppl:  11%|█         | 26/236 [01:40<12:32,  3.59s/it]
test ppl:  11%|█▏        | 27/236 [01:43<12:17,  3.53s/it]
test ppl:  12%|█▏        | 28/236 [01:45<10:18,  2.97s/it]
test ppl:  12%|█▏        | 29/236 [01:47<09:33,  2.77s/it]
test ppl:  13%|█▎        | 30/236 [01:49<08:12,  2.39s/it]
test ppl:  13%|█▎        | 31/236 [01:51<07:44,  2.26s/it]
test ppl:  14%|█▎        | 32/236 [01:55<09:23,  2.76s/it]
test ppl:  14%|█▍        | 33/236 [02:00<12:27,  3.68s/it]
test ppl:  14%|█▍        | 34/236 [02:04<12:39,  3.76s/it]
test ppl:  15%|█▍        | 35/236 [02:07<11:19,  3.38s/it]
test ppl:  15%|█▌        | 36/236 [02:13<13:41,  4.11s/it]
test ppl:  16%|█▌        | 37/236 [02:18<15:21,  4.63s/it]
test ppl:  16%|█▌        | 38/236 [02:21<12:43,  3.86s/it]
test ppl:  17%|█▋        | 39/236 [02:22<10:41,  3.25s/it]
test ppl:  17%|█▋        | 40/236 [02:25<09:56,  3.04s/it]
test ppl:  17%|█▋        | 41/236 [02:27<08:44,  2.69s/it]
test ppl:  18%|█▊        | 42/236 [02:33<11:45,  3.64s/it]
test ppl:  18%|█▊        | 43/236 [02:38<13:46,  4.28s/it]
test ppl:  19%|█▊        | 44/236 [02:42<12:39,  3.95s/it]
test ppl:  19%|█▉        | 45/236 [02:44<10:40,  3.36s/it]
test ppl:  19%|█▉        | 46/236 [02:49<13:00,  4.11s/it]
test ppl:  20%|█▉        | 47/236 [02:51<10:29,  3.33s/it]
test ppl:  20%|██        | 48/236 [02:57<12:43,  4.06s/it]
test ppl:  21%|██        | 49/236 [02:59<11:19,  3.63s/it]
test ppl:  21%|██        | 50/236 [03:05<13:20,  4.30s/it]
test ppl:  22%|██▏       | 51/236 [03:10<13:21,  4.33s/it]
test ppl:  22%|██▏       | 52/236 [03:15<14:39,  4.78s/it]
test ppl:  22%|██▏       | 53/236 [03:21<15:30,  5.08s/it]
test ppl:  23%|██▎       | 54/236 [03:23<12:10,  4.02s/it]
test ppl:  23%|██▎       | 55/236 [03:28<13:32,  4.49s/it]
test ppl:  24%|██▎       | 56/236 [03:34<14:41,  4.90s/it]
test ppl:  24%|██▍       | 57/236 [03:39<14:12,  4.77s/it]
test ppl:  25%|██▍       | 58/236 [03:41<11:48,  3.98s/it]
test ppl:  25%|██▌       | 59/236 [03:47<13:20,  4.52s/it]
test ppl:  25%|██▌       | 60/236 [03:50<11:53,  4.05s/it]
test ppl:  26%|██▌       | 61/236 [03:55<13:19,  4.57s/it]
test ppl:  26%|██▋       | 62/236 [03:59<12:49,  4.42s/it]
test ppl:  27%|██▋       | 63/236 [04:02<11:01,  3.83s/it]
test ppl:  27%|██▋       | 64/236 [04:04<09:15,  3.23s/it]
test ppl:  28%|██▊       | 65/236 [04:05<07:33,  2.65s/it]
test ppl:  28%|██▊       | 66/236 [04:08<07:50,  2.77s/it]
test ppl:  28%|██▊       | 67/236 [04:10<07:23,  2.62s/it]
test ppl:  29%|██▉       | 68/236 [04:16<10:01,  3.58s/it]
test ppl:  29%|██▉       | 69/236 [04:22<11:48,  4.24s/it]
test ppl:  30%|██▉       | 70/236 [04:23<09:16,  3.35s/it]
test ppl:  30%|███       | 71/236 [04:26<09:07,  3.32s/it]
test ppl:  31%|███       | 72/236 [04:30<09:26,  3.45s/it]
test ppl:  31%|███       | 73/236 [04:34<09:38,  3.55s/it]
test ppl:  31%|███▏      | 74/236 [04:35<07:54,  2.93s/it]
test ppl:  32%|███▏      | 75/236 [04:41<10:10,  3.79s/it]
test ppl:  32%|███▏      | 76/236 [04:45<09:50,  3.69s/it]
test ppl:  33%|███▎      | 77/236 [04:47<08:37,  3.26s/it]
test ppl:  33%|███▎      | 78/236 [04:48<07:11,  2.73s/it]
test ppl:  33%|███▎      | 79/236 [04:52<08:01,  3.07s/it]
test ppl:  34%|███▍      | 80/236 [04:54<06:37,  2.55s/it]
test ppl:  34%|███▍      | 81/236 [04:59<09:04,  3.51s/it]
test ppl:  35%|███▍      | 82/236 [05:05<10:48,  4.21s/it]
test ppl:  35%|███▌      | 83/236 [05:11<11:57,  4.69s/it]
test ppl:  36%|███▌      | 84/236 [05:13<10:07,  4.00s/it]
test ppl:  36%|███▌      | 85/236 [05:18<10:09,  4.03s/it]
test ppl:  36%|███▋      | 86/236 [05:20<08:56,  3.57s/it]
test ppl:  37%|███▋      | 87/236 [05:22<07:45,  3.12s/it]
test ppl:  37%|███▋      | 88/236 [05:28<09:41,  3.93s/it]
test ppl:  38%|███▊      | 89/236 [05:30<08:10,  3.33s/it]
test ppl:  38%|███▊      | 90/236 [05:36<09:55,  4.08s/it]
test ppl:  39%|███▊      | 91/236 [05:41<10:37,  4.40s/it]
test ppl:  39%|███▉      | 92/236 [05:44<09:23,  3.91s/it]
test ppl:  39%|███▉      | 93/236 [05:49<10:40,  4.48s/it]
test ppl:  40%|███▉      | 94/236 [05:55<11:32,  4.88s/it]
test ppl:  40%|████      | 95/236 [05:57<09:35,  4.08s/it]
test ppl:  41%|████      | 96/236 [06:01<09:10,  3.94s/it]
test ppl:  41%|████      | 97/236 [06:07<10:24,  4.50s/it]
test ppl:  42%|████▏     | 98/236 [06:13<11:14,  4.89s/it]
test ppl:  42%|████▏     | 99/236 [06:18<11:47,  5.17s/it]
test ppl:  42%|████▏     | 100/236 [06:20<09:01,  3.98s/it]
test ppl:  43%|████▎     | 101/236 [06:25<10:11,  4.53s/it]
test ppl:  43%|████▎     | 102/236 [06:29<09:29,  4.25s/it]
test ppl:  44%|████▎     | 103/236 [06:30<07:31,  3.40s/it]
test ppl:  44%|████▍     | 104/236 [06:35<07:58,  3.62s/it]
test ppl:  44%|████▍     | 105/236 [06:39<08:22,  3.84s/it]
test ppl:  45%|████▍     | 106/236 [06:44<09:17,  4.29s/it]
test ppl:  45%|████▌     | 107/236 [06:46<07:41,  3.58s/it]
test ppl:  46%|████▌     | 108/236 [06:52<08:56,  4.19s/it]
test ppl:  46%|████▌     | 109/236 [06:56<09:08,  4.32s/it]
test ppl:  47%|████▋     | 110/236 [06:58<07:21,  3.51s/it]
test ppl:  47%|████▋     | 111/236 [07:02<07:33,  3.63s/it]
test ppl:  47%|████▋     | 112/236 [07:06<07:44,  3.75s/it]
test ppl:  48%|████▊     | 113/236 [07:08<06:26,  3.14s/it]
test ppl:  48%|████▊     | 114/236 [07:11<06:29,  3.19s/it]
test ppl:  49%|████▊     | 115/236 [07:17<08:00,  3.97s/it]
test ppl:  49%|████▉     | 116/236 [07:23<09:02,  4.52s/it]
test ppl:  50%|████▉     | 117/236 [07:25<07:21,  3.71s/it]
test ppl:  50%|█████     | 118/236 [07:29<07:36,  3.87s/it]
test ppl:  50%|█████     | 119/236 [07:31<06:42,  3.44s/it]
test ppl:  51%|█████     | 120/236 [07:33<05:28,  2.83s/it]
test ppl:  51%|█████▏    | 121/236 [07:38<07:08,  3.73s/it]
test ppl:  52%|█████▏    | 122/236 [07:43<07:39,  4.03s/it]
test ppl:  52%|█████▏    | 123/236 [07:45<06:30,  3.46s/it]
test ppl:  53%|█████▎    | 124/236 [07:48<05:56,  3.18s/it]
test ppl:  53%|█████▎    | 125/236 [07:50<05:29,  2.97s/it]
test ppl:  53%|█████▎    | 126/236 [07:54<05:47,  3.16s/it]
test ppl:  54%|█████▍    | 127/236 [07:56<05:01,  2.77s/it]
test ppl:  54%|█████▍    | 128/236 [08:02<06:36,  3.67s/it]
test ppl:  55%|█████▍    | 129/236 [08:04<06:07,  3.44s/it]
test ppl:  55%|█████▌    | 130/236 [08:07<05:37,  3.19s/it]
test ppl:  56%|█████▌    | 131/236 [08:13<06:57,  3.97s/it]
test ppl:  56%|█████▌    | 132/236 [08:15<06:05,  3.51s/it]
test ppl:  56%|█████▋    | 133/236 [08:19<06:12,  3.62s/it]
test ppl:  57%|█████▋    | 134/236 [08:22<06:01,  3.54s/it]
test ppl:  57%|█████▋    | 135/236 [08:27<06:16,  3.72s/it]
test ppl:  58%|█████▊    | 136/236 [08:28<05:00,  3.01s/it]
test ppl:  58%|█████▊    | 137/236 [08:34<06:21,  3.86s/it]
test ppl:  58%|█████▊    | 138/236 [08:40<07:15,  4.44s/it]
test ppl:  59%|█████▉    | 139/236 [08:42<06:16,  3.88s/it]
test ppl:  59%|█████▉    | 140/236 [08:44<05:08,  3.22s/it]
test ppl:  60%|█████▉    | 141/236 [08:47<04:55,  3.11s/it]
test ppl:  60%|██████    | 142/236 [08:49<04:23,  2.81s/it]
test ppl:  61%|██████    | 143/236 [08:55<05:45,  3.71s/it]
test ppl:  61%|██████    | 144/236 [08:57<05:13,  3.41s/it]
test ppl:  61%|██████▏   | 145/236 [09:03<06:15,  4.12s/it]
test ppl:  62%|██████▏   | 146/236 [09:08<06:22,  4.25s/it]
test ppl:  62%|██████▏   | 147/236 [09:14<07:00,  4.73s/it]
test ppl:  63%|██████▎   | 148/236 [09:19<07:27,  5.09s/it]
test ppl:  63%|██████▎   | 149/236 [09:23<06:36,  4.56s/it]
test ppl:  64%|██████▎   | 150/236 [09:25<05:41,  3.97s/it]
test ppl:  64%|██████▍   | 151/236 [09:31<06:23,  4.52s/it]
test ppl:  64%|██████▍   | 152/236 [09:37<06:51,  4.90s/it]
test ppl:  65%|██████▍   | 153/236 [09:39<05:47,  4.19s/it]
test ppl:  65%|██████▌   | 154/236 [09:42<05:01,  3.67s/it]
test ppl:  66%|██████▌   | 155/236 [09:45<04:32,  3.37s/it]
test ppl:  66%|██████▌   | 156/236 [09:47<04:00,  3.00s/it]
test ppl:  67%|██████▋   | 157/236 [09:49<03:36,  2.74s/it]
test ppl:  67%|██████▋   | 158/236 [09:55<04:45,  3.66s/it]
test ppl:  67%|██████▋   | 159/236 [09:56<03:51,  3.01s/it]
test ppl:  68%|██████▊   | 160/236 [09:57<03:06,  2.45s/it]
test ppl:  68%|██████▊   | 161/236 [09:59<02:39,  2.13s/it]
test ppl:  69%|██████▊   | 162/236 [10:01<02:36,  2.12s/it]
test ppl:  69%|██████▉   | 163/236 [10:03<02:39,  2.18s/it]
test ppl:  69%|██████▉   | 164/236 [10:07<03:19,  2.77s/it]
test ppl:  70%|██████▉   | 165/236 [10:11<03:39,  3.10s/it]
test ppl:  70%|███████   | 166/236 [10:13<03:06,  2.67s/it]
test ppl:  71%|███████   | 167/236 [10:15<02:52,  2.51s/it]
test ppl:  71%|███████   | 168/236 [10:17<02:32,  2.24s/it]
test ppl:  72%|███████▏  | 169/236 [10:19<02:38,  2.37s/it]
test ppl:  72%|███████▏  | 170/236 [10:25<03:46,  3.43s/it]
test ppl:  72%|███████▏  | 171/236 [10:27<03:07,  2.88s/it]
test ppl:  73%|███████▎  | 172/236 [10:29<02:49,  2.65s/it]
test ppl:  73%|███████▎  | 173/236 [10:33<03:09,  3.01s/it]
test ppl:  74%|███████▎  | 174/236 [10:37<03:24,  3.29s/it]
test ppl:  74%|███████▍  | 175/236 [10:38<02:45,  2.71s/it]
test ppl:  75%|███████▍  | 176/236 [10:44<03:38,  3.64s/it]
test ppl:  75%|███████▌  | 177/236 [10:50<04:13,  4.30s/it]
test ppl:  75%|███████▌  | 178/236 [10:55<04:36,  4.77s/it]
test ppl:  76%|███████▌  | 179/236 [11:01<04:49,  5.09s/it]
test ppl:  76%|███████▋  | 180/236 [11:05<04:16,  4.58s/it]
test ppl:  77%|███████▋  | 181/236 [11:11<04:32,  4.95s/it]
test ppl:  77%|███████▋  | 182/236 [11:12<03:37,  4.03s/it]
test ppl:  78%|███████▊  | 183/236 [11:15<03:06,  3.52s/it]
test ppl:  78%|███████▊  | 184/236 [11:16<02:33,  2.96s/it]
test ppl:  78%|███████▊  | 185/236 [11:22<03:15,  3.83s/it]
test ppl:  79%|███████▉  | 186/236 [11:24<02:45,  3.31s/it]
test ppl:  79%|███████▉  | 187/236 [11:30<03:20,  4.09s/it]
test ppl:  80%|███████▉  | 188/236 [11:36<03:41,  4.61s/it]
test ppl:  80%|████████  | 189/236 [11:42<03:53,  4.98s/it]
test ppl:  81%|████████  | 190/236 [11:46<03:39,  4.77s/it]
test ppl:  81%|████████  | 191/236 [11:50<03:21,  4.47s/it]
test ppl:  81%|████████▏ | 192/236 [11:53<02:52,  3.91s/it]
test ppl:  82%|████████▏ | 193/236 [11:54<02:17,  3.20s/it]
test ppl:  82%|████████▏ | 194/236 [11:57<02:06,  3.02s/it]
test ppl:  83%|████████▎ | 195/236 [12:00<02:03,  3.02s/it]
test ppl:  83%|████████▎ | 196/236 [12:02<01:48,  2.71s/it]
test ppl:  83%|████████▎ | 197/236 [12:04<01:40,  2.58s/it]
test ppl:  84%|████████▍ | 198/236 [12:10<02:14,  3.55s/it]
test ppl:  84%|████████▍ | 199/236 [12:13<02:07,  3.45s/it]
test ppl:  85%|████████▍ | 200/236 [12:19<02:29,  4.16s/it]
test ppl:  85%|████████▌ | 201/236 [12:21<02:08,  3.67s/it]
test ppl:  86%|████████▌ | 202/236 [12:27<02:26,  4.31s/it]
test ppl:  86%|████████▌ | 203/236 [12:33<02:37,  4.77s/it]
test ppl:  86%|████████▋ | 204/236 [12:35<02:02,  3.84s/it]
test ppl:  87%|████████▋ | 205/236 [12:40<02:16,  4.39s/it]
test ppl:  87%|████████▋ | 206/236 [12:44<02:01,  4.05s/it]
test ppl:  88%|████████▊ | 207/236 [12:49<02:12,  4.58s/it]
test ppl:  88%|████████▊ | 208/236 [12:52<01:52,  4.01s/it]
test ppl:  89%|████████▊ | 209/236 [12:58<02:03,  4.58s/it]
test ppl:  89%|████████▉ | 210/236 [13:00<01:41,  3.90s/it]
test ppl:  89%|████████▉ | 211/236 [13:04<01:38,  3.92s/it]
test ppl:  90%|████████▉ | 212/236 [13:10<01:47,  4.48s/it]
test ppl:  90%|█████████ | 213/236 [13:16<01:52,  4.87s/it]
test ppl:  91%|█████████ | 214/236 [13:17<01:23,  3.81s/it]
test ppl:  91%|█████████ | 215/236 [13:23<01:32,  4.42s/it]
test ppl:  92%|█████████▏| 216/236 [13:25<01:15,  3.78s/it]
test ppl:  92%|█████████▏| 217/236 [13:31<01:23,  4.41s/it]
test ppl:  92%|█████████▏| 218/236 [13:33<01:05,  3.65s/it]
test ppl:  93%|█████████▎| 219/236 [13:39<01:13,  4.31s/it]
test ppl:  93%|█████████▎| 220/236 [13:43<01:07,  4.19s/it]
test ppl:  94%|█████████▎| 221/236 [13:45<00:51,  3.46s/it]
test ppl:  94%|█████████▍| 222/236 [13:50<00:58,  4.17s/it]
test ppl:  94%|█████████▍| 223/236 [13:56<01:00,  4.67s/it]
test ppl:  95%|█████████▍| 224/236 [13:58<00:44,  3.68s/it]
test ppl:  95%|█████████▌| 225/236 [14:00<00:36,  3.36s/it]
test ppl:  96%|█████████▌| 226/236 [14:03<00:30,  3.10s/it]
test ppl:  96%|█████████▌| 227/236 [14:05<00:24,  2.72s/it]
test ppl:  97%|█████████▋| 228/236 [14:07<00:19,  2.47s/it]
test ppl:  97%|█████████▋| 229/236 [14:12<00:24,  3.47s/it]
test ppl:  97%|█████████▋| 230/236 [14:16<00:20,  3.40s/it]
test ppl:  98%|█████████▊| 231/236 [14:19<00:16,  3.37s/it]
test ppl:  98%|█████████▊| 232/236 [14:21<00:11,  2.87s/it]
test ppl:  99%|█████████▊| 233/236 [14:23<00:07,  2.65s/it]
test ppl:  99%|█████████▉| 234/236 [14:24<00:04,  2.22s/it]
test ppl: 100%|█████████▉| 235/236 [14:30<00:03,  3.29s/it]
test ppl: 100%|██████████| 236/236 [14:31<00:00,  2.59s/it]
test ppl: 100%|██████████| 236/236 [14:31<00:00,  3.69s/it]
10/12/2024 10:34:06 - INFO - __main__ -    em: 0.2109
10/12/2024 10:34:06 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.4 20:  em: 0.2109

--------------------------------------------------------------------------------
Running experiment with knn_temp=20, lmbda=0.4, k=32
2024-10-12 10:34:13.231748: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 10:34:13.251279: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 10:34:13.273026: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 10:34:13.279634: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 10:34:13.295485: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 10:34:14.294084: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 10:34:15 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.4, knn_temp=20, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 10:34:15 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:34:20,  2.20it/s]
Adding feature api:   4%|▍         | 7283/187062 [00:00<00:10, 17440.77it/s]
Adding feature api:   8%|▊         | 15649/187062 [00:00<00:04, 34319.87it/s]
Adding feature api:  13%|█▎        | 24043/187062 [00:00<00:03, 47563.69it/s]
Adding feature api:  17%|█▋        | 32456/187062 [00:00<00:02, 57656.72it/s]
Adding feature api:  22%|██▏       | 40880/187062 [00:00<00:02, 65173.64it/s]
Adding feature api:  26%|██▋       | 49328/187062 [00:01<00:01, 70727.62it/s]
Adding feature api:  31%|███       | 57771/187062 [00:01<00:01, 74710.54it/s]
Adding feature api:  35%|███▌      | 66141/187062 [00:01<00:01, 77349.61it/s]
Adding feature api:  40%|███▉      | 74534/187062 [00:01<00:01, 79294.19it/s]
Adding feature api:  44%|████▍     | 82896/187062 [00:01<00:01, 80576.75it/s]
Adding feature api:  49%|████▉     | 91302/187062 [00:01<00:01, 81611.77it/s]
Adding feature api:  53%|█████▎    | 99637/187062 [00:01<00:01, 81864.68it/s]
Adding feature api:  58%|█████▊    | 108129/187062 [00:01<00:00, 82772.57it/s]
Adding feature api:  62%|██████▏   | 116605/187062 [00:01<00:00, 83363.11it/s]
Adding feature api:  67%|██████▋   | 125047/187062 [00:01<00:00, 83676.90it/s]
Adding feature api:  71%|███████▏  | 133470/187062 [00:02<00:00, 83839.94it/s]
Adding feature api:  76%|███████▌  | 141927/187062 [00:02<00:00, 84055.00it/s]
Adding feature api:  80%|████████  | 150375/187062 [00:02<00:00, 84180.95it/s]
Adding feature api:  85%|████████▍ | 158829/187062 [00:02<00:00, 84285.89it/s]
Adding feature api:  89%|████████▉ | 167268/187062 [00:02<00:00, 84246.07it/s]
Adding feature api:  94%|█████████▍| 175700/187062 [00:02<00:00, 84247.06it/s]
Adding feature api:  98%|█████████▊| 184130/187062 [00:02<00:00, 57330.17it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64513.51it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:37:00,  2.20it/s]
Adding feature datatype:   4%|▍         | 7056/187062 [00:00<00:10, 16872.88it/s]
Adding feature datatype:   8%|▊         | 15150/187062 [00:00<00:05, 33186.39it/s]
Adding feature datatype:  12%|█▏        | 23346/187062 [00:00<00:03, 46195.03it/s]
Adding feature datatype:  17%|█▋        | 31497/187062 [00:00<00:02, 55938.35it/s]
Adding feature datatype:  21%|██        | 39675/187062 [00:00<00:02, 63242.36it/s]
Adding feature datatype:  26%|██▌       | 47910/187062 [00:01<00:02, 68737.22it/s]
Adding feature datatype:  30%|██▉       | 56098/187062 [00:01<00:01, 72564.36it/s]
Adding feature datatype:  34%|███▍      | 64303/187062 [00:01<00:01, 75349.75it/s]
Adding feature datatype:  39%|███▉      | 72536/187062 [00:01<00:01, 77412.43it/s]
Adding feature datatype:  43%|████▎     | 80672/187062 [00:01<00:01, 78581.47it/s]
Adding feature datatype:  47%|████▋     | 88851/187062 [00:01<00:01, 79536.16it/s]
Adding feature datatype:  52%|█████▏    | 97005/187062 [00:01<00:01, 80130.71it/s]
Adding feature datatype:  56%|█████▌    | 105165/187062 [00:01<00:01, 80566.50it/s]
Adding feature datatype:  61%|██████    | 113338/187062 [00:01<00:00, 80911.51it/s]
Adding feature datatype:  65%|██████▍   | 121564/187062 [00:01<00:00, 81314.25it/s]
Adding feature datatype:  69%|██████▉   | 129740/187062 [00:02<00:00, 81446.31it/s]
Adding feature datatype:  74%|███████▎  | 137921/187062 [00:02<00:00, 81551.67it/s]
Adding feature datatype:  78%|███████▊  | 146151/187062 [00:02<00:00, 81774.76it/s]
Adding feature datatype:  83%|████████▎ | 154343/187062 [00:02<00:00, 81746.74it/s]
Adding feature datatype:  87%|████████▋ | 162528/187062 [00:02<00:00, 81662.17it/s]
Adding feature datatype:  91%|█████████▏| 170754/187062 [00:02<00:00, 81838.91it/s]
Adding feature datatype:  96%|█████████▌| 178943/187062 [00:02<00:00, 75170.98it/s]
Adding feature datatype: 100%|█████████▉| 186570/187062 [00:02<00:00, 51927.72it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63159.99it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:11:34,  2.24it/s]
Adding feature literal:   4%|▍         | 7081/187062 [00:00<00:10, 17167.26it/s]
Adding feature literal:   8%|▊         | 15153/187062 [00:00<00:05, 33515.33it/s]
Adding feature literal:  12%|█▏        | 23310/187062 [00:00<00:03, 46428.67it/s]
Adding feature literal:  17%|█▋        | 31502/187062 [00:00<00:02, 56273.85it/s]
Adding feature literal:  21%|██        | 39657/187062 [00:00<00:02, 63446.13it/s]
Adding feature literal:  26%|██▌       | 47751/187062 [00:01<00:02, 68489.74it/s]
Adding feature literal:  30%|██▉       | 55886/187062 [00:01<00:01, 72242.26it/s]
Adding feature literal:  34%|███▍      | 63879/187062 [00:01<00:01, 74314.10it/s]
Adding feature literal:  39%|███▊      | 72081/187062 [00:01<00:01, 76587.28it/s]
Adding feature literal:  43%|████▎     | 80217/187062 [00:01<00:01, 78002.34it/s]
Adding feature literal:  47%|████▋     | 88390/187062 [00:01<00:01, 79109.20it/s]
Adding feature literal:  52%|█████▏    | 96603/187062 [00:01<00:01, 80007.08it/s]
Adding feature literal:  56%|█████▌    | 104804/187062 [00:01<00:01, 80604.33it/s]
Adding feature literal:  60%|██████    | 113047/187062 [00:01<00:00, 81149.09it/s]
Adding feature literal:  65%|██████▍   | 121257/187062 [00:01<00:00, 81433.27it/s]
Adding feature literal:  69%|██████▉   | 129441/187062 [00:02<00:00, 81479.02it/s]
Adding feature literal:  74%|███████▎  | 137640/187062 [00:02<00:00, 81630.70it/s]
Adding feature literal:  78%|███████▊  | 145849/187062 [00:02<00:00, 81767.77it/s]
Adding feature literal:  82%|████████▏ | 154071/187062 [00:02<00:00, 81901.19it/s]
Adding feature literal:  87%|████████▋ | 162273/187062 [00:02<00:00, 81934.61it/s]
Adding feature literal:  91%|█████████ | 170474/187062 [00:02<00:00, 81799.40it/s]
Adding feature literal:  96%|█████████▌| 178659/187062 [00:02<00:00, 76234.85it/s]
Adding feature literal: 100%|█████████▉| 186362/187062 [00:02<00:00, 52175.14it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63244.79it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:17:06,  2.23it/s]
Adding feature operator:   4%|▍         | 7023/187062 [00:00<00:10, 16975.42it/s]
Adding feature operator:   8%|▊         | 15095/187062 [00:00<00:05, 33336.61it/s]
Adding feature operator:  12%|█▏        | 23201/187062 [00:00<00:03, 46139.60it/s]
Adding feature operator:  17%|█▋        | 31357/187062 [00:00<00:02, 55952.41it/s]
Adding feature operator:  21%|██        | 39474/187062 [00:00<00:02, 63102.17it/s]
Adding feature operator:  25%|██▌       | 47383/187062 [00:01<00:02, 67710.68it/s]
Adding feature operator:  30%|██▉       | 55549/187062 [00:01<00:01, 71778.71it/s]
Adding feature operator:  34%|███▍      | 63695/187062 [00:01<00:01, 74623.53it/s]
Adding feature operator:  38%|███▊      | 71854/187062 [00:01<00:01, 76683.11it/s]
Adding feature operator:  43%|████▎     | 80048/187062 [00:01<00:01, 78241.76it/s]
Adding feature operator:  47%|████▋     | 88159/187062 [00:01<00:01, 79094.80it/s]
Adding feature operator:  52%|█████▏    | 96349/187062 [00:01<00:01, 79930.98it/s]
Adding feature operator:  56%|█████▌    | 104502/187062 [00:01<00:01, 80406.68it/s]
Adding feature operator:  60%|██████    | 112662/187062 [00:01<00:00, 80761.88it/s]
Adding feature operator:  65%|██████▍   | 120808/187062 [00:01<00:00, 80968.27it/s]
Adding feature operator:  69%|██████▉   | 128985/187062 [00:02<00:00, 81203.59it/s]
Adding feature operator:  73%|███████▎  | 137134/187062 [00:02<00:00, 81278.02it/s]
Adding feature operator:  78%|███████▊  | 145330/187062 [00:02<00:00, 81481.62it/s]
Adding feature operator:  82%|████████▏ | 153493/187062 [00:02<00:00, 80844.21it/s]
Adding feature operator:  86%|████████▋ | 161679/187062 [00:02<00:00, 81144.71it/s]
Adding feature operator:  91%|█████████ | 169841/187062 [00:02<00:00, 81284.61it/s]
Adding feature operator:  95%|█████████▌| 177975/187062 [00:02<00:00, 80129.85it/s]
Adding feature operator:  99%|█████████▉| 185996/187062 [00:02<00:00, 52722.78it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63062.54it/s]
[2024-10-12 10:34:59,186] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 10:35:00 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 10:35:00 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 35/6548 [00:00<00:19, 334.86 examples/s]
Map:   1%|▏         | 84/6548 [00:00<00:31, 204.68 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:24, 260.30 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 312.64 examples/s]
Map:   3%|▎         | 220/6548 [00:00<00:18, 343.97 examples/s]
Map:   4%|▍         | 286/6548 [00:00<00:16, 369.08 examples/s]
Map:   5%|▌         | 340/6548 [00:01<00:20, 310.35 examples/s]
Map:   6%|▌         | 400/6548 [00:01<00:18, 331.71 examples/s]
Map:   7%|▋         | 436/6548 [00:01<00:18, 335.52 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:19, 314.30 examples/s]
Map:   8%|▊         | 528/6548 [00:01<00:18, 329.67 examples/s]
Map:   9%|▉         | 575/6548 [00:01<00:16, 354.05 examples/s]
Map:   9%|▉         | 612/6548 [00:01<00:16, 353.31 examples/s]
Map:  10%|▉         | 650/6548 [00:02<00:18, 314.36 examples/s]
Map:  11%|█         | 693/6548 [00:02<00:17, 339.42 examples/s]
Map:  11%|█         | 734/6548 [00:02<00:16, 355.35 examples/s]
Map:  12%|█▏        | 788/6548 [00:02<00:14, 401.64 examples/s]
Map:  13%|█▎        | 831/6548 [00:02<00:14, 395.16 examples/s]
Map:  13%|█▎        | 876/6548 [00:02<00:14, 404.89 examples/s]
Map:  14%|█▍        | 919/6548 [00:02<00:15, 359.84 examples/s]
Map:  15%|█▍        | 970/6548 [00:02<00:16, 343.44 examples/s]
Map:  15%|█▌        | 1013/6548 [00:03<00:25, 213.68 examples/s]
Map:  16%|█▌        | 1047/6548 [00:03<00:23, 233.37 examples/s]
Map:  17%|█▋        | 1090/6548 [00:03<00:20, 269.63 examples/s]
Map:  17%|█▋        | 1138/6548 [00:03<00:17, 313.82 examples/s]
Map:  18%|█▊        | 1198/6548 [00:03<00:15, 337.20 examples/s]
Map:  19%|█▉        | 1238/6548 [00:03<00:15, 345.21 examples/s]
Map:  20%|█▉        | 1278/6548 [00:03<00:14, 353.01 examples/s]
Map:  20%|██        | 1322/6548 [00:04<00:15, 326.69 examples/s]
Map:  21%|██        | 1363/6548 [00:04<00:17, 303.40 examples/s]
Map:  22%|██▏       | 1408/6548 [00:04<00:17, 298.57 examples/s]
Map:  22%|██▏       | 1459/6548 [00:04<00:17, 295.09 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:18, 274.81 examples/s]
Map:  24%|██▎       | 1542/6548 [00:04<00:18, 276.94 examples/s]
Map:  24%|██▍       | 1579/6548 [00:05<00:16, 294.19 examples/s]
Map:  25%|██▍       | 1610/6548 [00:05<00:17, 284.70 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:17, 287.85 examples/s]
Map:  26%|██▌       | 1693/6548 [00:05<00:16, 297.35 examples/s]
Map:  26%|██▋       | 1731/6548 [00:05<00:15, 316.75 examples/s]
Map:  27%|██▋       | 1776/6548 [00:05<00:13, 347.13 examples/s]
Map:  28%|██▊       | 1837/6548 [00:05<00:12, 367.74 examples/s]
Map:  29%|██▉       | 1886/6548 [00:05<00:13, 346.15 examples/s]
Map:  30%|██▉       | 1940/6548 [00:06<00:13, 344.96 examples/s]
Map:  30%|███       | 1985/6548 [00:06<00:12, 367.10 examples/s]
Map:  31%|███       | 2028/6548 [00:06<00:19, 233.65 examples/s]
Map:  32%|███▏      | 2063/6548 [00:06<00:17, 249.98 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 266.64 examples/s]
Map:  33%|███▎      | 2141/6548 [00:06<00:17, 253.56 examples/s]
Map:  33%|███▎      | 2175/6548 [00:07<00:16, 270.65 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 281.38 examples/s]
Map:  34%|███▍      | 2255/6548 [00:07<00:15, 278.42 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:15, 281.10 examples/s]
Map:  36%|███▌      | 2331/6548 [00:07<00:13, 317.96 examples/s]
Map:  36%|███▌      | 2371/6548 [00:07<00:13, 299.95 examples/s]
Map:  37%|███▋      | 2407/6548 [00:07<00:13, 308.42 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:13, 312.99 examples/s]
Map:  38%|███▊      | 2494/6548 [00:08<00:12, 319.30 examples/s]
Map:  39%|███▉      | 2546/6548 [00:08<00:12, 325.55 examples/s]
Map:  40%|███▉      | 2594/6548 [00:08<00:11, 357.44 examples/s]
Map:  40%|████      | 2637/6548 [00:08<00:10, 373.14 examples/s]
Map:  41%|████      | 2682/6548 [00:08<00:11, 331.21 examples/s]
Map:  42%|████▏     | 2737/6548 [00:08<00:11, 330.28 examples/s]
Map:  42%|████▏     | 2773/6548 [00:08<00:11, 329.23 examples/s]
Map:  43%|████▎     | 2808/6548 [00:08<00:11, 328.46 examples/s]
Map:  43%|████▎     | 2844/6548 [00:09<00:13, 276.39 examples/s]
Map:  44%|████▍     | 2880/6548 [00:09<00:12, 290.55 examples/s]
Map:  45%|████▍     | 2925/6548 [00:09<00:13, 271.27 examples/s]
Map:  45%|████▌     | 2957/6548 [00:09<00:12, 280.01 examples/s]
Map:  46%|████▌     | 2991/6548 [00:09<00:14, 244.18 examples/s]
Map:  46%|████▌     | 3026/6548 [00:10<00:21, 163.39 examples/s]
Map:  47%|████▋     | 3058/6548 [00:10<00:18, 185.25 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 209.50 examples/s]
Map:  48%|████▊     | 3135/6548 [00:10<00:13, 256.25 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:13, 251.88 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 248.07 examples/s]
Map:  49%|████▉     | 3238/6548 [00:10<00:12, 266.63 examples/s]
Map:  50%|████▉     | 3270/6548 [00:10<00:11, 279.24 examples/s]
Map:  50%|█████     | 3300/6548 [00:11<00:11, 280.02 examples/s]
Map:  51%|█████     | 3342/6548 [00:11<00:10, 310.84 examples/s]
Map:  52%|█████▏    | 3377/6548 [00:11<00:10, 315.12 examples/s]
Map:  52%|█████▏    | 3420/6548 [00:11<00:10, 288.84 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 274.80 examples/s]
Map:  53%|█████▎    | 3498/6548 [00:11<00:10, 278.66 examples/s]
Map:  54%|█████▍    | 3546/6548 [00:11<00:09, 324.38 examples/s]
Map:  55%|█████▍    | 3596/6548 [00:11<00:08, 363.58 examples/s]
Map:  56%|█████▌    | 3642/6548 [00:12<00:07, 375.70 examples/s]
Map:  56%|█████▌    | 3683/6548 [00:12<00:07, 379.93 examples/s]
Map:  57%|█████▋    | 3733/6548 [00:12<00:06, 402.96 examples/s]
Map:  58%|█████▊    | 3790/6548 [00:12<00:07, 387.79 examples/s]
Map:  59%|█████▊    | 3832/6548 [00:12<00:08, 332.14 examples/s]
Map:  59%|█████▉    | 3886/6548 [00:12<00:08, 327.63 examples/s]
Map:  60%|█████▉    | 3928/6548 [00:12<00:07, 328.69 examples/s]
Map:  61%|██████    | 3962/6548 [00:13<00:07, 329.63 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 232.86 examples/s]
Map:  62%|██████▏   | 4055/6548 [00:13<00:08, 293.55 examples/s]
Map:  63%|██████▎   | 4097/6548 [00:13<00:07, 318.85 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 329.34 examples/s]
Map:  64%|██████▍   | 4194/6548 [00:13<00:07, 329.94 examples/s]
Map:  65%|██████▍   | 4231/6548 [00:13<00:07, 325.96 examples/s]
Map:  65%|██████▌   | 4276/6548 [00:14<00:06, 354.62 examples/s]
Map:  66%|██████▌   | 4316/6548 [00:14<00:06, 364.92 examples/s]
Map:  67%|██████▋   | 4374/6548 [00:14<00:06, 360.02 examples/s]
Map:  68%|██████▊   | 4432/6548 [00:14<00:05, 358.57 examples/s]
Map:  68%|██████▊   | 4477/6548 [00:14<00:06, 332.04 examples/s]
Map:  69%|██████▉   | 4516/6548 [00:14<00:06, 306.04 examples/s]
Map:  70%|██████▉   | 4568/6548 [00:14<00:06, 307.31 examples/s]
Map:  71%|███████   | 4617/6548 [00:15<00:06, 311.15 examples/s]
Map:  71%|███████   | 4663/6548 [00:15<00:05, 340.99 examples/s]
Map:  72%|███████▏  | 4716/6548 [00:15<00:05, 338.36 examples/s]
Map:  73%|███████▎  | 4753/6548 [00:15<00:05, 344.05 examples/s]
Map:  73%|███████▎  | 4810/6548 [00:15<00:04, 397.69 examples/s]
Map:  74%|███████▍  | 4856/6548 [00:15<00:04, 355.82 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 366.10 examples/s]
Map:  76%|███████▌  | 4957/6548 [00:15<00:03, 405.95 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:16<00:06, 245.70 examples/s]
Map:  77%|███████▋  | 5037/6548 [00:16<00:05, 267.75 examples/s]
Map:  78%|███████▊  | 5081/6548 [00:16<00:05, 270.26 examples/s]
Map:  78%|███████▊  | 5116/6548 [00:16<00:05, 285.27 examples/s]
Map:  79%|███████▉  | 5162/6548 [00:16<00:04, 288.97 examples/s]
Map:  80%|███████▉  | 5206/6548 [00:16<00:04, 285.22 examples/s]
Map:  80%|████████  | 5242/6548 [00:17<00:04, 295.34 examples/s]
Map:  81%|████████  | 5286/6548 [00:17<00:03, 319.41 examples/s]
Map:  81%|████████▏ | 5330/6548 [00:17<00:03, 307.83 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 296.45 examples/s]
Map:  83%|████████▎ | 5405/6548 [00:17<00:04, 277.14 examples/s]
Map:  83%|████████▎ | 5450/6548 [00:17<00:03, 315.19 examples/s]
Map:  84%|████████▍ | 5500/6548 [00:17<00:03, 317.08 examples/s]
Map:  85%|████████▍ | 5538/6548 [00:17<00:03, 330.51 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:18<00:03, 304.04 examples/s]
Map:  86%|████████▌ | 5638/6548 [00:18<00:02, 353.13 examples/s]
Map:  87%|████████▋ | 5680/6548 [00:18<00:02, 295.21 examples/s]
Map:  87%|████████▋ | 5714/6548 [00:18<00:02, 302.07 examples/s]
Map:  88%|████████▊ | 5758/6548 [00:18<00:02, 334.40 examples/s]
Map:  89%|████████▊ | 5795/6548 [00:18<00:02, 338.98 examples/s]
Map:  89%|████████▉ | 5846/6548 [00:18<00:02, 336.84 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:19<00:01, 342.55 examples/s]
Map:  90%|█████████ | 5922/6548 [00:19<00:01, 353.92 examples/s]
Map:  91%|█████████ | 5964/6548 [00:19<00:01, 322.52 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 213.53 examples/s]
Map:  92%|█████████▏| 6041/6548 [00:19<00:02, 249.75 examples/s]
Map:  93%|█████████▎| 6074/6548 [00:19<00:01, 264.41 examples/s]
Map:  93%|█████████▎| 6120/6548 [00:19<00:01, 271.94 examples/s]
Map:  94%|█████████▍| 6160/6548 [00:20<00:01, 298.51 examples/s]
Map:  95%|█████████▍| 6193/6548 [00:20<00:01, 303.82 examples/s]
Map:  95%|█████████▌| 6236/6548 [00:20<00:00, 335.60 examples/s]
Map:  96%|█████████▌| 6294/6548 [00:20<00:00, 348.76 examples/s]
Map:  97%|█████████▋| 6346/6548 [00:20<00:00, 344.22 examples/s]
Map:  98%|█████████▊| 6402/6548 [00:20<00:00, 347.17 examples/s]
Map:  98%|█████████▊| 6440/6548 [00:20<00:00, 353.04 examples/s]
Map:  99%|█████████▉| 6490/6548 [00:20<00:00, 387.70 examples/s]
Map: 100%|█████████▉| 6547/6548 [00:21<00:00, 375.76 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 307.96 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   3%|▎         | 31/903 [00:00<00:03, 283.54 examples/s]
Map:   7%|▋         | 62/903 [00:00<00:02, 291.80 examples/s]
Map:  11%|█         | 96/903 [00:00<00:02, 305.76 examples/s]
Map:  16%|█▌        | 143/903 [00:00<00:02, 306.64 examples/s]
Map:  21%|██        | 191/903 [00:00<00:01, 356.67 examples/s]
Map:  26%|██▌       | 231/903 [00:00<00:01, 367.37 examples/s]
Map:  30%|███       | 271/903 [00:00<00:01, 375.62 examples/s]
Map:  34%|███▍      | 310/903 [00:00<00:01, 368.40 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 321.04 examples/s]
Map:  44%|████▎     | 395/903 [00:01<00:01, 292.20 examples/s]
Map:  48%|████▊     | 436/903 [00:01<00:01, 296.21 examples/s]
Map:  53%|█████▎    | 475/903 [00:01<00:01, 312.48 examples/s]
Map:  56%|█████▋    | 508/903 [00:01<00:01, 316.47 examples/s]
Map:  62%|██████▏   | 558/903 [00:01<00:00, 355.10 examples/s]
Map:  67%|██████▋   | 607/903 [00:01<00:00, 390.09 examples/s]
Map:  73%|███████▎  | 663/903 [00:01<00:00, 376.31 examples/s]
Map:  78%|███████▊  | 704/903 [00:02<00:00, 383.37 examples/s]
Map:  83%|████████▎ | 751/903 [00:02<00:00, 403.78 examples/s]
Map:  89%|████████▉ | 807/903 [00:02<00:00, 387.10 examples/s]
Map:  95%|█████████▍| 854/903 [00:02<00:00, 405.87 examples/s]
Map:  99%|█████████▉| 898/903 [00:02<00:00, 349.42 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 322.28 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 296.06 examples/s]
Map:   4%|▍         | 81/1882 [00:00<00:04, 365.23 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 346.67 examples/s]
Map:   9%|▊         | 161/1882 [00:00<00:04, 366.89 examples/s]
Map:  11%|█         | 203/1882 [00:00<00:05, 325.94 examples/s]
Map:  13%|█▎        | 252/1882 [00:00<00:04, 372.53 examples/s]
Map:  16%|█▌        | 300/1882 [00:00<00:04, 345.10 examples/s]
Map:  18%|█▊        | 336/1882 [00:00<00:04, 342.65 examples/s]
Map:  20%|█▉        | 376/1882 [00:01<00:04, 310.74 examples/s]
Map:  22%|██▏       | 417/1882 [00:01<00:05, 292.99 examples/s]
Map:  24%|██▍       | 449/1882 [00:01<00:04, 296.75 examples/s]
Map:  26%|██▋       | 497/1882 [00:01<00:04, 342.00 examples/s]
Map:  29%|██▉       | 543/1882 [00:01<00:04, 322.03 examples/s]
Map:  31%|███       | 584/1882 [00:01<00:03, 343.19 examples/s]
Map:  34%|███▍      | 644/1882 [00:01<00:03, 397.77 examples/s]
Map:  37%|███▋      | 704/1882 [00:02<00:03, 384.30 examples/s]
Map:  40%|███▉      | 744/1882 [00:02<00:02, 386.88 examples/s]
Map:  42%|████▏     | 793/1882 [00:02<00:03, 351.79 examples/s]
Map:  45%|████▌     | 848/1882 [00:02<00:02, 349.13 examples/s]
Map:  47%|████▋     | 891/1882 [00:02<00:02, 363.06 examples/s]
Map:  49%|████▉     | 931/1882 [00:02<00:02, 363.25 examples/s]
Map:  52%|█████▏    | 982/1882 [00:02<00:02, 398.46 examples/s]
Map:  55%|█████▌    | 1039/1882 [00:03<00:03, 249.04 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 262.33 examples/s]
Map:  59%|█████▉    | 1107/1882 [00:03<00:02, 275.38 examples/s]
Map:  61%|██████    | 1148/1882 [00:03<00:02, 273.07 examples/s]
Map:  63%|██████▎   | 1179/1882 [00:03<00:02, 275.53 examples/s]
Map:  65%|██████▌   | 1226/1882 [00:03<00:02, 285.24 examples/s]
Map:  68%|██████▊   | 1279/1882 [00:03<00:02, 301.03 examples/s]
Map:  70%|███████   | 1322/1882 [00:04<00:01, 328.45 examples/s]
Map:  72%|███████▏  | 1360/1882 [00:04<00:01, 331.88 examples/s]
Map:  75%|███████▍  | 1410/1882 [00:04<00:01, 330.27 examples/s]
Map:  78%|███████▊  | 1469/1882 [00:04<00:01, 296.54 examples/s]
Map:  80%|████████  | 1512/1882 [00:04<00:01, 254.02 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 263.54 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:04<00:01, 291.17 examples/s]
Map:  86%|████████▋ | 1626/1882 [00:05<00:00, 323.00 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 325.56 examples/s]
Map:  90%|█████████ | 1698/1882 [00:05<00:00, 330.20 examples/s]
Map:  92%|█████████▏| 1734/1882 [00:05<00:00, 288.31 examples/s]
Map:  94%|█████████▍| 1767/1882 [00:05<00:00, 288.26 examples/s]
Map:  96%|█████████▌| 1799/1882 [00:05<00:00, 293.00 examples/s]
Map:  98%|█████████▊| 1844/1882 [00:05<00:00, 329.39 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 226.88 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 309.11 examples/s]
10/12/2024 10:36:02 - INFO - __main__ -     ***** Testing *****
10/12/2024 10:36:02 - INFO - __main__ -     Batch size = 8
10/12/2024 10:36:02 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 10:36:03 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 10:36:03 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 10:36:04 - INFO - knnlm -   Reading datastore took 0.9601249694824219 s
10/12/2024 10:36:05 - INFO - knnlm -   Moving index to GPU took 0.9758496284484863 s
10/12/2024 10:36:05 - INFO - __main__ -   ******************************break-into
10/12/2024 10:36:05 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 10:36:05 - INFO - __main__ -     Num examples = 236
10/12/2024 10:36:05 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<32:58,  8.42s/it]
test ppl:   1%|          | 2/236 [00:10<17:52,  4.58s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:30,  3.22s/it]
test ppl:   2%|▏         | 4/236 [00:18<16:51,  4.36s/it]
test ppl:   2%|▏         | 5/236 [00:24<19:05,  4.96s/it]
test ppl:   3%|▎         | 6/236 [00:30<20:19,  5.30s/it]
test ppl:   3%|▎         | 7/236 [00:31<16:02,  4.20s/it]
test ppl:   3%|▎         | 8/236 [00:36<16:07,  4.24s/it]
test ppl:   4%|▍         | 9/236 [00:38<13:35,  3.59s/it]
test ppl:   4%|▍         | 10/236 [00:41<13:02,  3.46s/it]
test ppl:   5%|▍         | 11/236 [00:44<11:47,  3.15s/it]
test ppl:   5%|▌         | 12/236 [00:49<14:55,  4.00s/it]
test ppl:   6%|▌         | 13/236 [00:55<17:03,  4.59s/it]
test ppl:   6%|▌         | 14/236 [01:01<18:36,  5.03s/it]
test ppl:   6%|▋         | 15/236 [01:03<14:23,  3.91s/it]
test ppl:   7%|▋         | 16/236 [01:05<12:06,  3.30s/it]
test ppl:   7%|▋         | 17/236 [01:08<12:24,  3.40s/it]
test ppl:   8%|▊         | 18/236 [01:10<10:29,  2.89s/it]
test ppl:   8%|▊         | 19/236 [01:14<12:09,  3.36s/it]
test ppl:   8%|▊         | 20/236 [01:17<11:16,  3.13s/it]
test ppl:   9%|▉         | 21/236 [01:23<14:13,  3.97s/it]
test ppl:   9%|▉         | 22/236 [01:29<16:15,  4.56s/it]
test ppl:  10%|▉         | 23/236 [01:32<14:07,  3.98s/it]
test ppl:  10%|█         | 24/236 [01:34<12:20,  3.49s/it]
test ppl:  11%|█         | 25/236 [01:36<10:27,  2.98s/it]
test ppl:  11%|█         | 26/236 [01:41<12:39,  3.62s/it]
test ppl:  11%|█▏        | 27/236 [01:44<12:30,  3.59s/it]
test ppl:  12%|█▏        | 28/236 [01:46<10:31,  3.04s/it]
test ppl:  12%|█▏        | 29/236 [01:48<09:48,  2.84s/it]
test ppl:  13%|█▎        | 30/236 [01:50<08:25,  2.45s/it]
test ppl:  13%|█▎        | 31/236 [01:52<07:57,  2.33s/it]
test ppl:  14%|█▎        | 32/236 [01:56<09:40,  2.85s/it]
test ppl:  14%|█▍        | 33/236 [02:02<12:50,  3.80s/it]
test ppl:  14%|█▍        | 34/236 [02:06<13:03,  3.88s/it]
test ppl:  15%|█▍        | 35/236 [02:09<11:40,  3.48s/it]
test ppl:  15%|█▌        | 36/236 [02:15<13:59,  4.20s/it]
test ppl:  16%|█▌        | 37/236 [02:20<15:35,  4.70s/it]
test ppl:  16%|█▌        | 38/236 [02:23<12:53,  3.91s/it]
test ppl:  17%|█▋        | 39/236 [02:27<13:18,  4.06s/it]
test ppl:  17%|█▋        | 40/236 [02:30<11:48,  3.61s/it]
test ppl:  17%|█▋        | 41/236 [02:31<10:02,  3.09s/it]
test ppl:  18%|█▊        | 42/236 [02:37<12:46,  3.95s/it]
test ppl:  18%|█▊        | 43/236 [02:43<14:35,  4.53s/it]
test ppl:  19%|█▊        | 44/236 [02:46<12:26,  3.89s/it]
test ppl:  19%|█▉        | 45/236 [02:48<10:33,  3.32s/it]
test ppl:  19%|█▉        | 46/236 [02:54<12:59,  4.10s/it]
test ppl:  20%|█▉        | 47/236 [02:55<10:29,  3.33s/it]
test ppl:  20%|██        | 48/236 [03:01<12:48,  4.09s/it]
test ppl:  21%|██        | 49/236 [03:05<12:21,  3.96s/it]
test ppl:  21%|██        | 50/236 [03:11<14:06,  4.55s/it]
test ppl:  22%|██▏       | 51/236 [03:15<13:56,  4.52s/it]
test ppl:  22%|██▏       | 52/236 [03:21<15:07,  4.93s/it]
test ppl:  22%|██▏       | 53/236 [03:25<14:36,  4.79s/it]
test ppl:  23%|██▎       | 54/236 [03:27<11:34,  3.81s/it]
test ppl:  23%|██▎       | 55/236 [03:33<13:09,  4.36s/it]
test ppl:  24%|██▎       | 56/236 [03:38<14:28,  4.82s/it]
test ppl:  24%|██▍       | 57/236 [03:41<12:08,  4.07s/it]
test ppl:  25%|██▍       | 58/236 [03:43<10:23,  3.50s/it]
test ppl:  25%|██▌       | 59/236 [03:49<12:26,  4.22s/it]
test ppl:  25%|██▌       | 60/236 [03:52<11:17,  3.85s/it]
test ppl:  26%|██▌       | 61/236 [03:58<12:59,  4.45s/it]
test ppl:  26%|██▋       | 62/236 [04:04<14:08,  4.88s/it]
test ppl:  27%|██▋       | 63/236 [04:06<11:58,  4.15s/it]
test ppl:  27%|██▋       | 64/236 [04:08<09:59,  3.49s/it]
test ppl:  28%|██▊       | 65/236 [04:09<08:05,  2.84s/it]
test ppl:  28%|██▊       | 66/236 [04:12<08:14,  2.91s/it]
test ppl:  28%|██▊       | 67/236 [04:15<07:41,  2.73s/it]
test ppl:  29%|██▉       | 68/236 [04:21<10:18,  3.68s/it]
test ppl:  29%|██▉       | 69/236 [04:26<12:04,  4.34s/it]
test ppl:  30%|██▉       | 70/236 [04:28<09:28,  3.42s/it]
test ppl:  30%|███       | 71/236 [04:31<09:17,  3.38s/it]
test ppl:  31%|███       | 72/236 [04:35<09:36,  3.51s/it]
test ppl:  31%|███       | 73/236 [04:39<10:22,  3.82s/it]
test ppl:  31%|███▏      | 74/236 [04:41<08:26,  3.13s/it]
test ppl:  32%|███▏      | 75/236 [04:47<10:36,  3.95s/it]
test ppl:  32%|███▏      | 76/236 [04:50<10:10,  3.82s/it]
test ppl:  33%|███▎      | 77/236 [04:52<08:53,  3.36s/it]
test ppl:  33%|███▎      | 78/236 [04:54<07:23,  2.81s/it]
test ppl:  33%|███▎      | 79/236 [04:58<08:13,  3.14s/it]
test ppl:  34%|███▍      | 80/236 [04:59<06:51,  2.64s/it]
test ppl:  34%|███▍      | 81/236 [05:05<09:18,  3.61s/it]
test ppl:  35%|███▍      | 82/236 [05:11<11:01,  4.30s/it]
test ppl:  35%|███▌      | 83/236 [05:17<12:10,  4.78s/it]
test ppl:  36%|███▌      | 84/236 [05:19<09:45,  3.85s/it]
test ppl:  36%|███▌      | 85/236 [05:23<09:56,  3.95s/it]
test ppl:  36%|███▋      | 86/236 [05:29<11:18,  4.53s/it]
test ppl:  37%|███▋      | 87/236 [05:31<09:26,  3.80s/it]
test ppl:  37%|███▋      | 88/236 [05:37<10:54,  4.42s/it]
test ppl:  38%|███▊      | 89/236 [05:39<09:01,  3.68s/it]
test ppl:  38%|███▊      | 90/236 [05:45<10:33,  4.34s/it]
test ppl:  39%|███▊      | 91/236 [05:50<11:34,  4.79s/it]
test ppl:  39%|███▉      | 92/236 [05:53<10:04,  4.20s/it]
test ppl:  39%|███▉      | 93/236 [05:59<11:11,  4.69s/it]
test ppl:  40%|███▉      | 94/236 [06:05<11:56,  5.05s/it]
test ppl:  40%|████      | 95/236 [06:07<10:03,  4.28s/it]
test ppl:  41%|████      | 96/236 [06:10<09:03,  3.88s/it]
test ppl:  41%|████      | 97/236 [06:16<10:22,  4.48s/it]
test ppl:  42%|████▏     | 98/236 [06:22<11:15,  4.89s/it]
test ppl:  42%|████▏     | 99/236 [06:28<11:51,  5.19s/it]
test ppl:  42%|████▏     | 100/236 [06:29<09:04,  4.01s/it]
test ppl:  43%|████▎     | 101/236 [06:35<10:16,  4.56s/it]
test ppl:  43%|████▎     | 102/236 [06:39<09:33,  4.28s/it]
test ppl:  44%|████▎     | 103/236 [06:40<07:35,  3.42s/it]
test ppl:  44%|████▍     | 104/236 [06:44<08:01,  3.65s/it]
test ppl:  44%|████▍     | 105/236 [06:49<08:27,  3.87s/it]
test ppl:  45%|████▍     | 106/236 [06:54<09:22,  4.33s/it]
test ppl:  45%|████▌     | 107/236 [06:56<07:45,  3.61s/it]
test ppl:  46%|████▌     | 108/236 [07:02<09:01,  4.23s/it]
test ppl:  46%|████▌     | 109/236 [07:06<08:49,  4.17s/it]
test ppl:  47%|████▋     | 110/236 [07:09<07:50,  3.74s/it]
test ppl:  47%|████▋     | 111/236 [07:13<07:56,  3.81s/it]
test ppl:  47%|████▋     | 112/236 [07:17<08:02,  3.89s/it]
test ppl:  48%|████▊     | 113/236 [07:18<06:40,  3.26s/it]
test ppl:  48%|████▊     | 114/236 [07:22<06:40,  3.28s/it]
test ppl:  49%|████▊     | 115/236 [07:28<08:11,  4.06s/it]
test ppl:  49%|████▉     | 116/236 [07:33<09:12,  4.61s/it]
test ppl:  50%|████▉     | 117/236 [07:35<07:29,  3.78s/it]
test ppl:  50%|█████     | 118/236 [07:40<07:42,  3.92s/it]
test ppl:  50%|█████     | 119/236 [07:41<06:27,  3.31s/it]
test ppl:  51%|█████     | 120/236 [07:43<05:18,  2.75s/it]
test ppl:  51%|█████▏    | 121/236 [07:49<07:03,  3.68s/it]
test ppl:  52%|█████▏    | 122/236 [07:54<07:37,  4.01s/it]
test ppl:  52%|█████▏    | 123/236 [07:56<06:30,  3.45s/it]
test ppl:  53%|█████▎    | 124/236 [07:58<05:58,  3.20s/it]
test ppl:  53%|█████▎    | 125/236 [08:01<05:31,  2.99s/it]
test ppl:  53%|█████▎    | 126/236 [08:04<05:50,  3.18s/it]
test ppl:  54%|█████▍    | 127/236 [08:07<05:11,  2.86s/it]
test ppl:  54%|█████▍    | 128/236 [08:12<06:45,  3.76s/it]
test ppl:  55%|█████▍    | 129/236 [08:15<06:14,  3.50s/it]
test ppl:  55%|█████▌    | 130/236 [08:19<06:13,  3.53s/it]
test ppl:  56%|█████▌    | 131/236 [08:25<07:24,  4.23s/it]
test ppl:  56%|█████▌    | 132/236 [08:27<06:25,  3.70s/it]
test ppl:  56%|█████▋    | 133/236 [08:31<06:27,  3.77s/it]
test ppl:  57%|█████▋    | 134/236 [08:35<06:14,  3.67s/it]
test ppl:  57%|█████▋    | 135/236 [08:40<07:18,  4.34s/it]
test ppl:  58%|█████▊    | 136/236 [08:42<05:44,  3.44s/it]
test ppl:  58%|█████▊    | 137/236 [08:48<06:53,  4.18s/it]
test ppl:  58%|█████▊    | 138/236 [08:54<07:39,  4.69s/it]
test ppl:  59%|█████▉    | 139/236 [08:56<06:33,  4.06s/it]
test ppl:  59%|█████▉    | 140/236 [08:58<05:21,  3.34s/it]
test ppl:  60%|█████▉    | 141/236 [09:01<05:04,  3.21s/it]
test ppl:  60%|██████    | 142/236 [09:03<04:30,  2.88s/it]
test ppl:  61%|██████    | 143/236 [09:06<04:24,  2.84s/it]
test ppl:  61%|██████    | 144/236 [09:08<04:18,  2.81s/it]
test ppl:  61%|██████▏   | 145/236 [09:14<05:39,  3.73s/it]
test ppl:  62%|██████▏   | 146/236 [09:19<05:58,  3.98s/it]
test ppl:  62%|██████▏   | 147/236 [09:25<06:47,  4.58s/it]
test ppl:  63%|██████▎   | 148/236 [09:31<07:19,  5.00s/it]
test ppl:  63%|██████▎   | 149/236 [09:34<06:32,  4.51s/it]
test ppl:  64%|██████▎   | 150/236 [09:37<05:38,  3.94s/it]
test ppl:  64%|██████▍   | 151/236 [09:43<06:24,  4.53s/it]
test ppl:  64%|██████▍   | 152/236 [09:48<06:53,  4.93s/it]
test ppl:  65%|██████▍   | 153/236 [09:54<07:12,  5.21s/it]
test ppl:  65%|██████▌   | 154/236 [09:57<06:01,  4.41s/it]
test ppl:  66%|██████▌   | 155/236 [10:00<05:15,  3.89s/it]
test ppl:  66%|██████▌   | 156/236 [10:02<04:30,  3.38s/it]
test ppl:  67%|██████▋   | 157/236 [10:04<03:57,  3.01s/it]
test ppl:  67%|██████▋   | 158/236 [10:10<05:01,  3.87s/it]
test ppl:  67%|██████▋   | 159/236 [10:16<05:44,  4.47s/it]
test ppl:  68%|██████▊   | 160/236 [10:17<04:24,  3.48s/it]
test ppl:  68%|██████▊   | 161/236 [10:18<03:33,  2.85s/it]
test ppl:  69%|██████▊   | 162/236 [10:20<03:14,  2.63s/it]
test ppl:  69%|██████▉   | 163/236 [10:23<03:06,  2.55s/it]
test ppl:  69%|██████▉   | 164/236 [10:26<03:25,  2.85s/it]
test ppl:  70%|██████▉   | 165/236 [10:30<03:45,  3.17s/it]
test ppl:  70%|███████   | 166/236 [10:32<03:11,  2.73s/it]
test ppl:  71%|███████   | 167/236 [10:34<02:51,  2.49s/it]
test ppl:  71%|███████   | 168/236 [10:35<02:31,  2.23s/it]
test ppl:  72%|███████▏  | 169/236 [10:38<02:39,  2.38s/it]
test ppl:  72%|███████▏  | 170/236 [10:44<03:47,  3.45s/it]
test ppl:  72%|███████▏  | 171/236 [10:46<03:08,  2.90s/it]
test ppl:  73%|███████▎  | 172/236 [10:48<02:54,  2.72s/it]
test ppl:  73%|███████▎  | 173/236 [10:52<03:13,  3.07s/it]
test ppl:  74%|███████▎  | 174/236 [10:55<03:10,  3.08s/it]
test ppl:  74%|███████▍  | 175/236 [10:57<02:45,  2.71s/it]
test ppl:  75%|███████▍  | 176/236 [11:03<03:39,  3.66s/it]
test ppl:  75%|███████▌  | 177/236 [11:09<04:15,  4.33s/it]
test ppl:  75%|███████▌  | 178/236 [11:15<04:39,  4.81s/it]
test ppl:  76%|███████▌  | 179/236 [11:20<04:52,  5.13s/it]
test ppl:  76%|███████▋  | 180/236 [11:24<04:18,  4.62s/it]
test ppl:  77%|███████▋  | 181/236 [11:30<04:34,  5.00s/it]
test ppl:  77%|███████▋  | 182/236 [11:32<03:39,  4.06s/it]
test ppl:  78%|███████▊  | 183/236 [11:34<03:07,  3.53s/it]
test ppl:  78%|███████▊  | 184/236 [11:36<02:34,  2.97s/it]
test ppl:  78%|███████▊  | 185/236 [11:41<03:16,  3.86s/it]
test ppl:  79%|███████▉  | 186/236 [11:44<02:46,  3.34s/it]
test ppl:  79%|███████▉  | 187/236 [11:50<03:22,  4.13s/it]
test ppl:  80%|███████▉  | 188/236 [11:55<03:43,  4.66s/it]
test ppl:  80%|████████  | 189/236 [12:01<03:56,  5.03s/it]
test ppl:  81%|████████  | 190/236 [12:06<03:40,  4.80s/it]
test ppl:  81%|████████  | 191/236 [12:09<03:22,  4.50s/it]
test ppl:  81%|████████▏ | 192/236 [12:12<02:53,  3.94s/it]
test ppl:  82%|████████▏ | 193/236 [12:18<03:14,  4.53s/it]
test ppl:  82%|████████▏ | 194/236 [12:21<02:46,  3.96s/it]
test ppl:  83%|████████▎ | 195/236 [12:24<02:31,  3.69s/it]
test ppl:  83%|████████▎ | 196/236 [12:26<02:07,  3.18s/it]
test ppl:  83%|████████▎ | 197/236 [12:28<01:53,  2.92s/it]
test ppl:  84%|████████▍ | 198/236 [12:34<02:24,  3.81s/it]
test ppl:  84%|████████▍ | 199/236 [12:37<02:14,  3.64s/it]
test ppl:  85%|████████▍ | 200/236 [12:43<02:35,  4.32s/it]
test ppl:  85%|████████▌ | 201/236 [12:45<02:07,  3.64s/it]
test ppl:  86%|████████▌ | 202/236 [12:51<02:26,  4.31s/it]
test ppl:  86%|████████▌ | 203/236 [12:57<02:37,  4.79s/it]
test ppl:  86%|████████▋ | 204/236 [12:59<02:03,  3.85s/it]
test ppl:  87%|████████▋ | 205/236 [13:04<02:18,  4.47s/it]
test ppl:  87%|████████▋ | 206/236 [13:08<02:03,  4.13s/it]
test ppl:  88%|████████▊ | 207/236 [13:14<02:15,  4.66s/it]
test ppl:  88%|████████▊ | 208/236 [13:16<01:54,  4.08s/it]
test ppl:  89%|████████▊ | 209/236 [13:22<02:05,  4.65s/it]
test ppl:  89%|████████▉ | 210/236 [13:25<01:42,  3.96s/it]
test ppl:  89%|████████▉ | 211/236 [13:29<01:39,  3.98s/it]
test ppl:  90%|████████▉ | 212/236 [13:35<01:48,  4.54s/it]
test ppl:  90%|█████████ | 213/236 [13:40<01:53,  4.94s/it]
test ppl:  91%|█████████ | 214/236 [13:42<01:24,  3.86s/it]
test ppl:  91%|█████████ | 215/236 [13:48<01:33,  4.47s/it]
test ppl:  92%|█████████▏| 216/236 [13:50<01:16,  3.84s/it]
test ppl:  92%|█████████▏| 217/236 [13:56<01:25,  4.48s/it]
test ppl:  92%|█████████▏| 218/236 [13:58<01:06,  3.71s/it]
test ppl:  93%|█████████▎| 219/236 [14:04<01:14,  4.38s/it]
test ppl:  93%|█████████▎| 220/236 [14:08<01:08,  4.26s/it]
test ppl:  94%|█████████▎| 221/236 [14:10<00:52,  3.51s/it]
test ppl:  94%|█████████▍| 222/236 [14:16<00:59,  4.24s/it]
test ppl:  94%|█████████▍| 223/236 [14:21<01:01,  4.74s/it]
test ppl:  95%|█████████▍| 224/236 [14:23<00:45,  3.78s/it]
test ppl:  95%|█████████▌| 225/236 [14:26<00:37,  3.45s/it]
test ppl:  96%|█████████▌| 226/236 [14:28<00:31,  3.17s/it]
test ppl:  96%|█████████▌| 227/236 [14:30<00:24,  2.77s/it]
test ppl:  97%|█████████▋| 228/236 [14:32<00:19,  2.45s/it]
test ppl:  97%|█████████▋| 229/236 [14:38<00:24,  3.47s/it]
test ppl:  97%|█████████▋| 230/236 [14:41<00:20,  3.47s/it]
test ppl:  98%|█████████▊| 231/236 [14:44<00:17,  3.43s/it]
test ppl:  98%|█████████▊| 232/236 [14:46<00:11,  2.93s/it]
test ppl:  99%|█████████▊| 233/236 [14:48<00:08,  2.69s/it]
test ppl:  99%|█████████▉| 234/236 [14:50<00:04,  2.25s/it]
test ppl: 100%|█████████▉| 235/236 [14:55<00:03,  3.35s/it]
test ppl: 100%|██████████| 236/236 [14:56<00:00,  2.63s/it]
test ppl: 100%|██████████| 236/236 [14:56<00:00,  3.80s/it]
10/12/2024 10:51:02 - INFO - __main__ -    em: 0.2115
10/12/2024 10:51:02 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.4 20:  em: 0.2115

--------------------------------------------------------------------------------
Running experiment with knn_temp=20, lmbda=0.4, k=64
2024-10-12 10:51:09.098524: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 10:51:09.118021: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 10:51:09.139710: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 10:51:09.146363: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 10:51:09.162213: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 10:51:10.150120: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 10:51:11 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.4, knn_temp=20, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 10:51:11 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:40:15,  2.20it/s]
Adding feature api:   4%|▍         | 7372/187062 [00:00<00:10, 17597.97it/s]
Adding feature api:   8%|▊         | 15840/187062 [00:00<00:04, 34656.83it/s]
Adding feature api:  13%|█▎        | 24354/187062 [00:00<00:03, 48108.80it/s]
Adding feature api:  18%|█▊        | 32865/187062 [00:00<00:02, 58308.75it/s]
Adding feature api:  22%|██▏       | 41401/187062 [00:00<00:02, 65951.89it/s]
Adding feature api:  27%|██▋       | 49929/187062 [00:01<00:01, 71508.67it/s]
Adding feature api:  31%|███▏      | 58458/187062 [00:01<00:01, 75520.21it/s]
Adding feature api:  36%|███▌      | 66996/187062 [00:01<00:01, 78414.44it/s]
Adding feature api:  40%|████      | 75560/187062 [00:01<00:01, 80547.75it/s]
Adding feature api:  45%|████▍     | 84175/187062 [00:01<00:01, 82209.25it/s]
Adding feature api:  50%|████▉     | 92736/187062 [00:01<00:01, 83220.92it/s]
Adding feature api:  54%|█████▍    | 101237/187062 [00:01<00:01, 83753.32it/s]
Adding feature api:  59%|█████▊    | 109738/187062 [00:01<00:00, 83454.76it/s]
Adding feature api:  63%|██████▎   | 118296/187062 [00:01<00:00, 84084.61it/s]
Adding feature api:  68%|██████▊   | 126824/187062 [00:01<00:00, 84440.05it/s]
Adding feature api:  72%|███████▏  | 135323/187062 [00:02<00:00, 84601.39it/s]
Adding feature api:  77%|███████▋  | 143825/187062 [00:02<00:00, 84726.03it/s]
Adding feature api:  81%|████████▏ | 152377/187062 [00:02<00:00, 84961.28it/s]
Adding feature api:  86%|████████▌ | 160925/187062 [00:02<00:00, 85115.24it/s]
Adding feature api:  91%|█████████ | 169505/187062 [00:02<00:00, 85318.48it/s]
Adding feature api:  95%|█████████▌| 178045/187062 [00:02<00:00, 83590.13it/s]
Adding feature api: 100%|█████████▉| 186417/187062 [00:02<00:00, 53927.41it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 65143.29it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:44:38,  2.19it/s]
Adding feature datatype:   4%|▍         | 7243/187062 [00:00<00:10, 17249.50it/s]
Adding feature datatype:   8%|▊         | 15464/187062 [00:00<00:05, 33740.27it/s]
Adding feature datatype:  13%|█▎        | 23758/187062 [00:00<00:03, 46832.95it/s]
Adding feature datatype:  17%|█▋        | 32085/187062 [00:00<00:02, 56869.29it/s]
Adding feature datatype:  22%|██▏       | 40411/187062 [00:00<00:02, 64321.31it/s]
Adding feature datatype:  26%|██▌       | 48700/187062 [00:01<00:01, 69657.18it/s]
Adding feature datatype:  30%|███       | 57050/187062 [00:01<00:01, 73686.25it/s]
Adding feature datatype:  35%|███▍      | 65421/187062 [00:01<00:01, 76627.95it/s]
Adding feature datatype:  39%|███▉      | 73764/187062 [00:01<00:01, 78637.69it/s]
Adding feature datatype:  44%|████▍     | 82155/187062 [00:01<00:01, 80199.60it/s]
Adding feature datatype:  48%|████▊     | 90423/187062 [00:01<00:01, 80935.53it/s]
Adding feature datatype:  53%|█████▎    | 98751/187062 [00:01<00:01, 81632.47it/s]
Adding feature datatype:  57%|█████▋    | 107115/187062 [00:01<00:00, 82229.10it/s]
Adding feature datatype:  62%|██████▏   | 115504/187062 [00:01<00:00, 82722.97it/s]
Adding feature datatype:  66%|██████▌   | 123875/187062 [00:01<00:00, 83015.90it/s]
Adding feature datatype:  71%|███████   | 132219/187062 [00:02<00:00, 83095.85it/s]
Adding feature datatype:  75%|███████▌  | 140559/187062 [00:02<00:00, 83177.61it/s]
Adding feature datatype:  80%|███████▉  | 148909/187062 [00:02<00:00, 83272.23it/s]
Adding feature datatype:  84%|████████▍ | 157256/187062 [00:02<00:00, 83329.64it/s]
Adding feature datatype:  89%|████████▊ | 165600/187062 [00:02<00:00, 83324.81it/s]
Adding feature datatype:  93%|█████████▎| 173940/187062 [00:02<00:00, 83325.99it/s]
Adding feature datatype:  97%|█████████▋| 182278/187062 [00:02<00:00, 62607.09it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 64069.03it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:53:14,  2.18it/s]
Adding feature literal:   4%|▍         | 7158/187062 [00:00<00:10, 16968.94it/s]
Adding feature literal:   8%|▊         | 15379/187062 [00:00<00:05, 33474.07it/s]
Adding feature literal:  13%|█▎        | 23605/187062 [00:00<00:03, 46423.56it/s]
Adding feature literal:  17%|█▋        | 31887/187062 [00:00<00:02, 56430.48it/s]
Adding feature literal:  21%|██▏       | 40171/187062 [00:00<00:02, 63876.17it/s]
Adding feature literal:  26%|██▌       | 48462/187062 [00:01<00:01, 69339.70it/s]
Adding feature literal:  30%|███       | 56728/187062 [00:01<00:01, 73212.95it/s]
Adding feature literal:  35%|███▍      | 64966/187062 [00:01<00:01, 75901.76it/s]
Adding feature literal:  39%|███▉      | 73253/187062 [00:01<00:01, 77959.58it/s]
Adding feature literal:  44%|████▎     | 81516/187062 [00:01<00:01, 79343.39it/s]
Adding feature literal:  48%|████▊     | 89698/187062 [00:01<00:01, 79672.25it/s]
Adding feature literal:  52%|█████▏    | 97988/187062 [00:01<00:01, 80628.85it/s]
Adding feature literal:  57%|█████▋    | 106316/187062 [00:01<00:00, 81417.07it/s]
Adding feature literal:  61%|██████▏   | 114641/187062 [00:01<00:00, 81962.81it/s]
Adding feature literal:  66%|██████▌   | 122949/187062 [00:01<00:00, 82296.25it/s]
Adding feature literal:  70%|███████   | 131283/187062 [00:02<00:00, 82607.78it/s]
Adding feature literal:  75%|███████▍  | 139574/187062 [00:02<00:00, 82637.01it/s]
Adding feature literal:  79%|███████▉  | 147908/187062 [00:02<00:00, 82846.59it/s]
Adding feature literal:  84%|████████▎ | 156247/187062 [00:02<00:00, 83006.37it/s]
Adding feature literal:  88%|████████▊ | 164558/187062 [00:02<00:00, 83026.96it/s]
Adding feature literal:  92%|█████████▏| 172868/187062 [00:02<00:00, 82978.00it/s]
Adding feature literal:  97%|█████████▋| 181171/187062 [00:02<00:00, 67040.81it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63674.44it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:44:59,  2.19it/s]
Adding feature operator:   4%|▍         | 7153/187062 [00:00<00:10, 17032.25it/s]
Adding feature operator:   8%|▊         | 15353/187062 [00:00<00:05, 33521.86it/s]
Adding feature operator:  13%|█▎        | 23610/187062 [00:00<00:03, 46572.52it/s]
Adding feature operator:  17%|█▋        | 31902/187062 [00:00<00:02, 56582.64it/s]
Adding feature operator:  21%|██▏       | 40180/187062 [00:00<00:02, 63979.41it/s]
Adding feature operator:  26%|██▌       | 48450/187062 [00:01<00:01, 69358.01it/s]
Adding feature operator:  30%|███       | 56718/187062 [00:01<00:01, 73233.93it/s]
Adding feature operator:  35%|███▍      | 64771/187062 [00:01<00:01, 75373.95it/s]
Adding feature operator:  39%|███▉      | 73019/187062 [00:01<00:01, 77471.73it/s]
Adding feature operator:  43%|████▎     | 81339/187062 [00:01<00:01, 79168.98it/s]
Adding feature operator:  48%|████▊     | 89661/187062 [00:01<00:01, 80374.27it/s]
Adding feature operator:  52%|█████▏    | 97989/187062 [00:01<00:01, 81240.70it/s]
Adding feature operator:  57%|█████▋    | 106280/187062 [00:01<00:00, 81738.18it/s]
Adding feature operator:  61%|██████▏   | 114633/187062 [00:01<00:00, 82273.20it/s]
Adding feature operator:  66%|██████▌   | 122980/187062 [00:01<00:00, 82628.43it/s]
Adding feature operator:  70%|███████   | 131323/187062 [00:02<00:00, 82866.48it/s]
Adding feature operator:  75%|███████▍  | 139654/187062 [00:02<00:00, 82998.96it/s]
Adding feature operator:  79%|███████▉  | 147997/187062 [00:02<00:00, 83126.91it/s]
Adding feature operator:  84%|████████▎ | 156325/187062 [00:02<00:00, 83136.52it/s]
Adding feature operator:  88%|████████▊ | 164684/187062 [00:02<00:00, 83271.13it/s]
Adding feature operator:  92%|█████████▏| 173019/187062 [00:02<00:00, 82514.93it/s]
Adding feature operator:  97%|█████████▋| 181278/187062 [00:02<00:00, 66298.87it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63788.81it/s]
[2024-10-12 10:51:54,821] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 10:51:56 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 10:51:56 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 41/6548 [00:00<00:16, 388.26 examples/s]
Map:   1%|▏         | 83/6548 [00:00<00:32, 201.15 examples/s]
Map:   2%|▏         | 125/6548 [00:00<00:24, 257.09 examples/s]
Map:   3%|▎         | 173/6548 [00:00<00:20, 317.95 examples/s]
Map:   3%|▎         | 214/6548 [00:00<00:18, 342.37 examples/s]
Map:   4%|▍         | 260/6548 [00:00<00:19, 315.53 examples/s]
Map:   5%|▍         | 302/6548 [00:00<00:19, 316.90 examples/s]
Map:   5%|▌         | 344/6548 [00:01<00:20, 301.09 examples/s]
Map:   6%|▌         | 378/6548 [00:01<00:20, 307.59 examples/s]
Map:   7%|▋         | 429/6548 [00:01<00:17, 358.58 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:20, 299.80 examples/s]
Map:   8%|▊         | 534/6548 [00:01<00:18, 332.86 examples/s]
Map:   9%|▉         | 575/6548 [00:01<00:17, 347.96 examples/s]
Map:   9%|▉         | 620/6548 [00:01<00:18, 324.65 examples/s]
Map:  10%|█         | 658/6548 [00:02<00:19, 295.33 examples/s]
Map:  11%|█         | 703/6548 [00:02<00:17, 329.19 examples/s]
Map:  12%|█▏        | 763/6548 [00:02<00:16, 348.98 examples/s]
Map:  12%|█▏        | 813/6548 [00:02<00:14, 383.36 examples/s]
Map:  13%|█▎        | 854/6548 [00:02<00:14, 379.63 examples/s]
Map:  14%|█▍        | 906/6548 [00:02<00:15, 365.30 examples/s]
Map:  15%|█▍        | 968/6548 [00:02<00:14, 374.52 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:24, 227.28 examples/s]
Map:  16%|█▌        | 1054/6548 [00:03<00:21, 250.58 examples/s]
Map:  17%|█▋        | 1097/6548 [00:03<00:19, 281.42 examples/s]
Map:  17%|█▋        | 1143/6548 [00:03<00:17, 314.55 examples/s]
Map:  18%|█▊        | 1201/6548 [00:03<00:15, 335.67 examples/s]
Map:  19%|█▉        | 1258/6548 [00:03<00:15, 339.81 examples/s]
Map:  20%|█▉        | 1301/6548 [00:04<00:14, 349.80 examples/s]
Map:  21%|██        | 1351/6548 [00:04<00:16, 309.43 examples/s]
Map:  21%|██        | 1390/6548 [00:04<00:17, 291.55 examples/s]
Map:  22%|██▏       | 1430/6548 [00:04<00:16, 311.86 examples/s]
Map:  23%|██▎       | 1480/6548 [00:04<00:17, 284.39 examples/s]
Map:  23%|██▎       | 1515/6548 [00:04<00:17, 294.61 examples/s]
Map:  24%|██▍       | 1557/6548 [00:05<00:17, 279.80 examples/s]
Map:  24%|██▍       | 1596/6548 [00:05<00:17, 285.56 examples/s]
Map:  25%|██▌       | 1637/6548 [00:05<00:17, 279.10 examples/s]
Map:  26%|██▌       | 1678/6548 [00:05<00:18, 268.57 examples/s]
Map:  26%|██▌       | 1717/6548 [00:05<00:16, 292.80 examples/s]
Map:  27%|██▋       | 1765/6548 [00:05<00:14, 331.33 examples/s]
Map:  28%|██▊       | 1806/6548 [00:05<00:13, 350.47 examples/s]
Map:  28%|██▊       | 1845/6548 [00:05<00:13, 354.10 examples/s]
Map:  29%|██▉       | 1899/6548 [00:06<00:13, 345.45 examples/s]
Map:  30%|██▉       | 1952/6548 [00:06<00:13, 343.32 examples/s]
Map:  30%|███       | 1995/6548 [00:06<00:12, 361.99 examples/s]
Map:  31%|███▏      | 2049/6548 [00:06<00:19, 227.55 examples/s]
Map:  32%|███▏      | 2091/6548 [00:06<00:17, 256.71 examples/s]
Map:  32%|███▏      | 2124/6548 [00:06<00:16, 268.70 examples/s]
Map:  33%|███▎      | 2179/6548 [00:07<00:16, 258.38 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:16, 263.64 examples/s]
Map:  34%|███▍      | 2256/6548 [00:07<00:16, 261.00 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:15, 267.20 examples/s]
Map:  36%|███▌      | 2332/6548 [00:07<00:13, 307.01 examples/s]
Map:  36%|███▋      | 2385/6548 [00:07<00:13, 319.18 examples/s]
Map:  37%|███▋      | 2426/6548 [00:07<00:12, 335.82 examples/s]
Map:  38%|███▊      | 2477/6548 [00:08<00:12, 322.59 examples/s]
Map:  38%|███▊      | 2517/6548 [00:08<00:11, 336.51 examples/s]
Map:  39%|███▉      | 2558/6548 [00:08<00:11, 353.28 examples/s]
Map:  40%|███▉      | 2602/6548 [00:08<00:10, 373.91 examples/s]
Map:  40%|████      | 2647/6548 [00:08<00:10, 389.46 examples/s]
Map:  41%|████      | 2689/6548 [00:08<00:11, 339.05 examples/s]
Map:  42%|████▏     | 2726/6548 [00:08<00:11, 345.29 examples/s]
Map:  42%|████▏     | 2770/6548 [00:08<00:10, 369.34 examples/s]
Map:  43%|████▎     | 2819/6548 [00:09<00:10, 343.84 examples/s]
Map:  44%|████▎     | 2862/6548 [00:09<00:12, 292.08 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 297.11 examples/s]
Map:  45%|████▌     | 2950/6548 [00:09<00:11, 306.94 examples/s]
Map:  46%|████▌     | 2988/6548 [00:09<00:11, 309.81 examples/s]
Map:  46%|████▌     | 3026/6548 [00:10<00:20, 168.32 examples/s]
Map:  47%|████▋     | 3062/6548 [00:10<00:17, 195.04 examples/s]
Map:  47%|████▋     | 3097/6548 [00:10<00:15, 221.46 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 252.18 examples/s]
Map:  49%|████▊     | 3183/6548 [00:10<00:14, 239.22 examples/s]
Map:  49%|████▉     | 3218/6548 [00:10<00:14, 234.87 examples/s]
Map:  50%|████▉     | 3245/6548 [00:10<00:13, 239.68 examples/s]
Map:  50%|█████     | 3277/6548 [00:11<00:12, 257.30 examples/s]
Map:  51%|█████     | 3321/6548 [00:11<00:11, 292.21 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:11<00:10, 295.24 examples/s]
Map:  52%|█████▏    | 3404/6548 [00:11<00:11, 266.03 examples/s]
Map:  53%|█████▎    | 3442/6548 [00:11<00:10, 287.76 examples/s]
Map:  53%|█████▎    | 3486/6548 [00:11<00:11, 269.59 examples/s]
Map:  54%|█████▍    | 3532/6548 [00:11<00:09, 310.74 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:11<00:08, 337.54 examples/s]
Map:  55%|█████▌    | 3622/6548 [00:12<00:08, 363.69 examples/s]
Map:  56%|█████▌    | 3661/6548 [00:12<00:07, 367.00 examples/s]
Map:  57%|█████▋    | 3705/6548 [00:12<00:07, 383.94 examples/s]
Map:  57%|█████▋    | 3753/6548 [00:12<00:07, 358.25 examples/s]
Map:  58%|█████▊    | 3800/6548 [00:12<00:07, 384.73 examples/s]
Map:  59%|█████▉    | 3849/6548 [00:12<00:08, 312.70 examples/s]
Map:  59%|█████▉    | 3887/6548 [00:12<00:08, 321.88 examples/s]
Map:  60%|██████    | 3929/6548 [00:12<00:08, 324.56 examples/s]
Map:  61%|██████    | 3973/6548 [00:13<00:07, 340.61 examples/s]
Map:  62%|██████▏   | 4030/6548 [00:13<00:09, 255.31 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 296.77 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 320.27 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:08, 295.90 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:13<00:07, 305.74 examples/s]
Map:  65%|██████▌   | 4260/6548 [00:14<00:06, 345.19 examples/s]
Map:  66%|██████▌   | 4298/6548 [00:14<00:06, 346.53 examples/s]
Map:  66%|██████▋   | 4345/6548 [00:14<00:05, 376.29 examples/s]
Map:  67%|██████▋   | 4400/6548 [00:14<00:05, 358.93 examples/s]
Map:  68%|██████▊   | 4446/6548 [00:14<00:05, 382.59 examples/s]
Map:  69%|██████▊   | 4492/6548 [00:14<00:05, 352.82 examples/s]
Map:  69%|██████▉   | 4532/6548 [00:14<00:06, 321.73 examples/s]
Map:  70%|██████▉   | 4570/6548 [00:14<00:06, 327.88 examples/s]
Map:  71%|███████   | 4626/6548 [00:15<00:05, 332.20 examples/s]
Map:  71%|███████▏  | 4668/6548 [00:15<00:05, 341.24 examples/s]
Map:  72%|███████▏  | 4728/6548 [00:15<00:05, 357.47 examples/s]
Map:  73%|███████▎  | 4769/6548 [00:15<00:04, 367.98 examples/s]
Map:  74%|███████▎  | 4821/6548 [00:15<00:04, 404.57 examples/s]
Map:  74%|███████▍  | 4876/6548 [00:15<00:04, 363.63 examples/s]
Map:  75%|███████▌  | 4937/6548 [00:15<00:04, 374.97 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:16<00:04, 389.45 examples/s]
Map:  77%|███████▋  | 5041/6548 [00:16<00:06, 245.34 examples/s]
Map:  78%|███████▊  | 5076/6548 [00:16<00:05, 259.51 examples/s]
Map:  78%|███████▊  | 5119/6548 [00:16<00:05, 263.87 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:05, 275.19 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 277.02 examples/s]
Map:  80%|███████▉  | 5221/6548 [00:17<00:04, 284.21 examples/s]
Map:  80%|████████  | 5256/6548 [00:17<00:04, 293.35 examples/s]
Map:  81%|████████  | 5312/6548 [00:17<00:03, 359.10 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 308.64 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 300.88 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 330.21 examples/s]
Map:  84%|████████▍ | 5492/6548 [00:17<00:03, 342.27 examples/s]
Map:  84%|████████▍ | 5529/6548 [00:17<00:02, 342.86 examples/s]
Map:  85%|████████▌ | 5570/6548 [00:18<00:02, 355.40 examples/s]
Map:  86%|████████▌ | 5610/6548 [00:18<00:02, 320.35 examples/s]
Map:  86%|████████▌ | 5647/6548 [00:18<00:02, 328.59 examples/s]
Map:  87%|████████▋ | 5697/6548 [00:18<00:02, 318.96 examples/s]
Map:  88%|████████▊ | 5740/6548 [00:18<00:02, 341.41 examples/s]
Map:  88%|████████▊ | 5781/6548 [00:18<00:02, 345.91 examples/s]
Map:  89%|████████▉ | 5825/6548 [00:18<00:02, 346.41 examples/s]
Map:  90%|████████▉ | 5865/6548 [00:18<00:01, 357.42 examples/s]
Map:  90%|█████████ | 5902/6548 [00:19<00:01, 360.05 examples/s]
Map:  91%|█████████ | 5955/6548 [00:19<00:01, 354.31 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 212.51 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:02, 243.70 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 274.18 examples/s]
Map:  93%|█████████▎| 6117/6548 [00:19<00:01, 256.56 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:20<00:01, 272.86 examples/s]
Map:  95%|█████████▍| 6206/6548 [00:20<00:01, 296.62 examples/s]
Map:  95%|█████████▌| 6249/6548 [00:20<00:00, 322.69 examples/s]
Map:  96%|█████████▋| 6304/6548 [00:20<00:00, 335.71 examples/s]
Map:  97%|█████████▋| 6364/6548 [00:20<00:00, 354.14 examples/s]
Map:  98%|█████████▊| 6418/6548 [00:20<00:00, 350.38 examples/s]
Map:  99%|█████████▉| 6469/6548 [00:20<00:00, 383.91 examples/s]
Map: 100%|█████████▉| 6527/6548 [00:21<00:00, 382.52 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 308.35 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 320.83 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 342.90 examples/s]
Map:  13%|█▎        | 116/903 [00:00<00:02, 340.32 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 354.40 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 404.21 examples/s]
Map:  29%|██▉       | 263/903 [00:00<00:01, 375.01 examples/s]
Map:  34%|███▍      | 308/903 [00:00<00:01, 389.19 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 333.72 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 316.80 examples/s]
Map:  51%|█████     | 460/903 [00:01<00:01, 311.58 examples/s]
Map:  57%|█████▋    | 514/903 [00:01<00:01, 322.57 examples/s]
Map:  62%|██████▏   | 559/903 [00:01<00:00, 345.11 examples/s]
Map:  66%|██████▋   | 599/903 [00:01<00:00, 356.61 examples/s]
Map:  70%|███████   | 636/903 [00:01<00:00, 356.65 examples/s]
Map:  75%|███████▍  | 677/903 [00:01<00:00, 365.78 examples/s]
Map:  80%|███████▉  | 718/903 [00:02<00:00, 376.66 examples/s]
Map:  85%|████████▍ | 766/903 [00:02<00:00, 397.71 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 385.18 examples/s]
Map:  96%|█████████▌| 867/903 [00:02<00:00, 388.74 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 325.94 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 36/1882 [00:00<00:06, 280.25 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 348.67 examples/s]
Map:   7%|▋         | 127/1882 [00:00<00:05, 309.06 examples/s]
Map:   9%|▉         | 171/1882 [00:00<00:04, 348.54 examples/s]
Map:  12%|█▏        | 222/1882 [00:00<00:04, 340.29 examples/s]
Map:  14%|█▍        | 266/1882 [00:00<00:04, 366.29 examples/s]
Map:  17%|█▋        | 325/1882 [00:00<00:04, 367.72 examples/s]
Map:  20%|█▉        | 369/1882 [00:01<00:04, 333.60 examples/s]
Map:  21%|██▏       | 404/1882 [00:01<00:05, 292.84 examples/s]
Map:  23%|██▎       | 442/1882 [00:01<00:04, 308.77 examples/s]
Map:  26%|██▋       | 495/1882 [00:01<00:04, 321.94 examples/s]
Map:  28%|██▊       | 532/1882 [00:01<00:04, 281.90 examples/s]
Map:  31%|███       | 576/1882 [00:01<00:04, 309.23 examples/s]
Map:  34%|███▎      | 634/1882 [00:01<00:03, 369.50 examples/s]
Map:  36%|███▌      | 677/1882 [00:02<00:03, 372.57 examples/s]
Map:  39%|███▉      | 733/1882 [00:02<00:03, 365.92 examples/s]
Map:  41%|████      | 773/1882 [00:02<00:03, 353.21 examples/s]
Map:  44%|████▍     | 826/1882 [00:02<00:03, 345.08 examples/s]
Map:  47%|████▋     | 882/1882 [00:02<00:02, 348.80 examples/s]
Map:  49%|████▉     | 922/1882 [00:02<00:02, 354.46 examples/s]
Map:  52%|█████▏    | 973/1882 [00:02<00:02, 388.86 examples/s]
Map:  54%|█████▍    | 1015/1882 [00:03<00:03, 236.17 examples/s]
Map:  56%|█████▌    | 1053/1882 [00:03<00:03, 258.46 examples/s]
Map:  58%|█████▊    | 1098/1882 [00:03<00:02, 265.41 examples/s]
Map:  60%|██████    | 1135/1882 [00:03<00:02, 281.33 examples/s]
Map:  62%|██████▏   | 1170/1882 [00:03<00:02, 296.19 examples/s]
Map:  65%|██████▌   | 1224/1882 [00:03<00:02, 278.25 examples/s]
Map:  67%|██████▋   | 1256/1882 [00:03<00:02, 279.52 examples/s]
Map:  69%|██████▉   | 1303/1882 [00:04<00:01, 322.38 examples/s]
Map:  72%|███████▏  | 1346/1882 [00:04<00:01, 336.34 examples/s]
Map:  74%|███████▍  | 1393/1882 [00:04<00:01, 317.27 examples/s]
Map:  76%|███████▌  | 1428/1882 [00:04<00:01, 281.54 examples/s]
Map:  78%|███████▊  | 1470/1882 [00:04<00:01, 309.63 examples/s]
Map:  80%|███████▉  | 1505/1882 [00:04<00:01, 267.85 examples/s]
Map:  82%|████████▏ | 1549/1882 [00:04<00:01, 273.44 examples/s]
Map:  84%|████████▍ | 1587/1882 [00:05<00:00, 295.85 examples/s]
Map:  87%|████████▋ | 1633/1882 [00:05<00:00, 333.11 examples/s]
Map:  89%|████████▉ | 1672/1882 [00:05<00:00, 306.02 examples/s]
Map:  91%|█████████ | 1716/1882 [00:05<00:00, 336.22 examples/s]
Map:  93%|█████████▎| 1757/1882 [00:05<00:00, 270.75 examples/s]
Map:  96%|█████████▌| 1810/1882 [00:05<00:00, 292.24 examples/s]
Map:  99%|█████████▊| 1855/1882 [00:05<00:00, 325.44 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 303.87 examples/s]
10/12/2024 10:52:58 - INFO - __main__ -     ***** Testing *****
10/12/2024 10:52:58 - INFO - __main__ -     Batch size = 8
10/12/2024 10:52:58 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 10:52:58 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 10:52:58 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 10:52:59 - INFO - knnlm -   Reading datastore took 0.9633200168609619 s
10/12/2024 10:53:00 - INFO - knnlm -   Moving index to GPU took 0.919086217880249 s
10/12/2024 10:53:00 - INFO - __main__ -   ******************************break-into
10/12/2024 10:53:00 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 10:53:00 - INFO - __main__ -     Num examples = 236
10/12/2024 10:53:00 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<34:39,  8.85s/it]
test ppl:   1%|          | 2/236 [00:11<19:29,  5.00s/it]
test ppl:   1%|▏         | 3/236 [00:13<13:56,  3.59s/it]
test ppl:   2%|▏         | 4/236 [00:20<19:54,  5.15s/it]
test ppl:   2%|▏         | 5/236 [00:28<23:00,  5.98s/it]
test ppl:   3%|▎         | 6/236 [00:35<24:45,  6.46s/it]
test ppl:   3%|▎         | 7/236 [00:37<19:29,  5.11s/it]
test ppl:   3%|▎         | 8/236 [00:42<19:32,  5.14s/it]
test ppl:   4%|▍         | 9/236 [00:48<20:20,  5.38s/it]
test ppl:   4%|▍         | 10/236 [00:51<16:42,  4.43s/it]
test ppl:   5%|▍         | 11/236 [00:55<16:26,  4.38s/it]
test ppl:   5%|▌         | 12/236 [01:01<18:03,  4.84s/it]
test ppl:   6%|▌         | 13/236 [01:07<19:08,  5.15s/it]
test ppl:   6%|▌         | 14/236 [01:13<19:54,  5.38s/it]
test ppl:   6%|▋         | 15/236 [01:14<15:16,  4.15s/it]
test ppl:   7%|▋         | 16/236 [01:17<14:04,  3.84s/it]
test ppl:   7%|▋         | 17/236 [01:21<14:34,  4.00s/it]
test ppl:   8%|▊         | 18/236 [01:23<12:00,  3.30s/it]
test ppl:   8%|▊         | 19/236 [01:28<13:12,  3.65s/it]
test ppl:   8%|▊         | 20/236 [01:30<11:58,  3.33s/it]
test ppl:   9%|▉         | 21/236 [01:33<11:46,  3.28s/it]
test ppl:   9%|▉         | 22/236 [01:39<14:30,  4.07s/it]
test ppl:  10%|▉         | 23/236 [01:42<12:52,  3.63s/it]
test ppl:  10%|█         | 24/236 [01:44<11:25,  3.23s/it]
test ppl:  11%|█         | 25/236 [01:46<09:48,  2.79s/it]
test ppl:  11%|█         | 26/236 [01:51<11:59,  3.42s/it]
test ppl:  11%|█▏        | 27/236 [01:54<11:57,  3.43s/it]
test ppl:  12%|█▏        | 28/236 [01:56<09:56,  2.87s/it]
test ppl:  12%|█▏        | 29/236 [01:58<09:20,  2.71s/it]
test ppl:  13%|█▎        | 30/236 [02:00<08:04,  2.35s/it]
test ppl:  13%|█▎        | 31/236 [02:02<07:40,  2.25s/it]
test ppl:  14%|█▎        | 32/236 [02:06<09:24,  2.77s/it]
test ppl:  14%|█▍        | 33/236 [02:12<12:32,  3.71s/it]
test ppl:  14%|█▍        | 34/236 [02:16<12:47,  3.80s/it]
test ppl:  15%|█▍        | 35/236 [02:18<11:27,  3.42s/it]
test ppl:  15%|█▌        | 36/236 [02:24<13:51,  4.16s/it]
test ppl:  16%|█▌        | 37/236 [02:30<15:31,  4.68s/it]
test ppl:  16%|█▌        | 38/236 [02:32<12:52,  3.90s/it]
test ppl:  17%|█▋        | 39/236 [02:36<13:17,  4.05s/it]
test ppl:  17%|█▋        | 40/236 [02:39<11:49,  3.62s/it]
test ppl:  17%|█▋        | 41/236 [02:41<10:03,  3.09s/it]
test ppl:  18%|█▊        | 42/236 [02:47<12:45,  3.94s/it]
test ppl:  18%|█▊        | 43/236 [02:53<14:33,  4.53s/it]
test ppl:  19%|█▊        | 44/236 [02:55<12:24,  3.88s/it]
test ppl:  19%|█▉        | 45/236 [02:57<10:31,  3.31s/it]
test ppl:  19%|█▉        | 46/236 [03:03<12:58,  4.10s/it]
test ppl:  20%|█▉        | 47/236 [03:04<10:29,  3.33s/it]
test ppl:  20%|██        | 48/236 [03:10<12:48,  4.09s/it]
test ppl:  21%|██        | 49/236 [03:13<11:35,  3.72s/it]
test ppl:  21%|██        | 50/236 [03:19<13:37,  4.39s/it]
test ppl:  22%|██▏       | 51/236 [03:24<14:14,  4.62s/it]
test ppl:  22%|██▏       | 52/236 [03:30<15:21,  5.01s/it]
test ppl:  22%|██▏       | 53/236 [03:35<14:53,  4.89s/it]
test ppl:  23%|██▎       | 54/236 [03:36<11:46,  3.88s/it]
test ppl:  23%|██▎       | 55/236 [03:42<13:23,  4.44s/it]
test ppl:  24%|██▎       | 56/236 [03:48<14:40,  4.89s/it]
test ppl:  24%|██▍       | 57/236 [03:51<12:30,  4.19s/it]
test ppl:  25%|██▍       | 58/236 [03:53<10:39,  3.59s/it]
test ppl:  25%|██▌       | 59/236 [03:59<12:39,  4.29s/it]
test ppl:  25%|██▌       | 60/236 [04:02<11:28,  3.91s/it]
test ppl:  26%|██▌       | 61/236 [04:08<13:08,  4.50s/it]
test ppl:  26%|██▋       | 62/236 [04:12<12:44,  4.40s/it]
test ppl:  27%|██▋       | 63/236 [04:14<11:00,  3.82s/it]
test ppl:  27%|██▋       | 64/236 [04:16<09:19,  3.25s/it]
test ppl:  28%|██▊       | 65/236 [04:17<07:37,  2.68s/it]
test ppl:  28%|██▊       | 66/236 [04:21<07:56,  2.80s/it]
test ppl:  28%|██▊       | 67/236 [04:23<07:29,  2.66s/it]
test ppl:  29%|██▉       | 68/236 [04:29<10:10,  3.63s/it]
test ppl:  29%|██▉       | 69/236 [04:35<12:00,  4.32s/it]
test ppl:  30%|██▉       | 70/236 [04:36<09:25,  3.41s/it]
test ppl:  30%|███       | 71/236 [04:40<09:53,  3.60s/it]
test ppl:  31%|███       | 72/236 [04:44<10:02,  3.67s/it]
test ppl:  31%|███       | 73/236 [04:48<10:40,  3.93s/it]
test ppl:  31%|███▏      | 74/236 [04:50<08:38,  3.20s/it]
test ppl:  32%|███▏      | 75/236 [04:56<10:44,  4.00s/it]
test ppl:  32%|███▏      | 76/236 [04:59<10:16,  3.85s/it]
test ppl:  33%|███▎      | 77/236 [05:02<08:57,  3.38s/it]
test ppl:  33%|███▎      | 78/236 [05:03<07:26,  2.82s/it]
test ppl:  33%|███▎      | 79/236 [05:07<08:16,  3.16s/it]
test ppl:  34%|███▍      | 80/236 [05:09<06:53,  2.65s/it]
test ppl:  34%|███▍      | 81/236 [05:14<09:20,  3.61s/it]
test ppl:  35%|███▍      | 82/236 [05:20<11:04,  4.32s/it]
test ppl:  35%|███▌      | 83/236 [05:25<11:35,  4.54s/it]
test ppl:  36%|███▌      | 84/236 [05:27<09:26,  3.73s/it]
test ppl:  36%|███▌      | 85/236 [05:31<09:43,  3.86s/it]
test ppl:  36%|███▋      | 86/236 [05:37<11:09,  4.47s/it]
test ppl:  37%|███▋      | 87/236 [05:39<09:19,  3.76s/it]
test ppl:  37%|███▋      | 88/236 [05:45<10:50,  4.39s/it]
test ppl:  38%|███▊      | 89/236 [05:47<08:59,  3.67s/it]
test ppl:  38%|███▊      | 90/236 [05:53<10:33,  4.34s/it]
test ppl:  39%|███▊      | 91/236 [05:58<10:55,  4.52s/it]
test ppl:  39%|███▉      | 92/236 [06:01<09:37,  4.01s/it]
test ppl:  39%|███▉      | 93/236 [06:07<10:53,  4.57s/it]
test ppl:  40%|███▉      | 94/236 [06:13<11:45,  4.97s/it]
test ppl:  40%|████      | 95/236 [06:16<10:14,  4.36s/it]
test ppl:  41%|████      | 96/236 [06:19<09:12,  3.95s/it]
test ppl:  41%|████      | 97/236 [06:25<10:30,  4.53s/it]
test ppl:  42%|████▏     | 98/236 [06:30<11:21,  4.94s/it]
test ppl:  42%|████▏     | 99/236 [06:36<11:55,  5.22s/it]
test ppl:  42%|████▏     | 100/236 [06:38<09:08,  4.03s/it]
test ppl:  43%|████▎     | 101/236 [06:43<10:19,  4.59s/it]
test ppl:  43%|████▎     | 102/236 [06:47<09:37,  4.31s/it]
test ppl:  44%|████▎     | 103/236 [06:48<07:37,  3.44s/it]
test ppl:  44%|████▍     | 104/236 [06:53<08:05,  3.67s/it]
test ppl:  44%|████▍     | 105/236 [06:57<08:30,  3.89s/it]
test ppl:  45%|████▍     | 106/236 [07:03<09:25,  4.35s/it]
test ppl:  45%|████▌     | 107/236 [07:04<07:48,  3.63s/it]
test ppl:  46%|████▌     | 108/236 [07:10<09:05,  4.26s/it]
test ppl:  46%|████▌     | 109/236 [07:14<08:52,  4.19s/it]
test ppl:  47%|████▋     | 110/236 [07:17<07:53,  3.76s/it]
test ppl:  47%|████▋     | 111/236 [07:21<07:59,  3.84s/it]
test ppl:  47%|████▋     | 112/236 [07:25<08:10,  3.96s/it]
test ppl:  48%|████▊     | 113/236 [07:27<06:46,  3.30s/it]
test ppl:  48%|████▊     | 114/236 [07:30<06:44,  3.32s/it]
test ppl:  49%|████▊     | 115/236 [07:36<08:14,  4.09s/it]
test ppl:  49%|████▉     | 116/236 [07:42<09:16,  4.63s/it]
test ppl:  50%|████▉     | 117/236 [07:44<07:32,  3.80s/it]
test ppl:  50%|█████     | 118/236 [07:48<07:45,  3.94s/it]
test ppl:  50%|█████     | 119/236 [07:50<06:28,  3.32s/it]
test ppl:  51%|█████     | 120/236 [07:52<05:19,  2.76s/it]
test ppl:  51%|█████▏    | 121/236 [07:57<07:04,  3.69s/it]
test ppl:  52%|█████▏    | 122/236 [08:02<07:38,  4.03s/it]
test ppl:  52%|█████▏    | 123/236 [08:04<06:31,  3.46s/it]
test ppl:  53%|█████▎    | 124/236 [08:07<06:12,  3.33s/it]
test ppl:  53%|█████▎    | 125/236 [08:11<06:23,  3.45s/it]
test ppl:  53%|█████▎    | 126/236 [08:15<06:26,  3.51s/it]
test ppl:  54%|█████▍    | 127/236 [08:17<05:36,  3.09s/it]
test ppl:  54%|█████▍    | 128/236 [08:21<05:52,  3.26s/it]
test ppl:  55%|█████▍    | 129/236 [08:24<05:37,  3.16s/it]
test ppl:  55%|█████▌    | 130/236 [08:27<05:48,  3.29s/it]
test ppl:  56%|█████▌    | 131/236 [08:33<07:07,  4.07s/it]
test ppl:  56%|█████▌    | 132/236 [08:36<06:13,  3.59s/it]
test ppl:  56%|█████▋    | 133/236 [08:39<06:20,  3.69s/it]
test ppl:  57%|█████▋    | 134/236 [08:43<06:08,  3.61s/it]
test ppl:  57%|█████▋    | 135/236 [08:49<07:13,  4.30s/it]
test ppl:  58%|█████▊    | 136/236 [08:50<05:41,  3.41s/it]
test ppl:  58%|█████▊    | 137/236 [08:56<06:52,  4.17s/it]
test ppl:  58%|█████▊    | 138/236 [09:02<07:38,  4.68s/it]
test ppl:  59%|█████▉    | 139/236 [09:05<06:33,  4.06s/it]
test ppl:  59%|█████▉    | 140/236 [09:06<05:21,  3.35s/it]
test ppl:  60%|█████▉    | 141/236 [09:09<05:04,  3.21s/it]
test ppl:  60%|██████    | 142/236 [09:11<04:30,  2.88s/it]
test ppl:  61%|██████    | 143/236 [09:17<05:52,  3.79s/it]
test ppl:  61%|██████    | 144/236 [09:20<05:19,  3.48s/it]
test ppl:  61%|██████▏   | 145/236 [09:26<06:22,  4.20s/it]
test ppl:  62%|██████▏   | 146/236 [09:30<06:26,  4.30s/it]
test ppl:  62%|██████▏   | 147/236 [09:36<07:05,  4.78s/it]
test ppl:  63%|██████▎   | 148/236 [09:42<07:33,  5.16s/it]
test ppl:  63%|██████▎   | 149/236 [09:48<07:48,  5.38s/it]
test ppl:  64%|██████▎   | 150/236 [09:54<07:56,  5.54s/it]
test ppl:  64%|██████▍   | 151/236 [10:00<07:59,  5.64s/it]
test ppl:  64%|██████▍   | 152/236 [10:06<07:59,  5.70s/it]
test ppl:  65%|██████▍   | 153/236 [10:12<07:57,  5.75s/it]
test ppl:  65%|██████▌   | 154/236 [10:14<06:31,  4.78s/it]
test ppl:  66%|██████▌   | 155/236 [10:17<05:36,  4.15s/it]
test ppl:  66%|██████▌   | 156/236 [10:19<04:44,  3.56s/it]
test ppl:  67%|██████▋   | 157/236 [10:21<04:08,  3.14s/it]
test ppl:  67%|██████▋   | 158/236 [10:27<05:09,  3.96s/it]
test ppl:  67%|██████▋   | 159/236 [10:33<05:49,  4.54s/it]
test ppl:  68%|██████▊   | 160/236 [10:34<04:28,  3.53s/it]
test ppl:  68%|██████▊   | 161/236 [10:35<03:36,  2.88s/it]
test ppl:  69%|██████▊   | 162/236 [10:39<03:38,  2.96s/it]
test ppl:  69%|██████▉   | 163/236 [10:41<03:23,  2.78s/it]
test ppl:  69%|██████▉   | 164/236 [10:45<03:37,  3.02s/it]
test ppl:  70%|██████▉   | 165/236 [10:49<03:56,  3.33s/it]
test ppl:  70%|███████   | 166/236 [10:50<03:19,  2.85s/it]
test ppl:  71%|███████   | 167/236 [10:52<03:01,  2.62s/it]
test ppl:  71%|███████   | 168/236 [10:54<02:38,  2.33s/it]
test ppl:  72%|███████▏  | 169/236 [10:59<03:29,  3.12s/it]
test ppl:  72%|███████▏  | 170/236 [11:05<04:22,  3.98s/it]
test ppl:  72%|███████▏  | 171/236 [11:07<03:32,  3.26s/it]
test ppl:  73%|███████▎  | 172/236 [11:13<04:19,  4.06s/it]
test ppl:  73%|███████▎  | 173/236 [11:16<04:12,  4.01s/it]
test ppl:  74%|███████▎  | 174/236 [11:20<03:51,  3.74s/it]
test ppl:  74%|███████▍  | 175/236 [11:21<03:13,  3.17s/it]
test ppl:  75%|███████▍  | 176/236 [11:27<03:58,  3.97s/it]
test ppl:  75%|███████▌  | 177/236 [11:33<04:29,  4.56s/it]
test ppl:  75%|███████▌  | 178/236 [11:39<04:48,  4.97s/it]
test ppl:  76%|███████▌  | 179/236 [11:45<04:59,  5.26s/it]
test ppl:  76%|███████▋  | 180/236 [11:48<04:23,  4.71s/it]
test ppl:  77%|███████▋  | 181/236 [11:54<04:38,  5.06s/it]
test ppl:  77%|███████▋  | 182/236 [11:56<03:42,  4.11s/it]
test ppl:  78%|███████▊  | 183/236 [11:58<03:08,  3.56s/it]
test ppl:  78%|███████▊  | 184/236 [12:00<02:35,  2.99s/it]
test ppl:  78%|███████▊  | 185/236 [12:06<03:18,  3.90s/it]
test ppl:  79%|███████▉  | 186/236 [12:08<02:48,  3.37s/it]
test ppl:  79%|███████▉  | 187/236 [12:14<03:23,  4.15s/it]
test ppl:  80%|███████▉  | 188/236 [12:20<03:44,  4.67s/it]
test ppl:  80%|████████  | 189/236 [12:26<03:57,  5.05s/it]
test ppl:  81%|████████  | 190/236 [12:30<03:33,  4.64s/it]
test ppl:  81%|████████  | 191/236 [12:34<03:17,  4.39s/it]
test ppl:  81%|████████▏ | 192/236 [12:36<02:50,  3.87s/it]
test ppl:  82%|████████▏ | 193/236 [12:42<03:13,  4.49s/it]
test ppl:  82%|████████▏ | 194/236 [12:45<02:45,  3.93s/it]
test ppl:  83%|████████▎ | 195/236 [12:48<02:31,  3.69s/it]
test ppl:  83%|████████▎ | 196/236 [12:50<02:07,  3.19s/it]
test ppl:  83%|████████▎ | 197/236 [12:52<01:52,  2.88s/it]
test ppl:  84%|████████▍ | 198/236 [12:58<02:24,  3.80s/it]
test ppl:  84%|████████▍ | 199/236 [13:01<02:15,  3.65s/it]
test ppl:  85%|████████▍ | 200/236 [13:07<02:35,  4.33s/it]
test ppl:  85%|████████▌ | 201/236 [13:09<02:07,  3.64s/it]
test ppl:  86%|████████▌ | 202/236 [13:15<02:27,  4.33s/it]
test ppl:  86%|████████▌ | 203/236 [13:21<02:39,  4.82s/it]
test ppl:  86%|████████▋ | 204/236 [13:23<02:03,  3.87s/it]
test ppl:  87%|████████▋ | 205/236 [13:29<02:19,  4.49s/it]
test ppl:  87%|████████▋ | 206/236 [13:32<02:04,  4.14s/it]
test ppl:  88%|████████▊ | 207/236 [13:38<02:15,  4.67s/it]
test ppl:  88%|████████▊ | 208/236 [13:42<02:09,  4.61s/it]
test ppl:  89%|████████▊ | 209/236 [13:48<02:15,  5.02s/it]
test ppl:  89%|████████▉ | 210/236 [13:51<01:49,  4.22s/it]
test ppl:  89%|████████▉ | 211/236 [13:56<01:50,  4.43s/it]
test ppl:  90%|████████▉ | 212/236 [14:02<01:57,  4.88s/it]
test ppl:  90%|█████████ | 213/236 [14:08<01:59,  5.19s/it]
test ppl:  91%|█████████ | 214/236 [14:09<01:28,  4.04s/it]
test ppl:  91%|█████████ | 215/236 [14:15<01:36,  4.61s/it]
test ppl:  92%|█████████▏| 216/236 [14:17<01:18,  3.94s/it]
test ppl:  92%|█████████▏| 217/236 [14:23<01:27,  4.58s/it]
test ppl:  92%|█████████▏| 218/236 [14:25<01:08,  3.79s/it]
test ppl:  93%|█████████▎| 219/236 [14:31<01:15,  4.45s/it]
test ppl:  93%|█████████▎| 220/236 [14:35<01:08,  4.31s/it]
test ppl:  94%|█████████▎| 221/236 [14:37<00:53,  3.55s/it]
test ppl:  94%|█████████▍| 222/236 [14:43<00:59,  4.26s/it]
test ppl:  94%|█████████▍| 223/236 [14:49<01:02,  4.77s/it]
test ppl:  95%|█████████▍| 224/236 [14:50<00:45,  3.81s/it]
test ppl:  95%|█████████▌| 225/236 [14:53<00:38,  3.47s/it]
test ppl:  96%|█████████▌| 226/236 [14:56<00:31,  3.19s/it]
test ppl:  96%|█████████▌| 227/236 [14:58<00:25,  2.80s/it]
test ppl:  97%|█████████▋| 228/236 [14:59<00:19,  2.47s/it]
test ppl:  97%|█████████▋| 229/236 [15:05<00:24,  3.50s/it]
test ppl:  97%|█████████▋| 230/236 [15:09<00:20,  3.50s/it]
test ppl:  98%|█████████▊| 231/236 [15:12<00:17,  3.46s/it]
test ppl:  98%|█████████▊| 232/236 [15:14<00:11,  2.95s/it]
test ppl:  99%|█████████▊| 233/236 [15:16<00:08,  2.71s/it]
test ppl:  99%|█████████▉| 234/236 [15:17<00:04,  2.27s/it]
test ppl: 100%|█████████▉| 235/236 [15:23<00:03,  3.36s/it]
test ppl: 100%|██████████| 236/236 [15:24<00:00,  2.65s/it]
test ppl: 100%|██████████| 236/236 [15:24<00:00,  3.92s/it]
10/12/2024 11:08:25 - INFO - __main__ -    em: 0.2120
10/12/2024 11:08:25 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.4 20:  em: 0.2120

--------------------------------------------------------------------------------
Running experiment with knn_temp=20, lmbda=0.6, k=16
2024-10-12 11:08:32.393701: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 11:08:32.413191: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 11:08:32.434933: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 11:08:32.441573: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 11:08:32.457701: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 11:08:33.453755: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 11:08:34 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.6, knn_temp=20, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 11:08:34 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:45:28,  2.19it/s]
Adding feature api:   4%|▍         | 7196/187062 [00:00<00:10, 17129.92it/s]
Adding feature api:   8%|▊         | 15311/187062 [00:00<00:05, 33375.50it/s]
Adding feature api:  13%|█▎        | 23547/187062 [00:00<00:03, 46408.34it/s]
Adding feature api:  17%|█▋        | 31830/187062 [00:00<00:02, 56437.43it/s]
Adding feature api:  21%|██▏       | 40099/187062 [00:00<00:02, 63848.64it/s]
Adding feature api:  26%|██▌       | 48355/187062 [00:01<00:02, 69225.98it/s]
Adding feature api:  30%|███       | 56640/187062 [00:01<00:01, 73189.67it/s]
Adding feature api:  35%|███▍      | 64987/187062 [00:01<00:01, 76207.73it/s]
Adding feature api:  39%|███▉      | 73274/187062 [00:01<00:01, 78174.99it/s]
Adding feature api:  44%|████▎     | 81555/187062 [00:01<00:01, 79550.16it/s]
Adding feature api:  48%|████▊     | 89756/187062 [00:01<00:01, 79928.88it/s]
Adding feature api:  52%|█████▏    | 98092/187062 [00:01<00:01, 80948.34it/s]
Adding feature api:  57%|█████▋    | 106454/187062 [00:01<00:00, 81742.96it/s]
Adding feature api:  61%|██████▏   | 114731/187062 [00:01<00:00, 82047.44it/s]
Adding feature api:  66%|██████▌   | 123027/187062 [00:01<00:00, 82317.86it/s]
Adding feature api:  70%|███████   | 131391/187062 [00:02<00:00, 82710.47it/s]
Adding feature api:  75%|███████▍  | 139745/187062 [00:02<00:00, 82956.92it/s]
Adding feature api:  79%|███████▉  | 148096/187062 [00:02<00:00, 83120.26it/s]
Adding feature api:  84%|████████▎ | 156423/187062 [00:02<00:00, 83002.62it/s]
Adding feature api:  88%|████████▊ | 164734/187062 [00:02<00:00, 83012.69it/s]
Adding feature api:  93%|█████████▎| 173043/187062 [00:02<00:00, 82833.73it/s]
Adding feature api:  97%|█████████▋| 181332/187062 [00:02<00:00, 65561.07it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 63561.15it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:38:42,  2.20it/s]
Adding feature datatype:   4%|▎         | 7013/187062 [00:00<00:10, 16754.80it/s]
Adding feature datatype:   8%|▊         | 14957/187062 [00:00<00:05, 32704.64it/s]
Adding feature datatype:  12%|█▏        | 22983/187062 [00:00<00:03, 45380.94it/s]
Adding feature datatype:  17%|█▋        | 31036/187062 [00:00<00:02, 55073.99it/s]
Adding feature datatype:  21%|██        | 39079/187062 [00:00<00:02, 62239.33it/s]
Adding feature datatype:  25%|██▌       | 47094/187062 [00:01<00:02, 67389.00it/s]
Adding feature datatype:  29%|██▉       | 55178/187062 [00:01<00:01, 71304.15it/s]
Adding feature datatype:  34%|███▎      | 63111/187062 [00:01<00:01, 73660.39it/s]
Adding feature datatype:  38%|███▊      | 71112/187062 [00:01<00:01, 75534.96it/s]
Adding feature datatype:  42%|████▏     | 79160/187062 [00:01<00:01, 77002.49it/s]
Adding feature datatype:  47%|████▋     | 87190/187062 [00:01<00:01, 77981.91it/s]
Adding feature datatype:  51%|█████     | 95217/187062 [00:01<00:01, 78662.74it/s]
Adding feature datatype:  55%|█████▌    | 103245/187062 [00:01<00:01, 79142.98it/s]
Adding feature datatype:  59%|█████▉    | 111300/187062 [00:01<00:00, 79562.45it/s]
Adding feature datatype:  64%|██████▍   | 119385/187062 [00:01<00:00, 79945.08it/s]
Adding feature datatype:  68%|██████▊   | 127457/187062 [00:02<00:00, 80173.84it/s]
Adding feature datatype:  72%|███████▏  | 135503/187062 [00:02<00:00, 80141.20it/s]
Adding feature datatype:  77%|███████▋  | 143558/187062 [00:02<00:00, 80260.68it/s]
Adding feature datatype:  81%|████████  | 151621/187062 [00:02<00:00, 80369.87it/s]
Adding feature datatype:  85%|████████▌ | 159668/187062 [00:02<00:00, 80367.34it/s]
Adding feature datatype:  90%|████████▉ | 167712/187062 [00:02<00:00, 80245.15it/s]
Adding feature datatype:  94%|█████████▍| 175757/187062 [00:02<00:00, 80304.62it/s]
Adding feature datatype:  98%|█████████▊| 183791/187062 [00:02<00:00, 55756.30it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 62283.07it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:17:26,  2.23it/s]
Adding feature literal:   4%|▎         | 6992/187062 [00:00<00:10, 16897.44it/s]
Adding feature literal:   8%|▊         | 14945/187062 [00:00<00:05, 32970.99it/s]
Adding feature literal:  12%|█▏        | 22953/187062 [00:00<00:03, 45608.51it/s]
Adding feature literal:  17%|█▋        | 30993/187062 [00:00<00:02, 55247.06it/s]
Adding feature literal:  21%|██        | 39040/187062 [00:00<00:02, 62396.91it/s]
Adding feature literal:  25%|██▌       | 46849/187062 [00:01<00:02, 66920.36it/s]
Adding feature literal:  29%|██▉       | 54893/187062 [00:01<00:01, 70861.53it/s]
Adding feature literal:  34%|███▎      | 62971/187062 [00:01<00:01, 73777.91it/s]
Adding feature literal:  38%|███▊      | 71069/187062 [00:01<00:01, 75907.37it/s]
Adding feature literal:  42%|████▏     | 78990/187062 [00:01<00:01, 74637.32it/s]
Adding feature literal:  46%|████▋     | 86687/187062 [00:01<00:01, 73685.10it/s]
Adding feature literal:  50%|█████     | 94233/187062 [00:01<00:01, 74197.05it/s]
Adding feature literal:  55%|█████▍    | 102285/187062 [00:01<00:01, 76046.01it/s]
Adding feature literal:  59%|█████▉    | 110350/187062 [00:01<00:00, 77401.61it/s]
Adding feature literal:  63%|██████▎   | 118479/187062 [00:01<00:00, 78550.73it/s]
Adding feature literal:  68%|██████▊   | 126598/187062 [00:02<00:00, 79333.07it/s]
Adding feature literal:  72%|███████▏  | 134663/187062 [00:02<00:00, 79724.15it/s]
Adding feature literal:  76%|███████▋  | 142721/187062 [00:02<00:00, 79979.38it/s]
Adding feature literal:  81%|████████  | 150736/187062 [00:02<00:00, 79518.49it/s]
Adding feature literal:  85%|████████▍ | 158798/187062 [00:02<00:00, 79844.64it/s]
Adding feature literal:  89%|████████▉ | 166859/187062 [00:02<00:00, 80070.13it/s]
Adding feature literal:  94%|█████████▎| 174954/187062 [00:02<00:00, 80332.74it/s]
Adding feature literal:  98%|█████████▊| 182992/187062 [00:02<00:00, 57671.65it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 61865.97it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:21:15,  2.22it/s]
Adding feature operator:   4%|▎         | 6951/187062 [00:00<00:10, 16763.52it/s]
Adding feature operator:   8%|▊         | 14936/187062 [00:00<00:05, 32928.86it/s]
Adding feature operator:  12%|█▏        | 22763/187062 [00:00<00:03, 45078.31it/s]
Adding feature operator:  16%|█▋        | 30790/187062 [00:00<00:02, 54818.54it/s]
Adding feature operator:  21%|██        | 38841/187062 [00:00<00:02, 62098.35it/s]
Adding feature operator:  25%|██▌       | 46928/187062 [00:01<00:02, 67507.10it/s]
Adding feature operator:  29%|██▉       | 54970/187062 [00:01<00:01, 71271.11it/s]
Adding feature operator:  34%|███▎      | 63042/187062 [00:01<00:01, 74047.06it/s]
Adding feature operator:  38%|███▊      | 71106/187062 [00:01<00:01, 75996.04it/s]
Adding feature operator:  42%|████▏     | 79217/187062 [00:01<00:01, 77512.09it/s]
Adding feature operator:  47%|████▋     | 87287/187062 [00:01<00:01, 78460.76it/s]
Adding feature operator:  51%|█████     | 95370/187062 [00:01<00:01, 79165.12it/s]
Adding feature operator:  55%|█████▌    | 103450/187062 [00:01<00:01, 79651.43it/s]
Adding feature operator:  60%|█████▉    | 111554/187062 [00:01<00:00, 80064.44it/s]
Adding feature operator:  64%|██████▍   | 119658/187062 [00:01<00:00, 80353.30it/s]
Adding feature operator:  68%|██████▊   | 127734/187062 [00:02<00:00, 79753.10it/s]
Adding feature operator:  73%|███████▎  | 135774/187062 [00:02<00:00, 79943.02it/s]
Adding feature operator:  77%|███████▋  | 143823/187062 [00:02<00:00, 80103.69it/s]
Adding feature operator:  81%|████████  | 151848/187062 [00:02<00:00, 80011.56it/s]
Adding feature operator:  85%|████████▌ | 159902/187062 [00:02<00:00, 80167.47it/s]
Adding feature operator:  90%|████████▉ | 167950/187062 [00:02<00:00, 80258.61it/s]
Adding feature operator:  94%|█████████▍| 175981/187062 [00:02<00:00, 80248.35it/s]
Adding feature operator:  98%|█████████▊| 184010/187062 [00:02<00:00, 55284.98it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 62419.26it/s]
[2024-10-12 11:09:18,562] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 11:09:19 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 11:09:20 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:16, 389.76 examples/s]
Map:   1%|▏         | 85/6548 [00:00<00:30, 214.90 examples/s]
Map:   2%|▏         | 125/6548 [00:00<00:24, 265.57 examples/s]
Map:   3%|▎         | 172/6548 [00:00<00:19, 324.75 examples/s]
Map:   3%|▎         | 211/6548 [00:00<00:18, 343.06 examples/s]
Map:   4%|▍         | 249/6548 [00:00<00:18, 337.21 examples/s]
Map:   4%|▍         | 288/6548 [00:00<00:18, 338.07 examples/s]
Map:   5%|▌         | 331/6548 [00:01<00:19, 313.15 examples/s]
Map:   6%|▌         | 385/6548 [00:01<00:18, 325.73 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:17, 355.84 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 326.61 examples/s]
Map:   8%|▊         | 506/6548 [00:01<00:18, 328.13 examples/s]
Map:   9%|▊         | 563/6548 [00:01<00:15, 379.65 examples/s]
Map:   9%|▉         | 614/6548 [00:01<00:16, 360.08 examples/s]
Map:  10%|█         | 660/6548 [00:02<00:17, 328.54 examples/s]
Map:  11%|█         | 706/6548 [00:02<00:16, 355.50 examples/s]
Map:  11%|█▏        | 748/6548 [00:02<00:15, 368.16 examples/s]
Map:  12%|█▏        | 800/6548 [00:02<00:14, 405.71 examples/s]
Map:  13%|█▎        | 856/6548 [00:02<00:14, 392.14 examples/s]
Map:  14%|█▍        | 909/6548 [00:02<00:15, 365.81 examples/s]
Map:  15%|█▍        | 957/6548 [00:02<00:14, 379.74 examples/s]
Map:  15%|█▌        | 1000/6548 [00:03<00:23, 237.87 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:21, 260.14 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:19, 283.95 examples/s]
Map:  17%|█▋        | 1124/6548 [00:03<00:16, 324.37 examples/s]
Map:  18%|█▊        | 1164/6548 [00:03<00:15, 338.99 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:14, 357.77 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:14, 366.10 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:13, 376.27 examples/s]
Map:  21%|██        | 1354/6548 [00:04<00:15, 329.81 examples/s]
Map:  21%|██▏       | 1398/6548 [00:04<00:16, 306.95 examples/s]
Map:  22%|██▏       | 1436/6548 [00:04<00:17, 288.93 examples/s]
Map:  22%|██▏       | 1469/6548 [00:04<00:17, 296.61 examples/s]
Map:  23%|██▎       | 1514/6548 [00:04<00:17, 295.29 examples/s]
Map:  24%|██▍       | 1556/6548 [00:04<00:17, 281.77 examples/s]
Map:  24%|██▍       | 1587/6548 [00:04<00:17, 287.16 examples/s]
Map:  25%|██▍       | 1622/6548 [00:05<00:18, 263.41 examples/s]
Map:  25%|██▌       | 1653/6548 [00:05<00:18, 262.31 examples/s]
Map:  26%|██▌       | 1688/6548 [00:05<00:17, 282.07 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:15, 308.81 examples/s]
Map:  27%|██▋       | 1771/6548 [00:05<00:13, 342.17 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:13, 347.32 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 355.71 examples/s]
Map:  29%|██▉       | 1900/6548 [00:05<00:13, 339.91 examples/s]
Map:  30%|██▉       | 1953/6548 [00:06<00:13, 341.25 examples/s]
Map:  30%|███       | 1996/6548 [00:06<00:12, 356.65 examples/s]
Map:  31%|███▏      | 2049/6548 [00:06<00:19, 226.99 examples/s]
Map:  32%|███▏      | 2092/6548 [00:06<00:17, 257.53 examples/s]
Map:  32%|███▏      | 2126/6548 [00:06<00:16, 269.94 examples/s]
Map:  33%|███▎      | 2180/6548 [00:06<00:16, 264.28 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 272.39 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:15, 280.13 examples/s]
Map:  35%|███▌      | 2292/6548 [00:07<00:15, 281.21 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:13, 307.13 examples/s]
Map:  36%|███▋      | 2382/6548 [00:07<00:13, 306.70 examples/s]
Map:  37%|███▋      | 2422/6548 [00:07<00:12, 327.16 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:12, 315.55 examples/s]
Map:  38%|███▊      | 2494/6548 [00:07<00:12, 322.10 examples/s]
Map:  39%|███▉      | 2541/6548 [00:08<00:12, 313.94 examples/s]
Map:  40%|███▉      | 2594/6548 [00:08<00:10, 359.67 examples/s]
Map:  40%|████      | 2638/6548 [00:08<00:10, 377.55 examples/s]
Map:  41%|████      | 2682/6548 [00:08<00:11, 341.86 examples/s]
Map:  42%|████▏     | 2736/6548 [00:08<00:11, 340.34 examples/s]
Map:  42%|████▏     | 2774/6548 [00:08<00:10, 349.07 examples/s]
Map:  43%|████▎     | 2823/6548 [00:08<00:11, 338.36 examples/s]
Map:  44%|████▎     | 2860/6548 [00:09<00:13, 283.21 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 289.66 examples/s]
Map:  45%|████▌     | 2949/6548 [00:09<00:12, 284.83 examples/s]
Map:  46%|████▌     | 2982/6548 [00:09<00:12, 289.45 examples/s]
Map:  46%|████▌     | 3012/6548 [00:09<00:22, 157.30 examples/s]
Map:  46%|████▋     | 3043/6548 [00:10<00:19, 178.64 examples/s]
Map:  47%|████▋     | 3073/6548 [00:10<00:17, 193.47 examples/s]
Map:  48%|████▊     | 3113/6548 [00:10<00:15, 218.72 examples/s]
Map:  48%|████▊     | 3148/6548 [00:10<00:13, 243.18 examples/s]
Map:  49%|████▊     | 3183/6548 [00:10<00:14, 227.35 examples/s]
Map:  49%|████▉     | 3218/6548 [00:10<00:14, 227.21 examples/s]
Map:  50%|████▉     | 3245/6548 [00:10<00:14, 235.06 examples/s]
Map:  50%|█████     | 3280/6548 [00:10<00:12, 258.00 examples/s]
Map:  51%|█████     | 3315/6548 [00:11<00:11, 274.55 examples/s]
Map:  51%|█████     | 3350/6548 [00:11<00:11, 289.18 examples/s]
Map:  52%|█████▏    | 3389/6548 [00:11<00:11, 270.82 examples/s]
Map:  52%|█████▏    | 3425/6548 [00:11<00:10, 289.12 examples/s]
Map:  53%|█████▎    | 3459/6548 [00:11<00:12, 248.16 examples/s]
Map:  53%|█████▎    | 3493/6548 [00:11<00:11, 266.60 examples/s]
Map:  54%|█████▍    | 3543/6548 [00:11<00:09, 319.74 examples/s]
Map:  55%|█████▍    | 3582/6548 [00:11<00:09, 329.01 examples/s]
Map:  55%|█████▌    | 3620/6548 [00:12<00:08, 339.31 examples/s]
Map:  56%|█████▌    | 3663/6548 [00:12<00:09, 317.59 examples/s]
Map:  57%|█████▋    | 3706/6548 [00:12<00:08, 344.27 examples/s]
Map:  57%|█████▋    | 3742/6548 [00:12<00:08, 346.31 examples/s]
Map:  58%|█████▊    | 3799/6548 [00:12<00:07, 356.18 examples/s]
Map:  59%|█████▊    | 3839/6548 [00:12<00:08, 321.95 examples/s]
Map:  59%|█████▉    | 3888/6548 [00:12<00:08, 321.75 examples/s]
Map:  60%|█████▉    | 3922/6548 [00:13<00:08, 307.88 examples/s]
Map:  61%|██████    | 3962/6548 [00:13<00:07, 328.84 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 222.16 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 281.85 examples/s]
Map:  63%|██████▎   | 4095/6548 [00:13<00:07, 308.72 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 318.22 examples/s]
Map:  64%|██████▍   | 4179/6548 [00:13<00:07, 304.52 examples/s]
Map:  64%|██████▍   | 4216/6548 [00:14<00:07, 317.03 examples/s]
Map:  65%|██████▌   | 4266/6548 [00:14<00:06, 359.69 examples/s]
Map:  66%|██████▌   | 4325/6548 [00:14<00:06, 369.77 examples/s]
Map:  67%|██████▋   | 4379/6548 [00:14<00:06, 360.64 examples/s]
Map:  68%|██████▊   | 4426/6548 [00:14<00:05, 376.52 examples/s]
Map:  68%|██████▊   | 4475/6548 [00:14<00:05, 352.76 examples/s]
Map:  69%|██████▉   | 4520/6548 [00:14<00:06, 331.79 examples/s]
Map:  70%|██████▉   | 4570/6548 [00:15<00:06, 328.65 examples/s]
Map:  70%|███████   | 4610/6548 [00:15<00:05, 331.26 examples/s]
Map:  71%|███████   | 4658/6548 [00:15<00:05, 364.89 examples/s]
Map:  72%|███████▏  | 4705/6548 [00:15<00:05, 343.39 examples/s]
Map:  73%|███████▎  | 4750/6548 [00:15<00:05, 356.19 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 404.64 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 392.99 examples/s]
Map:  75%|███████▍  | 4903/6548 [00:15<00:04, 370.47 examples/s]
Map:  76%|███████▌  | 4968/6548 [00:16<00:04, 388.20 examples/s]
Map:  77%|███████▋  | 5013/6548 [00:16<00:06, 240.19 examples/s]
Map:  77%|███████▋  | 5052/6548 [00:16<00:05, 262.45 examples/s]
Map:  78%|███████▊  | 5096/6548 [00:16<00:05, 269.13 examples/s]
Map:  78%|███████▊  | 5139/6548 [00:16<00:05, 269.51 examples/s]
Map:  79%|███████▉  | 5177/6548 [00:16<00:04, 291.02 examples/s]
Map:  80%|███████▉  | 5214/6548 [00:17<00:04, 273.25 examples/s]
Map:  80%|████████  | 5254/6548 [00:17<00:04, 300.34 examples/s]
Map:  81%|████████  | 5293/6548 [00:17<00:03, 320.96 examples/s]
Map:  81%|████████▏ | 5328/6548 [00:17<00:03, 309.03 examples/s]
Map:  82%|████████▏ | 5385/6548 [00:17<00:03, 309.10 examples/s]
Map:  83%|████████▎ | 5429/6548 [00:17<00:03, 286.20 examples/s]
Map:  84%|████████▎ | 5473/6548 [00:17<00:03, 315.08 examples/s]
Map:  84%|████████▍ | 5515/6548 [00:18<00:03, 302.65 examples/s]
Map:  85%|████████▍ | 5558/6548 [00:18<00:02, 331.17 examples/s]
Map:  86%|████████▌ | 5602/6548 [00:18<00:03, 301.54 examples/s]
Map:  86%|████████▌ | 5646/6548 [00:18<00:02, 330.75 examples/s]
Map:  87%|████████▋ | 5687/6548 [00:18<00:02, 306.42 examples/s]
Map:  88%|████████▊ | 5730/6548 [00:18<00:02, 324.80 examples/s]
Map:  88%|████████▊ | 5772/6548 [00:18<00:02, 344.90 examples/s]
Map:  89%|████████▊ | 5809/6548 [00:18<00:02, 346.67 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:19<00:01, 352.32 examples/s]
Map:  90%|████████▉ | 5890/6548 [00:19<00:02, 317.42 examples/s]
Map:  91%|█████████ | 5933/6548 [00:19<00:01, 336.15 examples/s]
Map:  91%|█████████▏| 5982/6548 [00:19<00:01, 318.36 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 227.54 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 255.92 examples/s]
Map:  94%|█████████▎| 6124/6548 [00:20<00:01, 259.06 examples/s]
Map:  94%|█████████▍| 6165/6548 [00:20<00:01, 278.88 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:20<00:01, 301.64 examples/s]
Map:  96%|█████████▌| 6262/6548 [00:20<00:00, 313.01 examples/s]
Map:  96%|█████████▋| 6303/6548 [00:20<00:00, 333.67 examples/s]
Map:  97%|█████████▋| 6339/6548 [00:20<00:00, 339.35 examples/s]
Map:  97%|█████████▋| 6380/6548 [00:20<00:00, 341.49 examples/s]
Map:  98%|█████████▊| 6421/6548 [00:20<00:00, 354.08 examples/s]
Map:  99%|█████████▉| 6471/6548 [00:21<00:00, 388.05 examples/s]
Map: 100%|█████████▉| 6529/6548 [00:21<00:00, 367.84 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 306.45 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 316.98 examples/s]
Map:   8%|▊         | 73/903 [00:00<00:02, 340.65 examples/s]
Map:  13%|█▎        | 118/903 [00:00<00:02, 308.21 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 329.97 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 386.61 examples/s]
Map:  29%|██▉       | 263/903 [00:00<00:01, 368.35 examples/s]
Map:  33%|███▎      | 302/903 [00:00<00:01, 366.96 examples/s]
Map:  39%|███▉      | 354/903 [00:01<00:01, 355.92 examples/s]
Map:  45%|████▌     | 409/903 [00:01<00:01, 291.57 examples/s]
Map:  50%|████▉     | 451/903 [00:01<00:01, 286.22 examples/s]
Map:  54%|█████▍    | 486/903 [00:01<00:01, 288.69 examples/s]
Map:  59%|█████▊    | 530/903 [00:01<00:01, 321.95 examples/s]
Map:  63%|██████▎   | 566/903 [00:01<00:01, 330.38 examples/s]
Map:  68%|██████▊   | 613/903 [00:01<00:00, 362.04 examples/s]
Map:  74%|███████▍  | 667/903 [00:01<00:00, 354.53 examples/s]
Map:  78%|███████▊  | 704/903 [00:02<00:00, 354.76 examples/s]
Map:  83%|████████▎ | 751/903 [00:02<00:00, 382.08 examples/s]
Map:  89%|████████▉ | 806/903 [00:02<00:00, 374.21 examples/s]
Map:  95%|█████████▍| 854/903 [00:02<00:00, 398.05 examples/s]
Map:  99%|█████████▉| 898/903 [00:02<00:00, 343.56 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 316.47 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 36/1882 [00:00<00:06, 276.39 examples/s]
Map:   4%|▍         | 77/1882 [00:00<00:05, 343.61 examples/s]
Map:   7%|▋         | 124/1882 [00:00<00:05, 306.85 examples/s]
Map:   9%|▉         | 171/1882 [00:00<00:04, 349.83 examples/s]
Map:  12%|█▏        | 229/1882 [00:00<00:04, 362.36 examples/s]
Map:  14%|█▍        | 271/1882 [00:00<00:04, 375.42 examples/s]
Map:  16%|█▋        | 310/1882 [00:00<00:04, 367.72 examples/s]
Map:  19%|█▊        | 350/1882 [00:00<00:04, 371.74 examples/s]
Map:  21%|██        | 393/1882 [00:01<00:04, 326.76 examples/s]
Map:  23%|██▎       | 439/1882 [00:01<00:04, 315.83 examples/s]
Map:  25%|██▌       | 474/1882 [00:01<00:04, 321.90 examples/s]
Map:  27%|██▋       | 507/1882 [00:01<00:04, 309.77 examples/s]
Map:  29%|██▉       | 544/1882 [00:01<00:04, 323.85 examples/s]
Map:  31%|███▏      | 591/1882 [00:01<00:03, 357.79 examples/s]
Map:  34%|███▍      | 646/1882 [00:01<00:03, 409.47 examples/s]
Map:  37%|███▋      | 704/1882 [00:01<00:03, 392.08 examples/s]
Map:  40%|███▉      | 745/1882 [00:02<00:02, 392.95 examples/s]
Map:  42%|████▏     | 797/1882 [00:02<00:02, 369.18 examples/s]
Map:  45%|████▌     | 853/1882 [00:02<00:02, 361.19 examples/s]
Map:  48%|████▊     | 897/1882 [00:02<00:02, 376.51 examples/s]
Map:  50%|████▉     | 940/1882 [00:02<00:02, 388.15 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 398.88 examples/s]
Map:  55%|█████▌    | 1039/1882 [00:03<00:03, 256.12 examples/s]
Map:  58%|█████▊    | 1085/1882 [00:03<00:02, 267.42 examples/s]
Map:  60%|██████    | 1135/1882 [00:03<00:02, 280.16 examples/s]
Map:  62%|██████▏   | 1171/1882 [00:03<00:02, 295.11 examples/s]
Map:  65%|██████▌   | 1226/1882 [00:03<00:02, 279.56 examples/s]
Map:  67%|██████▋   | 1258/1882 [00:03<00:02, 283.94 examples/s]
Map:  69%|██████▉   | 1307/1882 [00:03<00:01, 318.20 examples/s]
Map:  72%|███████▏  | 1347/1882 [00:04<00:01, 333.20 examples/s]
Map:  74%|███████▍  | 1397/1882 [00:04<00:01, 329.93 examples/s]
Map:  76%|███████▋  | 1437/1882 [00:04<00:01, 285.08 examples/s]
Map:  78%|███████▊  | 1475/1882 [00:04<00:01, 279.45 examples/s]
Map:  80%|████████  | 1510/1882 [00:04<00:01, 264.64 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 275.69 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:04<00:00, 301.87 examples/s]
Map:  86%|████████▋ | 1626/1882 [00:04<00:00, 331.95 examples/s]
Map:  88%|████████▊ | 1662/1882 [00:05<00:00, 329.72 examples/s]
Map:  91%|█████████ | 1713/1882 [00:05<00:00, 326.21 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 281.05 examples/s]
Map:  95%|█████████▌| 1794/1882 [00:05<00:00, 273.51 examples/s]
Map:  98%|█████████▊| 1841/1882 [00:05<00:00, 312.07 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 224.14 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 311.70 examples/s]
10/12/2024 11:10:21 - INFO - __main__ -     ***** Testing *****
10/12/2024 11:10:21 - INFO - __main__ -     Batch size = 8
10/12/2024 11:10:21 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 11:10:22 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 11:10:22 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 11:10:23 - INFO - knnlm -   Reading datastore took 0.9689264297485352 s
10/12/2024 11:10:24 - INFO - knnlm -   Moving index to GPU took 0.9095005989074707 s
10/12/2024 11:10:24 - INFO - __main__ -   ******************************break-into
10/12/2024 11:10:24 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 11:10:24 - INFO - __main__ -     Num examples = 236
10/12/2024 11:10:24 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<31:14,  7.98s/it]
test ppl:   1%|          | 2/236 [00:09<17:23,  4.46s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:23,  3.19s/it]
test ppl:   2%|▏         | 4/236 [00:17<16:23,  4.24s/it]
test ppl:   2%|▏         | 5/236 [00:23<18:37,  4.84s/it]
test ppl:   3%|▎         | 6/236 [00:29<19:54,  5.19s/it]
test ppl:   3%|▎         | 7/236 [00:31<15:46,  4.14s/it]
test ppl:   3%|▎         | 8/236 [00:36<17:27,  4.59s/it]
test ppl:   4%|▍         | 9/236 [00:39<15:26,  4.08s/it]
test ppl:   4%|▍         | 10/236 [00:44<15:32,  4.13s/it]
test ppl:   5%|▍         | 11/236 [00:49<16:33,  4.41s/it]
test ppl:   5%|▌         | 12/236 [00:54<18:08,  4.86s/it]
test ppl:   6%|▌         | 13/236 [01:00<19:14,  5.18s/it]
test ppl:   6%|▌         | 14/236 [01:06<19:59,  5.41s/it]
test ppl:   6%|▋         | 15/236 [01:08<15:44,  4.28s/it]
test ppl:   7%|▋         | 16/236 [01:12<15:00,  4.09s/it]
test ppl:   7%|▋         | 17/236 [01:17<16:13,  4.45s/it]
test ppl:   8%|▊         | 18/236 [01:18<12:50,  3.53s/it]
test ppl:   8%|▊         | 19/236 [01:23<13:39,  3.78s/it]
test ppl:   8%|▊         | 20/236 [01:25<12:14,  3.40s/it]
test ppl:   9%|▉         | 21/236 [01:31<14:50,  4.14s/it]
test ppl:   9%|▉         | 22/236 [01:37<16:40,  4.68s/it]
test ppl:  10%|▉         | 23/236 [01:40<15:04,  4.25s/it]
test ppl:  10%|█         | 24/236 [01:43<13:17,  3.76s/it]
test ppl:  11%|█         | 25/236 [01:45<11:06,  3.16s/it]
test ppl:  11%|█         | 26/236 [01:49<12:50,  3.67s/it]
test ppl:  11%|█▏        | 27/236 [01:53<12:36,  3.62s/it]
test ppl:  12%|█▏        | 28/236 [01:54<10:12,  2.94s/it]
test ppl:  12%|█▏        | 29/236 [01:57<09:43,  2.82s/it]
test ppl:  13%|█▎        | 30/236 [01:58<08:20,  2.43s/it]
test ppl:  13%|█▎        | 31/236 [02:04<11:51,  3.47s/it]
test ppl:  14%|█▎        | 32/236 [02:08<11:58,  3.52s/it]
test ppl:  14%|█▍        | 33/236 [02:14<14:21,  4.24s/it]
test ppl:  14%|█▍        | 34/236 [02:18<14:04,  4.18s/it]
test ppl:  15%|█▍        | 35/236 [02:24<15:44,  4.70s/it]
test ppl:  15%|█▌        | 36/236 [02:30<16:52,  5.06s/it]
test ppl:  16%|█▌        | 37/236 [02:36<17:39,  5.32s/it]
test ppl:  16%|█▌        | 38/236 [02:38<14:42,  4.45s/it]
test ppl:  17%|█▋        | 39/236 [02:44<16:03,  4.89s/it]
test ppl:  17%|█▋        | 40/236 [02:45<12:28,  3.82s/it]
test ppl:  17%|█▋        | 41/236 [02:48<11:44,  3.61s/it]
test ppl:  18%|█▊        | 42/236 [02:54<13:56,  4.31s/it]
test ppl:  18%|█▊        | 43/236 [03:00<15:24,  4.79s/it]
test ppl:  19%|█▊        | 44/236 [03:03<13:39,  4.27s/it]
test ppl:  19%|█▉        | 45/236 [03:05<11:14,  3.53s/it]
test ppl:  19%|█▉        | 46/236 [03:11<13:28,  4.25s/it]
test ppl:  20%|█▉        | 47/236 [03:13<10:49,  3.44s/it]
test ppl:  20%|██        | 48/236 [03:18<13:04,  4.17s/it]
test ppl:  21%|██        | 49/236 [03:21<11:44,  3.76s/it]
test ppl:  21%|██        | 50/236 [03:27<13:42,  4.42s/it]
test ppl:  22%|██▏       | 51/236 [03:32<13:36,  4.41s/it]
test ppl:  22%|██▏       | 52/236 [03:38<14:55,  4.87s/it]
test ppl:  22%|██▏       | 53/236 [03:41<13:56,  4.57s/it]
test ppl:  23%|██▎       | 54/236 [03:47<15:05,  4.97s/it]
test ppl:  23%|██▎       | 55/236 [03:52<14:47,  4.91s/it]
test ppl:  24%|██▎       | 56/236 [03:58<15:39,  5.22s/it]
test ppl:  24%|██▍       | 57/236 [04:01<13:58,  4.69s/it]
test ppl:  25%|██▍       | 58/236 [04:04<11:34,  3.90s/it]
test ppl:  25%|██▌       | 59/236 [04:09<13:16,  4.50s/it]
test ppl:  25%|██▌       | 60/236 [04:13<12:23,  4.23s/it]
test ppl:  26%|██▌       | 61/236 [04:16<10:46,  3.70s/it]
test ppl:  26%|██▋       | 62/236 [04:20<11:02,  3.81s/it]
test ppl:  27%|██▋       | 63/236 [04:25<12:46,  4.43s/it]
test ppl:  27%|██▋       | 64/236 [04:28<11:02,  3.85s/it]
test ppl:  28%|██▊       | 65/236 [04:29<08:49,  3.09s/it]
test ppl:  28%|██▊       | 66/236 [04:33<09:15,  3.26s/it]
test ppl:  28%|██▊       | 67/236 [04:39<11:24,  4.05s/it]
test ppl:  29%|██▉       | 68/236 [04:45<12:53,  4.60s/it]
test ppl:  29%|██▉       | 69/236 [04:51<13:52,  4.99s/it]
test ppl:  30%|██▉       | 70/236 [04:52<10:53,  3.93s/it]
test ppl:  30%|███       | 71/236 [04:55<10:11,  3.71s/it]
test ppl:  31%|███       | 72/236 [04:58<09:17,  3.40s/it]
test ppl:  31%|███       | 73/236 [05:04<11:16,  4.15s/it]
test ppl:  31%|███▏      | 74/236 [05:06<09:17,  3.44s/it]
test ppl:  32%|███▏      | 75/236 [05:12<11:11,  4.17s/it]
test ppl:  32%|███▏      | 76/236 [05:15<10:24,  3.90s/it]
test ppl:  33%|███▎      | 77/236 [05:17<09:01,  3.40s/it]
test ppl:  33%|███▎      | 78/236 [05:19<07:33,  2.87s/it]
test ppl:  33%|███▎      | 79/236 [05:22<08:16,  3.16s/it]
test ppl:  34%|███▍      | 80/236 [05:24<07:13,  2.78s/it]
test ppl:  34%|███▍      | 81/236 [05:30<09:33,  3.70s/it]
test ppl:  35%|███▍      | 82/236 [05:36<11:11,  4.36s/it]
test ppl:  35%|███▌      | 83/236 [05:42<12:17,  4.82s/it]
test ppl:  36%|███▌      | 84/236 [05:44<10:17,  4.06s/it]
test ppl:  36%|███▌      | 85/236 [05:49<10:23,  4.13s/it]
test ppl:  36%|███▋      | 86/236 [05:50<08:32,  3.41s/it]
test ppl:  37%|███▋      | 87/236 [05:54<08:44,  3.52s/it]
test ppl:  37%|███▋      | 88/236 [06:00<10:24,  4.22s/it]
test ppl:  38%|███▊      | 89/236 [06:02<08:38,  3.53s/it]
test ppl:  38%|███▊      | 90/236 [06:08<10:16,  4.23s/it]
test ppl:  39%|███▊      | 91/236 [06:13<11:16,  4.66s/it]
test ppl:  39%|███▉      | 92/236 [06:16<09:51,  4.11s/it]
test ppl:  39%|███▉      | 93/236 [06:22<11:02,  4.63s/it]
test ppl:  40%|███▉      | 94/236 [06:28<11:50,  5.00s/it]
test ppl:  40%|████      | 95/236 [06:30<09:48,  4.17s/it]
test ppl:  41%|████      | 96/236 [06:34<09:21,  4.01s/it]
test ppl:  41%|████      | 97/236 [06:40<10:35,  4.57s/it]
test ppl:  42%|████▏     | 98/236 [06:46<11:24,  4.96s/it]
test ppl:  42%|████▏     | 99/236 [06:51<11:57,  5.24s/it]
test ppl:  42%|████▏     | 100/236 [06:53<09:32,  4.21s/it]
test ppl:  43%|████▎     | 101/236 [06:59<10:35,  4.71s/it]
test ppl:  43%|████▎     | 102/236 [07:03<10:03,  4.50s/it]
test ppl:  44%|████▎     | 103/236 [07:05<08:11,  3.70s/it]
test ppl:  44%|████▍     | 104/236 [07:09<08:27,  3.85s/it]
test ppl:  44%|████▍     | 105/236 [07:13<08:41,  3.98s/it]
test ppl:  45%|████▍     | 106/236 [07:19<09:32,  4.41s/it]
test ppl:  45%|████▌     | 107/236 [07:22<08:28,  3.94s/it]
test ppl:  46%|████▌     | 108/236 [07:27<08:56,  4.19s/it]
test ppl:  46%|████▌     | 109/236 [07:30<08:37,  4.07s/it]
test ppl:  47%|████▋     | 110/236 [07:32<06:59,  3.33s/it]
test ppl:  47%|████▋     | 111/236 [07:38<08:31,  4.09s/it]
test ppl:  47%|████▋     | 112/236 [07:44<09:34,  4.63s/it]
test ppl:  48%|████▊     | 113/236 [07:50<10:15,  5.01s/it]
test ppl:  48%|████▊     | 114/236 [07:53<09:06,  4.48s/it]
test ppl:  49%|████▊     | 115/236 [07:55<07:35,  3.76s/it]
test ppl:  49%|████▉     | 116/236 [08:01<08:47,  4.40s/it]
test ppl:  50%|████▉     | 117/236 [08:03<07:12,  3.63s/it]
test ppl:  50%|█████     | 118/236 [08:08<08:27,  4.30s/it]
test ppl:  50%|█████     | 119/236 [08:11<07:19,  3.75s/it]
test ppl:  51%|█████     | 120/236 [08:12<05:55,  3.07s/it]
test ppl:  51%|█████▏    | 121/236 [08:15<05:50,  3.04s/it]
test ppl:  52%|█████▏    | 122/236 [08:21<07:23,  3.89s/it]
test ppl:  52%|█████▏    | 123/236 [08:23<06:20,  3.36s/it]
test ppl:  53%|█████▎    | 124/236 [08:29<07:43,  4.14s/it]
test ppl:  53%|█████▎    | 125/236 [08:32<06:34,  3.55s/it]
test ppl:  53%|█████▎    | 126/236 [08:36<07:10,  3.91s/it]
test ppl:  54%|█████▍    | 127/236 [08:38<05:51,  3.22s/it]
test ppl:  54%|█████▍    | 128/236 [08:40<05:04,  2.82s/it]
test ppl:  55%|█████▍    | 129/236 [08:43<04:59,  2.80s/it]
test ppl:  55%|█████▌    | 130/236 [08:47<05:50,  3.30s/it]
test ppl:  56%|█████▌    | 131/236 [08:53<07:08,  4.08s/it]
test ppl:  56%|█████▌    | 132/236 [08:57<06:50,  3.95s/it]
test ppl:  56%|█████▋    | 133/236 [09:00<06:42,  3.90s/it]
test ppl:  57%|█████▋    | 134/236 [09:04<06:25,  3.78s/it]
test ppl:  57%|█████▋    | 135/236 [09:10<07:25,  4.41s/it]
test ppl:  58%|█████▊    | 136/236 [09:13<06:42,  4.02s/it]
test ppl:  58%|█████▊    | 137/236 [09:20<08:19,  5.04s/it]
test ppl:  58%|█████▊    | 138/236 [09:28<09:19,  5.71s/it]
test ppl:  59%|█████▉    | 139/236 [09:30<07:31,  4.66s/it]
test ppl:  59%|█████▉    | 140/236 [09:32<06:24,  4.00s/it]
test ppl:  60%|█████▉    | 141/236 [09:36<06:27,  4.08s/it]
test ppl:  60%|██████    | 142/236 [09:39<05:42,  3.64s/it]
test ppl:  61%|██████    | 143/236 [09:44<06:19,  4.08s/it]
test ppl:  61%|██████    | 144/236 [09:48<06:05,  3.97s/it]
test ppl:  61%|██████▏   | 145/236 [09:55<07:17,  4.81s/it]
test ppl:  62%|██████▏   | 146/236 [10:02<08:19,  5.54s/it]
test ppl:  62%|██████▏   | 147/236 [10:09<09:01,  6.08s/it]
test ppl:  63%|██████▎   | 148/236 [10:17<09:29,  6.48s/it]
test ppl:  63%|██████▎   | 149/236 [10:21<08:20,  5.75s/it]
test ppl:  64%|██████▎   | 150/236 [10:28<08:54,  6.22s/it]
test ppl:  64%|██████▍   | 151/236 [10:35<09:15,  6.53s/it]
test ppl:  64%|██████▍   | 152/236 [10:43<09:27,  6.75s/it]
test ppl:  65%|██████▍   | 153/236 [10:46<07:50,  5.67s/it]
test ppl:  65%|██████▌   | 154/236 [10:49<06:43,  4.92s/it]
test ppl:  66%|██████▌   | 155/236 [10:55<07:08,  5.29s/it]
test ppl:  66%|██████▌   | 156/236 [10:57<05:52,  4.40s/it]
test ppl:  67%|██████▋   | 157/236 [11:00<05:10,  3.93s/it]
test ppl:  67%|██████▋   | 158/236 [11:07<06:25,  4.94s/it]
test ppl:  67%|██████▋   | 159/236 [11:10<05:20,  4.16s/it]
test ppl:  68%|██████▊   | 160/236 [11:11<04:17,  3.38s/it]
test ppl:  68%|██████▊   | 161/236 [11:13<03:26,  2.76s/it]
test ppl:  69%|██████▊   | 162/236 [11:17<03:48,  3.09s/it]
test ppl:  69%|██████▉   | 163/236 [11:20<03:55,  3.22s/it]
test ppl:  69%|██████▉   | 164/236 [11:23<03:41,  3.08s/it]
test ppl:  70%|██████▉   | 165/236 [11:30<05:08,  4.34s/it]
test ppl:  70%|███████   | 166/236 [11:32<04:07,  3.54s/it]
test ppl:  71%|███████   | 167/236 [11:34<03:43,  3.24s/it]
test ppl:  71%|███████   | 168/236 [11:36<03:07,  2.76s/it]
test ppl:  72%|███████▏  | 169/236 [11:43<04:37,  4.14s/it]
test ppl:  72%|███████▏  | 170/236 [11:51<05:36,  5.10s/it]
test ppl:  72%|███████▏  | 171/236 [11:53<04:30,  4.16s/it]
test ppl:  73%|███████▎  | 172/236 [11:55<03:57,  3.70s/it]
test ppl:  73%|███████▎  | 173/236 [11:59<03:53,  3.71s/it]
test ppl:  74%|███████▎  | 174/236 [12:04<04:09,  4.02s/it]
test ppl:  74%|███████▍  | 175/236 [12:05<03:23,  3.34s/it]
test ppl:  75%|███████▍  | 176/236 [12:13<04:31,  4.52s/it]
test ppl:  75%|███████▌  | 177/236 [12:20<05:16,  5.36s/it]
test ppl:  75%|███████▌  | 178/236 [12:27<05:45,  5.96s/it]
test ppl:  76%|███████▌  | 179/236 [12:35<06:03,  6.37s/it]
test ppl:  76%|███████▋  | 180/236 [12:39<05:24,  5.80s/it]
test ppl:  77%|███████▋  | 181/236 [12:47<05:43,  6.24s/it]
test ppl:  77%|███████▋  | 182/236 [12:49<04:31,  5.03s/it]
test ppl:  78%|███████▊  | 183/236 [12:51<03:39,  4.13s/it]
test ppl:  78%|███████▊  | 184/236 [12:53<03:12,  3.70s/it]
test ppl:  78%|███████▊  | 185/236 [13:01<04:03,  4.78s/it]
test ppl:  79%|███████▉  | 186/236 [13:03<03:22,  4.05s/it]
test ppl:  79%|███████▉  | 187/236 [13:05<02:48,  3.43s/it]
test ppl:  80%|███████▉  | 188/236 [13:12<03:40,  4.60s/it]
test ppl:  80%|████████  | 189/236 [13:20<04:14,  5.41s/it]
test ppl:  81%|████████  | 190/236 [13:25<04:06,  5.36s/it]
test ppl:  81%|████████  | 191/236 [13:30<04:00,  5.35s/it]
test ppl:  81%|████████▏ | 192/236 [13:34<03:27,  4.73s/it]
test ppl:  82%|████████▏ | 193/236 [13:41<03:56,  5.51s/it]
test ppl:  82%|████████▏ | 194/236 [13:44<03:18,  4.73s/it]
test ppl:  83%|████████▎ | 195/236 [13:47<02:54,  4.26s/it]
test ppl:  83%|████████▎ | 196/236 [13:50<02:34,  3.86s/it]
test ppl:  83%|████████▎ | 197/236 [13:53<02:23,  3.69s/it]
test ppl:  84%|████████▍ | 198/236 [14:00<03:01,  4.77s/it]
test ppl:  84%|████████▍ | 199/236 [14:04<02:40,  4.35s/it]
test ppl:  85%|████████▍ | 200/236 [14:11<03:08,  5.23s/it]
test ppl:  85%|████████▌ | 201/236 [14:14<02:41,  4.62s/it]
test ppl:  86%|████████▌ | 202/236 [14:20<02:46,  4.89s/it]
test ppl:  86%|████████▌ | 203/236 [14:27<03:05,  5.62s/it]
test ppl:  86%|████████▋ | 204/236 [14:30<02:29,  4.66s/it]
test ppl:  87%|████████▋ | 205/236 [14:35<02:30,  4.86s/it]
test ppl:  87%|████████▋ | 206/236 [14:39<02:18,  4.63s/it]
test ppl:  88%|████████▊ | 207/236 [14:46<02:37,  5.43s/it]
test ppl:  88%|████████▊ | 208/236 [14:54<02:47,  5.99s/it]
test ppl:  89%|████████▊ | 209/236 [15:01<02:53,  6.41s/it]
test ppl:  89%|████████▉ | 210/236 [15:04<02:19,  5.36s/it]
test ppl:  89%|████████▉ | 211/236 [15:09<02:09,  5.17s/it]
test ppl:  90%|████████▉ | 212/236 [15:16<02:19,  5.80s/it]
test ppl:  90%|█████████ | 213/236 [15:23<02:23,  6.25s/it]
test ppl:  91%|█████████ | 214/236 [15:25<01:48,  4.91s/it]
test ppl:  91%|█████████ | 215/236 [15:29<01:40,  4.78s/it]
test ppl:  92%|█████████▏| 216/236 [15:32<01:23,  4.16s/it]
test ppl:  92%|█████████▏| 217/236 [15:38<01:29,  4.74s/it]
test ppl:  92%|█████████▏| 218/236 [15:44<01:31,  5.08s/it]
test ppl:  93%|█████████▎| 219/236 [15:50<01:30,  5.34s/it]
test ppl:  93%|█████████▎| 220/236 [15:54<01:17,  4.86s/it]
test ppl:  94%|█████████▎| 221/236 [15:55<00:56,  3.74s/it]
test ppl:  94%|█████████▍| 222/236 [16:01<01:01,  4.38s/it]
test ppl:  94%|█████████▍| 223/236 [16:07<01:02,  4.84s/it]
test ppl:  95%|█████████▍| 224/236 [16:08<00:46,  3.89s/it]
test ppl:  95%|█████████▌| 225/236 [16:14<00:49,  4.48s/it]
test ppl:  96%|█████████▌| 226/236 [16:17<00:38,  3.89s/it]
test ppl:  96%|█████████▌| 227/236 [16:19<00:29,  3.27s/it]
test ppl:  97%|█████████▋| 228/236 [16:21<00:23,  2.98s/it]
test ppl:  97%|█████████▋| 229/236 [16:27<00:26,  3.84s/it]
test ppl:  97%|█████████▋| 230/236 [16:32<00:26,  4.37s/it]
test ppl:  98%|█████████▊| 231/236 [16:36<00:20,  4.11s/it]
test ppl:  98%|█████████▊| 232/236 [16:37<00:13,  3.32s/it]
test ppl:  99%|█████████▊| 233/236 [16:40<00:09,  3.19s/it]
test ppl:  99%|█████████▉| 234/236 [16:41<00:05,  2.55s/it]
test ppl: 100%|█████████▉| 235/236 [16:47<00:03,  3.55s/it]
test ppl: 100%|██████████| 236/236 [16:48<00:00,  2.78s/it]
test ppl: 100%|██████████| 236/236 [16:48<00:00,  4.27s/it]
10/12/2024 11:27:13 - INFO - __main__ -    em: 0.1552
10/12/2024 11:27:13 - INFO - __main__ -   Finish and take 18m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.6 20:  em: 0.1552

--------------------------------------------------------------------------------
Running experiment with knn_temp=20, lmbda=0.6, k=32
2024-10-12 11:27:20.090399: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 11:27:20.109847: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 11:27:20.131350: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 11:27:20.137935: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 11:27:20.153822: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 11:27:21.148740: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 11:27:22 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.6, knn_temp=20, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 11:27:22 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:43:25,  2.19it/s]
Adding feature api:   3%|▎         | 6308/187062 [00:00<00:12, 15032.49it/s]
Adding feature api:   7%|▋         | 13517/187062 [00:00<00:05, 29523.23it/s]
Adding feature api:  11%|█         | 20766/187062 [00:00<00:04, 40960.72it/s]
Adding feature api:  15%|█▍        | 27847/187062 [00:00<00:03, 49183.40it/s]
Adding feature api:  19%|█▉        | 35126/187062 [00:00<00:02, 55849.37it/s]
Adding feature api:  23%|██▎       | 42415/187062 [00:01<00:02, 60745.65it/s]
Adding feature api:  27%|██▋       | 49757/187062 [00:01<00:02, 64432.32it/s]
Adding feature api:  30%|███       | 56876/187062 [00:01<00:01, 66416.01it/s]
Adding feature api:  34%|███▍      | 64203/187062 [00:01<00:01, 68439.06it/s]
Adding feature api:  38%|███▊      | 71529/187062 [00:01<00:01, 69869.01it/s]
Adding feature api:  42%|████▏     | 78886/187062 [00:01<00:01, 70970.34it/s]
Adding feature api:  46%|████▌     | 86187/187062 [00:01<00:01, 71576.87it/s]
Adding feature api:  50%|████▉     | 93452/187062 [00:01<00:01, 71371.98it/s]
Adding feature api:  54%|█████▍    | 100749/187062 [00:01<00:01, 71846.87it/s]
Adding feature api:  58%|█████▊    | 108069/187062 [00:01<00:01, 72244.16it/s]
Adding feature api:  62%|██████▏   | 115365/187062 [00:02<00:00, 72454.70it/s]
Adding feature api:  66%|██████▌   | 122637/187062 [00:02<00:00, 72035.01it/s]
Adding feature api:  69%|██████▉   | 129947/187062 [00:02<00:00, 72350.48it/s]
Adding feature api:  73%|███████▎  | 137267/187062 [00:02<00:00, 72601.25it/s]
Adding feature api:  77%|███████▋  | 144568/187062 [00:02<00:00, 72720.43it/s]
Adding feature api:  81%|████████  | 151847/187062 [00:02<00:00, 72228.51it/s]
Adding feature api:  85%|████████▌ | 159159/187062 [00:02<00:00, 72493.08it/s]
Adding feature api:  89%|████████▉ | 166416/187062 [00:02<00:00, 72513.18it/s]
Adding feature api:  93%|█████████▎| 173738/187062 [00:02<00:00, 72723.15it/s]
Adding feature api:  97%|█████████▋| 181013/187062 [00:03<00:00, 57980.33it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 57276.01it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<24:00:24,  2.16it/s]
Adding feature datatype:   3%|▎         | 6174/187062 [00:00<00:12, 14580.36it/s]
Adding feature datatype:   7%|▋         | 13173/187062 [00:00<00:06, 28558.25it/s]
Adding feature datatype:  11%|█         | 19921/187062 [00:00<00:04, 38868.52it/s]
Adding feature datatype:  14%|█▍        | 27013/187062 [00:00<00:03, 47666.14it/s]
Adding feature datatype:  18%|█▊        | 34110/187062 [00:00<00:02, 54230.42it/s]
Adding feature datatype:  22%|██▏       | 41222/187062 [00:01<00:02, 59074.46it/s]
Adding feature datatype:  26%|██▌       | 48379/187062 [00:01<00:02, 62706.02it/s]
Adding feature datatype:  30%|██▉       | 55275/187062 [00:01<00:02, 64257.86it/s]
Adding feature datatype:  33%|███▎      | 62308/187062 [00:01<00:01, 66044.47it/s]
Adding feature datatype:  37%|███▋      | 69376/187062 [00:01<00:01, 67416.61it/s]
Adding feature datatype:  41%|████      | 76494/187062 [00:01<00:01, 68533.88it/s]
Adding feature datatype:  45%|████▍     | 83663/187062 [00:01<00:01, 69472.48it/s]
Adding feature datatype:  49%|████▊     | 90811/187062 [00:01<00:01, 70069.78it/s]
Adding feature datatype:  52%|█████▏    | 97893/187062 [00:01<00:01, 69524.05it/s]
Adding feature datatype:  56%|█████▌    | 104993/187062 [00:01<00:01, 69961.07it/s]
Adding feature datatype:  60%|█████▉    | 112098/187062 [00:02<00:01, 70283.89it/s]
Adding feature datatype:  64%|██████▎   | 119176/187062 [00:02<00:00, 70430.56it/s]
Adding feature datatype:  68%|██████▊   | 126323/187062 [00:02<00:00, 70740.88it/s]
Adding feature datatype:  71%|███████▏  | 133467/187062 [00:02<00:00, 70949.01it/s]
Adding feature datatype:  75%|███████▌  | 140572/187062 [00:02<00:00, 70318.07it/s]
Adding feature datatype:  79%|███████▉  | 147709/187062 [00:02<00:00, 70628.87it/s]
Adding feature datatype:  83%|████████▎ | 154862/187062 [00:02<00:00, 70895.69it/s]
Adding feature datatype:  87%|████████▋ | 161963/187062 [00:02<00:00, 70927.50it/s]
Adding feature datatype:  90%|█████████ | 169059/187062 [00:02<00:00, 70282.15it/s]
Adding feature datatype:  94%|█████████▍| 176157/187062 [00:02<00:00, 70488.37it/s]
Adding feature datatype:  98%|█████████▊| 183209/187062 [00:03<00:00, 49647.27it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 55935.70it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:44:17,  2.19it/s]
Adding feature literal:   3%|▎         | 6140/187062 [00:00<00:12, 14625.28it/s]
Adding feature literal:   7%|▋         | 13238/187062 [00:00<00:06, 28933.26it/s]
Adding feature literal:  11%|█         | 20280/187062 [00:00<00:04, 39975.33it/s]
Adding feature literal:  15%|█▍        | 27383/187062 [00:00<00:03, 48527.45it/s]
Adding feature literal:  18%|█▊        | 34454/187062 [00:00<00:02, 54789.41it/s]
Adding feature literal:  22%|██▏       | 41534/187062 [00:01<00:02, 59388.99it/s]
Adding feature literal:  26%|██▌       | 48622/187062 [00:01<00:02, 62733.52it/s]
Adding feature literal:  30%|██▉       | 55798/187062 [00:01<00:02, 65382.58it/s]
Adding feature literal:  34%|███▎      | 62934/187062 [00:01<00:01, 67148.67it/s]
Adding feature literal:  37%|███▋      | 70088/187062 [00:01<00:01, 68449.76it/s]
Adding feature literal:  41%|████▏     | 77193/187062 [00:01<00:01, 69217.44it/s]
Adding feature literal:  45%|████▌     | 84341/187062 [00:01<00:01, 69889.66it/s]
Adding feature literal:  49%|████▉     | 91487/187062 [00:01<00:01, 70358.34it/s]
Adding feature literal:  53%|█████▎    | 98625/187062 [00:01<00:01, 70660.89it/s]
Adding feature literal:  57%|█████▋    | 105745/187062 [00:01<00:01, 70820.57it/s]
Adding feature literal:  60%|██████    | 112864/187062 [00:02<00:01, 70872.70it/s]
Adding feature literal:  64%|██████▍   | 120064/187062 [00:02<00:00, 71207.61it/s]
Adding feature literal:  68%|██████▊   | 127263/187062 [00:02<00:00, 71440.92it/s]
Adding feature literal:  72%|███████▏  | 134420/187062 [00:02<00:00, 71458.44it/s]
Adding feature literal:  76%|███████▌  | 141575/187062 [00:02<00:00, 71315.67it/s]
Adding feature literal:  79%|███████▉  | 148713/187062 [00:02<00:00, 70926.39it/s]
Adding feature literal:  83%|████████▎ | 155866/187062 [00:02<00:00, 71103.66it/s]
Adding feature literal:  87%|████████▋ | 162980/187062 [00:02<00:00, 71113.63it/s]
Adding feature literal:  91%|█████████ | 170131/187062 [00:02<00:00, 71231.32it/s]
Adding feature literal:  95%|█████████▍| 177277/187062 [00:02<00:00, 71297.72it/s]
Adding feature literal:  99%|█████████▊| 184408/187062 [00:03<00:00, 47615.89it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 56433.10it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:46:45,  2.19it/s]
Adding feature operator:   3%|▎         | 6180/187062 [00:00<00:12, 14701.18it/s]
Adding feature operator:   7%|▋         | 13236/187062 [00:00<00:06, 28869.28it/s]
Adding feature operator:  11%|█         | 20364/187062 [00:00<00:04, 40147.77it/s]
Adding feature operator:  15%|█▍        | 27419/187062 [00:00<00:03, 48518.22it/s]
Adding feature operator:  18%|█▊        | 34520/187062 [00:00<00:02, 54867.13it/s]
Adding feature operator:  22%|██▏       | 41676/187062 [00:01<00:02, 59662.83it/s]
Adding feature operator:  26%|██▌       | 48828/187062 [00:01<00:02, 63112.51it/s]
Adding feature operator:  30%|██▉       | 55973/187062 [00:01<00:01, 65558.41it/s]
Adding feature operator:  34%|███▎      | 63131/187062 [00:01<00:01, 67335.70it/s]
Adding feature operator:  38%|███▊      | 70305/187062 [00:01<00:01, 68640.58it/s]
Adding feature operator:  41%|████▏     | 77474/187062 [00:01<00:01, 69546.49it/s]
Adding feature operator:  45%|████▌     | 84644/187062 [00:01<00:01, 70187.40it/s]
Adding feature operator:  49%|████▉     | 91824/187062 [00:01<00:01, 70668.37it/s]
Adding feature operator:  53%|█████▎    | 98965/187062 [00:01<00:01, 70684.61it/s]
Adding feature operator:  57%|█████▋    | 106131/187062 [00:01<00:01, 70974.61it/s]
Adding feature operator:  61%|██████    | 113270/187062 [00:02<00:01, 71097.95it/s]
Adding feature operator:  64%|██████▍   | 120471/187062 [00:02<00:00, 71367.60it/s]
Adding feature operator:  68%|██████▊   | 127626/187062 [00:02<00:00, 71356.82it/s]
Adding feature operator:  72%|███████▏  | 134812/187062 [00:02<00:00, 71504.59it/s]
Adding feature operator:  76%|███████▌  | 142018/187062 [00:02<00:00, 71670.27it/s]
Adding feature operator:  80%|███████▉  | 149231/187062 [00:02<00:00, 71804.61it/s]
Adding feature operator:  84%|████████▎ | 156416/187062 [00:02<00:00, 71805.66it/s]
Adding feature operator:  87%|████████▋ | 163618/187062 [00:02<00:00, 71868.87it/s]
Adding feature operator:  91%|█████████▏| 170831/187062 [00:02<00:00, 71944.32it/s]
Adding feature operator:  95%|█████████▌| 178027/187062 [00:02<00:00, 70541.27it/s]
Adding feature operator:  99%|█████████▉| 185089/187062 [00:03<00:00, 47011.06it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 56645.58it/s]
[2024-10-12 11:28:08,167] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 11:28:09 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 11:28:09 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:16, 389.36 examples/s]
Map:   1%|▏         | 83/6548 [00:00<00:29, 217.37 examples/s]
Map:   2%|▏         | 125/6548 [00:00<00:23, 269.84 examples/s]
Map:   3%|▎         | 173/6548 [00:00<00:19, 327.88 examples/s]
Map:   3%|▎         | 215/6548 [00:00<00:17, 352.17 examples/s]
Map:   4%|▍         | 274/6548 [00:00<00:17, 363.44 examples/s]
Map:   5%|▍         | 325/6548 [00:01<00:20, 304.12 examples/s]
Map:   6%|▌         | 363/6548 [00:01<00:19, 316.11 examples/s]
Map:   6%|▋         | 415/6548 [00:01<00:16, 363.36 examples/s]
Map:   7%|▋         | 458/6548 [00:01<00:18, 331.45 examples/s]
Map:   8%|▊         | 505/6548 [00:01<00:18, 321.97 examples/s]
Map:   9%|▊         | 563/6548 [00:01<00:16, 371.32 examples/s]
Map:   9%|▉         | 606/6548 [00:01<00:15, 383.30 examples/s]
Map:  10%|█         | 666/6548 [00:02<00:18, 326.14 examples/s]
Map:  11%|█         | 710/6548 [00:02<00:16, 348.43 examples/s]
Map:  12%|█▏        | 755/6548 [00:02<00:15, 371.58 examples/s]
Map:  12%|█▏        | 808/6548 [00:02<00:14, 409.76 examples/s]
Map:  13%|█▎        | 854/6548 [00:02<00:14, 399.84 examples/s]
Map:  14%|█▍        | 909/6548 [00:02<00:14, 382.93 examples/s]
Map:  15%|█▍        | 966/6548 [00:02<00:14, 378.54 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:25, 219.70 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:22, 244.86 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:19, 278.67 examples/s]
Map:  18%|█▊        | 1146/6548 [00:03<00:17, 316.55 examples/s]
Map:  18%|█▊        | 1185/6548 [00:03<00:16, 327.63 examples/s]
Map:  19%|█▉        | 1228/6548 [00:03<00:15, 341.24 examples/s]
Map:  19%|█▉        | 1270/6548 [00:03<00:14, 359.47 examples/s]
Map:  20%|██        | 1325/6548 [00:04<00:15, 346.68 examples/s]
Map:  21%|██        | 1370/6548 [00:04<00:16, 322.49 examples/s]
Map:  22%|██▏       | 1423/6548 [00:04<00:15, 328.35 examples/s]
Map:  22%|██▏       | 1461/6548 [00:04<00:17, 294.00 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:16, 298.12 examples/s]
Map:  24%|██▎       | 1542/6548 [00:04<00:16, 296.63 examples/s]
Map:  24%|██▍       | 1579/6548 [00:04<00:16, 310.10 examples/s]
Map:  25%|██▍       | 1612/6548 [00:05<00:18, 269.62 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:17, 278.72 examples/s]
Map:  26%|██▌       | 1695/6548 [00:05<00:16, 291.46 examples/s]
Map:  26%|██▋       | 1735/6548 [00:05<00:15, 315.35 examples/s]
Map:  27%|██▋       | 1779/6548 [00:05<00:13, 344.87 examples/s]
Map:  28%|██▊       | 1842/6548 [00:05<00:13, 354.82 examples/s]
Map:  29%|██▉       | 1887/6548 [00:05<00:14, 332.63 examples/s]
Map:  29%|██▉       | 1926/6548 [00:05<00:13, 345.10 examples/s]
Map:  30%|███       | 1966/6548 [00:06<00:12, 356.13 examples/s]
Map:  31%|███       | 2018/6548 [00:06<00:18, 240.65 examples/s]
Map:  31%|███▏      | 2049/6548 [00:06<00:18, 249.30 examples/s]
Map:  32%|███▏      | 2092/6548 [00:06<00:15, 280.94 examples/s]
Map:  33%|███▎      | 2136/6548 [00:06<00:15, 283.76 examples/s]
Map:  33%|███▎      | 2180/6548 [00:06<00:16, 272.08 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 276.83 examples/s]
Map:  34%|███▍      | 2255/6548 [00:07<00:16, 265.73 examples/s]
Map:  35%|███▍      | 2286/6548 [00:07<00:15, 270.26 examples/s]
Map:  36%|███▌      | 2331/6548 [00:07<00:13, 305.50 examples/s]
Map:  36%|███▋      | 2382/6548 [00:07<00:13, 315.10 examples/s]
Map:  37%|███▋      | 2435/6548 [00:07<00:12, 326.09 examples/s]
Map:  38%|███▊      | 2472/6548 [00:07<00:13, 293.05 examples/s]
Map:  38%|███▊      | 2510/6548 [00:08<00:12, 311.40 examples/s]
Map:  39%|███▉      | 2551/6548 [00:08<00:12, 330.06 examples/s]
Map:  40%|███▉      | 2598/6548 [00:08<00:10, 363.15 examples/s]
Map:  40%|████      | 2639/6548 [00:08<00:10, 370.54 examples/s]
Map:  41%|████      | 2697/6548 [00:08<00:10, 356.10 examples/s]
Map:  42%|████▏     | 2737/6548 [00:08<00:10, 348.87 examples/s]
Map:  42%|████▏     | 2775/6548 [00:08<00:10, 352.97 examples/s]
Map:  43%|████▎     | 2822/6548 [00:08<00:11, 334.05 examples/s]
Map:  44%|████▎     | 2859/6548 [00:09<00:13, 276.39 examples/s]
Map:  44%|████▍     | 2896/6548 [00:09<00:12, 293.79 examples/s]
Map:  45%|████▌     | 2949/6548 [00:09<00:12, 278.07 examples/s]
Map:  46%|████▌     | 2986/6548 [00:09<00:12, 296.10 examples/s]
Map:  46%|████▌     | 3026/6548 [00:09<00:20, 170.65 examples/s]
Map:  47%|████▋     | 3062/6548 [00:10<00:17, 197.19 examples/s]
Map:  47%|████▋     | 3097/6548 [00:10<00:15, 223.41 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 254.82 examples/s]
Map:  49%|████▊     | 3183/6548 [00:10<00:14, 240.34 examples/s]
Map:  49%|████▉     | 3218/6548 [00:10<00:14, 236.43 examples/s]
Map:  50%|████▉     | 3252/6548 [00:10<00:12, 256.01 examples/s]
Map:  50%|█████     | 3286/6548 [00:10<00:12, 268.24 examples/s]
Map:  51%|█████     | 3331/6548 [00:10<00:10, 304.10 examples/s]
Map:  52%|█████▏    | 3380/6548 [00:11<00:10, 301.77 examples/s]
Map:  52%|█████▏    | 3423/6548 [00:11<00:11, 282.93 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 273.99 examples/s]
Map:  53%|█████▎    | 3485/6548 [00:11<00:11, 278.15 examples/s]
Map:  54%|█████▍    | 3530/6548 [00:11<00:09, 317.34 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:11<00:08, 346.51 examples/s]
Map:  55%|█████▌    | 3622/6548 [00:11<00:07, 371.60 examples/s]
Map:  56%|█████▌    | 3676/6548 [00:12<00:07, 362.04 examples/s]
Map:  57%|█████▋    | 3722/6548 [00:12<00:07, 383.38 examples/s]
Map:  58%|█████▊    | 3772/6548 [00:12<00:07, 362.04 examples/s]
Map:  58%|█████▊    | 3811/6548 [00:12<00:07, 360.09 examples/s]
Map:  59%|█████▉    | 3849/6548 [00:12<00:08, 314.80 examples/s]
Map:  59%|█████▉    | 3887/6548 [00:12<00:08, 324.33 examples/s]
Map:  60%|██████    | 3929/6548 [00:12<00:08, 327.20 examples/s]
Map:  61%|██████    | 3973/6548 [00:12<00:07, 342.52 examples/s]
Map:  62%|██████▏   | 4029/6548 [00:13<00:10, 248.29 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 291.35 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 315.32 examples/s]
Map:  64%|██████▎   | 4164/6548 [00:13<00:08, 295.62 examples/s]
Map:  64%|██████▍   | 4203/6548 [00:13<00:07, 308.74 examples/s]
Map:  65%|██████▍   | 4238/6548 [00:13<00:07, 316.37 examples/s]
Map:  65%|██████▌   | 4288/6548 [00:13<00:06, 354.70 examples/s]
Map:  66%|██████▌   | 4334/6548 [00:14<00:05, 378.33 examples/s]
Map:  67%|██████▋   | 4388/6548 [00:14<00:06, 359.46 examples/s]
Map:  68%|██████▊   | 4427/6548 [00:14<00:05, 366.83 examples/s]
Map:  68%|██████▊   | 4469/6548 [00:14<00:06, 333.66 examples/s]
Map:  69%|██████▉   | 4516/6548 [00:14<00:06, 320.07 examples/s]
Map:  70%|██████▉   | 4570/6548 [00:14<00:06, 324.82 examples/s]
Map:  70%|███████   | 4610/6548 [00:14<00:05, 329.09 examples/s]
Map:  71%|███████   | 4659/6548 [00:15<00:05, 365.74 examples/s]
Map:  72%|███████▏  | 4715/6548 [00:15<00:05, 366.24 examples/s]
Map:  73%|███████▎  | 4753/6548 [00:15<00:04, 367.87 examples/s]
Map:  73%|███████▎  | 4810/6548 [00:15<00:04, 418.30 examples/s]
Map:  74%|███████▍  | 4868/6548 [00:15<00:04, 352.24 examples/s]
Map:  75%|███████▌  | 4933/6548 [00:15<00:04, 368.87 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:04, 385.83 examples/s]
Map:  77%|███████▋  | 5040/6548 [00:16<00:06, 248.38 examples/s]
Map:  78%|███████▊  | 5082/6548 [00:16<00:05, 254.80 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 264.53 examples/s]
Map:  79%|███████▊  | 5155/6548 [00:16<00:04, 281.45 examples/s]
Map:  79%|███████▉  | 5187/6548 [00:16<00:04, 281.70 examples/s]
Map:  80%|███████▉  | 5235/6548 [00:16<00:04, 291.52 examples/s]
Map:  81%|████████  | 5286/6548 [00:17<00:03, 320.06 examples/s]
Map:  81%|████████  | 5320/6548 [00:17<00:03, 318.65 examples/s]
Map:  82%|████████▏ | 5358/6548 [00:17<00:04, 287.66 examples/s]
Map:  82%|████████▏ | 5392/6548 [00:17<00:04, 284.99 examples/s]
Map:  83%|████████▎ | 5440/6548 [00:17<00:03, 294.80 examples/s]
Map:  84%|████████▍ | 5485/6548 [00:17<00:03, 319.02 examples/s]
Map:  84%|████████▍ | 5519/6548 [00:17<00:03, 315.65 examples/s]
Map:  85%|████████▍ | 5559/6548 [00:17<00:02, 331.03 examples/s]
Map:  86%|████████▌ | 5604/6548 [00:18<00:03, 307.20 examples/s]
Map:  86%|████████▌ | 5647/6548 [00:18<00:02, 320.23 examples/s]
Map:  87%|████████▋ | 5680/6548 [00:18<00:02, 302.22 examples/s]
Map:  87%|████████▋ | 5716/6548 [00:18<00:02, 312.20 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 338.81 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 344.55 examples/s]
Map:  89%|████████▉ | 5837/6548 [00:18<00:02, 345.96 examples/s]
Map:  90%|████████▉ | 5879/6548 [00:18<00:01, 363.72 examples/s]
Map:  91%|█████████ | 5933/6548 [00:19<00:01, 353.27 examples/s]
Map:  91%|█████████▏| 5988/6548 [00:19<00:01, 339.14 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 236.00 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 268.32 examples/s]
Map:  94%|█████████▎| 6131/6548 [00:19<00:01, 256.39 examples/s]
Map:  94%|█████████▍| 6167/6548 [00:19<00:01, 273.95 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:20<00:01, 296.20 examples/s]
Map:  96%|█████████▌| 6262/6548 [00:20<00:00, 309.38 examples/s]
Map:  96%|█████████▋| 6303/6548 [00:20<00:00, 331.12 examples/s]
Map:  97%|█████████▋| 6339/6548 [00:20<00:00, 337.64 examples/s]
Map:  98%|█████████▊| 6386/6548 [00:20<00:00, 358.66 examples/s]
Map:  98%|█████████▊| 6427/6548 [00:20<00:00, 370.58 examples/s]
Map:  99%|█████████▉| 6475/6548 [00:20<00:00, 399.00 examples/s]
Map: 100%|█████████▉| 6537/6548 [00:20<00:00, 394.60 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 310.57 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 322.27 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 343.42 examples/s]
Map:  13%|█▎        | 115/903 [00:00<00:02, 337.67 examples/s]
Map:  17%|█▋        | 153/903 [00:00<00:02, 350.93 examples/s]
Map:  22%|██▏       | 203/903 [00:00<00:01, 400.19 examples/s]
Map:  29%|██▊       | 259/903 [00:00<00:01, 385.41 examples/s]
Map:  35%|███▍      | 313/903 [00:00<00:01, 372.82 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 328.52 examples/s]
Map:  44%|████▎     | 395/903 [00:01<00:01, 296.36 examples/s]
Map:  48%|████▊     | 436/903 [00:01<00:01, 300.71 examples/s]
Map:  53%|█████▎    | 475/903 [00:01<00:01, 316.72 examples/s]
Map:  56%|█████▋    | 509/903 [00:01<00:01, 321.72 examples/s]
Map:  62%|██████▏   | 558/903 [00:01<00:00, 356.93 examples/s]
Map:  66%|██████▌   | 598/903 [00:01<00:00, 366.27 examples/s]
Map:  72%|███████▏  | 653/903 [00:01<00:00, 363.22 examples/s]
Map:  77%|███████▋  | 696/903 [00:01<00:00, 374.39 examples/s]
Map:  82%|████████▏ | 740/903 [00:02<00:00, 390.90 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 386.24 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 385.31 examples/s]
Map:  96%|█████████▋| 870/903 [00:02<00:00, 398.64 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 324.78 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 298.56 examples/s]
Map:   4%|▍         | 81/1882 [00:00<00:04, 366.53 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 352.28 examples/s]
Map:   9%|▉         | 172/1882 [00:00<00:04, 348.28 examples/s]
Map:  12%|█▏        | 231/1882 [00:00<00:04, 358.48 examples/s]
Map:  15%|█▍        | 273/1882 [00:00<00:04, 374.09 examples/s]
Map:  18%|█▊        | 333/1882 [00:00<00:04, 375.27 examples/s]
Map:  20%|██        | 381/1882 [00:01<00:04, 312.50 examples/s]
Map:  23%|██▎       | 426/1882 [00:01<00:04, 295.62 examples/s]
Map:  25%|██▍       | 469/1882 [00:01<00:04, 312.39 examples/s]
Map:  27%|██▋       | 507/1882 [00:01<00:04, 317.35 examples/s]
Map:  30%|██▉       | 562/1882 [00:01<00:04, 328.33 examples/s]
Map:  32%|███▏      | 611/1882 [00:01<00:03, 358.72 examples/s]
Map:  35%|███▍      | 657/1882 [00:01<00:03, 380.24 examples/s]
Map:  37%|███▋      | 704/1882 [00:02<00:03, 390.69 examples/s]
Map:  41%|████      | 768/1882 [00:02<00:02, 397.36 examples/s]
Map:  43%|████▎     | 809/1882 [00:02<00:03, 348.47 examples/s]
Map:  45%|████▌     | 851/1882 [00:02<00:02, 363.98 examples/s]
Map:  48%|████▊     | 903/1882 [00:02<00:02, 355.70 examples/s]
Map:  50%|█████     | 947/1882 [00:02<00:02, 372.37 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 382.81 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 246.78 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 262.40 examples/s]
Map:  59%|█████▉    | 1107/1882 [00:03<00:02, 276.66 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 284.72 examples/s]
Map:  62%|██████▏   | 1175/1882 [00:03<00:02, 299.15 examples/s]
Map:  64%|██████▍   | 1212/1882 [00:03<00:02, 277.12 examples/s]
Map:  67%|██████▋   | 1254/1882 [00:03<00:02, 309.76 examples/s]
Map:  69%|██████▉   | 1295/1882 [00:03<00:01, 331.21 examples/s]
Map:  71%|███████   | 1338/1882 [00:04<00:01, 356.70 examples/s]
Map:  74%|███████▎  | 1385/1882 [00:04<00:01, 335.64 examples/s]
Map:  76%|███████▌  | 1428/1882 [00:04<00:01, 284.22 examples/s]
Map:  78%|███████▊  | 1471/1882 [00:04<00:01, 309.39 examples/s]
Map:  80%|████████  | 1507/1882 [00:04<00:01, 275.53 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 287.19 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:04<00:00, 310.72 examples/s]
Map:  86%|████████▋ | 1626/1882 [00:04<00:00, 337.72 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 334.54 examples/s]
Map:  91%|█████████ | 1716/1882 [00:05<00:00, 335.99 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 284.05 examples/s]
Map:  95%|█████████▍| 1784/1882 [00:05<00:00, 289.36 examples/s]
Map:  97%|█████████▋| 1826/1882 [00:05<00:00, 318.85 examples/s]
Map:  99%|█████████▉| 1869/1882 [00:05<00:00, 344.08 examples/s]
Map: 100%|██████████| 1882/1882 [00:05<00:00, 314.70 examples/s]
10/12/2024 11:29:11 - INFO - __main__ -     ***** Testing *****
10/12/2024 11:29:11 - INFO - __main__ -     Batch size = 8
10/12/2024 11:29:11 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 11:29:12 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 11:29:12 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 11:29:13 - INFO - knnlm -   Reading datastore took 0.9216256141662598 s
10/12/2024 11:29:14 - INFO - knnlm -   Moving index to GPU took 0.9093682765960693 s
10/12/2024 11:29:14 - INFO - __main__ -   ******************************break-into
10/12/2024 11:29:14 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 11:29:14 - INFO - __main__ -     Num examples = 236
10/12/2024 11:29:14 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<31:58,  8.16s/it]
test ppl:   1%|          | 2/236 [00:09<17:11,  4.41s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:59,  3.09s/it]
test ppl:   2%|▏         | 4/236 [00:17<16:16,  4.21s/it]
test ppl:   2%|▏         | 5/236 [00:23<18:37,  4.84s/it]
test ppl:   3%|▎         | 6/236 [00:29<19:59,  5.22s/it]
test ppl:   3%|▎         | 7/236 [00:31<15:51,  4.16s/it]
test ppl:   3%|▎         | 8/236 [00:36<17:07,  4.51s/it]
test ppl:   4%|▍         | 9/236 [00:39<15:14,  4.03s/it]
test ppl:   4%|▍         | 10/236 [00:43<15:22,  4.08s/it]
test ppl:   5%|▍         | 11/236 [00:49<17:19,  4.62s/it]
test ppl:   5%|▌         | 12/236 [00:55<18:46,  5.03s/it]
test ppl:   6%|▌         | 13/236 [01:01<19:44,  5.31s/it]
test ppl:   6%|▌         | 14/236 [01:07<20:21,  5.50s/it]
test ppl:   6%|▋         | 15/236 [01:10<17:14,  4.68s/it]
test ppl:   7%|▋         | 16/236 [01:12<14:11,  3.87s/it]
test ppl:   7%|▋         | 17/236 [01:17<16:07,  4.42s/it]
test ppl:   8%|▊         | 18/236 [01:19<12:46,  3.52s/it]
test ppl:   8%|▊         | 19/236 [01:23<13:43,  3.79s/it]
test ppl:   8%|▊         | 20/236 [01:26<12:17,  3.42s/it]
test ppl:   9%|▉         | 21/236 [01:32<14:56,  4.17s/it]
test ppl:   9%|▉         | 22/236 [01:38<16:46,  4.71s/it]
test ppl:  10%|▉         | 23/236 [01:43<17:01,  4.80s/it]
test ppl:  10%|█         | 24/236 [01:45<14:40,  4.15s/it]
test ppl:  11%|█         | 25/236 [01:47<12:04,  3.43s/it]
test ppl:  11%|█         | 26/236 [01:52<13:32,  3.87s/it]
test ppl:  11%|█▏        | 27/236 [01:56<13:40,  3.92s/it]
test ppl:  12%|█▏        | 28/236 [01:58<11:07,  3.21s/it]
test ppl:  12%|█▏        | 29/236 [02:00<10:06,  2.93s/it]
test ppl:  13%|█▎        | 30/236 [02:01<08:37,  2.51s/it]
test ppl:  13%|█▎        | 31/236 [02:07<12:03,  3.53s/it]
test ppl:  14%|█▎        | 32/236 [02:13<14:28,  4.26s/it]
test ppl:  14%|█▍        | 33/236 [02:19<16:07,  4.77s/it]
test ppl:  14%|█▍        | 34/236 [02:23<15:20,  4.56s/it]
test ppl:  15%|█▍        | 35/236 [02:29<16:39,  4.97s/it]
test ppl:  15%|█▌        | 36/236 [02:35<17:32,  5.26s/it]
test ppl:  16%|█▌        | 37/236 [02:41<18:09,  5.48s/it]
test ppl:  16%|█▌        | 38/236 [02:45<16:22,  4.96s/it]
test ppl:  17%|█▋        | 39/236 [02:46<12:52,  3.92s/it]
test ppl:  17%|█▋        | 40/236 [02:48<10:15,  3.14s/it]
test ppl:  17%|█▋        | 41/236 [02:50<08:58,  2.76s/it]
test ppl:  18%|█▊        | 42/236 [02:56<12:04,  3.73s/it]
test ppl:  18%|█▊        | 43/236 [03:01<14:08,  4.40s/it]
test ppl:  19%|█▊        | 44/236 [03:05<12:47,  4.00s/it]
test ppl:  19%|█▉        | 45/236 [03:06<10:39,  3.35s/it]
test ppl:  19%|█▉        | 46/236 [03:12<13:04,  4.13s/it]
test ppl:  20%|█▉        | 47/236 [03:14<10:33,  3.35s/it]
test ppl:  20%|██        | 48/236 [03:20<12:54,  4.12s/it]
test ppl:  21%|██        | 49/236 [03:25<13:27,  4.32s/it]
test ppl:  21%|██        | 50/236 [03:31<14:57,  4.83s/it]
test ppl:  22%|██▏       | 51/236 [03:35<14:05,  4.57s/it]
test ppl:  22%|██▏       | 52/236 [03:40<15:15,  4.98s/it]
test ppl:  22%|██▏       | 53/236 [03:44<14:04,  4.61s/it]
test ppl:  23%|██▎       | 54/236 [03:46<11:31,  3.80s/it]
test ppl:  23%|██▎       | 55/236 [03:51<12:43,  4.22s/it]
test ppl:  24%|██▎       | 56/236 [03:57<14:13,  4.74s/it]
test ppl:  24%|██▍       | 57/236 [04:03<15:13,  5.11s/it]
test ppl:  25%|██▍       | 58/236 [04:05<12:27,  4.20s/it]
test ppl:  25%|██▌       | 59/236 [04:11<13:55,  4.72s/it]
test ppl:  25%|██▌       | 60/236 [04:16<13:32,  4.62s/it]
test ppl:  26%|██▌       | 61/236 [04:18<11:35,  3.98s/it]
test ppl:  26%|██▋       | 62/236 [04:22<11:38,  4.02s/it]
test ppl:  27%|██▋       | 63/236 [04:25<10:15,  3.56s/it]
test ppl:  27%|██▋       | 64/236 [04:27<08:59,  3.13s/it]
test ppl:  28%|██▊       | 65/236 [04:28<07:24,  2.60s/it]
test ppl:  28%|██▊       | 66/236 [04:32<08:14,  2.91s/it]
test ppl:  28%|██▊       | 67/236 [04:38<10:46,  3.82s/it]
test ppl:  29%|██▉       | 68/236 [04:44<12:28,  4.46s/it]
test ppl:  29%|██▉       | 69/236 [04:50<13:38,  4.90s/it]
test ppl:  30%|██▉       | 70/236 [04:51<10:43,  3.88s/it]
test ppl:  30%|███       | 71/236 [04:54<10:06,  3.67s/it]
test ppl:  31%|███       | 72/236 [04:57<09:09,  3.35s/it]
test ppl:  31%|███       | 73/236 [05:03<11:13,  4.13s/it]
test ppl:  31%|███▏      | 74/236 [05:09<12:35,  4.66s/it]
test ppl:  32%|███▏      | 75/236 [05:15<13:32,  5.05s/it]
test ppl:  32%|███▏      | 76/236 [05:21<14:10,  5.31s/it]
test ppl:  33%|███▎      | 77/236 [05:23<11:41,  4.41s/it]
test ppl:  33%|███▎      | 78/236 [05:25<09:24,  3.58s/it]
test ppl:  33%|███▎      | 79/236 [05:29<09:34,  3.66s/it]
test ppl:  34%|███▍      | 80/236 [05:34<11:16,  4.34s/it]
test ppl:  34%|███▍      | 81/236 [05:40<12:25,  4.81s/it]
test ppl:  35%|███▍      | 82/236 [05:46<13:14,  5.16s/it]
test ppl:  35%|███▌      | 83/236 [05:52<13:44,  5.39s/it]
test ppl:  36%|███▌      | 84/236 [05:55<11:20,  4.48s/it]
test ppl:  36%|███▌      | 85/236 [05:59<11:08,  4.43s/it]
test ppl:  36%|███▋      | 86/236 [06:00<08:56,  3.57s/it]
test ppl:  37%|███▋      | 87/236 [06:03<08:13,  3.32s/it]
test ppl:  37%|███▋      | 88/236 [06:09<10:05,  4.09s/it]
test ppl:  38%|███▊      | 89/236 [06:11<08:38,  3.53s/it]
test ppl:  38%|███▊      | 90/236 [06:17<10:18,  4.24s/it]
test ppl:  39%|███▊      | 91/236 [06:23<11:20,  4.69s/it]
test ppl:  39%|███▉      | 92/236 [06:26<09:55,  4.13s/it]
test ppl:  39%|███▉      | 93/236 [06:32<11:07,  4.67s/it]
test ppl:  40%|███▉      | 94/236 [06:38<11:56,  5.04s/it]
test ppl:  40%|████      | 95/236 [06:40<09:53,  4.21s/it]
test ppl:  41%|████      | 96/236 [06:43<08:57,  3.84s/it]
test ppl:  41%|████      | 97/236 [06:49<10:20,  4.46s/it]
test ppl:  42%|████▏     | 98/236 [06:55<11:17,  4.91s/it]
test ppl:  42%|████▏     | 99/236 [07:01<11:55,  5.22s/it]
test ppl:  42%|████▏     | 100/236 [07:02<08:58,  3.96s/it]
test ppl:  43%|████▎     | 101/236 [07:08<10:14,  4.55s/it]
test ppl:  43%|████▎     | 102/236 [07:12<09:49,  4.40s/it]
test ppl:  44%|████▎     | 103/236 [07:15<08:46,  3.96s/it]
test ppl:  44%|████▍     | 104/236 [07:19<08:53,  4.04s/it]
test ppl:  44%|████▍     | 105/236 [07:23<09:00,  4.13s/it]
test ppl:  45%|████▍     | 106/236 [07:29<09:48,  4.53s/it]
test ppl:  45%|████▌     | 107/236 [07:31<08:08,  3.79s/it]
test ppl:  46%|████▌     | 108/236 [07:36<09:20,  4.38s/it]
test ppl:  46%|████▌     | 109/236 [07:41<09:17,  4.39s/it]
test ppl:  47%|████▋     | 110/236 [07:42<07:27,  3.56s/it]
test ppl:  47%|████▋     | 111/236 [07:48<08:53,  4.27s/it]
test ppl:  47%|████▋     | 112/236 [07:54<09:51,  4.77s/it]
test ppl:  48%|████▊     | 113/236 [07:56<07:56,  3.87s/it]
test ppl:  48%|████▊     | 114/236 [07:59<07:33,  3.72s/it]
test ppl:  49%|████▊     | 115/236 [08:05<08:50,  4.38s/it]
test ppl:  49%|████▉     | 116/236 [08:11<09:42,  4.85s/it]
test ppl:  50%|████▉     | 117/236 [08:13<07:50,  3.96s/it]
test ppl:  50%|█████     | 118/236 [08:19<08:56,  4.55s/it]
test ppl:  50%|█████     | 119/236 [08:22<07:40,  3.94s/it]
test ppl:  51%|█████     | 120/236 [08:23<06:07,  3.17s/it]
test ppl:  51%|█████▏    | 121/236 [08:29<07:39,  3.99s/it]
test ppl:  52%|█████▏    | 122/236 [08:35<08:41,  4.58s/it]
test ppl:  52%|█████▏    | 123/236 [08:41<09:23,  4.99s/it]
test ppl:  53%|█████▎    | 124/236 [08:44<08:23,  4.49s/it]
test ppl:  53%|█████▎    | 125/236 [08:47<07:17,  3.94s/it]
test ppl:  53%|█████▎    | 126/236 [08:52<07:41,  4.20s/it]
test ppl:  54%|█████▍    | 127/236 [08:53<06:13,  3.43s/it]
test ppl:  54%|█████▍    | 128/236 [08:55<05:20,  2.97s/it]
test ppl:  55%|█████▍    | 129/236 [08:58<05:05,  2.86s/it]
test ppl:  55%|█████▌    | 130/236 [09:01<05:11,  2.94s/it]
test ppl:  56%|█████▌    | 131/236 [09:07<06:43,  3.85s/it]
test ppl:  56%|█████▌    | 132/236 [09:11<06:35,  3.80s/it]
test ppl:  56%|█████▋    | 133/236 [09:14<06:34,  3.83s/it]
test ppl:  57%|█████▋    | 134/236 [09:18<06:19,  3.72s/it]
test ppl:  57%|█████▋    | 135/236 [09:24<07:24,  4.40s/it]
test ppl:  58%|█████▊    | 136/236 [09:27<06:30,  3.90s/it]
test ppl:  58%|█████▊    | 137/236 [09:33<07:27,  4.52s/it]
test ppl:  58%|█████▊    | 138/236 [09:38<08:03,  4.94s/it]
test ppl:  59%|█████▉    | 139/236 [09:43<07:44,  4.79s/it]
test ppl:  59%|█████▉    | 140/236 [09:45<06:20,  3.96s/it]
test ppl:  60%|█████▉    | 141/236 [09:48<06:02,  3.82s/it]
test ppl:  60%|██████    | 142/236 [09:51<05:11,  3.32s/it]
test ppl:  61%|██████    | 143/236 [09:57<06:20,  4.10s/it]
test ppl:  61%|██████    | 144/236 [10:00<05:50,  3.81s/it]
test ppl:  61%|██████▏   | 145/236 [10:06<06:43,  4.44s/it]
test ppl:  62%|██████▏   | 146/236 [10:11<07:19,  4.88s/it]
test ppl:  62%|██████▏   | 147/236 [10:17<07:42,  5.20s/it]
test ppl:  63%|██████▎   | 148/236 [10:23<07:59,  5.45s/it]
test ppl:  63%|██████▎   | 149/236 [10:26<06:49,  4.71s/it]
test ppl:  64%|██████▎   | 150/236 [10:32<06:55,  4.83s/it]
test ppl:  64%|██████▍   | 151/236 [10:37<07:17,  5.15s/it]
test ppl:  64%|██████▍   | 152/236 [10:43<07:31,  5.38s/it]
test ppl:  65%|██████▍   | 153/236 [10:46<06:27,  4.67s/it]
test ppl:  65%|██████▌   | 154/236 [10:48<05:04,  3.72s/it]
test ppl:  66%|██████▌   | 155/236 [10:52<05:20,  3.96s/it]
test ppl:  66%|██████▌   | 156/236 [10:56<05:06,  3.83s/it]
test ppl:  67%|██████▋   | 157/236 [10:58<04:24,  3.34s/it]
test ppl:  67%|██████▋   | 158/236 [11:04<05:21,  4.12s/it]
test ppl:  67%|██████▋   | 159/236 [11:06<04:19,  3.37s/it]
test ppl:  68%|██████▊   | 160/236 [11:07<03:28,  2.74s/it]
test ppl:  68%|██████▊   | 161/236 [11:08<02:48,  2.24s/it]
test ppl:  69%|██████▊   | 162/236 [11:11<03:06,  2.51s/it]
test ppl:  69%|██████▉   | 163/236 [11:13<02:43,  2.24s/it]
test ppl:  69%|██████▉   | 164/236 [11:16<03:00,  2.51s/it]
test ppl:  70%|██████▉   | 165/236 [11:22<04:07,  3.48s/it]
test ppl:  70%|███████   | 166/236 [11:23<03:19,  2.85s/it]
test ppl:  71%|███████   | 167/236 [11:25<02:56,  2.56s/it]
test ppl:  71%|███████   | 168/236 [11:27<02:42,  2.38s/it]
test ppl:  72%|███████▏  | 169/236 [11:33<03:51,  3.46s/it]
test ppl:  72%|███████▏  | 170/236 [11:39<04:38,  4.22s/it]
test ppl:  72%|███████▏  | 171/236 [11:40<03:43,  3.43s/it]
test ppl:  73%|███████▎  | 172/236 [11:43<03:18,  3.10s/it]
test ppl:  73%|███████▎  | 173/236 [11:46<03:23,  3.23s/it]
test ppl:  74%|███████▎  | 174/236 [11:50<03:27,  3.35s/it]
test ppl:  74%|███████▍  | 175/236 [11:51<02:49,  2.78s/it]
test ppl:  75%|███████▍  | 176/236 [11:57<03:42,  3.72s/it]
test ppl:  75%|███████▌  | 177/236 [12:03<04:19,  4.39s/it]
test ppl:  75%|███████▌  | 178/236 [12:09<04:42,  4.87s/it]
test ppl:  76%|███████▌  | 179/236 [12:15<04:56,  5.20s/it]
test ppl:  76%|███████▋  | 180/236 [12:19<04:24,  4.73s/it]
test ppl:  77%|███████▋  | 181/236 [12:24<04:24,  4.80s/it]
test ppl:  77%|███████▋  | 182/236 [12:26<03:32,  3.94s/it]
test ppl:  78%|███████▊  | 183/236 [12:28<02:56,  3.33s/it]
test ppl:  78%|███████▊  | 184/236 [12:30<02:40,  3.09s/it]
test ppl:  78%|███████▊  | 185/236 [12:36<03:22,  3.97s/it]
test ppl:  79%|███████▉  | 186/236 [12:38<02:48,  3.38s/it]
test ppl:  79%|███████▉  | 187/236 [12:40<02:20,  2.86s/it]
test ppl:  80%|███████▉  | 188/236 [12:46<03:01,  3.78s/it]
test ppl:  80%|████████  | 189/236 [12:52<03:28,  4.43s/it]
test ppl:  81%|████████  | 190/236 [12:58<03:44,  4.88s/it]
test ppl:  81%|████████  | 191/236 [13:02<03:32,  4.72s/it]
test ppl:  81%|████████▏ | 192/236 [13:05<03:00,  4.10s/it]
test ppl:  82%|████████▏ | 193/236 [13:11<03:20,  4.66s/it]
test ppl:  82%|████████▏ | 194/236 [13:13<02:50,  4.06s/it]
test ppl:  83%|████████▎ | 195/236 [13:16<02:27,  3.61s/it]
test ppl:  83%|████████▎ | 196/236 [13:18<02:05,  3.13s/it]
test ppl:  83%|████████▎ | 197/236 [13:21<02:04,  3.19s/it]
test ppl:  84%|████████▍ | 198/236 [13:27<02:32,  4.02s/it]
test ppl:  84%|████████▍ | 199/236 [13:30<02:20,  3.80s/it]
test ppl:  85%|████████▍ | 200/236 [13:36<02:40,  4.44s/it]
test ppl:  85%|████████▌ | 201/236 [13:39<02:16,  3.90s/it]
test ppl:  86%|████████▌ | 202/236 [13:43<02:17,  4.03s/it]
test ppl:  86%|████████▌ | 203/236 [13:49<02:32,  4.61s/it]
test ppl:  86%|████████▋ | 204/236 [13:51<02:00,  3.76s/it]
test ppl:  87%|████████▋ | 205/236 [13:57<02:17,  4.43s/it]
test ppl:  87%|████████▋ | 206/236 [14:00<02:03,  4.10s/it]
test ppl:  88%|████████▊ | 207/236 [14:06<02:16,  4.69s/it]
test ppl:  88%|████████▊ | 208/236 [14:12<02:21,  5.06s/it]
test ppl:  89%|████████▊ | 209/236 [14:18<02:24,  5.34s/it]
test ppl:  89%|████████▉ | 210/236 [14:21<01:55,  4.45s/it]
test ppl:  89%|████████▉ | 211/236 [14:25<01:45,  4.23s/it]
test ppl:  90%|████████▉ | 212/236 [14:30<01:53,  4.74s/it]
test ppl:  90%|█████████ | 213/236 [14:36<01:54,  4.98s/it]
test ppl:  91%|█████████ | 214/236 [14:37<01:26,  3.93s/it]
test ppl:  91%|█████████ | 215/236 [14:43<01:35,  4.53s/it]
test ppl:  92%|█████████▏| 216/236 [14:46<01:16,  3.84s/it]
test ppl:  92%|█████████▏| 217/236 [14:52<01:25,  4.49s/it]
test ppl:  92%|█████████▏| 218/236 [14:54<01:07,  3.76s/it]
test ppl:  93%|█████████▎| 219/236 [15:00<01:15,  4.41s/it]
test ppl:  93%|█████████▎| 220/236 [15:06<01:17,  4.87s/it]
test ppl:  94%|█████████▎| 221/236 [15:07<00:59,  3.94s/it]
test ppl:  94%|█████████▍| 222/236 [15:13<01:03,  4.54s/it]
test ppl:  94%|█████████▍| 223/236 [15:19<01:04,  4.96s/it]
test ppl:  95%|█████████▍| 224/236 [15:21<00:46,  3.90s/it]
test ppl:  95%|█████████▌| 225/236 [15:25<00:43,  3.95s/it]
test ppl:  96%|█████████▌| 226/236 [15:28<00:37,  3.75s/it]
test ppl:  96%|█████████▌| 227/236 [15:30<00:28,  3.18s/it]
test ppl:  97%|█████████▋| 228/236 [15:32<00:23,  2.93s/it]
test ppl:  97%|█████████▋| 229/236 [15:38<00:26,  3.82s/it]
test ppl:  97%|█████████▋| 230/236 [15:43<00:24,  4.07s/it]
test ppl:  98%|█████████▊| 231/236 [15:46<00:19,  3.84s/it]
test ppl:  98%|█████████▊| 232/236 [15:48<00:12,  3.14s/it]
test ppl:  99%|█████████▊| 233/236 [15:50<00:09,  3.06s/it]
test ppl:  99%|█████████▉| 234/236 [15:52<00:05,  2.51s/it]
test ppl: 100%|█████████▉| 235/236 [15:58<00:03,  3.54s/it]
test ppl: 100%|██████████| 236/236 [15:59<00:00,  2.78s/it]
test ppl: 100%|██████████| 236/236 [15:59<00:00,  4.06s/it]
10/12/2024 11:45:13 - INFO - __main__ -    em: 0.1599
10/12/2024 11:45:13 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.6 20:  em: 0.1599

--------------------------------------------------------------------------------
Running experiment with knn_temp=20, lmbda=0.6, k=64
2024-10-12 11:45:20.213619: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 11:45:20.233141: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 11:45:20.254967: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 11:45:20.261599: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 11:45:20.277658: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 11:45:21.275824: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 11:45:22 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.6, knn_temp=20, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 11:45:22 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:50:57,  2.18it/s]
Adding feature api:   4%|▍         | 7339/187062 [00:00<00:10, 17419.26it/s]
Adding feature api:   8%|▊         | 15813/187062 [00:00<00:04, 34466.12it/s]
Adding feature api:  13%|█▎        | 24334/187062 [00:00<00:03, 47944.52it/s]
Adding feature api:  18%|█▊        | 32828/187062 [00:00<00:02, 58120.29it/s]
Adding feature api:  22%|██▏       | 41358/187062 [00:00<00:02, 65786.89it/s]
Adding feature api:  27%|██▋       | 49917/187062 [00:01<00:01, 71474.57it/s]
Adding feature api:  31%|███       | 58370/187062 [00:01<00:01, 75272.42it/s]
Adding feature api:  36%|███▌      | 66858/187062 [00:01<00:01, 78092.50it/s]
Adding feature api:  40%|████      | 75173/187062 [00:01<00:01, 79462.10it/s]
Adding feature api:  45%|████▍     | 83706/187062 [00:01<00:01, 81199.92it/s]
Adding feature api:  49%|████▉     | 92078/187062 [00:01<00:01, 81665.72it/s]
Adding feature api:  54%|█████▍    | 100666/187062 [00:01<00:01, 82919.16it/s]
Adding feature api:  58%|█████▊    | 109234/187062 [00:01<00:00, 83741.25it/s]
Adding feature api:  63%|██████▎   | 117731/187062 [00:01<00:00, 84105.36it/s]
Adding feature api:  67%|██████▋   | 126209/187062 [00:01<00:00, 84306.72it/s]
Adding feature api:  72%|███████▏  | 134783/187062 [00:02<00:00, 84734.90it/s]
Adding feature api:  77%|███████▋  | 143359/187062 [00:02<00:00, 85040.74it/s]
Adding feature api:  81%|████████  | 151893/187062 [00:02<00:00, 85124.92it/s]
Adding feature api:  86%|████████▌ | 160421/187062 [00:02<00:00, 85146.91it/s]
Adding feature api:  90%|█████████ | 168947/187062 [00:02<00:00, 84388.11it/s]
Adding feature api:  95%|█████████▍| 177450/187062 [00:02<00:00, 84577.90it/s]
Adding feature api:  99%|█████████▉| 185915/187062 [00:02<00:00, 54392.95it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64809.81it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:37:13,  2.20it/s]
Adding feature datatype:   4%|▍         | 7184/187062 [00:00<00:10, 17177.35it/s]
Adding feature datatype:   8%|▊         | 15421/187062 [00:00<00:05, 33775.52it/s]
Adding feature datatype:  13%|█▎        | 23697/187062 [00:00<00:03, 46839.39it/s]
Adding feature datatype:  17%|█▋        | 31751/187062 [00:00<00:02, 56135.37it/s]
Adding feature datatype:  21%|██▏       | 40108/187062 [00:00<00:02, 63889.69it/s]
Adding feature datatype:  26%|██▌       | 48393/187062 [00:01<00:01, 69342.86it/s]
Adding feature datatype:  30%|███       | 56677/187062 [00:01<00:01, 73273.50it/s]
Adding feature datatype:  35%|███▍      | 64987/187062 [00:01<00:01, 76158.36it/s]
Adding feature datatype:  39%|███▉      | 73193/187062 [00:01<00:01, 77900.65it/s]
Adding feature datatype:  44%|████▎     | 81550/187062 [00:01<00:01, 79583.35it/s]
Adding feature datatype:  48%|████▊     | 89841/187062 [00:01<00:01, 80572.93it/s]
Adding feature datatype:  52%|█████▏    | 98152/187062 [00:01<00:01, 81329.54it/s]
Adding feature datatype:  57%|█████▋    | 106517/187062 [00:01<00:00, 82021.83it/s]
Adding feature datatype:  61%|██████▏   | 114805/187062 [00:01<00:00, 81781.53it/s]
Adding feature datatype:  66%|██████▌   | 123151/187062 [00:01<00:00, 82279.80it/s]
Adding feature datatype:  70%|███████   | 131481/187062 [00:02<00:00, 82583.48it/s]
Adding feature datatype:  75%|███████▍  | 139803/187062 [00:02<00:00, 82772.95it/s]
Adding feature datatype:  79%|███████▉  | 148138/187062 [00:02<00:00, 82942.29it/s]
Adding feature datatype:  84%|████████▎ | 156447/187062 [00:02<00:00, 82197.80it/s]
Adding feature datatype:  88%|████████▊ | 164762/187062 [00:02<00:00, 82479.41it/s]
Adding feature datatype:  93%|█████████▎| 173120/187062 [00:02<00:00, 82805.29it/s]
Adding feature datatype:  97%|█████████▋| 181407/187062 [00:02<00:00, 65627.19it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63659.69it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:21:34,  2.22it/s]
Adding feature literal:   4%|▍         | 7237/187062 [00:00<00:10, 17450.55it/s]
Adding feature literal:   8%|▊         | 15502/187062 [00:00<00:05, 34155.39it/s]
Adding feature literal:  13%|█▎        | 23839/187062 [00:00<00:03, 47341.45it/s]
Adding feature literal:  17%|█▋        | 32168/187062 [00:00<00:02, 57291.08it/s]
Adding feature literal:  22%|██▏       | 40468/187062 [00:00<00:02, 64575.87it/s]
Adding feature literal:  26%|██▌       | 48812/187062 [00:01<00:01, 70009.62it/s]
Adding feature literal:  31%|███       | 57149/187062 [00:01<00:01, 73904.76it/s]
Adding feature literal:  35%|███▍      | 65252/187062 [00:01<00:01, 75997.48it/s]
Adding feature literal:  39%|███▉      | 73623/187062 [00:01<00:01, 78275.83it/s]
Adding feature literal:  44%|████▎     | 81792/187062 [00:01<00:01, 78956.37it/s]
Adding feature literal:  48%|████▊     | 90105/187062 [00:01<00:01, 80193.79it/s]
Adding feature literal:  53%|█████▎    | 98452/187062 [00:01<00:01, 81168.26it/s]
Adding feature literal:  57%|█████▋    | 106835/187062 [00:01<00:00, 81959.65it/s]
Adding feature literal:  62%|██████▏   | 115227/187062 [00:01<00:00, 82545.16it/s]
Adding feature literal:  66%|██████▌   | 123597/187062 [00:01<00:00, 82888.97it/s]
Adding feature literal:  71%|███████   | 131960/187062 [00:02<00:00, 83109.44it/s]
Adding feature literal:  75%|███████▌  | 140313/187062 [00:02<00:00, 83232.86it/s]
Adding feature literal:  79%|███████▉  | 148700/187062 [00:02<00:00, 83421.36it/s]
Adding feature literal:  84%|████████▍ | 157126/187062 [00:02<00:00, 83669.59it/s]
Adding feature literal:  88%|████████▊ | 165504/187062 [00:02<00:00, 83685.37it/s]
Adding feature literal:  93%|█████████▎| 173880/187062 [00:02<00:00, 82257.23it/s]
Adding feature literal:  97%|█████████▋| 182117/187062 [00:02<00:00, 62733.35it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 64111.77it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:15:58,  2.23it/s]
Adding feature operator:   4%|▍         | 7211/187062 [00:00<00:10, 17440.54it/s]
Adding feature operator:   8%|▊         | 15522/187062 [00:00<00:05, 34303.80it/s]
Adding feature operator:  13%|█▎        | 23850/187062 [00:00<00:03, 47448.20it/s]
Adding feature operator:  17%|█▋        | 31963/187062 [00:00<00:02, 56781.50it/s]
Adding feature operator:  21%|██▏       | 40061/187062 [00:00<00:02, 63643.69it/s]
Adding feature operator:  26%|██▌       | 48413/187062 [00:01<00:01, 69374.38it/s]
Adding feature operator:  30%|███       | 56766/187062 [00:01<00:01, 73501.59it/s]
Adding feature operator:  35%|███▍      | 65165/187062 [00:01<00:01, 76586.39it/s]
Adding feature operator:  39%|███▉      | 73558/187062 [00:01<00:01, 78758.25it/s]
Adding feature operator:  44%|████▍     | 81966/187062 [00:01<00:01, 80338.73it/s]
Adding feature operator:  48%|████▊     | 90346/187062 [00:01<00:01, 81369.46it/s]
Adding feature operator:  53%|█████▎    | 98792/187062 [00:01<00:01, 82291.65it/s]
Adding feature operator:  57%|█████▋    | 107142/187062 [00:01<00:00, 82588.91it/s]
Adding feature operator:  62%|██████▏   | 115534/187062 [00:01<00:00, 82986.40it/s]
Adding feature operator:  66%|██████▌   | 123892/187062 [00:01<00:00, 82433.22it/s]
Adding feature operator:  71%|███████   | 132274/187062 [00:02<00:00, 82843.94it/s]
Adding feature operator:  75%|███████▌  | 140677/187062 [00:02<00:00, 83197.18it/s]
Adding feature operator:  80%|███████▉  | 149018/187062 [00:02<00:00, 82614.31it/s]
Adding feature operator:  84%|████████▍ | 157403/187062 [00:02<00:00, 82980.75it/s]
Adding feature operator:  89%|████████▊ | 165839/187062 [00:02<00:00, 83390.78it/s]
Adding feature operator:  93%|█████████▎| 174203/187062 [00:02<00:00, 83464.14it/s]
Adding feature operator:  98%|█████████▊| 182556/187062 [00:02<00:00, 61574.36it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 64263.41it/s]
[2024-10-12 11:46:06,047] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 11:46:07 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 11:46:07 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:16, 389.91 examples/s]
Map:   1%|▏         | 84/6548 [00:00<00:30, 211.10 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:23, 268.84 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:19, 320.92 examples/s]
Map:   3%|▎         | 220/6548 [00:00<00:18, 347.71 examples/s]
Map:   4%|▍         | 270/6548 [00:00<00:18, 339.41 examples/s]
Map:   5%|▍         | 325/6548 [00:01<00:20, 296.45 examples/s]
Map:   6%|▌         | 362/6548 [00:01<00:20, 303.86 examples/s]
Map:   6%|▋         | 414/6548 [00:01<00:17, 352.17 examples/s]
Map:   7%|▋         | 458/6548 [00:01<00:18, 325.70 examples/s]
Map:   8%|▊         | 506/6548 [00:01<00:18, 319.75 examples/s]
Map:   9%|▊         | 563/6548 [00:01<00:16, 367.35 examples/s]
Map:   9%|▉         | 606/6548 [00:01<00:15, 381.62 examples/s]
Map:  10%|█         | 660/6548 [00:02<00:17, 327.30 examples/s]
Map:  11%|█         | 706/6548 [00:02<00:16, 355.80 examples/s]
Map:  11%|█▏        | 749/6548 [00:02<00:15, 371.82 examples/s]
Map:  12%|█▏        | 802/6548 [00:02<00:14, 410.38 examples/s]
Map:  13%|█▎        | 863/6548 [00:02<00:14, 405.32 examples/s]
Map:  14%|█▍        | 908/6548 [00:02<00:14, 393.23 examples/s]
Map:  15%|█▍        | 970/6548 [00:02<00:14, 384.25 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:22, 246.13 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:20, 270.11 examples/s]
Map:  17%|█▋        | 1100/6548 [00:03<00:17, 303.33 examples/s]
Map:  18%|█▊        | 1150/6548 [00:03<00:15, 343.19 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 354.04 examples/s]
Map:  19%|█▉        | 1249/6548 [00:03<00:14, 360.93 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:14, 372.14 examples/s]
Map:  21%|██        | 1352/6548 [00:04<00:15, 326.39 examples/s]
Map:  21%|██        | 1388/6548 [00:04<00:17, 296.11 examples/s]
Map:  22%|██▏       | 1428/6548 [00:04<00:16, 312.82 examples/s]
Map:  22%|██▏       | 1463/6548 [00:04<00:19, 267.51 examples/s]
Map:  23%|██▎       | 1509/6548 [00:04<00:18, 272.01 examples/s]
Map:  24%|██▎       | 1542/6548 [00:04<00:18, 270.74 examples/s]
Map:  24%|██▍       | 1576/6548 [00:04<00:17, 278.97 examples/s]
Map:  25%|██▍       | 1609/6548 [00:05<00:17, 278.84 examples/s]
Map:  25%|██▌       | 1647/6548 [00:05<00:19, 256.37 examples/s]
Map:  26%|██▌       | 1676/6548 [00:05<00:18, 258.30 examples/s]
Map:  26%|██▌       | 1717/6548 [00:05<00:16, 291.62 examples/s]
Map:  27%|██▋       | 1766/6548 [00:05<00:14, 336.48 examples/s]
Map:  28%|██▊       | 1807/6548 [00:05<00:13, 348.45 examples/s]
Map:  28%|██▊       | 1849/6548 [00:05<00:12, 365.80 examples/s]
Map:  29%|██▉       | 1899/6548 [00:05<00:13, 347.45 examples/s]
Map:  30%|██▉       | 1954/6548 [00:06<00:13, 351.07 examples/s]
Map:  30%|███       | 1996/6548 [00:06<00:12, 362.95 examples/s]
Map:  31%|███▏      | 2049/6548 [00:06<00:19, 232.64 examples/s]
Map:  32%|███▏      | 2092/6548 [00:06<00:16, 262.94 examples/s]
Map:  32%|███▏      | 2128/6548 [00:06<00:17, 253.51 examples/s]
Map:  33%|███▎      | 2174/6548 [00:06<00:16, 265.12 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 275.37 examples/s]
Map:  34%|███▍      | 2251/6548 [00:07<00:16, 263.98 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:15, 274.44 examples/s]
Map:  36%|███▌      | 2332/6548 [00:07<00:13, 312.47 examples/s]
Map:  36%|███▋      | 2375/6548 [00:07<00:13, 301.57 examples/s]
Map:  37%|███▋      | 2418/6548 [00:07<00:12, 329.57 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:12, 323.10 examples/s]
Map:  38%|███▊      | 2496/6548 [00:07<00:12, 328.08 examples/s]
Map:  39%|███▊      | 2531/6548 [00:08<00:12, 328.04 examples/s]
Map:  39%|███▉      | 2579/6548 [00:08<00:10, 365.94 examples/s]
Map:  40%|████      | 2621/6548 [00:08<00:10, 376.45 examples/s]
Map:  41%|████      | 2676/6548 [00:08<00:10, 354.05 examples/s]
Map:  41%|████▏     | 2716/6548 [00:08<00:10, 351.99 examples/s]
Map:  42%|████▏     | 2761/6548 [00:08<00:10, 373.38 examples/s]
Map:  43%|████▎     | 2811/6548 [00:08<00:10, 346.89 examples/s]
Map:  44%|████▎     | 2857/6548 [00:09<00:12, 292.92 examples/s]
Map:  44%|████▍     | 2896/6548 [00:09<00:11, 310.06 examples/s]
Map:  45%|████▌     | 2950/6548 [00:09<00:11, 299.95 examples/s]
Map:  46%|████▌     | 2984/6548 [00:09<00:11, 306.29 examples/s]
Map:  46%|████▌     | 3025/6548 [00:09<00:20, 172.59 examples/s]
Map:  47%|████▋     | 3062/6548 [00:10<00:17, 199.21 examples/s]
Map:  47%|████▋     | 3097/6548 [00:10<00:15, 225.01 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 254.48 examples/s]
Map:  49%|████▊     | 3183/6548 [00:10<00:14, 235.65 examples/s]
Map:  49%|████▉     | 3218/6548 [00:10<00:14, 231.19 examples/s]
Map:  50%|████▉     | 3247/6548 [00:10<00:13, 240.73 examples/s]
Map:  50%|█████     | 3280/6548 [00:10<00:12, 256.72 examples/s]
Map:  51%|█████     | 3322/6548 [00:10<00:11, 289.14 examples/s]
Map:  51%|█████▏    | 3367/6548 [00:11<00:10, 289.56 examples/s]
Map:  52%|█████▏    | 3399/6548 [00:11<00:11, 263.31 examples/s]
Map:  52%|█████▏    | 3431/6548 [00:11<00:11, 273.97 examples/s]
Map:  53%|█████▎    | 3469/6548 [00:11<00:13, 233.86 examples/s]
Map:  54%|█████▎    | 3516/6548 [00:11<00:10, 277.72 examples/s]
Map:  54%|█████▍    | 3561/6548 [00:11<00:09, 315.08 examples/s]
Map:  55%|█████▌    | 3611/6548 [00:11<00:08, 354.86 examples/s]
Map:  56%|█████▌    | 3663/6548 [00:12<00:08, 349.28 examples/s]
Map:  57%|█████▋    | 3707/6548 [00:12<00:07, 365.35 examples/s]
Map:  57%|█████▋    | 3750/6548 [00:12<00:07, 379.77 examples/s]
Map:  58%|█████▊    | 3806/6548 [00:12<00:07, 375.87 examples/s]
Map:  59%|█████▉    | 3855/6548 [00:12<00:08, 303.82 examples/s]
Map:  60%|█████▉    | 3914/6548 [00:12<00:08, 307.74 examples/s]
Map:  60%|██████    | 3954/6548 [00:13<00:08, 295.39 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 228.94 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 280.22 examples/s]
Map:  63%|██████▎   | 4096/6548 [00:13<00:08, 304.40 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 316.72 examples/s]
Map:  64%|██████▍   | 4194/6548 [00:13<00:07, 321.21 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:07, 328.95 examples/s]
Map:  65%|██████▌   | 4282/6548 [00:14<00:06, 356.19 examples/s]
Map:  66%|██████▌   | 4325/6548 [00:14<00:06, 368.65 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:14<00:06, 357.19 examples/s]
Map:  67%|██████▋   | 4405/6548 [00:14<00:05, 360.21 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:05, 386.69 examples/s]
Map:  69%|██████▊   | 4495/6548 [00:14<00:06, 321.31 examples/s]
Map:  69%|██████▉   | 4539/6548 [00:14<00:06, 305.45 examples/s]
Map:  70%|██████▉   | 4580/6548 [00:14<00:05, 328.64 examples/s]
Map:  71%|███████   | 4618/6548 [00:15<00:05, 340.02 examples/s]
Map:  71%|███████▏  | 4666/6548 [00:15<00:05, 370.89 examples/s]
Map:  72%|███████▏  | 4714/6548 [00:15<00:05, 351.08 examples/s]
Map:  73%|███████▎  | 4751/6548 [00:15<00:05, 353.45 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 405.84 examples/s]
Map:  74%|███████▍  | 4853/6548 [00:15<00:04, 341.65 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 365.20 examples/s]
Map:  76%|███████▌  | 4959/6548 [00:15<00:03, 408.80 examples/s]
Map:  77%|███████▋  | 5013/6548 [00:16<00:06, 240.72 examples/s]
Map:  77%|███████▋  | 5059/6548 [00:16<00:05, 268.20 examples/s]
Map:  78%|███████▊  | 5107/6548 [00:16<00:05, 279.30 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 279.56 examples/s]
Map:  80%|███████▉  | 5206/6548 [00:16<00:04, 284.35 examples/s]
Map:  80%|████████  | 5242/6548 [00:17<00:04, 297.16 examples/s]
Map:  81%|████████  | 5286/6548 [00:17<00:03, 320.49 examples/s]
Map:  81%|████████▏ | 5323/6548 [00:17<00:03, 330.53 examples/s]
Map:  82%|████████▏ | 5360/6548 [00:17<00:03, 297.98 examples/s]
Map:  82%|████████▏ | 5392/6548 [00:17<00:03, 292.20 examples/s]
Map:  83%|████████▎ | 5425/6548 [00:17<00:03, 296.23 examples/s]
Map:  83%|████████▎ | 5461/6548 [00:17<00:03, 310.97 examples/s]
Map:  84%|████████▍ | 5496/6548 [00:17<00:03, 319.23 examples/s]
Map:  84%|████████▍ | 5529/6548 [00:17<00:03, 317.32 examples/s]
Map:  85%|████████▌ | 5569/6548 [00:18<00:02, 338.49 examples/s]
Map:  86%|████████▌ | 5610/6548 [00:18<00:03, 308.42 examples/s]
Map:  86%|████████▌ | 5647/6548 [00:18<00:02, 321.06 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 315.37 examples/s]
Map:  87%|████████▋ | 5720/6548 [00:18<00:02, 335.07 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 353.61 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 356.32 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:01, 360.95 examples/s]
Map:  90%|████████▉ | 5889/6548 [00:18<00:01, 368.39 examples/s]
Map:  91%|█████████ | 5927/6548 [00:19<00:01, 370.33 examples/s]
Map:  91%|█████████▏| 5987/6548 [00:19<00:01, 336.93 examples/s]
Map:  92%|█████████▏| 6024/6548 [00:19<00:02, 216.10 examples/s]
Map:  92%|█████████▏| 6052/6548 [00:19<00:02, 218.69 examples/s]
Map:  93%|█████████▎| 6086/6548 [00:19<00:01, 240.35 examples/s]
Map:  93%|█████████▎| 6117/6548 [00:19<00:01, 246.43 examples/s]
Map:  94%|█████████▍| 6154/6548 [00:20<00:01, 274.02 examples/s]
Map:  95%|█████████▍| 6190/6548 [00:20<00:01, 290.63 examples/s]
Map:  95%|█████████▌| 6234/6548 [00:20<00:00, 327.30 examples/s]
Map:  96%|█████████▌| 6271/6548 [00:20<00:00, 330.60 examples/s]
Map:  96%|█████████▋| 6310/6548 [00:20<00:00, 341.85 examples/s]
Map:  97%|█████████▋| 6365/6548 [00:20<00:00, 385.45 examples/s]
Map:  98%|█████████▊| 6420/6548 [00:20<00:00, 370.49 examples/s]
Map:  99%|█████████▉| 6469/6548 [00:20<00:00, 399.71 examples/s]
Map: 100%|█████████▉| 6527/6548 [00:21<00:00, 390.89 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 308.99 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   3%|▎         | 31/903 [00:00<00:03, 277.61 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 324.31 examples/s]
Map:  11%|█▏        | 103/903 [00:00<00:02, 324.79 examples/s]
Map:  16%|█▌        | 141/903 [00:00<00:02, 344.47 examples/s]
Map:  21%|██        | 190/903 [00:00<00:01, 387.79 examples/s]
Map:  25%|██▌       | 230/903 [00:00<00:01, 388.86 examples/s]
Map:  30%|██▉       | 269/903 [00:00<00:01, 388.16 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 382.27 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 318.59 examples/s]
Map:  45%|████▌     | 409/903 [00:01<00:01, 280.26 examples/s]
Map:  50%|████▉     | 451/903 [00:01<00:01, 278.39 examples/s]
Map:  54%|█████▍    | 486/903 [00:01<00:01, 281.58 examples/s]
Map:  59%|█████▉    | 531/903 [00:01<00:01, 316.35 examples/s]
Map:  63%|██████▎   | 570/903 [00:01<00:00, 333.14 examples/s]
Map:  68%|██████▊   | 614/903 [00:01<00:00, 355.22 examples/s]
Map:  72%|███████▏  | 652/903 [00:01<00:00, 361.33 examples/s]
Map:  77%|███████▋  | 696/903 [00:02<00:00, 374.64 examples/s]
Map:  82%|████████▏ | 742/903 [00:02<00:00, 396.10 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 390.23 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 389.35 examples/s]
Map:  96%|█████████▌| 867/903 [00:02<00:00, 392.81 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 313.48 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 35/1882 [00:00<00:07, 262.76 examples/s]
Map:   4%|▍         | 74/1882 [00:00<00:05, 324.53 examples/s]
Map:   6%|▋         | 120/1882 [00:00<00:05, 311.67 examples/s]
Map:   9%|▊         | 161/1882 [00:00<00:05, 342.53 examples/s]
Map:  11%|█         | 199/1882 [00:00<00:04, 351.51 examples/s]
Map:  14%|█▎        | 258/1882 [00:00<00:04, 365.93 examples/s]
Map:  16%|█▌        | 304/1882 [00:00<00:04, 338.86 examples/s]
Map:  19%|█▊        | 350/1882 [00:01<00:04, 354.50 examples/s]
Map:  21%|██        | 396/1882 [00:01<00:05, 294.97 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 299.84 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 331.01 examples/s]
Map:  29%|██▊       | 538/1882 [00:01<00:04, 308.77 examples/s]
Map:  31%|███       | 580/1882 [00:01<00:03, 332.36 examples/s]
Map:  34%|███▍      | 638/1882 [00:01<00:03, 389.66 examples/s]
Map:  37%|███▋      | 696/1882 [00:02<00:03, 383.78 examples/s]
Map:  40%|████      | 760/1882 [00:02<00:02, 391.94 examples/s]
Map:  43%|████▎     | 809/1882 [00:02<00:03, 353.99 examples/s]
Map:  45%|████▌     | 851/1882 [00:02<00:02, 368.18 examples/s]
Map:  48%|████▊     | 904/1882 [00:02<00:02, 359.93 examples/s]
Map:  50%|█████     | 947/1882 [00:02<00:02, 374.07 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 384.43 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 247.40 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 261.61 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 274.55 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 282.91 examples/s]
Map:  63%|██████▎   | 1177/1882 [00:03<00:02, 275.92 examples/s]
Map:  65%|██████▌   | 1226/1882 [00:03<00:02, 288.44 examples/s]
Map:  68%|██████▊   | 1278/1882 [00:03<00:01, 302.58 examples/s]
Map:  70%|███████   | 1322/1882 [00:04<00:01, 329.61 examples/s]
Map:  72%|███████▏  | 1360/1882 [00:04<00:01, 332.22 examples/s]
Map:  75%|███████▌  | 1413/1882 [00:04<00:01, 332.64 examples/s]
Map:  77%|███████▋  | 1457/1882 [00:04<00:01, 311.64 examples/s]
Map:  79%|███████▉  | 1493/1882 [00:04<00:01, 285.70 examples/s]
Map:  81%|████████  | 1524/1882 [00:04<00:01, 283.14 examples/s]
Map:  83%|████████▎ | 1558/1882 [00:04<00:01, 295.35 examples/s]
Map:  85%|████████▌ | 1607/1882 [00:04<00:00, 340.74 examples/s]
Map:  88%|████████▊ | 1662/1882 [00:05<00:00, 340.21 examples/s]
Map:  91%|█████████ | 1711/1882 [00:05<00:00, 329.92 examples/s]
Map:  93%|█████████▎| 1748/1882 [00:05<00:00, 275.25 examples/s]
Map:  94%|█████████▍| 1778/1882 [00:05<00:00, 277.63 examples/s]
Map:  97%|█████████▋| 1820/1882 [00:05<00:00, 306.69 examples/s]
Map:  99%|█████████▉| 1859/1882 [00:05<00:00, 324.59 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 310.80 examples/s]
10/12/2024 11:47:09 - INFO - __main__ -     ***** Testing *****
10/12/2024 11:47:09 - INFO - __main__ -     Batch size = 8
10/12/2024 11:47:09 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 11:47:10 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 11:47:10 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 11:47:11 - INFO - knnlm -   Reading datastore took 0.9526550769805908 s
10/12/2024 11:47:11 - INFO - knnlm -   Moving index to GPU took 0.9125163555145264 s
10/12/2024 11:47:11 - INFO - __main__ -   ******************************break-into
10/12/2024 11:47:11 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 11:47:11 - INFO - __main__ -     Num examples = 236
10/12/2024 11:47:11 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<31:05,  7.94s/it]
test ppl:   1%|          | 2/236 [00:09<16:50,  4.32s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:46,  3.03s/it]
test ppl:   2%|▏         | 4/236 [00:13<10:53,  2.82s/it]
test ppl:   2%|▏         | 5/236 [00:19<15:07,  3.93s/it]
test ppl:   3%|▎         | 6/236 [00:25<17:39,  4.61s/it]
test ppl:   3%|▎         | 7/236 [00:27<14:17,  3.74s/it]
test ppl:   3%|▎         | 8/236 [00:32<16:00,  4.21s/it]
test ppl:   4%|▍         | 9/236 [00:34<13:16,  3.51s/it]
test ppl:   4%|▍         | 10/236 [00:38<13:58,  3.71s/it]
test ppl:   5%|▍         | 11/236 [00:42<13:58,  3.73s/it]
test ppl:   5%|▌         | 12/236 [00:48<16:25,  4.40s/it]
test ppl:   6%|▌         | 13/236 [00:54<18:04,  4.86s/it]
test ppl:   6%|▌         | 14/236 [01:00<19:13,  5.19s/it]
test ppl:   6%|▋         | 15/236 [01:01<15:00,  4.07s/it]
test ppl:   7%|▋         | 16/236 [01:03<12:30,  3.41s/it]
test ppl:   7%|▋         | 17/236 [01:09<15:14,  4.18s/it]
test ppl:   8%|▊         | 18/236 [01:11<12:09,  3.35s/it]
test ppl:   8%|▊         | 19/236 [01:15<13:17,  3.68s/it]
test ppl:   8%|▊         | 20/236 [01:18<12:00,  3.34s/it]
test ppl:   9%|▉         | 21/236 [01:19<10:20,  2.89s/it]
test ppl:   9%|▉         | 22/236 [01:25<13:33,  3.80s/it]
test ppl:  10%|▉         | 23/236 [01:29<13:23,  3.77s/it]
test ppl:  10%|█         | 24/236 [01:32<12:07,  3.43s/it]
test ppl:  11%|█         | 25/236 [01:34<10:18,  2.93s/it]
test ppl:  11%|█         | 26/236 [01:39<13:10,  3.77s/it]
test ppl:  11%|█▏        | 27/236 [01:43<13:13,  3.80s/it]
test ppl:  12%|█▏        | 28/236 [01:45<10:48,  3.12s/it]
test ppl:  12%|█▏        | 29/236 [01:47<09:37,  2.79s/it]
test ppl:  13%|█▎        | 30/236 [01:48<08:16,  2.41s/it]
test ppl:  13%|█▎        | 31/236 [01:50<07:49,  2.29s/it]
test ppl:  14%|█▎        | 32/236 [01:56<11:30,  3.38s/it]
test ppl:  14%|█▍        | 33/236 [02:02<14:03,  4.16s/it]
test ppl:  14%|█▍        | 34/236 [02:06<13:52,  4.12s/it]
test ppl:  15%|█▍        | 35/236 [02:09<12:13,  3.65s/it]
test ppl:  15%|█▌        | 36/236 [02:15<14:26,  4.33s/it]
test ppl:  16%|█▌        | 37/236 [02:21<15:58,  4.82s/it]
test ppl:  16%|█▌        | 38/236 [02:24<14:50,  4.50s/it]
test ppl:  17%|█▋        | 39/236 [02:26<12:00,  3.66s/it]
test ppl:  17%|█▋        | 40/236 [02:27<09:39,  2.96s/it]
test ppl:  17%|█▋        | 41/236 [02:29<08:32,  2.63s/it]
test ppl:  18%|█▊        | 42/236 [02:35<11:45,  3.64s/it]
test ppl:  18%|█▊        | 43/236 [02:41<13:54,  4.32s/it]
test ppl:  19%|█▊        | 44/236 [02:44<12:14,  3.82s/it]
test ppl:  19%|█▉        | 45/236 [02:46<10:15,  3.22s/it]
test ppl:  19%|█▉        | 46/236 [02:52<12:48,  4.04s/it]
test ppl:  20%|█▉        | 47/236 [02:53<10:22,  3.29s/it]
test ppl:  20%|██        | 48/236 [02:59<12:46,  4.08s/it]
test ppl:  21%|██        | 49/236 [03:02<11:26,  3.67s/it]
test ppl:  21%|██        | 50/236 [03:08<13:32,  4.37s/it]
test ppl:  22%|██▏       | 51/236 [03:14<14:56,  4.84s/it]
test ppl:  22%|██▏       | 52/236 [03:20<15:50,  5.17s/it]
test ppl:  22%|██▏       | 53/236 [03:26<16:28,  5.40s/it]
test ppl:  23%|██▎       | 54/236 [03:31<16:51,  5.56s/it]
test ppl:  23%|██▎       | 55/236 [03:37<16:27,  5.45s/it]
test ppl:  24%|██▎       | 56/236 [03:43<16:50,  5.62s/it]
test ppl:  24%|██▍       | 57/236 [03:49<17:02,  5.71s/it]
test ppl:  25%|██▍       | 58/236 [03:51<13:42,  4.62s/it]
test ppl:  25%|██▌       | 59/236 [03:57<14:47,  5.01s/it]
test ppl:  25%|██▌       | 60/236 [04:03<15:29,  5.28s/it]
test ppl:  26%|██▌       | 61/236 [04:05<12:57,  4.44s/it]
test ppl:  26%|██▋       | 62/236 [04:09<12:34,  4.33s/it]
test ppl:  27%|██▋       | 63/236 [04:12<10:53,  3.78s/it]
test ppl:  27%|██▋       | 64/236 [04:14<09:24,  3.28s/it]
test ppl:  28%|██▊       | 65/236 [04:15<07:41,  2.70s/it]
test ppl:  28%|██▊       | 66/236 [04:19<08:25,  2.98s/it]
test ppl:  28%|██▊       | 67/236 [04:25<10:52,  3.86s/it]
test ppl:  29%|██▉       | 68/236 [04:31<12:33,  4.49s/it]
test ppl:  29%|██▉       | 69/236 [04:36<13:41,  4.92s/it]
test ppl:  30%|██▉       | 70/236 [04:38<10:45,  3.89s/it]
test ppl:  30%|███       | 71/236 [04:41<10:07,  3.68s/it]
test ppl:  31%|███       | 72/236 [04:44<09:10,  3.35s/it]
test ppl:  31%|███       | 73/236 [04:48<09:32,  3.51s/it]
test ppl:  31%|███▏      | 74/236 [04:54<11:25,  4.23s/it]
test ppl:  32%|███▏      | 75/236 [04:59<12:42,  4.74s/it]
test ppl:  32%|███▏      | 76/236 [05:05<13:35,  5.10s/it]
test ppl:  33%|███▎      | 77/236 [05:09<12:22,  4.67s/it]
test ppl:  33%|███▎      | 78/236 [05:11<10:25,  3.96s/it]
test ppl:  33%|███▎      | 79/236 [05:15<10:17,  3.93s/it]
test ppl:  34%|███▍      | 80/236 [05:21<11:45,  4.52s/it]
test ppl:  34%|███▍      | 81/236 [05:27<12:46,  4.95s/it]
test ppl:  35%|███▍      | 82/236 [05:33<13:28,  5.25s/it]
test ppl:  35%|███▌      | 83/236 [05:39<13:55,  5.46s/it]
test ppl:  36%|███▌      | 84/236 [05:41<11:27,  4.52s/it]
test ppl:  36%|███▌      | 85/236 [05:46<11:13,  4.46s/it]
test ppl:  36%|███▋      | 86/236 [05:48<09:27,  3.78s/it]
test ppl:  37%|███▋      | 87/236 [05:51<08:35,  3.46s/it]
test ppl:  37%|███▋      | 88/236 [05:56<10:22,  4.20s/it]
test ppl:  38%|███▊      | 89/236 [05:59<08:55,  3.65s/it]
test ppl:  38%|███▊      | 90/236 [06:06<11:22,  4.67s/it]
test ppl:  39%|███▊      | 91/236 [06:13<12:53,  5.33s/it]
test ppl:  39%|███▉      | 92/236 [06:16<11:23,  4.75s/it]
test ppl:  39%|███▉      | 93/236 [06:23<12:57,  5.44s/it]
test ppl:  40%|███▉      | 94/236 [06:30<14:01,  5.93s/it]
test ppl:  40%|████      | 95/236 [06:33<11:38,  4.96s/it]
test ppl:  41%|████      | 96/236 [06:37<11:09,  4.78s/it]
test ppl:  41%|████      | 97/236 [06:44<12:39,  5.46s/it]
test ppl:  42%|████▏     | 98/236 [06:51<13:40,  5.95s/it]
test ppl:  42%|████▏     | 99/236 [06:59<14:21,  6.29s/it]
test ppl:  42%|████▏     | 100/236 [07:00<10:47,  4.76s/it]
test ppl:  43%|████▎     | 101/236 [07:07<12:16,  5.46s/it]
test ppl:  43%|████▎     | 102/236 [07:12<11:55,  5.34s/it]
test ppl:  44%|████▎     | 103/236 [07:15<10:36,  4.78s/it]
test ppl:  44%|████▍     | 104/236 [07:22<11:57,  5.43s/it]
test ppl:  44%|████▍     | 105/236 [07:28<12:13,  5.60s/it]
test ppl:  45%|████▍     | 106/236 [07:35<12:43,  5.88s/it]
test ppl:  45%|████▌     | 107/236 [07:37<10:24,  4.84s/it]
test ppl:  46%|████▌     | 108/236 [07:44<11:39,  5.46s/it]
test ppl:  46%|████▌     | 109/236 [07:51<12:36,  5.96s/it]
test ppl:  47%|████▋     | 110/236 [07:53<09:57,  4.74s/it]
test ppl:  47%|████▋     | 111/236 [08:00<11:19,  5.44s/it]
test ppl:  47%|████▋     | 112/236 [08:07<12:14,  5.93s/it]
test ppl:  48%|████▊     | 113/236 [08:09<09:48,  4.78s/it]
test ppl:  48%|████▊     | 114/236 [08:14<09:26,  4.64s/it]
test ppl:  49%|████▊     | 115/236 [08:21<10:49,  5.37s/it]
test ppl:  49%|████▉     | 116/236 [08:28<11:45,  5.88s/it]
test ppl:  50%|████▉     | 117/236 [08:30<09:29,  4.79s/it]
test ppl:  50%|█████     | 118/236 [08:37<10:45,  5.47s/it]
test ppl:  50%|█████     | 119/236 [08:40<09:12,  4.72s/it]
test ppl:  51%|█████     | 120/236 [08:42<07:26,  3.85s/it]
test ppl:  51%|█████▏    | 121/236 [08:49<09:12,  4.81s/it]
test ppl:  52%|█████▏    | 122/236 [08:56<10:24,  5.48s/it]
test ppl:  52%|█████▏    | 123/236 [09:03<11:12,  5.95s/it]
test ppl:  53%|█████▎    | 124/236 [09:08<10:27,  5.60s/it]
test ppl:  53%|█████▎    | 125/236 [09:11<08:59,  4.86s/it]
test ppl:  53%|█████▎    | 126/236 [09:18<10:07,  5.52s/it]
test ppl:  54%|█████▍    | 127/236 [09:20<08:15,  4.55s/it]
test ppl:  54%|█████▍    | 128/236 [09:23<06:56,  3.86s/it]
test ppl:  55%|█████▍    | 129/236 [09:26<06:28,  3.63s/it]
test ppl:  55%|█████▌    | 130/236 [09:29<06:26,  3.65s/it]
test ppl:  56%|█████▌    | 131/236 [09:36<08:09,  4.66s/it]
test ppl:  56%|█████▌    | 132/236 [09:41<07:59,  4.61s/it]
test ppl:  56%|█████▋    | 133/236 [09:46<07:54,  4.61s/it]
test ppl:  57%|█████▋    | 134/236 [09:50<07:34,  4.45s/it]
test ppl:  57%|█████▋    | 135/236 [09:57<08:49,  5.24s/it]
test ppl:  58%|█████▊    | 136/236 [10:00<07:39,  4.60s/it]
test ppl:  58%|█████▊    | 137/236 [10:07<08:49,  5.34s/it]
test ppl:  58%|█████▊    | 138/236 [10:14<09:33,  5.86s/it]
test ppl:  59%|█████▉    | 139/236 [10:21<10:02,  6.21s/it]
test ppl:  59%|█████▉    | 140/236 [10:23<07:56,  4.96s/it]
test ppl:  60%|█████▉    | 141/236 [10:27<07:27,  4.71s/it]
test ppl:  60%|██████    | 142/236 [10:30<06:22,  4.07s/it]
test ppl:  61%|██████    | 143/236 [10:37<07:41,  4.96s/it]
test ppl:  61%|██████    | 144/236 [10:41<07:06,  4.64s/it]
test ppl:  61%|██████▏   | 145/236 [10:48<08:07,  5.36s/it]
test ppl:  62%|██████▏   | 146/236 [10:55<08:47,  5.86s/it]
test ppl:  62%|██████▏   | 147/236 [11:02<09:13,  6.22s/it]
test ppl:  63%|██████▎   | 148/236 [11:09<09:32,  6.50s/it]
test ppl:  63%|██████▎   | 149/236 [11:12<08:08,  5.61s/it]
test ppl:  64%|██████▎   | 150/236 [11:20<08:39,  6.04s/it]
test ppl:  64%|██████▍   | 151/236 [11:27<08:58,  6.34s/it]
test ppl:  64%|██████▍   | 152/236 [11:34<09:09,  6.54s/it]
test ppl:  65%|██████▍   | 153/236 [11:41<09:15,  6.69s/it]
test ppl:  65%|██████▌   | 154/236 [11:42<07:06,  5.20s/it]
test ppl:  66%|██████▌   | 155/236 [11:48<07:05,  5.26s/it]
test ppl:  66%|██████▌   | 156/236 [11:52<06:34,  4.93s/it]
test ppl:  67%|██████▋   | 157/236 [11:54<05:34,  4.23s/it]
test ppl:  67%|██████▋   | 158/236 [12:02<06:35,  5.07s/it]
test ppl:  67%|██████▋   | 159/236 [12:09<07:15,  5.66s/it]
test ppl:  68%|██████▊   | 160/236 [12:10<05:36,  4.42s/it]
test ppl:  68%|██████▊   | 161/236 [12:11<04:21,  3.49s/it]
test ppl:  69%|██████▊   | 162/236 [12:15<04:23,  3.56s/it]
test ppl:  69%|██████▉   | 163/236 [12:17<03:43,  3.06s/it]
test ppl:  69%|██████▉   | 164/236 [12:21<03:55,  3.27s/it]
test ppl:  70%|██████▉   | 165/236 [12:28<05:12,  4.40s/it]
test ppl:  70%|███████   | 166/236 [12:30<04:12,  3.60s/it]
test ppl:  71%|███████   | 167/236 [12:32<03:44,  3.26s/it]
test ppl:  71%|███████   | 168/236 [12:34<03:22,  2.99s/it]
test ppl:  72%|███████▏  | 169/236 [12:37<03:08,  2.82s/it]
test ppl:  72%|███████▏  | 170/236 [12:44<04:30,  4.11s/it]
test ppl:  72%|███████▏  | 171/236 [12:46<03:43,  3.44s/it]
test ppl:  73%|███████▎  | 172/236 [12:49<03:26,  3.23s/it]
test ppl:  73%|███████▎  | 173/236 [12:53<03:43,  3.54s/it]
test ppl:  74%|███████▎  | 174/236 [12:58<04:10,  4.04s/it]
test ppl:  74%|███████▍  | 175/236 [13:00<03:27,  3.40s/it]
test ppl:  75%|███████▍  | 176/236 [13:07<04:29,  4.49s/it]
test ppl:  75%|███████▌  | 177/236 [13:14<05:10,  5.26s/it]
test ppl:  75%|███████▌  | 178/236 [13:21<05:37,  5.81s/it]
test ppl:  76%|███████▌  | 179/236 [13:28<05:53,  6.20s/it]
test ppl:  76%|███████▋  | 180/236 [13:32<05:14,  5.62s/it]
test ppl:  77%|███████▋  | 181/236 [13:40<05:32,  6.05s/it]
test ppl:  77%|███████▋  | 182/236 [13:42<04:25,  4.92s/it]
test ppl:  78%|███████▊  | 183/236 [13:44<03:38,  4.13s/it]
test ppl:  78%|███████▊  | 184/236 [13:47<03:17,  3.80s/it]
test ppl:  78%|███████▊  | 185/236 [13:54<04:04,  4.80s/it]
test ppl:  79%|███████▉  | 186/236 [13:57<03:23,  4.07s/it]
test ppl:  79%|███████▉  | 187/236 [13:59<02:48,  3.43s/it]
test ppl:  80%|███████▉  | 188/236 [14:06<03:37,  4.52s/it]
test ppl:  80%|████████  | 189/236 [14:13<04:08,  5.28s/it]
test ppl:  81%|████████  | 190/236 [14:18<04:00,  5.22s/it]
test ppl:  81%|████████  | 191/236 [14:23<03:54,  5.20s/it]
test ppl:  81%|████████▏ | 192/236 [14:26<03:21,  4.59s/it]
test ppl:  82%|████████▏ | 193/236 [14:33<03:49,  5.33s/it]
test ppl:  82%|████████▏ | 194/236 [14:36<03:16,  4.67s/it]
test ppl:  83%|████████▎ | 195/236 [14:39<02:51,  4.19s/it]
test ppl:  83%|████████▎ | 196/236 [14:42<02:26,  3.66s/it]
test ppl:  83%|████████▎ | 197/236 [14:44<02:11,  3.37s/it]
test ppl:  84%|████████▍ | 198/236 [14:51<02:50,  4.48s/it]
test ppl:  84%|████████▍ | 199/236 [14:55<02:39,  4.31s/it]
test ppl:  85%|████████▍ | 200/236 [15:02<03:04,  5.12s/it]
test ppl:  85%|████████▌ | 201/236 [15:06<02:38,  4.52s/it]
test ppl:  86%|████████▌ | 202/236 [15:13<02:59,  5.28s/it]
test ppl:  86%|████████▌ | 203/236 [15:18<02:58,  5.40s/it]
test ppl:  86%|████████▋ | 204/236 [15:20<02:20,  4.41s/it]
test ppl:  87%|████████▋ | 205/236 [15:27<02:41,  5.22s/it]
test ppl:  87%|████████▋ | 206/236 [15:31<02:25,  4.84s/it]
test ppl:  88%|████████▊ | 207/236 [15:38<02:39,  5.50s/it]
test ppl:  88%|████████▊ | 208/236 [15:46<02:47,  5.97s/it]
test ppl:  89%|████████▊ | 209/236 [15:53<02:50,  6.32s/it]
test ppl:  89%|████████▉ | 210/236 [15:55<02:16,  5.27s/it]
test ppl:  89%|████████▉ | 211/236 [16:00<02:07,  5.10s/it]
test ppl:  90%|████████▉ | 212/236 [16:07<02:16,  5.68s/it]
test ppl:  90%|█████████ | 213/236 [16:14<02:19,  6.08s/it]
test ppl:  91%|█████████ | 214/236 [16:16<01:44,  4.74s/it]
test ppl:  91%|█████████ | 215/236 [16:23<01:54,  5.43s/it]
test ppl:  92%|█████████▏| 216/236 [16:26<01:31,  4.59s/it]
test ppl:  92%|█████████▏| 217/236 [16:33<01:41,  5.36s/it]
test ppl:  92%|█████████▏| 218/236 [16:40<01:45,  5.87s/it]
test ppl:  93%|█████████▎| 219/236 [16:47<01:45,  6.23s/it]
test ppl:  93%|█████████▎| 220/236 [16:54<01:43,  6.48s/it]
test ppl:  94%|█████████▎| 221/236 [16:56<01:17,  5.16s/it]
test ppl:  94%|█████████▍| 222/236 [17:03<01:20,  5.74s/it]
test ppl:  94%|█████████▍| 223/236 [17:10<01:19,  6.13s/it]
test ppl:  95%|█████████▍| 224/236 [17:12<00:57,  4.81s/it]
test ppl:  95%|█████████▌| 225/236 [17:17<00:53,  4.87s/it]
test ppl:  96%|█████████▌| 226/236 [17:21<00:46,  4.66s/it]
test ppl:  96%|█████████▌| 227/236 [17:23<00:35,  3.94s/it]
test ppl:  97%|█████████▋| 228/236 [17:30<00:38,  4.87s/it]
test ppl:  97%|█████████▋| 229/236 [17:37<00:38,  5.52s/it]
test ppl:  97%|█████████▋| 230/236 [17:43<00:33,  5.53s/it]
test ppl:  98%|█████████▊| 231/236 [17:47<00:25,  5.05s/it]
test ppl:  98%|█████████▊| 232/236 [17:49<00:16,  4.07s/it]
test ppl:  99%|█████████▊| 233/236 [17:52<00:11,  3.87s/it]
test ppl:  99%|█████████▉| 234/236 [17:53<00:06,  3.15s/it]
test ppl: 100%|█████████▉| 235/236 [18:01<00:04,  4.32s/it]
test ppl: 100%|██████████| 236/236 [18:02<00:00,  3.37s/it]
test ppl: 100%|██████████| 236/236 [18:02<00:00,  4.59s/it]
10/12/2024 12:05:14 - INFO - __main__ -    em: 0.1658
10/12/2024 12:05:14 - INFO - __main__ -   Finish and take 19m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.6 20:  em: 0.1658

--------------------------------------------------------------------------------
Running experiment with knn_temp=40, lmbda=0.2, k=16
2024-10-12 12:05:21.285037: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 12:05:21.304476: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 12:05:21.326432: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 12:05:21.333072: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 12:05:21.349084: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 12:05:22.335071: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 12:05:23 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.2, knn_temp=40, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 12:05:23 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:47:13,  2.18it/s]
Adding feature api:   4%|▍         | 7151/187062 [00:00<00:10, 17007.10it/s]
Adding feature api:   8%|▊         | 15441/187062 [00:00<00:05, 33716.58it/s]
Adding feature api:  13%|█▎        | 23731/187062 [00:00<00:03, 46795.06it/s]
Adding feature api:  17%|█▋        | 32022/187062 [00:00<00:02, 56736.16it/s]
Adding feature api:  22%|██▏       | 40385/187062 [00:00<00:02, 64324.94it/s]
Adding feature api:  26%|██▌       | 48686/187062 [00:01<00:01, 69692.65it/s]
Adding feature api:  30%|███       | 56997/187062 [00:01<00:01, 73595.67it/s]
Adding feature api:  35%|███▍      | 65286/187062 [00:01<00:01, 76324.54it/s]
Adding feature api:  39%|███▉      | 73622/187062 [00:01<00:01, 78401.23it/s]
Adding feature api:  44%|████▍     | 81914/187062 [00:01<00:01, 79741.48it/s]
Adding feature api:  48%|████▊     | 90230/187062 [00:01<00:01, 80757.25it/s]
Adding feature api:  53%|█████▎    | 98535/187062 [00:01<00:01, 81438.69it/s]
Adding feature api:  57%|█████▋    | 106802/187062 [00:01<00:00, 81327.51it/s]
Adding feature api:  62%|██████▏   | 115152/187062 [00:01<00:00, 81972.37it/s]
Adding feature api:  66%|██████▌   | 123541/187062 [00:01<00:00, 82542.33it/s]
Adding feature api:  70%|███████   | 131854/187062 [00:02<00:00, 82715.01it/s]
Adding feature api:  75%|███████▍  | 140207/187062 [00:02<00:00, 82957.47it/s]
Adding feature api:  79%|███████▉  | 148531/187062 [00:02<00:00, 83041.17it/s]
Adding feature api:  84%|████████▍ | 156883/187062 [00:02<00:00, 83183.07it/s]
Adding feature api:  88%|████████▊ | 165273/187062 [00:02<00:00, 83396.62it/s]
Adding feature api:  93%|█████████▎| 173635/187062 [00:02<00:00, 83462.54it/s]
Adding feature api:  97%|█████████▋| 181987/187062 [00:02<00:00, 63230.84it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 63900.74it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:49:22,  2.18it/s]
Adding feature datatype:   4%|▍         | 7048/187062 [00:00<00:10, 16742.53it/s]
Adding feature datatype:   8%|▊         | 15045/187062 [00:00<00:05, 32761.83it/s]
Adding feature datatype:  12%|█▏        | 23148/187062 [00:00<00:03, 45589.13it/s]
Adding feature datatype:  17%|█▋        | 31270/187062 [00:00<00:02, 55392.52it/s]
Adding feature datatype:  21%|██        | 39392/187062 [00:00<00:02, 62678.41it/s]
Adding feature datatype:  25%|██▌       | 47555/187062 [00:01<00:02, 68120.14it/s]
Adding feature datatype:  30%|██▉       | 55623/187062 [00:01<00:01, 71766.43it/s]
Adding feature datatype:  34%|███▍      | 63691/187062 [00:01<00:01, 74382.59it/s]
Adding feature datatype:  38%|███▊      | 71751/187062 [00:01<00:01, 76216.21it/s]
Adding feature datatype:  43%|████▎     | 79817/187062 [00:01<00:01, 77532.22it/s]
Adding feature datatype:  47%|████▋     | 87818/187062 [00:01<00:01, 78267.58it/s]
Adding feature datatype:  51%|█████     | 95850/187062 [00:01<00:01, 78877.00it/s]
Adding feature datatype:  56%|█████▌    | 103987/187062 [00:01<00:01, 79619.59it/s]
Adding feature datatype:  60%|█████▉    | 112055/187062 [00:01<00:00, 79936.16it/s]
Adding feature datatype:  64%|██████▍   | 120169/187062 [00:01<00:00, 80295.92it/s]
Adding feature datatype:  69%|██████▊   | 128334/187062 [00:02<00:00, 80699.28it/s]
Adding feature datatype:  73%|███████▎  | 136470/187062 [00:02<00:00, 80894.56it/s]
Adding feature datatype:  77%|███████▋  | 144580/187062 [00:02<00:00, 80894.19it/s]
Adding feature datatype:  82%|████████▏ | 152684/187062 [00:02<00:00, 80805.40it/s]
Adding feature datatype:  86%|████████▌ | 160832/187062 [00:02<00:00, 81006.39it/s]
Adding feature datatype:  90%|█████████ | 168940/187062 [00:02<00:00, 81026.09it/s]
Adding feature datatype:  95%|█████████▍| 177048/187062 [00:02<00:00, 81011.65it/s]
Adding feature datatype:  99%|█████████▉| 185153/187062 [00:02<00:00, 53799.52it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 62620.67it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:54:08,  2.17it/s]
Adding feature literal:   4%|▎         | 6956/187062 [00:00<00:10, 16482.22it/s]
Adding feature literal:   8%|▊         | 14928/187062 [00:00<00:05, 32474.56it/s]
Adding feature literal:  12%|█▏        | 22949/187062 [00:00<00:03, 45142.61it/s]
Adding feature literal:  17%|█▋        | 31028/187062 [00:00<00:02, 54940.61it/s]
Adding feature literal:  21%|██        | 39101/187062 [00:00<00:02, 62211.54it/s]
Adding feature literal:  25%|██▌       | 47194/187062 [00:01<00:02, 67584.27it/s]
Adding feature literal:  30%|██▉       | 55258/187062 [00:01<00:01, 71380.01it/s]
Adding feature literal:  34%|███▍      | 63362/187062 [00:01<00:01, 74214.23it/s]
Adding feature literal:  38%|███▊      | 71265/187062 [00:01<00:01, 75491.38it/s]
Adding feature literal:  42%|████▏     | 79153/187062 [00:01<00:01, 76368.53it/s]
Adding feature literal:  47%|████▋     | 87027/187062 [00:01<00:01, 74770.42it/s]
Adding feature literal:  51%|█████     | 94676/187062 [00:01<00:01, 73742.75it/s]
Adding feature literal:  55%|█████▍    | 102172/187062 [00:01<00:01, 72918.18it/s]
Adding feature literal:  59%|█████▊    | 109548/187062 [00:01<00:01, 72410.40it/s]
Adding feature literal:  62%|██████▏   | 116848/187062 [00:01<00:00, 72037.95it/s]
Adding feature literal:  66%|██████▋   | 124092/187062 [00:02<00:00, 71856.45it/s]
Adding feature literal:  70%|███████   | 131306/187062 [00:02<00:00, 71646.60it/s]
Adding feature literal:  74%|███████▍  | 139269/187062 [00:02<00:00, 73994.39it/s]
Adding feature literal:  79%|███████▊  | 147302/187062 [00:02<00:00, 75869.30it/s]
Adding feature literal:  83%|████████▎ | 155417/187062 [00:02<00:00, 77438.14it/s]
Adding feature literal:  87%|████████▋ | 163517/187062 [00:02<00:00, 78496.61it/s]
Adding feature literal:  92%|█████████▏| 171376/187062 [00:02<00:00, 78502.11it/s]
Adding feature literal:  96%|█████████▌| 179233/187062 [00:02<00:00, 71674.83it/s]
Adding feature literal: 100%|█████████▉| 186519/187062 [00:03<00:00, 50923.57it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 60536.08it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:44:53,  2.19it/s]
Adding feature operator:   4%|▍         | 7019/187062 [00:00<00:10, 16713.62it/s]
Adding feature operator:   8%|▊         | 15019/187062 [00:00<00:05, 32777.50it/s]
Adding feature operator:  12%|█▏        | 23050/187062 [00:00<00:03, 45425.66it/s]
Adding feature operator:  17%|█▋        | 31135/187062 [00:00<00:02, 55181.14it/s]
Adding feature operator:  21%|██        | 39013/187062 [00:00<00:02, 61843.94it/s]
Adding feature operator:  25%|██▌       | 47094/187062 [00:01<00:02, 67293.55it/s]
Adding feature operator:  30%|██▉       | 55215/187062 [00:01<00:01, 71342.89it/s]
Adding feature operator:  34%|███▍      | 63271/187062 [00:01<00:01, 74047.70it/s]
Adding feature operator:  38%|███▊      | 71315/187062 [00:01<00:01, 75933.85it/s]
Adding feature operator:  42%|████▏     | 79393/187062 [00:01<00:01, 77371.55it/s]
Adding feature operator:  47%|████▋     | 87471/187062 [00:01<00:01, 78385.48it/s]
Adding feature operator:  51%|█████     | 95481/187062 [00:01<00:01, 78895.13it/s]
Adding feature operator:  55%|█████▌    | 103586/187062 [00:01<00:01, 79536.15it/s]
Adding feature operator:  60%|█████▉    | 111702/187062 [00:01<00:00, 80019.16it/s]
Adding feature operator:  64%|██████▍   | 119774/187062 [00:01<00:00, 80227.90it/s]
Adding feature operator:  68%|██████▊   | 127838/187062 [00:02<00:00, 80281.89it/s]
Adding feature operator:  73%|███████▎  | 135959/187062 [00:02<00:00, 80557.28it/s]
Adding feature operator:  77%|███████▋  | 144035/187062 [00:02<00:00, 79926.38it/s]
Adding feature operator:  81%|████████▏ | 152130/187062 [00:02<00:00, 80230.78it/s]
Adding feature operator:  86%|████████▌ | 160221/187062 [00:02<00:00, 80431.83it/s]
Adding feature operator:  90%|████████▉ | 168309/187062 [00:02<00:00, 80562.41it/s]
Adding feature operator:  94%|█████████▍| 176400/187062 [00:02<00:00, 80663.35it/s]
Adding feature operator:  99%|█████████▊| 184471/187062 [00:02<00:00, 55046.91it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 62464.51it/s]
[2024-10-12 12:06:07,332] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 12:06:08 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 12:06:08 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 41/6548 [00:00<00:16, 388.88 examples/s]
Map:   1%|▏         | 84/6548 [00:00<00:31, 203.43 examples/s]
Map:   2%|▏         | 121/6548 [00:00<00:26, 246.53 examples/s]
Map:   2%|▏         | 155/6548 [00:00<00:23, 271.58 examples/s]
Map:   3%|▎         | 198/6548 [00:00<00:20, 308.15 examples/s]
Map:   4%|▍         | 247/6548 [00:00<00:17, 355.45 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:17, 349.33 examples/s]
Map:   5%|▍         | 325/6548 [00:01<00:21, 296.22 examples/s]
Map:   6%|▌         | 364/6548 [00:01<00:19, 314.29 examples/s]
Map:   6%|▋         | 418/6548 [00:01<00:16, 370.68 examples/s]
Map:   7%|▋         | 471/6548 [00:01<00:17, 350.07 examples/s]
Map:   8%|▊         | 521/6548 [00:01<00:17, 343.08 examples/s]
Map:   9%|▊         | 570/6548 [00:01<00:15, 375.27 examples/s]
Map:   9%|▉         | 622/6548 [00:01<00:16, 351.67 examples/s]
Map:  10%|█         | 663/6548 [00:02<00:18, 325.52 examples/s]
Map:  11%|█         | 708/6548 [00:02<00:16, 352.09 examples/s]
Map:  11%|█▏        | 752/6548 [00:02<00:15, 370.86 examples/s]
Map:  12%|█▏        | 806/6548 [00:02<00:13, 411.05 examples/s]
Map:  13%|█▎        | 863/6548 [00:02<00:14, 394.93 examples/s]
Map:  14%|█▍        | 906/6548 [00:02<00:14, 390.85 examples/s]
Map:  15%|█▍        | 969/6548 [00:02<00:14, 390.93 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:23, 236.03 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 259.42 examples/s]
Map:  17%|█▋        | 1098/6548 [00:03<00:18, 290.39 examples/s]
Map:  17%|█▋        | 1143/6548 [00:03<00:16, 323.56 examples/s]
Map:  18%|█▊        | 1203/6548 [00:03<00:15, 345.61 examples/s]
Map:  19%|█▉        | 1262/6548 [00:03<00:15, 352.36 examples/s]
Map:  20%|█▉        | 1301/6548 [00:03<00:14, 359.56 examples/s]
Map:  21%|██        | 1352/6548 [00:04<00:15, 334.23 examples/s]
Map:  21%|██▏       | 1407/6548 [00:04<00:16, 304.17 examples/s]
Map:  22%|██▏       | 1461/6548 [00:04<00:17, 290.62 examples/s]
Map:  23%|██▎       | 1494/6548 [00:04<00:17, 295.77 examples/s]
Map:  23%|██▎       | 1530/6548 [00:04<00:16, 308.79 examples/s]
Map:  24%|██▍       | 1578/6548 [00:04<00:16, 308.15 examples/s]
Map:  25%|██▍       | 1610/6548 [00:05<00:16, 294.62 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:16, 292.61 examples/s]
Map:  26%|██▌       | 1687/6548 [00:05<00:17, 282.81 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:15, 306.56 examples/s]
Map:  27%|██▋       | 1770/6548 [00:05<00:14, 335.98 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:13, 343.86 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 351.52 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 338.72 examples/s]
Map:  30%|██▉       | 1947/6548 [00:05<00:13, 353.13 examples/s]
Map:  30%|███       | 1990/6548 [00:06<00:12, 369.65 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:20, 221.75 examples/s]
Map:  32%|███▏      | 2070/6548 [00:06<00:17, 251.83 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 265.16 examples/s]
Map:  33%|███▎      | 2141/6548 [00:06<00:17, 256.88 examples/s]
Map:  33%|███▎      | 2180/6548 [00:06<00:15, 278.28 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 282.95 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:14, 286.91 examples/s]
Map:  35%|███▌      | 2292/6548 [00:07<00:14, 294.56 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:13, 318.79 examples/s]
Map:  36%|███▋      | 2376/6548 [00:07<00:13, 317.37 examples/s]
Map:  37%|███▋      | 2412/6548 [00:07<00:12, 324.95 examples/s]
Map:  38%|███▊      | 2460/6548 [00:07<00:12, 317.01 examples/s]
Map:  38%|███▊      | 2496/6548 [00:07<00:12, 324.28 examples/s]
Map:  39%|███▊      | 2537/6548 [00:08<00:12, 334.02 examples/s]
Map:  40%|███▉      | 2591/6548 [00:08<00:10, 381.38 examples/s]
Map:  40%|████      | 2632/6548 [00:08<00:10, 384.88 examples/s]
Map:  41%|████      | 2672/6548 [00:08<00:11, 341.28 examples/s]
Map:  41%|████▏     | 2713/6548 [00:08<00:10, 356.33 examples/s]
Map:  42%|████▏     | 2771/6548 [00:08<00:10, 354.35 examples/s]
Map:  43%|████▎     | 2819/6548 [00:08<00:11, 337.69 examples/s]
Map:  44%|████▎     | 2860/6548 [00:09<00:12, 283.89 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 290.81 examples/s]
Map:  45%|████▌     | 2950/6548 [00:09<00:12, 295.13 examples/s]
Map:  46%|████▌     | 2981/6548 [00:09<00:12, 293.95 examples/s]
Map:  46%|████▌     | 3012/6548 [00:09<00:22, 154.83 examples/s]
Map:  46%|████▋     | 3044/6548 [00:10<00:19, 178.49 examples/s]
Map:  47%|████▋     | 3073/6548 [00:10<00:17, 193.50 examples/s]
Map:  48%|████▊     | 3112/6548 [00:10<00:15, 222.67 examples/s]
Map:  48%|████▊     | 3142/6548 [00:10<00:14, 234.73 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:13, 245.18 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 242.04 examples/s]
Map:  49%|████▉     | 3238/6548 [00:10<00:12, 264.65 examples/s]
Map:  50%|████▉     | 3272/6548 [00:10<00:11, 279.40 examples/s]
Map:  51%|█████     | 3318/6548 [00:10<00:11, 285.29 examples/s]
Map:  51%|█████     | 3351/6548 [00:11<00:10, 294.90 examples/s]
Map:  52%|█████▏    | 3389/6548 [00:11<00:11, 265.00 examples/s]
Map:  52%|█████▏    | 3422/6548 [00:11<00:11, 275.84 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 267.17 examples/s]
Map:  53%|█████▎    | 3486/6548 [00:11<00:11, 273.13 examples/s]
Map:  54%|█████▍    | 3533/6548 [00:11<00:09, 320.45 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:11<00:08, 347.93 examples/s]
Map:  55%|█████▌    | 3622/6548 [00:11<00:07, 373.34 examples/s]
Map:  56%|█████▌    | 3683/6548 [00:12<00:07, 382.54 examples/s]
Map:  57%|█████▋    | 3727/6548 [00:12<00:07, 396.45 examples/s]
Map:  58%|█████▊    | 3786/6548 [00:12<00:07, 390.90 examples/s]
Map:  59%|█████▊    | 3838/6548 [00:12<00:07, 354.32 examples/s]
Map:  59%|█████▉    | 3888/6548 [00:12<00:07, 345.95 examples/s]
Map:  60%|██████    | 3935/6548 [00:12<00:08, 316.52 examples/s]
Map:  61%|██████    | 3980/6548 [00:12<00:07, 343.09 examples/s]
Map:  62%|██████▏   | 4029/6548 [00:13<00:09, 254.96 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 296.11 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 319.62 examples/s]
Map:  64%|██████▎   | 4165/6548 [00:13<00:07, 302.51 examples/s]
Map:  64%|██████▍   | 4203/6548 [00:13<00:07, 311.62 examples/s]
Map:  65%|██████▍   | 4256/6548 [00:13<00:07, 322.86 examples/s]
Map:  66%|██████▌   | 4297/6548 [00:13<00:06, 339.77 examples/s]
Map:  66%|██████▋   | 4342/6548 [00:14<00:06, 363.41 examples/s]
Map:  67%|██████▋   | 4389/6548 [00:14<00:06, 342.23 examples/s]
Map:  68%|██████▊   | 4426/6548 [00:14<00:06, 347.23 examples/s]
Map:  68%|██████▊   | 4469/6548 [00:14<00:06, 321.90 examples/s]
Map:  69%|██████▉   | 4505/6548 [00:14<00:06, 293.21 examples/s]
Map:  69%|██████▉   | 4537/6548 [00:14<00:06, 295.94 examples/s]
Map:  70%|██████▉   | 4576/6548 [00:14<00:06, 317.95 examples/s]
Map:  71%|███████   | 4626/6548 [00:15<00:06, 317.89 examples/s]
Map:  71%|███████▏  | 4668/6548 [00:15<00:05, 331.48 examples/s]
Map:  72%|███████▏  | 4725/6548 [00:15<00:05, 345.40 examples/s]
Map:  73%|███████▎  | 4768/6548 [00:15<00:04, 361.59 examples/s]
Map:  74%|███████▎  | 4820/6548 [00:15<00:04, 400.30 examples/s]
Map:  75%|███████▍  | 4881/6548 [00:15<00:04, 373.42 examples/s]
Map:  75%|███████▌  | 4933/6548 [00:15<00:04, 389.38 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:03, 404.25 examples/s]
Map:  77%|███████▋  | 5038/6548 [00:16<00:06, 250.42 examples/s]
Map:  78%|███████▊  | 5081/6548 [00:16<00:05, 257.20 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 266.85 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 282.60 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 284.11 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:16<00:04, 298.80 examples/s]
Map:  80%|████████  | 5257/6548 [00:17<00:04, 304.19 examples/s]
Map:  81%|████████  | 5312/6548 [00:17<00:03, 367.55 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 314.31 examples/s]
Map:  83%|████████▎ | 5407/6548 [00:17<00:03, 297.15 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 327.50 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 323.65 examples/s]
Map:  85%|████████▍ | 5547/6548 [00:17<00:02, 347.20 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:18<00:03, 312.00 examples/s]
Map:  86%|████████▌ | 5639/6548 [00:18<00:02, 361.10 examples/s]
Map:  87%|████████▋ | 5680/6548 [00:18<00:02, 318.44 examples/s]
Map:  87%|████████▋ | 5716/6548 [00:18<00:02, 324.53 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 348.05 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 353.05 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:01, 357.25 examples/s]
Map:  90%|████████▉ | 5889/6548 [00:18<00:01, 364.16 examples/s]
Map:  91%|█████████ | 5927/6548 [00:18<00:01, 366.72 examples/s]
Map:  91%|█████████ | 5971/6548 [00:19<00:01, 338.34 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 240.06 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 271.02 examples/s]
Map:  94%|█████████▎| 6124/6548 [00:19<00:01, 270.03 examples/s]
Map:  94%|█████████▍| 6164/6548 [00:19<00:01, 285.25 examples/s]
Map:  95%|█████████▍| 6218/6548 [00:20<00:01, 299.90 examples/s]
Map:  96%|█████████▌| 6256/6548 [00:20<00:00, 313.66 examples/s]
Map:  96%|█████████▌| 6292/6548 [00:20<00:00, 321.79 examples/s]
Map:  97%|█████████▋| 6334/6548 [00:20<00:00, 330.26 examples/s]
Map:  97%|█████████▋| 6375/6548 [00:20<00:00, 349.43 examples/s]
Map:  98%|█████████▊| 6418/6548 [00:20<00:00, 363.60 examples/s]
Map:  99%|█████████▉| 6468/6548 [00:20<00:00, 399.16 examples/s]
Map: 100%|█████████▉| 6525/6548 [00:20<00:00, 388.99 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 311.65 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 320.30 examples/s]
Map:   8%|▊         | 73/903 [00:00<00:02, 345.65 examples/s]
Map:  13%|█▎        | 120/903 [00:00<00:02, 324.56 examples/s]
Map:  18%|█▊        | 166/903 [00:00<00:02, 364.62 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 385.13 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 389.07 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 381.72 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 325.70 examples/s]
Map:  44%|████▎     | 395/903 [00:01<00:01, 295.55 examples/s]
Map:  48%|████▊     | 436/903 [00:01<00:01, 299.41 examples/s]
Map:  53%|█████▎    | 475/903 [00:01<00:01, 314.59 examples/s]
Map:  56%|█████▋    | 509/903 [00:01<00:01, 320.26 examples/s]
Map:  62%|██████▏   | 558/903 [00:01<00:00, 356.39 examples/s]
Map:  67%|██████▋   | 607/903 [00:01<00:00, 390.84 examples/s]
Map:  73%|███████▎  | 663/903 [00:01<00:00, 377.29 examples/s]
Map:  80%|███████▉  | 718/903 [00:02<00:00, 370.99 examples/s]
Map:  85%|████████▍ | 766/903 [00:02<00:00, 390.69 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 381.47 examples/s]
Map:  96%|█████████▋| 870/903 [00:02<00:00, 392.04 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 324.81 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 35/1882 [00:00<00:06, 273.22 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 348.12 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 343.55 examples/s]
Map:   9%|▊         | 161/1882 [00:00<00:04, 366.28 examples/s]
Map:  11%|█         | 206/1882 [00:00<00:04, 335.69 examples/s]
Map:  14%|█▎        | 258/1882 [00:00<00:04, 382.33 examples/s]
Map:  16%|█▋        | 310/1882 [00:00<00:04, 362.89 examples/s]
Map:  19%|█▊        | 350/1882 [00:00<00:04, 366.65 examples/s]
Map:  21%|██        | 396/1882 [00:01<00:04, 304.11 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 305.33 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 336.59 examples/s]
Map:  29%|██▉       | 543/1882 [00:01<00:04, 325.21 examples/s]
Map:  31%|███       | 587/1882 [00:01<00:03, 349.28 examples/s]
Map:  34%|███▍      | 644/1882 [00:01<00:03, 399.36 examples/s]
Map:  37%|███▋      | 696/1882 [00:01<00:03, 377.69 examples/s]
Map:  40%|████      | 761/1882 [00:02<00:02, 391.87 examples/s]
Map:  43%|████▎     | 804/1882 [00:02<00:03, 341.98 examples/s]
Map:  45%|████▌     | 848/1882 [00:02<00:02, 357.38 examples/s]
Map:  48%|████▊     | 897/1882 [00:02<00:02, 341.71 examples/s]
Map:  50%|████▉     | 940/1882 [00:02<00:02, 360.59 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 376.77 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 248.63 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 263.36 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 276.21 examples/s]
Map:  61%|██████    | 1146/1882 [00:03<00:02, 268.85 examples/s]
Map:  63%|██████▎   | 1177/1882 [00:03<00:02, 263.74 examples/s]
Map:  65%|██████▌   | 1226/1882 [00:03<00:02, 279.61 examples/s]
Map:  67%|██████▋   | 1258/1882 [00:03<00:02, 286.27 examples/s]
Map:  69%|██████▉   | 1303/1882 [00:03<00:01, 325.16 examples/s]
Map:  72%|███████▏  | 1346/1882 [00:04<00:01, 340.08 examples/s]
Map:  74%|███████▍  | 1393/1882 [00:04<00:01, 322.48 examples/s]
Map:  76%|███████▌  | 1428/1882 [00:04<00:01, 285.66 examples/s]
Map:  78%|███████▊  | 1471/1882 [00:04<00:01, 311.00 examples/s]
Map:  80%|████████  | 1512/1882 [00:04<00:01, 266.33 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 275.11 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:04<00:00, 299.80 examples/s]
Map:  86%|████████▋ | 1626/1882 [00:05<00:00, 329.50 examples/s]
Map:  88%|████████▊ | 1662/1882 [00:05<00:00, 326.65 examples/s]
Map:  91%|█████████ | 1715/1882 [00:05<00:00, 334.35 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 282.91 examples/s]
Map:  95%|█████████▍| 1785/1882 [00:05<00:00, 284.24 examples/s]
Map:  97%|█████████▋| 1830/1882 [00:05<00:00, 321.42 examples/s]
Map: 100%|█████████▉| 1874/1882 [00:05<00:00, 350.82 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 309.80 examples/s]
10/12/2024 12:07:10 - INFO - __main__ -     ***** Testing *****
10/12/2024 12:07:10 - INFO - __main__ -     Batch size = 8
10/12/2024 12:07:10 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 12:07:11 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 12:07:11 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 12:07:12 - INFO - knnlm -   Reading datastore took 0.9893426895141602 s
10/12/2024 12:07:13 - INFO - knnlm -   Moving index to GPU took 1.0166339874267578 s
10/12/2024 12:07:13 - INFO - __main__ -   ******************************break-into
10/12/2024 12:07:13 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 12:07:13 - INFO - __main__ -     Num examples = 236
10/12/2024 12:07:13 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<31:31,  8.05s/it]
test ppl:   1%|          | 2/236 [00:10<17:32,  4.50s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:13,  3.15s/it]
test ppl:   2%|▏         | 4/236 [00:13<09:58,  2.58s/it]
test ppl:   2%|▏         | 5/236 [00:19<14:42,  3.82s/it]
test ppl:   3%|▎         | 6/236 [00:21<12:46,  3.33s/it]
test ppl:   3%|▎         | 7/236 [00:24<11:48,  3.09s/it]
test ppl:   3%|▎         | 8/236 [00:28<13:24,  3.53s/it]
test ppl:   4%|▍         | 9/236 [00:34<16:20,  4.32s/it]
test ppl:   4%|▍         | 10/236 [00:37<14:47,  3.93s/it]
test ppl:   5%|▍         | 11/236 [00:40<13:00,  3.47s/it]
test ppl:   5%|▌         | 12/236 [00:46<15:56,  4.27s/it]
test ppl:   6%|▌         | 13/236 [00:52<17:53,  4.81s/it]
test ppl:   6%|▌         | 14/236 [00:58<19:15,  5.21s/it]
test ppl:   6%|▋         | 15/236 [01:01<16:31,  4.49s/it]
test ppl:   7%|▋         | 16/236 [01:03<13:36,  3.71s/it]
test ppl:   7%|▋         | 17/236 [01:09<16:08,  4.42s/it]
test ppl:   8%|▊         | 18/236 [01:11<13:08,  3.62s/it]
test ppl:   8%|▊         | 19/236 [01:15<14:07,  3.91s/it]
test ppl:   8%|▊         | 20/236 [01:17<11:52,  3.30s/it]
test ppl:   9%|▉         | 21/236 [01:20<10:55,  3.05s/it]
test ppl:   9%|▉         | 22/236 [01:26<14:10,  3.97s/it]
test ppl:  10%|▉         | 23/236 [01:28<12:38,  3.56s/it]
test ppl:  10%|█         | 24/236 [01:31<11:24,  3.23s/it]
test ppl:  11%|█         | 25/236 [01:33<09:57,  2.83s/it]
test ppl:  11%|█         | 26/236 [01:39<13:18,  3.80s/it]
test ppl:  11%|█▏        | 27/236 [01:43<13:46,  3.95s/it]
test ppl:  12%|█▏        | 28/236 [01:44<10:54,  3.15s/it]
test ppl:  12%|█▏        | 29/236 [01:47<10:04,  2.92s/it]
test ppl:  13%|█▎        | 30/236 [01:48<08:36,  2.51s/it]
test ppl:  13%|█▎        | 31/236 [01:50<08:06,  2.37s/it]
test ppl:  14%|█▎        | 32/236 [01:53<08:39,  2.55s/it]
test ppl:  14%|█▍        | 33/236 [01:59<12:15,  3.62s/it]
test ppl:  14%|█▍        | 34/236 [02:04<12:42,  3.78s/it]
test ppl:  15%|█▍        | 35/236 [02:06<11:28,  3.43s/it]
test ppl:  15%|█▌        | 36/236 [02:12<14:03,  4.22s/it]
test ppl:  16%|█▌        | 37/236 [02:18<15:51,  4.78s/it]
test ppl:  16%|█▌        | 38/236 [02:20<13:09,  3.99s/it]
test ppl:  17%|█▋        | 39/236 [02:22<10:42,  3.26s/it]
test ppl:  17%|█▋        | 40/236 [02:25<10:10,  3.12s/it]
test ppl:  17%|█▋        | 41/236 [02:27<09:40,  2.97s/it]
test ppl:  18%|█▊        | 42/236 [02:34<12:40,  3.92s/it]
test ppl:  18%|█▊        | 43/236 [02:40<14:39,  4.56s/it]
test ppl:  19%|█▊        | 44/236 [02:42<12:30,  3.91s/it]
test ppl:  19%|█▉        | 45/236 [02:44<10:40,  3.35s/it]
test ppl:  19%|█▉        | 46/236 [02:50<13:12,  4.17s/it]
test ppl:  20%|█▉        | 47/236 [02:56<14:59,  4.76s/it]
test ppl:  20%|██        | 48/236 [03:02<16:08,  5.15s/it]
test ppl:  21%|██        | 49/236 [03:08<16:11,  5.20s/it]
test ppl:  21%|██        | 50/236 [03:14<16:58,  5.48s/it]
test ppl:  22%|██▏       | 51/236 [03:20<17:30,  5.68s/it]
test ppl:  22%|██▏       | 52/236 [03:26<17:48,  5.81s/it]
test ppl:  22%|██▏       | 53/236 [03:31<16:33,  5.43s/it]
test ppl:  23%|██▎       | 54/236 [03:32<12:57,  4.27s/it]
test ppl:  23%|██▎       | 55/236 [03:38<14:18,  4.74s/it]
test ppl:  24%|██▎       | 56/236 [03:41<13:07,  4.37s/it]
test ppl:  24%|██▍       | 57/236 [03:44<11:31,  3.86s/it]
test ppl:  25%|██▍       | 58/236 [03:46<09:25,  3.18s/it]
test ppl:  25%|██▌       | 59/236 [03:52<11:52,  4.03s/it]
test ppl:  25%|██▌       | 60/236 [03:55<11:07,  3.79s/it]
test ppl:  26%|██▌       | 61/236 [04:01<12:54,  4.43s/it]
test ppl:  26%|██▋       | 62/236 [04:05<12:35,  4.34s/it]
test ppl:  27%|██▋       | 63/236 [04:07<10:54,  3.78s/it]
test ppl:  27%|██▋       | 64/236 [04:09<08:54,  3.11s/it]
test ppl:  28%|██▊       | 65/236 [04:10<07:19,  2.57s/it]
test ppl:  28%|██▊       | 66/236 [04:13<07:38,  2.70s/it]
test ppl:  28%|██▊       | 67/236 [04:19<10:19,  3.66s/it]
test ppl:  29%|██▉       | 68/236 [04:25<12:09,  4.34s/it]
test ppl:  29%|██▉       | 69/236 [04:30<12:18,  4.42s/it]
test ppl:  30%|██▉       | 70/236 [04:31<09:54,  3.58s/it]
test ppl:  30%|███       | 71/236 [04:35<09:52,  3.59s/it]
test ppl:  31%|███       | 72/236 [04:39<10:01,  3.67s/it]
test ppl:  31%|███       | 73/236 [04:43<10:07,  3.73s/it]
test ppl:  31%|███▏      | 74/236 [04:44<08:16,  3.07s/it]
test ppl:  32%|███▏      | 75/236 [04:50<10:30,  3.91s/it]
test ppl:  32%|███▏      | 76/236 [04:52<08:59,  3.37s/it]
test ppl:  33%|███▎      | 77/236 [04:55<08:04,  3.05s/it]
test ppl:  33%|███▎      | 78/236 [04:56<07:08,  2.71s/it]
test ppl:  33%|███▎      | 79/236 [05:01<08:54,  3.41s/it]
test ppl:  34%|███▍      | 80/236 [05:03<07:42,  2.97s/it]
test ppl:  34%|███▍      | 81/236 [05:09<09:56,  3.85s/it]
test ppl:  35%|███▍      | 82/236 [05:15<11:28,  4.47s/it]
test ppl:  35%|███▌      | 83/236 [05:17<09:34,  3.75s/it]
test ppl:  36%|███▌      | 84/236 [05:19<08:07,  3.21s/it]
test ppl:  36%|███▌      | 85/236 [05:24<08:52,  3.53s/it]
test ppl:  36%|███▋      | 86/236 [05:26<07:53,  3.16s/it]
test ppl:  37%|███▋      | 87/236 [05:28<07:06,  2.86s/it]
test ppl:  37%|███▋      | 88/236 [05:34<09:24,  3.82s/it]
test ppl:  38%|███▊      | 89/236 [05:36<08:01,  3.28s/it]
test ppl:  38%|███▊      | 90/236 [05:42<10:01,  4.12s/it]
test ppl:  39%|███▊      | 91/236 [05:48<11:23,  4.71s/it]
test ppl:  39%|███▉      | 92/236 [05:51<10:01,  4.17s/it]
test ppl:  39%|███▉      | 93/236 [05:57<11:17,  4.74s/it]
test ppl:  40%|███▉      | 94/236 [06:03<12:09,  5.14s/it]
test ppl:  40%|████      | 95/236 [06:06<10:04,  4.29s/it]
test ppl:  41%|████      | 96/236 [06:09<09:08,  3.92s/it]
test ppl:  41%|████      | 97/236 [06:15<10:34,  4.56s/it]
test ppl:  42%|████▏     | 98/236 [06:21<11:33,  5.02s/it]
test ppl:  42%|████▏     | 99/236 [06:27<12:13,  5.35s/it]
test ppl:  42%|████▏     | 100/236 [06:28<09:25,  4.16s/it]
test ppl:  43%|████▎     | 101/236 [06:34<10:38,  4.73s/it]
test ppl:  43%|████▎     | 102/236 [06:38<09:53,  4.43s/it]
test ppl:  44%|████▎     | 103/236 [06:40<08:17,  3.74s/it]
test ppl:  44%|████▍     | 104/236 [06:45<08:40,  3.94s/it]
test ppl:  44%|████▍     | 105/236 [06:49<08:41,  3.98s/it]
test ppl:  45%|████▍     | 106/236 [06:54<09:40,  4.46s/it]
test ppl:  45%|████▌     | 107/236 [06:56<08:06,  3.77s/it]
test ppl:  46%|████▌     | 108/236 [07:02<09:24,  4.41s/it]
test ppl:  46%|████▌     | 109/236 [07:07<09:35,  4.53s/it]
test ppl:  47%|████▋     | 110/236 [07:09<07:50,  3.74s/it]
test ppl:  47%|████▋     | 111/236 [07:13<07:59,  3.83s/it]
test ppl:  47%|████▋     | 112/236 [07:17<08:14,  3.99s/it]
test ppl:  48%|████▊     | 113/236 [07:19<06:51,  3.35s/it]
test ppl:  48%|████▊     | 114/236 [07:23<06:51,  3.38s/it]
test ppl:  49%|████▊     | 115/236 [07:29<08:26,  4.19s/it]
test ppl:  49%|████▉     | 116/236 [07:35<09:17,  4.65s/it]
test ppl:  50%|████▉     | 117/236 [07:37<07:35,  3.83s/it]
test ppl:  50%|█████     | 118/236 [07:41<07:56,  4.04s/it]
test ppl:  50%|█████     | 119/236 [07:44<07:31,  3.86s/it]
test ppl:  51%|█████     | 120/236 [07:46<06:02,  3.12s/it]
test ppl:  51%|█████▏    | 121/236 [07:52<07:41,  4.01s/it]
test ppl:  52%|█████▏    | 122/236 [07:57<08:10,  4.30s/it]
test ppl:  52%|█████▏    | 123/236 [07:59<06:56,  3.69s/it]
test ppl:  53%|█████▎    | 124/236 [08:02<06:24,  3.43s/it]
test ppl:  53%|█████▎    | 125/236 [08:05<05:53,  3.18s/it]
test ppl:  53%|█████▎    | 126/236 [08:10<06:54,  3.77s/it]
test ppl:  54%|█████▍    | 127/236 [08:12<05:50,  3.22s/it]
test ppl:  54%|█████▍    | 128/236 [08:14<05:18,  2.95s/it]
test ppl:  55%|█████▍    | 129/236 [08:17<05:19,  2.99s/it]
test ppl:  55%|█████▌    | 130/236 [08:20<05:21,  3.03s/it]
test ppl:  56%|█████▌    | 131/236 [08:26<06:55,  3.96s/it]
test ppl:  56%|█████▌    | 132/236 [08:29<06:08,  3.54s/it]
test ppl:  56%|█████▋    | 133/236 [08:33<06:20,  3.70s/it]
test ppl:  57%|█████▋    | 134/236 [08:39<07:20,  4.32s/it]
test ppl:  57%|█████▋    | 135/236 [08:45<08:08,  4.84s/it]
test ppl:  58%|█████▊    | 136/236 [08:46<06:16,  3.77s/it]
test ppl:  58%|█████▊    | 137/236 [08:52<07:22,  4.47s/it]
test ppl:  58%|█████▊    | 138/236 [08:55<06:44,  4.12s/it]
test ppl:  59%|█████▉    | 139/236 [08:58<05:58,  3.70s/it]
test ppl:  59%|█████▉    | 140/236 [09:00<04:59,  3.12s/it]
test ppl:  60%|█████▉    | 141/236 [09:03<04:52,  3.08s/it]
test ppl:  60%|██████    | 142/236 [09:05<04:24,  2.82s/it]
test ppl:  61%|██████    | 143/236 [09:11<05:53,  3.80s/it]
test ppl:  61%|██████    | 144/236 [09:14<05:23,  3.51s/it]
test ppl:  61%|██████▏   | 145/236 [09:20<06:19,  4.18s/it]
test ppl:  62%|██████▏   | 146/236 [09:24<06:28,  4.32s/it]
test ppl:  62%|██████▏   | 147/236 [09:31<07:13,  4.87s/it]
test ppl:  63%|██████▎   | 148/236 [09:37<07:43,  5.27s/it]
test ppl:  63%|██████▎   | 149/236 [09:40<06:51,  4.73s/it]
test ppl:  64%|██████▎   | 150/236 [09:44<06:31,  4.55s/it]
test ppl:  64%|██████▍   | 151/236 [09:51<07:06,  5.02s/it]
test ppl:  64%|██████▍   | 152/236 [09:57<07:27,  5.33s/it]
test ppl:  65%|██████▍   | 153/236 [10:03<07:40,  5.55s/it]
test ppl:  65%|██████▌   | 154/236 [10:05<06:23,  4.67s/it]
test ppl:  66%|██████▌   | 155/236 [10:08<05:32,  4.10s/it]
test ppl:  66%|██████▌   | 156/236 [10:10<04:43,  3.54s/it]
test ppl:  67%|██████▋   | 157/236 [10:13<04:10,  3.17s/it]
test ppl:  67%|██████▋   | 158/236 [10:19<05:15,  4.04s/it]
test ppl:  67%|██████▋   | 159/236 [10:21<04:40,  3.65s/it]
test ppl:  68%|██████▊   | 160/236 [10:23<03:41,  2.91s/it]
test ppl:  68%|██████▊   | 161/236 [10:24<03:04,  2.46s/it]
test ppl:  69%|██████▊   | 162/236 [10:27<03:20,  2.71s/it]
test ppl:  69%|██████▉   | 163/236 [10:30<03:15,  2.68s/it]
test ppl:  69%|██████▉   | 164/236 [10:36<04:27,  3.71s/it]
test ppl:  70%|██████▉   | 165/236 [10:40<04:38,  3.92s/it]
test ppl:  70%|███████   | 166/236 [10:42<03:44,  3.21s/it]
test ppl:  71%|███████   | 167/236 [10:43<03:06,  2.70s/it]
test ppl:  71%|███████   | 168/236 [10:49<03:54,  3.45s/it]
test ppl:  72%|███████▏  | 169/236 [10:54<04:34,  4.09s/it]
test ppl:  72%|███████▏  | 170/236 [11:00<05:10,  4.71s/it]
test ppl:  72%|███████▏  | 171/236 [11:02<04:01,  3.71s/it]
test ppl:  73%|███████▎  | 172/236 [11:08<04:42,  4.42s/it]
test ppl:  73%|███████▎  | 173/236 [11:12<04:26,  4.23s/it]
test ppl:  74%|███████▎  | 174/236 [11:16<04:18,  4.17s/it]
test ppl:  74%|███████▍  | 175/236 [11:18<03:32,  3.48s/it]
test ppl:  75%|███████▍  | 176/236 [11:23<03:57,  3.95s/it]
test ppl:  75%|███████▌  | 177/236 [11:29<04:31,  4.61s/it]
test ppl:  75%|███████▌  | 178/236 [11:35<04:51,  5.02s/it]
test ppl:  76%|███████▌  | 179/236 [11:41<05:01,  5.29s/it]
test ppl:  76%|███████▋  | 180/236 [11:45<04:44,  5.08s/it]
test ppl:  77%|███████▋  | 181/236 [11:51<04:52,  5.32s/it]
test ppl:  77%|███████▋  | 182/236 [11:53<03:51,  4.30s/it]
test ppl:  78%|███████▊  | 183/236 [11:55<03:15,  3.69s/it]
test ppl:  78%|███████▊  | 184/236 [11:57<02:37,  3.02s/it]
test ppl:  78%|███████▊  | 185/236 [12:01<02:49,  3.32s/it]
test ppl:  79%|███████▉  | 186/236 [12:07<03:24,  4.09s/it]
test ppl:  79%|███████▉  | 187/236 [12:13<03:48,  4.66s/it]
test ppl:  80%|███████▉  | 188/236 [12:19<04:01,  5.04s/it]
test ppl:  80%|████████  | 189/236 [12:25<04:09,  5.30s/it]
test ppl:  81%|████████  | 190/236 [12:28<03:41,  4.82s/it]
test ppl:  81%|████████  | 191/236 [12:33<03:30,  4.68s/it]
test ppl:  81%|████████▏ | 192/236 [12:35<02:58,  4.07s/it]
test ppl:  82%|████████▏ | 193/236 [12:41<03:18,  4.62s/it]
test ppl:  82%|████████▏ | 194/236 [12:44<02:49,  4.02s/it]
test ppl:  83%|████████▎ | 195/236 [12:47<02:33,  3.74s/it]
test ppl:  83%|████████▎ | 196/236 [12:49<02:08,  3.22s/it]
test ppl:  83%|████████▎ | 197/236 [12:51<01:52,  2.89s/it]
test ppl:  84%|████████▍ | 198/236 [12:57<02:24,  3.80s/it]
test ppl:  84%|████████▍ | 199/236 [13:00<02:08,  3.47s/it]
test ppl:  85%|████████▍ | 200/236 [13:05<02:31,  4.21s/it]
test ppl:  85%|████████▌ | 201/236 [13:08<02:04,  3.56s/it]
test ppl:  86%|████████▌ | 202/236 [13:12<02:11,  3.88s/it]
test ppl:  86%|████████▌ | 203/236 [13:18<02:28,  4.50s/it]
test ppl:  86%|████████▋ | 204/236 [13:20<01:54,  3.59s/it]
test ppl:  87%|████████▋ | 205/236 [13:26<02:14,  4.35s/it]
test ppl:  87%|████████▋ | 206/236 [13:29<02:01,  4.04s/it]
test ppl:  88%|████████▊ | 207/236 [13:35<02:13,  4.60s/it]
test ppl:  88%|████████▊ | 208/236 [13:38<01:56,  4.17s/it]
test ppl:  89%|████████▊ | 209/236 [13:44<02:07,  4.71s/it]
test ppl:  89%|████████▉ | 210/236 [13:46<01:44,  4.00s/it]
test ppl:  89%|████████▉ | 211/236 [13:51<01:46,  4.25s/it]
test ppl:  90%|████████▉ | 212/236 [13:56<01:48,  4.53s/it]
test ppl:  90%|█████████ | 213/236 [14:02<01:53,  4.94s/it]
test ppl:  91%|█████████ | 214/236 [14:04<01:26,  3.95s/it]
test ppl:  91%|█████████ | 215/236 [14:10<01:35,  4.54s/it]
test ppl:  92%|█████████▏| 216/236 [14:12<01:18,  3.95s/it]
test ppl:  92%|█████████▏| 217/236 [14:18<01:26,  4.55s/it]
test ppl:  92%|█████████▏| 218/236 [14:20<01:07,  3.77s/it]
test ppl:  93%|█████████▎| 219/236 [14:26<01:15,  4.42s/it]
test ppl:  93%|█████████▎| 220/236 [14:32<01:17,  4.87s/it]
test ppl:  94%|█████████▎| 221/236 [14:36<01:08,  4.59s/it]
test ppl:  94%|█████████▍| 222/236 [14:42<01:09,  4.99s/it]
test ppl:  94%|█████████▍| 223/236 [14:48<01:08,  5.27s/it]
test ppl:  95%|█████████▍| 224/236 [14:49<00:48,  4.08s/it]
test ppl:  95%|█████████▌| 225/236 [14:55<00:49,  4.48s/it]
test ppl:  96%|█████████▌| 226/236 [14:58<00:42,  4.20s/it]
test ppl:  96%|█████████▌| 227/236 [15:01<00:32,  3.67s/it]
test ppl:  97%|█████████▋| 228/236 [15:03<00:25,  3.18s/it]
test ppl:  97%|█████████▋| 229/236 [15:09<00:27,  3.99s/it]
test ppl:  97%|█████████▋| 230/236 [15:12<00:23,  3.87s/it]
test ppl:  98%|█████████▊| 231/236 [15:16<00:18,  3.74s/it]
test ppl:  98%|█████████▊| 232/236 [15:17<00:12,  3.14s/it]
test ppl:  99%|█████████▊| 233/236 [15:20<00:08,  2.85s/it]
test ppl:  99%|█████████▉| 234/236 [15:21<00:04,  2.36s/it]
test ppl: 100%|█████████▉| 235/236 [15:27<00:03,  3.43s/it]
test ppl: 100%|██████████| 236/236 [15:27<00:00,  2.60s/it]
test ppl: 100%|██████████| 236/236 [15:27<00:00,  3.93s/it]
10/12/2024 12:22:40 - INFO - __main__ -    em: 0.2109
10/12/2024 12:22:40 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.2 40:  em: 0.2109

--------------------------------------------------------------------------------
Running experiment with knn_temp=40, lmbda=0.2, k=32
2024-10-12 12:22:47.984598: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 12:22:48.004309: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 12:22:48.026413: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 12:22:48.033121: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 12:22:48.049276: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 12:22:49.044333: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 12:22:50 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.2, knn_temp=40, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 12:22:50 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:37:16,  2.20it/s]
Adding feature api:   4%|▍         | 7430/187062 [00:00<00:10, 17764.88it/s]
Adding feature api:   8%|▊         | 15858/187062 [00:00<00:04, 34700.10it/s]
Adding feature api:  13%|█▎        | 24072/187062 [00:00<00:03, 47352.01it/s]
Adding feature api:  17%|█▋        | 32581/187062 [00:00<00:02, 57762.84it/s]
Adding feature api:  22%|██▏       | 41095/187062 [00:00<00:02, 65500.03it/s]
Adding feature api:  26%|██▋       | 49553/187062 [00:01<00:01, 70986.90it/s]
Adding feature api:  31%|███       | 57783/187062 [00:01<00:01, 74278.96it/s]
Adding feature api:  35%|███▌      | 66235/187062 [00:01<00:01, 77286.04it/s]
Adding feature api:  40%|███▉      | 74781/187062 [00:01<00:01, 79699.98it/s]
Adding feature api:  45%|████▍     | 83261/187062 [00:01<00:01, 81211.81it/s]
Adding feature api:  49%|████▉     | 91632/187062 [00:01<00:01, 81687.26it/s]
Adding feature api:  54%|█████▎    | 100117/187062 [00:01<00:01, 82628.55it/s]
Adding feature api:  58%|█████▊    | 108656/187062 [00:01<00:00, 83451.07it/s]
Adding feature api:  63%|██████▎   | 117138/187062 [00:01<00:00, 83855.62it/s]
Adding feature api:  67%|██████▋   | 125610/187062 [00:01<00:00, 84111.17it/s]
Adding feature api:  72%|███████▏  | 134064/187062 [00:02<00:00, 83726.25it/s]
Adding feature api:  76%|███████▌  | 142570/187062 [00:02<00:00, 84123.52it/s]
Adding feature api:  81%|████████  | 151114/187062 [00:02<00:00, 84513.76it/s]
Adding feature api:  85%|████████▌ | 159641/187062 [00:02<00:00, 84737.07it/s]
Adding feature api:  90%|████████▉ | 168126/187062 [00:02<00:00, 84071.55it/s]
Adding feature api:  94%|█████████▍| 176643/187062 [00:02<00:00, 84395.93it/s]
Adding feature api:  99%|█████████▉| 185089/187062 [00:02<00:00, 55944.30it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64609.24it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:30:00,  2.21it/s]
Adding feature datatype:   4%|▍         | 7237/187062 [00:00<00:10, 17370.96it/s]
Adding feature datatype:   8%|▊         | 15093/187062 [00:00<00:05, 32994.88it/s]
Adding feature datatype:  12%|█▏        | 23341/187062 [00:00<00:03, 46220.12it/s]
Adding feature datatype:  17%|█▋        | 31627/187062 [00:00<00:02, 56343.44it/s]
Adding feature datatype:  21%|██▏       | 39923/187062 [00:00<00:02, 63875.73it/s]
Adding feature datatype:  26%|██▌       | 48232/187062 [00:01<00:02, 69406.47it/s]
Adding feature datatype:  30%|███       | 56579/187062 [00:01<00:01, 72622.29it/s]
Adding feature datatype:  35%|███▍      | 64881/187062 [00:01<00:01, 75649.46it/s]
Adding feature datatype:  39%|███▉      | 73219/187062 [00:01<00:01, 77920.52it/s]
Adding feature datatype:  44%|████▎     | 81521/187062 [00:01<00:01, 79428.20it/s]
Adding feature datatype:  48%|████▊     | 89889/187062 [00:01<00:01, 80687.81it/s]
Adding feature datatype:  52%|█████▏    | 98164/187062 [00:01<00:01, 81300.34it/s]
Adding feature datatype:  57%|█████▋    | 106415/187062 [00:01<00:00, 80887.91it/s]
Adding feature datatype:  61%|██████▏   | 114746/187062 [00:01<00:00, 81605.25it/s]
Adding feature datatype:  66%|██████▌   | 123070/187062 [00:01<00:00, 82089.41it/s]
Adding feature datatype:  70%|███████   | 131419/187062 [00:02<00:00, 82506.04it/s]
Adding feature datatype:  75%|███████▍  | 139742/187062 [00:02<00:00, 82721.30it/s]
Adding feature datatype:  79%|███████▉  | 148036/187062 [00:02<00:00, 82691.73it/s]
Adding feature datatype:  84%|████████▎ | 156320/187062 [00:02<00:00, 81709.55it/s]
Adding feature datatype:  88%|████████▊ | 164670/187062 [00:02<00:00, 82238.16it/s]
Adding feature datatype:  92%|█████████▏| 172941/187062 [00:02<00:00, 82378.22it/s]
Adding feature datatype:  97%|█████████▋| 181186/187062 [00:02<00:00, 66634.12it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63590.01it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:13:45,  2.24it/s]
Adding feature literal:   4%|▍         | 7154/187062 [00:00<00:10, 17323.73it/s]
Adding feature literal:   8%|▊         | 15310/187062 [00:00<00:05, 33833.40it/s]
Adding feature literal:  13%|█▎        | 23498/187062 [00:00<00:03, 46735.33it/s]
Adding feature literal:  17%|█▋        | 31714/187062 [00:00<00:02, 56555.96it/s]
Adding feature literal:  21%|██▏       | 39932/187062 [00:00<00:02, 63823.89it/s]
Adding feature literal:  26%|██▌       | 48206/187062 [00:01<00:02, 69276.85it/s]
Adding feature literal:  30%|███       | 56481/187062 [00:01<00:01, 73205.95it/s]
Adding feature literal:  35%|███▍      | 64695/187062 [00:01<00:01, 75833.56it/s]
Adding feature literal:  39%|███▉      | 72913/187062 [00:01<00:01, 77708.92it/s]
Adding feature literal:  43%|████▎     | 81146/187062 [00:01<00:01, 79080.49it/s]
Adding feature literal:  48%|████▊     | 89292/187062 [00:01<00:01, 77241.47it/s]
Adding feature literal:  52%|█████▏    | 97191/187062 [00:01<00:01, 75912.13it/s]
Adding feature literal:  56%|█████▌    | 104907/187062 [00:01<00:01, 74987.61it/s]
Adding feature literal:  60%|██████    | 112541/187062 [00:01<00:00, 75375.39it/s]
Adding feature literal:  65%|██████▍   | 120741/187062 [00:01<00:00, 77309.19it/s]
Adding feature literal:  69%|██████▉   | 128978/187062 [00:02<00:00, 78796.73it/s]
Adding feature literal:  73%|███████▎  | 137208/187062 [00:02<00:00, 79830.93it/s]
Adding feature literal:  78%|███████▊  | 145528/187062 [00:02<00:00, 80830.78it/s]
Adding feature literal:  82%|████████▏ | 153811/187062 [00:02<00:00, 81423.45it/s]
Adding feature literal:  87%|████████▋ | 162105/187062 [00:02<00:00, 81874.44it/s]
Adding feature literal:  91%|█████████ | 170374/187062 [00:02<00:00, 82116.82it/s]
Adding feature literal:  95%|█████████▌| 178594/187062 [00:02<00:00, 77447.76it/s]
Adding feature literal: 100%|█████████▉| 186399/187062 [00:02<00:00, 52134.02it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 62700.61it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:17:38,  2.23it/s]
Adding feature operator:   4%|▍         | 7048/187062 [00:00<00:10, 17030.76it/s]
Adding feature operator:   8%|▊         | 15315/187062 [00:00<00:05, 33874.65it/s]
Adding feature operator:  13%|█▎        | 23607/187062 [00:00<00:03, 47029.65it/s]
Adding feature operator:  17%|█▋        | 31891/187062 [00:00<00:02, 56949.67it/s]
Adding feature operator:  21%|██▏       | 40200/187062 [00:00<00:02, 64360.62it/s]
Adding feature operator:  26%|██▌       | 48527/187062 [00:01<00:01, 69811.04it/s]
Adding feature operator:  30%|███       | 56826/187062 [00:01<00:01, 73652.98it/s]
Adding feature operator:  35%|███▍      | 65028/187062 [00:01<00:01, 76113.29it/s]
Adding feature operator:  39%|███▉      | 73318/187062 [00:01<00:01, 78118.15it/s]
Adding feature operator:  44%|████▎     | 81614/187062 [00:01<00:01, 79553.64it/s]
Adding feature operator:  48%|████▊     | 89958/187062 [00:01<00:01, 80710.11it/s]
Adding feature operator:  53%|█████▎    | 98270/187062 [00:01<00:01, 81428.75it/s]
Adding feature operator:  57%|█████▋    | 106559/187062 [00:01<00:00, 81862.75it/s]
Adding feature operator:  61%|██████▏   | 114834/187062 [00:01<00:00, 82125.62it/s]
Adding feature operator:  66%|██████▌   | 123131/187062 [00:01<00:00, 82375.23it/s]
Adding feature operator:  70%|███████   | 131431/187062 [00:02<00:00, 82559.45it/s]
Adding feature operator:  75%|███████▍  | 139752/187062 [00:02<00:00, 82752.28it/s]
Adding feature operator:  79%|███████▉  | 148048/187062 [00:02<00:00, 82786.88it/s]
Adding feature operator:  84%|████████▎ | 156374/187062 [00:02<00:00, 82927.92it/s]
Adding feature operator:  88%|████████▊ | 164723/187062 [00:02<00:00, 83094.70it/s]
Adding feature operator:  93%|█████████▎| 173040/187062 [00:02<00:00, 83080.72it/s]
Adding feature operator:  97%|█████████▋| 181353/187062 [00:02<00:00, 66034.12it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63998.15it/s]
[2024-10-12 12:23:34,201] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 12:23:35 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 12:23:35 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 411.90 examples/s]
Map:   1%|▏         | 85/6548 [00:00<00:29, 221.59 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:24, 264.44 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 316.26 examples/s]
Map:   3%|▎         | 224/6548 [00:00<00:17, 357.52 examples/s]
Map:   4%|▍         | 282/6548 [00:00<00:17, 356.12 examples/s]
Map:   5%|▌         | 333/6548 [00:01<00:20, 310.30 examples/s]
Map:   6%|▌         | 390/6548 [00:01<00:18, 325.44 examples/s]
Map:   7%|▋         | 433/6548 [00:01<00:17, 343.73 examples/s]
Map:   7%|▋         | 470/6548 [00:01<00:17, 348.85 examples/s]
Map:   8%|▊         | 521/6548 [00:01<00:17, 344.53 examples/s]
Map:   9%|▊         | 570/6548 [00:01<00:15, 377.21 examples/s]
Map:   9%|▉         | 622/6548 [00:01<00:17, 344.39 examples/s]
Map:  10%|█         | 680/6548 [00:02<00:16, 350.12 examples/s]
Map:  11%|█         | 723/6548 [00:02<00:15, 365.67 examples/s]
Map:  12%|█▏        | 771/6548 [00:02<00:14, 390.03 examples/s]
Map:  13%|█▎        | 819/6548 [00:02<00:13, 411.12 examples/s]
Map:  13%|█▎        | 880/6548 [00:02<00:13, 407.72 examples/s]
Map:  14%|█▍        | 932/6548 [00:02<00:14, 375.85 examples/s]
Map:  15%|█▍        | 971/6548 [00:02<00:14, 378.56 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:23, 232.38 examples/s]
Map:  16%|█▌        | 1054/6548 [00:03<00:21, 256.74 examples/s]
Map:  17%|█▋        | 1097/6548 [00:03<00:18, 288.92 examples/s]
Map:  17%|█▋        | 1143/6548 [00:03<00:16, 325.56 examples/s]
Map:  18%|█▊        | 1198/6548 [00:03<00:16, 334.10 examples/s]
Map:  19%|█▉        | 1238/6548 [00:03<00:15, 341.81 examples/s]
Map:  20%|█▉        | 1278/6548 [00:03<00:15, 348.29 examples/s]
Map:  20%|██        | 1322/6548 [00:03<00:16, 321.05 examples/s]
Map:  21%|██        | 1358/6548 [00:04<00:17, 292.58 examples/s]
Map:  21%|██▏       | 1402/6548 [00:04<00:17, 291.29 examples/s]
Map:  22%|██▏       | 1436/6548 [00:04<00:18, 270.89 examples/s]
Map:  22%|██▏       | 1466/6548 [00:04<00:18, 274.29 examples/s]
Map:  23%|██▎       | 1512/6548 [00:04<00:17, 281.68 examples/s]
Map:  24%|██▎       | 1542/6548 [00:04<00:17, 278.39 examples/s]
Map:  24%|██▍       | 1576/6548 [00:04<00:17, 286.17 examples/s]
Map:  25%|██▍       | 1610/6548 [00:05<00:19, 253.27 examples/s]
Map:  25%|██▌       | 1641/6548 [00:05<00:18, 258.34 examples/s]
Map:  25%|██▌       | 1668/6548 [00:05<00:22, 220.10 examples/s]
Map:  26%|██▌       | 1707/6548 [00:05<00:18, 257.35 examples/s]
Map:  27%|██▋       | 1749/6548 [00:05<00:16, 294.42 examples/s]
Map:  27%|██▋       | 1792/6548 [00:05<00:14, 326.95 examples/s]
Map:  28%|██▊       | 1829/6548 [00:05<00:14, 330.35 examples/s]
Map:  28%|██▊       | 1866/6548 [00:05<00:14, 322.79 examples/s]
Map:  29%|██▉       | 1906/6548 [00:06<00:13, 335.60 examples/s]
Map:  30%|██▉       | 1960/6548 [00:06<00:13, 334.71 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:19, 228.63 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:18, 240.35 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:16, 271.59 examples/s]
Map:  32%|███▏      | 2107/6548 [00:06<00:15, 286.20 examples/s]
Map:  33%|███▎      | 2139/6548 [00:06<00:15, 276.41 examples/s]
Map:  33%|███▎      | 2188/6548 [00:07<00:15, 288.60 examples/s]
Map:  34%|███▍      | 2230/6548 [00:07<00:14, 292.57 examples/s]
Map:  35%|███▍      | 2272/6548 [00:07<00:15, 284.06 examples/s]
Map:  35%|███▌      | 2311/6548 [00:07<00:13, 304.85 examples/s]
Map:  36%|███▌      | 2355/6548 [00:07<00:13, 311.45 examples/s]
Map:  37%|███▋      | 2397/6548 [00:07<00:12, 337.15 examples/s]
Map:  37%|███▋      | 2438/6548 [00:07<00:12, 327.50 examples/s]
Map:  38%|███▊      | 2477/6548 [00:07<00:12, 333.80 examples/s]
Map:  38%|███▊      | 2517/6548 [00:08<00:11, 347.23 examples/s]
Map:  39%|███▉      | 2569/6548 [00:08<00:11, 343.30 examples/s]
Map:  40%|███▉      | 2614/6548 [00:08<00:10, 367.76 examples/s]
Map:  41%|████      | 2653/6548 [00:08<00:10, 370.59 examples/s]
Map:  41%|████▏     | 2704/6548 [00:08<00:11, 347.76 examples/s]
Map:  42%|████▏     | 2740/6548 [00:08<00:10, 348.53 examples/s]
Map:  43%|████▎     | 2791/6548 [00:08<00:10, 341.85 examples/s]
Map:  43%|████▎     | 2828/6548 [00:09<00:13, 278.44 examples/s]
Map:  44%|████▎     | 2862/6548 [00:09<00:12, 289.08 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 295.59 examples/s]
Map:  45%|████▍     | 2942/6548 [00:09<00:12, 286.22 examples/s]
Map:  46%|████▌     | 2988/6548 [00:09<00:12, 283.66 examples/s]
Map:  46%|████▌     | 3023/6548 [00:10<00:21, 161.99 examples/s]
Map:  47%|████▋     | 3058/6548 [00:10<00:18, 187.81 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 210.12 examples/s]
Map:  48%|████▊     | 3133/6548 [00:10<00:13, 247.89 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:14, 237.63 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:14, 238.43 examples/s]
Map:  50%|████▉     | 3245/6548 [00:10<00:13, 243.43 examples/s]
Map:  50%|█████     | 3276/6548 [00:10<00:12, 257.65 examples/s]
Map:  51%|█████     | 3311/6548 [00:11<00:11, 277.80 examples/s]
Map:  51%|█████     | 3350/6548 [00:11<00:10, 297.95 examples/s]
Map:  52%|█████▏    | 3389/6548 [00:11<00:11, 265.83 examples/s]
Map:  52%|█████▏    | 3421/6548 [00:11<00:11, 272.30 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 264.61 examples/s]
Map:  53%|█████▎    | 3495/6548 [00:11<00:11, 265.62 examples/s]
Map:  54%|█████▍    | 3544/6548 [00:11<00:09, 318.44 examples/s]
Map:  55%|█████▍    | 3591/6548 [00:11<00:08, 350.34 examples/s]
Map:  56%|█████▌    | 3637/6548 [00:12<00:07, 376.39 examples/s]
Map:  56%|█████▋    | 3696/6548 [00:12<00:07, 376.96 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:12<00:07, 381.33 examples/s]
Map:  58%|█████▊    | 3799/6548 [00:12<00:07, 370.50 examples/s]
Map:  59%|█████▊    | 3841/6548 [00:12<00:08, 326.84 examples/s]
Map:  59%|█████▉    | 3882/6548 [00:12<00:08, 332.19 examples/s]
Map:  60%|█████▉    | 3918/6548 [00:12<00:07, 332.93 examples/s]
Map:  60%|██████    | 3955/6548 [00:13<00:07, 339.35 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 232.00 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 289.94 examples/s]
Map:  62%|██████▏   | 4091/6548 [00:13<00:08, 303.51 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 324.77 examples/s]
Map:  64%|██████▍   | 4195/6548 [00:13<00:07, 329.87 examples/s]
Map:  65%|██████▍   | 4231/6548 [00:13<00:07, 324.92 examples/s]
Map:  65%|██████▌   | 4274/6548 [00:14<00:06, 347.56 examples/s]
Map:  66%|██████▌   | 4313/6548 [00:14<00:06, 353.97 examples/s]
Map:  67%|██████▋   | 4359/6548 [00:14<00:06, 336.63 examples/s]
Map:  67%|██████▋   | 4400/6548 [00:14<00:06, 342.10 examples/s]
Map:  68%|██████▊   | 4446/6548 [00:14<00:05, 371.17 examples/s]
Map:  68%|██████▊   | 4485/6548 [00:14<00:06, 328.82 examples/s]
Map:  69%|██████▉   | 4530/6548 [00:14<00:06, 311.23 examples/s]
Map:  70%|██████▉   | 4569/6548 [00:14<00:06, 326.11 examples/s]
Map:  70%|███████   | 4603/6548 [00:15<00:06, 311.57 examples/s]
Map:  71%|███████   | 4646/6548 [00:15<00:05, 339.55 examples/s]
Map:  72%|███████▏  | 4694/6548 [00:15<00:05, 331.58 examples/s]
Map:  72%|███████▏  | 4737/6548 [00:15<00:05, 345.59 examples/s]
Map:  73%|███████▎  | 4792/6548 [00:15<00:04, 394.90 examples/s]
Map:  74%|███████▍  | 4852/6548 [00:15<00:04, 387.97 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 368.30 examples/s]
Map:  76%|███████▌  | 4953/6548 [00:15<00:04, 394.53 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:16<00:06, 244.75 examples/s]
Map:  77%|███████▋  | 5052/6548 [00:16<00:05, 262.79 examples/s]
Map:  78%|███████▊  | 5101/6548 [00:16<00:05, 272.55 examples/s]
Map:  78%|███████▊  | 5133/6548 [00:16<00:05, 247.04 examples/s]
Map:  79%|███████▉  | 5174/6548 [00:16<00:04, 276.88 examples/s]
Map:  80%|███████▉  | 5207/6548 [00:17<00:04, 278.92 examples/s]
Map:  80%|████████  | 5247/6548 [00:17<00:04, 302.70 examples/s]
Map:  81%|████████  | 5287/6548 [00:17<00:03, 324.34 examples/s]
Map:  81%|████████▏ | 5325/6548 [00:17<00:03, 325.78 examples/s]
Map:  82%|████████▏ | 5361/6548 [00:17<00:04, 289.27 examples/s]
Map:  82%|████████▏ | 5392/6548 [00:17<00:04, 283.69 examples/s]
Map:  83%|████████▎ | 5430/6548 [00:17<00:03, 305.44 examples/s]
Map:  84%|████████▎ | 5472/6548 [00:17<00:03, 330.23 examples/s]
Map:  84%|████████▍ | 5508/6548 [00:17<00:03, 334.54 examples/s]
Map:  85%|████████▍ | 5548/6548 [00:18<00:02, 351.04 examples/s]
Map:  85%|████████▌ | 5595/6548 [00:18<00:03, 297.11 examples/s]
Map:  86%|████████▌ | 5641/6548 [00:18<00:02, 334.50 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:03, 282.87 examples/s]
Map:  87%|████████▋ | 5714/6548 [00:18<00:02, 291.26 examples/s]
Map:  88%|████████▊ | 5759/6548 [00:18<00:02, 328.50 examples/s]
Map:  89%|████████▊ | 5796/6548 [00:18<00:02, 336.74 examples/s]
Map:  89%|████████▉ | 5846/6548 [00:19<00:02, 331.51 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:19<00:01, 339.64 examples/s]
Map:  90%|█████████ | 5921/6548 [00:19<00:01, 341.74 examples/s]
Map:  91%|█████████ | 5964/6548 [00:19<00:01, 313.57 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 210.47 examples/s]
Map:  92%|█████████▏| 6041/6548 [00:19<00:02, 247.30 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 279.63 examples/s]
Map:  94%|█████████▎| 6124/6548 [00:20<00:01, 276.13 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:20<00:01, 292.86 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:20<00:01, 309.04 examples/s]
Map:  96%|█████████▌| 6261/6548 [00:20<00:00, 319.70 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 334.99 examples/s]
Map:  97%|█████████▋| 6337/6548 [00:20<00:00, 338.45 examples/s]
Map:  97%|█████████▋| 6381/6548 [00:20<00:00, 347.36 examples/s]
Map:  98%|█████████▊| 6422/6548 [00:20<00:00, 362.52 examples/s]
Map:  99%|█████████▉| 6471/6548 [00:21<00:00, 395.13 examples/s]
Map:  99%|█████████▉| 6515/6548 [00:21<00:00, 388.58 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 306.61 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 325.81 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 347.22 examples/s]
Map:  13%|█▎        | 116/903 [00:00<00:02, 343.35 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 358.86 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 406.47 examples/s]
Map:  29%|██▉       | 263/903 [00:00<00:01, 379.33 examples/s]
Map:  34%|███▍      | 308/903 [00:00<00:01, 392.32 examples/s]
Map:  39%|███▉      | 354/903 [00:00<00:01, 353.10 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 295.46 examples/s]
Map:  50%|████▉     | 450/903 [00:01<00:01, 280.59 examples/s]
Map:  54%|█████▍    | 486/903 [00:01<00:01, 284.24 examples/s]
Map:  59%|█████▉    | 536/903 [00:01<00:01, 326.88 examples/s]
Map:  64%|██████▍   | 581/903 [00:01<00:00, 352.29 examples/s]
Map:  69%|██████▊   | 619/903 [00:01<00:00, 354.49 examples/s]
Map:  73%|███████▎  | 663/903 [00:01<00:00, 375.15 examples/s]
Map:  78%|███████▊  | 704/903 [00:02<00:00, 381.96 examples/s]
Map:  83%|████████▎ | 751/903 [00:02<00:00, 404.17 examples/s]
Map:  89%|████████▉ | 807/903 [00:02<00:00, 386.36 examples/s]
Map:  95%|█████████▍| 857/903 [00:02<00:00, 411.74 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 228.48 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 321.30 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 302.17 examples/s]
Map:   4%|▍         | 81/1882 [00:00<00:04, 369.13 examples/s]
Map:   7%|▋         | 124/1882 [00:00<00:05, 306.70 examples/s]
Map:   9%|▉         | 167/1882 [00:00<00:04, 345.34 examples/s]
Map:  12%|█▏        | 222/1882 [00:00<00:05, 330.58 examples/s]
Map:  14%|█▍        | 267/1882 [00:00<00:04, 354.20 examples/s]
Map:  18%|█▊        | 330/1882 [00:00<00:04, 372.38 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:05, 296.93 examples/s]
Map:  22%|██▏       | 414/1882 [00:01<00:05, 280.72 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 288.29 examples/s]
Map:  26%|██▌       | 489/1882 [00:01<00:04, 311.00 examples/s]
Map:  28%|██▊       | 532/1882 [00:01<00:04, 294.90 examples/s]
Map:  30%|███       | 571/1882 [00:01<00:04, 315.86 examples/s]
Map:  33%|███▎      | 617/1882 [00:01<00:03, 349.15 examples/s]
Map:  35%|███▌      | 661/1882 [00:02<00:03, 371.75 examples/s]
Map:  37%|███▋      | 704/1882 [00:02<00:03, 383.65 examples/s]
Map:  41%|████      | 768/1882 [00:02<00:02, 390.08 examples/s]
Map:  43%|████▎     | 811/1882 [00:02<00:03, 351.64 examples/s]
Map:  45%|████▌     | 853/1882 [00:02<00:02, 356.42 examples/s]
Map:  48%|████▊     | 897/1882 [00:02<00:02, 373.87 examples/s]
Map:  50%|████▉     | 940/1882 [00:02<00:02, 387.22 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 398.73 examples/s]
Map:  55%|█████▌    | 1039/1882 [00:03<00:03, 253.65 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 266.02 examples/s]
Map:  59%|█████▉    | 1116/1882 [00:03<00:02, 269.03 examples/s]
Map:  61%|██████    | 1148/1882 [00:03<00:02, 275.08 examples/s]
Map:  63%|██████▎   | 1184/1882 [00:03<00:02, 256.88 examples/s]
Map:  65%|██████▌   | 1224/1882 [00:03<00:02, 283.54 examples/s]
Map:  67%|██████▋   | 1256/1882 [00:03<00:02, 286.01 examples/s]
Map:  69%|██████▉   | 1305/1882 [00:04<00:01, 333.23 examples/s]
Map:  72%|███████▏  | 1346/1882 [00:04<00:01, 346.06 examples/s]
Map:  74%|███████▍  | 1393/1882 [00:04<00:01, 326.10 examples/s]
Map:  76%|███████▌  | 1431/1882 [00:04<00:01, 275.97 examples/s]
Map:  78%|███████▊  | 1471/1882 [00:04<00:01, 298.97 examples/s]
Map:  80%|███████▉  | 1504/1882 [00:04<00:01, 261.69 examples/s]
Map:  82%|████████▏ | 1535/1882 [00:04<00:01, 267.35 examples/s]
Map:  84%|████████▎ | 1575/1882 [00:05<00:01, 294.29 examples/s]
Map:  86%|████████▌ | 1619/1882 [00:05<00:00, 326.28 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 327.60 examples/s]
Map:  91%|█████████ | 1710/1882 [00:05<00:00, 321.92 examples/s]
Map:  93%|█████████▎| 1750/1882 [00:05<00:00, 272.17 examples/s]
Map:  95%|█████████▍| 1781/1882 [00:05<00:00, 275.46 examples/s]
Map:  97%|█████████▋| 1824/1882 [00:05<00:00, 307.14 examples/s]
Map:  99%|█████████▉| 1869/1882 [00:05<00:00, 339.48 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 305.00 examples/s]
10/12/2024 12:24:37 - INFO - __main__ -     ***** Testing *****
10/12/2024 12:24:37 - INFO - __main__ -     Batch size = 8
10/12/2024 12:24:37 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 12:24:38 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 12:24:38 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 12:24:39 - INFO - knnlm -   Reading datastore took 0.97884202003479 s
10/12/2024 12:24:40 - INFO - knnlm -   Moving index to GPU took 0.98079514503479 s
10/12/2024 12:24:40 - INFO - __main__ -   ******************************break-into
10/12/2024 12:24:40 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 12:24:40 - INFO - __main__ -     Num examples = 236
10/12/2024 12:24:40 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:35,  7.55s/it]
test ppl:   1%|          | 2/236 [00:09<16:34,  4.25s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:37,  2.99s/it]
test ppl:   2%|▏         | 4/236 [00:12<09:29,  2.46s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:07,  3.67s/it]
test ppl:   3%|▎         | 6/236 [00:20<12:16,  3.20s/it]
test ppl:   3%|▎         | 7/236 [00:23<11:21,  2.98s/it]
test ppl:   3%|▎         | 8/236 [00:27<12:51,  3.38s/it]
test ppl:   4%|▍         | 9/236 [00:33<15:41,  4.15s/it]
test ppl:   4%|▍         | 10/236 [00:36<14:18,  3.80s/it]
test ppl:   5%|▍         | 11/236 [00:38<12:35,  3.36s/it]
test ppl:   5%|▌         | 12/236 [00:44<15:20,  4.11s/it]
test ppl:   6%|▌         | 13/236 [00:50<17:13,  4.64s/it]
test ppl:   6%|▌         | 14/236 [00:56<18:31,  5.01s/it]
test ppl:   6%|▋         | 15/236 [00:58<15:32,  4.22s/it]
test ppl:   7%|▋         | 16/236 [01:00<12:52,  3.51s/it]
test ppl:   7%|▋         | 17/236 [01:04<12:53,  3.53s/it]
test ppl:   8%|▊         | 18/236 [01:05<10:48,  2.97s/it]
test ppl:   8%|▊         | 19/236 [01:10<12:19,  3.41s/it]
test ppl:   8%|▊         | 20/236 [01:11<10:30,  2.92s/it]
test ppl:   9%|▉         | 21/236 [01:14<09:46,  2.73s/it]
test ppl:   9%|▉         | 22/236 [01:20<13:04,  3.67s/it]
test ppl:  10%|▉         | 23/236 [01:22<11:46,  3.32s/it]
test ppl:  10%|█         | 24/236 [01:24<10:42,  3.03s/it]
test ppl:  11%|█         | 25/236 [01:26<09:23,  2.67s/it]
test ppl:  11%|█         | 26/236 [01:32<12:42,  3.63s/it]
test ppl:  11%|█▏        | 27/236 [01:36<13:10,  3.78s/it]
test ppl:  12%|█▏        | 28/236 [01:37<10:25,  3.01s/it]
test ppl:  12%|█▏        | 29/236 [01:40<09:39,  2.80s/it]
test ppl:  13%|█▎        | 30/236 [01:41<08:16,  2.41s/it]
test ppl:  13%|█▎        | 31/236 [01:43<07:48,  2.28s/it]
test ppl:  14%|█▎        | 32/236 [01:46<08:21,  2.46s/it]
test ppl:  14%|█▍        | 33/236 [01:52<11:46,  3.48s/it]
test ppl:  14%|█▍        | 34/236 [01:56<12:13,  3.63s/it]
test ppl:  15%|█▍        | 35/236 [01:59<11:02,  3.30s/it]
test ppl:  15%|█▌        | 36/236 [02:04<13:31,  4.06s/it]
test ppl:  16%|█▌        | 37/236 [02:10<15:15,  4.60s/it]
test ppl:  16%|█▌        | 38/236 [02:12<12:40,  3.84s/it]
test ppl:  17%|█▋        | 39/236 [02:14<10:18,  3.14s/it]
test ppl:  17%|█▋        | 40/236 [02:16<09:48,  3.00s/it]
test ppl:  17%|█▋        | 41/236 [02:19<09:16,  2.85s/it]
test ppl:  18%|█▊        | 42/236 [02:25<12:10,  3.77s/it]
test ppl:  18%|█▊        | 43/236 [02:31<14:07,  4.39s/it]
test ppl:  19%|█▊        | 44/236 [02:33<12:03,  3.77s/it]
test ppl:  19%|█▉        | 45/236 [02:35<10:15,  3.22s/it]
test ppl:  19%|█▉        | 46/236 [02:41<12:43,  4.02s/it]
test ppl:  20%|█▉        | 47/236 [02:47<14:25,  4.58s/it]
test ppl:  20%|██        | 48/236 [02:53<15:31,  4.96s/it]
test ppl:  21%|██        | 49/236 [02:58<15:35,  5.00s/it]
test ppl:  21%|██        | 50/236 [03:04<16:20,  5.27s/it]
test ppl:  22%|██▏       | 51/236 [03:09<16:48,  5.45s/it]
test ppl:  22%|██▏       | 52/236 [03:15<17:06,  5.58s/it]
test ppl:  22%|██▏       | 53/236 [03:21<16:50,  5.52s/it]
test ppl:  23%|██▎       | 54/236 [03:22<13:07,  4.33s/it]
test ppl:  23%|██▎       | 55/236 [03:28<14:13,  4.72s/it]
test ppl:  24%|██▎       | 56/236 [03:31<12:57,  4.32s/it]
test ppl:  24%|██▍       | 57/236 [03:34<11:18,  3.79s/it]
test ppl:  25%|██▍       | 58/236 [03:35<09:14,  3.12s/it]
test ppl:  25%|██▌       | 59/236 [03:41<11:36,  3.93s/it]
test ppl:  25%|██▌       | 60/236 [03:44<10:53,  3.71s/it]
test ppl:  26%|██▌       | 61/236 [03:50<12:42,  4.36s/it]
test ppl:  26%|██▋       | 62/236 [03:54<12:24,  4.28s/it]
test ppl:  27%|██▋       | 63/236 [03:57<10:46,  3.74s/it]
test ppl:  27%|██▋       | 64/236 [03:58<08:48,  3.07s/it]
test ppl:  28%|██▊       | 65/236 [04:00<07:15,  2.55s/it]
test ppl:  28%|██▊       | 66/236 [04:03<07:34,  2.67s/it]
test ppl:  28%|██▊       | 67/236 [04:09<10:12,  3.63s/it]
test ppl:  29%|██▉       | 68/236 [04:14<12:02,  4.30s/it]
test ppl:  29%|██▉       | 69/236 [04:20<13:15,  4.77s/it]
test ppl:  30%|██▉       | 70/236 [04:22<10:32,  3.81s/it]
test ppl:  30%|███       | 71/236 [04:25<10:17,  3.74s/it]
test ppl:  31%|███       | 72/236 [04:29<10:16,  3.76s/it]
test ppl:  31%|███       | 73/236 [04:33<10:16,  3.78s/it]
test ppl:  31%|███▏      | 74/236 [04:35<08:21,  3.10s/it]
test ppl:  32%|███▏      | 75/236 [04:40<10:32,  3.93s/it]
test ppl:  32%|███▏      | 76/236 [04:43<09:02,  3.39s/it]
test ppl:  33%|███▎      | 77/236 [04:45<08:07,  3.06s/it]
test ppl:  33%|███▎      | 78/236 [04:47<07:10,  2.72s/it]
test ppl:  33%|███▎      | 79/236 [04:52<08:55,  3.41s/it]
test ppl:  34%|███▍      | 80/236 [04:54<07:42,  2.97s/it]
test ppl:  34%|███▍      | 81/236 [05:00<09:53,  3.83s/it]
test ppl:  35%|███▍      | 82/236 [05:05<11:24,  4.45s/it]
test ppl:  35%|███▌      | 83/236 [05:07<09:27,  3.71s/it]
test ppl:  36%|███▌      | 84/236 [05:09<08:00,  3.16s/it]
test ppl:  36%|███▌      | 85/236 [05:13<08:40,  3.44s/it]
test ppl:  36%|███▋      | 86/236 [05:16<07:39,  3.06s/it]
test ppl:  37%|███▋      | 87/236 [05:18<06:52,  2.77s/it]
test ppl:  37%|███▋      | 88/236 [05:24<09:06,  3.69s/it]
test ppl:  38%|███▊      | 89/236 [05:29<10:37,  4.34s/it]
test ppl:  38%|███▊      | 90/236 [05:35<11:40,  4.80s/it]
test ppl:  39%|███▊      | 91/236 [05:40<11:37,  4.81s/it]
test ppl:  39%|███▉      | 92/236 [05:43<10:05,  4.21s/it]
test ppl:  39%|███▉      | 93/236 [05:49<11:10,  4.69s/it]
test ppl:  40%|███▉      | 94/236 [05:55<11:55,  5.04s/it]
test ppl:  40%|████      | 95/236 [05:59<11:25,  4.86s/it]
test ppl:  41%|████      | 96/236 [06:02<10:00,  4.29s/it]
test ppl:  41%|████      | 97/236 [06:08<11:00,  4.75s/it]
test ppl:  42%|████▏     | 98/236 [06:14<11:41,  5.08s/it]
test ppl:  42%|████▏     | 99/236 [06:20<12:07,  5.31s/it]
test ppl:  42%|████▏     | 100/236 [06:21<09:19,  4.12s/it]
test ppl:  43%|████▎     | 101/236 [06:27<10:25,  4.63s/it]
test ppl:  43%|████▎     | 102/236 [06:30<09:39,  4.33s/it]
test ppl:  44%|████▎     | 103/236 [06:32<08:06,  3.66s/it]
test ppl:  44%|████▍     | 104/236 [06:37<08:26,  3.84s/it]
test ppl:  44%|████▍     | 105/236 [06:41<08:24,  3.85s/it]
test ppl:  45%|████▍     | 106/236 [06:46<09:20,  4.31s/it]
test ppl:  45%|████▌     | 107/236 [06:48<07:48,  3.63s/it]
test ppl:  46%|████▌     | 108/236 [06:54<09:03,  4.24s/it]
test ppl:  46%|████▌     | 109/236 [06:58<09:15,  4.37s/it]
test ppl:  47%|████▋     | 110/236 [07:00<07:33,  3.60s/it]
test ppl:  47%|████▋     | 111/236 [07:04<07:41,  3.70s/it]
test ppl:  47%|████▋     | 112/236 [07:07<07:03,  3.42s/it]
test ppl:  48%|████▊     | 113/236 [07:09<05:58,  2.92s/it]
test ppl:  48%|████▊     | 114/236 [07:12<06:10,  3.04s/it]
test ppl:  49%|████▊     | 115/236 [07:18<07:49,  3.88s/it]
test ppl:  49%|████▉     | 116/236 [07:23<08:44,  4.37s/it]
test ppl:  50%|████▉     | 117/236 [07:25<07:09,  3.61s/it]
test ppl:  50%|█████     | 118/236 [07:29<07:24,  3.77s/it]
test ppl:  50%|█████     | 119/236 [07:32<07:03,  3.62s/it]
test ppl:  51%|█████     | 120/236 [07:34<05:40,  2.93s/it]
test ppl:  51%|█████▏    | 121/236 [07:40<07:17,  3.80s/it]
test ppl:  52%|█████▏    | 122/236 [07:44<07:46,  4.09s/it]
test ppl:  52%|█████▏    | 123/236 [07:47<06:36,  3.51s/it]
test ppl:  53%|█████▎    | 124/236 [07:49<06:07,  3.28s/it]
test ppl:  53%|█████▎    | 125/236 [07:52<05:37,  3.04s/it]
test ppl:  53%|█████▎    | 126/236 [07:55<05:55,  3.23s/it]
test ppl:  54%|█████▍    | 127/236 [07:57<05:07,  2.82s/it]
test ppl:  54%|█████▍    | 128/236 [08:00<04:46,  2.65s/it]
test ppl:  55%|█████▍    | 129/236 [08:03<04:53,  2.74s/it]
test ppl:  55%|█████▌    | 130/236 [08:06<04:59,  2.82s/it]
test ppl:  56%|█████▌    | 131/236 [08:11<06:31,  3.73s/it]
test ppl:  56%|█████▌    | 132/236 [08:14<05:48,  3.35s/it]
test ppl:  56%|█████▋    | 133/236 [08:18<06:01,  3.51s/it]
test ppl:  57%|█████▋    | 134/236 [08:23<07:00,  4.12s/it]
test ppl:  57%|█████▋    | 135/236 [08:29<07:47,  4.63s/it]
test ppl:  58%|█████▊    | 136/236 [08:30<06:00,  3.61s/it]
test ppl:  58%|█████▊    | 137/236 [08:36<07:04,  4.29s/it]
test ppl:  58%|█████▊    | 138/236 [08:39<06:27,  3.96s/it]
test ppl:  59%|█████▉    | 139/236 [08:42<05:43,  3.54s/it]
test ppl:  59%|█████▉    | 140/236 [08:44<04:47,  2.99s/it]
test ppl:  60%|█████▉    | 141/236 [08:47<04:40,  2.95s/it]
test ppl:  60%|██████    | 142/236 [08:49<04:13,  2.70s/it]
test ppl:  61%|██████    | 143/236 [08:54<05:39,  3.65s/it]
test ppl:  61%|██████    | 144/236 [08:57<05:10,  3.37s/it]
test ppl:  61%|██████▏   | 145/236 [09:03<06:03,  4.00s/it]
test ppl:  62%|██████▏   | 146/236 [09:07<06:12,  4.14s/it]
test ppl:  62%|██████▏   | 147/236 [09:13<06:54,  4.65s/it]
test ppl:  63%|██████▎   | 148/236 [09:19<07:23,  5.04s/it]
test ppl:  63%|██████▎   | 149/236 [09:22<06:33,  4.53s/it]
test ppl:  64%|██████▎   | 150/236 [09:26<06:15,  4.36s/it]
test ppl:  64%|██████▍   | 151/236 [09:32<06:48,  4.80s/it]
test ppl:  64%|██████▍   | 152/236 [09:38<07:09,  5.11s/it]
test ppl:  65%|██████▍   | 153/236 [09:44<07:21,  5.32s/it]
test ppl:  65%|██████▌   | 154/236 [09:46<06:07,  4.48s/it]
test ppl:  66%|██████▌   | 155/236 [09:49<05:18,  3.93s/it]
test ppl:  66%|██████▌   | 156/236 [09:51<04:32,  3.40s/it]
test ppl:  67%|██████▋   | 157/236 [09:53<04:00,  3.04s/it]
test ppl:  67%|██████▋   | 158/236 [09:59<05:02,  3.88s/it]
test ppl:  67%|██████▋   | 159/236 [10:05<05:43,  4.46s/it]
test ppl:  68%|██████▊   | 160/236 [10:06<04:24,  3.47s/it]
test ppl:  68%|██████▊   | 161/236 [10:07<03:33,  2.84s/it]
test ppl:  69%|██████▊   | 162/236 [10:11<03:36,  2.92s/it]
test ppl:  69%|██████▉   | 163/236 [10:13<03:24,  2.80s/it]
test ppl:  69%|██████▉   | 164/236 [10:17<03:53,  3.24s/it]
test ppl:  70%|██████▉   | 165/236 [10:22<04:11,  3.54s/it]
test ppl:  70%|███████   | 166/236 [10:25<04:02,  3.47s/it]
test ppl:  71%|███████   | 167/236 [10:26<03:18,  2.87s/it]
test ppl:  71%|███████   | 168/236 [10:32<04:15,  3.76s/it]
test ppl:  72%|███████▏  | 169/236 [10:38<04:44,  4.25s/it]
test ppl:  72%|███████▏  | 170/236 [10:43<05:12,  4.73s/it]
test ppl:  72%|███████▏  | 171/236 [10:45<04:01,  3.71s/it]
test ppl:  73%|███████▎  | 172/236 [10:47<03:30,  3.29s/it]
test ppl:  73%|███████▎  | 173/236 [10:51<03:33,  3.39s/it]
test ppl:  74%|███████▎  | 174/236 [10:55<03:39,  3.54s/it]
test ppl:  74%|███████▍  | 175/236 [10:56<03:04,  3.03s/it]
test ppl:  75%|███████▍  | 176/236 [11:01<03:34,  3.57s/it]
test ppl:  75%|███████▌  | 177/236 [11:07<04:11,  4.26s/it]
test ppl:  75%|███████▌  | 178/236 [11:13<04:35,  4.75s/it]
test ppl:  76%|███████▌  | 179/236 [11:19<04:49,  5.08s/it]
test ppl:  76%|███████▋  | 180/236 [11:23<04:36,  4.93s/it]
test ppl:  77%|███████▋  | 181/236 [11:29<04:46,  5.20s/it]
test ppl:  77%|███████▋  | 182/236 [11:31<03:47,  4.21s/it]
test ppl:  78%|███████▊  | 183/236 [11:33<03:12,  3.63s/it]
test ppl:  78%|███████▊  | 184/236 [11:35<02:34,  2.97s/it]
test ppl:  78%|███████▊  | 185/236 [11:39<02:52,  3.39s/it]
test ppl:  79%|███████▉  | 186/236 [11:45<03:26,  4.13s/it]
test ppl:  79%|███████▉  | 187/236 [11:51<03:48,  4.67s/it]
test ppl:  80%|███████▉  | 188/236 [11:57<04:01,  5.03s/it]
test ppl:  80%|████████  | 189/236 [12:03<04:07,  5.28s/it]
test ppl:  81%|████████  | 190/236 [12:06<03:40,  4.79s/it]
test ppl:  81%|████████  | 191/236 [12:11<03:28,  4.64s/it]
test ppl:  81%|████████▏ | 192/236 [12:13<02:57,  4.03s/it]
test ppl:  82%|████████▏ | 193/236 [12:19<03:16,  4.58s/it]
test ppl:  82%|████████▏ | 194/236 [12:22<02:47,  3.98s/it]
test ppl:  83%|████████▎ | 195/236 [12:25<02:31,  3.70s/it]
test ppl:  83%|████████▎ | 196/236 [12:27<02:07,  3.19s/it]
test ppl:  83%|████████▎ | 197/236 [12:29<01:56,  3.00s/it]
test ppl:  84%|████████▍ | 198/236 [12:35<02:26,  3.85s/it]
test ppl:  84%|████████▍ | 199/236 [12:38<02:09,  3.50s/it]
test ppl:  85%|████████▍ | 200/236 [12:44<02:30,  4.19s/it]
test ppl:  85%|████████▌ | 201/236 [12:46<02:03,  3.54s/it]
test ppl:  86%|████████▌ | 202/236 [12:50<02:11,  3.86s/it]
test ppl:  86%|████████▌ | 203/236 [12:56<02:23,  4.35s/it]
test ppl:  86%|████████▋ | 204/236 [12:57<01:51,  3.49s/it]
test ppl:  87%|████████▋ | 205/236 [13:03<02:10,  4.21s/it]
test ppl:  87%|████████▋ | 206/236 [13:06<01:57,  3.93s/it]
test ppl:  88%|████████▊ | 207/236 [13:12<02:10,  4.51s/it]
test ppl:  88%|████████▊ | 208/236 [13:15<01:54,  4.09s/it]
test ppl:  89%|████████▊ | 209/236 [13:21<02:05,  4.64s/it]
test ppl:  89%|████████▉ | 210/236 [13:24<01:42,  3.95s/it]
test ppl:  89%|████████▉ | 211/236 [13:28<01:44,  4.20s/it]
test ppl:  90%|████████▉ | 212/236 [13:33<01:44,  4.37s/it]
test ppl:  90%|█████████ | 213/236 [13:39<01:50,  4.80s/it]
test ppl:  91%|█████████ | 214/236 [13:41<01:24,  3.86s/it]
test ppl:  91%|█████████ | 215/236 [13:47<01:33,  4.45s/it]
test ppl:  92%|█████████▏| 216/236 [13:49<01:17,  3.87s/it]
test ppl:  92%|█████████▏| 217/236 [13:55<01:25,  4.49s/it]
test ppl:  92%|█████████▏| 218/236 [13:57<01:06,  3.72s/it]
test ppl:  93%|█████████▎| 219/236 [14:03<01:14,  4.36s/it]
test ppl:  93%|█████████▎| 220/236 [14:09<01:16,  4.80s/it]
test ppl:  94%|█████████▎| 221/236 [14:13<01:08,  4.54s/it]
test ppl:  94%|█████████▍| 222/236 [14:18<01:09,  4.93s/it]
test ppl:  94%|█████████▍| 223/236 [14:24<01:07,  5.21s/it]
test ppl:  95%|█████████▍| 224/236 [14:26<00:48,  4.03s/it]
test ppl:  95%|█████████▌| 225/236 [14:31<00:50,  4.56s/it]
test ppl:  96%|█████████▌| 226/236 [14:35<00:42,  4.25s/it]
test ppl:  96%|█████████▌| 227/236 [14:37<00:33,  3.69s/it]
test ppl:  97%|█████████▋| 228/236 [14:39<00:25,  3.18s/it]
test ppl:  97%|█████████▋| 229/236 [14:45<00:27,  3.97s/it]
test ppl:  97%|█████████▋| 230/236 [14:49<00:22,  3.83s/it]
test ppl:  98%|█████████▊| 231/236 [14:52<00:18,  3.67s/it]
test ppl:  98%|█████████▊| 232/236 [14:54<00:12,  3.09s/it]
test ppl:  99%|█████████▊| 233/236 [14:56<00:08,  2.81s/it]
test ppl:  99%|█████████▉| 234/236 [14:57<00:04,  2.33s/it]
test ppl: 100%|█████████▉| 235/236 [15:03<00:03,  3.38s/it]
test ppl: 100%|██████████| 236/236 [15:03<00:00,  2.56s/it]
test ppl: 100%|██████████| 236/236 [15:03<00:00,  3.83s/it]
10/12/2024 12:39:44 - INFO - __main__ -    em: 0.2109
10/12/2024 12:39:44 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.2 40:  em: 0.2109

--------------------------------------------------------------------------------
Running experiment with knn_temp=40, lmbda=0.2, k=64
2024-10-12 12:39:51.383205: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 12:39:51.402765: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 12:39:51.424522: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 12:39:51.431157: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 12:39:51.447211: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 12:39:52.438257: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 12:39:53 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.2, knn_temp=40, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 12:39:53 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:46:00,  2.19it/s]
Adding feature api:   4%|▍         | 7217/187062 [00:00<00:10, 17175.12it/s]
Adding feature api:   8%|▊         | 15541/187062 [00:00<00:05, 33936.79it/s]
Adding feature api:  13%|█▎        | 23881/187062 [00:00<00:03, 47094.28it/s]
Adding feature api:  17%|█▋        | 32043/187062 [00:00<00:02, 56600.82it/s]
Adding feature api:  22%|██▏       | 40393/187062 [00:00<00:02, 64193.70it/s]
Adding feature api:  26%|██▌       | 48766/187062 [00:01<00:01, 69806.24it/s]
Adding feature api:  31%|███       | 57113/187062 [00:01<00:01, 73781.98it/s]
Adding feature api:  35%|███▍      | 65240/187062 [00:01<00:01, 75978.35it/s]
Adding feature api:  39%|███▉      | 73674/187062 [00:01<00:01, 78448.43it/s]
Adding feature api:  44%|████▍     | 82119/187062 [00:01<00:01, 80229.13it/s]
Adding feature api:  48%|████▊     | 90573/187062 [00:01<00:01, 81510.31it/s]
Adding feature api:  53%|█████▎    | 99046/187062 [00:01<00:01, 82470.59it/s]
Adding feature api:  57%|█████▋    | 107417/187062 [00:01<00:00, 82198.35it/s]
Adding feature api:  62%|██████▏   | 115802/187062 [00:01<00:00, 82689.33it/s]
Adding feature api:  66%|██████▋   | 124263/187062 [00:01<00:00, 83258.89it/s]
Adding feature api:  71%|███████   | 132679/187062 [00:02<00:00, 83527.22it/s]
Adding feature api:  75%|███████▌  | 141063/187062 [00:02<00:00, 82918.32it/s]
Adding feature api:  80%|███████▉  | 149533/187062 [00:02<00:00, 83446.88it/s]
Adding feature api:  84%|████████▍ | 157923/187062 [00:02<00:00, 83578.76it/s]
Adding feature api:  89%|████████▉ | 166316/187062 [00:02<00:00, 83680.77it/s]
Adding feature api:  93%|█████████▎| 174692/187062 [00:02<00:00, 83150.48it/s]
Adding feature api:  98%|█████████▊| 183014/187062 [00:02<00:00, 59345.12it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64031.09it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:34:05,  2.20it/s]
Adding feature datatype:   4%|▍         | 7104/187062 [00:00<00:10, 17014.27it/s]
Adding feature datatype:   8%|▊         | 15219/187062 [00:00<00:05, 33363.78it/s]
Adding feature datatype:  12%|█▏        | 22999/187062 [00:00<00:03, 45225.31it/s]
Adding feature datatype:  17%|█▋        | 31101/187062 [00:00<00:02, 55105.43it/s]
Adding feature datatype:  21%|██        | 39249/187062 [00:00<00:02, 62564.11it/s]
Adding feature datatype:  25%|██▌       | 47388/187062 [00:01<00:02, 67979.36it/s]
Adding feature datatype:  30%|██▉       | 55523/187062 [00:01<00:01, 71872.47it/s]
Adding feature datatype:  34%|███▍      | 63632/187062 [00:01<00:01, 74580.46it/s]
Adding feature datatype:  38%|███▊      | 71566/187062 [00:01<00:01, 75616.88it/s]
Adding feature datatype:  43%|████▎     | 79726/187062 [00:01<00:01, 77386.58it/s]
Adding feature datatype:  47%|████▋     | 87786/187062 [00:01<00:01, 78339.68it/s]
Adding feature datatype:  51%|█████     | 95856/187062 [00:01<00:01, 79042.49it/s]
Adding feature datatype:  56%|█████▌    | 103955/187062 [00:01<00:01, 79621.76it/s]
Adding feature datatype:  60%|█████▉    | 112000/187062 [00:01<00:00, 79160.08it/s]
Adding feature datatype:  64%|██████▍   | 120154/187062 [00:01<00:00, 79865.60it/s]
Adding feature datatype:  69%|██████▊   | 128283/187062 [00:02<00:00, 80288.88it/s]
Adding feature datatype:  73%|███████▎  | 136444/187062 [00:02<00:00, 80680.86it/s]
Adding feature datatype:  77%|███████▋  | 144642/187062 [00:02<00:00, 81066.63it/s]
Adding feature datatype:  82%|████████▏ | 152773/187062 [00:02<00:00, 81137.94it/s]
Adding feature datatype:  86%|████████▌ | 160898/187062 [00:02<00:00, 80017.56it/s]
Adding feature datatype:  90%|█████████ | 169033/187062 [00:02<00:00, 80411.08it/s]
Adding feature datatype:  95%|█████████▍| 177138/187062 [00:02<00:00, 80598.26it/s]
Adding feature datatype:  99%|█████████▉| 185204/187062 [00:02<00:00, 53586.74it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 62468.63it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:19:38,  2.23it/s]
Adding feature literal:   4%|▍         | 7025/187062 [00:00<00:10, 16956.90it/s]
Adding feature literal:   8%|▊         | 15034/187062 [00:00<00:05, 33144.92it/s]
Adding feature literal:  12%|█▏        | 23094/187062 [00:00<00:03, 45866.08it/s]
Adding feature literal:  17%|█▋        | 31136/187062 [00:00<00:02, 55433.52it/s]
Adding feature literal:  21%|██        | 39237/187062 [00:00<00:02, 62681.22it/s]
Adding feature literal:  25%|██▌       | 47313/187062 [00:01<00:02, 67889.23it/s]
Adding feature literal:  30%|██▉       | 55340/187062 [00:01<00:01, 71499.14it/s]
Adding feature literal:  34%|███▍      | 63420/187062 [00:01<00:01, 74234.09it/s]
Adding feature literal:  38%|███▊      | 71468/187062 [00:01<00:01, 76079.47it/s]
Adding feature literal:  43%|████▎     | 79559/187062 [00:01<00:01, 77512.92it/s]
Adding feature literal:  47%|████▋     | 87671/187062 [00:01<00:01, 78585.74it/s]
Adding feature literal:  51%|█████     | 95731/187062 [00:01<00:01, 79185.04it/s]
Adding feature literal:  55%|█████▌    | 103766/187062 [00:01<00:01, 79530.30it/s]
Adding feature literal:  60%|█████▉    | 111877/187062 [00:01<00:00, 80001.66it/s]
Adding feature literal:  64%|██████▍   | 119935/187062 [00:01<00:00, 80135.47it/s]
Adding feature literal:  68%|██████▊   | 127990/187062 [00:02<00:00, 80257.82it/s]
Adding feature literal:  73%|███████▎  | 136044/187062 [00:02<00:00, 80249.98it/s]
Adding feature literal:  77%|███████▋  | 144089/187062 [00:02<00:00, 80178.45it/s]
Adding feature literal:  81%|████████▏ | 152147/187062 [00:02<00:00, 80295.06it/s]
Adding feature literal:  86%|████████▌ | 160187/187062 [00:02<00:00, 80315.04it/s]
Adding feature literal:  90%|████████▉ | 168288/187062 [00:02<00:00, 80521.00it/s]
Adding feature literal:  94%|█████████▍| 176393/187062 [00:02<00:00, 80678.89it/s]
Adding feature literal:  99%|█████████▊| 184465/187062 [00:02<00:00, 54544.82it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 62555.50it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:23:30,  2.22it/s]
Adding feature operator:   4%|▎         | 6930/187062 [00:00<00:10, 16692.95it/s]
Adding feature operator:   8%|▊         | 15030/187062 [00:00<00:05, 33155.96it/s]
Adding feature operator:  12%|█▏        | 22911/187062 [00:00<00:03, 45378.25it/s]
Adding feature operator:  17%|█▋        | 31105/187062 [00:00<00:02, 55493.86it/s]
Adding feature operator:  21%|██        | 39240/187062 [00:00<00:02, 62817.59it/s]
Adding feature operator:  25%|██▌       | 47428/187062 [00:01<00:02, 68307.45it/s]
Adding feature operator:  30%|██▉       | 55618/187062 [00:01<00:01, 72269.77it/s]
Adding feature operator:  34%|███▍      | 63756/187062 [00:01<00:01, 74946.91it/s]
Adding feature operator:  38%|███▊      | 71923/187062 [00:01<00:01, 76932.91it/s]
Adding feature operator:  43%|████▎     | 80119/187062 [00:01<00:01, 78424.12it/s]
Adding feature operator:  47%|████▋     | 88297/187062 [00:01<00:01, 79422.68it/s]
Adding feature operator:  52%|█████▏    | 96529/187062 [00:01<00:01, 80285.03it/s]
Adding feature operator:  56%|█████▌    | 104721/187062 [00:01<00:01, 80771.61it/s]
Adding feature operator:  60%|██████    | 112929/187062 [00:01<00:00, 81161.40it/s]
Adding feature operator:  65%|██████▍   | 121159/187062 [00:01<00:00, 81498.86it/s]
Adding feature operator:  69%|██████▉   | 129400/187062 [00:02<00:00, 81769.03it/s]
Adding feature operator:  74%|███████▎  | 137606/187062 [00:02<00:00, 81822.41it/s]
Adding feature operator:  78%|███████▊  | 145813/187062 [00:02<00:00, 81896.12it/s]
Adding feature operator:  82%|████████▏ | 154017/187062 [00:02<00:00, 81846.14it/s]
Adding feature operator:  87%|████████▋ | 162212/187062 [00:02<00:00, 81776.16it/s]
Adding feature operator:  91%|█████████ | 170397/187062 [00:02<00:00, 81718.24it/s]
Adding feature operator:  95%|█████████▌| 178574/187062 [00:02<00:00, 77108.56it/s]
Adding feature operator: 100%|█████████▉| 186342/187062 [00:02<00:00, 52168.62it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63145.73it/s]
[2024-10-12 12:40:37,854] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 12:40:39 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 12:40:39 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:17, 381.04 examples/s]
Map:   1%|▏         | 86/6548 [00:00<00:30, 214.33 examples/s]
Map:   2%|▏         | 125/6548 [00:00<00:24, 257.85 examples/s]
Map:   3%|▎         | 172/6548 [00:00<00:20, 316.65 examples/s]
Map:   3%|▎         | 228/6548 [00:00<00:18, 332.99 examples/s]
Map:   4%|▍         | 267/6548 [00:00<00:18, 335.66 examples/s]
Map:   5%|▍         | 306/6548 [00:01<00:20, 302.91 examples/s]
Map:   5%|▌         | 346/6548 [00:01<00:19, 316.09 examples/s]
Map:   6%|▌         | 388/6548 [00:01<00:18, 339.82 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:16, 366.20 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:17, 341.85 examples/s]
Map:   8%|▊         | 532/6548 [00:01<00:16, 359.17 examples/s]
Map:   9%|▉         | 575/6548 [00:01<00:15, 373.32 examples/s]
Map:   9%|▉         | 614/6548 [00:01<00:15, 376.16 examples/s]
Map:  10%|█         | 661/6548 [00:01<00:17, 342.47 examples/s]
Map:  11%|█         | 707/6548 [00:02<00:15, 370.61 examples/s]
Map:  11%|█▏        | 749/6548 [00:02<00:15, 382.52 examples/s]
Map:  12%|█▏        | 802/6548 [00:02<00:13, 420.23 examples/s]
Map:  13%|█▎        | 863/6548 [00:02<00:13, 411.54 examples/s]
Map:  14%|█▍        | 906/6548 [00:02<00:14, 394.55 examples/s]
Map:  15%|█▍        | 957/6548 [00:02<00:14, 374.04 examples/s]
Map:  15%|█▌        | 998/6548 [00:02<00:16, 334.87 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:24, 222.12 examples/s]
Map:  16%|█▋        | 1076/6548 [00:03<00:22, 248.17 examples/s]
Map:  17%|█▋        | 1122/6548 [00:03<00:18, 288.23 examples/s]
Map:  18%|█▊        | 1162/6548 [00:03<00:17, 310.29 examples/s]
Map:  18%|█▊        | 1205/6548 [00:03<00:15, 335.16 examples/s]
Map:  19%|█▉        | 1261/6548 [00:03<00:15, 344.25 examples/s]
Map:  20%|█▉        | 1301/6548 [00:03<00:15, 349.58 examples/s]
Map:  21%|██        | 1350/6548 [00:04<00:15, 327.03 examples/s]
Map:  21%|██        | 1391/6548 [00:04<00:16, 304.97 examples/s]
Map:  22%|██▏       | 1430/6548 [00:04<00:15, 323.19 examples/s]
Map:  23%|██▎       | 1477/6548 [00:04<00:18, 274.58 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:17, 283.46 examples/s]
Map:  24%|██▎       | 1555/6548 [00:04<00:17, 281.04 examples/s]
Map:  24%|██▍       | 1596/6548 [00:04<00:17, 275.57 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:17, 272.88 examples/s]
Map:  26%|██▌       | 1694/6548 [00:05<00:17, 285.50 examples/s]
Map:  26%|██▋       | 1732/6548 [00:05<00:15, 302.94 examples/s]
Map:  27%|██▋       | 1776/6548 [00:05<00:14, 332.68 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 335.17 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 343.16 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 343.67 examples/s]
Map:  30%|██▉       | 1947/6548 [00:06<00:12, 357.03 examples/s]
Map:  30%|███       | 1991/6548 [00:06<00:12, 373.94 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:19, 226.31 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:17, 257.25 examples/s]
Map:  32%|███▏      | 2106/6548 [00:06<00:16, 273.22 examples/s]
Map:  33%|███▎      | 2141/6548 [00:06<00:16, 259.41 examples/s]
Map:  33%|███▎      | 2172/6548 [00:06<00:16, 265.08 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 278.23 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:15, 275.24 examples/s]
Map:  35%|███▌      | 2293/6548 [00:07<00:14, 287.11 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:13, 312.21 examples/s]
Map:  36%|███▋      | 2375/6548 [00:07<00:13, 312.70 examples/s]
Map:  37%|███▋      | 2418/6548 [00:07<00:12, 338.19 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:12, 325.96 examples/s]
Map:  38%|███▊      | 2495/6548 [00:07<00:12, 319.83 examples/s]
Map:  39%|███▉      | 2555/6548 [00:08<00:11, 344.67 examples/s]
Map:  40%|███▉      | 2601/6548 [00:08<00:10, 371.12 examples/s]
Map:  40%|████      | 2644/6548 [00:08<00:10, 385.02 examples/s]
Map:  41%|████      | 2700/6548 [00:08<00:10, 369.18 examples/s]
Map:  42%|████▏     | 2756/6548 [00:08<00:10, 352.84 examples/s]
Map:  43%|████▎     | 2801/6548 [00:08<00:11, 327.11 examples/s]
Map:  43%|████▎     | 2846/6548 [00:09<00:13, 280.01 examples/s]
Map:  44%|████▍     | 2880/6548 [00:09<00:12, 288.75 examples/s]
Map:  45%|████▍     | 2923/6548 [00:09<00:13, 261.97 examples/s]
Map:  45%|████▌     | 2957/6548 [00:09<00:13, 270.89 examples/s]
Map:  46%|████▌     | 2991/6548 [00:09<00:14, 242.35 examples/s]
Map:  46%|████▌     | 3026/6548 [00:10<00:21, 164.51 examples/s]
Map:  47%|████▋     | 3062/6548 [00:10<00:17, 194.08 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 211.02 examples/s]
Map:  48%|████▊     | 3133/6548 [00:10<00:13, 245.90 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:13, 247.42 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 245.06 examples/s]
Map:  49%|████▉     | 3238/6548 [00:10<00:12, 264.97 examples/s]
Map:  50%|████▉     | 3271/6548 [00:10<00:11, 278.89 examples/s]
Map:  50%|█████     | 3305/6548 [00:10<00:11, 287.57 examples/s]
Map:  51%|█████     | 3348/6548 [00:11<00:10, 309.99 examples/s]
Map:  52%|█████▏    | 3388/6548 [00:11<00:11, 282.75 examples/s]
Map:  52%|█████▏    | 3420/6548 [00:11<00:10, 284.81 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 271.02 examples/s]
Map:  53%|█████▎    | 3497/6548 [00:11<00:11, 267.13 examples/s]
Map:  54%|█████▍    | 3546/6548 [00:11<00:09, 315.74 examples/s]
Map:  55%|█████▍    | 3595/6548 [00:11<00:08, 357.18 examples/s]
Map:  56%|█████▌    | 3639/6548 [00:11<00:07, 372.00 examples/s]
Map:  57%|█████▋    | 3700/6548 [00:12<00:07, 379.61 examples/s]
Map:  57%|█████▋    | 3742/6548 [00:12<00:07, 387.43 examples/s]
Map:  58%|█████▊    | 3804/6548 [00:12<00:06, 395.18 examples/s]
Map:  59%|█████▉    | 3859/6548 [00:12<00:08, 334.30 examples/s]
Map:  60%|█████▉    | 3898/6548 [00:12<00:07, 341.41 examples/s]
Map:  60%|██████    | 3956/6548 [00:12<00:08, 316.56 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 238.86 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 289.77 examples/s]
Map:  63%|██████▎   | 4096/6548 [00:13<00:07, 314.29 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 325.60 examples/s]
Map:  64%|██████▍   | 4187/6548 [00:13<00:07, 311.82 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:07, 310.13 examples/s]
Map:  65%|██████▌   | 4278/6548 [00:13<00:06, 330.95 examples/s]
Map:  66%|██████▌   | 4318/6548 [00:14<00:06, 344.55 examples/s]
Map:  67%|██████▋   | 4374/6548 [00:14<00:06, 344.19 examples/s]
Map:  68%|██████▊   | 4432/6548 [00:14<00:05, 354.89 examples/s]
Map:  68%|██████▊   | 4483/6548 [00:14<00:06, 336.78 examples/s]
Map:  69%|██████▉   | 4526/6548 [00:14<00:06, 313.48 examples/s]
Map:  70%|██████▉   | 4563/6548 [00:14<00:06, 325.23 examples/s]
Map:  70%|███████   | 4610/6548 [00:14<00:06, 318.21 examples/s]
Map:  71%|███████   | 4658/6548 [00:15<00:05, 353.68 examples/s]
Map:  72%|███████▏  | 4715/6548 [00:15<00:05, 359.18 examples/s]
Map:  73%|███████▎  | 4753/6548 [00:15<00:04, 361.80 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 408.00 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 394.56 examples/s]
Map:  75%|███████▍  | 4903/6548 [00:15<00:04, 369.48 examples/s]
Map:  75%|███████▌  | 4942/6548 [00:15<00:04, 373.29 examples/s]
Map:  76%|███████▌  | 4984/6548 [00:15<00:04, 372.14 examples/s]
Map:  77%|███████▋  | 5038/6548 [00:16<00:06, 244.04 examples/s]
Map:  77%|███████▋  | 5069/6548 [00:16<00:05, 254.54 examples/s]
Map:  78%|███████▊  | 5101/6548 [00:16<00:05, 266.07 examples/s]
Map:  78%|███████▊  | 5133/6548 [00:16<00:05, 261.05 examples/s]
Map:  79%|███████▉  | 5174/6548 [00:16<00:04, 287.67 examples/s]
Map:  80%|███████▉  | 5207/6548 [00:16<00:04, 279.75 examples/s]
Map:  80%|████████  | 5247/6548 [00:16<00:04, 305.53 examples/s]
Map:  81%|████████  | 5286/6548 [00:17<00:03, 324.78 examples/s]
Map:  81%|████████▏ | 5322/6548 [00:17<00:03, 333.23 examples/s]
Map:  82%|████████▏ | 5360/6548 [00:17<00:04, 296.22 examples/s]
Map:  82%|████████▏ | 5392/6548 [00:17<00:04, 288.72 examples/s]
Map:  83%|████████▎ | 5423/6548 [00:17<00:03, 288.04 examples/s]
Map:  83%|████████▎ | 5463/6548 [00:17<00:03, 316.63 examples/s]
Map:  84%|████████▍ | 5500/6548 [00:17<00:03, 327.55 examples/s]
Map:  85%|████████▍ | 5534/6548 [00:17<00:03, 323.40 examples/s]
Map:  85%|████████▌ | 5572/6548 [00:17<00:03, 319.54 examples/s]
Map:  86%|████████▌ | 5610/6548 [00:18<00:02, 324.38 examples/s]
Map:  86%|████████▌ | 5647/6548 [00:18<00:02, 333.41 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 314.37 examples/s]
Map:  87%|████████▋ | 5720/6548 [00:18<00:02, 334.06 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 351.41 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 354.73 examples/s]
Map:  89%|████████▉ | 5845/6548 [00:18<00:02, 348.38 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:18<00:01, 353.70 examples/s]
Map:  90%|█████████ | 5921/6548 [00:18<00:01, 356.28 examples/s]
Map:  91%|█████████ | 5964/6548 [00:19<00:01, 325.89 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 216.44 examples/s]
Map:  92%|█████████▏| 6047/6548 [00:19<00:01, 257.73 examples/s]
Map:  93%|█████████▎| 6085/6548 [00:19<00:01, 277.86 examples/s]
Map:  94%|█████████▎| 6131/6548 [00:19<00:01, 276.50 examples/s]
Map:  94%|█████████▍| 6170/6548 [00:19<00:01, 299.83 examples/s]
Map:  95%|█████████▍| 6210/6548 [00:20<00:01, 321.96 examples/s]
Map:  96%|█████████▌| 6261/6548 [00:20<00:00, 325.56 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 340.49 examples/s]
Map:  97%|█████████▋| 6340/6548 [00:20<00:00, 347.07 examples/s]
Map:  98%|█████████▊| 6386/6548 [00:20<00:00, 367.82 examples/s]
Map:  98%|█████████▊| 6428/6548 [00:20<00:00, 376.91 examples/s]
Map:  99%|█████████▉| 6477/6548 [00:20<00:00, 403.94 examples/s]
Map: 100%|█████████▉| 6538/6548 [00:20<00:00, 397.23 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 311.15 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 326.06 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 319.58 examples/s]
Map:  13%|█▎        | 118/903 [00:00<00:02, 303.30 examples/s]
Map:  17%|█▋        | 156/903 [00:00<00:02, 326.44 examples/s]
Map:  23%|██▎       | 206/903 [00:00<00:01, 373.12 examples/s]
Map:  27%|██▋       | 245/903 [00:00<00:01, 374.84 examples/s]
Map:  31%|███▏      | 284/903 [00:00<00:01, 361.74 examples/s]
Map:  37%|███▋      | 336/903 [00:00<00:01, 352.13 examples/s]
Map:  42%|████▏     | 378/903 [00:01<00:01, 296.63 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 300.99 examples/s]
Map:  51%|█████     | 460/903 [00:01<00:01, 302.45 examples/s]
Map:  57%|█████▋    | 516/903 [00:01<00:01, 320.67 examples/s]
Map:  62%|██████▏   | 561/903 [00:01<00:00, 345.67 examples/s]
Map:  68%|██████▊   | 611/903 [00:01<00:00, 383.10 examples/s]
Map:  74%|███████▎  | 665/903 [00:01<00:00, 364.63 examples/s]
Map:  78%|███████▊  | 706/903 [00:02<00:00, 372.63 examples/s]
Map:  84%|████████▎ | 756/903 [00:02<00:00, 403.98 examples/s]
Map:  90%|████████▉ | 811/903 [00:02<00:00, 383.59 examples/s]
Map:  95%|█████████▌| 862/903 [00:02<00:00, 389.46 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 230.63 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 319.54 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 265.64 examples/s]
Map:   4%|▍         | 82/1882 [00:00<00:05, 349.59 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 337.69 examples/s]
Map:   9%|▉         | 172/1882 [00:00<00:05, 340.58 examples/s]
Map:  12%|█▏        | 231/1882 [00:00<00:04, 353.49 examples/s]
Map:  15%|█▍        | 273/1882 [00:00<00:04, 369.16 examples/s]
Map:  18%|█▊        | 332/1882 [00:00<00:04, 370.95 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:04, 324.68 examples/s]
Map:  22%|██▏       | 417/1882 [00:01<00:04, 307.38 examples/s]
Map:  24%|██▍       | 449/1882 [00:01<00:04, 303.01 examples/s]
Map:  26%|██▋       | 496/1882 [00:01<00:04, 342.43 examples/s]
Map:  29%|██▉       | 544/1882 [00:01<00:04, 320.15 examples/s]
Map:  31%|███       | 587/1882 [00:01<00:03, 345.04 examples/s]
Map:  34%|███▍      | 644/1882 [00:01<00:03, 396.85 examples/s]
Map:  37%|███▋      | 704/1882 [00:02<00:03, 385.53 examples/s]
Map:  41%|████      | 768/1882 [00:02<00:02, 393.01 examples/s]
Map:  43%|████▎     | 811/1882 [00:02<00:02, 358.27 examples/s]
Map:  45%|████▌     | 853/1882 [00:02<00:02, 359.50 examples/s]
Map:  48%|████▊     | 897/1882 [00:02<00:02, 373.95 examples/s]
Map:  50%|████▉     | 940/1882 [00:02<00:02, 384.85 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 395.24 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 251.69 examples/s]
Map:  58%|█████▊    | 1085/1882 [00:03<00:03, 263.98 examples/s]
Map:  60%|█████▉    | 1126/1882 [00:03<00:02, 263.07 examples/s]
Map:  61%|██████▏   | 1156/1882 [00:03<00:02, 269.18 examples/s]
Map:  63%|██████▎   | 1189/1882 [00:03<00:02, 252.69 examples/s]
Map:  65%|██████▌   | 1228/1882 [00:03<00:02, 281.05 examples/s]
Map:  68%|██████▊   | 1280/1882 [00:03<00:02, 297.97 examples/s]
Map:  71%|███████   | 1334/1882 [00:04<00:01, 342.70 examples/s]
Map:  73%|███████▎  | 1381/1882 [00:04<00:01, 329.39 examples/s]
Map:  76%|███████▌  | 1425/1882 [00:04<00:01, 308.78 examples/s]
Map:  78%|███████▊  | 1462/1882 [00:04<00:01, 320.93 examples/s]
Map:  80%|███████▉  | 1503/1882 [00:04<00:01, 263.68 examples/s]
Map:  81%|████████▏ | 1533/1882 [00:04<00:01, 270.88 examples/s]
Map:  83%|████████▎ | 1565/1882 [00:04<00:01, 281.39 examples/s]
Map:  86%|████████▌ | 1614/1882 [00:05<00:00, 332.50 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 321.20 examples/s]
Map:  91%|█████████ | 1716/1882 [00:05<00:00, 327.66 examples/s]
Map:  93%|█████████▎| 1757/1882 [00:05<00:00, 267.13 examples/s]
Map:  95%|█████████▍| 1787/1882 [00:05<00:00, 271.08 examples/s]
Map:  97%|█████████▋| 1834/1882 [00:05<00:00, 314.74 examples/s]
Map: 100%|█████████▉| 1877/1882 [00:05<00:00, 340.19 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 309.07 examples/s]
10/12/2024 12:41:41 - INFO - __main__ -     ***** Testing *****
10/12/2024 12:41:41 - INFO - __main__ -     Batch size = 8
10/12/2024 12:41:41 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 12:41:42 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 12:41:42 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 12:41:43 - INFO - knnlm -   Reading datastore took 0.9107494354248047 s
10/12/2024 12:41:43 - INFO - knnlm -   Moving index to GPU took 0.9128482341766357 s
10/12/2024 12:41:43 - INFO - __main__ -   ******************************break-into
10/12/2024 12:41:43 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 12:41:43 - INFO - __main__ -     Num examples = 236
10/12/2024 12:41:43 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:56,  7.65s/it]
test ppl:   1%|          | 2/236 [00:09<16:46,  4.30s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:50,  3.05s/it]
test ppl:   2%|▏         | 4/236 [00:12<09:40,  2.50s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:28,  3.76s/it]
test ppl:   3%|▎         | 6/236 [00:21<12:35,  3.28s/it]
test ppl:   3%|▎         | 7/236 [00:23<11:41,  3.06s/it]
test ppl:   3%|▎         | 8/236 [00:28<13:15,  3.49s/it]
test ppl:   4%|▍         | 9/236 [00:34<16:10,  4.27s/it]
test ppl:   4%|▍         | 10/236 [00:37<14:43,  3.91s/it]
test ppl:   5%|▍         | 11/236 [00:39<12:54,  3.44s/it]
test ppl:   5%|▌         | 12/236 [00:45<15:45,  4.22s/it]
test ppl:   6%|▌         | 13/236 [00:51<17:39,  4.75s/it]
test ppl:   6%|▌         | 14/236 [00:57<19:01,  5.14s/it]
test ppl:   6%|▋         | 15/236 [00:59<15:31,  4.22s/it]
test ppl:   7%|▋         | 16/236 [01:01<12:54,  3.52s/it]
test ppl:   7%|▋         | 17/236 [01:07<15:32,  4.26s/it]
test ppl:   8%|▊         | 18/236 [01:09<12:41,  3.49s/it]
test ppl:   8%|▊         | 19/236 [01:13<13:44,  3.80s/it]
test ppl:   8%|▊         | 20/236 [01:15<11:31,  3.20s/it]
test ppl:   9%|▉         | 21/236 [01:17<10:31,  2.94s/it]
test ppl:   9%|▉         | 22/236 [01:23<13:45,  3.86s/it]
test ppl:  10%|▉         | 23/236 [01:26<12:22,  3.48s/it]
test ppl:  10%|█         | 24/236 [01:29<11:12,  3.17s/it]
test ppl:  11%|█         | 25/236 [01:30<09:47,  2.79s/it]
test ppl:  11%|█         | 26/236 [01:36<13:06,  3.75s/it]
test ppl:  11%|█▏        | 27/236 [01:41<13:34,  3.90s/it]
test ppl:  12%|█▏        | 28/236 [01:42<10:56,  3.16s/it]
test ppl:  12%|█▏        | 29/236 [01:44<10:04,  2.92s/it]
test ppl:  13%|█▎        | 30/236 [01:46<08:36,  2.51s/it]
test ppl:  13%|█▎        | 31/236 [01:49<09:01,  2.64s/it]
test ppl:  14%|█▎        | 32/236 [01:52<09:17,  2.73s/it]
test ppl:  14%|█▍        | 33/236 [01:58<12:38,  3.74s/it]
test ppl:  14%|█▍        | 34/236 [02:02<12:57,  3.85s/it]
test ppl:  15%|█▍        | 35/236 [02:05<11:37,  3.47s/it]
test ppl:  15%|█▌        | 36/236 [02:11<14:07,  4.24s/it]
test ppl:  16%|█▌        | 37/236 [02:17<15:50,  4.78s/it]
test ppl:  16%|█▌        | 38/236 [02:19<13:07,  3.98s/it]
test ppl:  17%|█▋        | 39/236 [02:20<10:38,  3.24s/it]
test ppl:  17%|█▋        | 40/236 [02:23<10:07,  3.10s/it]
test ppl:  17%|█▋        | 41/236 [02:26<09:33,  2.94s/it]
test ppl:  18%|█▊        | 42/236 [02:32<12:34,  3.89s/it]
test ppl:  18%|█▊        | 43/236 [02:38<14:32,  4.52s/it]
test ppl:  19%|█▊        | 44/236 [02:40<12:03,  3.77s/it]
test ppl:  19%|█▉        | 45/236 [02:42<10:18,  3.24s/it]
test ppl:  19%|█▉        | 46/236 [02:47<12:12,  3.85s/it]
test ppl:  20%|█▉        | 47/236 [02:53<14:12,  4.51s/it]
test ppl:  20%|██        | 48/236 [02:59<15:33,  4.97s/it]
test ppl:  21%|██        | 49/236 [03:03<13:57,  4.48s/it]
test ppl:  21%|██        | 50/236 [03:09<15:21,  4.95s/it]
test ppl:  22%|██▏       | 51/236 [03:15<16:17,  5.29s/it]
test ppl:  22%|██▏       | 52/236 [03:21<16:53,  5.51s/it]
test ppl:  22%|██▏       | 53/236 [03:26<16:51,  5.53s/it]
test ppl:  23%|██▎       | 54/236 [03:28<13:11,  4.35s/it]
test ppl:  23%|██▎       | 55/236 [03:34<14:24,  4.78s/it]
test ppl:  24%|██▎       | 56/236 [03:37<13:09,  4.39s/it]
test ppl:  24%|██▍       | 57/236 [03:40<11:31,  3.86s/it]
test ppl:  25%|██▍       | 58/236 [03:42<10:00,  3.37s/it]
test ppl:  25%|██▌       | 59/236 [03:48<12:19,  4.18s/it]
test ppl:  25%|██▌       | 60/236 [03:51<11:28,  3.91s/it]
test ppl:  26%|██▌       | 61/236 [03:57<13:14,  4.54s/it]
test ppl:  26%|██▋       | 62/236 [04:02<12:56,  4.46s/it]
test ppl:  27%|██▋       | 63/236 [04:04<11:11,  3.88s/it]
test ppl:  27%|██▋       | 64/236 [04:06<09:06,  3.18s/it]
test ppl:  28%|██▊       | 65/236 [04:07<07:30,  2.63s/it]
test ppl:  28%|██▊       | 66/236 [04:10<07:48,  2.75s/it]
test ppl:  28%|██▊       | 67/236 [04:14<08:52,  3.15s/it]
test ppl:  29%|██▉       | 68/236 [04:20<11:14,  4.01s/it]
test ppl:  29%|██▉       | 69/236 [04:26<12:52,  4.63s/it]
test ppl:  30%|██▉       | 70/236 [04:28<10:22,  3.75s/it]
test ppl:  30%|███       | 71/236 [04:32<10:14,  3.72s/it]
test ppl:  31%|███       | 72/236 [04:36<10:19,  3.78s/it]
test ppl:  31%|███       | 73/236 [04:39<10:23,  3.82s/it]
test ppl:  31%|███▏      | 74/236 [04:41<08:28,  3.14s/it]
test ppl:  32%|███▏      | 75/236 [04:47<10:44,  4.00s/it]
test ppl:  32%|███▏      | 76/236 [04:51<10:46,  4.04s/it]
test ppl:  33%|███▎      | 77/236 [04:53<09:20,  3.52s/it]
test ppl:  33%|███▎      | 78/236 [04:55<08:02,  3.06s/it]
test ppl:  33%|███▎      | 79/236 [05:01<09:40,  3.70s/it]
test ppl:  34%|███▍      | 80/236 [05:03<08:16,  3.18s/it]
test ppl:  34%|███▍      | 81/236 [05:09<10:24,  4.03s/it]
test ppl:  35%|███▍      | 82/236 [05:15<11:54,  4.64s/it]
test ppl:  35%|███▌      | 83/236 [05:17<09:50,  3.86s/it]
test ppl:  36%|███▌      | 84/236 [05:19<08:19,  3.29s/it]
test ppl:  36%|███▌      | 85/236 [05:24<10:09,  4.03s/it]
test ppl:  36%|███▋      | 86/236 [05:27<08:45,  3.51s/it]
test ppl:  37%|███▋      | 87/236 [05:29<07:40,  3.09s/it]
test ppl:  37%|███▋      | 88/236 [05:35<09:39,  3.92s/it]
test ppl:  38%|███▊      | 89/236 [05:41<11:00,  4.50s/it]
test ppl:  38%|███▊      | 90/236 [05:46<11:56,  4.91s/it]
test ppl:  39%|███▊      | 91/236 [05:52<12:32,  5.19s/it]
test ppl:  39%|███▉      | 92/236 [05:55<10:43,  4.47s/it]
test ppl:  39%|███▉      | 93/236 [06:01<11:38,  4.88s/it]
test ppl:  40%|███▉      | 94/236 [06:07<12:14,  5.17s/it]
test ppl:  40%|████      | 95/236 [06:10<10:52,  4.63s/it]
test ppl:  41%|████      | 96/236 [06:13<09:37,  4.12s/it]
test ppl:  41%|████      | 97/236 [06:19<10:45,  4.64s/it]
test ppl:  42%|████▏     | 98/236 [06:25<11:30,  5.01s/it]
test ppl:  42%|████▏     | 99/236 [06:31<12:02,  5.27s/it]
test ppl:  42%|████▏     | 100/236 [06:32<09:17,  4.10s/it]
test ppl:  43%|████▎     | 101/236 [06:38<10:30,  4.67s/it]
test ppl:  43%|████▎     | 102/236 [06:42<09:46,  4.38s/it]
test ppl:  44%|████▎     | 103/236 [06:44<08:14,  3.72s/it]
test ppl:  44%|████▍     | 104/236 [06:48<08:36,  3.91s/it]
test ppl:  44%|████▍     | 105/236 [06:52<08:36,  3.94s/it]
test ppl:  45%|████▍     | 106/236 [06:58<09:34,  4.42s/it]
test ppl:  45%|████▌     | 107/236 [07:00<08:00,  3.73s/it]
test ppl:  46%|████▌     | 108/236 [07:06<09:19,  4.37s/it]
test ppl:  46%|████▌     | 109/236 [07:11<09:31,  4.50s/it]
test ppl:  47%|████▋     | 110/236 [07:12<07:47,  3.71s/it]
test ppl:  47%|████▋     | 111/236 [07:16<07:55,  3.81s/it]
test ppl:  47%|████▋     | 112/236 [07:19<07:16,  3.52s/it]
test ppl:  48%|████▊     | 113/236 [07:21<06:08,  3.00s/it]
test ppl:  48%|████▊     | 114/236 [07:25<06:23,  3.14s/it]
test ppl:  49%|████▊     | 115/236 [07:31<08:05,  4.01s/it]
test ppl:  49%|████▉     | 116/236 [07:36<09:01,  4.51s/it]
test ppl:  50%|████▉     | 117/236 [07:38<07:23,  3.73s/it]
test ppl:  50%|█████     | 118/236 [07:43<07:46,  3.95s/it]
test ppl:  50%|█████     | 119/236 [07:46<07:21,  3.78s/it]
test ppl:  51%|█████     | 120/236 [07:47<05:53,  3.05s/it]
test ppl:  51%|█████▏    | 121/236 [07:52<06:41,  3.49s/it]
test ppl:  52%|█████▏    | 122/236 [07:57<07:24,  3.90s/it]
test ppl:  52%|█████▏    | 123/236 [07:59<06:24,  3.40s/it]
test ppl:  53%|█████▎    | 124/236 [08:02<06:02,  3.24s/it]
test ppl:  53%|█████▎    | 125/236 [08:06<06:19,  3.42s/it]
test ppl:  53%|█████▎    | 126/236 [08:09<06:27,  3.52s/it]
test ppl:  54%|█████▍    | 127/236 [08:11<05:31,  3.04s/it]
test ppl:  54%|█████▍    | 128/236 [08:14<05:04,  2.82s/it]
test ppl:  55%|█████▍    | 129/236 [08:17<05:08,  2.89s/it]
test ppl:  55%|█████▌    | 130/236 [08:21<05:58,  3.38s/it]
test ppl:  56%|█████▌    | 131/236 [08:27<07:18,  4.18s/it]
test ppl:  56%|█████▌    | 132/236 [08:30<06:24,  3.70s/it]
test ppl:  56%|█████▋    | 133/236 [08:34<06:30,  3.79s/it]
test ppl:  57%|█████▋    | 134/236 [08:40<07:24,  4.36s/it]
test ppl:  57%|█████▋    | 135/236 [08:45<07:37,  4.53s/it]
test ppl:  58%|█████▊    | 136/236 [08:46<05:53,  3.53s/it]
test ppl:  58%|█████▊    | 137/236 [08:52<07:01,  4.26s/it]
test ppl:  58%|█████▊    | 138/236 [08:55<06:26,  3.95s/it]
test ppl:  59%|█████▉    | 139/236 [08:57<05:42,  3.53s/it]
test ppl:  59%|█████▉    | 140/236 [09:00<04:57,  3.10s/it]
test ppl:  60%|█████▉    | 141/236 [09:02<04:48,  3.04s/it]
test ppl:  60%|██████    | 142/236 [09:05<04:19,  2.76s/it]
test ppl:  61%|██████    | 143/236 [09:10<05:43,  3.70s/it]
test ppl:  61%|██████    | 144/236 [09:13<05:13,  3.41s/it]
test ppl:  61%|██████▏   | 145/236 [09:19<06:07,  4.03s/it]
test ppl:  62%|██████▏   | 146/236 [09:23<06:15,  4.17s/it]
test ppl:  62%|██████▏   | 147/236 [09:29<06:56,  4.68s/it]
test ppl:  63%|██████▎   | 148/236 [09:35<07:26,  5.07s/it]
test ppl:  63%|██████▎   | 149/236 [09:38<06:36,  4.56s/it]
test ppl:  64%|██████▎   | 150/236 [09:42<06:19,  4.41s/it]
test ppl:  64%|██████▍   | 151/236 [09:48<06:51,  4.85s/it]
test ppl:  64%|██████▍   | 152/236 [09:54<07:12,  5.15s/it]
test ppl:  65%|██████▍   | 153/236 [10:00<07:25,  5.36s/it]
test ppl:  65%|██████▌   | 154/236 [10:03<06:09,  4.51s/it]
test ppl:  66%|██████▌   | 155/236 [10:05<05:18,  3.93s/it]
test ppl:  66%|██████▌   | 156/236 [10:07<04:32,  3.41s/it]
test ppl:  67%|██████▋   | 157/236 [10:09<04:00,  3.04s/it]
test ppl:  67%|██████▋   | 158/236 [10:15<05:03,  3.89s/it]
test ppl:  67%|██████▋   | 159/236 [10:21<05:44,  4.48s/it]
test ppl:  68%|██████▊   | 160/236 [10:22<04:25,  3.49s/it]
test ppl:  68%|██████▊   | 161/236 [10:24<03:33,  2.85s/it]
test ppl:  69%|██████▊   | 162/236 [10:27<03:31,  2.86s/it]
test ppl:  69%|██████▉   | 163/236 [10:29<03:21,  2.76s/it]
test ppl:  69%|██████▉   | 164/236 [10:35<04:26,  3.70s/it]
test ppl:  70%|██████▉   | 165/236 [10:39<04:34,  3.87s/it]
test ppl:  70%|███████   | 166/236 [10:43<04:19,  3.70s/it]
test ppl:  71%|███████   | 167/236 [10:44<03:29,  3.04s/it]
test ppl:  71%|███████   | 168/236 [10:50<04:23,  3.88s/it]
test ppl:  72%|███████▏  | 169/236 [10:55<04:50,  4.34s/it]
test ppl:  72%|███████▏  | 170/236 [11:01<05:17,  4.81s/it]
test ppl:  72%|███████▏  | 171/236 [11:03<04:04,  3.77s/it]
test ppl:  73%|███████▎  | 172/236 [11:05<03:32,  3.32s/it]
test ppl:  73%|███████▎  | 173/236 [11:08<03:32,  3.37s/it]
test ppl:  74%|███████▎  | 174/236 [11:14<04:15,  4.12s/it]
test ppl:  74%|███████▍  | 175/236 [11:16<03:29,  3.43s/it]
test ppl:  75%|███████▍  | 176/236 [11:21<03:51,  3.86s/it]
test ppl:  75%|███████▌  | 177/236 [11:27<04:23,  4.47s/it]
test ppl:  75%|███████▌  | 178/236 [11:33<04:44,  4.90s/it]
test ppl:  76%|███████▌  | 179/236 [11:39<04:56,  5.19s/it]
test ppl:  76%|███████▋  | 180/236 [11:43<04:40,  5.01s/it]
test ppl:  77%|███████▋  | 181/236 [11:49<04:49,  5.26s/it]
test ppl:  77%|███████▋  | 182/236 [11:51<03:49,  4.25s/it]
test ppl:  78%|███████▊  | 183/236 [11:53<03:14,  3.67s/it]
test ppl:  78%|███████▊  | 184/236 [11:55<02:37,  3.02s/it]
test ppl:  78%|███████▊  | 185/236 [11:59<02:57,  3.48s/it]
test ppl:  79%|███████▉  | 186/236 [12:05<03:32,  4.25s/it]
test ppl:  79%|███████▉  | 187/236 [12:11<03:55,  4.82s/it]
test ppl:  80%|███████▉  | 188/236 [12:17<04:07,  5.16s/it]
test ppl:  80%|████████  | 189/236 [12:23<04:12,  5.37s/it]
test ppl:  81%|████████  | 190/236 [12:27<03:46,  4.93s/it]
test ppl:  81%|████████  | 191/236 [12:32<03:33,  4.75s/it]
test ppl:  81%|████████▏ | 192/236 [12:34<03:00,  4.11s/it]
test ppl:  82%|████████▏ | 193/236 [12:40<03:19,  4.64s/it]
test ppl:  82%|████████▏ | 194/236 [12:43<02:49,  4.03s/it]
test ppl:  83%|████████▎ | 195/236 [12:46<02:33,  3.74s/it]
test ppl:  83%|████████▎ | 196/236 [12:48<02:08,  3.22s/it]
test ppl:  83%|████████▎ | 197/236 [12:50<01:57,  3.02s/it]
test ppl:  84%|████████▍ | 198/236 [12:56<02:27,  3.88s/it]
test ppl:  84%|████████▍ | 199/236 [12:59<02:10,  3.52s/it]
test ppl:  85%|████████▍ | 200/236 [13:05<02:32,  4.23s/it]
test ppl:  85%|████████▌ | 201/236 [13:07<02:04,  3.57s/it]
test ppl:  86%|████████▌ | 202/236 [13:11<02:11,  3.87s/it]
test ppl:  86%|████████▌ | 203/236 [13:17<02:27,  4.47s/it]
test ppl:  86%|████████▋ | 204/236 [13:19<01:54,  3.57s/it]
test ppl:  87%|████████▋ | 205/236 [13:25<02:12,  4.28s/it]
test ppl:  87%|████████▋ | 206/236 [13:28<01:59,  3.98s/it]
test ppl:  88%|████████▊ | 207/236 [13:34<02:11,  4.55s/it]
test ppl:  88%|████████▊ | 208/236 [13:37<01:55,  4.13s/it]
test ppl:  89%|████████▊ | 209/236 [13:43<02:06,  4.67s/it]
test ppl:  89%|████████▉ | 210/236 [13:45<01:43,  3.97s/it]
test ppl:  89%|████████▉ | 211/236 [13:50<01:45,  4.22s/it]
test ppl:  90%|████████▉ | 212/236 [13:55<01:45,  4.38s/it]
test ppl:  90%|█████████ | 213/236 [14:01<01:51,  4.83s/it]
test ppl:  91%|█████████ | 214/236 [14:02<01:25,  3.87s/it]
test ppl:  91%|█████████ | 215/236 [14:08<01:33,  4.47s/it]
test ppl:  92%|█████████▏| 216/236 [14:11<01:17,  3.90s/it]
test ppl:  92%|█████████▏| 217/236 [14:17<01:25,  4.52s/it]
test ppl:  92%|█████████▏| 218/236 [14:19<01:07,  3.75s/it]
test ppl:  93%|█████████▎| 219/236 [14:24<01:14,  4.40s/it]
test ppl:  93%|█████████▎| 220/236 [14:30<01:17,  4.84s/it]
test ppl:  94%|█████████▎| 221/236 [14:34<01:08,  4.58s/it]
test ppl:  94%|█████████▍| 222/236 [14:40<01:09,  4.98s/it]
test ppl:  94%|█████████▍| 223/236 [14:46<01:08,  5.25s/it]
test ppl:  95%|█████████▍| 224/236 [14:47<00:48,  4.06s/it]
test ppl:  95%|█████████▌| 225/236 [14:53<00:50,  4.59s/it]
test ppl:  96%|█████████▌| 226/236 [14:57<00:42,  4.28s/it]
test ppl:  96%|█████████▌| 227/236 [14:59<00:33,  3.69s/it]
test ppl:  97%|█████████▋| 228/236 [15:01<00:25,  3.19s/it]
test ppl:  97%|█████████▋| 229/236 [15:07<00:27,  3.99s/it]
test ppl:  97%|█████████▋| 230/236 [15:11<00:23,  3.85s/it]
test ppl:  98%|█████████▊| 231/236 [15:14<00:18,  3.69s/it]
test ppl:  98%|█████████▊| 232/236 [15:16<00:12,  3.11s/it]
test ppl:  99%|█████████▊| 233/236 [15:20<00:10,  3.40s/it]
test ppl:  99%|█████████▉| 234/236 [15:21<00:05,  2.75s/it]
test ppl: 100%|█████████▉| 235/236 [15:27<00:03,  3.68s/it]
test ppl: 100%|██████████| 236/236 [15:27<00:00,  2.77s/it]
test ppl: 100%|██████████| 236/236 [15:27<00:00,  3.93s/it]
10/12/2024 12:57:11 - INFO - __main__ -    em: 0.2109
10/12/2024 12:57:11 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.2 40:  em: 0.2109

--------------------------------------------------------------------------------
Running experiment with knn_temp=40, lmbda=0.4, k=16
2024-10-12 12:57:18.745221: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 12:57:18.764555: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 12:57:18.786224: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 12:57:18.792927: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 12:57:18.808826: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 12:57:19.798586: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 12:57:21 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.4, knn_temp=40, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 12:57:21 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:43:37,  2.19it/s]
Adding feature api:   4%|▍         | 7175/187062 [00:00<00:10, 17096.88it/s]
Adding feature api:   8%|▊         | 15109/187062 [00:00<00:05, 32903.24it/s]
Adding feature api:  12%|█▏        | 23357/187062 [00:00<00:03, 46100.20it/s]
Adding feature api:  17%|█▋        | 31563/187062 [00:00<00:02, 56006.53it/s]
Adding feature api:  21%|██▏       | 39872/187062 [00:00<00:02, 63654.60it/s]
Adding feature api:  26%|██▌       | 47909/187062 [00:01<00:02, 68458.77it/s]
Adding feature api:  30%|███       | 56193/187062 [00:01<00:01, 72642.41it/s]
Adding feature api:  34%|███▍      | 64414/187062 [00:01<00:01, 75451.77it/s]
Adding feature api:  39%|███▉      | 72687/187062 [00:01<00:01, 77602.38it/s]
Adding feature api:  43%|████▎     | 80974/187062 [00:01<00:01, 79165.39it/s]
Adding feature api:  48%|████▊     | 89135/187062 [00:01<00:01, 79657.14it/s]
Adding feature api:  52%|█████▏    | 97389/187062 [00:01<00:01, 80514.55it/s]
Adding feature api:  57%|█████▋    | 105706/187062 [00:01<00:01, 81305.79it/s]
Adding feature api:  61%|██████    | 114015/187062 [00:01<00:00, 81837.95it/s]
Adding feature api:  65%|██████▌   | 122259/187062 [00:01<00:00, 81406.55it/s]
Adding feature api:  70%|██████▉   | 130505/187062 [00:02<00:00, 81717.21it/s]
Adding feature api:  74%|███████▍  | 138796/187062 [00:02<00:00, 82070.91it/s]
Adding feature api:  79%|███████▊  | 147100/187062 [00:02<00:00, 82358.83it/s]
Adding feature api:  83%|████████▎ | 155351/187062 [00:02<00:00, 82066.94it/s]
Adding feature api:  88%|████████▊ | 163712/187062 [00:02<00:00, 82525.53it/s]
Adding feature api:  92%|█████████▏| 172045/187062 [00:02<00:00, 82762.69it/s]
Adding feature api:  96%|█████████▋| 180327/187062 [00:02<00:00, 70362.72it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 63360.13it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:29:42,  2.21it/s]
Adding feature datatype:   4%|▎         | 7014/187062 [00:00<00:10, 16838.77it/s]
Adding feature datatype:   8%|▊         | 14985/187062 [00:00<00:05, 32894.51it/s]
Adding feature datatype:  12%|█▏        | 23032/187062 [00:00<00:03, 45610.71it/s]
Adding feature datatype:  16%|█▋        | 30764/187062 [00:00<00:02, 54372.57it/s]
Adding feature datatype:  21%|██        | 38838/187062 [00:00<00:02, 61833.34it/s]
Adding feature datatype:  25%|██▌       | 46942/187062 [00:01<00:02, 67362.60it/s]
Adding feature datatype:  29%|██▉       | 55033/187062 [00:01<00:01, 71310.03it/s]
Adding feature datatype:  34%|███▎      | 63087/187062 [00:01<00:01, 74021.94it/s]
Adding feature datatype:  38%|███▊      | 71177/187062 [00:01<00:01, 76053.20it/s]
Adding feature datatype:  42%|████▏     | 79116/187062 [00:01<00:01, 76464.03it/s]
Adding feature datatype:  47%|████▋     | 87148/187062 [00:01<00:01, 77604.26it/s]
Adding feature datatype:  51%|█████     | 95282/187062 [00:01<00:01, 78712.45it/s]
Adding feature datatype:  55%|█████▌    | 103377/187062 [00:01<00:01, 79378.01it/s]
Adding feature datatype:  60%|█████▉    | 111501/187062 [00:01<00:00, 79931.38it/s]
Adding feature datatype:  64%|██████▍   | 119553/187062 [00:01<00:00, 79300.07it/s]
Adding feature datatype:  68%|██████▊   | 127634/187062 [00:02<00:00, 79745.80it/s]
Adding feature datatype:  73%|███████▎  | 135731/187062 [00:02<00:00, 80109.11it/s]
Adding feature datatype:  77%|███████▋  | 143899/187062 [00:02<00:00, 80576.64it/s]
Adding feature datatype:  81%|████████▏ | 152002/187062 [00:02<00:00, 80710.16it/s]
Adding feature datatype:  86%|████████▌ | 160085/187062 [00:02<00:00, 80743.18it/s]
Adding feature datatype:  90%|████████▉ | 168167/187062 [00:02<00:00, 79969.57it/s]
Adding feature datatype:  94%|█████████▍| 176239/187062 [00:02<00:00, 80190.29it/s]
Adding feature datatype:  99%|█████████▊| 184263/187062 [00:02<00:00, 55207.46it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 62397.47it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:15:34,  2.23it/s]
Adding feature literal:   4%|▍         | 7018/187062 [00:00<00:10, 16977.49it/s]
Adding feature literal:   8%|▊         | 15145/187062 [00:00<00:05, 33489.43it/s]
Adding feature literal:  12%|█▏        | 23208/187062 [00:00<00:03, 46142.46it/s]
Adding feature literal:  17%|█▋        | 31275/187062 [00:00<00:02, 55710.85it/s]
Adding feature literal:  21%|██        | 39357/187062 [00:00<00:02, 62831.43it/s]
Adding feature literal:  25%|██▌       | 47407/187062 [00:01<00:02, 67923.67it/s]
Adding feature literal:  30%|██▉       | 55513/187062 [00:01<00:01, 71752.99it/s]
Adding feature literal:  34%|███▍      | 63603/187062 [00:01<00:01, 74442.05it/s]
Adding feature literal:  38%|███▊      | 71734/187062 [00:01<00:01, 76471.61it/s]
Adding feature literal:  43%|████▎     | 79713/187062 [00:01<00:01, 76790.23it/s]
Adding feature literal:  47%|████▋     | 87623/187062 [00:01<00:01, 76240.40it/s]
Adding feature literal:  51%|█████     | 95775/187062 [00:01<00:01, 77790.54it/s]
Adding feature literal:  56%|█████▌    | 103905/187062 [00:01<00:01, 78826.84it/s]
Adding feature literal:  60%|█████▉    | 112081/187062 [00:01<00:00, 79696.77it/s]
Adding feature literal:  64%|██████▍   | 120173/187062 [00:01<00:00, 80060.44it/s]
Adding feature literal:  69%|██████▊   | 128279/187062 [00:02<00:00, 80355.59it/s]
Adding feature literal:  73%|███████▎  | 136375/187062 [00:02<00:00, 80535.21it/s]
Adding feature literal:  77%|███████▋  | 144469/187062 [00:02<00:00, 80655.68it/s]
Adding feature literal:  82%|████████▏ | 152563/187062 [00:02<00:00, 80740.22it/s]
Adding feature literal:  86%|████████▌ | 160708/187062 [00:02<00:00, 80951.13it/s]
Adding feature literal:  90%|█████████ | 168811/187062 [00:02<00:00, 80896.46it/s]
Adding feature literal:  95%|█████████▍| 176911/187062 [00:02<00:00, 80926.52it/s]
Adding feature literal:  99%|█████████▉| 185008/187062 [00:02<00:00, 53754.33it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 62565.06it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:23:06,  2.22it/s]
Adding feature operator:   4%|▎         | 7004/187062 [00:00<00:10, 16874.87it/s]
Adding feature operator:   8%|▊         | 15046/187062 [00:00<00:05, 33145.35it/s]
Adding feature operator:  12%|█▏        | 23085/187062 [00:00<00:03, 45797.55it/s]
Adding feature operator:  17%|█▋        | 30996/187062 [00:00<00:02, 55014.76it/s]
Adding feature operator:  21%|██        | 39006/187062 [00:00<00:02, 62120.98it/s]
Adding feature operator:  25%|██▌       | 47068/187062 [00:01<00:02, 67449.02it/s]
Adding feature operator:  29%|██▉       | 55146/187062 [00:01<00:01, 71334.92it/s]
Adding feature operator:  34%|███▍      | 63274/187062 [00:01<00:01, 74256.49it/s]
Adding feature operator:  38%|███▊      | 71304/187062 [00:01<00:01, 76041.30it/s]
Adding feature operator:  42%|████▏     | 79373/187062 [00:01<00:01, 77420.70it/s]
Adding feature operator:  47%|████▋     | 87452/187062 [00:01<00:01, 78421.89it/s]
Adding feature operator:  51%|█████     | 95555/187062 [00:01<00:01, 79197.42it/s]
Adding feature operator:  55%|█████▌    | 103591/187062 [00:01<00:01, 79531.46it/s]
Adding feature operator:  60%|█████▉    | 111696/187062 [00:01<00:00, 79984.18it/s]
Adding feature operator:  64%|██████▍   | 119828/187062 [00:01<00:00, 80381.53it/s]
Adding feature operator:  68%|██████▊   | 127907/187062 [00:02<00:00, 80412.15it/s]
Adding feature operator:  73%|███████▎  | 135977/187062 [00:02<00:00, 80466.32it/s]
Adding feature operator:  77%|███████▋  | 144070/187062 [00:02<00:00, 80603.00it/s]
Adding feature operator:  81%|████████▏ | 152153/187062 [00:02<00:00, 80668.17it/s]
Adding feature operator:  86%|████████▌ | 160230/187062 [00:02<00:00, 80629.62it/s]
Adding feature operator:  90%|████████▉ | 168300/187062 [00:02<00:00, 80589.99it/s]
Adding feature operator:  94%|█████████▍| 176397/187062 [00:02<00:00, 80701.73it/s]
Adding feature operator:  99%|█████████▊| 184471/187062 [00:02<00:00, 54686.82it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 62568.98it/s]
[2024-10-12 12:58:04,966] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 12:58:06 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 12:58:06 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 408.92 examples/s]
Map:   2%|▏         | 108/6548 [00:00<00:26, 247.31 examples/s]
Map:   2%|▏         | 151/6548 [00:00<00:22, 285.33 examples/s]
Map:   3%|▎         | 191/6548 [00:00<00:21, 298.58 examples/s]
Map:   4%|▎         | 244/6548 [00:00<00:17, 356.22 examples/s]
Map:   4%|▍         | 289/6548 [00:00<00:19, 322.65 examples/s]
Map:   5%|▌         | 337/6548 [00:01<00:19, 318.44 examples/s]
Map:   6%|▌         | 373/6548 [00:01<00:18, 327.64 examples/s]
Map:   6%|▋         | 425/6548 [00:01<00:16, 374.20 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:17, 339.40 examples/s]
Map:   8%|▊         | 512/6548 [00:01<00:17, 351.69 examples/s]
Map:   9%|▊         | 566/6548 [00:01<00:15, 397.01 examples/s]
Map:   9%|▉         | 618/6548 [00:01<00:16, 357.68 examples/s]
Map:  10%|█         | 660/6548 [00:01<00:18, 323.05 examples/s]
Map:  11%|█         | 706/6548 [00:02<00:16, 352.64 examples/s]
Map:  11%|█▏        | 749/6548 [00:02<00:15, 367.83 examples/s]
Map:  12%|█▏        | 802/6548 [00:02<00:14, 406.31 examples/s]
Map:  13%|█▎        | 859/6548 [00:02<00:14, 394.71 examples/s]
Map:  14%|█▍        | 914/6548 [00:02<00:14, 380.68 examples/s]
Map:  15%|█▍        | 970/6548 [00:02<00:15, 363.04 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:25, 219.95 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:22, 245.41 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:19, 279.83 examples/s]
Map:  18%|█▊        | 1147/6548 [00:03<00:16, 320.46 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 338.72 examples/s]
Map:  19%|█▉        | 1267/6548 [00:03<00:14, 353.15 examples/s]
Map:  20%|██        | 1322/6548 [00:04<00:15, 342.71 examples/s]
Map:  21%|██        | 1370/6548 [00:04<00:15, 324.19 examples/s]
Map:  21%|██▏       | 1407/6548 [00:04<00:17, 296.67 examples/s]
Map:  22%|██▏       | 1458/6548 [00:04<00:17, 295.40 examples/s]
Map:  23%|██▎       | 1491/6548 [00:04<00:18, 270.08 examples/s]
Map:  23%|██▎       | 1527/6548 [00:04<00:17, 284.62 examples/s]
Map:  24%|██▍       | 1566/6548 [00:04<00:18, 276.29 examples/s]
Map:  24%|██▍       | 1596/6548 [00:05<00:17, 280.70 examples/s]
Map:  25%|██▍       | 1627/6548 [00:05<00:19, 248.24 examples/s]
Map:  25%|██▌       | 1656/6548 [00:05<00:21, 227.37 examples/s]
Map:  26%|██▌       | 1684/6548 [00:05<00:20, 238.48 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:17, 278.52 examples/s]
Map:  27%|██▋       | 1771/6548 [00:05<00:15, 318.04 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 330.09 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 344.31 examples/s]
Map:  29%|██▉       | 1906/6548 [00:06<00:13, 344.24 examples/s]
Map:  30%|██▉       | 1960/6548 [00:06<00:13, 340.85 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:19, 232.66 examples/s]
Map:  31%|███       | 2035/6548 [00:06<00:19, 230.56 examples/s]
Map:  32%|███▏      | 2079/6548 [00:06<00:16, 269.27 examples/s]
Map:  32%|███▏      | 2127/6548 [00:06<00:16, 276.23 examples/s]
Map:  33%|███▎      | 2159/6548 [00:07<00:17, 251.96 examples/s]
Map:  34%|███▍      | 2210/6548 [00:07<00:14, 305.65 examples/s]
Map:  34%|███▍      | 2255/6548 [00:07<00:16, 264.16 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:15, 267.99 examples/s]
Map:  36%|███▌      | 2331/6548 [00:07<00:13, 303.41 examples/s]
Map:  36%|███▌      | 2368/6548 [00:07<00:14, 280.51 examples/s]
Map:  37%|███▋      | 2407/6548 [00:07<00:13, 300.44 examples/s]
Map:  38%|███▊      | 2459/6548 [00:08<00:13, 310.36 examples/s]
Map:  38%|███▊      | 2496/6548 [00:08<00:12, 317.93 examples/s]
Map:  39%|███▉      | 2538/6548 [00:08<00:11, 339.63 examples/s]
Map:  40%|███▉      | 2592/6548 [00:08<00:10, 387.79 examples/s]
Map:  40%|████      | 2634/6548 [00:08<00:09, 392.90 examples/s]
Map:  41%|████      | 2682/6548 [00:08<00:10, 360.44 examples/s]
Map:  42%|████▏     | 2735/6548 [00:08<00:10, 350.01 examples/s]
Map:  42%|████▏     | 2773/6548 [00:08<00:10, 349.70 examples/s]
Map:  43%|████▎     | 2822/6548 [00:09<00:10, 338.97 examples/s]
Map:  44%|████▎     | 2862/6548 [00:09<00:12, 288.24 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 296.11 examples/s]
Map:  45%|████▌     | 2950/6548 [00:09<00:11, 305.97 examples/s]
Map:  46%|████▌     | 2983/6548 [00:09<00:11, 306.72 examples/s]
Map:  46%|████▌     | 3026/6548 [00:10<00:21, 165.45 examples/s]
Map:  47%|████▋     | 3062/6548 [00:10<00:18, 192.93 examples/s]
Map:  47%|████▋     | 3094/6548 [00:10<00:16, 213.69 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 248.81 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:13, 252.64 examples/s]
Map:  49%|████▉     | 3202/6548 [00:10<00:12, 260.88 examples/s]
Map:  50%|████▉     | 3244/6548 [00:10<00:12, 259.25 examples/s]
Map:  50%|█████     | 3276/6548 [00:11<00:12, 266.60 examples/s]
Map:  51%|█████     | 3322/6548 [00:11<00:10, 302.06 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:11<00:10, 301.01 examples/s]
Map:  52%|█████▏    | 3421/6548 [00:11<00:11, 270.90 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 260.73 examples/s]
Map:  53%|█████▎    | 3489/6548 [00:11<00:12, 247.70 examples/s]
Map:  54%|█████▍    | 3542/6548 [00:11<00:09, 305.74 examples/s]
Map:  55%|█████▍    | 3586/6548 [00:12<00:08, 335.95 examples/s]
Map:  55%|█████▌    | 3631/6548 [00:12<00:08, 359.48 examples/s]
Map:  56%|█████▋    | 3687/6548 [00:12<00:07, 361.29 examples/s]
Map:  57%|█████▋    | 3733/6548 [00:12<00:07, 380.57 examples/s]
Map:  58%|█████▊    | 3788/6548 [00:12<00:07, 372.46 examples/s]
Map:  58%|█████▊    | 3830/6548 [00:12<00:08, 317.93 examples/s]
Map:  59%|█████▉    | 3864/6548 [00:12<00:08, 319.18 examples/s]
Map:  60%|█████▉    | 3911/6548 [00:12<00:07, 350.56 examples/s]
Map:  60%|██████    | 3956/6548 [00:13<00:07, 324.41 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 228.97 examples/s]
Map:  62%|██████▏   | 4055/6548 [00:13<00:08, 286.12 examples/s]
Map:  63%|██████▎   | 4097/6548 [00:13<00:07, 312.54 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 326.04 examples/s]
Map:  64%|██████▍   | 4195/6548 [00:13<00:07, 333.07 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:14<00:06, 337.43 examples/s]
Map:  65%|██████▌   | 4282/6548 [00:14<00:06, 364.16 examples/s]
Map:  66%|██████▌   | 4325/6548 [00:14<00:05, 375.92 examples/s]
Map:  67%|██████▋   | 4384/6548 [00:14<00:06, 355.76 examples/s]
Map:  68%|██████▊   | 4431/6548 [00:14<00:05, 376.92 examples/s]
Map:  68%|██████▊   | 4483/6548 [00:14<00:06, 342.99 examples/s]
Map:  69%|██████▉   | 4530/6548 [00:14<00:06, 323.64 examples/s]
Map:  70%|██████▉   | 4572/6548 [00:14<00:05, 343.95 examples/s]
Map:  71%|███████   | 4626/6548 [00:15<00:05, 320.67 examples/s]
Map:  71%|███████▏  | 4668/6548 [00:15<00:05, 329.08 examples/s]
Map:  72%|███████▏  | 4728/6548 [00:15<00:05, 350.25 examples/s]
Map:  73%|███████▎  | 4792/6548 [00:15<00:04, 371.19 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 365.82 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 347.15 examples/s]
Map:  76%|███████▌  | 4959/6548 [00:16<00:04, 388.18 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:16<00:06, 244.53 examples/s]
Map:  77%|███████▋  | 5041/6548 [00:16<00:05, 265.54 examples/s]
Map:  78%|███████▊  | 5076/6548 [00:16<00:05, 278.01 examples/s]
Map:  78%|███████▊  | 5122/6548 [00:16<00:05, 283.92 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 293.16 examples/s]
Map:  80%|███████▉  | 5208/6548 [00:17<00:04, 302.85 examples/s]
Map:  80%|████████  | 5243/6548 [00:17<00:04, 307.51 examples/s]
Map:  81%|████████  | 5286/6548 [00:17<00:03, 328.58 examples/s]
Map:  81%|████████▏ | 5322/6548 [00:17<00:03, 335.16 examples/s]
Map:  82%|████████▏ | 5360/6548 [00:17<00:03, 301.13 examples/s]
Map:  82%|████████▏ | 5392/6548 [00:17<00:04, 287.83 examples/s]
Map:  83%|████████▎ | 5429/6548 [00:17<00:03, 305.76 examples/s]
Map:  83%|████████▎ | 5466/6548 [00:17<00:03, 317.59 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 325.83 examples/s]
Map:  85%|████████▍ | 5547/6548 [00:18<00:02, 344.43 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:18<00:03, 296.69 examples/s]
Map:  86%|████████▌ | 5632/6548 [00:18<00:02, 338.14 examples/s]
Map:  87%|████████▋ | 5680/6548 [00:18<00:02, 307.23 examples/s]
Map:  87%|████████▋ | 5716/6548 [00:18<00:02, 315.91 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 340.67 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 346.70 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:01, 355.76 examples/s]
Map:  90%|████████▉ | 5889/6548 [00:19<00:01, 366.42 examples/s]
Map:  91%|█████████ | 5927/6548 [00:19<00:01, 369.39 examples/s]
Map:  91%|█████████ | 5973/6548 [00:19<00:01, 343.84 examples/s]
Map:  92%|█████████▏| 6027/6548 [00:19<00:02, 235.26 examples/s]
Map:  93%|█████████▎| 6079/6548 [00:19<00:01, 261.31 examples/s]
Map:  94%|█████████▎| 6130/6548 [00:20<00:01, 255.50 examples/s]
Map:  94%|█████████▍| 6163/6548 [00:20<00:01, 267.34 examples/s]
Map:  95%|█████████▍| 6217/6548 [00:20<00:01, 287.45 examples/s]
Map:  95%|█████████▌| 6250/6548 [00:20<00:01, 295.98 examples/s]
Map:  96%|█████████▌| 6283/6548 [00:20<00:00, 302.51 examples/s]
Map:  97%|█████████▋| 6319/6548 [00:20<00:00, 315.27 examples/s]
Map:  97%|█████████▋| 6367/6548 [00:20<00:00, 341.15 examples/s]
Map:  98%|█████████▊| 6411/6548 [00:20<00:00, 365.16 examples/s]
Map:  99%|█████████▊| 6459/6548 [00:20<00:00, 390.09 examples/s]
Map:  99%|█████████▉| 6515/6548 [00:21<00:00, 382.30 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 307.62 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 322.68 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 343.81 examples/s]
Map:  13%|█▎        | 116/903 [00:00<00:02, 341.71 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 357.86 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 408.63 examples/s]
Map:  29%|██▉       | 260/903 [00:00<00:01, 368.17 examples/s]
Map:  33%|███▎      | 302/903 [00:00<00:01, 366.51 examples/s]
Map:  39%|███▉      | 354/903 [00:00<00:01, 355.99 examples/s]
Map:  45%|████▌     | 409/903 [00:01<00:01, 291.46 examples/s]
Map:  50%|████▉     | 450/903 [00:01<00:01, 284.33 examples/s]
Map:  54%|█████▍    | 486/903 [00:01<00:01, 290.89 examples/s]
Map:  59%|█████▉    | 531/903 [00:01<00:01, 324.57 examples/s]
Map:  63%|██████▎   | 569/903 [00:01<00:00, 334.17 examples/s]
Map:  68%|██████▊   | 613/903 [00:01<00:00, 355.25 examples/s]
Map:  74%|███████▎  | 665/903 [00:01<00:00, 348.14 examples/s]
Map:  78%|███████▊  | 708/903 [00:02<00:00, 362.17 examples/s]
Map:  85%|████████▍ | 765/903 [00:02<00:00, 413.30 examples/s]
Map:  91%|█████████ | 821/903 [00:02<00:00, 392.56 examples/s]
Map:  95%|█████████▌| 862/903 [00:02<00:00, 385.89 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 237.58 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 321.75 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 302.20 examples/s]
Map:   4%|▍         | 82/1882 [00:00<00:04, 373.99 examples/s]
Map:   7%|▋         | 135/1882 [00:00<00:05, 346.51 examples/s]
Map:  10%|▉         | 180/1882 [00:00<00:04, 379.02 examples/s]
Map:  13%|█▎        | 239/1882 [00:00<00:04, 382.44 examples/s]
Map:  15%|█▍        | 280/1882 [00:00<00:04, 384.74 examples/s]
Map:  18%|█▊        | 334/1882 [00:00<00:04, 365.54 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:04, 321.60 examples/s]
Map:  22%|██▏       | 417/1882 [00:01<00:04, 306.62 examples/s]
Map:  24%|██▍       | 449/1882 [00:01<00:04, 308.98 examples/s]
Map:  27%|██▋       | 499/1882 [00:01<00:03, 350.04 examples/s]
Map:  29%|██▉       | 552/1882 [00:01<00:04, 323.95 examples/s]
Map:  32%|███▏      | 603/1882 [00:01<00:03, 359.34 examples/s]
Map:  35%|███▍      | 653/1882 [00:01<00:03, 382.17 examples/s]
Map:  37%|███▋      | 696/1882 [00:01<00:03, 393.00 examples/s]
Map:  40%|████      | 760/1882 [00:02<00:02, 402.33 examples/s]
Map:  43%|████▎     | 802/1882 [00:02<00:03, 345.39 examples/s]
Map:  45%|████▌     | 848/1882 [00:02<00:02, 361.88 examples/s]
Map:  47%|████▋     | 891/1882 [00:02<00:02, 374.45 examples/s]
Map:  49%|████▉     | 930/1882 [00:02<00:02, 370.07 examples/s]
Map:  52%|█████▏    | 982/1882 [00:02<00:02, 355.29 examples/s]
Map:  55%|█████▌    | 1039/1882 [00:03<00:03, 238.15 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 253.14 examples/s]
Map:  59%|█████▉    | 1107/1882 [00:03<00:02, 268.04 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 280.18 examples/s]
Map:  62%|██████▏   | 1173/1882 [00:03<00:02, 289.06 examples/s]
Map:  64%|██████▍   | 1206/1882 [00:03<00:02, 261.54 examples/s]
Map:  66%|██████▋   | 1250/1882 [00:03<00:02, 302.04 examples/s]
Map:  69%|██████▉   | 1307/1882 [00:03<00:01, 321.63 examples/s]
Map:  72%|███████▏  | 1349/1882 [00:04<00:01, 340.18 examples/s]
Map:  74%|███████▎  | 1386/1882 [00:04<00:01, 331.86 examples/s]
Map:  76%|███████▌  | 1429/1882 [00:04<00:01, 298.36 examples/s]
Map:  78%|███████▊  | 1471/1882 [00:04<00:01, 321.25 examples/s]
Map:  80%|████████  | 1507/1882 [00:04<00:01, 282.81 examples/s]
Map:  82%|████████▏ | 1539/1882 [00:04<00:01, 286.38 examples/s]
Map:  84%|████████▍ | 1582/1882 [00:04<00:00, 319.28 examples/s]
Map:  86%|████████▌ | 1622/1882 [00:04<00:00, 338.04 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 339.00 examples/s]
Map:  91%|█████████ | 1713/1882 [00:05<00:00, 342.13 examples/s]
Map:  93%|█████████▎| 1748/1882 [00:05<00:00, 286.74 examples/s]
Map:  95%|█████████▌| 1788/1882 [00:05<00:00, 278.49 examples/s]
Map:  98%|█████████▊| 1837/1882 [00:05<00:00, 325.90 examples/s]
Map: 100%|█████████▉| 1880/1882 [00:05<00:00, 347.45 examples/s]
Map: 100%|██████████| 1882/1882 [00:05<00:00, 314.20 examples/s]
10/12/2024 12:59:08 - INFO - __main__ -     ***** Testing *****
10/12/2024 12:59:08 - INFO - __main__ -     Batch size = 8
10/12/2024 12:59:08 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 12:59:08 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 12:59:08 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 12:59:09 - INFO - knnlm -   Reading datastore took 0.9099235534667969 s
10/12/2024 12:59:10 - INFO - knnlm -   Moving index to GPU took 0.8894076347351074 s
10/12/2024 12:59:10 - INFO - __main__ -   ******************************break-into
10/12/2024 12:59:10 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 12:59:10 - INFO - __main__ -     Num examples = 236
10/12/2024 12:59:10 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:59,  7.66s/it]
test ppl:   1%|          | 2/236 [00:09<16:59,  4.36s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:54,  3.06s/it]
test ppl:   2%|▏         | 4/236 [00:17<16:13,  4.20s/it]
test ppl:   2%|▏         | 5/236 [00:23<18:32,  4.82s/it]
test ppl:   3%|▎         | 6/236 [00:28<19:53,  5.19s/it]
test ppl:   3%|▎         | 7/236 [00:30<15:42,  4.12s/it]
test ppl:   3%|▎         | 8/236 [00:35<15:55,  4.19s/it]
test ppl:   4%|▍         | 9/236 [00:37<13:25,  3.55s/it]
test ppl:   4%|▍         | 10/236 [00:39<11:58,  3.18s/it]
test ppl:   5%|▍         | 11/236 [00:42<11:01,  2.94s/it]
test ppl:   5%|▌         | 12/236 [00:48<14:34,  3.90s/it]
test ppl:   6%|▌         | 13/236 [00:54<16:46,  4.51s/it]
test ppl:   6%|▌         | 14/236 [01:00<18:18,  4.95s/it]
test ppl:   6%|▋         | 15/236 [01:01<14:09,  3.85s/it]
test ppl:   7%|▋         | 16/236 [01:03<11:55,  3.25s/it]
test ppl:   7%|▋         | 17/236 [01:09<14:47,  4.05s/it]
test ppl:   8%|▊         | 18/236 [01:10<12:09,  3.35s/it]
test ppl:   8%|▊         | 19/236 [01:15<13:20,  3.69s/it]
test ppl:   8%|▊         | 20/236 [01:17<11:13,  3.12s/it]
test ppl:   9%|▉         | 21/236 [01:19<10:15,  2.86s/it]
test ppl:   9%|▉         | 22/236 [01:25<13:30,  3.79s/it]
test ppl:  10%|▉         | 23/236 [01:27<12:06,  3.41s/it]
test ppl:  10%|█         | 24/236 [01:30<10:57,  3.10s/it]
test ppl:  11%|█         | 25/236 [01:32<09:29,  2.70s/it]
test ppl:  11%|█         | 26/236 [01:36<11:36,  3.32s/it]
test ppl:  11%|█▏        | 27/236 [01:40<11:43,  3.37s/it]
test ppl:  12%|█▏        | 28/236 [01:41<09:25,  2.72s/it]
test ppl:  12%|█▏        | 29/236 [01:43<08:59,  2.61s/it]
test ppl:  13%|█▎        | 30/236 [01:45<07:51,  2.29s/it]
test ppl:  13%|█▎        | 31/236 [01:47<07:32,  2.21s/it]
test ppl:  14%|█▎        | 32/236 [01:50<07:58,  2.35s/it]
test ppl:  14%|█▍        | 33/236 [01:56<11:35,  3.43s/it]
test ppl:  14%|█▍        | 34/236 [02:00<12:09,  3.61s/it]
test ppl:  15%|█▍        | 35/236 [02:02<11:02,  3.30s/it]
test ppl:  15%|█▌        | 36/236 [02:08<13:38,  4.09s/it]
test ppl:  16%|█▌        | 37/236 [02:14<15:27,  4.66s/it]
test ppl:  16%|█▌        | 38/236 [02:16<12:49,  3.89s/it]
test ppl:  17%|█▋        | 39/236 [02:18<10:42,  3.26s/it]
test ppl:  17%|█▋        | 40/236 [02:21<10:02,  3.07s/it]
test ppl:  17%|█▋        | 41/236 [02:22<08:49,  2.72s/it]
test ppl:  18%|█▊        | 42/236 [02:28<11:55,  3.69s/it]
test ppl:  18%|█▊        | 43/236 [02:34<14:01,  4.36s/it]
test ppl:  19%|█▊        | 44/236 [02:37<12:10,  3.81s/it]
test ppl:  19%|█▉        | 45/236 [02:39<10:22,  3.26s/it]
test ppl:  19%|█▉        | 46/236 [02:45<12:53,  4.07s/it]
test ppl:  20%|█▉        | 47/236 [02:46<10:32,  3.35s/it]
test ppl:  20%|██        | 48/236 [02:52<12:59,  4.15s/it]
test ppl:  21%|██        | 49/236 [02:56<12:41,  4.07s/it]
test ppl:  21%|██        | 50/236 [03:03<14:39,  4.73s/it]
test ppl:  22%|██▏       | 51/236 [03:07<14:28,  4.69s/it]
test ppl:  22%|██▏       | 52/236 [03:13<15:31,  5.06s/it]
test ppl:  22%|██▏       | 53/236 [03:17<14:26,  4.74s/it]
test ppl:  23%|██▎       | 54/236 [03:19<11:27,  3.78s/it]
test ppl:  23%|██▎       | 55/236 [03:24<13:10,  4.37s/it]
test ppl:  24%|██▎       | 56/236 [03:30<14:31,  4.84s/it]
test ppl:  24%|██▍       | 57/236 [03:33<12:11,  4.09s/it]
test ppl:  25%|██▍       | 58/236 [03:35<10:25,  3.52s/it]
test ppl:  25%|██▌       | 59/236 [03:41<12:29,  4.24s/it]
test ppl:  25%|██▌       | 60/236 [03:44<11:21,  3.87s/it]
test ppl:  26%|██▌       | 61/236 [03:49<12:41,  4.35s/it]
test ppl:  26%|██▋       | 62/236 [03:53<12:26,  4.29s/it]
test ppl:  27%|██▋       | 63/236 [03:56<10:47,  3.74s/it]
test ppl:  27%|██▋       | 64/236 [03:58<09:10,  3.20s/it]
test ppl:  28%|██▊       | 65/236 [03:59<07:31,  2.64s/it]
test ppl:  28%|██▊       | 66/236 [04:02<07:48,  2.76s/it]
test ppl:  28%|██▊       | 67/236 [04:05<07:50,  2.78s/it]
test ppl:  29%|██▉       | 68/236 [04:11<10:25,  3.72s/it]
test ppl:  29%|██▉       | 69/236 [04:17<12:11,  4.38s/it]
test ppl:  30%|██▉       | 70/236 [04:18<09:33,  3.45s/it]
test ppl:  30%|███       | 71/236 [04:21<09:21,  3.40s/it]
test ppl:  31%|███       | 72/236 [04:25<09:39,  3.54s/it]
test ppl:  31%|███       | 73/236 [04:30<10:46,  3.97s/it]
test ppl:  31%|███▏      | 74/236 [04:32<08:43,  3.23s/it]
test ppl:  32%|███▏      | 75/236 [04:38<10:49,  4.03s/it]
test ppl:  32%|███▏      | 76/236 [04:41<10:09,  3.81s/it]
test ppl:  33%|███▎      | 77/236 [04:43<08:53,  3.36s/it]
test ppl:  33%|███▎      | 78/236 [04:45<07:22,  2.80s/it]
test ppl:  33%|███▎      | 79/236 [04:49<08:12,  3.14s/it]
test ppl:  34%|███▍      | 80/236 [04:51<07:09,  2.75s/it]
test ppl:  34%|███▍      | 81/236 [04:56<09:31,  3.69s/it]
test ppl:  35%|███▍      | 82/236 [05:02<11:12,  4.36s/it]
test ppl:  35%|███▌      | 83/236 [05:08<12:18,  4.83s/it]
test ppl:  36%|███▌      | 84/236 [05:11<10:23,  4.10s/it]
test ppl:  36%|███▌      | 85/236 [05:15<10:19,  4.10s/it]
test ppl:  36%|███▋      | 86/236 [05:17<08:27,  3.38s/it]
test ppl:  37%|███▋      | 87/236 [05:19<07:53,  3.18s/it]
test ppl:  37%|███▋      | 88/236 [05:25<09:49,  3.99s/it]
test ppl:  38%|███▊      | 89/236 [05:31<11:10,  4.56s/it]
test ppl:  38%|███▊      | 90/236 [05:37<12:04,  4.96s/it]
test ppl:  39%|███▊      | 91/236 [05:42<12:01,  4.98s/it]
test ppl:  39%|███▉      | 92/236 [05:45<10:24,  4.34s/it]
test ppl:  39%|███▉      | 93/236 [05:51<11:26,  4.80s/it]
test ppl:  40%|███▉      | 94/236 [05:57<12:09,  5.14s/it]
test ppl:  40%|████      | 95/236 [05:59<09:50,  4.19s/it]
test ppl:  41%|████      | 96/236 [06:01<08:54,  3.82s/it]
test ppl:  41%|████      | 97/236 [06:07<10:18,  4.45s/it]
test ppl:  42%|████▏     | 98/236 [06:13<11:14,  4.89s/it]
test ppl:  42%|████▏     | 99/236 [06:19<11:50,  5.19s/it]
test ppl:  42%|████▏     | 100/236 [06:20<09:04,  4.01s/it]
test ppl:  43%|████▎     | 101/236 [06:26<10:17,  4.57s/it]
test ppl:  43%|████▎     | 102/236 [06:30<09:43,  4.36s/it]
test ppl:  44%|████▎     | 103/236 [06:32<07:42,  3.48s/it]
test ppl:  44%|████▍     | 104/236 [06:36<08:10,  3.72s/it]
test ppl:  44%|████▍     | 105/236 [06:40<08:34,  3.93s/it]
test ppl:  45%|████▍     | 106/236 [06:46<09:29,  4.38s/it]
test ppl:  45%|████▌     | 107/236 [06:48<07:50,  3.65s/it]
test ppl:  46%|████▌     | 108/236 [06:53<09:07,  4.28s/it]
test ppl:  46%|████▌     | 109/236 [06:58<09:18,  4.40s/it]
test ppl:  47%|████▋     | 110/236 [07:00<07:28,  3.56s/it]
test ppl:  47%|████▋     | 111/236 [07:04<07:40,  3.68s/it]
test ppl:  47%|████▋     | 112/236 [07:07<07:35,  3.67s/it]
test ppl:  48%|████▊     | 113/236 [07:09<06:21,  3.10s/it]
test ppl:  48%|████▊     | 114/236 [07:12<06:28,  3.18s/it]
test ppl:  49%|████▊     | 115/236 [07:17<07:14,  3.59s/it]
test ppl:  49%|████▉     | 116/236 [07:23<08:33,  4.28s/it]
test ppl:  50%|████▉     | 117/236 [07:25<07:02,  3.55s/it]
test ppl:  50%|█████     | 118/236 [07:31<08:22,  4.25s/it]
test ppl:  50%|█████     | 119/236 [07:33<07:23,  3.79s/it]
test ppl:  51%|█████     | 120/236 [07:35<05:58,  3.09s/it]
test ppl:  51%|█████▏    | 121/236 [07:41<07:31,  3.93s/it]
test ppl:  52%|█████▏    | 122/236 [07:45<07:57,  4.19s/it]
test ppl:  52%|█████▏    | 123/236 [07:48<06:44,  3.58s/it]
test ppl:  53%|█████▎    | 124/236 [07:50<06:01,  3.23s/it]
test ppl:  53%|█████▎    | 125/236 [07:53<05:34,  3.01s/it]
test ppl:  53%|█████▎    | 126/236 [07:58<06:34,  3.59s/it]
test ppl:  54%|█████▍    | 127/236 [08:00<05:42,  3.15s/it]
test ppl:  54%|█████▍    | 128/236 [08:02<05:11,  2.88s/it]
test ppl:  55%|█████▍    | 129/236 [08:05<05:11,  2.91s/it]
test ppl:  55%|█████▌    | 130/236 [08:08<05:01,  2.85s/it]
test ppl:  56%|█████▌    | 131/236 [08:13<06:36,  3.77s/it]
test ppl:  56%|█████▌    | 132/236 [08:16<05:52,  3.39s/it]
test ppl:  56%|█████▋    | 133/236 [08:20<06:05,  3.55s/it]
test ppl:  57%|█████▋    | 134/236 [08:24<06:13,  3.66s/it]
test ppl:  57%|█████▋    | 135/236 [08:30<07:18,  4.34s/it]
test ppl:  58%|█████▊    | 136/236 [08:31<05:41,  3.41s/it]
test ppl:  58%|█████▊    | 137/236 [08:37<06:52,  4.17s/it]
test ppl:  58%|█████▊    | 138/236 [08:40<06:29,  3.98s/it]
test ppl:  59%|█████▉    | 139/236 [08:42<05:22,  3.32s/it]
test ppl:  59%|█████▉    | 140/236 [08:44<04:31,  2.83s/it]
test ppl:  60%|█████▉    | 141/236 [08:47<04:30,  2.85s/it]
test ppl:  60%|██████    | 142/236 [08:49<04:07,  2.63s/it]
test ppl:  61%|██████    | 143/236 [08:55<05:35,  3.61s/it]
test ppl:  61%|██████    | 144/236 [08:58<05:08,  3.35s/it]
test ppl:  61%|██████▏   | 145/236 [09:03<06:03,  4.00s/it]
test ppl:  62%|██████▏   | 146/236 [09:08<06:15,  4.17s/it]
test ppl:  62%|██████▏   | 147/236 [09:14<06:58,  4.70s/it]
test ppl:  63%|██████▎   | 148/236 [09:20<07:27,  5.09s/it]
test ppl:  63%|██████▎   | 149/236 [09:26<07:44,  5.34s/it]
test ppl:  64%|██████▎   | 150/236 [09:31<07:53,  5.51s/it]
test ppl:  64%|██████▍   | 151/236 [09:37<07:58,  5.62s/it]
test ppl:  64%|██████▍   | 152/236 [09:43<07:59,  5.71s/it]
test ppl:  65%|██████▍   | 153/236 [09:49<07:58,  5.76s/it]
test ppl:  65%|██████▌   | 154/236 [09:52<06:33,  4.79s/it]
test ppl:  66%|██████▌   | 155/236 [09:54<05:37,  4.17s/it]
test ppl:  66%|██████▌   | 156/236 [09:57<04:45,  3.57s/it]
test ppl:  67%|██████▋   | 157/236 [09:59<04:09,  3.16s/it]
test ppl:  67%|██████▋   | 158/236 [10:05<05:10,  3.98s/it]
test ppl:  67%|██████▋   | 159/236 [10:06<04:01,  3.13s/it]
test ppl:  68%|██████▊   | 160/236 [10:07<03:13,  2.54s/it]
test ppl:  68%|██████▊   | 161/236 [10:08<02:44,  2.19s/it]
test ppl:  69%|██████▊   | 162/236 [10:10<02:40,  2.17s/it]
test ppl:  69%|██████▉   | 163/236 [10:13<02:46,  2.28s/it]
test ppl:  69%|██████▉   | 164/236 [10:17<03:25,  2.85s/it]
test ppl:  70%|██████▉   | 165/236 [10:21<03:45,  3.18s/it]
test ppl:  70%|███████   | 166/236 [10:23<03:08,  2.69s/it]
test ppl:  71%|███████   | 167/236 [10:24<02:40,  2.33s/it]
test ppl:  71%|███████   | 168/236 [10:28<03:16,  2.89s/it]
test ppl:  72%|███████▏  | 169/236 [10:34<04:15,  3.81s/it]
test ppl:  72%|███████▏  | 170/236 [10:40<04:54,  4.46s/it]
test ppl:  72%|███████▏  | 171/236 [10:42<03:49,  3.53s/it]
test ppl:  73%|███████▎  | 172/236 [10:48<04:31,  4.24s/it]
test ppl:  73%|███████▎  | 173/236 [10:51<04:20,  4.14s/it]
test ppl:  74%|███████▎  | 174/236 [10:55<04:12,  4.07s/it]
test ppl:  74%|███████▍  | 175/236 [10:57<03:27,  3.41s/it]
test ppl:  75%|███████▍  | 176/236 [11:03<04:09,  4.15s/it]
test ppl:  75%|███████▌  | 177/236 [11:09<04:36,  4.69s/it]
test ppl:  75%|███████▌  | 178/236 [11:15<04:53,  5.06s/it]
test ppl:  76%|███████▌  | 179/236 [11:21<05:03,  5.32s/it]
test ppl:  76%|███████▋  | 180/236 [11:25<04:29,  4.81s/it]
test ppl:  77%|███████▋  | 181/236 [11:30<04:42,  5.14s/it]
test ppl:  77%|███████▋  | 182/236 [11:32<03:45,  4.17s/it]
test ppl:  78%|███████▊  | 183/236 [11:35<03:11,  3.61s/it]
test ppl:  78%|███████▊  | 184/236 [11:36<02:33,  2.96s/it]
test ppl:  78%|███████▊  | 185/236 [11:40<02:43,  3.21s/it]
test ppl:  79%|███████▉  | 186/236 [11:42<02:24,  2.89s/it]
test ppl:  79%|███████▉  | 187/236 [11:48<03:07,  3.82s/it]
test ppl:  80%|███████▉  | 188/236 [11:54<03:34,  4.46s/it]
test ppl:  80%|████████  | 189/236 [12:00<03:50,  4.89s/it]
test ppl:  81%|████████  | 190/236 [12:04<03:36,  4.71s/it]
test ppl:  81%|████████  | 191/236 [12:08<03:19,  4.44s/it]
test ppl:  81%|████████▏ | 192/236 [12:11<02:51,  3.91s/it]
test ppl:  82%|████████▏ | 193/236 [12:17<03:13,  4.51s/it]
test ppl:  82%|████████▏ | 194/236 [12:19<02:45,  3.95s/it]
test ppl:  83%|████████▎ | 195/236 [12:22<02:31,  3.69s/it]
test ppl:  83%|████████▎ | 196/236 [12:24<02:07,  3.19s/it]
test ppl:  83%|████████▎ | 197/236 [12:26<01:52,  2.88s/it]
test ppl:  84%|████████▍ | 198/236 [12:28<01:39,  2.61s/it]
test ppl:  84%|████████▍ | 199/236 [12:31<01:37,  2.64s/it]
test ppl:  85%|████████▍ | 200/236 [12:37<02:10,  3.61s/it]
test ppl:  85%|████████▌ | 201/236 [12:40<01:55,  3.30s/it]
test ppl:  86%|████████▌ | 202/236 [12:46<02:18,  4.09s/it]
test ppl:  86%|████████▌ | 203/236 [12:51<02:31,  4.60s/it]
test ppl:  86%|████████▋ | 204/236 [12:53<01:59,  3.72s/it]
test ppl:  87%|████████▋ | 205/236 [12:59<02:16,  4.39s/it]
test ppl:  87%|████████▋ | 206/236 [13:02<02:02,  4.07s/it]
test ppl:  88%|████████▊ | 207/236 [13:08<02:13,  4.62s/it]
test ppl:  88%|████████▊ | 208/236 [13:11<01:57,  4.20s/it]
test ppl:  89%|████████▊ | 209/236 [13:17<02:07,  4.73s/it]
test ppl:  89%|████████▉ | 210/236 [13:20<01:44,  4.02s/it]
test ppl:  89%|████████▉ | 211/236 [13:24<01:38,  3.95s/it]
test ppl:  90%|████████▉ | 212/236 [13:29<01:48,  4.53s/it]
test ppl:  90%|█████████ | 213/236 [13:35<01:53,  4.94s/it]
test ppl:  91%|█████████ | 214/236 [13:37<01:26,  3.95s/it]
test ppl:  91%|█████████ | 215/236 [13:43<01:35,  4.54s/it]
test ppl:  92%|█████████▏| 216/236 [13:45<01:13,  3.68s/it]
test ppl:  92%|█████████▏| 217/236 [13:51<01:23,  4.37s/it]
test ppl:  92%|█████████▏| 218/236 [13:52<01:05,  3.63s/it]
test ppl:  93%|█████████▎| 219/236 [13:58<01:13,  4.32s/it]
test ppl:  93%|█████████▎| 220/236 [14:04<01:16,  4.80s/it]
test ppl:  94%|█████████▎| 221/236 [14:06<00:58,  3.88s/it]
test ppl:  94%|█████████▍| 222/236 [14:12<01:03,  4.50s/it]
test ppl:  94%|█████████▍| 223/236 [14:18<01:04,  4.93s/it]
test ppl:  95%|█████████▍| 224/236 [14:20<00:47,  3.98s/it]
test ppl:  95%|█████████▌| 225/236 [14:26<00:50,  4.56s/it]
test ppl:  96%|█████████▌| 226/236 [14:28<00:39,  3.96s/it]
test ppl:  96%|█████████▌| 227/236 [14:31<00:32,  3.60s/it]
test ppl:  97%|█████████▋| 228/236 [14:33<00:25,  3.13s/it]
test ppl:  97%|█████████▋| 229/236 [14:39<00:27,  3.96s/it]
test ppl:  97%|█████████▋| 230/236 [14:42<00:22,  3.81s/it]
test ppl:  98%|█████████▊| 231/236 [14:46<00:18,  3.68s/it]
test ppl:  98%|█████████▊| 232/236 [14:47<00:12,  3.10s/it]
test ppl:  99%|█████████▊| 233/236 [14:50<00:08,  2.81s/it]
test ppl:  99%|█████████▉| 234/236 [14:51<00:04,  2.44s/it]
test ppl: 100%|█████████▉| 235/236 [14:57<00:03,  3.48s/it]
test ppl: 100%|██████████| 236/236 [14:58<00:00,  2.63s/it]
test ppl: 100%|██████████| 236/236 [14:58<00:00,  3.81s/it]
10/12/2024 13:14:08 - INFO - __main__ -    em: 0.2104
10/12/2024 13:14:08 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.4 40:  em: 0.2104

--------------------------------------------------------------------------------
Running experiment with knn_temp=40, lmbda=0.4, k=32
2024-10-12 13:14:15.938765: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 13:14:15.958490: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 13:14:15.980414: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 13:14:15.987056: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 13:14:16.003205: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 13:14:16.994389: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 13:14:18 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.4, knn_temp=40, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 13:14:18 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:47:30,  2.18it/s]
Adding feature api:   3%|▎         | 6338/187062 [00:00<00:11, 15070.92it/s]
Adding feature api:   7%|▋         | 13456/187062 [00:00<00:05, 29298.26it/s]
Adding feature api:  11%|█         | 20851/187062 [00:00<00:04, 41171.09it/s]
Adding feature api:  15%|█▌        | 28261/187062 [00:00<00:03, 50235.05it/s]
Adding feature api:  19%|█▉        | 35653/187062 [00:00<00:02, 56918.36it/s]
Adding feature api:  23%|██▎       | 42853/187062 [00:01<00:02, 61249.78it/s]
Adding feature api:  27%|██▋       | 50307/187062 [00:01<00:02, 65114.61it/s]
Adding feature api:  31%|███       | 57756/187062 [00:01<00:01, 67865.35it/s]
Adding feature api:  35%|███▍      | 65206/187062 [00:01<00:01, 69823.54it/s]
Adding feature api:  39%|███▉      | 72500/187062 [00:01<00:01, 70669.83it/s]
Adding feature api:  43%|████▎     | 79959/187062 [00:01<00:01, 71833.60it/s]
Adding feature api:  47%|████▋     | 87340/187062 [00:01<00:01, 72421.99it/s]
Adding feature api:  51%|█████     | 94800/187062 [00:01<00:01, 73070.90it/s]
Adding feature api:  55%|█████▍    | 102254/187062 [00:01<00:01, 73509.34it/s]
Adding feature api:  59%|█████▊    | 109659/187062 [00:01<00:01, 73273.57it/s]
Adding feature api:  63%|██████▎   | 117098/187062 [00:02<00:00, 73606.20it/s]
Adding feature api:  67%|██████▋   | 124541/187062 [00:02<00:00, 73848.99it/s]
Adding feature api:  71%|███████   | 131986/187062 [00:02<00:00, 74027.84it/s]
Adding feature api:  75%|███████▍  | 139402/187062 [00:02<00:00, 73689.64it/s]
Adding feature api:  79%|███████▊  | 146897/187062 [00:02<00:00, 74062.51it/s]
Adding feature api:  83%|████████▎ | 154380/187062 [00:02<00:00, 74289.29it/s]
Adding feature api:  87%|████████▋ | 161842/187062 [00:02<00:00, 74385.47it/s]
Adding feature api:  90%|█████████ | 169285/187062 [00:02<00:00, 73769.07it/s]
Adding feature api:  94%|█████████▍| 176734/187062 [00:02<00:00, 73981.30it/s]
Adding feature api:  98%|█████████▊| 184135/187062 [00:03<00:00, 50032.13it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 58042.91it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:59:31,  2.17it/s]
Adding feature datatype:   3%|▎         | 6140/187062 [00:00<00:12, 14507.25it/s]
Adding feature datatype:   7%|▋         | 13210/187062 [00:00<00:06, 28687.77it/s]
Adding feature datatype:  11%|█         | 20310/187062 [00:00<00:04, 39899.11it/s]
Adding feature datatype:  15%|█▍        | 27174/187062 [00:00<00:03, 47790.31it/s]
Adding feature datatype:  18%|█▊        | 34305/187062 [00:00<00:02, 54414.94it/s]
Adding feature datatype:  22%|██▏       | 41444/187062 [00:01<00:02, 59285.28it/s]
Adding feature datatype:  26%|██▌       | 48645/187062 [00:01<00:02, 62982.53it/s]
Adding feature datatype:  30%|██▉       | 55847/187062 [00:01<00:01, 65633.71it/s]
Adding feature datatype:  34%|███▎      | 62839/187062 [00:01<00:01, 66619.44it/s]
Adding feature datatype:  37%|███▋      | 70002/187062 [00:01<00:01, 68100.08it/s]
Adding feature datatype:  41%|████▏     | 77167/187062 [00:01<00:01, 69152.33it/s]
Adding feature datatype:  45%|████▌     | 84355/187062 [00:01<00:01, 69962.40it/s]
Adding feature datatype:  49%|████▉     | 91552/187062 [00:01<00:01, 70560.15it/s]
Adding feature datatype:  53%|█████▎    | 98683/187062 [00:01<00:01, 70080.14it/s]
Adding feature datatype:  57%|█████▋    | 105845/187062 [00:01<00:01, 70536.20it/s]
Adding feature datatype:  60%|██████    | 113033/187062 [00:02<00:01, 70934.74it/s]
Adding feature datatype:  64%|██████▍   | 120239/187062 [00:02<00:00, 71268.39it/s]
Adding feature datatype:  68%|██████▊   | 127426/187062 [00:02<00:00, 71446.52it/s]
Adding feature datatype:  72%|███████▏  | 134604/187062 [00:02<00:00, 71544.41it/s]
Adding feature datatype:  76%|███████▌  | 141768/187062 [00:02<00:00, 70684.75it/s]
Adding feature datatype:  80%|███████▉  | 148947/187062 [00:02<00:00, 71011.82it/s]
Adding feature datatype:  83%|████████▎ | 156151/187062 [00:02<00:00, 71315.17it/s]
Adding feature datatype:  87%|████████▋ | 163308/187062 [00:02<00:00, 71390.60it/s]
Adding feature datatype:  91%|█████████ | 170454/187062 [00:02<00:00, 71410.86it/s]
Adding feature datatype:  95%|█████████▍| 177598/187062 [00:02<00:00, 70729.51it/s]
Adding feature datatype:  99%|█████████▊| 184674/187062 [00:03<00:00, 47446.29it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 56397.25it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:50:46,  2.18it/s]
Adding feature literal:   3%|▎         | 6140/187062 [00:00<00:12, 14574.67it/s]
Adding feature literal:   7%|▋         | 12515/187062 [00:00<00:06, 27027.18it/s]
Adding feature literal:  10%|█         | 18897/187062 [00:00<00:04, 36799.94it/s]
Adding feature literal:  14%|█▎        | 25266/187062 [00:00<00:03, 44196.58it/s]
Adding feature literal:  17%|█▋        | 31692/187062 [00:00<00:03, 49856.37it/s]
Adding feature literal:  20%|██        | 38138/187062 [00:01<00:02, 54049.63it/s]
Adding feature literal:  24%|██▍       | 44605/187062 [00:01<00:02, 57138.00it/s]
Adding feature literal:  28%|██▊       | 51769/187062 [00:01<00:02, 61395.33it/s]
Adding feature literal:  32%|███▏      | 58942/187062 [00:01<00:01, 64448.22it/s]
Adding feature literal:  35%|███▌      | 66117/187062 [00:01<00:01, 66614.43it/s]
Adding feature literal:  39%|███▉      | 73300/187062 [00:01<00:01, 68165.59it/s]
Adding feature literal:  43%|████▎     | 80514/187062 [00:01<00:01, 69350.01it/s]
Adding feature literal:  47%|████▋     | 87667/187062 [00:01<00:01, 69998.97it/s]
Adding feature literal:  51%|█████     | 94819/187062 [00:01<00:01, 70452.20it/s]
Adding feature literal:  55%|█████▍    | 102006/187062 [00:01<00:01, 70875.71it/s]
Adding feature literal:  58%|█████▊    | 109211/187062 [00:02<00:01, 71224.51it/s]
Adding feature literal:  62%|██████▏   | 116406/187062 [00:02<00:00, 71440.23it/s]
Adding feature literal:  66%|██████▌   | 123644/187062 [00:02<00:00, 71721.22it/s]
Adding feature literal:  70%|██████▉   | 130853/187062 [00:02<00:00, 71829.15it/s]
Adding feature literal:  74%|███████▍  | 138091/187062 [00:02<00:00, 71992.05it/s]
Adding feature literal:  78%|███████▊  | 145297/187062 [00:02<00:00, 71977.81it/s]
Adding feature literal:  82%|████████▏ | 152500/187062 [00:02<00:00, 71813.64it/s]
Adding feature literal:  85%|████████▌ | 159685/187062 [00:02<00:00, 71821.06it/s]
Adding feature literal:  89%|████████▉ | 166885/187062 [00:02<00:00, 71873.86it/s]
Adding feature literal:  93%|█████████▎| 174121/187062 [00:02<00:00, 72018.69it/s]
Adding feature literal:  97%|█████████▋| 181324/187062 [00:03<00:00, 56733.81it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 55741.15it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:48:41,  2.18it/s]
Adding feature operator:   3%|▎         | 6003/187062 [00:00<00:12, 14265.03it/s]
Adding feature operator:   7%|▋         | 13087/187062 [00:00<00:06, 28603.58it/s]
Adding feature operator:  11%|█         | 20270/187062 [00:00<00:04, 40093.56it/s]
Adding feature operator:  15%|█▍        | 27475/187062 [00:00<00:03, 48887.54it/s]
Adding feature operator:  19%|█▊        | 34708/187062 [00:00<00:02, 55502.67it/s]
Adding feature operator:  22%|██▏       | 41854/187062 [00:01<00:02, 60085.21it/s]
Adding feature operator:  26%|██▌       | 49053/187062 [00:01<00:02, 63546.99it/s]
Adding feature operator:  30%|███       | 56237/187062 [00:01<00:01, 65979.37it/s]
Adding feature operator:  34%|███▍      | 63433/187062 [00:01<00:01, 67743.56it/s]
Adding feature operator:  38%|███▊      | 70655/187062 [00:01<00:01, 69070.38it/s]
Adding feature operator:  42%|████▏     | 77899/187062 [00:01<00:01, 70072.27it/s]
Adding feature operator:  46%|████▌     | 85133/187062 [00:01<00:01, 70748.05it/s]
Adding feature operator:  49%|████▉     | 92334/187062 [00:01<00:01, 71124.60it/s]
Adding feature operator:  53%|█████▎    | 99522/187062 [00:01<00:01, 71345.92it/s]
Adding feature operator:  57%|█████▋    | 106719/187062 [00:01<00:01, 71531.85it/s]
Adding feature operator:  61%|██████    | 113934/187062 [00:02<00:01, 71714.36it/s]
Adding feature operator:  65%|██████▍   | 121193/187062 [00:02<00:00, 71973.33it/s]
Adding feature operator:  69%|██████▊   | 128429/187062 [00:02<00:00, 72087.05it/s]
Adding feature operator:  73%|███████▎  | 135651/187062 [00:02<00:00, 71964.31it/s]
Adding feature operator:  76%|███████▋  | 142857/187062 [00:02<00:00, 71969.66it/s]
Adding feature operator:  80%|████████  | 150061/187062 [00:02<00:00, 70315.65it/s]
Adding feature operator:  84%|████████▍ | 157106/187062 [00:02<00:00, 68400.92it/s]
Adding feature operator:  88%|████████▊ | 163964/187062 [00:02<00:00, 67173.67it/s]
Adding feature operator:  91%|█████████▏| 170696/187062 [00:02<00:00, 66557.34it/s]
Adding feature operator:  95%|█████████▌| 177787/187062 [00:02<00:00, 67798.41it/s]
Adding feature operator:  99%|█████████▊| 184578/187062 [00:03<00:00, 46359.72it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 56218.00it/s]
[2024-10-12 13:15:03,881] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 13:15:05 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 13:15:05 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:17, 376.74 examples/s]
Map:   1%|▏         | 89/6548 [00:00<00:28, 228.81 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:24, 259.19 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 311.01 examples/s]
Map:   3%|▎         | 220/6548 [00:00<00:18, 343.03 examples/s]
Map:   4%|▍         | 280/6548 [00:00<00:17, 350.03 examples/s]
Map:   5%|▍         | 325/6548 [00:01<00:21, 292.67 examples/s]
Map:   6%|▌         | 361/6548 [00:01<00:20, 301.41 examples/s]
Map:   6%|▋         | 411/6548 [00:01<00:17, 344.65 examples/s]
Map:   7%|▋         | 454/6548 [00:01<00:18, 337.46 examples/s]
Map:   8%|▊         | 509/6548 [00:01<00:17, 336.84 examples/s]
Map:   9%|▊         | 563/6548 [00:01<00:15, 378.42 examples/s]
Map:   9%|▉         | 609/6548 [00:01<00:16, 349.72 examples/s]
Map:  10%|▉         | 651/6548 [00:02<00:18, 314.06 examples/s]
Map:  11%|█         | 692/6548 [00:02<00:17, 333.40 examples/s]
Map:  11%|█         | 731/6548 [00:02<00:16, 344.69 examples/s]
Map:  12%|█▏        | 785/6548 [00:02<00:14, 388.79 examples/s]
Map:  13%|█▎        | 831/6548 [00:02<00:14, 393.06 examples/s]
Map:  13%|█▎        | 874/6548 [00:02<00:14, 400.24 examples/s]
Map:  14%|█▍        | 926/6548 [00:02<00:14, 376.60 examples/s]
Map:  15%|█▍        | 970/6548 [00:02<00:14, 372.35 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:24, 224.37 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 251.12 examples/s]
Map:  17%|█▋        | 1098/6548 [00:03<00:19, 284.87 examples/s]
Map:  17%|█▋        | 1145/6548 [00:03<00:16, 323.14 examples/s]
Map:  18%|█▊        | 1203/6548 [00:03<00:15, 341.41 examples/s]
Map:  19%|█▉        | 1258/6548 [00:03<00:15, 343.40 examples/s]
Map:  20%|█▉        | 1301/6548 [00:03<00:14, 356.62 examples/s]
Map:  21%|██        | 1355/6548 [00:04<00:16, 323.43 examples/s]
Map:  21%|██▏       | 1394/6548 [00:04<00:17, 302.80 examples/s]
Map:  22%|██▏       | 1430/6548 [00:04<00:16, 309.30 examples/s]
Map:  23%|██▎       | 1480/6548 [00:04<00:17, 284.07 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:18, 279.59 examples/s]
Map:  24%|██▎       | 1542/6548 [00:04<00:18, 277.41 examples/s]
Map:  24%|██▍       | 1576/6548 [00:04<00:17, 286.01 examples/s]
Map:  25%|██▍       | 1609/6548 [00:05<00:17, 283.83 examples/s]
Map:  25%|██▌       | 1638/6548 [00:05<00:17, 283.20 examples/s]
Map:  26%|██▌       | 1676/6548 [00:05<00:18, 261.00 examples/s]
Map:  26%|██▌       | 1717/6548 [00:05<00:16, 293.83 examples/s]
Map:  27%|██▋       | 1766/6548 [00:05<00:14, 338.37 examples/s]
Map:  28%|██▊       | 1807/6548 [00:05<00:13, 351.35 examples/s]
Map:  28%|██▊       | 1848/6548 [00:05<00:12, 367.00 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:14, 323.55 examples/s]
Map:  30%|██▉       | 1947/6548 [00:06<00:13, 341.30 examples/s]
Map:  30%|███       | 1991/6548 [00:06<00:12, 361.21 examples/s]
Map:  31%|███       | 2041/6548 [00:06<00:19, 225.96 examples/s]
Map:  32%|███▏      | 2081/6548 [00:06<00:17, 255.44 examples/s]
Map:  32%|███▏      | 2124/6548 [00:06<00:16, 274.86 examples/s]
Map:  33%|███▎      | 2160/6548 [00:07<00:18, 239.26 examples/s]
Map:  34%|███▍      | 2210/6548 [00:07<00:14, 289.99 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:16, 263.63 examples/s]
Map:  35%|███▌      | 2293/6548 [00:07<00:15, 276.62 examples/s]
Map:  36%|███▌      | 2333/6548 [00:07<00:14, 297.52 examples/s]
Map:  36%|███▋      | 2376/6548 [00:07<00:15, 277.76 examples/s]
Map:  37%|███▋      | 2411/6548 [00:07<00:14, 291.84 examples/s]
Map:  38%|███▊      | 2460/6548 [00:08<00:13, 294.50 examples/s]
Map:  38%|███▊      | 2495/6548 [00:08<00:13, 299.87 examples/s]
Map:  39%|███▉      | 2551/6548 [00:08<00:12, 315.99 examples/s]
Map:  40%|███▉      | 2599/6548 [00:08<00:11, 348.11 examples/s]
Map:  40%|████      | 2641/6548 [00:08<00:10, 362.84 examples/s]
Map:  41%|████      | 2687/6548 [00:08<00:11, 324.97 examples/s]
Map:  42%|████▏     | 2724/6548 [00:08<00:11, 333.93 examples/s]
Map:  42%|████▏     | 2766/6548 [00:08<00:10, 351.98 examples/s]
Map:  43%|████▎     | 2818/6548 [00:09<00:12, 310.31 examples/s]
Map:  44%|████▎     | 2862/6548 [00:09<00:13, 275.22 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 285.77 examples/s]
Map:  45%|████▌     | 2951/6548 [00:09<00:11, 301.14 examples/s]
Map:  46%|████▌     | 2983/6548 [00:09<00:11, 301.31 examples/s]
Map:  46%|████▌     | 3026/6548 [00:10<00:20, 168.23 examples/s]
Map:  47%|████▋     | 3062/6548 [00:10<00:17, 195.05 examples/s]
Map:  47%|████▋     | 3097/6548 [00:10<00:15, 221.30 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 253.26 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:13, 256.69 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 250.94 examples/s]
Map:  50%|████▉     | 3245/6548 [00:10<00:13, 253.60 examples/s]
Map:  50%|█████     | 3280/6548 [00:11<00:12, 271.68 examples/s]
Map:  51%|█████     | 3322/6548 [00:11<00:10, 303.20 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:11<00:10, 301.55 examples/s]
Map:  52%|█████▏    | 3421/6548 [00:11<00:11, 275.06 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 270.54 examples/s]
Map:  53%|█████▎    | 3485/6548 [00:11<00:11, 275.60 examples/s]
Map:  54%|█████▍    | 3530/6548 [00:11<00:09, 314.83 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:11<00:08, 344.10 examples/s]
Map:  55%|█████▌    | 3622/6548 [00:12<00:07, 369.29 examples/s]
Map:  56%|█████▌    | 3661/6548 [00:12<00:07, 372.09 examples/s]
Map:  57%|█████▋    | 3722/6548 [00:12<00:07, 379.67 examples/s]
Map:  58%|█████▊    | 3778/6548 [00:12<00:07, 374.69 examples/s]
Map:  58%|█████▊    | 3817/6548 [00:12<00:07, 375.49 examples/s]
Map:  59%|█████▉    | 3865/6548 [00:12<00:08, 309.61 examples/s]
Map:  60%|█████▉    | 3914/6548 [00:12<00:08, 327.53 examples/s]
Map:  61%|██████    | 3967/6548 [00:13<00:07, 333.07 examples/s]
Map:  62%|██████▏   | 4030/6548 [00:13<00:09, 260.06 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 297.65 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 320.22 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:07, 299.41 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:13<00:07, 314.98 examples/s]
Map:  65%|██████▌   | 4260/6548 [00:14<00:06, 351.33 examples/s]
Map:  66%|██████▌   | 4325/6548 [00:14<00:05, 370.71 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:14<00:06, 339.05 examples/s]
Map:  67%|██████▋   | 4405/6548 [00:14<00:06, 344.19 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:05, 371.76 examples/s]
Map:  69%|██████▊   | 4497/6548 [00:14<00:06, 331.81 examples/s]
Map:  69%|██████▉   | 4546/6548 [00:14<00:06, 316.73 examples/s]
Map:  70%|███████   | 4584/6548 [00:14<00:06, 323.62 examples/s]
Map:  71%|███████   | 4626/6548 [00:15<00:05, 343.01 examples/s]
Map:  71%|███████▏  | 4668/6548 [00:15<00:05, 360.41 examples/s]
Map:  72%|███████▏  | 4730/6548 [00:15<00:04, 365.50 examples/s]
Map:  73%|███████▎  | 4782/6548 [00:15<00:04, 397.73 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 397.15 examples/s]
Map:  75%|███████▍  | 4880/6548 [00:15<00:04, 375.04 examples/s]
Map:  75%|███████▌  | 4932/6548 [00:15<00:04, 390.92 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:03, 404.33 examples/s]
Map:  77%|███████▋  | 5038/6548 [00:16<00:05, 255.18 examples/s]
Map:  78%|███████▊  | 5081/6548 [00:16<00:05, 255.90 examples/s]
Map:  78%|███████▊  | 5120/6548 [00:16<00:05, 255.78 examples/s]
Map:  79%|███████▊  | 5155/6548 [00:16<00:05, 269.07 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:05, 262.55 examples/s]
Map:  80%|███████▉  | 5221/6548 [00:17<00:04, 271.61 examples/s]
Map:  80%|████████  | 5256/6548 [00:17<00:04, 283.60 examples/s]
Map:  81%|████████  | 5312/6548 [00:17<00:03, 349.97 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 297.40 examples/s]
Map:  83%|████████▎ | 5407/6548 [00:17<00:03, 288.04 examples/s]
Map:  83%|████████▎ | 5444/6548 [00:17<00:03, 301.52 examples/s]
Map:  84%|████████▎ | 5481/6548 [00:17<00:03, 307.07 examples/s]
Map:  85%|████████▍ | 5534/6548 [00:18<00:03, 317.19 examples/s]
Map:  85%|████████▌ | 5572/6548 [00:18<00:03, 314.38 examples/s]
Map:  86%|████████▌ | 5631/6548 [00:18<00:02, 332.92 examples/s]
Map:  87%|████████▋ | 5677/6548 [00:18<00:02, 323.15 examples/s]
Map:  87%|████████▋ | 5723/6548 [00:18<00:02, 308.87 examples/s]
Map:  88%|████████▊ | 5766/6548 [00:18<00:02, 334.84 examples/s]
Map:  89%|████████▊ | 5802/6548 [00:18<00:02, 339.76 examples/s]
Map:  89%|████████▉ | 5844/6548 [00:18<00:02, 338.38 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:19<00:01, 344.51 examples/s]
Map:  90%|█████████ | 5923/6548 [00:19<00:01, 355.88 examples/s]
Map:  91%|█████████ | 5960/6548 [00:19<00:01, 348.56 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 209.95 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:02, 243.83 examples/s]
Map:  93%|█████████▎| 6081/6548 [00:19<00:01, 275.27 examples/s]
Map:  93%|█████████▎| 6117/6548 [00:19<00:01, 258.69 examples/s]
Map:  94%|█████████▍| 6154/6548 [00:20<00:01, 282.46 examples/s]
Map:  95%|█████████▍| 6190/6548 [00:20<00:01, 295.81 examples/s]
Map:  95%|█████████▌| 6233/6548 [00:20<00:00, 328.10 examples/s]
Map:  96%|█████████▌| 6271/6548 [00:20<00:00, 331.38 examples/s]
Map:  96%|█████████▋| 6310/6548 [00:20<00:00, 340.83 examples/s]
Map:  97%|█████████▋| 6347/6548 [00:20<00:00, 347.88 examples/s]
Map:  98%|█████████▊| 6390/6548 [00:20<00:00, 369.38 examples/s]
Map:  98%|█████████▊| 6430/6548 [00:20<00:00, 375.12 examples/s]
Map:  99%|█████████▉| 6477/6548 [00:20<00:00, 400.58 examples/s]
Map: 100%|█████████▉| 6529/6548 [00:21<00:00, 376.98 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 308.32 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   3%|▎         | 30/903 [00:00<00:03, 276.23 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 325.27 examples/s]
Map:  13%|█▎        | 119/903 [00:00<00:02, 322.81 examples/s]
Map:  18%|█▊        | 164/903 [00:00<00:02, 363.68 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 386.86 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 392.81 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 382.82 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 334.04 examples/s]
Map:  45%|████▌     | 408/903 [00:01<00:01, 300.30 examples/s]
Map:  50%|████▉     | 450/903 [00:01<00:01, 284.84 examples/s]
Map:  54%|█████▍    | 486/903 [00:01<00:01, 288.84 examples/s]
Map:  59%|█████▉    | 531/903 [00:01<00:01, 320.47 examples/s]
Map:  63%|██████▎   | 570/903 [00:01<00:00, 334.51 examples/s]
Map:  68%|██████▊   | 614/903 [00:01<00:00, 357.59 examples/s]
Map:  72%|███████▏  | 654/903 [00:01<00:00, 365.01 examples/s]
Map:  77%|███████▋  | 697/903 [00:02<00:00, 379.90 examples/s]
Map:  82%|████████▏ | 743/903 [00:02<00:00, 399.46 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 392.13 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 394.18 examples/s]
Map:  96%|█████████▋| 871/903 [00:02<00:00, 408.08 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 323.85 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 298.53 examples/s]
Map:   4%|▍         | 81/1882 [00:00<00:04, 365.95 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 349.48 examples/s]
Map:   9%|▊         | 161/1882 [00:00<00:04, 370.87 examples/s]
Map:  11%|█         | 208/1882 [00:00<00:04, 341.88 examples/s]
Map:  14%|█▎        | 255/1882 [00:00<00:04, 377.33 examples/s]
Map:  16%|█▋        | 310/1882 [00:00<00:04, 363.01 examples/s]
Map:  19%|█▉        | 356/1882 [00:01<00:04, 338.96 examples/s]
Map:  21%|██        | 393/1882 [00:01<00:04, 305.26 examples/s]
Map:  23%|██▎       | 433/1882 [00:01<00:05, 287.82 examples/s]
Map:  25%|██▍       | 469/1882 [00:01<00:04, 303.26 examples/s]
Map:  27%|██▋       | 505/1882 [00:01<00:04, 315.93 examples/s]
Map:  29%|██▉       | 552/1882 [00:01<00:04, 312.85 examples/s]
Map:  32%|███▏      | 603/1882 [00:01<00:03, 351.47 examples/s]
Map:  35%|███▍      | 653/1882 [00:01<00:03, 376.75 examples/s]
Map:  37%|███▋      | 696/1882 [00:02<00:03, 386.23 examples/s]
Map:  40%|████      | 756/1882 [00:02<00:02, 385.45 examples/s]
Map:  43%|████▎     | 805/1882 [00:02<00:03, 339.25 examples/s]
Map:  45%|████▌     | 848/1882 [00:02<00:02, 353.86 examples/s]
Map:  47%|████▋     | 890/1882 [00:02<00:02, 365.69 examples/s]
Map:  49%|████▉     | 931/1882 [00:02<00:02, 365.57 examples/s]
Map:  52%|█████▏    | 983/1882 [00:02<00:02, 402.98 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 252.85 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 265.64 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 276.77 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 284.66 examples/s]
Map:  62%|██████▏   | 1176/1882 [00:03<00:02, 301.17 examples/s]
Map:  65%|██████▌   | 1229/1882 [00:03<00:02, 281.79 examples/s]
Map:  67%|██████▋   | 1266/1882 [00:03<00:02, 299.91 examples/s]
Map:  70%|██████▉   | 1308/1882 [00:04<00:01, 327.76 examples/s]
Map:  72%|███████▏  | 1347/1882 [00:04<00:01, 340.79 examples/s]
Map:  74%|███████▍  | 1390/1882 [00:04<00:01, 317.72 examples/s]
Map:  76%|███████▌  | 1428/1882 [00:04<00:01, 281.66 examples/s]
Map:  78%|███████▊  | 1471/1882 [00:04<00:01, 307.85 examples/s]
Map:  80%|████████  | 1507/1882 [00:04<00:01, 274.06 examples/s]
Map:  82%|████████▏ | 1538/1882 [00:04<00:01, 275.23 examples/s]
Map:  84%|████████▍ | 1582/1882 [00:04<00:00, 311.74 examples/s]
Map:  86%|████████▌ | 1622/1882 [00:05<00:00, 331.78 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 334.85 examples/s]
Map:  91%|█████████ | 1712/1882 [00:05<00:00, 335.65 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 279.29 examples/s]
Map:  96%|█████████▌| 1799/1882 [00:05<00:00, 285.33 examples/s]
Map:  98%|█████████▊| 1844/1882 [00:05<00:00, 318.47 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 233.55 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 311.31 examples/s]
10/12/2024 13:16:07 - INFO - __main__ -     ***** Testing *****
10/12/2024 13:16:07 - INFO - __main__ -     Batch size = 8
10/12/2024 13:16:07 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 13:16:08 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 13:16:08 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 13:16:09 - INFO - knnlm -   Reading datastore took 0.8459136486053467 s
10/12/2024 13:16:09 - INFO - knnlm -   Moving index to GPU took 0.9102821350097656 s
10/12/2024 13:16:09 - INFO - __main__ -   ******************************break-into
10/12/2024 13:16:09 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 13:16:09 - INFO - __main__ -     Num examples = 236
10/12/2024 13:16:09 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:20,  7.49s/it]
test ppl:   1%|          | 2/236 [00:09<16:59,  4.36s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:52,  3.06s/it]
test ppl:   2%|▏         | 4/236 [00:17<16:08,  4.18s/it]
test ppl:   2%|▏         | 5/236 [00:22<18:28,  4.80s/it]
test ppl:   3%|▎         | 6/236 [00:28<18:59,  4.95s/it]
test ppl:   3%|▎         | 7/236 [00:30<15:04,  3.95s/it]
test ppl:   3%|▎         | 8/236 [00:34<15:26,  4.06s/it]
test ppl:   4%|▍         | 9/236 [00:36<13:05,  3.46s/it]
test ppl:   4%|▍         | 10/236 [00:42<15:54,  4.22s/it]
test ppl:   5%|▍         | 11/236 [00:44<13:42,  3.65s/it]
test ppl:   5%|▌         | 12/236 [00:50<16:13,  4.34s/it]
test ppl:   6%|▌         | 13/236 [00:56<17:53,  4.82s/it]
test ppl:   6%|▌         | 14/236 [00:58<15:03,  4.07s/it]
test ppl:   6%|▋         | 15/236 [01:00<11:54,  3.23s/it]
test ppl:   7%|▋         | 16/236 [01:02<10:20,  2.82s/it]
test ppl:   7%|▋         | 17/236 [01:08<13:40,  3.75s/it]
test ppl:   8%|▊         | 18/236 [01:09<11:22,  3.13s/it]
test ppl:   8%|▊         | 19/236 [01:14<12:46,  3.53s/it]
test ppl:   8%|▊         | 20/236 [01:16<10:49,  3.01s/it]
test ppl:   9%|▉         | 21/236 [01:21<13:52,  3.87s/it]
test ppl:   9%|▉         | 22/236 [01:27<16:04,  4.50s/it]
test ppl:  10%|▉         | 23/236 [01:30<13:53,  3.91s/it]
test ppl:  10%|█         | 24/236 [01:32<12:09,  3.44s/it]
test ppl:  11%|█         | 25/236 [01:34<10:19,  2.93s/it]
test ppl:  11%|█         | 26/236 [01:40<13:24,  3.83s/it]
test ppl:  11%|█▏        | 27/236 [01:43<12:56,  3.72s/it]
test ppl:  12%|█▏        | 28/236 [01:45<10:16,  2.97s/it]
test ppl:  12%|█▏        | 29/236 [01:47<09:35,  2.78s/it]
test ppl:  13%|█▎        | 30/236 [01:48<08:15,  2.40s/it]
test ppl:  13%|█▎        | 31/236 [01:50<07:48,  2.28s/it]
test ppl:  14%|█▎        | 32/236 [01:53<08:08,  2.39s/it]
test ppl:  14%|█▍        | 33/236 [01:56<08:10,  2.42s/it]
test ppl:  14%|█▍        | 34/236 [02:00<09:44,  2.89s/it]
test ppl:  15%|█▍        | 35/236 [02:02<09:20,  2.79s/it]
test ppl:  15%|█▌        | 36/236 [02:08<12:23,  3.72s/it]
test ppl:  16%|█▌        | 37/236 [02:14<14:32,  4.38s/it]
test ppl:  16%|█▌        | 38/236 [02:16<12:10,  3.69s/it]
test ppl:  17%|█▋        | 39/236 [02:18<10:15,  3.13s/it]
test ppl:  17%|█▋        | 40/236 [02:20<09:42,  2.97s/it]
test ppl:  17%|█▋        | 41/236 [02:22<08:34,  2.64s/it]
test ppl:  18%|█▊        | 42/236 [02:28<11:44,  3.63s/it]
test ppl:  18%|█▊        | 43/236 [02:34<13:52,  4.31s/it]
test ppl:  19%|█▊        | 44/236 [02:37<11:55,  3.73s/it]
test ppl:  19%|█▉        | 45/236 [02:38<10:11,  3.20s/it]
test ppl:  19%|█▉        | 46/236 [02:44<12:44,  4.02s/it]
test ppl:  20%|█▉        | 47/236 [02:46<10:19,  3.28s/it]
test ppl:  20%|██        | 48/236 [02:52<12:42,  4.06s/it]
test ppl:  21%|██        | 49/236 [02:56<12:23,  3.97s/it]
test ppl:  21%|██        | 50/236 [03:02<14:10,  4.57s/it]
test ppl:  22%|██▏       | 51/236 [03:08<15:21,  4.98s/it]
test ppl:  22%|██▏       | 52/236 [03:13<16:08,  5.26s/it]
test ppl:  22%|██▏       | 53/236 [03:18<15:39,  5.13s/it]
test ppl:  23%|██▎       | 54/236 [03:20<12:18,  4.06s/it]
test ppl:  23%|██▎       | 55/236 [03:26<13:45,  4.56s/it]
test ppl:  24%|██▎       | 56/236 [03:32<14:55,  4.98s/it]
test ppl:  24%|██▍       | 57/236 [03:34<12:28,  4.18s/it]
test ppl:  25%|██▍       | 58/236 [03:36<10:37,  3.58s/it]
test ppl:  25%|██▌       | 59/236 [03:42<12:38,  4.28s/it]
test ppl:  25%|██▌       | 60/236 [03:45<11:27,  3.90s/it]
test ppl:  26%|██▌       | 61/236 [03:51<13:08,  4.51s/it]
test ppl:  26%|██▋       | 62/236 [03:57<14:17,  4.93s/it]
test ppl:  27%|██▋       | 63/236 [03:59<12:05,  4.19s/it]
test ppl:  27%|██▋       | 64/236 [04:01<10:13,  3.57s/it]
test ppl:  28%|██▊       | 65/236 [04:03<08:15,  2.90s/it]
test ppl:  28%|██▊       | 66/236 [04:06<08:19,  2.94s/it]
test ppl:  28%|██▊       | 67/236 [04:08<07:56,  2.82s/it]
test ppl:  29%|██▉       | 68/236 [04:14<10:29,  3.75s/it]
test ppl:  29%|██▉       | 69/236 [04:20<12:13,  4.39s/it]
test ppl:  30%|██▉       | 70/236 [04:22<09:51,  3.57s/it]
test ppl:  30%|███       | 71/236 [04:25<09:36,  3.50s/it]
test ppl:  31%|███       | 72/236 [04:29<09:51,  3.61s/it]
test ppl:  31%|███       | 73/236 [04:34<11:21,  4.18s/it]
test ppl:  31%|███▏      | 74/236 [04:36<09:07,  3.38s/it]
test ppl:  32%|███▏      | 75/236 [04:42<11:10,  4.17s/it]
test ppl:  32%|███▏      | 76/236 [04:45<10:23,  3.90s/it]
test ppl:  33%|███▎      | 77/236 [04:48<09:02,  3.41s/it]
test ppl:  33%|███▎      | 78/236 [04:49<07:29,  2.84s/it]
test ppl:  33%|███▎      | 79/236 [04:53<08:17,  3.17s/it]
test ppl:  34%|███▍      | 80/236 [04:55<07:12,  2.77s/it]
test ppl:  34%|███▍      | 81/236 [05:01<09:37,  3.72s/it]
test ppl:  35%|███▍      | 82/236 [05:07<11:14,  4.38s/it]
test ppl:  35%|███▌      | 83/236 [05:09<09:52,  3.87s/it]
test ppl:  36%|███▌      | 84/236 [05:11<08:18,  3.28s/it]
test ppl:  36%|███▌      | 85/236 [05:15<08:54,  3.54s/it]
test ppl:  36%|███▋      | 86/236 [05:17<07:37,  3.05s/it]
test ppl:  37%|███▋      | 87/236 [05:19<06:51,  2.76s/it]
test ppl:  37%|███▋      | 88/236 [05:25<09:07,  3.70s/it]
test ppl:  38%|███▊      | 89/236 [05:31<10:41,  4.36s/it]
test ppl:  38%|███▊      | 90/236 [05:37<11:44,  4.82s/it]
test ppl:  39%|███▊      | 91/236 [05:42<11:43,  4.85s/it]
test ppl:  39%|███▉      | 92/236 [05:45<10:10,  4.24s/it]
test ppl:  39%|███▉      | 93/236 [05:51<11:15,  4.73s/it]
test ppl:  40%|███▉      | 94/236 [05:57<12:01,  5.08s/it]
test ppl:  40%|████      | 95/236 [05:59<10:22,  4.41s/it]
test ppl:  41%|████      | 96/236 [06:02<09:16,  3.97s/it]
test ppl:  41%|████      | 97/236 [06:08<10:31,  4.54s/it]
test ppl:  42%|████▏     | 98/236 [06:14<11:23,  4.95s/it]
test ppl:  42%|████▏     | 99/236 [06:20<11:57,  5.24s/it]
test ppl:  42%|████▏     | 100/236 [06:21<09:09,  4.04s/it]
test ppl:  43%|████▎     | 101/236 [06:27<10:20,  4.59s/it]
test ppl:  43%|████▎     | 102/236 [06:30<09:09,  4.10s/it]
test ppl:  44%|████▎     | 103/236 [06:32<07:19,  3.30s/it]
test ppl:  44%|████▍     | 104/236 [06:36<07:53,  3.59s/it]
test ppl:  44%|████▍     | 105/236 [06:40<08:22,  3.83s/it]
test ppl:  45%|████▍     | 106/236 [06:46<09:19,  4.30s/it]
test ppl:  45%|████▌     | 107/236 [06:48<07:43,  3.59s/it]
test ppl:  46%|████▌     | 108/236 [06:53<09:00,  4.22s/it]
test ppl:  46%|████▌     | 109/236 [06:57<08:48,  4.16s/it]
test ppl:  47%|████▋     | 110/236 [06:59<07:07,  3.39s/it]
test ppl:  47%|████▋     | 111/236 [07:03<07:26,  3.57s/it]
test ppl:  47%|████▋     | 112/236 [07:06<07:16,  3.52s/it]
test ppl:  48%|████▊     | 113/236 [07:08<06:08,  2.99s/it]
test ppl:  48%|████▊     | 114/236 [07:11<06:17,  3.10s/it]
test ppl:  49%|████▊     | 115/236 [07:17<07:55,  3.93s/it]
test ppl:  49%|████▉     | 116/236 [07:23<09:02,  4.52s/it]
test ppl:  50%|████▉     | 117/236 [07:25<07:22,  3.72s/it]
test ppl:  50%|█████     | 118/236 [07:29<07:45,  3.94s/it]
test ppl:  50%|█████     | 119/236 [07:34<08:08,  4.18s/it]
test ppl:  51%|█████     | 120/236 [07:36<06:32,  3.39s/it]
test ppl:  51%|█████▏    | 121/236 [07:42<07:57,  4.15s/it]
test ppl:  52%|█████▏    | 122/236 [07:46<08:15,  4.34s/it]
test ppl:  52%|█████▏    | 123/236 [07:49<06:56,  3.69s/it]
test ppl:  53%|█████▎    | 124/236 [07:51<06:09,  3.30s/it]
test ppl:  53%|█████▎    | 125/236 [07:57<07:32,  4.08s/it]
test ppl:  53%|█████▎    | 126/236 [08:02<07:55,  4.33s/it]
test ppl:  54%|█████▍    | 127/236 [08:04<06:38,  3.66s/it]
test ppl:  54%|█████▍    | 128/236 [08:06<05:50,  3.25s/it]
test ppl:  55%|█████▍    | 129/236 [08:09<05:38,  3.16s/it]
test ppl:  55%|█████▌    | 130/236 [08:12<05:19,  3.02s/it]
test ppl:  56%|█████▌    | 131/236 [08:18<06:50,  3.91s/it]
test ppl:  56%|█████▌    | 132/236 [08:20<06:02,  3.48s/it]
test ppl:  56%|█████▋    | 133/236 [08:24<06:11,  3.61s/it]
test ppl:  57%|█████▋    | 134/236 [08:28<06:16,  3.69s/it]
test ppl:  57%|█████▋    | 135/236 [08:34<07:19,  4.36s/it]
test ppl:  58%|█████▊    | 136/236 [08:35<05:42,  3.43s/it]
test ppl:  58%|█████▊    | 137/236 [08:41<06:53,  4.18s/it]
test ppl:  58%|█████▊    | 138/236 [08:44<06:20,  3.88s/it]
test ppl:  59%|█████▉    | 139/236 [08:47<05:39,  3.50s/it]
test ppl:  59%|█████▉    | 140/236 [08:49<04:45,  2.98s/it]
test ppl:  60%|█████▉    | 141/236 [08:52<04:40,  2.95s/it]
test ppl:  60%|██████    | 142/236 [08:54<04:13,  2.70s/it]
test ppl:  61%|██████    | 143/236 [08:59<05:25,  3.50s/it]
test ppl:  61%|██████    | 144/236 [09:02<05:00,  3.27s/it]
test ppl:  61%|██████▏   | 145/236 [09:08<06:09,  4.06s/it]
test ppl:  62%|██████▏   | 146/236 [09:12<06:17,  4.20s/it]
test ppl:  62%|██████▏   | 147/236 [09:18<06:59,  4.71s/it]
test ppl:  63%|██████▎   | 148/236 [09:24<07:28,  5.10s/it]
test ppl:  63%|██████▎   | 149/236 [09:28<06:39,  4.59s/it]
test ppl:  64%|██████▎   | 150/236 [09:33<07:08,  4.98s/it]
test ppl:  64%|██████▍   | 151/236 [09:39<07:26,  5.25s/it]
test ppl:  64%|██████▍   | 152/236 [09:45<07:37,  5.44s/it]
test ppl:  65%|██████▍   | 153/236 [09:50<07:21,  5.32s/it]
test ppl:  65%|██████▌   | 154/236 [09:53<06:08,  4.49s/it]
test ppl:  66%|██████▌   | 155/236 [09:56<05:20,  3.95s/it]
test ppl:  66%|██████▌   | 156/236 [09:58<04:34,  3.43s/it]
test ppl:  67%|██████▋   | 157/236 [10:00<04:03,  3.08s/it]
test ppl:  67%|██████▋   | 158/236 [10:06<05:07,  3.95s/it]
test ppl:  67%|██████▋   | 159/236 [10:12<05:50,  4.55s/it]
test ppl:  68%|██████▊   | 160/236 [10:13<04:28,  3.54s/it]
test ppl:  68%|██████▊   | 161/236 [10:15<03:37,  2.90s/it]
test ppl:  69%|██████▊   | 162/236 [10:18<03:40,  2.98s/it]
test ppl:  69%|██████▉   | 163/236 [10:20<03:28,  2.86s/it]
test ppl:  69%|██████▉   | 164/236 [10:24<03:51,  3.21s/it]
test ppl:  70%|██████▉   | 165/236 [10:29<04:18,  3.64s/it]
test ppl:  70%|███████   | 166/236 [10:31<03:35,  3.07s/it]
test ppl:  71%|███████   | 167/236 [10:32<02:59,  2.60s/it]
test ppl:  71%|███████   | 168/236 [10:36<03:30,  3.10s/it]
test ppl:  72%|███████▏  | 169/236 [10:42<04:25,  3.96s/it]
test ppl:  72%|███████▏  | 170/236 [10:48<05:01,  4.57s/it]
test ppl:  72%|███████▏  | 171/236 [10:50<03:54,  3.60s/it]
test ppl:  73%|███████▎  | 172/236 [10:56<04:35,  4.31s/it]
test ppl:  73%|███████▎  | 173/236 [11:00<04:24,  4.19s/it]
test ppl:  74%|███████▎  | 174/236 [11:06<04:52,  4.72s/it]
test ppl:  74%|███████▍  | 175/236 [11:07<03:55,  3.87s/it]
test ppl:  75%|███████▍  | 176/236 [11:13<04:28,  4.47s/it]
test ppl:  75%|███████▌  | 177/236 [11:19<04:49,  4.91s/it]
test ppl:  75%|███████▌  | 178/236 [11:25<05:04,  5.25s/it]
test ppl:  76%|███████▌  | 179/236 [11:31<05:10,  5.46s/it]
test ppl:  76%|███████▋  | 180/236 [11:35<04:34,  4.91s/it]
test ppl:  77%|███████▋  | 181/236 [11:41<04:46,  5.21s/it]
test ppl:  77%|███████▋  | 182/236 [11:43<03:47,  4.22s/it]
test ppl:  78%|███████▊  | 183/236 [11:45<03:13,  3.64s/it]
test ppl:  78%|███████▊  | 184/236 [11:46<02:35,  2.99s/it]
test ppl:  78%|███████▊  | 185/236 [11:50<02:45,  3.24s/it]
test ppl:  79%|███████▉  | 186/236 [11:52<02:23,  2.87s/it]
test ppl:  79%|███████▉  | 187/236 [11:58<03:06,  3.80s/it]
test ppl:  80%|███████▉  | 188/236 [12:04<03:33,  4.44s/it]
test ppl:  80%|████████  | 189/236 [12:10<03:49,  4.88s/it]
test ppl:  81%|████████  | 190/236 [12:14<03:27,  4.52s/it]
test ppl:  81%|████████  | 191/236 [12:18<03:13,  4.31s/it]
test ppl:  81%|████████▏ | 192/236 [12:20<02:47,  3.81s/it]
test ppl:  82%|████████▏ | 193/236 [12:26<03:11,  4.45s/it]
test ppl:  82%|████████▏ | 194/236 [12:29<02:43,  3.90s/it]
test ppl:  83%|████████▎ | 195/236 [12:32<02:29,  3.65s/it]
test ppl:  83%|████████▎ | 196/236 [12:34<02:06,  3.17s/it]
test ppl:  83%|████████▎ | 197/236 [12:36<01:51,  2.86s/it]
test ppl:  84%|████████▍ | 198/236 [12:42<02:23,  3.78s/it]
test ppl:  84%|████████▍ | 199/236 [12:45<02:08,  3.46s/it]
test ppl:  85%|████████▍ | 200/236 [12:51<02:30,  4.19s/it]
test ppl:  85%|████████▌ | 201/236 [12:53<02:03,  3.54s/it]
test ppl:  86%|████████▌ | 202/236 [12:57<02:11,  3.87s/it]
test ppl:  86%|████████▌ | 203/236 [13:03<02:28,  4.49s/it]
test ppl:  86%|████████▋ | 204/236 [13:05<01:56,  3.64s/it]
test ppl:  87%|████████▋ | 205/236 [13:11<02:14,  4.32s/it]
test ppl:  87%|████████▋ | 206/236 [13:14<02:00,  4.02s/it]
test ppl:  88%|████████▊ | 207/236 [13:20<02:12,  4.58s/it]
test ppl:  88%|████████▊ | 208/236 [13:23<01:56,  4.16s/it]
test ppl:  89%|████████▊ | 209/236 [13:29<02:06,  4.70s/it]
test ppl:  89%|████████▉ | 210/236 [13:31<01:43,  4.00s/it]
test ppl:  89%|████████▉ | 211/236 [13:35<01:38,  3.94s/it]
test ppl:  90%|████████▉ | 212/236 [13:41<01:48,  4.53s/it]
test ppl:  90%|█████████ | 213/236 [13:47<01:53,  4.93s/it]
test ppl:  91%|█████████ | 214/236 [13:49<01:26,  3.94s/it]
test ppl:  91%|█████████ | 215/236 [13:55<01:35,  4.53s/it]
test ppl:  92%|█████████▏| 216/236 [13:56<01:13,  3.67s/it]
test ppl:  92%|█████████▏| 217/236 [14:02<01:22,  4.37s/it]
test ppl:  92%|█████████▏| 218/236 [14:04<01:05,  3.63s/it]
test ppl:  93%|█████████▎| 219/236 [14:10<01:13,  4.32s/it]
test ppl:  93%|█████████▎| 220/236 [14:16<01:16,  4.79s/it]
test ppl:  94%|█████████▎| 221/236 [14:18<00:58,  3.87s/it]
test ppl:  94%|█████████▍| 222/236 [14:24<01:02,  4.48s/it]
test ppl:  94%|█████████▍| 223/236 [14:30<01:03,  4.91s/it]
test ppl:  95%|█████████▍| 224/236 [14:31<00:46,  3.91s/it]
test ppl:  95%|█████████▌| 225/236 [14:37<00:49,  4.50s/it]
test ppl:  96%|█████████▌| 226/236 [14:41<00:42,  4.25s/it]
test ppl:  96%|█████████▌| 227/236 [14:44<00:34,  3.84s/it]
test ppl:  97%|█████████▋| 228/236 [14:46<00:26,  3.31s/it]
test ppl:  97%|█████████▋| 229/236 [14:51<00:28,  4.08s/it]
test ppl:  97%|█████████▋| 230/236 [14:55<00:23,  3.90s/it]
test ppl:  98%|█████████▊| 231/236 [14:58<00:18,  3.73s/it]
test ppl:  98%|█████████▊| 232/236 [15:00<00:12,  3.14s/it]
test ppl:  99%|█████████▊| 233/236 [15:02<00:08,  2.84s/it]
test ppl:  99%|█████████▉| 234/236 [15:03<00:04,  2.36s/it]
test ppl: 100%|█████████▉| 235/236 [15:09<00:03,  3.42s/it]
test ppl: 100%|██████████| 236/236 [15:10<00:00,  2.59s/it]
test ppl: 100%|██████████| 236/236 [15:10<00:00,  3.86s/it]
10/12/2024 13:31:20 - INFO - __main__ -    em: 0.2099
10/12/2024 13:31:20 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.4 40:  em: 0.2099

--------------------------------------------------------------------------------
Running experiment with knn_temp=40, lmbda=0.4, k=64
2024-10-12 13:31:27.476423: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 13:31:27.495829: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 13:31:27.517665: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 13:31:27.524292: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 13:31:27.540236: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 13:31:28.529645: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 13:31:29 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.4, knn_temp=40, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 13:31:29 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:41:27,  2.19it/s]
Adding feature api:   4%|▍         | 7098/187062 [00:00<00:10, 16933.00it/s]
Adding feature api:   8%|▊         | 15419/187062 [00:00<00:05, 33779.08it/s]
Adding feature api:  13%|█▎        | 23801/187062 [00:00<00:03, 47108.39it/s]
Adding feature api:  17%|█▋        | 32205/187062 [00:00<00:02, 57287.11it/s]
Adding feature api:  22%|██▏       | 40348/187062 [00:00<00:02, 64106.15it/s]
Adding feature api:  26%|██▌       | 48727/187062 [00:01<00:01, 69764.16it/s]
Adding feature api:  31%|███       | 57166/187062 [00:01<00:01, 74021.57it/s]
Adding feature api:  35%|███▌      | 65555/187062 [00:01<00:01, 76918.08it/s]
Adding feature api:  39%|███▉      | 73773/187062 [00:01<00:01, 78472.01it/s]
Adding feature api:  44%|████▍     | 82217/187062 [00:01<00:01, 80242.51it/s]
Adding feature api:  48%|████▊     | 90660/187062 [00:01<00:01, 81487.10it/s]
Adding feature api:  53%|█████▎    | 99075/187062 [00:01<00:01, 82280.09it/s]
Adding feature api:  57%|█████▋    | 107426/187062 [00:01<00:00, 82261.47it/s]
Adding feature api:  62%|██████▏   | 115852/187062 [00:01<00:00, 82856.46it/s]
Adding feature api:  66%|██████▋   | 124300/187062 [00:01<00:00, 83341.02it/s]
Adding feature api:  71%|███████   | 132695/187062 [00:02<00:00, 83521.79it/s]
Adding feature api:  75%|███████▌  | 141118/187062 [00:02<00:00, 83731.70it/s]
Adding feature api:  80%|███████▉  | 149513/187062 [00:02<00:00, 83175.96it/s]
Adding feature api:  84%|████████▍ | 157981/187062 [00:02<00:00, 83623.21it/s]
Adding feature api:  89%|████████▉ | 166365/187062 [00:02<00:00, 83684.53it/s]
Adding feature api:  93%|█████████▎| 174850/187062 [00:02<00:00, 84030.72it/s]
Adding feature api:  98%|█████████▊| 183259/187062 [00:02<00:00, 58781.49it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64117.65it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:30:02,  2.21it/s]
Adding feature datatype:   4%|▍         | 7061/187062 [00:00<00:10, 16948.42it/s]
Adding feature datatype:   8%|▊         | 15170/187062 [00:00<00:05, 33325.92it/s]
Adding feature datatype:  12%|█▏        | 23356/187062 [00:00<00:03, 46296.58it/s]
Adding feature datatype:  17%|█▋        | 31182/187062 [00:00<00:02, 55127.10it/s]
Adding feature datatype:  21%|██        | 39289/187062 [00:00<00:02, 62466.75it/s]
Adding feature datatype:  25%|██▌       | 47476/187062 [00:01<00:02, 68050.34it/s]
Adding feature datatype:  30%|██▉       | 55609/187062 [00:01<00:01, 71917.10it/s]
Adding feature datatype:  34%|███▍      | 63723/187062 [00:01<00:01, 74625.28it/s]
Adding feature datatype:  38%|███▊      | 71660/187062 [00:01<00:01, 75658.57it/s]
Adding feature datatype:  43%|████▎     | 79843/187062 [00:01<00:01, 77482.32it/s]
Adding feature datatype:  47%|████▋     | 88038/187062 [00:01<00:01, 78808.35it/s]
Adding feature datatype:  51%|█████▏    | 96267/187062 [00:01<00:01, 79842.68it/s]
Adding feature datatype:  56%|█████▌    | 104453/187062 [00:01<00:01, 80441.62it/s]
Adding feature datatype:  60%|██████    | 112674/187062 [00:01<00:00, 80969.59it/s]
Adding feature datatype:  65%|██████▍   | 120830/187062 [00:01<00:00, 80251.42it/s]
Adding feature datatype:  69%|██████▉   | 129027/187062 [00:02<00:00, 80761.27it/s]
Adding feature datatype:  73%|███████▎  | 137227/187062 [00:02<00:00, 81128.39it/s]
Adding feature datatype:  78%|███████▊  | 145427/187062 [00:02<00:00, 81386.54it/s]
Adding feature datatype:  82%|████████▏ | 153641/187062 [00:02<00:00, 81609.71it/s]
Adding feature datatype:  87%|████████▋ | 161813/187062 [00:02<00:00, 80782.25it/s]
Adding feature datatype:  91%|█████████ | 170057/187062 [00:02<00:00, 81274.25it/s]
Adding feature datatype:  95%|█████████▌| 178192/187062 [00:02<00:00, 78978.54it/s]
Adding feature datatype:  99%|█████████▉| 186108/187062 [00:02<00:00, 52615.22it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 62908.60it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:14:20,  2.24it/s]
Adding feature literal:   4%|▎         | 7007/187062 [00:00<00:10, 16962.12it/s]
Adding feature literal:   8%|▊         | 15018/187062 [00:00<00:05, 33188.01it/s]
Adding feature literal:  12%|█▏        | 23115/187062 [00:00<00:03, 46017.43it/s]
Adding feature literal:  17%|█▋        | 31260/187062 [00:00<00:02, 55839.34it/s]
Adding feature literal:  21%|██        | 39353/187062 [00:00<00:02, 62956.16it/s]
Adding feature literal:  25%|██▌       | 47497/187062 [00:01<00:02, 68286.01it/s]
Adding feature literal:  30%|██▉       | 55616/187062 [00:01<00:01, 72048.20it/s]
Adding feature literal:  34%|███▍      | 63808/187062 [00:01<00:01, 74950.23it/s]
Adding feature literal:  38%|███▊      | 71997/187062 [00:01<00:01, 77000.53it/s]
Adding feature literal:  43%|████▎     | 80164/187062 [00:01<00:01, 78386.63it/s]
Adding feature literal:  47%|████▋     | 88333/187062 [00:01<00:01, 79368.13it/s]
Adding feature literal:  52%|█████▏    | 96499/187062 [00:01<00:01, 80049.07it/s]
Adding feature literal:  56%|█████▌    | 104639/187062 [00:01<00:01, 80449.50it/s]
Adding feature literal:  60%|██████    | 112787/187062 [00:01<00:00, 80755.23it/s]
Adding feature literal:  65%|██████▍   | 120920/187062 [00:01<00:00, 80860.93it/s]
Adding feature literal:  69%|██████▉   | 129048/187062 [00:02<00:00, 80983.16it/s]
Adding feature literal:  73%|███████▎  | 137187/187062 [00:02<00:00, 81104.33it/s]
Adding feature literal:  78%|███████▊  | 145328/187062 [00:02<00:00, 81195.39it/s]
Adding feature literal:  82%|████████▏ | 153516/187062 [00:02<00:00, 81397.35it/s]
Adding feature literal:  86%|████████▋ | 161666/187062 [00:02<00:00, 81386.73it/s]
Adding feature literal:  91%|█████████ | 169812/187062 [00:02<00:00, 81382.31it/s]
Adding feature literal:  95%|█████████▌| 177955/187062 [00:02<00:00, 80044.65it/s]
Adding feature literal:  99%|█████████▉| 185968/187062 [00:02<00:00, 52145.77it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 62983.84it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:20:59,  2.23it/s]
Adding feature operator:   4%|▍         | 7117/187062 [00:00<00:10, 17166.61it/s]
Adding feature operator:   8%|▊         | 15072/187062 [00:00<00:05, 33153.38it/s]
Adding feature operator:  12%|█▏        | 23253/187062 [00:00<00:03, 46191.90it/s]
Adding feature operator:  17%|█▋        | 31456/187062 [00:00<00:02, 56112.91it/s]
Adding feature operator:  21%|██        | 39694/187062 [00:00<00:02, 63555.08it/s]
Adding feature operator:  26%|██▌       | 47887/187062 [00:01<00:02, 68849.67it/s]
Adding feature operator:  30%|██▉       | 56085/187062 [00:01<00:01, 72677.58it/s]
Adding feature operator:  34%|███▍      | 64267/187062 [00:01<00:01, 75363.51it/s]
Adding feature operator:  39%|███▉      | 72495/187062 [00:01<00:01, 77408.75it/s]
Adding feature operator:  43%|████▎     | 80713/187062 [00:01<00:01, 78823.57it/s]
Adding feature operator:  48%|████▊     | 88926/187062 [00:01<00:01, 79807.44it/s]
Adding feature operator:  52%|█████▏    | 97160/187062 [00:01<00:01, 80562.46it/s]
Adding feature operator:  56%|█████▋    | 105380/187062 [00:01<00:01, 81049.94it/s]
Adding feature operator:  61%|██████    | 113593/187062 [00:01<00:00, 81371.28it/s]
Adding feature operator:  65%|██████▌   | 121789/187062 [00:01<00:00, 81446.26it/s]
Adding feature operator:  69%|██████▉   | 129988/187062 [00:02<00:00, 81607.20it/s]
Adding feature operator:  74%|███████▍  | 138194/187062 [00:02<00:00, 81741.41it/s]
Adding feature operator:  78%|███████▊  | 146453/187062 [00:02<00:00, 81993.99it/s]
Adding feature operator:  83%|████████▎ | 154667/187062 [00:02<00:00, 81814.70it/s]
Adding feature operator:  87%|████████▋ | 162878/187062 [00:02<00:00, 81899.94it/s]
Adding feature operator:  91%|█████████▏| 171075/187062 [00:02<00:00, 81788.85it/s]
Adding feature operator:  96%|█████████▌| 179259/187062 [00:02<00:00, 73686.99it/s]
Adding feature operator: 100%|█████████▉| 186783/187062 [00:02<00:00, 51548.15it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63300.47it/s]
[2024-10-12 13:32:13,904] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 13:32:15 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 13:32:15 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:16, 383.01 examples/s]
Map:   1%|▏         | 82/6548 [00:00<00:31, 204.32 examples/s]
Map:   2%|▏         | 121/6548 [00:00<00:24, 258.18 examples/s]
Map:   2%|▏         | 157/6548 [00:00<00:22, 286.56 examples/s]
Map:   3%|▎         | 197/6548 [00:00<00:20, 312.91 examples/s]
Map:   4%|▍         | 247/6548 [00:00<00:17, 360.39 examples/s]
Map:   4%|▍         | 292/6548 [00:00<00:18, 331.24 examples/s]
Map:   5%|▌         | 329/6548 [00:01<00:19, 319.50 examples/s]
Map:   6%|▌         | 385/6548 [00:01<00:18, 332.55 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:16, 361.40 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 335.78 examples/s]
Map:   8%|▊         | 512/6548 [00:01<00:17, 348.92 examples/s]
Map:   9%|▊         | 565/6548 [00:01<00:15, 395.59 examples/s]
Map:   9%|▉         | 614/6548 [00:01<00:16, 357.13 examples/s]
Map:  10%|█         | 658/6548 [00:02<00:18, 316.29 examples/s]
Map:  11%|█         | 706/6548 [00:02<00:16, 345.80 examples/s]
Map:  11%|█▏        | 749/6548 [00:02<00:15, 364.12 examples/s]
Map:  12%|█▏        | 802/6548 [00:02<00:14, 404.57 examples/s]
Map:  13%|█▎        | 860/6548 [00:02<00:14, 395.52 examples/s]
Map:  14%|█▍        | 908/6548 [00:02<00:15, 366.03 examples/s]
Map:  15%|█▍        | 969/6548 [00:02<00:14, 372.78 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:23, 233.01 examples/s]
Map:  16%|█▌        | 1051/6548 [00:03<00:21, 253.48 examples/s]
Map:  17%|█▋        | 1093/6548 [00:03<00:19, 284.29 examples/s]
Map:  17%|█▋        | 1142/6548 [00:03<00:16, 325.35 examples/s]
Map:  18%|█▊        | 1198/6548 [00:03<00:15, 338.84 examples/s]
Map:  19%|█▉        | 1238/6548 [00:03<00:15, 346.22 examples/s]
Map:  20%|█▉        | 1284/6548 [00:03<00:14, 368.13 examples/s]
Map:  20%|██        | 1334/6548 [00:04<00:17, 302.76 examples/s]
Map:  21%|██        | 1377/6548 [00:04<00:17, 292.76 examples/s]
Map:  22%|██▏       | 1428/6548 [00:04<00:17, 297.31 examples/s]
Map:  22%|██▏       | 1468/6548 [00:04<00:18, 269.46 examples/s]
Map:  23%|██▎       | 1498/6548 [00:04<00:18, 273.40 examples/s]
Map:  23%|██▎       | 1533/6548 [00:04<00:17, 281.69 examples/s]
Map:  24%|██▍       | 1577/6548 [00:04<00:17, 284.47 examples/s]
Map:  25%|██▍       | 1613/6548 [00:05<00:18, 268.65 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:18, 267.06 examples/s]
Map:  26%|██▌       | 1686/6548 [00:05<00:18, 267.23 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:16, 295.35 examples/s]
Map:  27%|██▋       | 1769/6548 [00:05<00:14, 325.27 examples/s]
Map:  28%|██▊       | 1803/6548 [00:05<00:14, 319.13 examples/s]
Map:  28%|██▊       | 1837/6548 [00:05<00:14, 317.70 examples/s]
Map:  29%|██▉       | 1885/6548 [00:06<00:15, 308.42 examples/s]
Map:  29%|██▉       | 1920/6548 [00:06<00:14, 310.34 examples/s]
Map:  30%|██▉       | 1963/6548 [00:06<00:13, 339.83 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:20, 221.06 examples/s]
Map:  31%|███       | 2028/6548 [00:06<00:19, 231.43 examples/s]
Map:  31%|███▏      | 2060/6548 [00:06<00:18, 248.80 examples/s]
Map:  32%|███▏      | 2099/6548 [00:06<00:15, 281.02 examples/s]
Map:  33%|███▎      | 2139/6548 [00:07<00:16, 263.60 examples/s]
Map:  33%|███▎      | 2181/6548 [00:07<00:16, 263.67 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 274.15 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:15, 273.95 examples/s]
Map:  35%|███▌      | 2293/6548 [00:07<00:14, 288.01 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:13, 314.25 examples/s]
Map:  36%|███▌      | 2371/6548 [00:07<00:13, 302.12 examples/s]
Map:  37%|███▋      | 2407/6548 [00:07<00:13, 313.94 examples/s]
Map:  37%|███▋      | 2454/6548 [00:08<00:13, 307.78 examples/s]
Map:  38%|███▊      | 2502/6548 [00:08<00:13, 309.39 examples/s]
Map:  39%|███▉      | 2544/6548 [00:08<00:12, 329.93 examples/s]
Map:  40%|███▉      | 2594/6548 [00:08<00:10, 367.90 examples/s]
Map:  40%|████      | 2636/6548 [00:08<00:10, 380.03 examples/s]
Map:  41%|████      | 2682/6548 [00:08<00:11, 344.62 examples/s]
Map:  42%|████▏     | 2738/6548 [00:08<00:10, 348.40 examples/s]
Map:  42%|████▏     | 2776/6548 [00:08<00:10, 352.95 examples/s]
Map:  43%|████▎     | 2823/6548 [00:09<00:11, 331.03 examples/s]
Map:  44%|████▎     | 2858/6548 [00:09<00:13, 281.22 examples/s]
Map:  44%|████▍     | 2896/6548 [00:09<00:12, 300.69 examples/s]
Map:  45%|████▍     | 2929/6548 [00:09<00:13, 273.53 examples/s]
Map:  45%|████▌     | 2958/6548 [00:09<00:12, 276.33 examples/s]
Map:  46%|████▌     | 2991/6548 [00:09<00:14, 243.39 examples/s]
Map:  46%|████▌     | 3027/6548 [00:10<00:21, 160.73 examples/s]
Map:  47%|████▋     | 3058/6548 [00:10<00:19, 182.83 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 204.97 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 249.61 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:13, 254.08 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 242.81 examples/s]
Map:  49%|████▉     | 3237/6548 [00:10<00:12, 263.55 examples/s]
Map:  50%|████▉     | 3269/6548 [00:11<00:11, 274.37 examples/s]
Map:  51%|█████     | 3322/6548 [00:11<00:10, 299.14 examples/s]
Map:  51%|█████▏    | 3363/6548 [00:11<00:11, 283.43 examples/s]
Map:  52%|█████▏    | 3397/6548 [00:11<00:12, 248.53 examples/s]
Map:  52%|█████▏    | 3432/6548 [00:11<00:11, 269.20 examples/s]
Map:  53%|█████▎    | 3479/6548 [00:11<00:12, 249.80 examples/s]
Map:  54%|█████▍    | 3525/6548 [00:11<00:10, 291.41 examples/s]
Map:  54%|█████▍    | 3566/6548 [00:12<00:09, 317.23 examples/s]
Map:  55%|█████▌    | 3613/6548 [00:12<00:08, 352.75 examples/s]
Map:  56%|█████▌    | 3667/6548 [00:12<00:08, 353.29 examples/s]
Map:  57%|█████▋    | 3713/6548 [00:12<00:07, 376.37 examples/s]
Map:  58%|█████▊    | 3772/6548 [00:12<00:07, 364.47 examples/s]
Map:  58%|█████▊    | 3811/6548 [00:12<00:07, 360.72 examples/s]
Map:  59%|█████▉    | 3849/6548 [00:12<00:08, 314.27 examples/s]
Map:  59%|█████▉    | 3884/6548 [00:12<00:08, 317.16 examples/s]
Map:  60%|█████▉    | 3928/6548 [00:13<00:08, 322.97 examples/s]
Map:  61%|██████    | 3974/6548 [00:13<00:08, 315.49 examples/s]
Map:  62%|██████▏   | 4030/6548 [00:13<00:10, 245.75 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 287.48 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 311.75 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:08, 291.08 examples/s]
Map:  64%|██████▍   | 4205/6548 [00:14<00:07, 305.56 examples/s]
Map:  65%|██████▌   | 4266/6548 [00:14<00:06, 332.09 examples/s]
Map:  66%|██████▌   | 4324/6548 [00:14<00:06, 346.65 examples/s]
Map:  67%|██████▋   | 4375/6548 [00:14<00:06, 343.48 examples/s]
Map:  68%|██████▊   | 4432/6548 [00:14<00:06, 351.46 examples/s]
Map:  68%|██████▊   | 4485/6548 [00:14<00:06, 340.92 examples/s]
Map:  69%|██████▉   | 4530/6548 [00:15<00:06, 319.84 examples/s]
Map:  70%|██████▉   | 4569/6548 [00:15<00:05, 331.10 examples/s]
Map:  70%|███████   | 4610/6548 [00:15<00:05, 326.85 examples/s]
Map:  71%|███████   | 4657/6548 [00:15<00:05, 359.68 examples/s]
Map:  72%|███████▏  | 4700/6548 [00:15<00:05, 324.62 examples/s]
Map:  73%|███████▎  | 4750/6548 [00:15<00:05, 348.66 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 397.99 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 389.89 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:16<00:04, 359.56 examples/s]
Map:  76%|███████▌  | 4958/6548 [00:16<00:03, 400.90 examples/s]
Map:  77%|███████▋  | 5012/6548 [00:16<00:06, 241.53 examples/s]
Map:  77%|███████▋  | 5054/6548 [00:16<00:05, 270.09 examples/s]
Map:  78%|███████▊  | 5101/6548 [00:16<00:05, 277.85 examples/s]
Map:  79%|███████▊  | 5145/6548 [00:16<00:05, 269.98 examples/s]
Map:  79%|███████▉  | 5185/6548 [00:17<00:04, 294.34 examples/s]
Map:  80%|███████▉  | 5233/6548 [00:17<00:04, 298.41 examples/s]
Map:  81%|████████  | 5289/6548 [00:17<00:03, 318.81 examples/s]
Map:  81%|████████▏ | 5325/6548 [00:17<00:03, 320.14 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:04, 293.92 examples/s]
Map:  83%|████████▎ | 5404/6548 [00:17<00:04, 276.52 examples/s]
Map:  83%|████████▎ | 5447/6548 [00:17<00:03, 304.28 examples/s]
Map:  84%|████████▍ | 5486/6548 [00:18<00:03, 322.04 examples/s]
Map:  84%|████████▍ | 5520/6548 [00:18<00:03, 319.45 examples/s]
Map:  85%|████████▍ | 5562/6548 [00:18<00:02, 339.15 examples/s]
Map:  86%|████████▌ | 5602/6548 [00:18<00:03, 310.30 examples/s]
Map:  86%|████████▌ | 5646/6548 [00:18<00:02, 337.23 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 296.83 examples/s]
Map:  87%|████████▋ | 5716/6548 [00:18<00:02, 307.86 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 333.73 examples/s]
Map:  89%|████████▊ | 5800/6548 [00:19<00:02, 337.52 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:19<00:02, 324.15 examples/s]
Map:  90%|████████▉ | 5885/6548 [00:19<00:01, 336.78 examples/s]
Map:  90%|█████████ | 5923/6548 [00:19<00:01, 345.71 examples/s]
Map:  91%|█████████ | 5967/6548 [00:19<00:01, 324.16 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 236.34 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:20<00:01, 266.86 examples/s]
Map:  94%|█████████▎| 6123/6548 [00:20<00:01, 264.53 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:20<00:01, 282.89 examples/s]
Map:  95%|█████████▍| 6207/6548 [00:20<00:01, 305.97 examples/s]
Map:  95%|█████████▌| 6249/6548 [00:20<00:00, 326.30 examples/s]
Map:  96%|█████████▋| 6303/6548 [00:20<00:00, 335.73 examples/s]
Map:  97%|█████████▋| 6355/6548 [00:20<00:00, 332.97 examples/s]
Map:  98%|█████████▊| 6392/6548 [00:20<00:00, 329.83 examples/s]
Map:  98%|█████████▊| 6432/6548 [00:21<00:00, 345.92 examples/s]
Map:  99%|█████████▉| 6479/6548 [00:21<00:00, 375.35 examples/s]
Map: 100%|█████████▉| 6538/6548 [00:21<00:00, 372.04 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 304.94 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 35/903 [00:00<00:02, 317.07 examples/s]
Map:   8%|▊         | 73/903 [00:00<00:02, 343.54 examples/s]
Map:  13%|█▎        | 118/903 [00:00<00:02, 307.44 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 326.34 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 383.39 examples/s]
Map:  29%|██▉       | 263/903 [00:00<00:01, 366.44 examples/s]
Map:  33%|███▎      | 302/903 [00:00<00:01, 362.22 examples/s]
Map:  39%|███▉      | 355/903 [00:01<00:01, 355.56 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 306.05 examples/s]
Map:  51%|█████     | 460/903 [00:01<00:01, 304.63 examples/s]
Map:  57%|█████▋    | 513/903 [00:01<00:01, 316.87 examples/s]
Map:  62%|██████▏   | 560/903 [00:01<00:00, 345.96 examples/s]
Map:  67%|██████▋   | 603/903 [00:01<00:00, 362.05 examples/s]
Map:  72%|███████▏  | 653/903 [00:01<00:00, 346.31 examples/s]
Map:  77%|███████▋  | 696/903 [00:02<00:00, 362.72 examples/s]
Map:  82%|████████▏ | 741/903 [00:02<00:00, 383.17 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 380.46 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 384.14 examples/s]
Map:  97%|█████████▋| 872/903 [00:02<00:00, 402.25 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 323.81 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 35/1882 [00:00<00:06, 269.65 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 345.08 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 339.41 examples/s]
Map:   9%|▊         | 160/1882 [00:00<00:04, 359.16 examples/s]
Map:  10%|█         | 197/1882 [00:00<00:04, 359.18 examples/s]
Map:  14%|█▎        | 257/1882 [00:00<00:04, 373.21 examples/s]
Map:  16%|█▌        | 302/1882 [00:00<00:04, 338.04 examples/s]
Map:  18%|█▊        | 345/1882 [00:00<00:04, 357.86 examples/s]
Map:  21%|██        | 393/1882 [00:01<00:04, 301.75 examples/s]
Map:  23%|██▎       | 433/1882 [00:01<00:05, 285.20 examples/s]
Map:  26%|██▌       | 489/1882 [00:01<00:04, 302.37 examples/s]
Map:  28%|██▊       | 525/1882 [00:01<00:04, 301.74 examples/s]
Map:  30%|██▉       | 564/1882 [00:01<00:04, 319.81 examples/s]
Map:  32%|███▏      | 599/1882 [00:01<00:03, 322.64 examples/s]
Map:  35%|███▍      | 653/1882 [00:01<00:03, 356.35 examples/s]
Map:  37%|███▋      | 696/1882 [00:02<00:03, 371.46 examples/s]
Map:  39%|███▉      | 734/1882 [00:02<00:03, 369.28 examples/s]
Map:  41%|████      | 773/1882 [00:02<00:03, 354.92 examples/s]
Map:  44%|████▍     | 830/1882 [00:02<00:02, 360.37 examples/s]
Map:  47%|████▋     | 886/1882 [00:02<00:02, 359.75 examples/s]
Map:  50%|█████     | 946/1882 [00:02<00:02, 366.67 examples/s]
Map:  52%|█████▏    | 984/1882 [00:02<00:02, 367.99 examples/s]
Map:  55%|█████▌    | 1039/1882 [00:03<00:03, 237.41 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 251.78 examples/s]
Map:  59%|█████▉    | 1107/1882 [00:03<00:02, 266.45 examples/s]
Map:  61%|██████    | 1148/1882 [00:03<00:02, 266.73 examples/s]
Map:  63%|██████▎   | 1184/1882 [00:03<00:02, 254.30 examples/s]
Map:  65%|██████▌   | 1226/1882 [00:03<00:02, 288.05 examples/s]
Map:  68%|██████▊   | 1278/1882 [00:04<00:01, 302.54 examples/s]
Map:  70%|███████   | 1322/1882 [00:04<00:01, 329.04 examples/s]
Map:  72%|███████▏  | 1360/1882 [00:04<00:01, 331.45 examples/s]
Map:  75%|███████▌  | 1413/1882 [00:04<00:01, 333.87 examples/s]
Map:  78%|███████▊  | 1471/1882 [00:04<00:01, 305.63 examples/s]
Map:  80%|████████  | 1506/1882 [00:04<00:01, 256.63 examples/s]
Map:  82%|████████▏ | 1538/1882 [00:04<00:01, 257.71 examples/s]
Map:  84%|████████▍ | 1582/1882 [00:05<00:01, 293.04 examples/s]
Map:  86%|████████▌ | 1622/1882 [00:05<00:00, 315.58 examples/s]
Map:  89%|████████▊ | 1667/1882 [00:05<00:00, 293.62 examples/s]
Map:  91%|█████████ | 1713/1882 [00:05<00:00, 330.41 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 287.10 examples/s]
Map:  95%|█████████▍| 1785/1882 [00:05<00:00, 289.44 examples/s]
Map:  97%|█████████▋| 1830/1882 [00:05<00:00, 326.37 examples/s]
Map: 100%|█████████▉| 1875/1882 [00:05<00:00, 355.26 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 304.14 examples/s]
10/12/2024 13:33:18 - INFO - __main__ -     ***** Testing *****
10/12/2024 13:33:18 - INFO - __main__ -     Batch size = 8
10/12/2024 13:33:18 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 13:33:18 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 13:33:18 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 13:33:19 - INFO - knnlm -   Reading datastore took 0.9635477066040039 s
10/12/2024 13:33:20 - INFO - knnlm -   Moving index to GPU took 0.931535005569458 s
10/12/2024 13:33:20 - INFO - __main__ -   ******************************break-into
10/12/2024 13:33:20 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 13:33:20 - INFO - __main__ -     Num examples = 236
10/12/2024 13:33:20 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:47,  7.61s/it]
test ppl:   1%|          | 2/236 [00:09<16:32,  4.24s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:34,  2.98s/it]
test ppl:   2%|▏         | 4/236 [00:16<15:48,  4.09s/it]
test ppl:   2%|▏         | 5/236 [00:22<18:06,  4.71s/it]
test ppl:   3%|▎         | 6/236 [00:28<19:28,  5.08s/it]
test ppl:   3%|▎         | 7/236 [00:30<15:22,  4.03s/it]
test ppl:   3%|▎         | 8/236 [00:35<16:40,  4.39s/it]
test ppl:   4%|▍         | 9/236 [00:41<18:18,  4.84s/it]
test ppl:   4%|▍         | 10/236 [00:47<19:24,  5.15s/it]
test ppl:   5%|▍         | 11/236 [00:49<16:39,  4.44s/it]
test ppl:   5%|▌         | 12/236 [00:55<17:53,  4.79s/it]
test ppl:   6%|▌         | 13/236 [01:01<18:56,  5.10s/it]
test ppl:   6%|▌         | 14/236 [01:03<15:43,  4.25s/it]
test ppl:   6%|▋         | 15/236 [01:06<14:15,  3.87s/it]
test ppl:   7%|▋         | 16/236 [01:09<13:21,  3.64s/it]
test ppl:   7%|▋         | 17/236 [01:15<15:40,  4.30s/it]
test ppl:   8%|▊         | 18/236 [01:17<12:45,  3.51s/it]
test ppl:   8%|▊         | 19/236 [01:21<13:39,  3.78s/it]
test ppl:   8%|▊         | 20/236 [01:23<11:24,  3.17s/it]
test ppl:   9%|▉         | 21/236 [01:26<11:06,  3.10s/it]
test ppl:   9%|▉         | 22/236 [01:32<13:57,  3.91s/it]
test ppl:  10%|▉         | 23/236 [01:34<12:22,  3.48s/it]
test ppl:  10%|█         | 24/236 [01:36<11:04,  3.14s/it]
test ppl:  11%|█         | 25/236 [01:38<09:32,  2.71s/it]
test ppl:  11%|█         | 26/236 [01:44<12:44,  3.64s/it]
test ppl:  11%|█▏        | 27/236 [01:47<12:26,  3.57s/it]
test ppl:  12%|█▏        | 28/236 [01:49<09:54,  2.86s/it]
test ppl:  12%|█▏        | 29/236 [01:51<09:17,  2.69s/it]
test ppl:  13%|█▎        | 30/236 [01:52<08:01,  2.34s/it]
test ppl:  13%|█▎        | 31/236 [01:54<07:37,  2.23s/it]
test ppl:  14%|█▎        | 32/236 [01:57<07:58,  2.35s/it]
test ppl:  14%|█▍        | 33/236 [01:59<08:01,  2.37s/it]
test ppl:  14%|█▍        | 34/236 [02:04<10:20,  3.07s/it]
test ppl:  15%|█▍        | 35/236 [02:07<09:43,  2.90s/it]
test ppl:  15%|█▌        | 36/236 [02:12<12:35,  3.78s/it]
test ppl:  16%|█▌        | 37/236 [02:18<14:33,  4.39s/it]
test ppl:  16%|█▌        | 38/236 [02:20<12:10,  3.69s/it]
test ppl:  17%|█▋        | 39/236 [02:22<09:56,  3.03s/it]
test ppl:  17%|█▋        | 40/236 [02:24<09:32,  2.92s/it]
test ppl:  17%|█▋        | 41/236 [02:26<08:27,  2.60s/it]
test ppl:  18%|█▊        | 42/236 [02:32<11:33,  3.58s/it]
test ppl:  18%|█▊        | 43/236 [02:38<13:39,  4.24s/it]
test ppl:  19%|█▊        | 44/236 [02:41<11:59,  3.75s/it]
test ppl:  19%|█▉        | 45/236 [02:43<10:13,  3.21s/it]
test ppl:  19%|█▉        | 46/236 [02:48<12:41,  4.01s/it]
test ppl:  20%|█▉        | 47/236 [02:50<10:15,  3.26s/it]
test ppl:  20%|██        | 48/236 [02:56<12:34,  4.01s/it]
test ppl:  21%|██        | 49/236 [03:00<12:45,  4.09s/it]
test ppl:  21%|██        | 50/236 [03:06<14:20,  4.63s/it]
test ppl:  22%|██▏       | 51/236 [03:12<15:24,  5.00s/it]
test ppl:  22%|██▏       | 52/236 [03:17<16:04,  5.24s/it]
test ppl:  22%|██▏       | 53/236 [03:22<15:33,  5.10s/it]
test ppl:  23%|██▎       | 54/236 [03:24<12:12,  4.03s/it]
test ppl:  23%|██▎       | 55/236 [03:29<13:37,  4.51s/it]
test ppl:  24%|██▎       | 56/236 [03:35<14:44,  4.91s/it]
test ppl:  24%|██▍       | 57/236 [03:38<12:18,  4.12s/it]
test ppl:  25%|██▍       | 58/236 [03:40<10:29,  3.53s/it]
test ppl:  25%|██▌       | 59/236 [03:46<12:26,  4.22s/it]
test ppl:  25%|██▌       | 60/236 [03:48<11:16,  3.84s/it]
test ppl:  26%|██▌       | 61/236 [03:54<12:55,  4.43s/it]
test ppl:  26%|██▋       | 62/236 [03:58<12:32,  4.32s/it]
test ppl:  27%|██▋       | 63/236 [04:01<10:51,  3.76s/it]
test ppl:  27%|██▋       | 64/236 [04:03<09:20,  3.26s/it]
test ppl:  28%|██▊       | 65/236 [04:04<07:37,  2.67s/it]
test ppl:  28%|██▊       | 66/236 [04:07<07:50,  2.77s/it]
test ppl:  28%|██▊       | 67/236 [04:10<07:34,  2.69s/it]
test ppl:  29%|██▉       | 68/236 [04:16<10:09,  3.63s/it]
test ppl:  29%|██▉       | 69/236 [04:21<11:55,  4.28s/it]
test ppl:  30%|██▉       | 70/236 [04:23<09:38,  3.48s/it]
test ppl:  30%|███       | 71/236 [04:29<11:30,  4.18s/it]
test ppl:  31%|███       | 72/236 [04:33<11:06,  4.06s/it]
test ppl:  31%|███       | 73/236 [04:36<10:55,  4.02s/it]
test ppl:  31%|███▏      | 74/236 [04:38<08:48,  3.26s/it]
test ppl:  32%|███▏      | 75/236 [04:44<10:48,  4.03s/it]
test ppl:  32%|███▏      | 76/236 [04:47<10:28,  3.93s/it]
test ppl:  33%|███▎      | 77/236 [04:50<09:04,  3.43s/it]
test ppl:  33%|███▎      | 78/236 [04:51<07:29,  2.85s/it]
test ppl:  33%|███▎      | 79/236 [04:55<08:15,  3.16s/it]
test ppl:  34%|███▍      | 80/236 [04:57<07:09,  2.76s/it]
test ppl:  34%|███▍      | 81/236 [05:03<09:28,  3.67s/it]
test ppl:  35%|███▍      | 82/236 [05:09<11:06,  4.33s/it]
test ppl:  35%|███▌      | 83/236 [05:12<10:26,  4.09s/it]
test ppl:  36%|███▌      | 84/236 [05:14<08:40,  3.42s/it]
test ppl:  36%|███▌      | 85/236 [05:18<09:06,  3.62s/it]
test ppl:  36%|███▋      | 86/236 [05:20<07:46,  3.11s/it]
test ppl:  37%|███▋      | 87/236 [05:22<06:56,  2.80s/it]
test ppl:  37%|███▋      | 88/236 [05:28<09:07,  3.70s/it]
test ppl:  38%|███▊      | 89/236 [05:34<10:36,  4.33s/it]
test ppl:  38%|███▊      | 90/236 [05:39<11:36,  4.77s/it]
test ppl:  39%|███▊      | 91/236 [05:44<11:36,  4.80s/it]
test ppl:  39%|███▉      | 92/236 [05:47<10:04,  4.19s/it]
test ppl:  39%|███▉      | 93/236 [05:53<11:08,  4.68s/it]
test ppl:  40%|███▉      | 94/236 [05:59<11:52,  5.01s/it]
test ppl:  40%|████      | 95/236 [06:02<10:14,  4.36s/it]
test ppl:  41%|████      | 96/236 [06:04<09:08,  3.92s/it]
test ppl:  41%|████      | 97/236 [06:10<10:23,  4.49s/it]
test ppl:  42%|████▏     | 98/236 [06:16<11:14,  4.88s/it]
test ppl:  42%|████▏     | 99/236 [06:22<11:47,  5.16s/it]
test ppl:  42%|████▏     | 100/236 [06:23<09:01,  3.98s/it]
test ppl:  43%|████▎     | 101/236 [06:29<09:59,  4.44s/it]
test ppl:  43%|████▎     | 102/236 [06:32<09:16,  4.15s/it]
test ppl:  44%|████▎     | 103/236 [06:34<07:23,  3.33s/it]
test ppl:  44%|████▍     | 104/236 [06:38<07:55,  3.60s/it]
test ppl:  44%|████▍     | 105/236 [06:42<08:04,  3.70s/it]
test ppl:  45%|████▍     | 106/236 [06:47<09:05,  4.20s/it]
test ppl:  45%|████▌     | 107/236 [06:49<07:41,  3.58s/it]
test ppl:  46%|████▌     | 108/236 [06:55<08:57,  4.20s/it]
test ppl:  46%|████▌     | 109/236 [06:59<08:44,  4.13s/it]
test ppl:  47%|████▋     | 110/236 [07:00<07:03,  3.36s/it]
test ppl:  47%|████▋     | 111/236 [07:04<07:21,  3.53s/it]
test ppl:  47%|████▋     | 112/236 [07:08<07:11,  3.48s/it]
test ppl:  48%|████▊     | 113/236 [07:09<06:04,  2.96s/it]
test ppl:  48%|████▊     | 114/236 [07:13<06:13,  3.06s/it]
test ppl:  49%|████▊     | 115/236 [07:19<07:49,  3.88s/it]
test ppl:  49%|████▉     | 116/236 [07:24<08:55,  4.46s/it]
test ppl:  50%|████▉     | 117/236 [07:26<07:17,  3.68s/it]
test ppl:  50%|█████     | 118/236 [07:30<07:32,  3.84s/it]
test ppl:  50%|█████     | 119/236 [07:35<07:58,  4.09s/it]
test ppl:  51%|█████     | 120/236 [07:37<06:24,  3.32s/it]
test ppl:  51%|█████▏    | 121/236 [07:42<07:46,  4.06s/it]
test ppl:  52%|█████▏    | 122/236 [07:47<08:05,  4.26s/it]
test ppl:  52%|█████▏    | 123/236 [07:49<06:49,  3.62s/it]
test ppl:  53%|█████▎    | 124/236 [07:51<05:59,  3.21s/it]
test ppl:  53%|█████▎    | 125/236 [07:57<07:22,  3.99s/it]
test ppl:  53%|█████▎    | 126/236 [08:01<07:07,  3.89s/it]
test ppl:  54%|█████▍    | 127/236 [08:03<06:04,  3.34s/it]
test ppl:  54%|█████▍    | 128/236 [08:05<05:25,  3.01s/it]
test ppl:  55%|█████▍    | 129/236 [08:08<05:18,  2.97s/it]
test ppl:  55%|█████▌    | 130/236 [08:11<05:19,  3.01s/it]
test ppl:  56%|█████▌    | 131/236 [08:17<06:44,  3.86s/it]
test ppl:  56%|█████▌    | 132/236 [08:20<05:57,  3.43s/it]
test ppl:  56%|█████▋    | 133/236 [08:23<06:07,  3.57s/it]
test ppl:  57%|█████▋    | 134/236 [08:27<06:12,  3.65s/it]
test ppl:  57%|█████▋    | 135/236 [08:32<06:31,  3.87s/it]
test ppl:  58%|█████▊    | 136/236 [08:33<05:08,  3.08s/it]
test ppl:  58%|█████▊    | 137/236 [08:39<06:26,  3.91s/it]
test ppl:  58%|█████▊    | 138/236 [08:42<06:01,  3.68s/it]
test ppl:  59%|█████▉    | 139/236 [08:44<05:24,  3.35s/it]
test ppl:  59%|█████▉    | 140/236 [08:46<04:36,  2.88s/it]
test ppl:  60%|█████▉    | 141/236 [08:49<04:32,  2.87s/it]
test ppl:  60%|██████    | 142/236 [08:51<04:07,  2.63s/it]
test ppl:  61%|██████    | 143/236 [08:57<05:33,  3.59s/it]
test ppl:  61%|██████    | 144/236 [09:00<05:05,  3.32s/it]
test ppl:  61%|██████▏   | 145/236 [09:05<06:06,  4.02s/it]
test ppl:  62%|██████▏   | 146/236 [09:10<06:14,  4.16s/it]
test ppl:  62%|██████▏   | 147/236 [09:16<06:54,  4.66s/it]
test ppl:  63%|██████▎   | 148/236 [09:22<07:23,  5.04s/it]
test ppl:  63%|██████▎   | 149/236 [09:25<06:33,  4.53s/it]
test ppl:  64%|██████▎   | 150/236 [09:31<07:03,  4.92s/it]
test ppl:  64%|██████▍   | 151/236 [09:37<07:20,  5.19s/it]
test ppl:  64%|██████▍   | 152/236 [09:42<07:31,  5.37s/it]
test ppl:  65%|██████▍   | 153/236 [09:48<07:27,  5.40s/it]
test ppl:  65%|██████▌   | 154/236 [09:50<06:11,  4.53s/it]
test ppl:  66%|██████▌   | 155/236 [09:53<05:19,  3.94s/it]
test ppl:  66%|██████▌   | 156/236 [09:55<04:32,  3.41s/it]
test ppl:  67%|██████▋   | 157/236 [09:57<04:00,  3.04s/it]
test ppl:  67%|██████▋   | 158/236 [10:03<05:01,  3.87s/it]
test ppl:  67%|██████▋   | 159/236 [10:09<05:42,  4.45s/it]
test ppl:  68%|██████▊   | 160/236 [10:10<04:23,  3.46s/it]
test ppl:  68%|██████▊   | 161/236 [10:11<03:32,  2.83s/it]
test ppl:  69%|██████▊   | 162/236 [10:14<03:35,  2.91s/it]
test ppl:  69%|██████▉   | 163/236 [10:17<03:23,  2.79s/it]
test ppl:  69%|██████▉   | 164/236 [10:23<04:27,  3.71s/it]
test ppl:  70%|██████▉   | 165/236 [10:27<04:31,  3.83s/it]
test ppl:  70%|███████   | 166/236 [10:29<03:47,  3.25s/it]
test ppl:  71%|███████   | 167/236 [10:30<03:07,  2.72s/it]
test ppl:  71%|███████   | 168/236 [10:36<04:08,  3.65s/it]
test ppl:  72%|███████▏  | 169/236 [10:41<04:29,  4.03s/it]
test ppl:  72%|███████▏  | 170/236 [10:47<05:01,  4.57s/it]
test ppl:  72%|███████▏  | 171/236 [10:48<03:54,  3.60s/it]
test ppl:  73%|███████▎  | 172/236 [10:54<04:33,  4.27s/it]
test ppl:  73%|███████▎  | 173/236 [11:00<04:57,  4.73s/it]
test ppl:  74%|███████▎  | 174/236 [11:06<05:13,  5.06s/it]
test ppl:  74%|███████▍  | 175/236 [11:07<04:10,  4.10s/it]
test ppl:  75%|███████▍  | 176/236 [11:13<04:36,  4.61s/it]
test ppl:  75%|███████▌  | 177/236 [11:19<04:53,  4.98s/it]
test ppl:  75%|███████▌  | 178/236 [11:25<05:04,  5.24s/it]
test ppl:  76%|███████▌  | 179/236 [11:31<05:09,  5.43s/it]
test ppl:  76%|███████▋  | 180/236 [11:34<04:32,  4.87s/it]
test ppl:  77%|███████▋  | 181/236 [11:40<04:42,  5.15s/it]
test ppl:  77%|███████▋  | 182/236 [11:42<03:44,  4.17s/it]
test ppl:  78%|███████▊  | 183/236 [11:44<03:10,  3.59s/it]
test ppl:  78%|███████▊  | 184/236 [11:46<02:31,  2.92s/it]
test ppl:  78%|███████▊  | 185/236 [11:52<03:14,  3.81s/it]
test ppl:  79%|███████▉  | 186/236 [11:54<02:43,  3.26s/it]
test ppl:  79%|███████▉  | 187/236 [11:59<03:18,  4.05s/it]
test ppl:  80%|███████▉  | 188/236 [12:05<03:39,  4.58s/it]
test ppl:  80%|████████  | 189/236 [12:11<03:52,  4.95s/it]
test ppl:  81%|████████  | 190/236 [12:15<03:37,  4.73s/it]
test ppl:  81%|████████  | 191/236 [12:20<03:27,  4.60s/it]
test ppl:  81%|████████▏ | 192/236 [12:22<02:55,  4.00s/it]
test ppl:  82%|████████▏ | 193/236 [12:28<03:15,  4.55s/it]
test ppl:  82%|████████▏ | 194/236 [12:31<02:46,  3.96s/it]
test ppl:  83%|████████▎ | 195/236 [12:34<02:31,  3.69s/it]
test ppl:  83%|████████▎ | 196/236 [12:36<02:07,  3.18s/it]
test ppl:  83%|████████▎ | 197/236 [12:38<01:56,  2.99s/it]
test ppl:  84%|████████▍ | 198/236 [12:44<02:25,  3.83s/it]
test ppl:  84%|████████▍ | 199/236 [12:47<02:08,  3.49s/it]
test ppl:  85%|████████▍ | 200/236 [12:52<02:30,  4.18s/it]
test ppl:  85%|████████▌ | 201/236 [12:54<02:03,  3.53s/it]
test ppl:  86%|████████▌ | 202/236 [13:00<02:23,  4.21s/it]
test ppl:  86%|████████▌ | 203/236 [13:06<02:34,  4.69s/it]
test ppl:  86%|████████▋ | 204/236 [13:08<01:59,  3.72s/it]
test ppl:  87%|████████▋ | 205/236 [13:13<02:15,  4.36s/it]
test ppl:  87%|████████▋ | 206/236 [13:17<02:00,  4.03s/it]
test ppl:  88%|████████▊ | 207/236 [13:22<02:12,  4.57s/it]
test ppl:  88%|████████▊ | 208/236 [13:26<01:55,  4.13s/it]
test ppl:  89%|████████▊ | 209/236 [13:31<02:05,  4.66s/it]
test ppl:  89%|████████▉ | 210/236 [13:34<01:42,  3.96s/it]
test ppl:  89%|████████▉ | 211/236 [13:39<01:44,  4.18s/it]
test ppl:  90%|████████▉ | 212/236 [13:44<01:51,  4.66s/it]
test ppl:  90%|█████████ | 213/236 [13:50<01:55,  5.00s/it]
test ppl:  91%|█████████ | 214/236 [13:51<01:25,  3.90s/it]
test ppl:  91%|█████████ | 215/236 [13:57<01:34,  4.48s/it]
test ppl:  92%|█████████▏| 216/236 [13:59<01:12,  3.63s/it]
test ppl:  92%|█████████▏| 217/236 [14:05<01:21,  4.30s/it]
test ppl:  92%|█████████▏| 218/236 [14:07<01:04,  3.58s/it]
test ppl:  93%|█████████▎| 219/236 [14:12<01:12,  4.26s/it]
test ppl:  93%|█████████▎| 220/236 [14:18<01:15,  4.73s/it]
test ppl:  94%|█████████▎| 221/236 [14:20<00:57,  3.82s/it]
test ppl:  94%|█████████▍| 222/236 [14:26<01:01,  4.42s/it]
test ppl:  94%|█████████▍| 223/236 [14:32<01:02,  4.84s/it]
test ppl:  95%|█████████▍| 224/236 [14:33<00:46,  3.85s/it]
test ppl:  95%|█████████▌| 225/236 [14:39<00:48,  4.43s/it]
test ppl:  96%|█████████▌| 226/236 [14:43<00:41,  4.19s/it]
test ppl:  96%|█████████▌| 227/236 [14:45<00:34,  3.78s/it]
test ppl:  97%|█████████▋| 228/236 [14:47<00:26,  3.26s/it]
test ppl:  97%|█████████▋| 229/236 [14:53<00:28,  4.02s/it]
test ppl:  97%|█████████▋| 230/236 [14:57<00:23,  3.84s/it]
test ppl:  98%|█████████▊| 231/236 [15:00<00:18,  3.69s/it]
test ppl:  98%|█████████▊| 232/236 [15:02<00:12,  3.16s/it]
test ppl:  99%|█████████▊| 233/236 [15:04<00:08,  2.85s/it]
test ppl:  99%|█████████▉| 234/236 [15:06<00:05,  2.56s/it]
test ppl: 100%|█████████▉| 235/236 [15:12<00:03,  3.54s/it]
test ppl: 100%|██████████| 236/236 [15:12<00:00,  2.67s/it]
test ppl: 100%|██████████| 236/236 [15:12<00:00,  3.87s/it]
10/12/2024 13:48:33 - INFO - __main__ -    em: 0.2094
10/12/2024 13:48:33 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.4 40:  em: 0.2094

--------------------------------------------------------------------------------
Running experiment with knn_temp=40, lmbda=0.6, k=16
2024-10-12 13:48:40.502040: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 13:48:40.521589: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 13:48:40.543419: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 13:48:40.550055: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 13:48:40.566019: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 13:48:41.555494: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 13:48:42 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.6, knn_temp=40, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 13:48:42 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:33:25,  2.21it/s]
Adding feature api:   4%|▍         | 7044/187062 [00:00<00:10, 16876.95it/s]
Adding feature api:   8%|▊         | 14922/187062 [00:00<00:05, 32661.81it/s]
Adding feature api:  12%|█▏        | 23067/187062 [00:00<00:03, 45688.36it/s]
Adding feature api:  17%|█▋        | 31261/187062 [00:00<00:02, 55697.35it/s]
Adding feature api:  21%|██        | 39353/187062 [00:00<00:02, 62830.96it/s]
Adding feature api:  25%|██▌       | 47246/187062 [00:01<00:02, 67463.09it/s]
Adding feature api:  30%|██▉       | 55398/187062 [00:01<00:01, 71557.44it/s]
Adding feature api:  34%|███▍      | 63560/187062 [00:01<00:01, 74514.16it/s]
Adding feature api:  38%|███▊      | 71783/187062 [00:01<00:01, 76794.90it/s]
Adding feature api:  43%|████▎     | 79801/187062 [00:01<00:01, 77584.31it/s]
Adding feature api:  47%|████▋     | 87972/187062 [00:01<00:01, 78808.24it/s]
Adding feature api:  51%|█████▏    | 96230/187062 [00:01<00:01, 79929.53it/s]
Adding feature api:  56%|█████▌    | 104407/187062 [00:01<00:01, 80475.84it/s]
Adding feature api:  60%|██████    | 112601/187062 [00:01<00:00, 80911.35it/s]
Adding feature api:  65%|██████▍   | 120751/187062 [00:01<00:00, 80510.99it/s]
Adding feature api:  69%|██████▉   | 128894/187062 [00:02<00:00, 80782.56it/s]
Adding feature api:  73%|███████▎  | 137070/187062 [00:02<00:00, 81073.13it/s]
Adding feature api:  78%|███████▊  | 145268/187062 [00:02<00:00, 81341.72it/s]
Adding feature api:  82%|████████▏ | 153417/187062 [00:02<00:00, 80824.35it/s]
Adding feature api:  86%|████████▋ | 161636/187062 [00:02<00:00, 81230.56it/s]
Adding feature api:  91%|█████████ | 169830/187062 [00:02<00:00, 81441.12it/s]
Adding feature api:  95%|█████████▌| 177980/187062 [00:02<00:00, 80092.93it/s]
Adding feature api:  99%|█████████▉| 185998/187062 [00:02<00:00, 52189.98it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 62774.15it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:12:17,  2.24it/s]
Adding feature datatype:   4%|▎         | 6599/187062 [00:00<00:11, 15992.56it/s]
Adding feature datatype:   8%|▊         | 14503/187062 [00:00<00:05, 32206.48it/s]
Adding feature datatype:  12%|█▏        | 22513/187062 [00:00<00:03, 45074.13it/s]
Adding feature datatype:  16%|█▋        | 30507/187062 [00:00<00:02, 54743.98it/s]
Adding feature datatype:  21%|██        | 38533/187062 [00:00<00:02, 61983.31it/s]
Adding feature datatype:  25%|██▍       | 46566/187062 [00:01<00:02, 67273.03it/s]
Adding feature datatype:  29%|██▉       | 54212/187062 [00:01<00:01, 69951.45it/s]
Adding feature datatype:  33%|███▎      | 62264/187062 [00:01<00:01, 73059.39it/s]
Adding feature datatype:  38%|███▊      | 70233/187062 [00:01<00:01, 75020.94it/s]
Adding feature datatype:  42%|████▏     | 78234/187062 [00:01<00:01, 76502.78it/s]
Adding feature datatype:  46%|████▌     | 86255/187062 [00:01<00:01, 77605.41it/s]
Adding feature datatype:  50%|█████     | 94178/187062 [00:01<00:01, 77435.74it/s]
Adding feature datatype:  55%|█████▍    | 102279/187062 [00:01<00:01, 78497.02it/s]
Adding feature datatype:  59%|█████▉    | 110345/187062 [00:01<00:00, 79141.01it/s]
Adding feature datatype:  63%|██████▎   | 118388/187062 [00:01<00:00, 79525.02it/s]
Adding feature datatype:  68%|██████▊   | 126381/187062 [00:02<00:00, 79534.38it/s]
Adding feature datatype:  72%|███████▏  | 134437/187062 [00:02<00:00, 79837.40it/s]
Adding feature datatype:  76%|███████▌  | 142441/187062 [00:02<00:00, 79020.45it/s]
Adding feature datatype:  80%|████████  | 150426/187062 [00:02<00:00, 79265.62it/s]
Adding feature datatype:  85%|████████▍ | 158409/187062 [00:02<00:00, 79430.80it/s]
Adding feature datatype:  89%|████████▉ | 166456/187062 [00:02<00:00, 79738.02it/s]
Adding feature datatype:  93%|█████████▎| 174518/187062 [00:02<00:00, 80001.20it/s]
Adding feature datatype:  98%|█████████▊| 182523/187062 [00:02<00:00, 58482.44it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 61982.72it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:09:01,  2.24it/s]
Adding feature literal:   4%|▎         | 6962/187062 [00:00<00:10, 16902.21it/s]
Adding feature literal:   8%|▊         | 14930/187062 [00:00<00:05, 33067.93it/s]
Adding feature literal:  12%|█▏        | 22920/187062 [00:00<00:03, 45662.02it/s]
Adding feature literal:  16%|█▋        | 30815/187062 [00:00<00:02, 54900.92it/s]
Adding feature literal:  21%|██        | 38861/187062 [00:00<00:02, 62157.50it/s]
Adding feature literal:  25%|██▌       | 46920/187062 [00:01<00:02, 67475.51it/s]
Adding feature literal:  29%|██▉       | 54964/187062 [00:01<00:01, 71259.26it/s]
Adding feature literal:  34%|███▎      | 62998/187062 [00:01<00:01, 73928.67it/s]
Adding feature literal:  38%|███▊      | 71006/187062 [00:01<00:01, 75746.50it/s]
Adding feature literal:  42%|████▏     | 79081/187062 [00:01<00:01, 77229.85it/s]
Adding feature literal:  47%|████▋     | 87136/187062 [00:01<00:01, 78216.59it/s]
Adding feature literal:  51%|█████     | 95205/187062 [00:01<00:01, 78951.77it/s]
Adding feature literal:  55%|█████▌    | 103303/187062 [00:01<00:01, 79555.28it/s]
Adding feature literal:  60%|█████▉    | 111362/187062 [00:01<00:00, 79863.39it/s]
Adding feature literal:  64%|██████▍   | 119501/187062 [00:01<00:00, 80317.42it/s]
Adding feature literal:  68%|██████▊   | 127573/187062 [00:02<00:00, 80419.52it/s]
Adding feature literal:  73%|███████▎  | 135679/187062 [00:02<00:00, 80609.36it/s]
Adding feature literal:  77%|███████▋  | 143829/187062 [00:02<00:00, 80873.26it/s]
Adding feature literal:  81%|████████  | 151930/187062 [00:02<00:00, 80904.92it/s]
Adding feature literal:  86%|████████▌ | 160034/187062 [00:02<00:00, 80942.21it/s]
Adding feature literal:  90%|████████▉ | 168135/187062 [00:02<00:00, 80878.25it/s]
Adding feature literal:  94%|█████████▍| 176228/187062 [00:02<00:00, 80885.86it/s]
Adding feature literal:  99%|█████████▊| 184320/187062 [00:02<00:00, 54766.61it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 62558.06it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:16:08,  2.23it/s]
Adding feature operator:   4%|▎         | 7006/187062 [00:00<00:10, 16943.37it/s]
Adding feature operator:   8%|▊         | 15033/187062 [00:00<00:05, 33203.82it/s]
Adding feature operator:  12%|█▏        | 23101/187062 [00:00<00:03, 45944.73it/s]
Adding feature operator:  17%|█▋        | 31188/187062 [00:00<00:02, 55623.29it/s]
Adding feature operator:  21%|██        | 39269/187062 [00:00<00:02, 62766.10it/s]
Adding feature operator:  25%|██▌       | 47228/187062 [00:01<00:02, 67616.35it/s]
Adding feature operator:  30%|██▉       | 55273/187062 [00:01<00:01, 71357.93it/s]
Adding feature operator:  34%|███▍      | 63357/187062 [00:01<00:01, 74144.67it/s]
Adding feature operator:  38%|███▊      | 71465/187062 [00:01<00:01, 76194.86it/s]
Adding feature operator:  43%|████▎     | 79553/187062 [00:01<00:01, 77583.60it/s]
Adding feature operator:  47%|████▋     | 87674/187062 [00:01<00:01, 78661.89it/s]
Adding feature operator:  51%|█████     | 95758/187062 [00:01<00:01, 79311.48it/s]
Adding feature operator:  56%|█████▌    | 103857/187062 [00:01<00:01, 79812.34it/s]
Adding feature operator:  60%|█████▉    | 111970/187062 [00:01<00:00, 80205.12it/s]
Adding feature operator:  64%|██████▍   | 120083/187062 [00:01<00:00, 80481.11it/s]
Adding feature operator:  69%|██████▊   | 128240/187062 [00:02<00:00, 80804.35it/s]
Adding feature operator:  73%|███████▎  | 136362/187062 [00:02<00:00, 80925.73it/s]
Adding feature operator:  77%|███████▋  | 144475/187062 [00:02<00:00, 80840.39it/s]
Adding feature operator:  82%|████████▏ | 152597/187062 [00:02<00:00, 80953.47it/s]
Adding feature operator:  86%|████████▌ | 160730/187062 [00:02<00:00, 81063.01it/s]
Adding feature operator:  90%|█████████ | 168844/187062 [00:02<00:00, 81060.91it/s]
Adding feature operator:  95%|█████████▍| 176971/187062 [00:02<00:00, 81123.03it/s]
Adding feature operator:  99%|█████████▉| 185087/187062 [00:02<00:00, 53644.27it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 62734.78it/s]
[2024-10-12 13:49:26,757] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 13:49:28 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 13:49:28 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:17, 382.01 examples/s]
Map:   1%|▏         | 84/6548 [00:00<00:32, 200.88 examples/s]
Map:   2%|▏         | 125/6548 [00:00<00:25, 251.40 examples/s]
Map:   3%|▎         | 167/6548 [00:00<00:21, 296.66 examples/s]
Map:   3%|▎         | 225/6548 [00:00<00:19, 328.49 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:18, 337.61 examples/s]
Map:   5%|▌         | 330/6548 [00:01<00:20, 307.54 examples/s]
Map:   6%|▌         | 365/6548 [00:01<00:19, 316.74 examples/s]
Map:   6%|▋         | 418/6548 [00:01<00:16, 368.09 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 333.63 examples/s]
Map:   8%|▊         | 535/6548 [00:01<00:16, 354.55 examples/s]
Map:   9%|▉         | 578/6548 [00:01<00:16, 369.15 examples/s]
Map:   9%|▉         | 618/6548 [00:01<00:15, 374.53 examples/s]
Map:  10%|█         | 666/6548 [00:02<00:17, 335.33 examples/s]
Map:  11%|█         | 711/6548 [00:02<00:16, 359.44 examples/s]
Map:  12%|█▏        | 758/6548 [00:02<00:15, 384.03 examples/s]
Map:  12%|█▏        | 813/6548 [00:02<00:13, 419.84 examples/s]
Map:  13%|█▎        | 876/6548 [00:02<00:13, 411.33 examples/s]
Map:  14%|█▍        | 932/6548 [00:02<00:14, 382.34 examples/s]
Map:  15%|█▍        | 981/6548 [00:02<00:15, 355.76 examples/s]
Map:  16%|█▌        | 1037/6548 [00:03<00:23, 234.56 examples/s]
Map:  16%|█▋        | 1073/6548 [00:03<00:21, 253.09 examples/s]
Map:  17%|█▋        | 1115/6548 [00:03<00:19, 281.65 examples/s]
Map:  18%|█▊        | 1156/6548 [00:03<00:17, 306.95 examples/s]
Map:  18%|█▊        | 1197/6548 [00:03<00:16, 329.52 examples/s]
Map:  19%|█▉        | 1238/6548 [00:03<00:15, 338.11 examples/s]
Map:  20%|█▉        | 1278/6548 [00:03<00:15, 344.06 examples/s]
Map:  20%|██        | 1323/6548 [00:04<00:16, 323.45 examples/s]
Map:  21%|██        | 1369/6548 [00:04<00:17, 298.96 examples/s]
Map:  21%|██▏       | 1401/6548 [00:04<00:17, 300.23 examples/s]
Map:  22%|██▏       | 1436/6548 [00:04<00:18, 283.91 examples/s]
Map:  23%|██▎       | 1480/6548 [00:04<00:17, 293.30 examples/s]
Map:  23%|██▎       | 1514/6548 [00:04<00:16, 302.52 examples/s]
Map:  24%|██▍       | 1559/6548 [00:04<00:16, 296.86 examples/s]
Map:  24%|██▍       | 1595/6548 [00:04<00:16, 307.69 examples/s]
Map:  25%|██▍       | 1629/6548 [00:05<00:18, 272.95 examples/s]
Map:  25%|██▌       | 1666/6548 [00:05<00:18, 259.59 examples/s]
Map:  26%|██▌       | 1705/6548 [00:05<00:16, 289.08 examples/s]
Map:  27%|██▋       | 1746/6548 [00:05<00:15, 318.22 examples/s]
Map:  27%|██▋       | 1791/6548 [00:05<00:13, 349.91 examples/s]
Map:  28%|██▊       | 1837/6548 [00:05<00:12, 369.37 examples/s]
Map:  29%|██▉       | 1884/6548 [00:05<00:13, 340.43 examples/s]
Map:  29%|██▉       | 1925/6548 [00:05<00:13, 348.35 examples/s]
Map:  30%|███       | 1966/6548 [00:06<00:12, 362.80 examples/s]
Map:  31%|███       | 2017/6548 [00:06<00:19, 238.42 examples/s]
Map:  31%|███▏      | 2049/6548 [00:06<00:18, 249.04 examples/s]
Map:  32%|███▏      | 2092/6548 [00:06<00:15, 281.36 examples/s]
Map:  33%|███▎      | 2131/6548 [00:06<00:16, 273.41 examples/s]
Map:  33%|███▎      | 2172/6548 [00:06<00:16, 270.90 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 281.83 examples/s]
Map:  34%|███▍      | 2255/6548 [00:07<00:15, 270.26 examples/s]
Map:  35%|███▌      | 2305/6548 [00:07<00:15, 282.36 examples/s]
Map:  36%|███▌      | 2350/6548 [00:07<00:13, 314.11 examples/s]
Map:  37%|███▋      | 2392/6548 [00:07<00:13, 298.40 examples/s]
Map:  37%|███▋      | 2435/6548 [00:07<00:12, 325.66 examples/s]
Map:  38%|███▊      | 2478/6548 [00:07<00:13, 308.53 examples/s]
Map:  38%|███▊      | 2517/6548 [00:08<00:12, 315.77 examples/s]
Map:  39%|███▉      | 2562/6548 [00:08<00:11, 343.77 examples/s]
Map:  40%|███▉      | 2608/6548 [00:08<00:10, 369.81 examples/s]
Map:  41%|████      | 2654/6548 [00:08<00:09, 391.66 examples/s]
Map:  41%|████      | 2700/6548 [00:08<00:10, 353.32 examples/s]
Map:  42%|████▏     | 2737/6548 [00:08<00:10, 347.50 examples/s]
Map:  42%|████▏     | 2773/6548 [00:08<00:11, 342.35 examples/s]
Map:  43%|████▎     | 2817/6548 [00:08<00:11, 323.81 examples/s]
Map:  44%|████▎     | 2862/6548 [00:09<00:13, 280.37 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 288.94 examples/s]
Map:  45%|████▌     | 2951/6548 [00:09<00:12, 294.66 examples/s]
Map:  46%|████▌     | 2988/6548 [00:09<00:11, 299.42 examples/s]
Map:  46%|████▌     | 3019/6548 [00:10<00:21, 161.75 examples/s]
Map:  47%|████▋     | 3053/6548 [00:10<00:18, 184.49 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 207.57 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 248.20 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:13, 252.91 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 249.19 examples/s]
Map:  49%|████▉     | 3237/6548 [00:10<00:12, 268.93 examples/s]
Map:  50%|████▉     | 3269/6548 [00:10<00:11, 278.10 examples/s]
Map:  51%|█████     | 3325/6548 [00:10<00:10, 309.59 examples/s]
Map:  52%|█████▏    | 3378/6548 [00:11<00:10, 313.93 examples/s]
Map:  52%|█████▏    | 3420/6548 [00:11<00:10, 287.79 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 276.82 examples/s]
Map:  53%|█████▎    | 3497/6548 [00:11<00:10, 277.95 examples/s]
Map:  54%|█████▍    | 3546/6548 [00:11<00:09, 321.91 examples/s]
Map:  55%|█████▍    | 3595/6548 [00:11<00:08, 360.71 examples/s]
Map:  56%|█████▌    | 3639/6548 [00:11<00:07, 374.95 examples/s]
Map:  57%|█████▋    | 3700/6548 [00:12<00:07, 380.89 examples/s]
Map:  57%|█████▋    | 3741/6548 [00:12<00:07, 384.59 examples/s]
Map:  58%|█████▊    | 3799/6548 [00:12<00:07, 375.01 examples/s]
Map:  59%|█████▊    | 3846/6548 [00:12<00:08, 317.80 examples/s]
Map:  59%|█████▉    | 3882/6548 [00:12<00:08, 318.58 examples/s]
Map:  60%|█████▉    | 3917/6548 [00:12<00:08, 325.00 examples/s]
Map:  60%|██████    | 3955/6548 [00:12<00:07, 330.11 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 233.84 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 290.37 examples/s]
Map:  63%|██████▎   | 4096/6548 [00:13<00:07, 315.91 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 326.85 examples/s]
Map:  64%|██████▍   | 4194/6548 [00:13<00:07, 328.40 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:06, 334.25 examples/s]
Map:  65%|██████▌   | 4282/6548 [00:13<00:06, 360.76 examples/s]
Map:  66%|██████▌   | 4325/6548 [00:14<00:05, 371.69 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:14<00:06, 358.08 examples/s]
Map:  67%|██████▋   | 4405/6548 [00:14<00:05, 359.78 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:05, 385.72 examples/s]
Map:  69%|██████▊   | 4498/6548 [00:14<00:06, 330.33 examples/s]
Map:  69%|██████▉   | 4546/6548 [00:14<00:06, 320.39 examples/s]
Map:  70%|███████   | 4584/6548 [00:14<00:06, 325.51 examples/s]
Map:  71%|███████   | 4626/6548 [00:14<00:05, 345.30 examples/s]
Map:  71%|███████▏  | 4668/6548 [00:15<00:05, 363.67 examples/s]
Map:  72%|███████▏  | 4730/6548 [00:15<00:04, 363.97 examples/s]
Map:  73%|███████▎  | 4776/6548 [00:15<00:04, 381.71 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 385.60 examples/s]
Map:  75%|███████▍  | 4879/6548 [00:15<00:04, 353.35 examples/s]
Map:  75%|███████▌  | 4932/6548 [00:15<00:04, 373.26 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:04, 386.69 examples/s]
Map:  77%|███████▋  | 5038/6548 [00:16<00:06, 247.25 examples/s]
Map:  78%|███████▊  | 5081/6548 [00:16<00:05, 255.33 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 264.50 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 278.97 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 281.63 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:16<00:04, 296.12 examples/s]
Map:  80%|████████  | 5256/6548 [00:16<00:04, 299.55 examples/s]
Map:  81%|████████  | 5304/6548 [00:17<00:03, 345.08 examples/s]
Map:  82%|████████▏ | 5346/6548 [00:17<00:03, 301.43 examples/s]
Map:  82%|████████▏ | 5385/6548 [00:17<00:03, 320.54 examples/s]
Map:  83%|████████▎ | 5423/6548 [00:17<00:03, 282.93 examples/s]
Map:  83%|████████▎ | 5461/6548 [00:17<00:03, 299.86 examples/s]
Map:  84%|████████▍ | 5500/6548 [00:17<00:03, 319.09 examples/s]
Map:  85%|████████▍ | 5538/6548 [00:17<00:03, 332.03 examples/s]
Map:  85%|████████▌ | 5580/6548 [00:17<00:03, 295.48 examples/s]
Map:  86%|████████▌ | 5616/6548 [00:18<00:03, 307.17 examples/s]
Map:  86%|████████▋ | 5664/6548 [00:18<00:02, 298.82 examples/s]
Map:  87%|████████▋ | 5711/6548 [00:18<00:02, 292.24 examples/s]
Map:  88%|████████▊ | 5755/6548 [00:18<00:02, 325.03 examples/s]
Map:  88%|████████▊ | 5794/6548 [00:18<00:02, 336.13 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:02, 339.00 examples/s]
Map:  90%|████████▉ | 5889/6548 [00:18<00:01, 351.39 examples/s]
Map:  91%|█████████ | 5927/6548 [00:19<00:01, 356.96 examples/s]
Map:  91%|█████████ | 5968/6548 [00:19<00:01, 324.59 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 236.97 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 267.48 examples/s]
Map:  93%|█████████▎| 6120/6548 [00:19<00:01, 258.57 examples/s]
Map:  94%|█████████▍| 6156/6548 [00:19<00:01, 277.72 examples/s]
Map:  95%|█████████▍| 6191/6548 [00:20<00:01, 291.18 examples/s]
Map:  95%|█████████▌| 6235/6548 [00:20<00:00, 323.73 examples/s]
Map:  96%|█████████▌| 6271/6548 [00:20<00:00, 327.53 examples/s]
Map:  96%|█████████▋| 6310/6548 [00:20<00:00, 340.26 examples/s]
Map:  97%|█████████▋| 6366/6548 [00:20<00:00, 385.11 examples/s]
Map:  98%|█████████▊| 6416/6548 [00:20<00:00, 364.01 examples/s]
Map:  99%|█████████▊| 6464/6548 [00:20<00:00, 389.88 examples/s]
Map: 100%|█████████▉| 6520/6548 [00:20<00:00, 380.56 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 310.85 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▎         | 32/903 [00:00<00:02, 312.91 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 336.95 examples/s]
Map:  13%|█▎        | 119/903 [00:00<00:02, 325.71 examples/s]
Map:  18%|█▊        | 162/903 [00:00<00:02, 359.96 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 383.01 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 388.28 examples/s]
Map:  34%|███▍      | 310/903 [00:00<00:01, 372.61 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 319.38 examples/s]
Map:  46%|████▌     | 413/903 [00:01<00:01, 305.32 examples/s]
Map:  49%|████▉     | 445/903 [00:01<00:01, 306.24 examples/s]
Map:  53%|█████▎    | 482/903 [00:01<00:01, 317.60 examples/s]
Map:  58%|█████▊    | 520/903 [00:01<00:01, 329.70 examples/s]
Map:  63%|██████▎   | 565/903 [00:01<00:00, 359.09 examples/s]
Map:  68%|██████▊   | 613/903 [00:01<00:00, 381.28 examples/s]
Map:  75%|███████▍  | 673/903 [00:01<00:00, 385.27 examples/s]
Map:  80%|███████▉  | 718/903 [00:02<00:00, 393.46 examples/s]
Map:  85%|████████▍ | 766/903 [00:02<00:00, 412.45 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 400.60 examples/s]
Map:  96%|█████████▋| 871/903 [00:02<00:00, 412.27 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 330.61 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 299.13 examples/s]
Map:   4%|▍         | 82/1882 [00:00<00:04, 371.53 examples/s]
Map:   7%|▋         | 135/1882 [00:00<00:05, 346.59 examples/s]
Map:  10%|▉         | 181/1882 [00:00<00:04, 361.06 examples/s]
Map:  12%|█▏        | 223/1882 [00:00<00:04, 360.79 examples/s]
Map:  14%|█▍        | 267/1882 [00:00<00:04, 377.39 examples/s]
Map:  17%|█▋        | 313/1882 [00:00<00:04, 348.37 examples/s]
Map:  19%|█▊        | 351/1882 [00:01<00:04, 332.04 examples/s]
Map:  21%|██        | 393/1882 [00:01<00:05, 297.69 examples/s]
Map:  23%|██▎       | 433/1882 [00:01<00:05, 282.26 examples/s]
Map:  25%|██▍       | 469/1882 [00:01<00:04, 299.07 examples/s]
Map:  27%|██▋       | 507/1882 [00:01<00:04, 306.41 examples/s]
Map:  30%|██▉       | 561/1882 [00:01<00:04, 320.49 examples/s]
Map:  32%|███▏      | 599/1882 [00:01<00:03, 333.29 examples/s]
Map:  35%|███▍      | 653/1882 [00:01<00:03, 365.60 examples/s]
Map:  37%|███▋      | 696/1882 [00:02<00:03, 380.32 examples/s]
Map:  40%|████      | 761/1882 [00:02<00:02, 395.53 examples/s]
Map:  43%|████▎     | 805/1882 [00:02<00:03, 342.55 examples/s]
Map:  45%|████▌     | 848/1882 [00:02<00:02, 359.35 examples/s]
Map:  48%|████▊     | 904/1882 [00:02<00:02, 359.42 examples/s]
Map:  50%|█████     | 947/1882 [00:02<00:02, 373.58 examples/s]
Map:  53%|█████▎    | 991/1882 [00:02<00:02, 384.32 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 247.19 examples/s]
Map:  57%|█████▋    | 1082/1882 [00:03<00:03, 255.75 examples/s]
Map:  60%|█████▉    | 1124/1882 [00:03<00:02, 260.97 examples/s]
Map:  62%|██████▏   | 1173/1882 [00:03<00:02, 275.07 examples/s]
Map:  64%|██████▍   | 1206/1882 [00:03<00:02, 256.20 examples/s]
Map:  66%|██████▋   | 1250/1882 [00:03<00:02, 292.67 examples/s]
Map:  69%|██████▉   | 1305/1882 [00:04<00:01, 313.34 examples/s]
Map:  71%|███████▏  | 1343/1882 [00:04<00:01, 327.01 examples/s]
Map:  74%|███████▎  | 1384/1882 [00:04<00:01, 307.89 examples/s]
Map:  75%|███████▌  | 1420/1882 [00:04<00:01, 281.51 examples/s]
Map:  77%|███████▋  | 1457/1882 [00:04<00:01, 299.06 examples/s]
Map:  79%|███████▉  | 1493/1882 [00:04<00:01, 276.32 examples/s]
Map:  81%|████████  | 1523/1882 [00:04<00:01, 276.57 examples/s]
Map:  83%|████████▎ | 1568/1882 [00:05<00:01, 283.00 examples/s]
Map:  86%|████████▌ | 1616/1882 [00:05<00:00, 329.74 examples/s]
Map:  89%|████████▊ | 1666/1882 [00:05<00:00, 322.22 examples/s]
Map:  91%|█████████ | 1716/1882 [00:05<00:00, 322.74 examples/s]
Map:  94%|█████████▎| 1763/1882 [00:05<00:00, 272.69 examples/s]
Map:  95%|█████████▌| 1794/1882 [00:05<00:00, 278.85 examples/s]
Map:  98%|█████████▊| 1841/1882 [00:05<00:00, 317.46 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 229.46 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 305.30 examples/s]
10/12/2024 13:50:30 - INFO - __main__ -     ***** Testing *****
10/12/2024 13:50:30 - INFO - __main__ -     Batch size = 8
10/12/2024 13:50:30 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 13:50:30 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 13:50:30 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 13:50:31 - INFO - knnlm -   Reading datastore took 0.8815464973449707 s
10/12/2024 13:50:32 - INFO - knnlm -   Moving index to GPU took 0.9411940574645996 s
10/12/2024 13:50:32 - INFO - __main__ -   ******************************break-into
10/12/2024 13:50:32 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 13:50:32 - INFO - __main__ -     Num examples = 236
10/12/2024 13:50:32 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:43,  7.59s/it]
test ppl:   1%|          | 2/236 [00:09<16:19,  4.18s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:29,  2.96s/it]
test ppl:   2%|▏         | 4/236 [00:12<09:31,  2.46s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:12,  3.69s/it]
test ppl:   3%|▎         | 6/236 [00:24<17:01,  4.44s/it]
test ppl:   3%|▎         | 7/236 [00:26<14:36,  3.83s/it]
test ppl:   3%|▎         | 8/236 [00:31<14:58,  3.94s/it]
test ppl:   4%|▍         | 9/236 [00:34<13:59,  3.70s/it]
test ppl:   4%|▍         | 10/236 [00:37<13:42,  3.64s/it]
test ppl:   5%|▍         | 11/236 [00:41<14:05,  3.76s/it]
test ppl:   5%|▌         | 12/236 [00:47<16:27,  4.41s/it]
test ppl:   6%|▌         | 13/236 [00:53<18:03,  4.86s/it]
test ppl:   6%|▌         | 14/236 [00:56<15:34,  4.21s/it]
test ppl:   6%|▋         | 15/236 [00:57<12:15,  3.33s/it]
test ppl:   7%|▋         | 16/236 [00:59<10:35,  2.89s/it]
test ppl:   7%|▋         | 17/236 [01:04<12:57,  3.55s/it]
test ppl:   8%|▊         | 18/236 [01:06<10:52,  2.99s/it]
test ppl:   8%|▊         | 19/236 [01:12<13:57,  3.86s/it]
test ppl:   8%|▊         | 20/236 [01:14<12:29,  3.47s/it]
test ppl:   9%|▉         | 21/236 [01:17<12:05,  3.37s/it]
test ppl:   9%|▉         | 22/236 [01:23<14:50,  4.16s/it]
test ppl:  10%|▉         | 23/236 [01:27<13:47,  3.88s/it]
test ppl:  10%|█         | 24/236 [01:29<11:57,  3.38s/it]
test ppl:  11%|█         | 25/236 [01:31<10:10,  2.90s/it]
test ppl:  11%|█         | 26/236 [01:35<12:15,  3.50s/it]
test ppl:  11%|█▏        | 27/236 [01:39<12:31,  3.59s/it]
test ppl:  12%|█▏        | 28/236 [01:41<10:14,  2.95s/it]
test ppl:  12%|█▏        | 29/236 [01:43<09:32,  2.76s/it]
test ppl:  13%|█▎        | 30/236 [01:45<08:13,  2.40s/it]
test ppl:  13%|█▎        | 31/236 [01:47<07:47,  2.28s/it]
test ppl:  14%|█▎        | 32/236 [01:50<08:28,  2.49s/it]
test ppl:  14%|█▍        | 33/236 [01:55<11:54,  3.52s/it]
test ppl:  14%|█▍        | 34/236 [02:00<12:23,  3.68s/it]
test ppl:  15%|█▍        | 35/236 [02:02<11:10,  3.34s/it]
test ppl:  15%|█▌        | 36/236 [02:08<13:41,  4.11s/it]
test ppl:  16%|█▌        | 37/236 [02:14<15:25,  4.65s/it]
test ppl:  16%|█▌        | 38/236 [02:16<12:47,  3.88s/it]
test ppl:  17%|█▋        | 39/236 [02:18<10:36,  3.23s/it]
test ppl:  17%|█▋        | 40/236 [02:19<08:40,  2.66s/it]
test ppl:  17%|█▋        | 41/236 [02:21<07:51,  2.42s/it]
test ppl:  18%|█▊        | 42/236 [02:27<11:14,  3.48s/it]
test ppl:  18%|█▊        | 43/236 [02:33<13:30,  4.20s/it]
test ppl:  19%|█▊        | 44/236 [02:35<11:33,  3.61s/it]
test ppl:  19%|█▉        | 45/236 [02:37<09:48,  3.08s/it]
test ppl:  19%|█▉        | 46/236 [02:43<12:28,  3.94s/it]
test ppl:  20%|█▉        | 47/236 [02:44<10:08,  3.22s/it]
test ppl:  20%|██        | 48/236 [02:50<12:34,  4.01s/it]
test ppl:  21%|██        | 49/236 [02:53<11:22,  3.65s/it]
test ppl:  21%|██        | 50/236 [02:59<13:26,  4.34s/it]
test ppl:  22%|██▏       | 51/236 [03:05<14:48,  4.80s/it]
test ppl:  22%|██▏       | 52/236 [03:11<15:43,  5.13s/it]
test ppl:  22%|██▏       | 53/236 [03:14<13:43,  4.50s/it]
test ppl:  23%|██▎       | 54/236 [03:15<10:57,  3.61s/it]
test ppl:  23%|██▎       | 55/236 [03:21<12:55,  4.29s/it]
test ppl:  24%|██▎       | 56/236 [03:27<14:19,  4.78s/it]
test ppl:  24%|██▍       | 57/236 [03:33<15:14,  5.11s/it]
test ppl:  25%|██▍       | 58/236 [03:35<12:38,  4.26s/it]
test ppl:  25%|██▌       | 59/236 [03:41<14:00,  4.75s/it]
test ppl:  25%|██▌       | 60/236 [03:44<12:37,  4.30s/it]
test ppl:  26%|██▌       | 61/236 [03:50<13:55,  4.77s/it]
test ppl:  26%|██▋       | 62/236 [03:54<13:13,  4.56s/it]
test ppl:  27%|██▋       | 63/236 [03:57<11:21,  3.94s/it]
test ppl:  27%|██▋       | 64/236 [03:58<09:13,  3.22s/it]
test ppl:  28%|██▊       | 65/236 [04:00<07:33,  2.65s/it]
test ppl:  28%|██▊       | 66/236 [04:04<08:42,  3.07s/it]
test ppl:  28%|██▊       | 67/236 [04:10<11:03,  3.92s/it]
test ppl:  29%|██▉       | 68/236 [04:15<12:38,  4.51s/it]
test ppl:  29%|██▉       | 69/236 [04:21<13:17,  4.77s/it]
test ppl:  30%|██▉       | 70/236 [04:22<10:23,  3.76s/it]
test ppl:  30%|███       | 71/236 [04:25<09:51,  3.59s/it]
test ppl:  31%|███       | 72/236 [04:28<08:36,  3.15s/it]
test ppl:  31%|███       | 73/236 [04:30<08:16,  3.04s/it]
test ppl:  31%|███▏      | 74/236 [04:32<06:58,  2.58s/it]
test ppl:  32%|███▏      | 75/236 [04:38<09:35,  3.57s/it]
test ppl:  32%|███▏      | 76/236 [04:44<11:22,  4.27s/it]
test ppl:  33%|███▎      | 77/236 [04:46<09:43,  3.67s/it]
test ppl:  33%|███▎      | 78/236 [04:48<08:09,  3.10s/it]
test ppl:  33%|███▎      | 79/236 [04:51<08:40,  3.31s/it]
test ppl:  34%|███▍      | 80/236 [04:57<10:37,  4.08s/it]
test ppl:  34%|███▍      | 81/236 [05:03<11:56,  4.62s/it]
test ppl:  35%|███▍      | 82/236 [05:09<12:52,  5.01s/it]
test ppl:  35%|███▌      | 83/236 [05:13<11:52,  4.65s/it]
test ppl:  36%|███▌      | 84/236 [05:15<10:05,  3.98s/it]
test ppl:  36%|███▌      | 85/236 [05:20<10:10,  4.05s/it]
test ppl:  36%|███▋      | 86/236 [05:21<08:04,  3.23s/it]
test ppl:  37%|███▋      | 87/236 [05:24<07:36,  3.07s/it]
test ppl:  37%|███▋      | 88/236 [05:29<09:38,  3.91s/it]
test ppl:  38%|███▊      | 89/236 [05:31<08:10,  3.33s/it]
test ppl:  38%|███▊      | 90/236 [05:37<09:57,  4.09s/it]
test ppl:  39%|███▊      | 91/236 [05:43<10:49,  4.48s/it]
test ppl:  39%|███▉      | 92/236 [05:46<09:33,  3.98s/it]
test ppl:  39%|███▉      | 93/236 [05:51<10:50,  4.55s/it]
test ppl:  40%|███▉      | 94/236 [05:57<11:43,  4.95s/it]
test ppl:  40%|████      | 95/236 [06:00<09:52,  4.20s/it]
test ppl:  41%|████      | 96/236 [06:04<09:30,  4.07s/it]
test ppl:  41%|████      | 97/236 [06:09<10:41,  4.61s/it]
test ppl:  42%|████▏     | 98/236 [06:15<11:29,  5.00s/it]
test ppl:  42%|████▏     | 99/236 [06:21<12:01,  5.27s/it]
test ppl:  42%|████▏     | 100/236 [06:22<09:02,  3.99s/it]
test ppl:  43%|████▎     | 101/236 [06:28<10:14,  4.55s/it]
test ppl:  43%|████▎     | 102/236 [06:32<09:37,  4.31s/it]
test ppl:  44%|████▎     | 103/236 [06:33<07:38,  3.45s/it]
test ppl:  44%|████▍     | 104/236 [06:38<08:10,  3.72s/it]
test ppl:  44%|████▍     | 105/236 [06:42<08:18,  3.81s/it]
test ppl:  45%|████▍     | 106/236 [06:47<09:17,  4.29s/it]
test ppl:  45%|████▌     | 107/236 [06:49<07:52,  3.66s/it]
test ppl:  46%|████▌     | 108/236 [06:54<08:31,  4.00s/it]
test ppl:  46%|████▌     | 109/236 [07:00<09:41,  4.58s/it]
test ppl:  47%|████▋     | 110/236 [07:02<07:44,  3.69s/it]
test ppl:  47%|████▋     | 111/236 [07:07<09:04,  4.36s/it]
test ppl:  47%|████▋     | 112/236 [07:13<09:57,  4.82s/it]
test ppl:  48%|████▊     | 113/236 [07:15<08:00,  3.91s/it]
test ppl:  48%|████▊     | 114/236 [07:20<08:16,  4.07s/it]
test ppl:  49%|████▊     | 115/236 [07:22<07:00,  3.48s/it]
test ppl:  49%|████▉     | 116/236 [07:28<08:24,  4.21s/it]
test ppl:  50%|████▉     | 117/236 [07:29<06:56,  3.50s/it]
test ppl:  50%|█████     | 118/236 [07:35<07:52,  4.01s/it]
test ppl:  50%|█████     | 119/236 [07:37<06:40,  3.42s/it]
test ppl:  51%|█████     | 120/236 [07:38<05:28,  2.83s/it]
test ppl:  51%|█████▏    | 121/236 [07:41<05:21,  2.79s/it]
test ppl:  52%|█████▏    | 122/236 [07:46<06:38,  3.49s/it]
test ppl:  52%|█████▏    | 123/236 [07:48<05:48,  3.08s/it]
test ppl:  53%|█████▎    | 124/236 [07:53<06:50,  3.66s/it]
test ppl:  53%|█████▎    | 125/236 [07:59<08:00,  4.33s/it]
test ppl:  53%|█████▎    | 126/236 [08:05<08:49,  4.81s/it]
test ppl:  54%|█████▍    | 127/236 [08:07<07:16,  4.00s/it]
test ppl:  54%|█████▍    | 128/236 [08:09<06:03,  3.37s/it]
test ppl:  55%|█████▍    | 129/236 [08:12<05:44,  3.22s/it]
test ppl:  55%|█████▌    | 130/236 [08:15<05:37,  3.18s/it]
test ppl:  56%|█████▌    | 131/236 [08:21<06:59,  4.00s/it]
test ppl:  56%|█████▌    | 132/236 [08:23<06:08,  3.54s/it]
test ppl:  56%|█████▋    | 133/236 [08:27<06:15,  3.64s/it]
test ppl:  57%|█████▋    | 134/236 [08:31<06:04,  3.58s/it]
test ppl:  57%|█████▋    | 135/236 [08:37<07:12,  4.28s/it]
test ppl:  58%|█████▊    | 136/236 [08:38<05:39,  3.39s/it]
test ppl:  58%|█████▊    | 137/236 [08:44<06:51,  4.15s/it]
test ppl:  58%|█████▊    | 138/236 [08:50<07:38,  4.68s/it]
test ppl:  59%|█████▉    | 139/236 [08:52<06:12,  3.84s/it]
test ppl:  59%|█████▉    | 140/236 [08:53<05:07,  3.20s/it]
test ppl:  60%|█████▉    | 141/236 [08:57<05:23,  3.40s/it]
test ppl:  60%|██████    | 142/236 [08:59<04:44,  3.03s/it]
test ppl:  61%|██████    | 143/236 [09:04<05:14,  3.38s/it]
test ppl:  61%|██████    | 144/236 [09:07<05:08,  3.35s/it]
test ppl:  61%|██████▏   | 145/236 [09:13<06:14,  4.12s/it]
test ppl:  62%|██████▏   | 146/236 [09:17<06:24,  4.27s/it]
test ppl:  62%|██████▏   | 147/236 [09:23<07:04,  4.77s/it]
test ppl:  63%|██████▎   | 148/236 [09:29<07:32,  5.15s/it]
test ppl:  63%|██████▎   | 149/236 [09:35<07:47,  5.38s/it]
test ppl:  64%|██████▎   | 150/236 [09:41<07:56,  5.54s/it]
test ppl:  64%|██████▍   | 151/236 [09:47<08:00,  5.65s/it]
test ppl:  64%|██████▍   | 152/236 [09:53<08:01,  5.73s/it]
test ppl:  65%|██████▍   | 153/236 [09:56<06:40,  4.83s/it]
test ppl:  65%|██████▌   | 154/236 [09:58<05:41,  4.16s/it]
test ppl:  66%|██████▌   | 155/236 [10:03<05:39,  4.19s/it]
test ppl:  66%|██████▌   | 156/236 [10:07<05:31,  4.14s/it]
test ppl:  67%|██████▋   | 157/236 [10:09<04:40,  3.56s/it]
test ppl:  67%|██████▋   | 158/236 [10:15<05:32,  4.26s/it]
test ppl:  67%|██████▋   | 159/236 [10:21<06:05,  4.75s/it]
test ppl:  68%|██████▊   | 160/236 [10:22<04:36,  3.64s/it]
test ppl:  68%|██████▊   | 161/236 [10:23<03:41,  2.95s/it]
test ppl:  69%|██████▊   | 162/236 [10:26<03:42,  3.00s/it]
test ppl:  69%|██████▉   | 163/236 [10:28<03:25,  2.82s/it]
test ppl:  69%|██████▉   | 164/236 [10:32<03:29,  2.92s/it]
test ppl:  70%|██████▉   | 165/236 [10:35<03:36,  3.05s/it]
test ppl:  70%|███████   | 166/236 [10:37<03:05,  2.65s/it]
test ppl:  71%|███████   | 167/236 [10:39<02:51,  2.48s/it]
test ppl:  71%|███████   | 168/236 [10:41<02:38,  2.33s/it]
test ppl:  72%|███████▏  | 169/236 [10:43<02:41,  2.41s/it]
test ppl:  72%|███████▏  | 170/236 [10:49<03:49,  3.47s/it]
test ppl:  72%|███████▏  | 171/236 [10:51<03:08,  2.91s/it]
test ppl:  73%|███████▎  | 172/236 [10:57<04:03,  3.81s/it]
test ppl:  73%|███████▎  | 173/236 [11:00<03:44,  3.57s/it]
test ppl:  74%|███████▎  | 174/236 [11:03<03:31,  3.42s/it]
test ppl:  74%|███████▍  | 175/236 [11:04<02:48,  2.76s/it]
test ppl:  75%|███████▍  | 176/236 [11:10<03:41,  3.70s/it]
test ppl:  75%|███████▌  | 177/236 [11:16<04:17,  4.37s/it]
test ppl:  75%|███████▌  | 178/236 [11:22<04:41,  4.85s/it]
test ppl:  76%|███████▌  | 179/236 [11:28<04:56,  5.20s/it]
test ppl:  76%|███████▋  | 180/236 [11:33<04:54,  5.27s/it]
test ppl:  77%|███████▋  | 181/236 [11:39<05:00,  5.46s/it]
test ppl:  77%|███████▋  | 182/236 [11:41<03:57,  4.40s/it]
test ppl:  78%|███████▊  | 183/236 [11:43<03:08,  3.56s/it]
test ppl:  78%|███████▊  | 184/236 [11:44<02:35,  2.98s/it]
test ppl:  78%|███████▊  | 185/236 [11:50<03:17,  3.88s/it]
test ppl:  79%|███████▉  | 186/236 [11:52<02:45,  3.32s/it]
test ppl:  79%|███████▉  | 187/236 [11:54<02:17,  2.81s/it]
test ppl:  80%|███████▉  | 188/236 [12:00<02:59,  3.75s/it]
test ppl:  80%|████████  | 189/236 [12:06<03:27,  4.41s/it]
test ppl:  81%|████████  | 190/236 [12:10<03:20,  4.37s/it]
test ppl:  81%|████████  | 191/236 [12:14<03:08,  4.20s/it]
test ppl:  81%|████████▏ | 192/236 [12:17<02:44,  3.73s/it]
test ppl:  82%|████████▏ | 193/236 [12:23<03:08,  4.38s/it]
test ppl:  82%|████████▏ | 194/236 [12:25<02:41,  3.86s/it]
test ppl:  83%|████████▎ | 195/236 [12:28<02:22,  3.46s/it]
test ppl:  83%|████████▎ | 196/236 [12:30<02:01,  3.04s/it]
test ppl:  83%|████████▎ | 197/236 [12:32<01:48,  2.77s/it]
test ppl:  84%|████████▍ | 198/236 [12:38<02:20,  3.71s/it]
test ppl:  84%|████████▍ | 199/236 [12:41<02:07,  3.45s/it]
test ppl:  85%|████████▍ | 200/236 [12:46<02:30,  4.18s/it]
test ppl:  85%|████████▌ | 201/236 [12:49<02:09,  3.71s/it]
test ppl:  86%|████████▌ | 202/236 [12:55<02:27,  4.35s/it]
test ppl:  86%|████████▌ | 203/236 [13:01<02:39,  4.82s/it]
test ppl:  86%|████████▋ | 204/236 [13:03<02:08,  4.00s/it]
test ppl:  87%|████████▋ | 205/236 [13:09<02:19,  4.49s/it]
test ppl:  87%|████████▋ | 206/236 [13:12<02:04,  4.14s/it]
test ppl:  88%|████████▊ | 207/236 [13:18<02:15,  4.67s/it]
test ppl:  88%|████████▊ | 208/236 [13:21<01:54,  4.09s/it]
test ppl:  89%|████████▊ | 209/236 [13:27<02:05,  4.65s/it]
test ppl:  89%|████████▉ | 210/236 [13:29<01:42,  3.96s/it]
test ppl:  89%|████████▉ | 211/236 [13:35<01:53,  4.54s/it]
test ppl:  90%|████████▉ | 212/236 [13:41<01:58,  4.94s/it]
test ppl:  90%|█████████ | 213/236 [13:47<02:00,  5.23s/it]
test ppl:  91%|█████████ | 214/236 [13:48<01:29,  4.06s/it]
test ppl:  91%|█████████ | 215/236 [13:54<01:36,  4.62s/it]
test ppl:  92%|█████████▏| 216/236 [13:56<01:19,  3.97s/it]
test ppl:  92%|█████████▏| 217/236 [14:02<01:28,  4.64s/it]
test ppl:  92%|█████████▏| 218/236 [14:08<01:30,  5.02s/it]
test ppl:  93%|█████████▎| 219/236 [14:14<01:29,  5.29s/it]
test ppl:  93%|█████████▎| 220/236 [14:19<01:23,  5.22s/it]
test ppl:  94%|█████████▎| 221/236 [14:21<01:02,  4.18s/it]
test ppl:  94%|█████████▍| 222/236 [14:27<01:05,  4.71s/it]
test ppl:  94%|█████████▍| 223/236 [14:33<01:05,  5.07s/it]
test ppl:  95%|█████████▍| 224/236 [14:35<00:48,  4.06s/it]
test ppl:  95%|█████████▌| 225/236 [14:39<00:45,  4.13s/it]
test ppl:  96%|█████████▌| 226/236 [14:42<00:36,  3.66s/it]
test ppl:  96%|█████████▌| 227/236 [14:43<00:28,  3.12s/it]
test ppl:  97%|█████████▋| 228/236 [14:45<00:21,  2.69s/it]
test ppl:  97%|█████████▋| 229/236 [14:51<00:25,  3.64s/it]
test ppl:  97%|█████████▋| 230/236 [14:54<00:21,  3.54s/it]
test ppl:  98%|█████████▊| 231/236 [14:58<00:17,  3.53s/it]
test ppl:  98%|█████████▊| 232/236 [15:00<00:12,  3.06s/it]
test ppl:  99%|█████████▊| 233/236 [15:03<00:09,  3.00s/it]
test ppl:  99%|█████████▉| 234/236 [15:04<00:04,  2.47s/it]
test ppl: 100%|█████████▉| 235/236 [15:10<00:03,  3.49s/it]
test ppl: 100%|██████████| 236/236 [15:11<00:00,  2.74s/it]
test ppl: 100%|██████████| 236/236 [15:11<00:00,  3.86s/it]
10/12/2024 14:05:43 - INFO - __main__ -    em: 0.1908
10/12/2024 14:05:43 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.6 40:  em: 0.1908

--------------------------------------------------------------------------------
Running experiment with knn_temp=40, lmbda=0.6, k=32
2024-10-12 14:05:50.891983: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 14:05:50.911622: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 14:05:50.933476: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 14:05:50.940088: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 14:05:50.956031: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 14:05:51.950038: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 14:05:53 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.6, knn_temp=40, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 14:05:53 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:45:26,  2.19it/s]
Adding feature api:   4%|▍         | 7437/187062 [00:00<00:10, 17704.10it/s]
Adding feature api:   9%|▊         | 15920/187062 [00:00<00:04, 34738.88it/s]
Adding feature api:  13%|█▎        | 24550/187062 [00:00<00:03, 48456.53it/s]
Adding feature api:  18%|█▊        | 33158/187062 [00:00<00:02, 58816.62it/s]
Adding feature api:  22%|██▏       | 41781/187062 [00:00<00:02, 66556.37it/s]
Adding feature api:  27%|██▋       | 50360/187062 [00:01<00:01, 72084.20it/s]
Adding feature api:  32%|███▏      | 58938/187062 [00:01<00:01, 76069.23it/s]
Adding feature api:  36%|███▌      | 67558/187062 [00:01<00:01, 79043.02it/s]
Adding feature api:  41%|████      | 76204/187062 [00:01<00:01, 81232.77it/s]
Adding feature api:  45%|████▌     | 84783/187062 [00:01<00:01, 82583.53it/s]
Adding feature api:  50%|████▉     | 93297/187062 [00:01<00:01, 82852.32it/s]
Adding feature api:  55%|█████▍    | 101983/187062 [00:01<00:01, 84042.59it/s]
Adding feature api:  59%|█████▉    | 110636/187062 [00:01<00:00, 84782.28it/s]
Adding feature api:  64%|██████▍   | 119310/187062 [00:01<00:00, 85365.95it/s]
Adding feature api:  68%|██████▊   | 127925/187062 [00:01<00:00, 85599.88it/s]
Adding feature api:  73%|███████▎  | 136534/187062 [00:02<00:00, 85744.90it/s]
Adding feature api:  78%|███████▊  | 145169/187062 [00:02<00:00, 85924.07it/s]
Adding feature api:  82%|████████▏ | 153792/187062 [00:02<00:00, 86012.76it/s]
Adding feature api:  87%|████████▋ | 162415/187062 [00:02<00:00, 86074.64it/s]
Adding feature api:  91%|█████████▏| 171034/187062 [00:02<00:00, 85948.23it/s]
Adding feature api:  96%|█████████▌| 179637/187062 [00:02<00:00, 75700.22it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 65415.73it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:39:46,  2.20it/s]
Adding feature datatype:   4%|▍         | 7152/187062 [00:00<00:10, 17077.11it/s]
Adding feature datatype:   8%|▊         | 15297/187062 [00:00<00:05, 33449.43it/s]
Adding feature datatype:  13%|█▎        | 23481/187062 [00:00<00:03, 46344.85it/s]
Adding feature datatype:  17%|█▋        | 31687/187062 [00:00<00:02, 56191.90it/s]
Adding feature datatype:  21%|██▏       | 39902/187062 [00:00<00:02, 63525.48it/s]
Adding feature datatype:  26%|██▌       | 48115/187062 [00:01<00:02, 68874.13it/s]
Adding feature datatype:  30%|███       | 56358/187062 [00:01<00:01, 72820.56it/s]
Adding feature datatype:  34%|███▍      | 64522/187062 [00:01<00:01, 75408.88it/s]
Adding feature datatype:  39%|███▉      | 72699/187062 [00:01<00:01, 77028.91it/s]
Adding feature datatype:  43%|████▎     | 80904/187062 [00:01<00:01, 78515.24it/s]
Adding feature datatype:  48%|████▊     | 89086/187062 [00:01<00:01, 79497.09it/s]
Adding feature datatype:  52%|█████▏    | 97348/187062 [00:01<00:01, 80427.46it/s]
Adding feature datatype:  56%|█████▋    | 105574/187062 [00:01<00:01, 80973.22it/s]
Adding feature datatype:  61%|██████    | 113776/187062 [00:01<00:00, 81285.55it/s]
Adding feature datatype:  65%|██████▌   | 122033/187062 [00:01<00:00, 81668.04it/s]
Adding feature datatype:  70%|██████▉   | 130255/187062 [00:02<00:00, 81832.05it/s]
Adding feature datatype:  74%|███████▍  | 138468/187062 [00:02<00:00, 81903.22it/s]
Adding feature datatype:  78%|███████▊  | 146707/187062 [00:02<00:00, 82045.80it/s]
Adding feature datatype:  83%|████████▎ | 154926/187062 [00:02<00:00, 81880.76it/s]
Adding feature datatype:  87%|████████▋ | 163169/187062 [00:02<00:00, 82043.90it/s]
Adding feature datatype:  92%|█████████▏| 171391/187062 [00:02<00:00, 82093.68it/s]
Adding feature datatype:  96%|█████████▌| 179606/187062 [00:02<00:00, 72330.74it/s]
Adding feature datatype: 100%|█████████▉| 187055/187062 [00:02<00:00, 51535.69it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63307.05it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:22:39,  2.22it/s]
Adding feature literal:   4%|▍         | 7160/187062 [00:00<00:10, 17254.56it/s]
Adding feature literal:   8%|▊         | 15252/187062 [00:00<00:05, 33559.50it/s]
Adding feature literal:  13%|█▎        | 23469/187062 [00:00<00:03, 46579.16it/s]
Adding feature literal:  17%|█▋        | 31739/187062 [00:00<00:02, 56574.08it/s]
Adding feature literal:  21%|██▏       | 39980/187062 [00:00<00:02, 63892.75it/s]
Adding feature literal:  26%|██▌       | 48260/187062 [00:01<00:02, 69340.10it/s]
Adding feature literal:  30%|███       | 56541/187062 [00:01<00:01, 73266.13it/s]
Adding feature literal:  35%|███▍      | 64797/187062 [00:01<00:01, 75996.59it/s]
Adding feature literal:  39%|███▉      | 72876/187062 [00:01<00:01, 77305.40it/s]
Adding feature literal:  43%|████▎     | 81171/187062 [00:01<00:01, 78978.44it/s]
Adding feature literal:  48%|████▊     | 89418/187062 [00:01<00:01, 80016.49it/s]
Adding feature literal:  52%|█████▏    | 97589/187062 [00:01<00:01, 78680.09it/s]
Adding feature literal:  57%|█████▋    | 105870/187062 [00:01<00:01, 79891.82it/s]
Adding feature literal:  61%|██████    | 114143/187062 [00:01<00:00, 80727.97it/s]
Adding feature literal:  65%|██████▌   | 122432/187062 [00:01<00:00, 81368.53it/s]
Adding feature literal:  70%|██████▉   | 130615/187062 [00:02<00:00, 81488.61it/s]
Adding feature literal:  74%|███████▍  | 138871/187062 [00:02<00:00, 81806.34it/s]
Adding feature literal:  79%|███████▊  | 147243/187062 [00:02<00:00, 82377.38it/s]
Adding feature literal:  83%|████████▎ | 155535/187062 [00:02<00:00, 82537.60it/s]
Adding feature literal:  88%|████████▊ | 163800/187062 [00:02<00:00, 82479.71it/s]
Adding feature literal:  92%|█████████▏| 172131/187062 [00:02<00:00, 82727.38it/s]
Adding feature literal:  96%|█████████▋| 180410/187062 [00:02<00:00, 69559.87it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63477.35it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:20:59,  2.23it/s]
Adding feature operator:   4%|▍         | 7183/187062 [00:00<00:10, 17325.93it/s]
Adding feature operator:   8%|▊         | 15407/187062 [00:00<00:05, 33961.18it/s]
Adding feature operator:  13%|█▎        | 23656/187062 [00:00<00:03, 46965.68it/s]
Adding feature operator:  17%|█▋        | 31971/187062 [00:00<00:02, 56982.20it/s]
Adding feature operator:  22%|██▏       | 40267/187062 [00:00<00:02, 64342.42it/s]
Adding feature operator:  26%|██▌       | 48352/187062 [00:01<00:02, 69097.55it/s]
Adding feature operator:  30%|███       | 56668/187062 [00:01<00:01, 73197.07it/s]
Adding feature operator:  35%|███▍      | 64962/187062 [00:01<00:01, 76059.38it/s]
Adding feature operator:  39%|███▉      | 73262/187062 [00:01<00:01, 78110.57it/s]
Adding feature operator:  44%|████▎     | 81564/187062 [00:01<00:01, 79566.00it/s]
Adding feature operator:  48%|████▊     | 89826/187062 [00:01<00:01, 80473.38it/s]
Adding feature operator:  52%|█████▏    | 98136/187062 [00:01<00:01, 81255.36it/s]
Adding feature operator:  57%|█████▋    | 106419/187062 [00:01<00:00, 81716.54it/s]
Adding feature operator:  61%|██████▏   | 114704/187062 [00:01<00:00, 82053.77it/s]
Adding feature operator:  66%|██████▌   | 122995/187062 [00:01<00:00, 82306.86it/s]
Adding feature operator:  70%|███████   | 131319/187062 [00:02<00:00, 82579.16it/s]
Adding feature operator:  75%|███████▍  | 139651/187062 [00:02<00:00, 82800.34it/s]
Adding feature operator:  79%|███████▉  | 148024/187062 [00:02<00:00, 83077.05it/s]
Adding feature operator:  84%|████████▎ | 156346/187062 [00:02<00:00, 82372.06it/s]
Adding feature operator:  88%|████████▊ | 164643/187062 [00:02<00:00, 82548.28it/s]
Adding feature operator:  92%|█████████▏| 172946/187062 [00:02<00:00, 82690.02it/s]
Adding feature operator:  97%|█████████▋| 181221/187062 [00:02<00:00, 66490.10it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63879.90it/s]
[2024-10-12 14:06:36,621] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 14:06:38 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 14:06:38 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:16, 387.90 examples/s]
Map:   1%|▏         | 85/6548 [00:00<00:32, 198.39 examples/s]
Map:   2%|▏         | 125/6548 [00:00<00:26, 246.47 examples/s]
Map:   3%|▎         | 172/6548 [00:00<00:20, 305.45 examples/s]
Map:   3%|▎         | 228/6548 [00:00<00:19, 327.58 examples/s]
Map:   4%|▍         | 268/6548 [00:00<00:18, 334.39 examples/s]
Map:   5%|▍         | 304/6548 [00:00<00:18, 333.93 examples/s]
Map:   5%|▌         | 349/6548 [00:01<00:19, 320.53 examples/s]
Map:   6%|▌         | 383/6548 [00:01<00:19, 323.62 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:17, 358.96 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 331.40 examples/s]
Map:   8%|▊         | 531/6548 [00:01<00:17, 345.68 examples/s]
Map:   9%|▊         | 571/6548 [00:01<00:16, 358.07 examples/s]
Map:   9%|▉         | 620/6548 [00:01<00:17, 332.05 examples/s]
Map:  10%|█         | 661/6548 [00:02<00:19, 308.92 examples/s]
Map:  11%|█         | 706/6548 [00:02<00:17, 339.60 examples/s]
Map:  11%|█▏        | 748/6548 [00:02<00:16, 356.35 examples/s]
Map:  12%|█▏        | 800/6548 [00:02<00:14, 396.83 examples/s]
Map:  13%|█▎        | 857/6548 [00:02<00:14, 389.65 examples/s]
Map:  14%|█▍        | 908/6548 [00:02<00:15, 364.19 examples/s]
Map:  15%|█▍        | 969/6548 [00:02<00:14, 372.45 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:24, 226.81 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 252.30 examples/s]
Map:  17%|█▋        | 1100/6548 [00:03<00:18, 287.22 examples/s]
Map:  18%|█▊        | 1150/6548 [00:03<00:16, 328.06 examples/s]
Map:  18%|█▊        | 1202/6548 [00:03<00:16, 331.24 examples/s]
Map:  19%|█▉        | 1256/6548 [00:03<00:15, 335.75 examples/s]
Map:  20%|█▉        | 1296/6548 [00:04<00:15, 339.43 examples/s]
Map:  20%|██        | 1339/6548 [00:04<00:16, 320.18 examples/s]
Map:  21%|██        | 1379/6548 [00:04<00:17, 290.20 examples/s]
Map:  22%|██▏       | 1417/6548 [00:04<00:16, 307.95 examples/s]
Map:  22%|██▏       | 1459/6548 [00:04<00:17, 297.52 examples/s]
Map:  23%|██▎       | 1494/6548 [00:04<00:18, 272.81 examples/s]
Map:  23%|██▎       | 1531/6548 [00:04<00:17, 293.05 examples/s]
Map:  24%|██▍       | 1576/6548 [00:05<00:17, 286.65 examples/s]
Map:  25%|██▍       | 1611/6548 [00:05<00:18, 261.01 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:18, 266.97 examples/s]
Map:  26%|██▌       | 1685/6548 [00:05<00:18, 264.89 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:16, 296.35 examples/s]
Map:  27%|██▋       | 1771/6548 [00:05<00:14, 329.43 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 337.61 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 348.51 examples/s]
Map:  29%|██▉       | 1906/6548 [00:06<00:13, 347.66 examples/s]
Map:  30%|██▉       | 1947/6548 [00:06<00:12, 361.57 examples/s]
Map:  30%|███       | 1991/6548 [00:06<00:12, 377.93 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:19, 227.97 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:17, 258.44 examples/s]
Map:  32%|███▏      | 2105/6548 [00:06<00:16, 272.47 examples/s]
Map:  33%|███▎      | 2142/6548 [00:06<00:17, 258.73 examples/s]
Map:  33%|███▎      | 2181/6548 [00:07<00:15, 283.57 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:14, 290.10 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:14, 288.54 examples/s]
Map:  35%|███▌      | 2292/6548 [00:07<00:14, 295.02 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:13, 318.13 examples/s]
Map:  36%|███▋      | 2375/6548 [00:07<00:13, 314.44 examples/s]
Map:  37%|███▋      | 2418/6548 [00:07<00:12, 337.88 examples/s]
Map:  38%|███▊      | 2458/6548 [00:07<00:12, 325.47 examples/s]
Map:  38%|███▊      | 2495/6548 [00:08<00:12, 326.52 examples/s]
Map:  39%|███▊      | 2537/6548 [00:08<00:11, 342.49 examples/s]
Map:  40%|███▉      | 2591/6548 [00:08<00:10, 388.66 examples/s]
Map:  40%|████      | 2641/6548 [00:08<00:10, 365.26 examples/s]
Map:  41%|████      | 2698/6548 [00:08<00:10, 357.15 examples/s]
Map:  42%|████▏     | 2738/6548 [00:08<00:11, 318.67 examples/s]
Map:  42%|████▏     | 2774/6548 [00:08<00:11, 327.11 examples/s]
Map:  43%|████▎     | 2822/6548 [00:09<00:11, 318.42 examples/s]
Map:  44%|████▎     | 2862/6548 [00:09<00:13, 273.65 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 283.05 examples/s]
Map:  45%|████▌     | 2950/6548 [00:09<00:12, 296.35 examples/s]
Map:  46%|████▌     | 2986/6548 [00:09<00:11, 308.80 examples/s]
Map:  46%|████▌     | 3020/6548 [00:10<00:22, 155.82 examples/s]
Map:  47%|████▋     | 3058/6548 [00:10<00:18, 186.33 examples/s]
Map:  47%|████▋     | 3093/6548 [00:10<00:16, 212.90 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 250.04 examples/s]
Map:  49%|████▊     | 3183/6548 [00:10<00:14, 238.73 examples/s]
Map:  49%|████▉     | 3216/6548 [00:10<00:13, 238.99 examples/s]
Map:  50%|████▉     | 3246/6548 [00:10<00:13, 248.10 examples/s]
Map:  50%|█████     | 3276/6548 [00:10<00:12, 256.43 examples/s]
Map:  51%|█████     | 3311/6548 [00:11<00:11, 277.72 examples/s]
Map:  51%|█████     | 3348/6548 [00:11<00:10, 297.69 examples/s]
Map:  52%|█████▏    | 3380/6548 [00:11<00:10, 290.80 examples/s]
Map:  52%|█████▏    | 3421/6548 [00:11<00:11, 267.72 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 261.28 examples/s]
Map:  53%|█████▎    | 3482/6548 [00:11<00:11, 264.48 examples/s]
Map:  54%|█████▍    | 3528/6548 [00:11<00:09, 311.97 examples/s]
Map:  55%|█████▍    | 3571/6548 [00:11<00:08, 339.56 examples/s]
Map:  55%|█████▌    | 3617/6548 [00:12<00:07, 370.61 examples/s]
Map:  56%|█████▌    | 3671/6548 [00:12<00:07, 364.32 examples/s]
Map:  57%|█████▋    | 3716/6548 [00:12<00:07, 384.77 examples/s]
Map:  58%|█████▊    | 3774/6548 [00:12<00:07, 376.08 examples/s]
Map:  58%|█████▊    | 3814/6548 [00:12<00:07, 380.05 examples/s]
Map:  59%|█████▉    | 3863/6548 [00:12<00:07, 346.07 examples/s]
Map:  60%|█████▉    | 3914/6548 [00:12<00:07, 332.61 examples/s]
Map:  60%|██████    | 3956/6548 [00:13<00:08, 314.45 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 234.07 examples/s]
Map:  62%|██████▏   | 4055/6548 [00:13<00:08, 289.78 examples/s]
Map:  63%|██████▎   | 4096/6548 [00:13<00:07, 313.05 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 325.53 examples/s]
Map:  64%|██████▍   | 4194/6548 [00:13<00:07, 327.39 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:06, 334.62 examples/s]
Map:  65%|██████▌   | 4282/6548 [00:14<00:06, 360.19 examples/s]
Map:  66%|██████▌   | 4324/6548 [00:14<00:06, 369.04 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:14<00:06, 338.57 examples/s]
Map:  68%|██████▊   | 4431/6548 [00:14<00:05, 353.92 examples/s]
Map:  68%|██████▊   | 4483/6548 [00:14<00:06, 329.19 examples/s]
Map:  69%|██████▉   | 4527/6548 [00:14<00:06, 310.71 examples/s]
Map:  70%|██████▉   | 4572/6548 [00:14<00:06, 327.78 examples/s]
Map:  70%|███████   | 4610/6548 [00:15<00:05, 329.49 examples/s]
Map:  71%|███████   | 4658/6548 [00:15<00:05, 364.66 examples/s]
Map:  72%|███████▏  | 4716/6548 [00:15<00:04, 368.75 examples/s]
Map:  73%|███████▎  | 4783/6548 [00:15<00:04, 390.70 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 394.58 examples/s]
Map:  75%|███████▍  | 4888/6548 [00:15<00:04, 387.42 examples/s]
Map:  75%|███████▌  | 4933/6548 [00:15<00:04, 381.31 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:03, 397.64 examples/s]
Map:  77%|███████▋  | 5040/6548 [00:16<00:06, 250.64 examples/s]
Map:  78%|███████▊  | 5082/6548 [00:16<00:05, 255.77 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 263.58 examples/s]
Map:  79%|███████▉  | 5171/6548 [00:16<00:04, 286.13 examples/s]
Map:  80%|███████▉  | 5211/6548 [00:16<00:04, 276.58 examples/s]
Map:  80%|████████  | 5253/6548 [00:17<00:04, 305.49 examples/s]
Map:  81%|████████  | 5292/6548 [00:17<00:03, 323.48 examples/s]
Map:  81%|████████▏ | 5330/6548 [00:17<00:03, 320.38 examples/s]
Map:  82%|████████▏ | 5388/6548 [00:17<00:03, 322.58 examples/s]
Map:  83%|████████▎ | 5422/6548 [00:17<00:03, 285.52 examples/s]
Map:  83%|████████▎ | 5461/6548 [00:17<00:03, 307.00 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 325.05 examples/s]
Map:  85%|████████▍ | 5542/6548 [00:17<00:02, 337.90 examples/s]
Map:  85%|████████▌ | 5582/6548 [00:18<00:03, 298.65 examples/s]
Map:  86%|████████▌ | 5631/6548 [00:18<00:02, 340.10 examples/s]
Map:  87%|████████▋ | 5678/6548 [00:18<00:02, 327.10 examples/s]
Map:  88%|████████▊ | 5734/6548 [00:18<00:02, 333.25 examples/s]
Map:  88%|████████▊ | 5769/6548 [00:18<00:02, 334.42 examples/s]
Map:  89%|████████▉ | 5825/6548 [00:18<00:02, 327.03 examples/s]
Map:  90%|████████▉ | 5861/6548 [00:18<00:02, 330.25 examples/s]
Map:  90%|█████████ | 5901/6548 [00:19<00:01, 342.82 examples/s]
Map:  91%|█████████ | 5939/6548 [00:19<00:01, 340.03 examples/s]
Map:  91%|█████████▏| 5988/6548 [00:19<00:01, 330.60 examples/s]
Map:  92%|█████████▏| 6025/6548 [00:19<00:02, 225.45 examples/s]
Map:  93%|█████████▎| 6072/6548 [00:19<00:01, 244.83 examples/s]
Map:  93%|█████████▎| 6111/6548 [00:19<00:01, 246.45 examples/s]
Map:  94%|█████████▍| 6147/6548 [00:20<00:01, 264.75 examples/s]
Map:  94%|█████████▍| 6181/6548 [00:20<00:01, 279.57 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:20<00:01, 300.88 examples/s]
Map:  96%|█████████▌| 6261/6548 [00:20<00:00, 315.88 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 333.59 examples/s]
Map:  97%|█████████▋| 6340/6548 [00:20<00:00, 342.11 examples/s]
Map:  98%|█████████▊| 6386/6548 [00:20<00:00, 364.82 examples/s]
Map:  98%|█████████▊| 6427/6548 [00:20<00:00, 376.10 examples/s]
Map:  99%|█████████▉| 6472/6548 [00:20<00:00, 393.29 examples/s]
Map: 100%|█████████▉| 6529/6548 [00:21<00:00, 378.46 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 308.39 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 323.56 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 345.64 examples/s]
Map:  13%|█▎        | 116/903 [00:00<00:02, 342.28 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 355.00 examples/s]
Map:  23%|██▎       | 208/903 [00:00<00:01, 402.83 examples/s]
Map:  29%|██▉       | 263/903 [00:00<00:01, 377.27 examples/s]
Map:  33%|███▎      | 302/903 [00:00<00:01, 374.18 examples/s]
Map:  39%|███▉      | 355/903 [00:00<00:01, 363.17 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 311.29 examples/s]
Map:  51%|█████     | 460/903 [00:01<00:01, 310.90 examples/s]
Map:  56%|█████▋    | 508/903 [00:01<00:01, 308.65 examples/s]
Map:  62%|██████▏   | 558/903 [00:01<00:01, 341.83 examples/s]
Map:  67%|██████▋   | 602/903 [00:01<00:00, 362.93 examples/s]
Map:  72%|███████▏  | 654/903 [00:01<00:00, 355.90 examples/s]
Map:  77%|███████▋  | 693/903 [00:01<00:00, 362.52 examples/s]
Map:  82%|████████▏ | 736/903 [00:02<00:00, 374.69 examples/s]
Map:  86%|████████▌ | 778/903 [00:02<00:00, 376.95 examples/s]
Map:  91%|█████████ | 821/903 [00:02<00:00, 389.08 examples/s]
Map:  95%|█████████▌| 862/903 [00:02<00:00, 370.24 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 217.48 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 321.89 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 296.20 examples/s]
Map:   4%|▍         | 81/1882 [00:00<00:04, 363.15 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 349.41 examples/s]
Map:   9%|▉         | 172/1882 [00:00<00:04, 346.65 examples/s]
Map:  12%|█▏        | 228/1882 [00:00<00:04, 353.59 examples/s]
Map:  14%|█▍        | 270/1882 [00:00<00:04, 369.39 examples/s]
Map:  18%|█▊        | 331/1882 [00:00<00:04, 367.61 examples/s]
Map:  20%|█▉        | 376/1882 [00:01<00:04, 306.91 examples/s]
Map:  22%|██▏       | 411/1882 [00:01<00:05, 282.62 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 290.60 examples/s]
Map:  26%|██▌       | 489/1882 [00:01<00:04, 313.66 examples/s]
Map:  28%|██▊       | 526/1882 [00:01<00:04, 311.50 examples/s]
Map:  30%|███       | 566/1882 [00:01<00:03, 333.09 examples/s]
Map:  32%|███▏      | 611/1882 [00:01<00:03, 358.21 examples/s]
Map:  35%|███▍      | 657/1882 [00:01<00:03, 379.96 examples/s]
Map:  37%|███▋      | 703/1882 [00:02<00:02, 396.55 examples/s]
Map:  41%|████      | 766/1882 [00:02<00:02, 399.13 examples/s]
Map:  43%|████▎     | 809/1882 [00:02<00:03, 354.02 examples/s]
Map:  45%|████▌     | 850/1882 [00:02<00:02, 366.39 examples/s]
Map:  47%|████▋     | 893/1882 [00:02<00:02, 377.95 examples/s]
Map:  51%|█████     | 961/1882 [00:02<00:02, 399.08 examples/s]
Map:  54%|█████▍    | 1017/1882 [00:03<00:03, 258.56 examples/s]
Map:  56%|█████▌    | 1054/1882 [00:03<00:03, 275.68 examples/s]
Map:  58%|█████▊    | 1091/1882 [00:03<00:02, 292.08 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 298.34 examples/s]
Map:  62%|██████▏   | 1176/1882 [00:03<00:02, 310.96 examples/s]
Map:  65%|██████▍   | 1214/1882 [00:03<00:02, 289.97 examples/s]
Map:  66%|██████▋   | 1250/1882 [00:03<00:02, 304.99 examples/s]
Map:  69%|██████▉   | 1307/1882 [00:03<00:01, 319.52 examples/s]
Map:  72%|███████▏  | 1347/1882 [00:04<00:01, 335.48 examples/s]
Map:  74%|███████▍  | 1396/1882 [00:04<00:01, 329.37 examples/s]
Map:  76%|███████▌  | 1430/1882 [00:04<00:01, 286.76 examples/s]
Map:  78%|███████▊  | 1471/1882 [00:04<00:01, 313.76 examples/s]
Map:  80%|████████  | 1512/1882 [00:04<00:01, 267.66 examples/s]
Map:  82%|████████▏ | 1544/1882 [00:04<00:01, 277.86 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:04<00:00, 302.84 examples/s]
Map:  86%|████████▋ | 1626/1882 [00:05<00:00, 333.60 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 332.89 examples/s]
Map:  90%|█████████ | 1698/1882 [00:05<00:00, 335.21 examples/s]
Map:  92%|█████████▏| 1734/1882 [00:05<00:00, 288.86 examples/s]
Map:  94%|█████████▍| 1772/1882 [00:05<00:00, 297.15 examples/s]
Map:  96%|█████████▌| 1807/1882 [00:05<00:00, 305.98 examples/s]
Map:  98%|█████████▊| 1852/1882 [00:05<00:00, 342.20 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 313.18 examples/s]
10/12/2024 14:07:39 - INFO - __main__ -     ***** Testing *****
10/12/2024 14:07:39 - INFO - __main__ -     Batch size = 8
10/12/2024 14:07:39 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 14:07:40 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 14:07:40 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 14:07:41 - INFO - knnlm -   Reading datastore took 0.9636919498443604 s
10/12/2024 14:07:42 - INFO - knnlm -   Moving index to GPU took 0.9962131977081299 s
10/12/2024 14:07:42 - INFO - __main__ -   ******************************break-into
10/12/2024 14:07:42 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 14:07:42 - INFO - __main__ -     Num examples = 236
10/12/2024 14:07:42 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<31:49,  8.13s/it]
test ppl:   1%|          | 2/236 [00:10<17:56,  4.60s/it]
test ppl:   1%|▏         | 3/236 [00:16<20:33,  5.29s/it]
test ppl:   2%|▏         | 4/236 [00:18<15:29,  4.01s/it]
test ppl:   2%|▏         | 5/236 [00:24<18:16,  4.75s/it]
test ppl:   3%|▎         | 6/236 [00:30<19:52,  5.18s/it]
test ppl:   3%|▎         | 7/236 [00:32<15:42,  4.11s/it]
test ppl:   3%|▎         | 8/236 [00:37<17:15,  4.54s/it]
test ppl:   4%|▍         | 9/236 [00:39<14:13,  3.76s/it]
test ppl:   4%|▍         | 10/236 [00:44<15:01,  3.99s/it]
test ppl:   5%|▍         | 11/236 [00:48<15:04,  4.02s/it]
test ppl:   5%|▌         | 12/236 [00:54<17:15,  4.62s/it]
test ppl:   6%|▌         | 13/236 [01:00<18:44,  5.04s/it]
test ppl:   6%|▌         | 14/236 [01:06<19:46,  5.35s/it]
test ppl:   6%|▋         | 15/236 [01:07<15:14,  4.14s/it]
test ppl:   7%|▋         | 16/236 [01:09<12:35,  3.44s/it]
test ppl:   7%|▋         | 17/236 [01:15<15:23,  4.22s/it]
test ppl:   8%|▊         | 18/236 [01:18<13:26,  3.70s/it]
test ppl:   8%|▊         | 19/236 [01:23<15:19,  4.24s/it]
test ppl:   8%|▊         | 20/236 [01:26<13:30,  3.75s/it]
test ppl:   9%|▉         | 21/236 [01:29<12:51,  3.59s/it]
test ppl:   9%|▉         | 22/236 [01:35<15:30,  4.35s/it]
test ppl:  10%|▉         | 23/236 [01:38<13:40,  3.85s/it]
test ppl:  10%|█         | 24/236 [01:40<11:59,  3.39s/it]
test ppl:  11%|█         | 25/236 [01:46<14:50,  4.22s/it]
test ppl:  11%|█         | 26/236 [01:53<16:49,  4.81s/it]
test ppl:  11%|█▏        | 27/236 [01:57<15:54,  4.56s/it]
test ppl:  12%|█▏        | 28/236 [01:58<12:52,  3.71s/it]
test ppl:  12%|█▏        | 29/236 [02:01<11:23,  3.30s/it]
test ppl:  13%|█▎        | 30/236 [02:02<09:32,  2.78s/it]
test ppl:  13%|█▎        | 31/236 [02:04<08:42,  2.55s/it]
test ppl:  14%|█▎        | 32/236 [02:10<12:08,  3.57s/it]
test ppl:  14%|█▍        | 33/236 [02:13<10:58,  3.25s/it]
test ppl:  14%|█▍        | 34/236 [02:17<11:47,  3.50s/it]
test ppl:  15%|█▍        | 35/236 [02:19<10:46,  3.22s/it]
test ppl:  15%|█▌        | 36/236 [02:25<13:27,  4.04s/it]
test ppl:  16%|█▌        | 37/236 [02:31<15:18,  4.61s/it]
test ppl:  16%|█▌        | 38/236 [02:33<12:43,  3.86s/it]
test ppl:  17%|█▋        | 39/236 [02:35<10:36,  3.23s/it]
test ppl:  17%|█▋        | 40/236 [02:36<08:41,  2.66s/it]
test ppl:  17%|█▋        | 41/236 [02:38<07:53,  2.43s/it]
test ppl:  18%|█▊        | 42/236 [02:44<11:18,  3.50s/it]
test ppl:  18%|█▊        | 43/236 [02:50<13:36,  4.23s/it]
test ppl:  19%|█▊        | 44/236 [02:53<11:44,  3.67s/it]
test ppl:  19%|█▉        | 45/236 [02:54<10:02,  3.16s/it]
test ppl:  19%|█▉        | 46/236 [03:00<12:41,  4.01s/it]
test ppl:  20%|█▉        | 47/236 [03:02<10:18,  3.27s/it]
test ppl:  20%|██        | 48/236 [03:08<12:44,  4.07s/it]
test ppl:  21%|██        | 49/236 [03:11<11:25,  3.67s/it]
test ppl:  21%|██        | 50/236 [03:17<13:33,  4.38s/it]
test ppl:  22%|██▏       | 51/236 [03:23<14:55,  4.84s/it]
test ppl:  22%|██▏       | 52/236 [03:29<15:52,  5.18s/it]
test ppl:  22%|██▏       | 53/236 [03:35<16:29,  5.41s/it]
test ppl:  23%|██▎       | 54/236 [03:36<12:54,  4.25s/it]
test ppl:  23%|██▎       | 55/236 [03:42<14:10,  4.70s/it]
test ppl:  24%|██▎       | 56/236 [03:48<15:14,  5.08s/it]
test ppl:  24%|██▍       | 57/236 [03:50<12:42,  4.26s/it]
test ppl:  25%|██▍       | 58/236 [03:52<10:54,  3.68s/it]
test ppl:  25%|██▌       | 59/236 [03:58<12:52,  4.36s/it]
test ppl:  25%|██▌       | 60/236 [04:02<11:56,  4.07s/it]
test ppl:  26%|██▌       | 61/236 [04:08<13:30,  4.63s/it]
test ppl:  26%|██▋       | 62/236 [04:12<12:59,  4.48s/it]
test ppl:  27%|██▋       | 63/236 [04:14<11:12,  3.89s/it]
test ppl:  27%|██▋       | 64/236 [04:16<09:08,  3.19s/it]
test ppl:  28%|██▊       | 65/236 [04:17<07:30,  2.64s/it]
test ppl:  28%|██▊       | 66/236 [04:20<07:49,  2.76s/it]
test ppl:  28%|██▊       | 67/236 [04:26<10:29,  3.72s/it]
test ppl:  29%|██▉       | 68/236 [04:32<12:18,  4.39s/it]
test ppl:  29%|██▉       | 69/236 [04:38<13:31,  4.86s/it]
test ppl:  30%|██▉       | 70/236 [04:40<10:29,  3.80s/it]
test ppl:  30%|███       | 71/236 [04:43<10:28,  3.81s/it]
test ppl:  31%|███       | 72/236 [04:46<09:02,  3.31s/it]
test ppl:  31%|███       | 73/236 [04:51<11:08,  4.10s/it]
test ppl:  31%|███▏      | 74/236 [04:53<08:59,  3.33s/it]
test ppl:  32%|███▏      | 75/236 [04:59<11:02,  4.11s/it]
test ppl:  32%|███▏      | 76/236 [05:05<12:25,  4.66s/it]
test ppl:  33%|███▎      | 77/236 [05:07<10:29,  3.96s/it]
test ppl:  33%|███▎      | 78/236 [05:09<08:42,  3.31s/it]
test ppl:  33%|███▎      | 79/236 [05:13<09:04,  3.47s/it]
test ppl:  34%|███▍      | 80/236 [05:15<08:04,  3.11s/it]
test ppl:  34%|███▍      | 81/236 [05:21<10:12,  3.95s/it]
test ppl:  35%|███▍      | 82/236 [05:27<11:41,  4.55s/it]
test ppl:  35%|███▌      | 83/236 [05:30<10:04,  3.95s/it]
test ppl:  36%|███▌      | 84/236 [05:32<08:51,  3.49s/it]
test ppl:  36%|███▌      | 85/236 [05:36<09:20,  3.71s/it]
test ppl:  36%|███▋      | 86/236 [05:38<07:29,  3.00s/it]
test ppl:  37%|███▋      | 87/236 [05:40<06:46,  2.73s/it]
test ppl:  37%|███▋      | 88/236 [05:46<09:06,  3.69s/it]
test ppl:  38%|███▊      | 89/236 [05:48<07:48,  3.19s/it]
test ppl:  38%|███▊      | 90/236 [05:54<09:45,  4.01s/it]
test ppl:  39%|███▊      | 91/236 [05:58<10:23,  4.30s/it]
test ppl:  39%|███▉      | 92/236 [06:01<09:15,  3.86s/it]
test ppl:  39%|███▉      | 93/236 [06:07<10:40,  4.48s/it]
test ppl:  40%|███▉      | 94/236 [06:13<11:33,  4.88s/it]
test ppl:  40%|████      | 95/236 [06:16<09:54,  4.21s/it]
test ppl:  41%|████      | 96/236 [06:20<09:37,  4.13s/it]
test ppl:  41%|████      | 97/236 [06:26<10:49,  4.67s/it]
test ppl:  42%|████▏     | 98/236 [06:32<11:37,  5.06s/it]
test ppl:  42%|████▏     | 99/236 [06:37<12:09,  5.32s/it]
test ppl:  42%|████▏     | 100/236 [06:38<09:07,  4.03s/it]
test ppl:  43%|████▎     | 101/236 [06:44<10:21,  4.60s/it]
test ppl:  43%|████▎     | 102/236 [06:48<09:43,  4.36s/it]
test ppl:  44%|████▎     | 103/236 [06:50<07:43,  3.48s/it]
test ppl:  44%|████▍     | 104/236 [06:54<08:09,  3.71s/it]
test ppl:  44%|████▍     | 105/236 [06:58<08:34,  3.93s/it]
test ppl:  45%|████▍     | 106/236 [07:04<09:30,  4.39s/it]
test ppl:  45%|████▌     | 107/236 [07:06<08:01,  3.74s/it]
test ppl:  46%|████▌     | 108/236 [07:12<09:17,  4.36s/it]
test ppl:  46%|████▌     | 109/236 [07:17<09:50,  4.65s/it]
test ppl:  47%|████▋     | 110/236 [07:19<07:50,  3.74s/it]
test ppl:  47%|████▋     | 111/236 [07:22<07:38,  3.67s/it]
test ppl:  47%|████▋     | 112/236 [07:28<08:59,  4.35s/it]
test ppl:  48%|████▊     | 113/236 [07:30<07:20,  3.58s/it]
test ppl:  48%|████▊     | 114/236 [07:35<07:58,  3.92s/it]
test ppl:  49%|████▊     | 115/236 [07:41<09:08,  4.53s/it]
test ppl:  49%|████▉     | 116/236 [07:47<09:55,  4.96s/it]
test ppl:  50%|████▉     | 117/236 [07:49<08:00,  4.04s/it]
test ppl:  50%|█████     | 118/236 [07:54<08:39,  4.40s/it]
test ppl:  50%|█████     | 119/236 [07:56<07:16,  3.73s/it]
test ppl:  51%|█████     | 120/236 [07:57<05:53,  3.05s/it]
test ppl:  51%|█████▏    | 121/236 [08:00<05:36,  2.93s/it]
test ppl:  52%|█████▏    | 122/236 [08:06<07:16,  3.83s/it]
test ppl:  52%|█████▏    | 123/236 [08:08<06:16,  3.33s/it]
test ppl:  53%|█████▎    | 124/236 [08:11<05:46,  3.09s/it]
test ppl:  53%|█████▎    | 125/236 [08:17<07:18,  3.95s/it]
test ppl:  53%|█████▎    | 126/236 [08:21<07:43,  4.22s/it]
test ppl:  54%|█████▍    | 127/236 [08:24<06:31,  3.59s/it]
test ppl:  54%|█████▍    | 128/236 [08:25<05:33,  3.09s/it]
test ppl:  55%|█████▍    | 129/236 [08:29<05:46,  3.24s/it]
test ppl:  55%|█████▌    | 130/236 [08:32<05:39,  3.20s/it]
test ppl:  56%|█████▌    | 131/236 [08:38<07:02,  4.02s/it]
test ppl:  56%|█████▌    | 132/236 [08:43<07:22,  4.26s/it]
test ppl:  56%|█████▋    | 133/236 [08:47<07:08,  4.16s/it]
test ppl:  57%|█████▋    | 134/236 [08:50<06:42,  3.94s/it]
test ppl:  57%|█████▋    | 135/236 [08:56<07:39,  4.55s/it]
test ppl:  58%|█████▊    | 136/236 [08:58<05:58,  3.59s/it]
test ppl:  58%|█████▊    | 137/236 [09:04<07:05,  4.30s/it]
test ppl:  58%|█████▊    | 138/236 [09:07<06:38,  4.07s/it]
test ppl:  59%|█████▉    | 139/236 [09:09<05:28,  3.39s/it]
test ppl:  59%|█████▉    | 140/236 [09:11<04:36,  2.88s/it]
test ppl:  60%|█████▉    | 141/236 [09:17<06:01,  3.80s/it]
test ppl:  60%|██████    | 142/236 [09:19<05:10,  3.31s/it]
test ppl:  61%|██████    | 143/236 [09:25<06:21,  4.10s/it]
test ppl:  61%|██████    | 144/236 [09:28<05:55,  3.86s/it]
test ppl:  61%|██████▏   | 145/236 [09:34<06:49,  4.50s/it]
test ppl:  62%|██████▏   | 146/236 [09:39<07:02,  4.70s/it]
test ppl:  62%|██████▏   | 147/236 [09:45<07:32,  5.08s/it]
test ppl:  63%|██████▎   | 148/236 [09:51<07:53,  5.38s/it]
test ppl:  63%|██████▎   | 149/236 [09:57<08:03,  5.56s/it]
test ppl:  64%|██████▎   | 150/236 [10:03<08:08,  5.68s/it]
test ppl:  64%|██████▍   | 151/236 [10:09<08:09,  5.76s/it]
test ppl:  64%|██████▍   | 152/236 [10:15<08:07,  5.81s/it]
test ppl:  65%|██████▍   | 153/236 [10:21<07:57,  5.75s/it]
test ppl:  65%|██████▌   | 154/236 [10:22<06:06,  4.47s/it]
test ppl:  66%|██████▌   | 155/236 [10:26<05:57,  4.42s/it]
test ppl:  66%|██████▌   | 156/236 [10:30<05:31,  4.15s/it]
test ppl:  67%|██████▋   | 157/236 [10:32<04:42,  3.57s/it]
test ppl:  67%|██████▋   | 158/236 [10:38<05:34,  4.29s/it]
test ppl:  67%|██████▋   | 159/236 [10:44<06:08,  4.79s/it]
test ppl:  68%|██████▊   | 160/236 [10:45<04:41,  3.71s/it]
test ppl:  68%|██████▊   | 161/236 [10:47<03:44,  3.00s/it]
test ppl:  69%|██████▊   | 162/236 [10:50<03:45,  3.05s/it]
test ppl:  69%|██████▉   | 163/236 [10:52<03:28,  2.86s/it]
test ppl:  69%|██████▉   | 164/236 [10:55<03:27,  2.88s/it]
test ppl:  70%|██████▉   | 165/236 [10:59<03:51,  3.26s/it]
test ppl:  70%|███████   | 166/236 [11:01<03:10,  2.72s/it]
test ppl:  71%|███████   | 167/236 [11:03<02:51,  2.49s/it]
test ppl:  71%|███████   | 168/236 [11:04<02:31,  2.23s/it]
test ppl:  72%|███████▏  | 169/236 [11:09<03:20,  3.00s/it]
test ppl:  72%|███████▏  | 170/236 [11:15<04:17,  3.90s/it]
test ppl:  72%|███████▏  | 171/236 [11:17<03:28,  3.21s/it]
test ppl:  73%|███████▎  | 172/236 [11:23<04:18,  4.04s/it]
test ppl:  73%|███████▎  | 173/236 [11:26<04:00,  3.82s/it]
test ppl:  74%|███████▎  | 174/236 [11:32<04:37,  4.47s/it]
test ppl:  74%|███████▍  | 175/236 [11:34<03:46,  3.71s/it]
test ppl:  75%|███████▍  | 176/236 [11:40<04:23,  4.38s/it]
test ppl:  75%|███████▌  | 177/236 [11:46<04:47,  4.87s/it]
test ppl:  75%|███████▌  | 178/236 [11:52<05:02,  5.21s/it]
test ppl:  76%|███████▌  | 179/236 [11:58<05:10,  5.44s/it]
test ppl:  76%|███████▋  | 180/236 [12:04<05:09,  5.53s/it]
test ppl:  77%|███████▋  | 181/236 [12:09<05:11,  5.66s/it]
test ppl:  77%|███████▋  | 182/236 [12:11<04:04,  4.54s/it]
test ppl:  78%|███████▊  | 183/236 [12:13<03:13,  3.66s/it]
test ppl:  78%|███████▊  | 184/236 [12:15<02:39,  3.06s/it]
test ppl:  78%|███████▊  | 185/236 [12:21<03:21,  3.95s/it]
test ppl:  79%|███████▉  | 186/236 [12:23<02:47,  3.35s/it]
test ppl:  79%|███████▉  | 187/236 [12:24<02:19,  2.85s/it]
test ppl:  80%|███████▉  | 188/236 [12:30<03:02,  3.79s/it]
test ppl:  80%|████████  | 189/236 [12:36<03:29,  4.45s/it]
test ppl:  81%|████████  | 190/236 [12:41<03:22,  4.40s/it]
test ppl:  81%|████████  | 191/236 [12:44<03:10,  4.23s/it]
test ppl:  81%|████████▏ | 192/236 [12:47<02:45,  3.76s/it]
test ppl:  82%|████████▏ | 193/236 [12:49<02:15,  3.15s/it]
test ppl:  82%|████████▏ | 194/236 [12:51<02:05,  3.00s/it]
test ppl:  83%|████████▎ | 195/236 [12:54<01:57,  2.87s/it]
test ppl:  83%|████████▎ | 196/236 [12:56<01:45,  2.63s/it]
test ppl:  83%|████████▎ | 197/236 [13:02<02:21,  3.62s/it]
test ppl:  84%|████████▍ | 198/236 [13:08<02:44,  4.32s/it]
test ppl:  84%|████████▍ | 199/236 [13:11<02:23,  3.88s/it]
test ppl:  85%|████████▍ | 200/236 [13:17<02:41,  4.50s/it]
test ppl:  85%|████████▌ | 201/236 [13:19<02:17,  3.94s/it]
test ppl:  86%|████████▌ | 202/236 [13:25<02:34,  4.54s/it]
test ppl:  86%|████████▌ | 203/236 [13:31<02:41,  4.91s/it]
test ppl:  86%|████████▋ | 204/236 [13:33<02:06,  3.96s/it]
test ppl:  87%|████████▋ | 205/236 [13:39<02:21,  4.58s/it]
test ppl:  87%|████████▋ | 206/236 [13:42<02:06,  4.23s/it]
test ppl:  88%|████████▊ | 207/236 [13:48<02:17,  4.75s/it]
test ppl:  88%|████████▊ | 208/236 [13:51<01:58,  4.22s/it]
test ppl:  89%|████████▊ | 209/236 [13:57<02:08,  4.76s/it]
test ppl:  89%|████████▉ | 210/236 [14:00<01:45,  4.05s/it]
test ppl:  89%|████████▉ | 211/236 [14:05<01:48,  4.36s/it]
test ppl:  90%|████████▉ | 212/236 [14:11<01:55,  4.83s/it]
test ppl:  90%|█████████ | 213/236 [14:17<01:58,  5.16s/it]
test ppl:  91%|█████████ | 214/236 [14:18<01:28,  4.02s/it]
test ppl:  91%|█████████ | 215/236 [14:24<01:36,  4.61s/it]
test ppl:  92%|█████████▏| 216/236 [14:26<01:18,  3.94s/it]
test ppl:  92%|█████████▏| 217/236 [14:32<01:26,  4.57s/it]
test ppl:  92%|█████████▏| 218/236 [14:34<01:08,  3.78s/it]
test ppl:  93%|█████████▎| 219/236 [14:40<01:15,  4.44s/it]
test ppl:  93%|█████████▎| 220/236 [14:46<01:18,  4.90s/it]
test ppl:  94%|█████████▎| 221/236 [14:48<00:59,  3.95s/it]
test ppl:  94%|█████████▍| 222/236 [14:54<01:03,  4.56s/it]
test ppl:  94%|█████████▍| 223/236 [15:00<01:04,  4.98s/it]
test ppl:  95%|█████████▍| 224/236 [15:06<01:03,  5.27s/it]
test ppl:  95%|█████████▌| 225/236 [15:10<00:54,  4.97s/it]
test ppl:  96%|█████████▌| 226/236 [15:13<00:43,  4.31s/it]
test ppl:  96%|█████████▌| 227/236 [15:16<00:34,  3.86s/it]
test ppl:  97%|█████████▋| 228/236 [15:17<00:25,  3.21s/it]
test ppl:  97%|█████████▋| 229/236 [15:23<00:28,  4.02s/it]
test ppl:  97%|█████████▋| 230/236 [15:27<00:22,  3.81s/it]
test ppl:  98%|█████████▊| 231/236 [15:30<00:18,  3.71s/it]
test ppl:  98%|█████████▊| 232/236 [15:32<00:12,  3.17s/it]
test ppl:  99%|█████████▊| 233/236 [15:35<00:09,  3.09s/it]
test ppl:  99%|█████████▉| 234/236 [15:36<00:05,  2.53s/it]
test ppl: 100%|█████████▉| 235/236 [15:42<00:03,  3.56s/it]
test ppl: 100%|██████████| 236/236 [15:43<00:00,  2.69s/it]
test ppl: 100%|██████████| 236/236 [15:43<00:00,  4.00s/it]
10/12/2024 14:23:25 - INFO - __main__ -    em: 0.1955
10/12/2024 14:23:25 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.6 40:  em: 0.1955

--------------------------------------------------------------------------------
Running experiment with knn_temp=40, lmbda=0.6, k=64
2024-10-12 14:23:32.922864: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 14:23:32.942419: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 14:23:32.964386: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 14:23:32.971069: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 14:23:32.986953: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 14:23:33.978586: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 14:23:35 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.6, knn_temp=40, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 14:23:35 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:40:20,  2.20it/s]
Adding feature api:   4%|▍         | 7334/187062 [00:00<00:10, 17506.82it/s]
Adding feature api:   8%|▊         | 15659/187062 [00:00<00:05, 34224.55it/s]
Adding feature api:  13%|█▎        | 24067/187062 [00:00<00:03, 47509.04it/s]
Adding feature api:  17%|█▋        | 32526/187062 [00:00<00:02, 57732.15it/s]
Adding feature api:  22%|██▏       | 40970/187062 [00:00<00:02, 65276.90it/s]
Adding feature api:  26%|██▋       | 49343/187062 [00:01<00:01, 70580.69it/s]
Adding feature api:  31%|███       | 57812/187062 [00:01<00:01, 74688.34it/s]
Adding feature api:  35%|███▌      | 66287/187062 [00:01<00:01, 77642.75it/s]
Adding feature api:  40%|███▉      | 74781/187062 [00:01<00:01, 79798.34it/s]
Adding feature api:  44%|████▍     | 83210/187062 [00:01<00:01, 81131.29it/s]
Adding feature api:  49%|████▉     | 91669/187062 [00:01<00:01, 82160.14it/s]
Adding feature api:  53%|█████▎    | 100061/187062 [00:01<00:01, 82055.44it/s]
Adding feature api:  58%|█████▊    | 108551/187062 [00:01<00:00, 82900.35it/s]
Adding feature api:  63%|██████▎   | 117006/187062 [00:01<00:00, 83389.63it/s]
Adding feature api:  67%|██████▋   | 125474/187062 [00:01<00:00, 83772.01it/s]
Adding feature api:  72%|███████▏  | 133919/187062 [00:02<00:00, 83972.05it/s]
Adding feature api:  76%|███████▌  | 142431/187062 [00:02<00:00, 84311.73it/s]
Adding feature api:  81%|████████  | 150924/187062 [00:02<00:00, 84494.83it/s]
Adding feature api:  85%|████████▌ | 159389/187062 [00:02<00:00, 84507.06it/s]
Adding feature api:  90%|████████▉ | 167885/187062 [00:02<00:00, 84642.27it/s]
Adding feature api:  94%|█████████▍| 176357/187062 [00:02<00:00, 84518.39it/s]
Adding feature api:  99%|█████████▉| 184815/187062 [00:02<00:00, 56011.36it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64493.08it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:47:20,  2.18it/s]
Adding feature datatype:   4%|▍         | 7197/187062 [00:00<00:10, 17115.03it/s]
Adding feature datatype:   8%|▊         | 15340/187062 [00:00<00:05, 33423.40it/s]
Adding feature datatype:  13%|█▎        | 23502/187062 [00:00<00:03, 46238.65it/s]
Adding feature datatype:  17%|█▋        | 31718/187062 [00:00<00:02, 56125.82it/s]
Adding feature datatype:  21%|██▏       | 39945/187062 [00:00<00:02, 63503.44it/s]
Adding feature datatype:  26%|██▌       | 48164/187062 [00:01<00:02, 68871.43it/s]
Adding feature datatype:  30%|███       | 56358/187062 [00:01<00:01, 72674.03it/s]
Adding feature datatype:  35%|███▍      | 64587/187062 [00:01<00:01, 75493.67it/s]
Adding feature datatype:  39%|███▉      | 72819/187062 [00:01<00:01, 77509.39it/s]
Adding feature datatype:  43%|████▎     | 81021/187062 [00:01<00:01, 78839.90it/s]
Adding feature datatype:  48%|████▊     | 89236/187062 [00:01<00:01, 79822.66it/s]
Adding feature datatype:  52%|█████▏    | 97391/187062 [00:01<00:01, 80313.48it/s]
Adding feature datatype:  56%|█████▋    | 105578/187062 [00:01<00:01, 80776.62it/s]
Adding feature datatype:  61%|██████    | 113779/187062 [00:01<00:00, 81143.62it/s]
Adding feature datatype:  65%|██████▌   | 121979/187062 [00:01<00:00, 81397.21it/s]
Adding feature datatype:  70%|██████▉   | 130161/187062 [00:02<00:00, 81512.89it/s]
Adding feature datatype:  74%|███████▍  | 138382/187062 [00:02<00:00, 81720.19it/s]
Adding feature datatype:  78%|███████▊  | 146638/187062 [00:02<00:00, 81970.62it/s]
Adding feature datatype:  83%|████████▎ | 154861/187062 [00:02<00:00, 82047.71it/s]
Adding feature datatype:  87%|████████▋ | 163076/187062 [00:02<00:00, 82026.80it/s]
Adding feature datatype:  92%|█████████▏| 171292/187062 [00:02<00:00, 82064.94it/s]
Adding feature datatype:  96%|█████████▌| 179504/187062 [00:02<00:00, 72423.09it/s]
Adding feature datatype: 100%|█████████▉| 186957/187062 [00:02<00:00, 51531.30it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63226.21it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:44:20,  2.19it/s]
Adding feature literal:   4%|▎         | 6992/187062 [00:00<00:10, 16654.42it/s]
Adding feature literal:   8%|▊         | 15021/187062 [00:00<00:05, 32810.01it/s]
Adding feature literal:  12%|█▏        | 23243/187062 [00:00<00:03, 45960.31it/s]
Adding feature literal:  17%|█▋        | 31399/187062 [00:00<00:02, 55766.92it/s]
Adding feature literal:  21%|██        | 39551/187062 [00:00<00:02, 63037.59it/s]
Adding feature literal:  26%|██▌       | 47723/187062 [00:01<00:02, 68406.45it/s]
Adding feature literal:  30%|██▉       | 55869/187062 [00:01<00:01, 72204.78it/s]
Adding feature literal:  34%|███▍      | 63824/187062 [00:01<00:01, 74361.34it/s]
Adding feature literal:  39%|███▊      | 72045/187062 [00:01<00:01, 76678.09it/s]
Adding feature literal:  43%|████▎     | 80054/187062 [00:01<00:01, 77293.78it/s]
Adding feature literal:  47%|████▋     | 88022/187062 [00:01<00:01, 75706.66it/s]
Adding feature literal:  51%|█████     | 95765/187062 [00:01<00:01, 74651.84it/s]
Adding feature literal:  55%|█████▌    | 103352/187062 [00:01<00:01, 73977.04it/s]
Adding feature literal:  60%|█████▉    | 111558/187062 [00:01<00:00, 76319.07it/s]
Adding feature literal:  64%|██████▍   | 119781/187062 [00:01<00:00, 78048.40it/s]
Adding feature literal:  68%|██████▊   | 127962/187062 [00:02<00:00, 79155.69it/s]
Adding feature literal:  73%|███████▎  | 136129/187062 [00:02<00:00, 79899.60it/s]
Adding feature literal:  77%|███████▋  | 144298/187062 [00:02<00:00, 80430.95it/s]
Adding feature literal:  82%|████████▏ | 152509/187062 [00:02<00:00, 80929.78it/s]
Adding feature literal:  86%|████████▌ | 160617/187062 [00:02<00:00, 80531.84it/s]
Adding feature literal:  90%|█████████ | 168829/187062 [00:02<00:00, 81001.83it/s]
Adding feature literal:  95%|█████████▍| 176955/187062 [00:02<00:00, 81075.93it/s]
Adding feature literal:  99%|█████████▉| 185068/187062 [00:02<00:00, 54077.23it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 62119.17it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:36:43,  2.20it/s]
Adding feature operator:   4%|▍         | 7118/187062 [00:00<00:10, 17024.12it/s]
Adding feature operator:   8%|▊         | 15281/187062 [00:00<00:05, 33476.94it/s]
Adding feature operator:  13%|█▎        | 23439/187062 [00:00<00:03, 46308.00it/s]
Adding feature operator:  17%|█▋        | 31602/187062 [00:00<00:02, 56053.35it/s]
Adding feature operator:  21%|██        | 39584/187062 [00:00<00:02, 62771.78it/s]
Adding feature operator:  26%|██▌       | 47795/187062 [00:01<00:02, 68332.78it/s]
Adding feature operator:  30%|██▉       | 55993/187062 [00:01<00:01, 72305.34it/s]
Adding feature operator:  34%|███▍      | 64203/187062 [00:01<00:01, 75181.21it/s]
Adding feature operator:  39%|███▊      | 72421/187062 [00:01<00:01, 77247.47it/s]
Adding feature operator:  43%|████▎     | 80627/187062 [00:01<00:01, 78675.87it/s]
Adding feature operator:  47%|████▋     | 88829/187062 [00:01<00:01, 79669.21it/s]
Adding feature operator:  52%|█████▏    | 97000/187062 [00:01<00:01, 80277.11it/s]
Adding feature operator:  56%|█████▌    | 105195/187062 [00:01<00:01, 80774.22it/s]
Adding feature operator:  61%|██████    | 113486/187062 [00:01<00:00, 81412.61it/s]
Adding feature operator:  65%|██████▌   | 121693/187062 [00:01<00:00, 81606.47it/s]
Adding feature operator:  69%|██████▉   | 129895/187062 [00:02<00:00, 81538.65it/s]
Adding feature operator:  74%|███████▍  | 138128/187062 [00:02<00:00, 81773.72it/s]
Adding feature operator:  78%|███████▊  | 146326/187062 [00:02<00:00, 81234.07it/s]
Adding feature operator:  83%|████████▎ | 154534/187062 [00:02<00:00, 81484.04it/s]
Adding feature operator:  87%|████████▋ | 162782/187062 [00:02<00:00, 81780.17it/s]
Adding feature operator:  91%|█████████▏| 171031/187062 [00:02<00:00, 81990.48it/s]
Adding feature operator:  96%|█████████▌| 179236/187062 [00:02<00:00, 74204.89it/s]
Adding feature operator: 100%|█████████▉| 186801/187062 [00:02<00:00, 51961.63it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63246.81it/s]
[2024-10-12 14:24:18,963] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 14:24:20 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 14:24:20 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:16, 390.84 examples/s]
Map:   1%|▏         | 85/6548 [00:00<00:32, 200.16 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:25, 255.40 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 310.92 examples/s]
Map:   3%|▎         | 225/6548 [00:00<00:17, 355.90 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:17, 357.18 examples/s]
Map:   5%|▌         | 334/6548 [00:01<00:18, 337.36 examples/s]
Map:   6%|▌         | 373/6548 [00:01<00:17, 345.15 examples/s]
Map:   6%|▋         | 424/6548 [00:01<00:15, 386.54 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:17, 344.86 examples/s]
Map:   8%|▊         | 531/6548 [00:01<00:16, 358.56 examples/s]
Map:   9%|▉         | 575/6548 [00:01<00:16, 370.25 examples/s]
Map:   9%|▉         | 621/6548 [00:01<00:17, 343.88 examples/s]
Map:  10%|█         | 666/6548 [00:02<00:17, 327.33 examples/s]
Map:  11%|█         | 710/6548 [00:02<00:16, 351.41 examples/s]
Map:  12%|█▏        | 758/6548 [00:02<00:15, 378.95 examples/s]
Map:  12%|█▏        | 813/6548 [00:02<00:13, 415.69 examples/s]
Map:  13%|█▎        | 876/6548 [00:02<00:13, 408.12 examples/s]
Map:  14%|█▍        | 932/6548 [00:02<00:14, 380.04 examples/s]
Map:  15%|█▌        | 985/6548 [00:02<00:15, 363.99 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:22, 244.28 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:20, 266.84 examples/s]
Map:  17%|█▋        | 1125/6548 [00:03<00:17, 305.61 examples/s]
Map:  18%|█▊        | 1164/6548 [00:03<00:16, 322.92 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 342.48 examples/s]
Map:  19%|█▉        | 1267/6548 [00:03<00:14, 356.56 examples/s]
Map:  20%|█▉        | 1306/6548 [00:03<00:14, 354.99 examples/s]
Map:  21%|██        | 1351/6548 [00:04<00:15, 333.89 examples/s]
Map:  21%|██▏       | 1392/6548 [00:04<00:16, 311.14 examples/s]
Map:  22%|██▏       | 1431/6548 [00:04<00:15, 326.13 examples/s]
Map:  23%|██▎       | 1480/6548 [00:04<00:18, 275.74 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:18, 273.39 examples/s]
Map:  24%|██▎       | 1542/6548 [00:04<00:18, 274.92 examples/s]
Map:  24%|██▍       | 1576/6548 [00:04<00:17, 279.23 examples/s]
Map:  25%|██▍       | 1612/6548 [00:05<00:18, 262.26 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:17, 272.55 examples/s]
Map:  26%|██▌       | 1685/6548 [00:05<00:18, 260.37 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:16, 294.34 examples/s]
Map:  27%|██▋       | 1770/6548 [00:05<00:14, 325.93 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 335.48 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 346.57 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 342.46 examples/s]
Map:  30%|██▉       | 1962/6548 [00:06<00:13, 350.16 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:19, 233.40 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:18, 244.70 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:16, 274.46 examples/s]
Map:  32%|███▏      | 2107/6548 [00:06<00:15, 288.96 examples/s]
Map:  33%|███▎      | 2152/6548 [00:06<00:15, 275.60 examples/s]
Map:  33%|███▎      | 2193/6548 [00:06<00:14, 304.81 examples/s]
Map:  34%|███▍      | 2229/6548 [00:07<00:14, 292.63 examples/s]
Map:  35%|███▍      | 2271/6548 [00:07<00:15, 280.21 examples/s]
Map:  35%|███▌      | 2304/6548 [00:07<00:14, 288.21 examples/s]
Map:  36%|███▌      | 2350/6548 [00:07<00:13, 320.01 examples/s]
Map:  36%|███▋      | 2389/6548 [00:07<00:14, 296.93 examples/s]
Map:  37%|███▋      | 2429/6548 [00:07<00:12, 319.71 examples/s]
Map:  38%|███▊      | 2469/6548 [00:07<00:14, 291.14 examples/s]
Map:  38%|███▊      | 2502/6548 [00:08<00:13, 299.90 examples/s]
Map:  39%|███▊      | 2536/6548 [00:08<00:13, 302.25 examples/s]
Map:  40%|███▉      | 2591/6548 [00:08<00:10, 360.30 examples/s]
Map:  40%|████      | 2632/6548 [00:08<00:10, 371.88 examples/s]
Map:  41%|████      | 2682/6548 [00:08<00:11, 347.85 examples/s]
Map:  42%|████▏     | 2736/6548 [00:08<00:11, 333.77 examples/s]
Map:  42%|████▏     | 2774/6548 [00:08<00:10, 343.46 examples/s]
Map:  43%|████▎     | 2824/6548 [00:08<00:11, 336.94 examples/s]
Map:  44%|████▎     | 2862/6548 [00:09<00:12, 288.42 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 292.66 examples/s]
Map:  45%|████▌     | 2951/6548 [00:09<00:12, 298.92 examples/s]
Map:  46%|████▌     | 2988/6548 [00:09<00:11, 302.85 examples/s]
Map:  46%|████▌     | 3026/6548 [00:09<00:21, 166.69 examples/s]
Map:  47%|████▋     | 3062/6548 [00:10<00:17, 193.69 examples/s]
Map:  47%|████▋     | 3096/6548 [00:10<00:15, 218.70 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 251.21 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:13, 254.51 examples/s]
Map:  49%|████▉     | 3201/6548 [00:10<00:12, 259.06 examples/s]
Map:  50%|████▉     | 3244/6548 [00:10<00:12, 259.12 examples/s]
Map:  50%|█████     | 3276/6548 [00:10<00:12, 266.45 examples/s]
Map:  51%|█████     | 3311/6548 [00:10<00:11, 286.02 examples/s]
Map:  51%|█████     | 3347/6548 [00:11<00:10, 297.40 examples/s]
Map:  52%|█████▏    | 3380/6548 [00:11<00:10, 291.86 examples/s]
Map:  52%|█████▏    | 3422/6548 [00:11<00:11, 282.34 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 275.78 examples/s]
Map:  53%|█████▎    | 3493/6548 [00:11<00:11, 265.40 examples/s]
Map:  54%|█████▍    | 3543/6548 [00:11<00:09, 318.81 examples/s]
Map:  55%|█████▍    | 3591/6548 [00:11<00:08, 354.19 examples/s]
Map:  56%|█████▌    | 3637/6548 [00:11<00:07, 380.29 examples/s]
Map:  56%|█████▋    | 3692/6548 [00:12<00:07, 368.54 examples/s]
Map:  57%|█████▋    | 3739/6548 [00:12<00:07, 390.37 examples/s]
Map:  58%|█████▊    | 3800/6548 [00:12<00:07, 381.47 examples/s]
Map:  59%|█████▉    | 3849/6548 [00:12<00:08, 320.77 examples/s]
Map:  59%|█████▉    | 3886/6548 [00:12<00:08, 326.02 examples/s]
Map:  60%|█████▉    | 3928/6548 [00:12<00:08, 327.24 examples/s]
Map:  61%|██████    | 3973/6548 [00:12<00:07, 341.63 examples/s]
Map:  62%|██████▏   | 4029/6548 [00:13<00:09, 256.65 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 298.12 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 321.48 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:07, 298.98 examples/s]
Map:  64%|██████▍   | 4209/6548 [00:13<00:07, 321.97 examples/s]
Map:  65%|██████▌   | 4266/6548 [00:13<00:06, 337.59 examples/s]
Map:  66%|██████▌   | 4327/6548 [00:14<00:06, 356.66 examples/s]
Map:  67%|██████▋   | 4383/6548 [00:14<00:06, 345.80 examples/s]
Map:  68%|██████▊   | 4427/6548 [00:14<00:05, 362.12 examples/s]
Map:  68%|██████▊   | 4469/6548 [00:14<00:06, 334.56 examples/s]
Map:  69%|██████▉   | 4516/6548 [00:14<00:06, 320.66 examples/s]
Map:  70%|██████▉   | 4573/6548 [00:14<00:05, 333.64 examples/s]
Map:  70%|███████   | 4610/6548 [00:14<00:05, 335.35 examples/s]
Map:  71%|███████   | 4658/6548 [00:14<00:05, 368.25 examples/s]
Map:  72%|███████▏  | 4715/6548 [00:15<00:04, 368.57 examples/s]
Map:  73%|███████▎  | 4776/6548 [00:15<00:04, 377.59 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 386.08 examples/s]
Map:  75%|███████▍  | 4881/6548 [00:15<00:04, 369.46 examples/s]
Map:  75%|███████▌  | 4933/6548 [00:15<00:04, 385.01 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:03, 399.72 examples/s]
Map:  77%|███████▋  | 5038/6548 [00:16<00:05, 254.26 examples/s]
Map:  78%|███████▊  | 5081/6548 [00:16<00:05, 260.53 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 268.61 examples/s]
Map:  79%|███████▊  | 5154/6548 [00:16<00:04, 281.39 examples/s]
Map:  79%|███████▉  | 5187/6548 [00:16<00:04, 282.56 examples/s]
Map:  80%|███████▉  | 5235/6548 [00:16<00:04, 289.73 examples/s]
Map:  81%|████████  | 5286/6548 [00:16<00:03, 319.27 examples/s]
Map:  81%|████████▏ | 5322/6548 [00:17<00:03, 326.52 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 301.73 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 296.06 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 326.77 examples/s]
Map:  84%|████████▍ | 5492/6548 [00:17<00:03, 340.12 examples/s]
Map:  84%|████████▍ | 5528/6548 [00:17<00:02, 340.45 examples/s]
Map:  85%|████████▌ | 5567/6548 [00:17<00:02, 350.16 examples/s]
Map:  86%|████████▌ | 5610/6548 [00:17<00:02, 319.63 examples/s]
Map:  86%|████████▌ | 5647/6548 [00:18<00:02, 327.15 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 302.19 examples/s]
Map:  87%|████████▋ | 5716/6548 [00:18<00:02, 309.08 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 338.65 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 346.42 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:01, 354.77 examples/s]
Map:  90%|████████▉ | 5889/6548 [00:18<00:01, 365.47 examples/s]
Map:  91%|█████████ | 5927/6548 [00:18<00:01, 368.46 examples/s]
Map:  91%|█████████ | 5973/6548 [00:19<00:01, 344.28 examples/s]
Map:  92%|█████████▏| 6025/6548 [00:19<00:02, 226.64 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 261.31 examples/s]
Map:  93%|█████████▎| 6120/6548 [00:19<00:01, 253.50 examples/s]
Map:  94%|█████████▍| 6159/6548 [00:19<00:01, 278.73 examples/s]
Map:  95%|█████████▍| 6212/6548 [00:19<00:01, 298.48 examples/s]
Map:  95%|█████████▌| 6251/6548 [00:20<00:00, 317.28 examples/s]
Map:  96%|█████████▋| 6304/6548 [00:20<00:00, 323.83 examples/s]
Map:  97%|█████████▋| 6357/6548 [00:20<00:00, 323.13 examples/s]
Map:  98%|█████████▊| 6396/6548 [00:20<00:00, 336.71 examples/s]
Map:  98%|█████████▊| 6444/6548 [00:20<00:00, 360.24 examples/s]
Map:  99%|█████████▉| 6493/6548 [00:20<00:00, 389.93 examples/s]
Map: 100%|█████████▉| 6539/6548 [00:20<00:00, 356.15 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 311.26 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 319.57 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 342.07 examples/s]
Map:  14%|█▍        | 125/903 [00:00<00:02, 313.50 examples/s]
Map:  19%|█▉        | 170/903 [00:00<00:02, 354.51 examples/s]
Map:  23%|██▎       | 212/903 [00:00<00:01, 373.73 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 379.57 examples/s]
Map:  34%|███▍      | 310/903 [00:00<00:01, 379.03 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 319.68 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 300.80 examples/s]
Map:  51%|█████     | 460/903 [00:01<00:01, 302.67 examples/s]
Map:  57%|█████▋    | 516/903 [00:01<00:01, 319.39 examples/s]
Map:  62%|██████▏   | 561/903 [00:01<00:01, 341.52 examples/s]
Map:  68%|██████▊   | 611/903 [00:01<00:00, 377.66 examples/s]
Map:  72%|███████▏  | 651/903 [00:01<00:00, 337.25 examples/s]
Map:  78%|███████▊  | 706/903 [00:02<00:00, 340.18 examples/s]
Map:  84%|████████▎ | 755/903 [00:02<00:00, 373.83 examples/s]
Map:  90%|████████▉ | 809/903 [00:02<00:00, 363.27 examples/s]
Map:  94%|█████████▍| 849/903 [00:02<00:00, 367.55 examples/s]
Map:  99%|█████████▊| 891/903 [00:02<00:00, 333.52 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 313.15 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 301.79 examples/s]
Map:   4%|▍         | 82/1882 [00:00<00:04, 372.72 examples/s]
Map:   7%|▋         | 135/1882 [00:00<00:05, 346.44 examples/s]
Map:  10%|▉         | 180/1882 [00:00<00:04, 378.45 examples/s]
Map:  13%|█▎        | 240/1882 [00:00<00:04, 381.38 examples/s]
Map:  15%|█▍        | 280/1882 [00:00<00:04, 382.89 examples/s]
Map:  18%|█▊        | 334/1882 [00:00<00:04, 365.58 examples/s]
Map:  20%|██        | 377/1882 [00:01<00:04, 336.23 examples/s]
Map:  22%|██▏       | 417/1882 [00:01<00:04, 311.18 examples/s]
Map:  24%|██▍       | 450/1882 [00:01<00:04, 314.71 examples/s]
Map:  27%|██▋       | 499/1882 [00:01<00:03, 352.09 examples/s]
Map:  29%|██▉       | 545/1882 [00:01<00:03, 334.68 examples/s]
Map:  31%|███▏      | 591/1882 [00:01<00:03, 361.71 examples/s]
Map:  34%|███▍      | 645/1882 [00:01<00:03, 406.76 examples/s]
Map:  37%|███▋      | 704/1882 [00:01<00:03, 391.95 examples/s]
Map:  41%|████      | 768/1882 [00:02<00:02, 398.51 examples/s]
Map:  43%|████▎     | 809/1882 [00:02<00:03, 352.06 examples/s]
Map:  45%|████▌     | 851/1882 [00:02<00:02, 366.79 examples/s]
Map:  48%|████▊     | 894/1882 [00:02<00:02, 378.16 examples/s]
Map:  51%|█████     | 961/1882 [00:02<00:02, 397.63 examples/s]
Map:  54%|█████▍    | 1016/1882 [00:02<00:03, 258.05 examples/s]
Map:  56%|█████▌    | 1053/1882 [00:03<00:03, 274.97 examples/s]
Map:  58%|█████▊    | 1095/1882 [00:03<00:02, 272.26 examples/s]
Map:  60%|██████    | 1135/1882 [00:03<00:02, 287.82 examples/s]
Map:  62%|██████▏   | 1172/1882 [00:03<00:02, 304.87 examples/s]
Map:  64%|██████▍   | 1213/1882 [00:03<00:02, 286.42 examples/s]
Map:  66%|██████▋   | 1249/1882 [00:03<00:02, 299.26 examples/s]
Map:  68%|██████▊   | 1288/1882 [00:03<00:01, 320.17 examples/s]
Map:  71%|███████   | 1333/1882 [00:03<00:01, 350.87 examples/s]
Map:  73%|███████▎  | 1376/1882 [00:04<00:01, 318.11 examples/s]
Map:  75%|███████▌  | 1413/1882 [00:04<00:01, 325.15 examples/s]
Map:  78%|███████▊  | 1469/1882 [00:04<00:01, 297.50 examples/s]
Map:  80%|████████  | 1507/1882 [00:04<00:01, 257.50 examples/s]
Map:  82%|████████▏ | 1538/1882 [00:04<00:01, 261.06 examples/s]
Map:  84%|████████▍ | 1581/1882 [00:04<00:01, 294.95 examples/s]
Map:  86%|████████▌ | 1621/1882 [00:04<00:00, 317.81 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 320.03 examples/s]
Map:  91%|█████████ | 1713/1882 [00:05<00:00, 327.51 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 283.06 examples/s]
Map:  95%|█████████▍| 1785/1882 [00:05<00:00, 284.97 examples/s]
Map:  97%|█████████▋| 1830/1882 [00:05<00:00, 320.27 examples/s]
Map: 100%|█████████▉| 1875/1882 [00:05<00:00, 349.12 examples/s]
Map: 100%|██████████| 1882/1882 [00:05<00:00, 314.98 examples/s]
10/12/2024 14:25:22 - INFO - __main__ -     ***** Testing *****
10/12/2024 14:25:22 - INFO - __main__ -     Batch size = 8
10/12/2024 14:25:22 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 14:25:22 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 14:25:22 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 14:25:23 - INFO - knnlm -   Reading datastore took 0.9731249809265137 s
10/12/2024 14:25:24 - INFO - knnlm -   Moving index to GPU took 0.9078807830810547 s
10/12/2024 14:25:24 - INFO - __main__ -   ******************************break-into
10/12/2024 14:25:24 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 14:25:24 - INFO - __main__ -     Num examples = 236
10/12/2024 14:25:24 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<31:49,  8.12s/it]
test ppl:   1%|          | 2/236 [00:10<17:26,  4.47s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:13,  3.15s/it]
test ppl:   2%|▏         | 4/236 [00:14<11:02,  2.86s/it]
test ppl:   2%|▏         | 5/236 [00:19<15:12,  3.95s/it]
test ppl:   3%|▎         | 6/236 [00:25<17:42,  4.62s/it]
test ppl:   3%|▎         | 7/236 [00:27<14:14,  3.73s/it]
test ppl:   3%|▎         | 8/236 [00:32<15:57,  4.20s/it]
test ppl:   4%|▍         | 9/236 [00:38<17:54,  4.73s/it]
test ppl:   4%|▍         | 10/236 [00:41<15:03,  4.00s/it]
test ppl:   5%|▍         | 11/236 [00:44<14:10,  3.78s/it]
test ppl:   5%|▌         | 12/236 [00:50<16:31,  4.43s/it]
test ppl:   6%|▌         | 13/236 [00:56<18:08,  4.88s/it]
test ppl:   6%|▌         | 14/236 [01:02<19:16,  5.21s/it]
test ppl:   6%|▋         | 15/236 [01:04<16:20,  4.44s/it]
test ppl:   7%|▋         | 16/236 [01:06<13:26,  3.67s/it]
test ppl:   7%|▋         | 17/236 [01:11<14:08,  3.87s/it]
test ppl:   8%|▊         | 18/236 [01:13<12:31,  3.45s/it]
test ppl:   8%|▊         | 19/236 [01:19<15:08,  4.19s/it]
test ppl:   8%|▊         | 20/236 [01:22<13:19,  3.70s/it]
test ppl:   9%|▉         | 21/236 [01:28<15:38,  4.37s/it]
test ppl:   9%|▉         | 22/236 [01:33<17:15,  4.84s/it]
test ppl:  10%|▉         | 23/236 [01:36<14:43,  4.15s/it]
test ppl:  10%|█         | 24/236 [01:38<12:36,  3.57s/it]
test ppl:  11%|█         | 25/236 [01:44<14:59,  4.27s/it]
test ppl:  11%|█         | 26/236 [01:50<16:40,  4.77s/it]
test ppl:  11%|█▏        | 27/236 [01:53<15:13,  4.37s/it]
test ppl:  12%|█▏        | 28/236 [01:55<12:07,  3.50s/it]
test ppl:  12%|█▏        | 29/236 [01:57<10:32,  3.05s/it]
test ppl:  13%|█▎        | 30/236 [01:59<08:56,  2.60s/it]
test ppl:  13%|█▎        | 31/236 [02:01<08:16,  2.42s/it]
test ppl:  14%|█▎        | 32/236 [02:06<11:48,  3.47s/it]
test ppl:  14%|█▍        | 33/236 [02:09<11:16,  3.33s/it]
test ppl:  14%|█▍        | 34/236 [02:13<11:56,  3.55s/it]
test ppl:  15%|█▍        | 35/236 [02:19<14:16,  4.26s/it]
test ppl:  15%|█▌        | 36/236 [02:25<15:51,  4.76s/it]
test ppl:  16%|█▌        | 37/236 [02:31<16:57,  5.11s/it]
test ppl:  16%|█▌        | 38/236 [02:33<13:52,  4.20s/it]
test ppl:  17%|█▋        | 39/236 [02:35<11:26,  3.49s/it]
test ppl:  17%|█▋        | 40/236 [02:37<09:16,  2.84s/it]
test ppl:  17%|█▋        | 41/236 [02:38<08:16,  2.55s/it]
test ppl:  18%|█▊        | 42/236 [02:44<11:32,  3.57s/it]
test ppl:  18%|█▊        | 43/236 [02:50<13:44,  4.27s/it]
test ppl:  19%|█▊        | 44/236 [02:53<12:10,  3.81s/it]
test ppl:  19%|█▉        | 45/236 [02:55<10:22,  3.26s/it]
test ppl:  19%|█▉        | 46/236 [03:01<12:51,  4.06s/it]
test ppl:  20%|█▉        | 47/236 [03:02<10:24,  3.30s/it]
test ppl:  20%|██        | 48/236 [03:08<12:46,  4.08s/it]
test ppl:  21%|██        | 49/236 [03:11<11:25,  3.66s/it]
test ppl:  21%|██        | 50/236 [03:17<13:30,  4.36s/it]
test ppl:  22%|██▏       | 51/236 [03:23<14:53,  4.83s/it]
test ppl:  22%|██▏       | 52/236 [03:29<15:49,  5.16s/it]
test ppl:  22%|██▏       | 53/236 [03:33<14:49,  4.86s/it]
test ppl:  23%|██▎       | 54/236 [03:35<11:43,  3.87s/it]
test ppl:  23%|██▎       | 55/236 [03:40<13:17,  4.41s/it]
test ppl:  24%|██▎       | 56/236 [03:46<14:36,  4.87s/it]
test ppl:  24%|██▍       | 57/236 [03:49<12:25,  4.17s/it]
test ppl:  25%|██▍       | 58/236 [03:51<10:41,  3.60s/it]
test ppl:  25%|██▌       | 59/236 [03:57<12:40,  4.30s/it]
test ppl:  25%|██▌       | 60/236 [04:00<11:28,  3.91s/it]
test ppl:  26%|██▌       | 61/236 [04:06<13:09,  4.51s/it]
test ppl:  26%|██▋       | 62/236 [04:12<14:18,  4.93s/it]
test ppl:  27%|██▋       | 63/236 [04:14<12:06,  4.20s/it]
test ppl:  27%|██▋       | 64/236 [04:16<09:45,  3.40s/it]
test ppl:  28%|██▊       | 65/236 [04:17<07:55,  2.78s/it]
test ppl:  28%|██▊       | 66/236 [04:20<08:05,  2.86s/it]
test ppl:  28%|██▊       | 67/236 [04:26<10:38,  3.78s/it]
test ppl:  29%|██▉       | 68/236 [04:32<12:23,  4.42s/it]
test ppl:  29%|██▉       | 69/236 [04:38<13:34,  4.87s/it]
test ppl:  30%|██▉       | 70/236 [04:44<14:20,  5.18s/it]
test ppl:  30%|███       | 71/236 [04:47<12:58,  4.72s/it]
test ppl:  31%|███       | 72/236 [04:51<12:09,  4.45s/it]
test ppl:  31%|███       | 73/236 [04:57<13:17,  4.89s/it]
test ppl:  31%|███▏      | 74/236 [04:59<10:28,  3.88s/it]
test ppl:  32%|███▏      | 75/236 [05:05<12:02,  4.49s/it]
test ppl:  32%|███▏      | 76/236 [05:11<13:07,  4.92s/it]
test ppl:  33%|███▎      | 77/236 [05:14<12:12,  4.61s/it]
test ppl:  33%|███▎      | 78/236 [05:16<09:41,  3.68s/it]
test ppl:  33%|███▎      | 79/236 [05:20<09:45,  3.73s/it]
test ppl:  34%|███▍      | 80/236 [05:22<08:43,  3.36s/it]
test ppl:  34%|███▍      | 81/236 [05:28<10:38,  4.12s/it]
test ppl:  35%|███▍      | 82/236 [05:34<11:58,  4.67s/it]
test ppl:  35%|███▌      | 83/236 [05:37<10:46,  4.23s/it]
test ppl:  36%|███▌      | 84/236 [05:39<08:47,  3.47s/it]
test ppl:  36%|███▌      | 85/236 [05:43<09:17,  3.69s/it]
test ppl:  36%|███▋      | 86/236 [05:45<08:06,  3.25s/it]
test ppl:  37%|███▋      | 87/236 [05:48<07:13,  2.91s/it]
test ppl:  37%|███▋      | 88/236 [05:53<09:23,  3.81s/it]
test ppl:  38%|███▊      | 89/236 [05:59<10:52,  4.44s/it]
test ppl:  38%|███▊      | 90/236 [06:05<11:52,  4.88s/it]
test ppl:  39%|███▊      | 91/236 [06:10<11:50,  4.90s/it]
test ppl:  39%|███▉      | 92/236 [06:13<10:16,  4.28s/it]
test ppl:  39%|███▉      | 93/236 [06:19<11:21,  4.77s/it]
test ppl:  40%|███▉      | 94/236 [06:25<12:00,  5.07s/it]
test ppl:  40%|████      | 95/236 [06:27<10:12,  4.34s/it]
test ppl:  41%|████      | 96/236 [06:30<09:08,  3.92s/it]
test ppl:  41%|████      | 97/236 [06:36<10:27,  4.51s/it]
test ppl:  42%|████▏     | 98/236 [06:42<11:21,  4.94s/it]
test ppl:  42%|████▏     | 99/236 [06:48<11:57,  5.24s/it]
test ppl:  42%|████▏     | 100/236 [06:49<09:09,  4.04s/it]
test ppl:  43%|████▎     | 101/236 [06:55<10:21,  4.61s/it]
test ppl:  43%|████▎     | 102/236 [06:59<09:51,  4.41s/it]
test ppl:  44%|████▎     | 103/236 [07:01<07:48,  3.52s/it]
test ppl:  44%|████▍     | 104/236 [07:05<08:12,  3.73s/it]
test ppl:  44%|████▍     | 105/236 [07:09<08:18,  3.81s/it]
test ppl:  45%|████▍     | 106/236 [07:14<09:18,  4.30s/it]
test ppl:  45%|████▌     | 107/236 [07:17<07:57,  3.70s/it]
test ppl:  46%|████▌     | 108/236 [07:20<07:47,  3.65s/it]
test ppl:  46%|████▌     | 109/236 [07:25<08:47,  4.15s/it]
test ppl:  47%|████▋     | 110/236 [07:27<07:06,  3.38s/it]
test ppl:  47%|████▋     | 111/236 [07:31<07:34,  3.63s/it]
test ppl:  47%|████▋     | 112/236 [07:37<08:55,  4.32s/it]
test ppl:  48%|████▊     | 113/236 [07:39<07:18,  3.56s/it]
test ppl:  48%|████▊     | 114/236 [07:44<07:57,  3.91s/it]
test ppl:  49%|████▊     | 115/236 [07:50<09:06,  4.52s/it]
test ppl:  49%|████▉     | 116/236 [07:56<09:53,  4.94s/it]
test ppl:  50%|████▉     | 117/236 [07:57<07:58,  4.02s/it]
test ppl:  50%|█████     | 118/236 [08:03<08:35,  4.37s/it]
test ppl:  50%|█████     | 119/236 [08:05<07:13,  3.71s/it]
test ppl:  51%|█████     | 120/236 [08:06<05:51,  3.03s/it]
test ppl:  51%|█████▏    | 121/236 [08:09<05:34,  2.91s/it]
test ppl:  52%|█████▏    | 122/236 [08:15<07:14,  3.81s/it]
test ppl:  52%|█████▏    | 123/236 [08:21<08:23,  4.46s/it]
test ppl:  53%|█████▎    | 124/236 [08:23<07:14,  3.88s/it]
test ppl:  53%|█████▎    | 125/236 [08:29<08:18,  4.49s/it]
test ppl:  53%|█████▎    | 126/236 [08:34<08:24,  4.59s/it]
test ppl:  54%|█████▍    | 127/236 [08:36<06:52,  3.79s/it]
test ppl:  54%|█████▍    | 128/236 [08:38<05:47,  3.22s/it]
test ppl:  55%|█████▍    | 129/236 [08:41<05:47,  3.25s/it]
test ppl:  55%|█████▌    | 130/236 [08:44<05:31,  3.13s/it]
test ppl:  56%|█████▌    | 131/236 [08:50<06:56,  3.97s/it]
test ppl:  56%|█████▌    | 132/236 [08:56<07:53,  4.55s/it]
test ppl:  56%|█████▋    | 133/236 [09:00<07:30,  4.37s/it]
test ppl:  57%|█████▋    | 134/236 [09:03<06:57,  4.09s/it]
test ppl:  57%|█████▋    | 135/236 [09:09<07:48,  4.64s/it]
test ppl:  58%|█████▊    | 136/236 [09:10<06:04,  3.65s/it]
test ppl:  58%|█████▊    | 137/236 [09:16<07:09,  4.34s/it]
test ppl:  58%|█████▊    | 138/236 [09:20<06:46,  4.14s/it]
test ppl:  59%|█████▉    | 139/236 [09:22<05:33,  3.44s/it]
test ppl:  59%|█████▉    | 140/236 [09:24<04:40,  2.92s/it]
test ppl:  60%|█████▉    | 141/236 [09:28<05:05,  3.21s/it]
test ppl:  60%|██████    | 142/236 [09:30<04:31,  2.89s/it]
test ppl:  61%|██████    | 143/236 [09:36<05:53,  3.81s/it]
test ppl:  61%|██████    | 144/236 [09:39<05:35,  3.64s/it]
test ppl:  61%|██████▏   | 145/236 [09:43<05:48,  3.83s/it]
test ppl:  62%|██████▏   | 146/236 [09:49<06:30,  4.34s/it]
test ppl:  62%|██████▏   | 147/236 [09:55<07:08,  4.82s/it]
test ppl:  63%|██████▎   | 148/236 [10:01<07:35,  5.18s/it]
test ppl:  63%|██████▎   | 149/236 [10:07<07:50,  5.40s/it]
test ppl:  64%|██████▎   | 150/236 [10:12<07:58,  5.56s/it]
test ppl:  64%|██████▍   | 151/236 [10:18<08:01,  5.66s/it]
test ppl:  64%|██████▍   | 152/236 [10:24<08:02,  5.74s/it]
test ppl:  65%|██████▍   | 153/236 [10:30<08:00,  5.79s/it]
test ppl:  65%|██████▌   | 154/236 [10:32<06:08,  4.50s/it]
test ppl:  66%|██████▌   | 155/236 [10:36<05:47,  4.29s/it]
test ppl:  66%|██████▌   | 156/236 [10:38<04:58,  3.73s/it]
test ppl:  67%|██████▋   | 157/236 [10:39<04:00,  3.05s/it]
test ppl:  67%|██████▋   | 158/236 [10:45<05:04,  3.91s/it]
test ppl:  67%|██████▋   | 159/236 [10:51<05:47,  4.51s/it]
test ppl:  68%|██████▊   | 160/236 [10:53<04:45,  3.76s/it]
test ppl:  68%|██████▊   | 161/236 [10:55<03:47,  3.03s/it]
test ppl:  69%|██████▊   | 162/236 [10:57<03:24,  2.76s/it]
test ppl:  69%|██████▉   | 163/236 [10:58<02:56,  2.41s/it]
test ppl:  69%|██████▉   | 164/236 [11:03<03:33,  2.97s/it]
test ppl:  70%|██████▉   | 165/236 [11:06<03:31,  2.99s/it]
test ppl:  70%|███████   | 166/236 [11:07<02:56,  2.53s/it]
test ppl:  71%|███████   | 167/236 [11:09<02:32,  2.21s/it]
test ppl:  71%|███████   | 168/236 [11:10<02:22,  2.09s/it]
test ppl:  72%|███████▏  | 169/236 [11:15<03:06,  2.78s/it]
test ppl:  72%|███████▏  | 170/236 [11:21<04:06,  3.74s/it]
test ppl:  72%|███████▏  | 171/236 [11:22<03:16,  3.03s/it]
test ppl:  73%|███████▎  | 172/236 [11:28<04:09,  3.90s/it]
test ppl:  73%|███████▎  | 173/236 [11:31<03:50,  3.67s/it]
test ppl:  74%|███████▎  | 174/236 [11:37<04:30,  4.36s/it]
test ppl:  74%|███████▍  | 175/236 [11:39<03:40,  3.61s/it]
test ppl:  75%|███████▍  | 176/236 [11:45<04:18,  4.30s/it]
test ppl:  75%|███████▌  | 177/236 [11:51<04:43,  4.80s/it]
test ppl:  75%|███████▌  | 178/236 [11:57<04:58,  5.15s/it]
test ppl:  76%|███████▌  | 179/236 [12:03<05:07,  5.39s/it]
test ppl:  76%|███████▋  | 180/236 [12:08<05:03,  5.42s/it]
test ppl:  77%|███████▋  | 181/236 [12:13<04:53,  5.34s/it]
test ppl:  77%|███████▋  | 182/236 [12:15<03:52,  4.31s/it]
test ppl:  78%|███████▊  | 183/236 [12:17<03:05,  3.50s/it]
test ppl:  78%|███████▊  | 184/236 [12:18<02:29,  2.88s/it]
test ppl:  78%|███████▊  | 185/236 [12:24<03:14,  3.81s/it]
test ppl:  79%|███████▉  | 186/236 [12:26<02:42,  3.25s/it]
test ppl:  79%|███████▉  | 187/236 [12:29<02:27,  3.01s/it]
test ppl:  80%|███████▉  | 188/236 [12:35<03:06,  3.88s/it]
test ppl:  80%|████████  | 189/236 [12:41<03:31,  4.49s/it]
test ppl:  81%|████████  | 190/236 [12:44<03:16,  4.27s/it]
test ppl:  81%|████████  | 191/236 [12:48<03:05,  4.13s/it]
test ppl:  81%|████████▏ | 192/236 [12:51<02:42,  3.69s/it]
test ppl:  82%|████████▏ | 193/236 [12:57<03:07,  4.36s/it]
test ppl:  82%|████████▏ | 194/236 [12:59<02:41,  3.85s/it]
test ppl:  83%|████████▎ | 195/236 [13:02<02:21,  3.46s/it]
test ppl:  83%|████████▎ | 196/236 [13:04<02:01,  3.04s/it]
test ppl:  83%|████████▎ | 197/236 [13:06<01:48,  2.77s/it]
test ppl:  84%|████████▍ | 198/236 [13:12<02:21,  3.71s/it]
test ppl:  84%|████████▍ | 199/236 [13:15<02:11,  3.54s/it]
test ppl:  85%|████████▍ | 200/236 [13:21<02:32,  4.25s/it]
test ppl:  85%|████████▌ | 201/236 [13:24<02:11,  3.75s/it]
test ppl:  86%|████████▌ | 202/236 [13:30<02:29,  4.40s/it]
test ppl:  86%|████████▌ | 203/236 [13:35<02:40,  4.86s/it]
test ppl:  86%|████████▋ | 204/236 [13:37<02:05,  3.92s/it]
test ppl:  87%|████████▋ | 205/236 [13:43<02:21,  4.55s/it]
test ppl:  87%|████████▋ | 206/236 [13:47<02:06,  4.21s/it]
test ppl:  88%|████████▊ | 207/236 [13:53<02:16,  4.72s/it]
test ppl:  88%|████████▊ | 208/236 [13:55<01:55,  4.14s/it]
test ppl:  89%|████████▊ | 209/236 [14:01<02:06,  4.70s/it]
test ppl:  89%|████████▉ | 210/236 [14:04<01:43,  4.00s/it]
test ppl:  89%|████████▉ | 211/236 [14:08<01:45,  4.23s/it]
test ppl:  90%|████████▉ | 212/236 [14:14<01:53,  4.73s/it]
test ppl:  90%|█████████ | 213/236 [14:20<01:56,  5.09s/it]
test ppl:  91%|█████████ | 214/236 [14:22<01:27,  3.96s/it]
test ppl:  91%|█████████ | 215/236 [14:28<01:35,  4.55s/it]
test ppl:  92%|█████████▏| 216/236 [14:30<01:17,  3.89s/it]
test ppl:  92%|█████████▏| 217/236 [14:36<01:26,  4.53s/it]
test ppl:  92%|█████████▏| 218/236 [14:39<01:12,  4.01s/it]
test ppl:  93%|█████████▎| 219/236 [14:45<01:17,  4.59s/it]
test ppl:  93%|█████████▎| 220/236 [14:51<01:19,  4.99s/it]
test ppl:  94%|█████████▎| 221/236 [14:52<01:00,  4.02s/it]
test ppl:  94%|█████████▍| 222/236 [14:58<01:04,  4.59s/it]
test ppl:  94%|█████████▍| 223/236 [15:04<01:04,  4.99s/it]
test ppl:  95%|█████████▍| 224/236 [15:10<01:03,  5.27s/it]
test ppl:  95%|█████████▌| 225/236 [15:14<00:54,  4.96s/it]
test ppl:  96%|█████████▌| 226/236 [15:17<00:43,  4.33s/it]
test ppl:  96%|█████████▌| 227/236 [15:20<00:34,  3.86s/it]
test ppl:  97%|█████████▋| 228/236 [15:22<00:25,  3.21s/it]
test ppl:  97%|█████████▋| 229/236 [15:28<00:28,  4.02s/it]
test ppl:  97%|█████████▋| 230/236 [15:31<00:23,  3.86s/it]
test ppl:  98%|█████████▊| 231/236 [15:34<00:18,  3.71s/it]
test ppl:  98%|█████████▊| 232/236 [15:36<00:12,  3.16s/it]
test ppl:  99%|█████████▊| 233/236 [15:39<00:09,  3.07s/it]
test ppl:  99%|█████████▉| 234/236 [15:41<00:05,  2.61s/it]
test ppl: 100%|█████████▉| 235/236 [15:47<00:03,  3.61s/it]
test ppl: 100%|██████████| 236/236 [15:47<00:00,  2.72s/it]
test ppl: 100%|██████████| 236/236 [15:47<00:00,  4.02s/it]
10/12/2024 14:41:12 - INFO - __main__ -    em: 0.1977
10/12/2024 14:41:12 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.6 40:  em: 0.1977

--------------------------------------------------------------------------------
Running experiment with knn_temp=50, lmbda=0.2, k=16
2024-10-12 14:41:19.302626: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 14:41:19.322212: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 14:41:19.344008: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 14:41:19.350678: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 14:41:19.366682: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 14:41:20.360676: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 14:41:21 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.2, knn_temp=50, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 14:41:21 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:43:06,  2.19it/s]
Adding feature api:   4%|▍         | 7473/187062 [00:00<00:10, 17809.99it/s]
Adding feature api:   9%|▊         | 16094/187062 [00:00<00:04, 35182.58it/s]
Adding feature api:  13%|█▎        | 24749/187062 [00:00<00:03, 48856.73it/s]
Adding feature api:  18%|█▊        | 33378/187062 [00:00<00:02, 59169.29it/s]
Adding feature api:  23%|██▎       | 42096/187062 [00:00<00:02, 67078.28it/s]
Adding feature api:  27%|██▋       | 50798/187062 [00:01<00:01, 72809.96it/s]
Adding feature api:  32%|███▏      | 59461/187062 [00:01<00:01, 76830.80it/s]
Adding feature api:  36%|███▋      | 68168/187062 [00:01<00:01, 79836.52it/s]
Adding feature api:  41%|████      | 76858/187062 [00:01<00:01, 81923.46it/s]
Adding feature api:  46%|████▌     | 85525/187062 [00:01<00:01, 83330.89it/s]
Adding feature api:  50%|█████     | 94189/187062 [00:01<00:01, 84314.48it/s]
Adding feature api:  55%|█████▍    | 102802/187062 [00:01<00:00, 84563.02it/s]
Adding feature api:  60%|█████▉    | 111502/187062 [00:01<00:00, 85289.07it/s]
Adding feature api:  64%|██████▍   | 120204/187062 [00:01<00:00, 85804.34it/s]
Adding feature api:  69%|██████▉   | 128909/187062 [00:01<00:00, 86175.91it/s]
Adding feature api:  74%|███████▎  | 137609/187062 [00:02<00:00, 86421.29it/s]
Adding feature api:  78%|███████▊  | 146372/187062 [00:02<00:00, 86782.71it/s]
Adding feature api:  83%|████████▎ | 155132/187062 [00:02<00:00, 87025.36it/s]
Adding feature api:  88%|████████▊ | 163850/187062 [00:02<00:00, 87036.72it/s]
Adding feature api:  92%|█████████▏| 172578/187062 [00:02<00:00, 87108.61it/s]
Adding feature api:  97%|█████████▋| 181297/187062 [00:02<00:00, 68941.64it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 65980.66it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:43:34,  2.19it/s]
Adding feature datatype:   4%|▍         | 7312/187062 [00:00<00:10, 17423.68it/s]
Adding feature datatype:   8%|▊         | 15587/187062 [00:00<00:05, 34013.37it/s]
Adding feature datatype:  13%|█▎        | 23907/187062 [00:00<00:03, 47107.12it/s]
Adding feature datatype:  17%|█▋        | 32267/187062 [00:00<00:02, 57160.84it/s]
Adding feature datatype:  22%|██▏       | 40638/187062 [00:00<00:02, 64658.60it/s]
Adding feature datatype:  26%|██▌       | 49025/187062 [00:01<00:01, 70180.86it/s]
Adding feature datatype:  31%|███       | 57460/187062 [00:01<00:01, 74304.93it/s]
Adding feature datatype:  35%|███▌      | 65826/187062 [00:01<00:01, 77052.15it/s]
Adding feature datatype:  40%|███▉      | 74249/187062 [00:01<00:01, 79171.80it/s]
Adding feature datatype:  44%|████▍     | 82605/187062 [00:01<00:01, 80472.57it/s]
Adding feature datatype:  49%|████▊     | 90930/187062 [00:01<00:01, 81297.83it/s]
Adding feature datatype:  53%|█████▎    | 99265/187062 [00:01<00:01, 81907.25it/s]
Adding feature datatype:  58%|█████▊    | 107660/187062 [00:01<00:00, 82514.88it/s]
Adding feature datatype:  62%|██████▏   | 116083/187062 [00:01<00:00, 83026.34it/s]
Adding feature datatype:  67%|██████▋   | 124447/187062 [00:01<00:00, 83065.36it/s]
Adding feature datatype:  71%|███████   | 132796/187062 [00:02<00:00, 83183.20it/s]
Adding feature datatype:  75%|███████▌  | 141196/187062 [00:02<00:00, 83426.81it/s]
Adding feature datatype:  80%|███████▉  | 149571/187062 [00:02<00:00, 83522.77it/s]
Adding feature datatype:  84%|████████▍ | 158006/187062 [00:02<00:00, 83769.18it/s]
Adding feature datatype:  89%|████████▉ | 166400/187062 [00:02<00:00, 83818.32it/s]
Adding feature datatype:  93%|█████████▎| 174825/187062 [00:02<00:00, 83945.93it/s]
Adding feature datatype:  98%|█████████▊| 183225/187062 [00:02<00:00, 59509.10it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 64276.52it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:26:05,  2.22it/s]
Adding feature literal:   4%|▍         | 7274/187062 [00:00<00:10, 17496.71it/s]
Adding feature literal:   8%|▊         | 15578/187062 [00:00<00:05, 34259.03it/s]
Adding feature literal:  13%|█▎        | 23963/187062 [00:00<00:03, 47528.78it/s]
Adding feature literal:  17%|█▋        | 32338/187062 [00:00<00:02, 57544.50it/s]
Adding feature literal:  22%|██▏       | 40753/187062 [00:00<00:02, 65077.63it/s]
Adding feature literal:  26%|██▋       | 49179/187062 [00:01<00:01, 70601.12it/s]
Adding feature literal:  31%|███       | 57614/187062 [00:01<00:01, 74606.88it/s]
Adding feature literal:  35%|███▌      | 66047/187062 [00:01<00:01, 77463.94it/s]
Adding feature literal:  40%|███▉      | 74469/187062 [00:01<00:01, 79460.42it/s]
Adding feature literal:  44%|████▍     | 82891/187062 [00:01<00:01, 80873.23it/s]
Adding feature literal:  49%|████▉     | 91224/187062 [00:01<00:01, 81096.93it/s]
Adding feature literal:  53%|█████▎    | 99505/187062 [00:01<00:01, 79266.91it/s]
Adding feature literal:  57%|█████▋    | 107560/187062 [00:01<00:01, 77895.55it/s]
Adding feature literal:  62%|██████▏   | 115441/187062 [00:01<00:00, 76922.20it/s]
Adding feature literal:  66%|██████▌   | 123197/187062 [00:01<00:00, 76780.58it/s]
Adding feature literal:  70%|███████   | 131572/187062 [00:02<00:00, 78810.84it/s]
Adding feature literal:  75%|███████▍  | 139978/187062 [00:02<00:00, 80354.16it/s]
Adding feature literal:  79%|███████▉  | 148391/187062 [00:02<00:00, 81469.22it/s]
Adding feature literal:  84%|████████▍ | 156731/187062 [00:02<00:00, 82040.99it/s]
Adding feature literal:  88%|████████▊ | 165175/187062 [00:02<00:00, 82752.55it/s]
Adding feature literal:  93%|█████████▎| 173529/187062 [00:02<00:00, 82986.67it/s]
Adding feature literal:  97%|█████████▋| 181837/187062 [00:02<00:00, 63777.34it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63467.57it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:18:41,  2.23it/s]
Adding feature operator:   4%|▍         | 7287/187062 [00:00<00:10, 17598.59it/s]
Adding feature operator:   8%|▊         | 15647/187062 [00:00<00:04, 34528.86it/s]
Adding feature operator:  13%|█▎        | 24015/187062 [00:00<00:03, 47708.98it/s]
Adding feature operator:  17%|█▋        | 32421/187062 [00:00<00:02, 57775.48it/s]
Adding feature operator:  22%|██▏       | 40842/187062 [00:00<00:02, 65267.71it/s]
Adding feature operator:  26%|██▋       | 49261/187062 [00:01<00:01, 70719.94it/s]
Adding feature operator:  31%|███       | 57741/187062 [00:01<00:01, 74824.08it/s]
Adding feature operator:  35%|███▌      | 65927/187062 [00:01<00:01, 76892.06it/s]
Adding feature operator:  40%|███▉      | 74362/187062 [00:01<00:01, 79096.30it/s]
Adding feature operator:  44%|████▍     | 82797/187062 [00:01<00:01, 80654.86it/s]
Adding feature operator:  49%|████▉     | 91243/187062 [00:01<00:01, 81786.45it/s]
Adding feature operator:  53%|█████▎    | 99594/187062 [00:01<00:01, 82295.07it/s]
Adding feature operator:  58%|█████▊    | 108009/187062 [00:01<00:00, 82848.24it/s]
Adding feature operator:  62%|██████▏   | 116443/187062 [00:01<00:00, 83291.74it/s]
Adding feature operator:  67%|██████▋   | 124901/187062 [00:01<00:00, 83674.11it/s]
Adding feature operator:  71%|███████▏  | 133311/187062 [00:02<00:00, 83671.38it/s]
Adding feature operator:  76%|███████▌  | 141739/187062 [00:02<00:00, 83852.80it/s]
Adding feature operator:  80%|████████  | 150145/187062 [00:02<00:00, 83892.42it/s]
Adding feature operator:  85%|████████▍ | 158600/187062 [00:02<00:00, 84087.39it/s]
Adding feature operator:  89%|████████▉ | 167040/187062 [00:02<00:00, 84177.87it/s]
Adding feature operator:  94%|█████████▍| 175465/187062 [00:02<00:00, 83582.04it/s]
Adding feature operator:  98%|█████████▊| 183830/187062 [00:02<00:00, 58254.05it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 64641.61it/s]
[2024-10-12 14:42:05,178] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 14:42:06 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 14:42:06 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 41/6548 [00:00<00:16, 388.80 examples/s]
Map:   1%|▏         | 83/6548 [00:00<00:29, 219.20 examples/s]
Map:   2%|▏         | 125/6548 [00:00<00:23, 273.71 examples/s]
Map:   3%|▎         | 173/6548 [00:00<00:19, 332.32 examples/s]
Map:   3%|▎         | 213/6548 [00:00<00:17, 352.07 examples/s]
Map:   4%|▍         | 268/6548 [00:00<00:18, 345.76 examples/s]
Map:   5%|▍         | 308/6548 [00:01<00:20, 302.72 examples/s]
Map:   5%|▌         | 349/6548 [00:01<00:19, 326.24 examples/s]
Map:   6%|▌         | 384/6548 [00:01<00:18, 329.57 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:16, 361.32 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:17, 340.05 examples/s]
Map:   8%|▊         | 534/6548 [00:01<00:16, 363.22 examples/s]
Map:   9%|▉         | 575/6548 [00:01<00:15, 373.82 examples/s]
Map:   9%|▉         | 614/6548 [00:01<00:15, 375.98 examples/s]
Map:  10%|█         | 658/6548 [00:01<00:17, 333.17 examples/s]
Map:  11%|█         | 704/6548 [00:02<00:16, 363.71 examples/s]
Map:  12%|█▏        | 765/6548 [00:02<00:15, 372.38 examples/s]
Map:  12%|█▏        | 817/6548 [00:02<00:14, 402.02 examples/s]
Map:  13%|█▎        | 873/6548 [00:02<00:14, 387.99 examples/s]
Map:  14%|█▍        | 919/6548 [00:02<00:15, 358.28 examples/s]
Map:  15%|█▍        | 961/6548 [00:02<00:15, 370.39 examples/s]
Map:  15%|█▌        | 1000/6548 [00:03<00:25, 218.46 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:22, 244.46 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:20, 271.63 examples/s]
Map:  17%|█▋        | 1126/6548 [00:03<00:17, 315.55 examples/s]
Map:  18%|█▊        | 1167/6548 [00:03<00:15, 337.13 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 351.96 examples/s]
Map:  19%|█▉        | 1267/6548 [00:03<00:14, 364.94 examples/s]
Map:  20%|█▉        | 1306/6548 [00:03<00:14, 360.25 examples/s]
Map:  21%|██        | 1345/6548 [00:04<00:16, 315.65 examples/s]
Map:  21%|██        | 1385/6548 [00:04<00:17, 289.31 examples/s]
Map:  22%|██▏       | 1427/6548 [00:04<00:16, 317.37 examples/s]
Map:  22%|██▏       | 1461/6548 [00:04<00:18, 276.82 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:17, 288.34 examples/s]
Map:  24%|██▎       | 1550/6548 [00:04<00:18, 271.24 examples/s]
Map:  24%|██▍       | 1587/6548 [00:04<00:16, 292.43 examples/s]
Map:  25%|██▍       | 1621/6548 [00:05<00:18, 259.72 examples/s]
Map:  25%|██▌       | 1655/6548 [00:05<00:19, 246.81 examples/s]
Map:  26%|██▌       | 1691/6548 [00:05<00:17, 271.56 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:16, 285.38 examples/s]
Map:  27%|██▋       | 1769/6548 [00:05<00:15, 315.72 examples/s]
Map:  28%|██▊       | 1807/6548 [00:05<00:14, 330.37 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:15, 312.23 examples/s]
Map:  29%|██▉       | 1890/6548 [00:06<00:16, 287.49 examples/s]
Map:  29%|██▉       | 1921/6548 [00:06<00:16, 285.43 examples/s]
Map:  30%|██▉       | 1964/6548 [00:06<00:14, 320.93 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:21, 214.15 examples/s]
Map:  31%|███       | 2029/6548 [00:06<00:19, 226.52 examples/s]
Map:  32%|███▏      | 2065/6548 [00:06<00:17, 254.40 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 275.25 examples/s]
Map:  33%|███▎      | 2137/6548 [00:06<00:15, 285.45 examples/s]
Map:  33%|███▎      | 2181/6548 [00:07<00:16, 266.97 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 276.48 examples/s]
Map:  34%|███▍      | 2253/6548 [00:07<00:16, 261.68 examples/s]
Map:  35%|███▍      | 2286/6548 [00:07<00:16, 259.69 examples/s]
Map:  36%|███▌      | 2331/6548 [00:07<00:14, 298.06 examples/s]
Map:  36%|███▋      | 2382/6548 [00:07<00:13, 302.45 examples/s]
Map:  37%|███▋      | 2422/6548 [00:07<00:12, 324.05 examples/s]
Map:  38%|███▊      | 2457/6548 [00:08<00:13, 307.74 examples/s]
Map:  38%|███▊      | 2495/6548 [00:08<00:12, 314.77 examples/s]
Map:  39%|███▉      | 2550/6548 [00:08<00:12, 331.23 examples/s]
Map:  40%|███▉      | 2596/6548 [00:08<00:10, 361.23 examples/s]
Map:  40%|████      | 2638/6548 [00:08<00:10, 372.41 examples/s]
Map:  41%|████      | 2676/6548 [00:08<00:11, 341.46 examples/s]
Map:  41%|████▏     | 2715/6548 [00:08<00:10, 353.33 examples/s]
Map:  42%|████▏     | 2771/6548 [00:08<00:10, 345.58 examples/s]
Map:  43%|████▎     | 2811/6548 [00:09<00:12, 309.17 examples/s]
Map:  43%|████▎     | 2844/6548 [00:09<00:14, 261.96 examples/s]
Map:  44%|████▍     | 2880/6548 [00:09<00:13, 277.80 examples/s]
Map:  45%|████▍     | 2926/6548 [00:09<00:13, 275.03 examples/s]
Map:  45%|████▌     | 2966/6548 [00:09<00:11, 302.07 examples/s]
Map:  46%|████▌     | 3000/6548 [00:10<00:20, 173.57 examples/s]
Map:  46%|████▋     | 3042/6548 [00:10<00:17, 196.36 examples/s]
Map:  47%|████▋     | 3070/6548 [00:10<00:16, 208.59 examples/s]
Map:  47%|████▋     | 3099/6548 [00:10<00:15, 222.30 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 254.19 examples/s]
Map:  48%|████▊     | 3168/6548 [00:10<00:13, 243.74 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:14, 232.05 examples/s]
Map:  49%|████▉     | 3230/6548 [00:10<00:13, 237.77 examples/s]
Map:  50%|████▉     | 3269/6548 [00:11<00:12, 266.79 examples/s]
Map:  50%|█████     | 3300/6548 [00:11<00:11, 274.77 examples/s]
Map:  51%|█████     | 3342/6548 [00:11<00:10, 308.99 examples/s]
Map:  52%|█████▏    | 3378/6548 [00:11<00:09, 318.27 examples/s]
Map:  52%|█████▏    | 3412/6548 [00:11<00:11, 271.15 examples/s]
Map:  53%|█████▎    | 3450/6548 [00:11<00:10, 297.13 examples/s]
Map:  53%|█████▎    | 3486/6548 [00:11<00:11, 271.07 examples/s]
Map:  54%|█████▍    | 3533/6548 [00:11<00:09, 316.69 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:12<00:08, 344.93 examples/s]
Map:  55%|█████▌    | 3622/6548 [00:12<00:07, 369.54 examples/s]
Map:  56%|█████▌    | 3678/6548 [00:12<00:07, 366.50 examples/s]
Map:  57%|█████▋    | 3724/6548 [00:12<00:07, 386.65 examples/s]
Map:  58%|█████▊    | 3784/6548 [00:12<00:07, 387.87 examples/s]
Map:  59%|█████▊    | 3832/6548 [00:12<00:07, 341.45 examples/s]
Map:  59%|█████▉    | 3887/6548 [00:12<00:07, 341.59 examples/s]
Map:  60%|█████▉    | 3925/6548 [00:13<00:08, 325.87 examples/s]
Map:  61%|██████    | 3969/6548 [00:13<00:07, 351.18 examples/s]
Map:  62%|██████▏   | 4030/6548 [00:13<00:09, 261.47 examples/s]
Map:  62%|██████▏   | 4079/6548 [00:13<00:08, 301.84 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 323.47 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:07, 303.44 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:13<00:07, 312.42 examples/s]
Map:  65%|██████▌   | 4259/6548 [00:14<00:06, 347.48 examples/s]
Map:  66%|██████▌   | 4298/6548 [00:14<00:06, 348.97 examples/s]
Map:  66%|██████▋   | 4345/6548 [00:14<00:05, 378.79 examples/s]
Map:  67%|██████▋   | 4398/6548 [00:14<00:05, 369.23 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:05, 365.18 examples/s]
Map:  69%|██████▊   | 4498/6548 [00:14<00:06, 328.98 examples/s]
Map:  69%|██████▉   | 4546/6548 [00:14<00:06, 317.78 examples/s]
Map:  70%|███████   | 4584/6548 [00:15<00:06, 323.13 examples/s]
Map:  71%|███████   | 4633/6548 [00:15<00:05, 354.25 examples/s]
Map:  71%|███████▏  | 4670/6548 [00:15<00:05, 351.35 examples/s]
Map:  72%|███████▏  | 4711/6548 [00:15<00:05, 358.91 examples/s]
Map:  73%|███████▎  | 4750/6548 [00:15<00:04, 360.24 examples/s]
Map:  73%|███████▎  | 4807/6548 [00:15<00:04, 416.13 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 390.75 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 364.02 examples/s]
Map:  76%|███████▌  | 4957/6548 [00:15<00:03, 404.78 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:16<00:06, 241.51 examples/s]
Map:  77%|███████▋  | 5038/6548 [00:16<00:05, 265.11 examples/s]
Map:  78%|███████▊  | 5081/6548 [00:16<00:05, 264.47 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 273.17 examples/s]
Map:  79%|███████▊  | 5155/6548 [00:16<00:04, 287.74 examples/s]
Map:  79%|███████▉  | 5187/6548 [00:16<00:04, 287.43 examples/s]
Map:  80%|████████  | 5239/6548 [00:17<00:04, 302.76 examples/s]
Map:  81%|████████  | 5286/6548 [00:17<00:03, 326.53 examples/s]
Map:  81%|████████▏ | 5330/6548 [00:17<00:03, 313.73 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 302.31 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 296.22 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 327.31 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 321.49 examples/s]
Map:  85%|████████▍ | 5541/6548 [00:18<00:03, 331.99 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:18<00:03, 302.25 examples/s]
Map:  86%|████████▌ | 5638/6548 [00:18<00:02, 351.03 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 308.28 examples/s]
Map:  87%|████████▋ | 5721/6548 [00:18<00:02, 327.36 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 342.94 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 347.14 examples/s]
Map:  89%|████████▉ | 5846/6548 [00:18<00:01, 351.65 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:19<00:01, 354.78 examples/s]
Map:  90%|█████████ | 5922/6548 [00:19<00:01, 363.54 examples/s]
Map:  91%|█████████ | 5964/6548 [00:19<00:01, 329.25 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 203.79 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:02, 238.38 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 272.64 examples/s]
Map:  93%|█████████▎| 6118/6548 [00:20<00:01, 256.95 examples/s]
Map:  94%|█████████▍| 6154/6548 [00:20<00:01, 278.58 examples/s]
Map:  95%|█████████▍| 6206/6548 [00:20<00:01, 297.55 examples/s]
Map:  95%|█████████▌| 6248/6548 [00:20<00:00, 325.63 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 330.32 examples/s]
Map:  97%|█████████▋| 6362/6548 [00:20<00:00, 347.32 examples/s]
Map:  98%|█████████▊| 6399/6548 [00:20<00:00, 349.21 examples/s]
Map:  98%|█████████▊| 6444/6548 [00:20<00:00, 367.69 examples/s]
Map:  99%|█████████▉| 6493/6548 [00:21<00:00, 396.30 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 382.59 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 307.54 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 324.95 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 317.35 examples/s]
Map:  13%|█▎        | 118/903 [00:00<00:02, 304.76 examples/s]
Map:  18%|█▊        | 162/903 [00:00<00:02, 344.84 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 371.75 examples/s]
Map:  28%|██▊       | 250/903 [00:00<00:01, 378.94 examples/s]
Map:  34%|███▍      | 308/903 [00:00<00:01, 373.12 examples/s]
Map:  39%|███▉      | 354/903 [00:01<00:01, 342.93 examples/s]
Map:  43%|████▎     | 390/903 [00:01<00:01, 280.95 examples/s]
Map:  48%|████▊     | 433/903 [00:01<00:01, 313.66 examples/s]
Map:  52%|█████▏    | 472/903 [00:01<00:01, 294.20 examples/s]
Map:  56%|█████▋    | 508/903 [00:01<00:01, 296.90 examples/s]
Map:  62%|██████▏   | 557/903 [00:01<00:01, 336.44 examples/s]
Map:  67%|██████▋   | 603/903 [00:01<00:00, 366.32 examples/s]
Map:  73%|███████▎  | 655/903 [00:01<00:00, 355.54 examples/s]
Map:  77%|███████▋  | 696/903 [00:02<00:00, 355.37 examples/s]
Map:  83%|████████▎ | 754/903 [00:02<00:00, 363.30 examples/s]
Map:  89%|████████▉ | 805/903 [00:02<00:00, 347.92 examples/s]
Map:  95%|█████████▍| 854/903 [00:02<00:00, 376.68 examples/s]
Map:  99%|█████████▉| 898/903 [00:02<00:00, 332.69 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 312.69 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 301.79 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 346.24 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 343.28 examples/s]
Map:   8%|▊         | 156/1882 [00:00<00:04, 346.99 examples/s]
Map:  10%|█         | 192/1882 [00:00<00:04, 350.76 examples/s]
Map:  12%|█▏        | 233/1882 [00:00<00:04, 367.50 examples/s]
Map:  15%|█▍        | 278/1882 [00:00<00:04, 383.06 examples/s]
Map:  18%|█▊        | 334/1882 [00:00<00:04, 364.74 examples/s]
Map:  20%|█▉        | 376/1882 [00:01<00:04, 332.66 examples/s]
Map:  22%|██▏       | 414/1882 [00:01<00:04, 301.28 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 307.24 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 341.38 examples/s]
Map:  28%|██▊       | 536/1882 [00:01<00:04, 316.25 examples/s]
Map:  31%|███       | 576/1882 [00:01<00:03, 335.21 examples/s]
Map:  33%|███▎      | 625/1882 [00:01<00:03, 372.37 examples/s]
Map:  36%|███▌      | 678/1882 [00:01<00:03, 389.85 examples/s]
Map:  39%|███▉      | 734/1882 [00:02<00:03, 381.13 examples/s]
Map:  41%|████      | 773/1882 [00:02<00:03, 365.10 examples/s]
Map:  44%|████▍     | 826/1882 [00:02<00:02, 354.37 examples/s]
Map:  46%|████▌     | 862/1882 [00:02<00:02, 352.80 examples/s]
Map:  48%|████▊     | 901/1882 [00:02<00:02, 360.89 examples/s]
Map:  50%|█████     | 946/1882 [00:02<00:02, 381.91 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 389.30 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 245.71 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 260.35 examples/s]
Map:  59%|█████▉    | 1119/1882 [00:03<00:02, 271.81 examples/s]
Map:  62%|██████▏   | 1164/1882 [00:03<00:02, 276.40 examples/s]
Map:  64%|██████▍   | 1203/1882 [00:03<00:02, 258.25 examples/s]
Map:  66%|██████▌   | 1244/1882 [00:03<00:02, 286.37 examples/s]
Map:  68%|██████▊   | 1282/1882 [00:03<00:01, 306.37 examples/s]
Map:  71%|███████   | 1334/1882 [00:04<00:01, 348.00 examples/s]
Map:  73%|███████▎  | 1381/1882 [00:04<00:01, 328.46 examples/s]
Map:  75%|███████▌  | 1417/1882 [00:04<00:01, 286.91 examples/s]
Map:  77%|███████▋  | 1457/1882 [00:04<00:01, 308.87 examples/s]
Map:  79%|███████▉  | 1493/1882 [00:04<00:01, 272.07 examples/s]
Map:  81%|████████  | 1524/1882 [00:04<00:01, 271.96 examples/s]
Map:  83%|████████▎ | 1553/1882 [00:04<00:01, 270.42 examples/s]
Map:  85%|████████▌ | 1604/1882 [00:04<00:00, 328.64 examples/s]
Map:  87%|████████▋ | 1639/1882 [00:05<00:00, 330.48 examples/s]
Map:  90%|█████████ | 1694/1882 [00:05<00:00, 333.66 examples/s]
Map:  92%|█████████▏| 1729/1882 [00:05<00:00, 333.55 examples/s]
Map:  94%|█████████▍| 1765/1882 [00:05<00:00, 277.49 examples/s]
Map:  96%|█████████▌| 1798/1882 [00:05<00:00, 285.14 examples/s]
Map:  98%|█████████▊| 1843/1882 [00:05<00:00, 319.27 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 224.23 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 310.57 examples/s]
10/12/2024 14:43:08 - INFO - __main__ -     ***** Testing *****
10/12/2024 14:43:08 - INFO - __main__ -     Batch size = 8
10/12/2024 14:43:08 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 14:43:09 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 14:43:09 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 14:43:10 - INFO - knnlm -   Reading datastore took 0.973046064376831 s
10/12/2024 14:43:11 - INFO - knnlm -   Moving index to GPU took 0.9035155773162842 s
10/12/2024 14:43:11 - INFO - __main__ -   ******************************break-into
10/12/2024 14:43:11 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 14:43:11 - INFO - __main__ -     Num examples = 236
10/12/2024 14:43:11 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<32:03,  8.18s/it]
test ppl:   1%|          | 2/236 [00:10<17:41,  4.53s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:17,  3.16s/it]
test ppl:   2%|▏         | 4/236 [00:13<09:57,  2.58s/it]
test ppl:   2%|▏         | 5/236 [00:19<14:40,  3.81s/it]
test ppl:   3%|▎         | 6/236 [00:21<12:47,  3.34s/it]
test ppl:   3%|▎         | 7/236 [00:24<11:50,  3.10s/it]
test ppl:   3%|▎         | 8/236 [00:28<13:19,  3.50s/it]
test ppl:   4%|▍         | 9/236 [00:34<16:15,  4.30s/it]
test ppl:   4%|▍         | 10/236 [00:37<14:40,  3.90s/it]
test ppl:   5%|▍         | 11/236 [00:40<12:55,  3.45s/it]
test ppl:   5%|▌         | 12/236 [00:46<15:45,  4.22s/it]
test ppl:   6%|▌         | 13/236 [00:52<17:40,  4.76s/it]
test ppl:   6%|▌         | 14/236 [00:58<19:04,  5.16s/it]
test ppl:   6%|▋         | 15/236 [01:01<16:21,  4.44s/it]
test ppl:   7%|▋         | 16/236 [01:02<13:28,  3.68s/it]
test ppl:   7%|▋         | 17/236 [01:09<16:11,  4.43s/it]
test ppl:   8%|▊         | 18/236 [01:10<13:10,  3.63s/it]
test ppl:   8%|▊         | 19/236 [01:15<14:31,  4.01s/it]
test ppl:   8%|▊         | 20/236 [01:17<12:05,  3.36s/it]
test ppl:   9%|▉         | 21/236 [01:20<11:02,  3.08s/it]
test ppl:   9%|▉         | 22/236 [01:26<14:09,  3.97s/it]
test ppl:  10%|▉         | 23/236 [01:28<12:39,  3.57s/it]
test ppl:  10%|█         | 24/236 [01:31<11:23,  3.23s/it]
test ppl:  11%|█         | 25/236 [01:33<09:56,  2.83s/it]
test ppl:  11%|█         | 26/236 [01:39<13:15,  3.79s/it]
test ppl:  11%|█▏        | 27/236 [01:43<13:41,  3.93s/it]
test ppl:  12%|█▏        | 28/236 [01:44<10:48,  3.12s/it]
test ppl:  12%|█▏        | 29/236 [01:47<10:00,  2.90s/it]
test ppl:  13%|█▎        | 30/236 [01:48<08:34,  2.50s/it]
test ppl:  13%|█▎        | 31/236 [01:50<08:03,  2.36s/it]
test ppl:  14%|█▎        | 32/236 [01:53<08:35,  2.53s/it]
test ppl:  14%|█▍        | 33/236 [01:59<12:05,  3.57s/it]
test ppl:  14%|█▍        | 34/236 [02:03<12:32,  3.72s/it]
test ppl:  15%|█▍        | 35/236 [02:06<11:18,  3.38s/it]
test ppl:  15%|█▌        | 36/236 [02:12<13:51,  4.16s/it]
test ppl:  16%|█▌        | 37/236 [02:18<15:34,  4.70s/it]
test ppl:  16%|█▌        | 38/236 [02:20<12:54,  3.91s/it]
test ppl:  17%|█▋        | 39/236 [02:21<10:29,  3.19s/it]
test ppl:  17%|█▋        | 40/236 [02:24<09:57,  3.05s/it]
test ppl:  17%|█▋        | 41/236 [02:26<09:24,  2.89s/it]
test ppl:  18%|█▊        | 42/236 [02:32<12:19,  3.81s/it]
test ppl:  18%|█▊        | 43/236 [02:38<14:18,  4.45s/it]
test ppl:  19%|█▊        | 44/236 [02:41<12:11,  3.81s/it]
test ppl:  19%|█▉        | 45/236 [02:43<10:23,  3.27s/it]
test ppl:  19%|█▉        | 46/236 [02:49<12:55,  4.08s/it]
test ppl:  20%|█▉        | 47/236 [02:55<14:37,  4.65s/it]
test ppl:  20%|██        | 48/236 [03:00<15:43,  5.02s/it]
test ppl:  21%|██        | 49/236 [03:07<16:35,  5.32s/it]
test ppl:  21%|██        | 50/236 [03:12<17:05,  5.52s/it]
test ppl:  22%|██▏       | 51/236 [03:18<17:22,  5.63s/it]
test ppl:  22%|██▏       | 52/236 [03:25<18:07,  5.91s/it]
test ppl:  22%|██▏       | 53/236 [03:30<17:25,  5.71s/it]
test ppl:  23%|██▎       | 54/236 [03:32<13:47,  4.55s/it]
test ppl:  23%|██▎       | 55/236 [03:39<15:42,  5.20s/it]
test ppl:  24%|██▎       | 56/236 [03:43<14:35,  4.86s/it]
test ppl:  24%|██▍       | 57/236 [03:46<12:53,  4.32s/it]
test ppl:  25%|██▍       | 58/236 [03:48<10:37,  3.58s/it]
test ppl:  25%|██▌       | 59/236 [03:55<13:36,  4.61s/it]
test ppl:  25%|██▌       | 60/236 [03:59<12:51,  4.38s/it]
test ppl:  26%|██▌       | 61/236 [04:06<15:05,  5.17s/it]
test ppl:  26%|██▋       | 62/236 [04:11<14:47,  5.10s/it]
test ppl:  27%|██▋       | 63/236 [04:14<12:51,  4.46s/it]
test ppl:  27%|██▋       | 64/236 [04:15<10:30,  3.66s/it]
test ppl:  28%|██▊       | 65/236 [04:17<08:39,  3.04s/it]
test ppl:  28%|██▊       | 66/236 [04:20<09:02,  3.19s/it]
test ppl:  28%|██▊       | 67/236 [04:25<10:20,  3.67s/it]
test ppl:  29%|██▉       | 68/236 [04:32<13:07,  4.68s/it]
test ppl:  29%|██▉       | 69/236 [04:38<13:42,  4.92s/it]
test ppl:  30%|██▉       | 70/236 [04:40<11:07,  4.02s/it]
test ppl:  30%|███       | 71/236 [04:44<11:17,  4.11s/it]
test ppl:  31%|███       | 72/236 [04:49<11:35,  4.24s/it]
test ppl:  31%|███       | 73/236 [04:53<11:49,  4.35s/it]
test ppl:  31%|███▏      | 74/236 [04:55<09:41,  3.59s/it]
test ppl:  32%|███▏      | 75/236 [05:02<12:23,  4.62s/it]
test ppl:  32%|███▏      | 76/236 [05:07<12:51,  4.82s/it]
test ppl:  33%|███▎      | 77/236 [05:10<11:06,  4.19s/it]
test ppl:  33%|███▎      | 78/236 [05:12<09:31,  3.62s/it]
test ppl:  33%|███▎      | 79/236 [05:18<11:20,  4.33s/it]
test ppl:  34%|███▍      | 80/236 [05:21<09:40,  3.72s/it]
test ppl:  34%|███▍      | 81/236 [05:28<12:09,  4.71s/it]
test ppl:  35%|███▍      | 82/236 [05:35<13:53,  5.41s/it]
test ppl:  35%|███▌      | 83/236 [05:37<11:29,  4.51s/it]
test ppl:  36%|███▌      | 84/236 [05:39<09:42,  3.83s/it]
test ppl:  36%|███▌      | 85/236 [05:44<10:28,  4.16s/it]
test ppl:  36%|███▋      | 86/236 [05:47<09:14,  3.70s/it]
test ppl:  37%|███▋      | 87/236 [05:49<08:17,  3.34s/it]
test ppl:  37%|███▋      | 88/236 [05:56<10:57,  4.44s/it]
test ppl:  38%|███▊      | 89/236 [06:03<12:46,  5.22s/it]
test ppl:  38%|███▊      | 90/236 [06:10<14:00,  5.76s/it]
test ppl:  39%|███▊      | 91/236 [06:17<14:48,  6.13s/it]
test ppl:  39%|███▉      | 92/236 [06:21<12:42,  5.29s/it]
test ppl:  39%|███▉      | 93/236 [06:28<13:50,  5.81s/it]
test ppl:  40%|███▉      | 94/236 [06:35<14:36,  6.17s/it]
test ppl:  40%|████      | 95/236 [06:37<12:01,  5.11s/it]
test ppl:  41%|████      | 96/236 [06:41<10:49,  4.64s/it]
test ppl:  41%|████      | 97/236 [06:48<12:23,  5.35s/it]
test ppl:  42%|████▏     | 98/236 [06:55<13:27,  5.85s/it]
test ppl:  42%|████▏     | 99/236 [07:02<14:10,  6.21s/it]
test ppl:  42%|████▏     | 100/236 [07:04<10:55,  4.82s/it]
test ppl:  43%|████▎     | 101/236 [07:11<12:20,  5.48s/it]
test ppl:  43%|████▎     | 102/236 [07:15<11:28,  5.14s/it]
test ppl:  44%|████▎     | 103/236 [07:17<09:38,  4.35s/it]
test ppl:  44%|████▍     | 104/236 [07:23<10:03,  4.57s/it]
test ppl:  44%|████▍     | 105/236 [07:27<10:03,  4.60s/it]
test ppl:  45%|████▍     | 106/236 [07:34<11:10,  5.16s/it]
test ppl:  45%|████▌     | 107/236 [07:36<09:20,  4.34s/it]
test ppl:  46%|████▌     | 108/236 [07:43<10:51,  5.09s/it]
test ppl:  46%|████▌     | 109/236 [07:49<11:05,  5.24s/it]
test ppl:  47%|████▋     | 110/236 [07:51<09:03,  4.31s/it]
test ppl:  47%|████▋     | 111/236 [07:55<09:13,  4.43s/it]
test ppl:  47%|████▋     | 112/236 [08:00<09:31,  4.61s/it]
test ppl:  48%|████▊     | 113/236 [08:03<07:54,  3.86s/it]
test ppl:  48%|████▊     | 114/236 [08:07<07:55,  3.90s/it]
test ppl:  49%|████▊     | 115/236 [08:14<09:44,  4.83s/it]
test ppl:  49%|████▉     | 116/236 [08:20<10:44,  5.37s/it]
test ppl:  50%|████▉     | 117/236 [08:22<08:46,  4.42s/it]
test ppl:  50%|█████     | 118/236 [08:28<09:11,  4.67s/it]
test ppl:  50%|█████     | 119/236 [08:32<08:41,  4.45s/it]
test ppl:  51%|█████     | 120/236 [08:33<06:56,  3.59s/it]
test ppl:  51%|█████▏    | 121/236 [08:40<08:51,  4.62s/it]
test ppl:  52%|█████▏    | 122/236 [08:46<09:24,  4.95s/it]
test ppl:  52%|█████▏    | 123/236 [08:48<07:58,  4.24s/it]
test ppl:  53%|█████▎    | 124/236 [08:52<07:22,  3.96s/it]
test ppl:  53%|█████▎    | 125/236 [08:55<06:47,  3.67s/it]
test ppl:  53%|█████▎    | 126/236 [09:01<07:57,  4.34s/it]
test ppl:  54%|█████▍    | 127/236 [09:03<06:44,  3.71s/it]
test ppl:  54%|█████▍    | 128/236 [09:06<06:08,  3.41s/it]
test ppl:  55%|█████▍    | 129/236 [09:09<06:09,  3.45s/it]
test ppl:  55%|█████▌    | 130/236 [09:13<06:11,  3.50s/it]
test ppl:  56%|█████▌    | 131/236 [09:20<07:59,  4.57s/it]
test ppl:  56%|█████▌    | 132/236 [09:23<07:04,  4.08s/it]
test ppl:  56%|█████▋    | 133/236 [09:28<07:19,  4.26s/it]
test ppl:  57%|█████▋    | 134/236 [09:34<08:28,  4.98s/it]
test ppl:  57%|█████▋    | 135/236 [09:41<09:24,  5.59s/it]
test ppl:  58%|█████▊    | 136/236 [09:43<07:14,  4.35s/it]
test ppl:  58%|█████▊    | 137/236 [09:50<08:30,  5.16s/it]
test ppl:  58%|█████▊    | 138/236 [09:53<07:46,  4.76s/it]
test ppl:  59%|█████▉    | 139/236 [09:57<06:52,  4.25s/it]
test ppl:  59%|█████▉    | 140/236 [09:59<05:45,  3.60s/it]
test ppl:  60%|█████▉    | 141/236 [10:05<06:53,  4.35s/it]
test ppl:  60%|██████    | 142/236 [10:07<05:58,  3.81s/it]
test ppl:  61%|██████    | 143/236 [10:14<07:24,  4.78s/it]
test ppl:  61%|██████    | 144/236 [10:18<06:37,  4.33s/it]
test ppl:  61%|██████▏   | 145/236 [10:24<07:35,  5.00s/it]
test ppl:  62%|██████▏   | 146/236 [10:30<07:40,  5.12s/it]
test ppl:  62%|██████▏   | 147/236 [10:37<08:27,  5.70s/it]
test ppl:  63%|██████▎   | 148/236 [10:44<09:00,  6.14s/it]
test ppl:  63%|██████▎   | 149/236 [10:48<07:59,  5.51s/it]
test ppl:  64%|██████▎   | 150/236 [10:53<07:34,  5.28s/it]
test ppl:  64%|██████▍   | 151/236 [11:00<08:13,  5.81s/it]
test ppl:  64%|██████▍   | 152/236 [11:07<08:38,  6.17s/it]
test ppl:  65%|██████▍   | 153/236 [11:14<08:53,  6.43s/it]
test ppl:  65%|██████▌   | 154/236 [11:17<07:22,  5.40s/it]
test ppl:  66%|██████▌   | 155/236 [11:20<06:24,  4.75s/it]
test ppl:  66%|██████▌   | 156/236 [11:22<05:28,  4.10s/it]
test ppl:  67%|██████▋   | 157/236 [11:25<04:49,  3.66s/it]
test ppl:  67%|██████▋   | 158/236 [11:32<06:04,  4.68s/it]
test ppl:  67%|██████▋   | 159/236 [11:37<05:57,  4.64s/it]
test ppl:  68%|██████▊   | 160/236 [11:38<04:38,  3.67s/it]
test ppl:  68%|██████▊   | 161/236 [11:40<03:49,  3.06s/it]
test ppl:  69%|██████▊   | 162/236 [11:44<04:01,  3.27s/it]
test ppl:  69%|██████▉   | 163/236 [11:47<03:53,  3.20s/it]
test ppl:  69%|██████▉   | 164/236 [11:54<05:13,  4.36s/it]
test ppl:  70%|██████▉   | 165/236 [11:59<05:25,  4.59s/it]
test ppl:  70%|███████   | 166/236 [12:01<04:22,  3.75s/it]
test ppl:  71%|███████   | 167/236 [12:02<03:37,  3.15s/it]
test ppl:  71%|███████   | 168/236 [12:08<04:32,  4.01s/it]
test ppl:  72%|███████▏  | 169/236 [12:15<05:18,  4.76s/it]
test ppl:  72%|███████▏  | 170/236 [12:22<05:59,  5.45s/it]
test ppl:  72%|███████▏  | 171/236 [12:23<04:39,  4.30s/it]
test ppl:  73%|███████▎  | 172/236 [12:31<05:27,  5.12s/it]
test ppl:  73%|███████▎  | 173/236 [12:35<05:04,  4.84s/it]
test ppl:  74%|███████▎  | 174/236 [12:39<04:56,  4.79s/it]
test ppl:  74%|███████▍  | 175/236 [12:42<04:04,  4.01s/it]
test ppl:  75%|███████▍  | 176/236 [12:47<04:33,  4.57s/it]
test ppl:  75%|███████▌  | 177/236 [12:54<05:13,  5.31s/it]
test ppl:  75%|███████▌  | 178/236 [13:02<05:39,  5.85s/it]
test ppl:  76%|███████▌  | 179/236 [13:09<05:53,  6.21s/it]
test ppl:  76%|███████▋  | 180/236 [13:14<05:35,  6.00s/it]
test ppl:  77%|███████▋  | 181/236 [13:21<05:47,  6.31s/it]
test ppl:  77%|███████▋  | 182/236 [13:23<04:35,  5.10s/it]
test ppl:  78%|███████▊  | 183/236 [13:26<03:52,  4.39s/it]
test ppl:  78%|███████▊  | 184/236 [13:28<03:06,  3.59s/it]
test ppl:  78%|███████▊  | 185/236 [13:33<03:28,  4.09s/it]
test ppl:  79%|███████▉  | 186/236 [13:40<04:08,  4.97s/it]
test ppl:  79%|███████▉  | 187/236 [13:47<04:35,  5.62s/it]
test ppl:  80%|███████▉  | 188/236 [13:54<04:50,  6.06s/it]
test ppl:  80%|████████  | 189/236 [14:01<04:58,  6.35s/it]
test ppl:  81%|████████  | 190/236 [14:06<04:25,  5.77s/it]
test ppl:  81%|████████  | 191/236 [14:11<04:12,  5.61s/it]
test ppl:  81%|████████▏ | 192/236 [14:14<03:34,  4.87s/it]
test ppl:  82%|████████▏ | 193/236 [14:21<03:58,  5.54s/it]
test ppl:  82%|████████▏ | 194/236 [14:25<03:22,  4.82s/it]
test ppl:  83%|████████▎ | 195/236 [14:28<03:03,  4.48s/it]
test ppl:  83%|████████▎ | 196/236 [14:31<02:34,  3.86s/it]
test ppl:  83%|████████▎ | 197/236 [14:33<02:15,  3.47s/it]
test ppl:  84%|████████▍ | 198/236 [14:40<02:52,  4.54s/it]
test ppl:  84%|████████▍ | 199/236 [14:43<02:33,  4.15s/it]
test ppl:  85%|████████▍ | 200/236 [14:50<03:00,  5.02s/it]
test ppl:  85%|████████▌ | 201/236 [14:53<02:28,  4.24s/it]
test ppl:  86%|████████▌ | 202/236 [14:58<02:37,  4.63s/it]
test ppl:  86%|████████▌ | 203/236 [15:06<02:56,  5.36s/it]
test ppl:  86%|████████▋ | 204/236 [15:07<02:16,  4.28s/it]
test ppl:  87%|████████▋ | 205/236 [15:14<02:38,  5.12s/it]
test ppl:  87%|████████▋ | 206/236 [15:18<02:23,  4.77s/it]
test ppl:  88%|████████▊ | 207/236 [15:25<02:38,  5.45s/it]
test ppl:  88%|████████▊ | 208/236 [15:29<02:18,  4.95s/it]
test ppl:  89%|████████▊ | 209/236 [15:36<02:31,  5.60s/it]
test ppl:  89%|████████▉ | 210/236 [15:39<02:03,  4.76s/it]
test ppl:  89%|████████▉ | 211/236 [15:45<02:06,  5.06s/it]
test ppl:  90%|████████▉ | 212/236 [15:51<02:09,  5.40s/it]
test ppl:  90%|█████████ | 213/236 [15:58<02:15,  5.89s/it]
test ppl:  91%|█████████ | 214/236 [16:00<01:43,  4.71s/it]
test ppl:  91%|█████████ | 215/236 [16:07<01:53,  5.41s/it]
test ppl:  92%|█████████▏| 216/236 [16:10<01:34,  4.71s/it]
test ppl:  92%|█████████▏| 217/236 [16:17<01:43,  5.44s/it]
test ppl:  92%|█████████▏| 218/236 [16:20<01:21,  4.51s/it]
test ppl:  93%|█████████▎| 219/236 [16:27<01:29,  5.28s/it]
test ppl:  93%|█████████▎| 220/236 [16:34<01:32,  5.80s/it]
test ppl:  94%|█████████▎| 221/236 [16:37<01:17,  5.17s/it]
test ppl:  94%|█████████▍| 222/236 [16:44<01:20,  5.75s/it]
test ppl:  94%|█████████▍| 223/236 [16:51<01:19,  6.13s/it]
test ppl:  95%|█████████▍| 224/236 [16:53<00:57,  4.76s/it]
test ppl:  95%|█████████▌| 225/236 [16:59<00:57,  5.26s/it]
test ppl:  96%|█████████▌| 226/236 [17:04<00:49,  4.96s/it]
test ppl:  96%|█████████▌| 227/236 [17:07<00:38,  4.33s/it]
test ppl:  97%|█████████▋| 228/236 [17:09<00:30,  3.75s/it]
test ppl:  97%|█████████▋| 229/236 [17:16<00:33,  4.73s/it]
test ppl:  97%|█████████▋| 230/236 [17:20<00:27,  4.57s/it]
test ppl:  98%|█████████▊| 231/236 [17:24<00:21,  4.40s/it]
test ppl:  98%|█████████▊| 232/236 [17:26<00:14,  3.71s/it]
test ppl:  99%|█████████▊| 233/236 [17:29<00:10,  3.37s/it]
test ppl:  99%|█████████▉| 234/236 [17:30<00:05,  2.79s/it]
test ppl: 100%|█████████▉| 235/236 [17:37<00:04,  4.06s/it]
test ppl: 100%|██████████| 236/236 [17:38<00:00,  3.07s/it]
test ppl: 100%|██████████| 236/236 [17:38<00:00,  4.49s/it]
10/12/2024 15:00:49 - INFO - __main__ -    em: 0.2099
10/12/2024 15:00:49 - INFO - __main__ -   Finish and take 19m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.2 50:  em: 0.2099

--------------------------------------------------------------------------------
Running experiment with knn_temp=50, lmbda=0.2, k=32
2024-10-12 15:00:56.877466: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 15:00:56.896884: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 15:00:56.918780: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 15:00:56.925382: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 15:00:56.941346: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 15:00:57.937747: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 15:00:59 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.2, knn_temp=50, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 15:00:59 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:33:02,  2.21it/s]
Adding feature api:   4%|▍         | 7097/187062 [00:00<00:10, 17007.39it/s]
Adding feature api:   8%|▊         | 15478/187062 [00:00<00:05, 34043.97it/s]
Adding feature api:  13%|█▎        | 23910/187062 [00:00<00:03, 47469.53it/s]
Adding feature api:  17%|█▋        | 32378/187062 [00:00<00:02, 57744.11it/s]
Adding feature api:  22%|██▏       | 40614/187062 [00:00<00:02, 64705.59it/s]
Adding feature api:  26%|██▌       | 49052/187062 [00:01<00:01, 70366.70it/s]
Adding feature api:  31%|███       | 57549/187062 [00:01<00:01, 74618.47it/s]
Adding feature api:  35%|███▌      | 65979/187062 [00:01<00:01, 77461.60it/s]
Adding feature api:  40%|███▉      | 74457/187062 [00:01<00:01, 79623.91it/s]
Adding feature api:  44%|████▍     | 82770/187062 [00:01<00:01, 80278.34it/s]
Adding feature api:  49%|████▉     | 91259/187062 [00:01<00:01, 81646.59it/s]
Adding feature api:  53%|█████▎    | 99695/187062 [00:01<00:01, 82451.97it/s]
Adding feature api:  58%|█████▊    | 108151/187062 [00:01<00:00, 83078.05it/s]
Adding feature api:  62%|██████▏   | 116545/187062 [00:01<00:00, 82681.27it/s]
Adding feature api:  67%|██████▋   | 124984/187062 [00:01<00:00, 83187.30it/s]
Adding feature api:  71%|███████▏  | 133426/187062 [00:02<00:00, 83552.95it/s]
Adding feature api:  76%|███████▌  | 141880/187062 [00:02<00:00, 83847.13it/s]
Adding feature api:  80%|████████  | 150287/187062 [00:02<00:00, 83369.38it/s]
Adding feature api:  85%|████████▍ | 158719/187062 [00:02<00:00, 83649.59it/s]
Adding feature api:  89%|████████▉ | 167169/187062 [00:02<00:00, 83902.84it/s]
Adding feature api:  94%|█████████▍| 175590/187062 [00:02<00:00, 83992.32it/s]
Adding feature api:  98%|█████████▊| 183995/187062 [00:02<00:00, 57473.58it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64388.29it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:45:43,  2.19it/s]
Adding feature datatype:   4%|▍         | 7171/187062 [00:00<00:10, 17068.04it/s]
Adding feature datatype:   8%|▊         | 15319/187062 [00:00<00:05, 33411.77it/s]
Adding feature datatype:  12%|█▏        | 23262/187062 [00:00<00:03, 45567.87it/s]
Adding feature datatype:  17%|█▋        | 31480/187062 [00:00<00:02, 55635.70it/s]
Adding feature datatype:  21%|██        | 39690/187062 [00:00<00:02, 63097.98it/s]
Adding feature datatype:  26%|██▌       | 47903/187062 [00:01<00:02, 68562.09it/s]
Adding feature datatype:  30%|███       | 56137/187062 [00:01<00:01, 72568.80it/s]
Adding feature datatype:  34%|███▍      | 64377/187062 [00:01<00:01, 75452.50it/s]
Adding feature datatype:  39%|███▊      | 72408/187062 [00:01<00:01, 76565.77it/s]
Adding feature datatype:  43%|████▎     | 80634/187062 [00:01<00:01, 78249.84it/s]
Adding feature datatype:  48%|████▊     | 88894/187062 [00:01<00:01, 79541.53it/s]
Adding feature datatype:  52%|█████▏    | 97094/187062 [00:01<00:01, 80272.16it/s]
Adding feature datatype:  56%|█████▋    | 105342/187062 [00:01<00:01, 80930.90it/s]
Adding feature datatype:  61%|██████    | 113616/187062 [00:01<00:00, 81471.10it/s]
Adding feature datatype:  65%|██████▌   | 121823/187062 [00:01<00:00, 80800.15it/s]
Adding feature datatype:  70%|██████▉   | 130084/187062 [00:02<00:00, 81337.70it/s]
Adding feature datatype:  74%|███████▍  | 138330/187062 [00:02<00:00, 81671.49it/s]
Adding feature datatype:  78%|███████▊  | 146564/187062 [00:02<00:00, 81870.36it/s]
Adding feature datatype:  83%|████████▎ | 154836/187062 [00:02<00:00, 82122.09it/s]
Adding feature datatype:  87%|████████▋ | 163060/187062 [00:02<00:00, 81279.62it/s]
Adding feature datatype:  92%|█████████▏| 171328/187062 [00:02<00:00, 81695.27it/s]
Adding feature datatype:  96%|█████████▌| 179505/187062 [00:02<00:00, 72867.61it/s]
Adding feature datatype: 100%|█████████▉| 186972/187062 [00:02<00:00, 51736.87it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63136.06it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:32:15,  2.21it/s]
Adding feature literal:   4%|▍         | 7073/187062 [00:00<00:10, 16956.99it/s]
Adding feature literal:   8%|▊         | 15181/187062 [00:00<00:05, 33316.02it/s]
Adding feature literal:  12%|█▏        | 23355/187062 [00:00<00:03, 46249.44it/s]
Adding feature literal:  17%|█▋        | 31492/187062 [00:00<00:02, 55947.59it/s]
Adding feature literal:  21%|██        | 39680/187062 [00:00<00:02, 63282.97it/s]
Adding feature literal:  26%|██▌       | 47804/187062 [00:01<00:02, 68448.86it/s]
Adding feature literal:  30%|██▉       | 56019/187062 [00:01<00:01, 72440.26it/s]
Adding feature literal:  34%|███▍      | 64207/187062 [00:01<00:01, 75213.65it/s]
Adding feature literal:  39%|███▊      | 72373/187062 [00:01<00:01, 77118.74it/s]
Adding feature literal:  43%|████▎     | 80549/187062 [00:01<00:01, 78496.22it/s]
Adding feature literal:  47%|████▋     | 88639/187062 [00:01<00:01, 77396.94it/s]
Adding feature literal:  52%|█████▏    | 96549/187062 [00:01<00:01, 75867.36it/s]
Adding feature literal:  56%|█████▌    | 104259/187062 [00:01<00:01, 75511.93it/s]
Adding feature literal:  60%|██████    | 112412/187062 [00:01<00:00, 77260.95it/s]
Adding feature literal:  64%|██████▍   | 120614/187062 [00:01<00:00, 78655.57it/s]
Adding feature literal:  69%|██████▉   | 128794/187062 [00:02<00:00, 79582.46it/s]
Adding feature literal:  73%|███████▎  | 136953/187062 [00:02<00:00, 80176.77it/s]
Adding feature literal:  78%|███████▊  | 145123/187062 [00:02<00:00, 80626.90it/s]
Adding feature literal:  82%|████████▏ | 153315/187062 [00:02<00:00, 81012.37it/s]
Adding feature literal:  86%|████████▋ | 161527/187062 [00:02<00:00, 81342.94it/s]
Adding feature literal:  91%|█████████ | 169671/187062 [00:02<00:00, 81350.07it/s]
Adding feature literal:  95%|█████████▌| 177813/187062 [00:02<00:00, 80903.47it/s]
Adding feature literal:  99%|█████████▉| 185909/187062 [00:02<00:00, 52614.51it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 62504.94it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:37:27,  2.20it/s]
Adding feature operator:   4%|▍         | 7159/187062 [00:00<00:10, 17115.23it/s]
Adding feature operator:   8%|▊         | 15322/187062 [00:00<00:05, 33539.04it/s]
Adding feature operator:  13%|█▎        | 23385/187062 [00:00<00:03, 46097.19it/s]
Adding feature operator:  17%|█▋        | 31579/187062 [00:00<00:02, 55983.58it/s]
Adding feature operator:  21%|██▏       | 39767/187062 [00:00<00:02, 63303.33it/s]
Adding feature operator:  26%|██▌       | 47947/187062 [00:01<00:02, 68623.16it/s]
Adding feature operator:  30%|███       | 56139/187062 [00:01<00:01, 72493.46it/s]
Adding feature operator:  34%|███▍      | 64339/187062 [00:01<00:01, 75284.67it/s]
Adding feature operator:  39%|███▉      | 72573/187062 [00:01<00:01, 77368.79it/s]
Adding feature operator:  43%|████▎     | 80769/187062 [00:01<00:01, 78728.90it/s]
Adding feature operator:  48%|████▊     | 88994/187062 [00:01<00:01, 79774.97it/s]
Adding feature operator:  52%|█████▏    | 97188/187062 [00:01<00:01, 80419.37it/s]
Adding feature operator:  56%|█████▋    | 105421/187062 [00:01<00:01, 80987.07it/s]
Adding feature operator:  61%|██████    | 113624/187062 [00:01<00:00, 81298.19it/s]
Adding feature operator:  65%|██████▌   | 121868/187062 [00:01<00:00, 81637.46it/s]
Adding feature operator:  70%|██████▉   | 130092/187062 [00:02<00:00, 81817.26it/s]
Adding feature operator:  74%|███████▍  | 138324/187062 [00:02<00:00, 81966.09it/s]
Adding feature operator:  78%|███████▊  | 146568/187062 [00:02<00:00, 82105.85it/s]
Adding feature operator:  83%|████████▎ | 154793/187062 [00:02<00:00, 82147.92it/s]
Adding feature operator:  87%|████████▋ | 163018/187062 [00:02<00:00, 82106.58it/s]
Adding feature operator:  92%|█████████▏| 171250/187062 [00:02<00:00, 82167.35it/s]
Adding feature operator:  96%|█████████▌| 179472/187062 [00:02<00:00, 73098.12it/s]
Adding feature operator: 100%|█████████▉| 186971/187062 [00:02<00:00, 51700.10it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63327.98it/s]
[2024-10-12 15:01:43,051] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 15:01:44 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 15:01:44 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 415.14 examples/s]
Map:   2%|▏         | 108/6548 [00:00<00:25, 249.54 examples/s]
Map:   2%|▏         | 148/6548 [00:00<00:22, 283.67 examples/s]
Map:   3%|▎         | 186/6548 [00:00<00:20, 307.90 examples/s]
Map:   4%|▎         | 233/6548 [00:00<00:17, 352.78 examples/s]
Map:   4%|▍         | 288/6548 [00:00<00:18, 336.43 examples/s]
Map:   5%|▍         | 326/6548 [00:01<00:20, 302.53 examples/s]
Map:   6%|▌         | 362/6548 [00:01<00:20, 308.81 examples/s]
Map:   6%|▋         | 413/6548 [00:01<00:17, 357.27 examples/s]
Map:   7%|▋         | 454/6548 [00:01<00:17, 349.07 examples/s]
Map:   8%|▊         | 504/6548 [00:01<00:18, 330.77 examples/s]
Map:   9%|▊         | 558/6548 [00:01<00:15, 378.09 examples/s]
Map:   9%|▉         | 614/6548 [00:01<00:15, 374.05 examples/s]
Map:  10%|█         | 660/6548 [00:01<00:17, 338.11 examples/s]
Map:  11%|█         | 706/6548 [00:02<00:16, 360.85 examples/s]
Map:  11%|█▏        | 747/6548 [00:02<00:15, 368.47 examples/s]
Map:  12%|█▏        | 799/6548 [00:02<00:14, 406.05 examples/s]
Map:  13%|█▎        | 861/6548 [00:02<00:14, 405.19 examples/s]
Map:  14%|█▍        | 911/6548 [00:02<00:14, 377.29 examples/s]
Map:  15%|█▍        | 956/6548 [00:02<00:14, 382.99 examples/s]
Map:  15%|█▌        | 1000/6548 [00:03<00:23, 237.06 examples/s]
Map:  16%|█▌        | 1037/6548 [00:03<00:21, 259.18 examples/s]
Map:  16%|█▋        | 1073/6548 [00:03<00:19, 278.11 examples/s]
Map:  17%|█▋        | 1115/6548 [00:03<00:17, 306.27 examples/s]
Map:  18%|█▊        | 1156/6548 [00:03<00:16, 330.29 examples/s]
Map:  18%|█▊        | 1198/6548 [00:03<00:15, 351.99 examples/s]
Map:  19%|█▉        | 1238/6548 [00:03<00:14, 354.16 examples/s]
Map:  20%|█▉        | 1284/6548 [00:03<00:14, 375.33 examples/s]
Map:  20%|██        | 1328/6548 [00:03<00:15, 340.31 examples/s]
Map:  21%|██        | 1375/6548 [00:04<00:16, 317.37 examples/s]
Map:  22%|██▏       | 1430/6548 [00:04<00:15, 327.65 examples/s]
Map:  23%|██▎       | 1480/6548 [00:04<00:17, 296.28 examples/s]
Map:  23%|██▎       | 1515/6548 [00:04<00:16, 306.79 examples/s]
Map:  24%|██▍       | 1556/6548 [00:04<00:17, 280.74 examples/s]
Map:  24%|██▍       | 1588/6548 [00:04<00:17, 287.24 examples/s]
Map:  25%|██▍       | 1622/6548 [00:05<00:19, 254.73 examples/s]
Map:  25%|██▌       | 1655/6548 [00:05<00:18, 262.15 examples/s]
Map:  26%|██▌       | 1693/6548 [00:05<00:16, 289.31 examples/s]
Map:  26%|██▋       | 1731/6548 [00:05<00:15, 310.97 examples/s]
Map:  27%|██▋       | 1776/6548 [00:05<00:13, 343.31 examples/s]
Map:  28%|██▊       | 1812/6548 [00:05<00:13, 346.60 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 352.63 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 338.02 examples/s]
Map:  30%|██▉       | 1947/6548 [00:05<00:13, 353.57 examples/s]
Map:  30%|███       | 1991/6548 [00:06<00:12, 371.80 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:20, 223.70 examples/s]
Map:  32%|███▏      | 2070/6548 [00:06<00:17, 254.34 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 267.48 examples/s]
Map:  33%|███▎      | 2142/6548 [00:06<00:17, 250.32 examples/s]
Map:  33%|███▎      | 2180/6548 [00:06<00:16, 272.77 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 278.62 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:15, 284.04 examples/s]
Map:  35%|███▌      | 2292/6548 [00:07<00:14, 293.05 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:13, 317.93 examples/s]
Map:  36%|███▋      | 2376/6548 [00:07<00:13, 317.07 examples/s]
Map:  37%|███▋      | 2411/6548 [00:07<00:12, 324.13 examples/s]
Map:  38%|███▊      | 2460/6548 [00:07<00:12, 317.21 examples/s]
Map:  38%|███▊      | 2499/6548 [00:07<00:12, 333.86 examples/s]
Map:  39%|███▉      | 2559/6548 [00:08<00:11, 354.36 examples/s]
Map:  40%|███▉      | 2603/6548 [00:08<00:10, 374.75 examples/s]
Map:  40%|████      | 2646/6548 [00:08<00:10, 385.83 examples/s]
Map:  41%|████      | 2689/6548 [00:08<00:11, 339.18 examples/s]
Map:  42%|████▏     | 2745/6548 [00:08<00:11, 343.04 examples/s]
Map:  43%|████▎     | 2795/6548 [00:08<00:11, 338.38 examples/s]
Map:  43%|████▎     | 2841/6548 [00:09<00:14, 262.58 examples/s]
Map:  44%|████▍     | 2879/6548 [00:09<00:13, 281.60 examples/s]
Map:  45%|████▍     | 2923/6548 [00:09<00:14, 254.87 examples/s]
Map:  45%|████▌     | 2965/6548 [00:09<00:12, 283.38 examples/s]
Map:  46%|████▌     | 3000/6548 [00:09<00:21, 167.05 examples/s]
Map:  46%|████▌     | 3026/6548 [00:09<00:19, 179.80 examples/s]
Map:  47%|████▋     | 3061/6548 [00:10<00:16, 207.72 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:15, 220.78 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:12, 262.80 examples/s]
Map:  48%|████▊     | 3169/6548 [00:10<00:13, 250.89 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:14, 232.44 examples/s]
Map:  49%|████▉     | 3229/6548 [00:10<00:13, 237.94 examples/s]
Map:  50%|████▉     | 3268/6548 [00:10<00:12, 272.21 examples/s]
Map:  51%|█████     | 3322/6548 [00:11<00:10, 296.10 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:11<00:10, 297.10 examples/s]
Map:  52%|█████▏    | 3411/6548 [00:11<00:11, 280.89 examples/s]
Map:  53%|█████▎    | 3450/6548 [00:11<00:10, 303.06 examples/s]
Map:  53%|█████▎    | 3497/6548 [00:11<00:11, 273.16 examples/s]
Map:  54%|█████▍    | 3546/6548 [00:11<00:09, 316.76 examples/s]
Map:  55%|█████▍    | 3596/6548 [00:11<00:08, 354.93 examples/s]
Map:  56%|█████▌    | 3642/6548 [00:11<00:07, 369.51 examples/s]
Map:  56%|█████▋    | 3696/6548 [00:12<00:07, 357.04 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:12<00:07, 367.94 examples/s]
Map:  58%|█████▊    | 3792/6548 [00:12<00:07, 358.44 examples/s]
Map:  59%|█████▊    | 3839/6548 [00:12<00:08, 336.45 examples/s]
Map:  59%|█████▉    | 3879/6548 [00:12<00:08, 308.94 examples/s]
Map:  60%|█████▉    | 3916/6548 [00:12<00:08, 319.47 examples/s]
Map:  60%|██████    | 3952/6548 [00:12<00:08, 313.06 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 228.31 examples/s]
Map:  62%|██████▏   | 4050/6548 [00:13<00:08, 277.81 examples/s]
Map:  62%|██████▏   | 4091/6548 [00:13<00:08, 303.82 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 324.20 examples/s]
Map:  64%|██████▍   | 4194/6548 [00:13<00:07, 326.22 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:06, 332.61 examples/s]
Map:  65%|██████▌   | 4282/6548 [00:13<00:06, 358.40 examples/s]
Map:  66%|██████▌   | 4324/6548 [00:14<00:06, 368.06 examples/s]
Map:  67%|██████▋   | 4377/6548 [00:14<00:06, 361.58 examples/s]
Map:  68%|██████▊   | 4438/6548 [00:14<00:05, 375.72 examples/s]
Map:  69%|██████▊   | 4486/6548 [00:14<00:05, 353.77 examples/s]
Map:  69%|██████▉   | 4530/6548 [00:14<00:06, 326.87 examples/s]
Map:  70%|██████▉   | 4568/6548 [00:14<00:06, 326.11 examples/s]
Map:  70%|███████   | 4610/6548 [00:14<00:05, 327.62 examples/s]
Map:  71%|███████   | 4659/6548 [00:15<00:05, 365.43 examples/s]
Map:  72%|███████▏  | 4724/6548 [00:15<00:04, 373.41 examples/s]
Map:  73%|███████▎  | 4769/6548 [00:15<00:04, 386.42 examples/s]
Map:  74%|███████▎  | 4821/6548 [00:15<00:04, 417.74 examples/s]
Map:  74%|███████▍  | 4876/6548 [00:15<00:04, 370.32 examples/s]
Map:  75%|███████▌  | 4915/6548 [00:15<00:04, 372.49 examples/s]
Map:  76%|███████▌  | 4970/6548 [00:15<00:03, 414.78 examples/s]
Map:  77%|███████▋  | 5041/6548 [00:16<00:05, 254.72 examples/s]
Map:  78%|███████▊  | 5076/6548 [00:16<00:05, 267.63 examples/s]
Map:  78%|███████▊  | 5120/6548 [00:16<00:05, 272.56 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 283.22 examples/s]
Map:  79%|███████▉  | 5204/6548 [00:16<00:04, 287.43 examples/s]
Map:  80%|████████  | 5256/6548 [00:16<00:04, 286.26 examples/s]
Map:  81%|████████  | 5312/6548 [00:17<00:03, 340.84 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 305.89 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 299.80 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 326.88 examples/s]
Map:  84%|████████▍ | 5502/6548 [00:17<00:03, 325.40 examples/s]
Map:  85%|████████▍ | 5540/6548 [00:17<00:02, 336.50 examples/s]
Map:  85%|████████▌ | 5582/6548 [00:17<00:03, 305.89 examples/s]
Map:  86%|████████▌ | 5632/6548 [00:18<00:02, 344.04 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 311.04 examples/s]
Map:  87%|████████▋ | 5721/6548 [00:18<00:02, 329.91 examples/s]
Map:  88%|████████▊ | 5762/6548 [00:18<00:02, 347.00 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 351.04 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:01, 357.76 examples/s]
Map:  90%|████████▉ | 5889/6548 [00:18<00:01, 367.07 examples/s]
Map:  91%|█████████ | 5927/6548 [00:18<00:01, 369.92 examples/s]
Map:  91%|█████████ | 5972/6548 [00:19<00:01, 343.73 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 230.46 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 262.18 examples/s]
Map:  93%|█████████▎| 6119/6548 [00:19<00:01, 252.77 examples/s]
Map:  94%|█████████▍| 6154/6548 [00:19<00:01, 270.52 examples/s]
Map:  95%|█████████▍| 6190/6548 [00:19<00:01, 286.16 examples/s]
Map:  95%|█████████▌| 6234/6548 [00:20<00:00, 319.83 examples/s]
Map:  96%|█████████▌| 6271/6548 [00:20<00:00, 324.18 examples/s]
Map:  96%|█████████▋| 6310/6548 [00:20<00:00, 336.01 examples/s]
Map:  97%|█████████▋| 6365/6548 [00:20<00:00, 376.38 examples/s]
Map:  98%|█████████▊| 6418/6548 [00:20<00:00, 359.48 examples/s]
Map:  99%|█████████▉| 6468/6548 [00:20<00:00, 390.58 examples/s]
Map: 100%|█████████▉| 6524/6548 [00:20<00:00, 377.72 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 311.40 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▎         | 32/903 [00:00<00:02, 311.32 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 332.24 examples/s]
Map:  13%|█▎        | 118/903 [00:00<00:02, 307.97 examples/s]
Map:  18%|█▊        | 159/903 [00:00<00:02, 339.79 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 389.65 examples/s]
Map:  29%|██▉       | 263/903 [00:00<00:01, 366.73 examples/s]
Map:  34%|███▍      | 307/903 [00:00<00:01, 380.13 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 329.93 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 314.49 examples/s]
Map:  50%|█████     | 456/903 [00:01<00:01, 304.70 examples/s]
Map:  54%|█████▍    | 488/903 [00:01<00:01, 303.18 examples/s]
Map:  59%|█████▉    | 537/903 [00:01<00:01, 341.21 examples/s]
Map:  64%|██████▍   | 579/903 [00:01<00:00, 352.34 examples/s]
Map:  70%|███████   | 633/903 [00:01<00:00, 352.56 examples/s]
Map:  74%|███████▍  | 672/903 [00:01<00:00, 357.94 examples/s]
Map:  79%|███████▊  | 709/903 [00:02<00:00, 348.84 examples/s]
Map:  85%|████████▍ | 766/903 [00:02<00:00, 388.63 examples/s]
Map:  89%|████████▉ | 806/903 [00:02<00:00, 382.51 examples/s]
Map:  95%|█████████▍| 854/903 [00:02<00:00, 404.51 examples/s]
Map:  99%|█████████▉| 898/903 [00:02<00:00, 346.43 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 322.90 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 35/1882 [00:00<00:06, 273.72 examples/s]
Map:   4%|▍         | 74/1882 [00:00<00:05, 328.04 examples/s]
Map:   6%|▋         | 120/1882 [00:00<00:05, 311.69 examples/s]
Map:   9%|▊         | 160/1882 [00:00<00:05, 339.05 examples/s]
Map:  10%|█         | 197/1882 [00:00<00:04, 347.22 examples/s]
Map:  13%|█▎        | 238/1882 [00:00<00:04, 364.43 examples/s]
Map:  15%|█▍        | 280/1882 [00:00<00:04, 372.61 examples/s]
Map:  18%|█▊        | 334/1882 [00:00<00:04, 358.50 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:04, 313.85 examples/s]
Map:  22%|██▏       | 414/1882 [00:01<00:05, 283.70 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 292.55 examples/s]
Map:  26%|██▌       | 489/1882 [00:01<00:04, 315.46 examples/s]
Map:  29%|██▊       | 538/1882 [00:01<00:04, 302.64 examples/s]
Map:  31%|███       | 580/1882 [00:01<00:03, 329.21 examples/s]
Map:  34%|███▍      | 638/1882 [00:01<00:03, 388.86 examples/s]
Map:  37%|███▋      | 696/1882 [00:02<00:03, 379.73 examples/s]
Map:  40%|████      | 760/1882 [00:02<00:02, 390.32 examples/s]
Map:  43%|████▎     | 805/1882 [00:02<00:03, 341.09 examples/s]
Map:  45%|████▍     | 844/1882 [00:02<00:02, 346.14 examples/s]
Map:  48%|████▊     | 897/1882 [00:02<00:02, 343.87 examples/s]
Map:  50%|████▉     | 940/1882 [00:02<00:02, 362.21 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 375.35 examples/s]
Map:  55%|█████▌    | 1036/1882 [00:03<00:03, 238.04 examples/s]
Map:  57%|█████▋    | 1069/1882 [00:03<00:03, 246.10 examples/s]
Map:  59%|█████▉    | 1116/1882 [00:03<00:02, 262.14 examples/s]
Map:  61%|██████    | 1147/1882 [00:03<00:02, 268.28 examples/s]
Map:  63%|██████▎   | 1177/1882 [00:03<00:02, 270.80 examples/s]
Map:  65%|██████▍   | 1214/1882 [00:03<00:02, 286.79 examples/s]
Map:  67%|██████▋   | 1255/1882 [00:03<00:01, 316.36 examples/s]
Map:  69%|██████▉   | 1296/1882 [00:04<00:01, 340.75 examples/s]
Map:  71%|███████   | 1340/1882 [00:04<00:01, 365.03 examples/s]
Map:  74%|███████▎  | 1385/1882 [00:04<00:01, 337.77 examples/s]
Map:  76%|███████▌  | 1425/1882 [00:04<00:01, 312.20 examples/s]
Map:  78%|███████▊  | 1471/1882 [00:04<00:01, 307.57 examples/s]
Map:  80%|████████  | 1511/1882 [00:04<00:01, 263.04 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 273.48 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:05<00:01, 298.98 examples/s]
Map:  86%|████████▌ | 1621/1882 [00:05<00:00, 318.31 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 322.87 examples/s]
Map:  91%|█████████ | 1711/1882 [00:05<00:00, 327.80 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 278.15 examples/s]
Map:  96%|█████████▌| 1799/1882 [00:05<00:00, 283.62 examples/s]
Map:  98%|█████████▊| 1844/1882 [00:05<00:00, 317.13 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 230.46 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 306.45 examples/s]
10/12/2024 15:02:46 - INFO - __main__ -     ***** Testing *****
10/12/2024 15:02:46 - INFO - __main__ -     Batch size = 8
10/12/2024 15:02:46 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 15:02:47 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 15:02:47 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 15:02:48 - INFO - knnlm -   Reading datastore took 0.9583075046539307 s
10/12/2024 15:02:49 - INFO - knnlm -   Moving index to GPU took 0.9819402694702148 s
10/12/2024 15:02:49 - INFO - __main__ -   ******************************break-into
10/12/2024 15:02:49 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 15:02:49 - INFO - __main__ -     Num examples = 236
10/12/2024 15:02:49 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:38,  7.82s/it]
test ppl:   1%|          | 2/236 [00:09<17:00,  4.36s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:51,  3.05s/it]
test ppl:   2%|▏         | 4/236 [00:12<09:39,  2.50s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:15,  3.70s/it]
test ppl:   3%|▎         | 6/236 [00:21<12:21,  3.23s/it]
test ppl:   3%|▎         | 7/236 [00:23<11:25,  3.00s/it]
test ppl:   3%|▎         | 8/236 [00:27<12:55,  3.40s/it]
test ppl:   4%|▍         | 9/236 [00:33<15:47,  4.17s/it]
test ppl:   4%|▍         | 10/236 [00:36<14:22,  3.81s/it]
test ppl:   5%|▍         | 11/236 [00:39<12:37,  3.37s/it]
test ppl:   5%|▌         | 12/236 [00:44<15:23,  4.12s/it]
test ppl:   6%|▌         | 13/236 [00:50<17:15,  4.65s/it]
test ppl:   6%|▌         | 14/236 [00:56<18:34,  5.02s/it]
test ppl:   6%|▋         | 15/236 [00:59<15:34,  4.23s/it]
test ppl:   7%|▋         | 16/236 [01:00<12:53,  3.52s/it]
test ppl:   7%|▋         | 17/236 [01:06<15:24,  4.22s/it]
test ppl:   8%|▊         | 18/236 [01:08<12:34,  3.46s/it]
test ppl:   8%|▊         | 19/236 [01:12<13:35,  3.76s/it]
test ppl:   8%|▊         | 20/236 [01:14<11:23,  3.16s/it]
test ppl:   9%|▉         | 21/236 [01:16<10:23,  2.90s/it]
test ppl:   9%|▉         | 22/236 [01:22<13:32,  3.79s/it]
test ppl:  10%|▉         | 23/236 [01:25<12:06,  3.41s/it]
test ppl:  10%|█         | 24/236 [01:27<10:57,  3.10s/it]
test ppl:  11%|█         | 25/236 [01:29<09:34,  2.72s/it]
test ppl:  11%|█         | 26/236 [01:35<12:55,  3.69s/it]
test ppl:  11%|█▏        | 27/236 [01:39<13:20,  3.83s/it]
test ppl:  12%|█▏        | 28/236 [01:41<10:39,  3.08s/it]
test ppl:  12%|█▏        | 29/236 [01:43<09:49,  2.85s/it]
test ppl:  13%|█▎        | 30/236 [01:44<08:24,  2.45s/it]
test ppl:  13%|█▎        | 31/236 [01:46<07:53,  2.31s/it]
test ppl:  14%|█▎        | 32/236 [01:49<08:25,  2.48s/it]
test ppl:  14%|█▍        | 33/236 [01:55<11:50,  3.50s/it]
test ppl:  14%|█▍        | 34/236 [01:59<12:17,  3.65s/it]
test ppl:  15%|█▍        | 35/236 [02:02<11:06,  3.32s/it]
test ppl:  15%|█▌        | 36/236 [02:07<13:35,  4.08s/it]
test ppl:  16%|█▌        | 37/236 [02:13<15:18,  4.62s/it]
test ppl:  16%|█▌        | 38/236 [02:15<12:43,  3.86s/it]
test ppl:  17%|█▋        | 39/236 [02:17<10:20,  3.15s/it]
test ppl:  17%|█▋        | 40/236 [02:20<09:49,  3.01s/it]
test ppl:  17%|█▋        | 41/236 [02:22<09:18,  2.86s/it]
test ppl:  18%|█▊        | 42/236 [02:28<12:12,  3.78s/it]
test ppl:  18%|█▊        | 43/236 [02:34<14:09,  4.40s/it]
test ppl:  19%|█▊        | 44/236 [02:36<12:04,  3.77s/it]
test ppl:  19%|█▉        | 45/236 [02:38<10:17,  3.23s/it]
test ppl:  19%|█▉        | 46/236 [02:44<12:47,  4.04s/it]
test ppl:  20%|█▉        | 47/236 [02:50<14:29,  4.60s/it]
test ppl:  20%|██        | 48/236 [02:56<15:35,  4.98s/it]
test ppl:  21%|██        | 49/236 [02:59<13:55,  4.47s/it]
test ppl:  21%|██        | 50/236 [03:05<15:11,  4.90s/it]
test ppl:  22%|██▏       | 51/236 [03:11<16:01,  5.20s/it]
test ppl:  22%|██▏       | 52/236 [03:17<16:33,  5.40s/it]
test ppl:  22%|██▏       | 53/236 [03:22<16:27,  5.40s/it]
test ppl:  23%|██▎       | 54/236 [03:24<12:51,  4.24s/it]
test ppl:  23%|██▎       | 55/236 [03:29<14:01,  4.65s/it]
test ppl:  24%|██▎       | 56/236 [03:33<12:49,  4.27s/it]
test ppl:  24%|██▍       | 57/236 [03:35<11:12,  3.76s/it]
test ppl:  25%|██▍       | 58/236 [03:37<09:10,  3.09s/it]
test ppl:  25%|██▌       | 59/236 [03:43<11:34,  3.92s/it]
test ppl:  25%|██▌       | 60/236 [03:46<10:53,  3.71s/it]
test ppl:  26%|██▌       | 61/236 [03:52<12:43,  4.36s/it]
test ppl:  26%|██▋       | 62/236 [03:56<12:25,  4.29s/it]
test ppl:  27%|██▋       | 63/236 [03:58<10:47,  3.74s/it]
test ppl:  27%|██▋       | 64/236 [04:00<08:49,  3.08s/it]
test ppl:  28%|██▊       | 65/236 [04:01<07:16,  2.55s/it]
test ppl:  28%|██▊       | 66/236 [04:04<07:35,  2.68s/it]
test ppl:  28%|██▊       | 67/236 [04:08<08:40,  3.08s/it]
test ppl:  29%|██▉       | 68/236 [04:14<10:59,  3.92s/it]
test ppl:  29%|██▉       | 69/236 [04:20<12:32,  4.51s/it]
test ppl:  30%|██▉       | 70/236 [04:22<10:03,  3.64s/it]
test ppl:  30%|███       | 71/236 [04:25<09:57,  3.62s/it]
test ppl:  31%|███       | 72/236 [04:29<10:02,  3.68s/it]
test ppl:  31%|███       | 73/236 [04:33<10:08,  3.73s/it]
test ppl:  31%|███▏      | 74/236 [04:34<08:16,  3.06s/it]
test ppl:  32%|███▏      | 75/236 [04:40<10:28,  3.90s/it]
test ppl:  32%|███▏      | 76/236 [04:42<08:58,  3.36s/it]
test ppl:  33%|███▎      | 77/236 [04:45<08:02,  3.04s/it]
test ppl:  33%|███▎      | 78/236 [04:46<07:05,  2.70s/it]
test ppl:  33%|███▎      | 79/236 [04:51<08:51,  3.38s/it]
test ppl:  34%|███▍      | 80/236 [04:53<07:39,  2.95s/it]
test ppl:  34%|███▍      | 81/236 [04:59<09:52,  3.82s/it]
test ppl:  35%|███▍      | 82/236 [05:05<11:24,  4.45s/it]
test ppl:  35%|███▌      | 83/236 [05:07<09:28,  3.71s/it]
test ppl:  36%|███▌      | 84/236 [05:09<08:01,  3.16s/it]
test ppl:  36%|███▌      | 85/236 [05:13<08:41,  3.45s/it]
test ppl:  36%|███▋      | 86/236 [05:15<07:28,  2.99s/it]
test ppl:  37%|███▋      | 87/236 [05:17<06:45,  2.72s/it]
test ppl:  37%|███▋      | 88/236 [05:23<09:01,  3.66s/it]
test ppl:  38%|███▊      | 89/236 [05:29<10:35,  4.32s/it]
test ppl:  38%|███▊      | 90/236 [05:35<11:38,  4.79s/it]
test ppl:  39%|███▊      | 91/236 [05:40<11:37,  4.81s/it]
test ppl:  39%|███▉      | 92/236 [05:42<10:05,  4.21s/it]
test ppl:  39%|███▉      | 93/236 [05:48<11:12,  4.70s/it]
test ppl:  40%|███▉      | 94/236 [05:54<11:57,  5.06s/it]
test ppl:  40%|████      | 95/236 [05:59<11:28,  4.88s/it]
test ppl:  41%|████      | 96/236 [06:02<10:02,  4.31s/it]
test ppl:  41%|████      | 97/236 [06:07<11:03,  4.77s/it]
test ppl:  42%|████▏     | 98/236 [06:13<11:44,  5.11s/it]
test ppl:  42%|████▏     | 99/236 [06:19<12:10,  5.33s/it]
test ppl:  42%|████▏     | 100/236 [06:21<09:21,  4.13s/it]
test ppl:  43%|████▎     | 101/236 [06:26<10:28,  4.65s/it]
test ppl:  43%|████▎     | 102/236 [06:30<09:41,  4.34s/it]
test ppl:  44%|████▎     | 103/236 [06:32<08:08,  3.67s/it]
test ppl:  44%|████▍     | 104/236 [06:36<08:27,  3.84s/it]
test ppl:  44%|████▍     | 105/236 [06:40<08:25,  3.86s/it]
test ppl:  45%|████▍     | 106/236 [06:46<09:21,  4.32s/it]
test ppl:  45%|████▌     | 107/236 [06:48<07:48,  3.64s/it]
test ppl:  46%|████▌     | 108/236 [06:53<09:04,  4.25s/it]
test ppl:  46%|████▌     | 109/236 [06:58<09:16,  4.38s/it]
test ppl:  47%|████▋     | 110/236 [07:00<07:34,  3.61s/it]
test ppl:  47%|████▋     | 111/236 [07:04<07:42,  3.70s/it]
test ppl:  47%|████▋     | 112/236 [07:07<07:03,  3.42s/it]
test ppl:  48%|████▊     | 113/236 [07:08<05:59,  2.92s/it]
test ppl:  48%|████▊     | 114/236 [07:12<06:10,  3.04s/it]
test ppl:  49%|████▊     | 115/236 [07:17<07:49,  3.88s/it]
test ppl:  49%|████▉     | 116/236 [07:23<08:44,  4.37s/it]
test ppl:  50%|████▉     | 117/236 [07:25<07:09,  3.61s/it]
test ppl:  50%|█████     | 118/236 [07:29<07:25,  3.77s/it]
test ppl:  50%|█████     | 119/236 [07:32<07:04,  3.63s/it]
test ppl:  51%|█████     | 120/236 [07:34<05:40,  2.94s/it]
test ppl:  51%|█████▏    | 121/236 [07:39<07:18,  3.81s/it]
test ppl:  52%|█████▏    | 122/236 [07:44<07:47,  4.10s/it]
test ppl:  52%|█████▏    | 123/236 [07:46<06:36,  3.51s/it]
test ppl:  53%|█████▎    | 124/236 [07:49<06:08,  3.29s/it]
test ppl:  53%|█████▎    | 125/236 [07:52<05:38,  3.05s/it]
test ppl:  53%|█████▎    | 126/236 [07:55<05:56,  3.24s/it]
test ppl:  54%|█████▍    | 127/236 [07:57<05:08,  2.83s/it]
test ppl:  54%|█████▍    | 128/236 [07:59<04:46,  2.65s/it]
test ppl:  55%|█████▍    | 129/236 [08:02<04:54,  2.75s/it]
test ppl:  55%|█████▌    | 130/236 [08:07<05:44,  3.25s/it]
test ppl:  56%|█████▌    | 131/236 [08:13<07:03,  4.03s/it]
test ppl:  56%|█████▌    | 132/236 [08:15<06:10,  3.56s/it]
test ppl:  56%|█████▋    | 133/236 [08:19<06:17,  3.66s/it]
test ppl:  57%|█████▋    | 134/236 [08:25<07:11,  4.23s/it]
test ppl:  57%|█████▋    | 135/236 [08:30<07:56,  4.71s/it]
test ppl:  58%|█████▊    | 136/236 [08:32<06:06,  3.66s/it]
test ppl:  58%|█████▊    | 137/236 [08:38<07:08,  4.33s/it]
test ppl:  58%|█████▊    | 138/236 [08:41<06:30,  3.99s/it]
test ppl:  59%|█████▉    | 139/236 [08:43<05:45,  3.56s/it]
test ppl:  59%|█████▉    | 140/236 [08:45<04:48,  3.01s/it]
test ppl:  60%|█████▉    | 141/236 [08:48<04:41,  2.96s/it]
test ppl:  60%|██████    | 142/236 [08:50<04:15,  2.71s/it]
test ppl:  61%|██████    | 143/236 [08:56<05:40,  3.66s/it]
test ppl:  61%|██████    | 144/236 [08:59<05:11,  3.38s/it]
test ppl:  61%|██████▏   | 145/236 [09:04<06:05,  4.02s/it]
test ppl:  62%|██████▏   | 146/236 [09:09<06:14,  4.16s/it]
test ppl:  62%|██████▏   | 147/236 [09:14<06:56,  4.68s/it]
test ppl:  63%|██████▎   | 148/236 [09:20<07:26,  5.07s/it]
test ppl:  63%|██████▎   | 149/236 [09:24<06:36,  4.56s/it]
test ppl:  64%|██████▎   | 150/236 [09:28<06:18,  4.40s/it]
test ppl:  64%|██████▍   | 151/236 [09:34<06:51,  4.84s/it]
test ppl:  64%|██████▍   | 152/236 [09:40<07:11,  5.14s/it]
test ppl:  65%|██████▍   | 153/236 [09:45<07:24,  5.35s/it]
test ppl:  65%|██████▌   | 154/236 [09:48<06:08,  4.50s/it]
test ppl:  66%|██████▌   | 155/236 [09:51<05:20,  3.96s/it]
test ppl:  66%|██████▌   | 156/236 [09:53<04:33,  3.42s/it]
test ppl:  67%|██████▋   | 157/236 [09:55<04:01,  3.06s/it]
test ppl:  67%|██████▋   | 158/236 [10:01<05:04,  3.90s/it]
test ppl:  67%|██████▋   | 159/236 [10:07<05:46,  4.50s/it]
test ppl:  68%|██████▊   | 160/236 [10:08<04:25,  3.50s/it]
test ppl:  68%|██████▊   | 161/236 [10:09<03:34,  2.86s/it]
test ppl:  69%|██████▊   | 162/236 [10:12<03:37,  2.94s/it]
test ppl:  69%|██████▉   | 163/236 [10:15<03:25,  2.82s/it]
test ppl:  69%|██████▉   | 164/236 [10:21<04:29,  3.74s/it]
test ppl:  70%|██████▉   | 165/236 [10:25<04:36,  3.90s/it]
test ppl:  70%|███████   | 166/236 [10:28<04:20,  3.72s/it]
test ppl:  71%|███████   | 167/236 [10:30<03:30,  3.05s/it]
test ppl:  71%|███████   | 168/236 [10:36<04:24,  3.89s/it]
test ppl:  72%|███████▏  | 169/236 [10:41<04:52,  4.36s/it]
test ppl:  72%|███████▏  | 170/236 [10:47<05:18,  4.82s/it]
test ppl:  72%|███████▏  | 171/236 [10:48<04:05,  3.78s/it]
test ppl:  73%|███████▎  | 172/236 [10:51<03:33,  3.33s/it]
test ppl:  73%|███████▎  | 173/236 [10:54<03:32,  3.38s/it]
test ppl:  74%|███████▎  | 174/236 [11:00<04:16,  4.13s/it]
test ppl:  74%|███████▍  | 175/236 [11:02<03:29,  3.44s/it]
test ppl:  75%|███████▍  | 176/236 [11:07<03:51,  3.86s/it]
test ppl:  75%|███████▌  | 177/236 [11:13<04:24,  4.48s/it]
test ppl:  75%|███████▌  | 178/236 [11:19<04:47,  4.96s/it]
test ppl:  76%|███████▌  | 179/236 [11:25<04:58,  5.24s/it]
test ppl:  76%|███████▋  | 180/236 [11:29<04:42,  5.04s/it]
test ppl:  77%|███████▋  | 181/236 [11:35<04:50,  5.29s/it]
test ppl:  77%|███████▋  | 182/236 [11:37<03:50,  4.27s/it]
test ppl:  78%|███████▊  | 183/236 [11:39<03:14,  3.67s/it]
test ppl:  78%|███████▊  | 184/236 [11:41<02:36,  3.00s/it]
test ppl:  78%|███████▊  | 185/236 [11:45<02:54,  3.42s/it]
test ppl:  79%|███████▉  | 186/236 [11:51<03:27,  4.16s/it]
test ppl:  79%|███████▉  | 187/236 [11:57<03:50,  4.70s/it]
test ppl:  80%|███████▉  | 188/236 [12:03<04:02,  5.06s/it]
test ppl:  80%|████████  | 189/236 [12:09<04:09,  5.31s/it]
test ppl:  81%|████████  | 190/236 [12:12<03:41,  4.82s/it]
test ppl:  81%|████████  | 191/236 [12:17<03:30,  4.68s/it]
test ppl:  81%|████████▏ | 192/236 [12:19<02:58,  4.06s/it]
test ppl:  82%|████████▏ | 193/236 [12:25<03:17,  4.60s/it]
test ppl:  82%|████████▏ | 194/236 [12:28<02:48,  4.01s/it]
test ppl:  83%|████████▎ | 195/236 [12:31<02:32,  3.72s/it]
test ppl:  83%|████████▎ | 196/236 [12:33<02:08,  3.20s/it]
test ppl:  83%|████████▎ | 197/236 [12:35<01:57,  3.01s/it]
test ppl:  84%|████████▍ | 198/236 [12:41<02:27,  3.87s/it]
test ppl:  84%|████████▍ | 199/236 [12:44<02:10,  3.52s/it]
test ppl:  85%|████████▍ | 200/236 [12:50<02:31,  4.22s/it]
test ppl:  85%|████████▌ | 201/236 [12:52<02:04,  3.56s/it]
test ppl:  86%|████████▌ | 202/236 [12:57<02:11,  3.88s/it]
test ppl:  86%|████████▌ | 203/236 [13:02<02:24,  4.37s/it]
test ppl:  86%|████████▋ | 204/236 [13:04<01:52,  3.50s/it]
test ppl:  87%|████████▋ | 205/236 [13:09<02:10,  4.22s/it]
test ppl:  87%|████████▋ | 206/236 [13:13<01:58,  3.95s/it]
test ppl:  88%|████████▊ | 207/236 [13:19<02:11,  4.54s/it]
test ppl:  88%|████████▊ | 208/236 [13:22<01:55,  4.12s/it]
test ppl:  89%|████████▊ | 209/236 [13:28<02:06,  4.67s/it]
test ppl:  89%|████████▉ | 210/236 [13:30<01:43,  3.97s/it]
test ppl:  89%|████████▉ | 211/236 [13:35<01:45,  4.22s/it]
test ppl:  90%|████████▉ | 212/236 [13:40<01:45,  4.38s/it]
test ppl:  90%|█████████ | 213/236 [13:46<01:50,  4.82s/it]
test ppl:  91%|█████████ | 214/236 [13:47<01:25,  3.87s/it]
test ppl:  91%|█████████ | 215/236 [13:53<01:33,  4.47s/it]
test ppl:  92%|█████████▏| 216/236 [13:56<01:17,  3.89s/it]
test ppl:  92%|█████████▏| 217/236 [14:02<01:25,  4.51s/it]
test ppl:  92%|█████████▏| 218/236 [14:03<01:07,  3.74s/it]
test ppl:  93%|█████████▎| 219/236 [14:09<01:14,  4.39s/it]
test ppl:  93%|█████████▎| 220/236 [14:15<01:17,  4.84s/it]
test ppl:  94%|█████████▎| 221/236 [14:18<01:04,  4.31s/it]
test ppl:  94%|█████████▍| 222/236 [14:24<01:06,  4.78s/it]
test ppl:  94%|█████████▍| 223/236 [14:30<01:06,  5.11s/it]
test ppl:  95%|█████████▍| 224/236 [14:31<00:47,  3.97s/it]
test ppl:  95%|█████████▌| 225/236 [14:37<00:49,  4.53s/it]
test ppl:  96%|█████████▌| 226/236 [14:41<00:42,  4.23s/it]
test ppl:  96%|█████████▌| 227/236 [14:43<00:33,  3.68s/it]
test ppl:  97%|█████████▋| 228/236 [14:45<00:25,  3.18s/it]
test ppl:  97%|█████████▋| 229/236 [14:51<00:27,  3.98s/it]
test ppl:  97%|█████████▋| 230/236 [14:54<00:23,  3.83s/it]
test ppl:  98%|█████████▊| 231/236 [14:58<00:18,  3.68s/it]
test ppl:  98%|█████████▊| 232/236 [15:00<00:12,  3.10s/it]
test ppl:  99%|█████████▊| 233/236 [15:02<00:08,  2.81s/it]
test ppl:  99%|█████████▉| 234/236 [15:03<00:04,  2.33s/it]
test ppl: 100%|█████████▉| 235/236 [15:09<00:03,  3.39s/it]
test ppl: 100%|██████████| 236/236 [15:09<00:00,  2.57s/it]
test ppl: 100%|██████████| 236/236 [15:09<00:00,  3.86s/it]
10/12/2024 15:17:59 - INFO - __main__ -    em: 0.2099
10/12/2024 15:17:59 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.2 50:  em: 0.2099

--------------------------------------------------------------------------------
Running experiment with knn_temp=50, lmbda=0.2, k=64
2024-10-12 15:18:06.138868: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 15:18:06.158391: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 15:18:06.180167: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 15:18:06.186780: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 15:18:06.202745: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 15:18:07.195545: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 15:18:08 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.2, knn_temp=50, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 15:18:08 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:44:28,  2.19it/s]
Adding feature api:   3%|▎         | 6426/187062 [00:00<00:11, 15305.06it/s]
Adding feature api:   7%|▋         | 13821/187062 [00:00<00:05, 30192.76it/s]
Adding feature api:  11%|█▏        | 21287/187062 [00:00<00:03, 42026.71it/s]
Adding feature api:  15%|█▌        | 28573/187062 [00:00<00:03, 50519.63it/s]
Adding feature api:  19%|█▉        | 36070/187062 [00:00<00:02, 57423.89it/s]
Adding feature api:  23%|██▎       | 43607/187062 [00:01<00:02, 62579.96it/s]
Adding feature api:  27%|██▋       | 51167/187062 [00:01<00:02, 66368.83it/s]
Adding feature api:  31%|███▏      | 58525/187062 [00:01<00:01, 68486.16it/s]
Adding feature api:  35%|███▌      | 66061/187062 [00:01<00:01, 70515.56it/s]
Adding feature api:  39%|███▉      | 73656/187062 [00:01<00:01, 72125.92it/s]
Adding feature api:  43%|████▎     | 81179/187062 [00:01<00:01, 73048.31it/s]
Adding feature api:  47%|████▋     | 88735/187062 [00:01<00:01, 73795.47it/s]
Adding feature api:  51%|█████▏    | 96225/187062 [00:01<00:01, 73713.32it/s]
Adding feature api:  55%|█████▌    | 103779/187062 [00:01<00:01, 74254.49it/s]
Adding feature api:  60%|█████▉    | 111308/187062 [00:01<00:01, 74561.41it/s]
Adding feature api:  64%|██████▎   | 118856/187062 [00:02<00:00, 74835.11it/s]
Adding feature api:  68%|██████▊   | 126367/187062 [00:02<00:00, 74360.37it/s]
Adding feature api:  72%|███████▏  | 133972/187062 [00:02<00:00, 74862.08it/s]
Adding feature api:  76%|███████▌  | 141491/187062 [00:02<00:00, 74958.78it/s]
Adding feature api:  80%|███████▉  | 149033/187062 [00:02<00:00, 75093.87it/s]
Adding feature api:  84%|████████▎ | 156550/187062 [00:02<00:00, 74443.07it/s]
Adding feature api:  88%|████████▊ | 164084/187062 [00:02<00:00, 74709.45it/s]
Adding feature api:  92%|█████████▏| 171588/187062 [00:02<00:00, 74805.95it/s]
Adding feature api:  96%|█████████▌| 179072/187062 [00:02<00:00, 68111.46it/s]
Adding feature api:  99%|█████████▉| 186000/187062 [00:03<00:00, 47712.99it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 58660.16it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:34:33,  2.20it/s]
Adding feature datatype:   3%|▎         | 6235/187062 [00:00<00:12, 14929.18it/s]
Adding feature datatype:   7%|▋         | 13377/187062 [00:00<00:05, 29326.64it/s]
Adding feature datatype:  11%|█         | 20605/187062 [00:00<00:04, 40790.81it/s]
Adding feature datatype:  15%|█▍        | 27802/187062 [00:00<00:03, 49395.80it/s]
Adding feature datatype:  19%|█▊        | 34721/187062 [00:00<00:02, 54992.43it/s]
Adding feature datatype:  22%|██▏       | 41963/187062 [00:01<00:02, 60005.20it/s]
Adding feature datatype:  26%|██▋       | 49237/187062 [00:01<00:02, 63713.58it/s]
Adding feature datatype:  30%|███       | 56494/187062 [00:01<00:01, 66315.51it/s]
Adding feature datatype:  34%|███▍      | 63732/187062 [00:01<00:01, 68107.26it/s]
Adding feature datatype:  38%|███▊      | 70953/187062 [00:01<00:01, 69322.51it/s]
Adding feature datatype:  42%|████▏     | 78098/187062 [00:01<00:01, 69435.51it/s]
Adding feature datatype:  46%|████▌     | 85341/187062 [00:01<00:01, 70324.14it/s]
Adding feature datatype:  50%|████▉     | 92636/187062 [00:01<00:01, 71103.63it/s]
Adding feature datatype:  53%|█████▎    | 99942/187062 [00:01<00:01, 71686.88it/s]
Adding feature datatype:  57%|█████▋    | 107192/187062 [00:01<00:01, 71929.35it/s]
Adding feature datatype:  61%|██████    | 114444/187062 [00:02<00:01, 72104.84it/s]
Adding feature datatype:  65%|██████▌   | 121681/187062 [00:02<00:00, 71389.41it/s]
Adding feature datatype:  69%|██████▉   | 128957/187062 [00:02<00:00, 71793.62it/s]
Adding feature datatype:  73%|███████▎  | 136194/187062 [00:02<00:00, 71963.82it/s]
Adding feature datatype:  77%|███████▋  | 143461/187062 [00:02<00:00, 72172.54it/s]
Adding feature datatype:  81%|████████  | 150709/187062 [00:02<00:00, 72262.50it/s]
Adding feature datatype:  84%|████████▍ | 157941/187062 [00:02<00:00, 71578.31it/s]
Adding feature datatype:  88%|████████▊ | 165201/187062 [00:02<00:00, 71879.27it/s]
Adding feature datatype:  92%|█████████▏| 172535/187062 [00:02<00:00, 72313.07it/s]
Adding feature datatype:  96%|█████████▌| 179770/187062 [00:03<00:00, 63111.03it/s]
Adding feature datatype: 100%|█████████▉| 186292/187062 [00:03<00:00, 45939.22it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 57002.26it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:18:20,  2.23it/s]
Adding feature literal:   3%|▎         | 6202/187062 [00:00<00:12, 14980.68it/s]
Adding feature literal:   7%|▋         | 13234/187062 [00:00<00:05, 29177.19it/s]
Adding feature literal:  11%|█         | 19699/187062 [00:00<00:04, 38689.77it/s]
Adding feature literal:  14%|█▍        | 26208/187062 [00:00<00:03, 46001.14it/s]
Adding feature literal:  17%|█▋        | 32626/187062 [00:00<00:03, 51153.38it/s]
Adding feature literal:  21%|██        | 39212/187062 [00:01<00:02, 55391.17it/s]
Adding feature literal:  24%|██▍       | 45732/187062 [00:01<00:02, 58250.47it/s]
Adding feature literal:  28%|██▊       | 52258/187062 [00:01<00:02, 60309.47it/s]
Adding feature literal:  32%|███▏      | 59539/187062 [00:01<00:01, 64004.98it/s]
Adding feature literal:  36%|███▌      | 66809/187062 [00:01<00:01, 66586.27it/s]
Adding feature literal:  40%|███▉      | 74057/187062 [00:01<00:01, 68341.20it/s]
Adding feature literal:  43%|████▎     | 81343/187062 [00:01<00:01, 69688.68it/s]
Adding feature literal:  47%|████▋     | 88661/187062 [00:01<00:01, 70730.47it/s]
Adding feature literal:  51%|█████▏    | 95915/187062 [00:01<00:01, 71270.77it/s]
Adding feature literal:  55%|█████▌    | 103177/187062 [00:01<00:01, 71674.11it/s]
Adding feature literal:  59%|█████▉    | 110467/187062 [00:02<00:01, 72037.96it/s]
Adding feature literal:  63%|██████▎   | 117776/187062 [00:02<00:00, 72352.80it/s]
Adding feature literal:  67%|██████▋   | 125076/187062 [00:02<00:00, 72543.91it/s]
Adding feature literal:  71%|███████   | 132348/187062 [00:02<00:00, 72593.51it/s]
Adding feature literal:  75%|███████▍  | 139659/187062 [00:02<00:00, 72745.20it/s]
Adding feature literal:  79%|███████▊  | 147026/187062 [00:02<00:00, 73021.02it/s]
Adding feature literal:  83%|████████▎ | 154345/187062 [00:02<00:00, 73070.94it/s]
Adding feature literal:  86%|████████▋ | 161656/187062 [00:02<00:00, 73029.20it/s]
Adding feature literal:  90%|█████████ | 168962/187062 [00:02<00:00, 72718.00it/s]
Adding feature literal:  94%|█████████▍| 176257/187062 [00:02<00:00, 72785.14it/s]
Adding feature literal:  98%|█████████▊| 183537/187062 [00:03<00:00, 50143.06it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 56388.97it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:23:00,  2.22it/s]
Adding feature operator:   3%|▎         | 6265/187062 [00:00<00:11, 15094.99it/s]
Adding feature operator:   7%|▋         | 13443/187062 [00:00<00:05, 29610.23it/s]
Adding feature operator:  11%|█         | 20674/187062 [00:00<00:04, 41046.23it/s]
Adding feature operator:  15%|█▍        | 27973/187062 [00:00<00:03, 49885.41it/s]
Adding feature operator:  19%|█▉        | 35261/187062 [00:00<00:02, 56399.79it/s]
Adding feature operator:  23%|██▎       | 42566/187062 [00:01<00:02, 61195.32it/s]
Adding feature operator:  27%|██▋       | 49908/187062 [00:01<00:02, 64758.94it/s]
Adding feature operator:  31%|███       | 57205/187062 [00:01<00:01, 67171.34it/s]
Adding feature operator:  34%|███▍      | 64466/187062 [00:01<00:01, 68779.28it/s]
Adding feature operator:  38%|███▊      | 71715/187062 [00:01<00:01, 69871.97it/s]
Adding feature operator:  42%|████▏     | 79043/187062 [00:01<00:01, 70884.98it/s]
Adding feature operator:  46%|████▌     | 86361/187062 [00:01<00:01, 71569.50it/s]
Adding feature operator:  50%|█████     | 93658/187062 [00:01<00:01, 71986.57it/s]
Adding feature operator:  54%|█████▍    | 100942/187062 [00:01<00:01, 72240.04it/s]
Adding feature operator:  58%|█████▊    | 108286/187062 [00:01<00:01, 72597.19it/s]
Adding feature operator:  62%|██████▏   | 115617/187062 [00:02<00:00, 72809.39it/s]
Adding feature operator:  66%|██████▌   | 122924/187062 [00:02<00:00, 72868.41it/s]
Adding feature operator:  70%|██████▉   | 130229/187062 [00:02<00:00, 72911.56it/s]
Adding feature operator:  74%|███████▎  | 137533/187062 [00:02<00:00, 72855.15it/s]
Adding feature operator:  77%|███████▋  | 144870/187062 [00:02<00:00, 73007.43it/s]
Adding feature operator:  81%|████████▏ | 152177/187062 [00:02<00:00, 73023.91it/s]
Adding feature operator:  85%|████████▌ | 159570/187062 [00:02<00:00, 73294.73it/s]
Adding feature operator:  89%|████████▉ | 166903/187062 [00:02<00:00, 70904.92it/s]
Adding feature operator:  93%|█████████▎| 174013/187062 [00:02<00:00, 69210.21it/s]
Adding feature operator:  97%|█████████▋| 180953/187062 [00:03<00:00, 56171.76it/s]
Adding feature operator: 100%|█████████▉| 186965/187062 [00:03<00:00, 44201.78it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 57176.69it/s]
[2024-10-12 15:18:53,911] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 15:18:55 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 15:18:55 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 42/6548 [00:00<00:16, 405.96 examples/s]
Map:   1%|▏         | 84/6548 [00:00<00:30, 208.74 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:24, 265.70 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 316.41 examples/s]
Map:   3%|▎         | 216/6548 [00:00<00:18, 334.24 examples/s]
Map:   4%|▍         | 272/6548 [00:00<00:18, 344.35 examples/s]
Map:   5%|▍         | 325/6548 [00:01<00:20, 298.79 examples/s]
Map:   6%|▌         | 361/6548 [00:01<00:20, 306.82 examples/s]
Map:   6%|▋         | 412/6548 [00:01<00:17, 347.49 examples/s]
Map:   7%|▋         | 458/6548 [00:01<00:18, 323.14 examples/s]
Map:   8%|▊         | 503/6548 [00:01<00:19, 314.02 examples/s]
Map:   9%|▊         | 557/6548 [00:01<00:16, 365.39 examples/s]
Map:   9%|▉         | 612/6548 [00:01<00:16, 360.25 examples/s]
Map:  10%|▉         | 651/6548 [00:02<00:18, 323.74 examples/s]
Map:  11%|█         | 693/6548 [00:02<00:17, 342.07 examples/s]
Map:  11%|█         | 731/6548 [00:02<00:16, 343.22 examples/s]
Map:  12%|█▏        | 785/6548 [00:02<00:14, 388.83 examples/s]
Map:  13%|█▎        | 831/6548 [00:02<00:14, 393.65 examples/s]
Map:  13%|█▎        | 876/6548 [00:02<00:13, 406.86 examples/s]
Map:  14%|█▍        | 924/6548 [00:02<00:15, 368.95 examples/s]
Map:  15%|█▍        | 969/6548 [00:02<00:14, 386.07 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:25, 214.35 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:22, 242.45 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:19, 279.14 examples/s]
Map:  18%|█▊        | 1147/6548 [00:03<00:16, 321.45 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 340.86 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:15, 352.15 examples/s]
Map:  20%|█▉        | 1294/6548 [00:03<00:14, 367.17 examples/s]
Map:  20%|██        | 1334/6548 [00:04<00:16, 317.36 examples/s]
Map:  21%|██        | 1369/6548 [00:04<00:16, 313.39 examples/s]
Map:  22%|██▏       | 1420/6548 [00:04<00:16, 318.64 examples/s]
Map:  22%|██▏       | 1461/6548 [00:04<00:17, 286.89 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:16, 297.14 examples/s]
Map:  24%|██▎       | 1542/6548 [00:04<00:16, 294.72 examples/s]
Map:  24%|██▍       | 1579/6548 [00:04<00:16, 308.22 examples/s]
Map:  25%|██▍       | 1622/6548 [00:05<00:17, 286.60 examples/s]
Map:  25%|██▌       | 1653/6548 [00:05<00:17, 277.48 examples/s]
Map:  26%|██▌       | 1687/6548 [00:05<00:16, 292.05 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:15, 317.44 examples/s]
Map:  27%|██▋       | 1771/6548 [00:05<00:13, 349.07 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:13, 352.68 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 359.35 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 343.95 examples/s]
Map:  30%|██▉       | 1947/6548 [00:06<00:12, 358.46 examples/s]
Map:  30%|███       | 1990/6548 [00:06<00:12, 374.58 examples/s]
Map:  31%|███       | 2041/6548 [00:06<00:19, 226.60 examples/s]
Map:  32%|███▏      | 2081/6548 [00:06<00:17, 255.98 examples/s]
Map:  32%|███▏      | 2117/6548 [00:06<00:16, 261.64 examples/s]
Map:  33%|███▎      | 2154/6548 [00:06<00:17, 254.94 examples/s]
Map:  34%|███▎      | 2194/6548 [00:07<00:15, 285.00 examples/s]
Map:  34%|███▍      | 2229/6548 [00:07<00:15, 274.19 examples/s]
Map:  35%|███▍      | 2271/6548 [00:07<00:15, 267.42 examples/s]
Map:  35%|███▌      | 2309/6548 [00:07<00:14, 289.87 examples/s]
Map:  36%|███▌      | 2350/6548 [00:07<00:13, 316.22 examples/s]
Map:  37%|███▋      | 2402/6548 [00:07<00:12, 324.90 examples/s]
Map:  37%|███▋      | 2438/6548 [00:07<00:13, 313.21 examples/s]
Map:  38%|███▊      | 2477/6548 [00:07<00:12, 322.40 examples/s]
Map:  38%|███▊      | 2517/6548 [00:08<00:11, 337.45 examples/s]
Map:  39%|███▉      | 2557/6548 [00:08<00:11, 351.07 examples/s]
Map:  40%|███▉      | 2601/6548 [00:08<00:10, 373.45 examples/s]
Map:  40%|████      | 2643/6548 [00:08<00:10, 384.22 examples/s]
Map:  41%|████      | 2699/6548 [00:08<00:10, 367.39 examples/s]
Map:  42%|████▏     | 2737/6548 [00:08<00:10, 357.66 examples/s]
Map:  43%|████▎     | 2790/6548 [00:08<00:10, 350.41 examples/s]
Map:  43%|████▎     | 2828/6548 [00:08<00:12, 294.52 examples/s]
Map:  44%|████▍     | 2873/6548 [00:09<00:12, 294.77 examples/s]
Map:  44%|████▍     | 2904/6548 [00:09<00:13, 274.25 examples/s]
Map:  45%|████▌     | 2949/6548 [00:09<00:11, 305.33 examples/s]
Map:  46%|████▌     | 2986/6548 [00:09<00:11, 320.02 examples/s]
Map:  46%|████▌     | 3020/6548 [00:09<00:22, 156.89 examples/s]
Map:  47%|████▋     | 3053/6548 [00:10<00:19, 177.75 examples/s]
Map:  47%|████▋     | 3084/6548 [00:10<00:17, 199.10 examples/s]
Map:  48%|████▊     | 3122/6548 [00:10<00:14, 234.17 examples/s]
Map:  48%|████▊     | 3169/6548 [00:10<00:13, 244.52 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:14, 231.18 examples/s]
Map:  49%|████▉     | 3230/6548 [00:10<00:13, 237.96 examples/s]
Map:  50%|████▉     | 3269/6548 [00:10<00:12, 264.80 examples/s]
Map:  50%|█████     | 3298/6548 [00:10<00:12, 270.36 examples/s]
Map:  51%|█████     | 3342/6548 [00:11<00:10, 307.03 examples/s]
Map:  52%|█████▏    | 3378/6548 [00:11<00:10, 315.63 examples/s]
Map:  52%|█████▏    | 3420/6548 [00:11<00:10, 298.71 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:10, 282.91 examples/s]
Map:  53%|█████▎    | 3495/6548 [00:11<00:11, 275.60 examples/s]
Map:  54%|█████▍    | 3544/6548 [00:11<00:09, 325.39 examples/s]
Map:  55%|█████▍    | 3591/6548 [00:11<00:08, 355.72 examples/s]
Map:  56%|█████▌    | 3636/6548 [00:11<00:07, 379.24 examples/s]
Map:  56%|█████▋    | 3696/6548 [00:12<00:07, 381.65 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:12<00:07, 387.24 examples/s]
Map:  58%|█████▊    | 3793/6548 [00:12<00:07, 373.73 examples/s]
Map:  59%|█████▊    | 3839/6548 [00:12<00:07, 344.54 examples/s]
Map:  59%|█████▉    | 3887/6548 [00:12<00:08, 328.31 examples/s]
Map:  60%|█████▉    | 3925/6548 [00:12<00:08, 318.59 examples/s]
Map:  60%|██████    | 3961/6548 [00:12<00:07, 324.37 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 230.24 examples/s]
Map:  62%|██████▏   | 4055/6548 [00:13<00:08, 290.76 examples/s]
Map:  63%|██████▎   | 4097/6548 [00:13<00:07, 316.26 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 328.23 examples/s]
Map:  64%|██████▍   | 4195/6548 [00:13<00:07, 332.70 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:07, 327.46 examples/s]
Map:  65%|██████▌   | 4282/6548 [00:13<00:06, 355.96 examples/s]
Map:  66%|██████▌   | 4325/6548 [00:14<00:06, 368.15 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:14<00:06, 355.14 examples/s]
Map:  68%|██████▊   | 4431/6548 [00:14<00:05, 368.35 examples/s]
Map:  69%|██████▊   | 4486/6548 [00:14<00:05, 350.11 examples/s]
Map:  69%|██████▉   | 4530/6548 [00:14<00:06, 326.36 examples/s]
Map:  70%|██████▉   | 4569/6548 [00:14<00:05, 337.78 examples/s]
Map:  70%|███████   | 4610/6548 [00:14<00:05, 333.09 examples/s]
Map:  71%|███████   | 4658/6548 [00:14<00:05, 367.53 examples/s]
Map:  72%|███████▏  | 4715/6548 [00:15<00:04, 368.82 examples/s]
Map:  73%|███████▎  | 4783/6548 [00:15<00:04, 394.25 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 398.30 examples/s]
Map:  74%|███████▍  | 4869/6548 [00:15<00:04, 346.92 examples/s]
Map:  75%|███████▍  | 4905/6548 [00:15<00:04, 347.01 examples/s]
Map:  76%|███████▌  | 4958/6548 [00:15<00:04, 390.56 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:16<00:06, 230.69 examples/s]
Map:  77%|███████▋  | 5046/6548 [00:16<00:06, 248.81 examples/s]
Map:  78%|███████▊  | 5085/6548 [00:16<00:05, 250.59 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 257.25 examples/s]
Map:  79%|███████▊  | 5147/6548 [00:16<00:05, 263.66 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 276.29 examples/s]
Map:  80%|███████▉  | 5221/6548 [00:16<00:04, 282.92 examples/s]
Map:  80%|████████  | 5256/6548 [00:17<00:04, 289.91 examples/s]
Map:  81%|████████  | 5305/6548 [00:17<00:03, 339.79 examples/s]
Map:  82%|████████▏ | 5346/6548 [00:17<00:04, 294.03 examples/s]
Map:  82%|████████▏ | 5388/6548 [00:17<00:03, 320.37 examples/s]
Map:  83%|████████▎ | 5430/6548 [00:17<00:03, 301.52 examples/s]
Map:  83%|████████▎ | 5465/6548 [00:17<00:03, 309.14 examples/s]
Map:  84%|████████▍ | 5500/6548 [00:17<00:03, 317.12 examples/s]
Map:  84%|████████▍ | 5533/6548 [00:17<00:03, 313.87 examples/s]
Map:  85%|████████▌ | 5572/6548 [00:18<00:03, 314.60 examples/s]
Map:  86%|████████▌ | 5626/6548 [00:18<00:02, 327.74 examples/s]
Map:  87%|████████▋ | 5666/6548 [00:18<00:02, 294.44 examples/s]
Map:  87%|████████▋ | 5711/6548 [00:18<00:02, 292.03 examples/s]
Map:  88%|████████▊ | 5755/6548 [00:18<00:02, 323.60 examples/s]
Map:  88%|████████▊ | 5793/6548 [00:18<00:02, 336.39 examples/s]
Map:  89%|████████▉ | 5846/6548 [00:18<00:02, 336.57 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:18<00:01, 342.02 examples/s]
Map:  90%|█████████ | 5922/6548 [00:19<00:01, 351.70 examples/s]
Map:  91%|█████████ | 5964/6548 [00:19<00:01, 321.91 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 212.33 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:02, 246.10 examples/s]
Map:  93%|█████████▎| 6081/6548 [00:19<00:01, 277.45 examples/s]
Map:  94%|█████████▎| 6123/6548 [00:19<00:01, 270.94 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:20<00:01, 289.55 examples/s]
Map:  95%|█████████▍| 6198/6548 [00:20<00:01, 294.43 examples/s]
Map:  95%|█████████▌| 6240/6548 [00:20<00:00, 310.49 examples/s]
Map:  96%|█████████▌| 6274/6548 [00:20<00:00, 316.25 examples/s]
Map:  96%|█████████▋| 6311/6548 [00:20<00:00, 326.04 examples/s]
Map:  97%|█████████▋| 6365/6548 [00:20<00:00, 364.63 examples/s]
Map:  98%|█████████▊| 6421/6548 [00:20<00:00, 356.23 examples/s]
Map:  99%|█████████▉| 6471/6548 [00:20<00:00, 387.32 examples/s]
Map:  99%|█████████▉| 6515/6548 [00:20<00:00, 382.20 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 308.97 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 35/903 [00:00<00:02, 319.68 examples/s]
Map:   8%|▊         | 71/903 [00:00<00:02, 337.08 examples/s]
Map:  13%|█▎        | 119/903 [00:00<00:02, 322.97 examples/s]
Map:  18%|█▊        | 162/903 [00:00<00:02, 358.37 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 382.49 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 389.87 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 383.92 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 338.56 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 320.81 examples/s]
Map:  51%|█████     | 460/903 [00:01<00:01, 316.29 examples/s]
Map:  57%|█████▋    | 516/903 [00:01<00:01, 329.40 examples/s]
Map:  62%|██████▏   | 561/903 [00:01<00:00, 350.70 examples/s]
Map:  68%|██████▊   | 613/903 [00:01<00:00, 375.60 examples/s]
Map:  74%|███████▍  | 667/903 [00:01<00:00, 365.95 examples/s]
Map:  80%|████████  | 726/903 [00:02<00:00, 371.30 examples/s]
Map:  85%|████████▌ | 770/903 [00:02<00:00, 384.81 examples/s]
Map:  92%|█████████▏| 827/903 [00:02<00:00, 375.59 examples/s]
Map:  96%|█████████▌| 868/903 [00:02<00:00, 382.62 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 325.70 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 277.78 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 328.99 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 330.40 examples/s]
Map:   9%|▉         | 171/1882 [00:00<00:05, 335.82 examples/s]
Map:  12%|█▏        | 228/1882 [00:00<00:04, 350.84 examples/s]
Map:  14%|█▍        | 270/1882 [00:00<00:04, 367.32 examples/s]
Map:  16%|█▋        | 310/1882 [00:00<00:04, 361.66 examples/s]
Map:  19%|█▊        | 350/1882 [00:00<00:04, 364.37 examples/s]
Map:  21%|██        | 393/1882 [00:01<00:04, 320.58 examples/s]
Map:  23%|██▎       | 433/1882 [00:01<00:04, 295.31 examples/s]
Map:  26%|██▌       | 489/1882 [00:01<00:04, 314.53 examples/s]
Map:  28%|██▊       | 532/1882 [00:01<00:04, 294.57 examples/s]
Map:  30%|███       | 570/1882 [00:01<00:04, 313.03 examples/s]
Map:  32%|███▏      | 611/1882 [00:01<00:03, 327.78 examples/s]
Map:  35%|███▍      | 657/1882 [00:01<00:03, 356.14 examples/s]
Map:  37%|███▋      | 704/1882 [00:02<00:03, 375.85 examples/s]
Map:  40%|███▉      | 745/1882 [00:02<00:02, 382.55 examples/s]
Map:  42%|████▏     | 793/1882 [00:02<00:03, 345.44 examples/s]
Map:  44%|████▍     | 831/1882 [00:02<00:02, 352.13 examples/s]
Map:  47%|████▋     | 891/1882 [00:02<00:02, 366.66 examples/s]
Map:  49%|████▉     | 931/1882 [00:02<00:02, 365.21 examples/s]
Map:  52%|█████▏    | 982/1882 [00:02<00:02, 400.20 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 251.53 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 263.16 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 274.41 examples/s]
Map:  61%|██████    | 1146/1882 [00:03<00:02, 263.56 examples/s]
Map:  63%|██████▎   | 1177/1882 [00:03<00:02, 267.11 examples/s]
Map:  65%|██████▌   | 1229/1882 [00:03<00:02, 289.47 examples/s]
Map:  68%|██████▊   | 1279/1882 [00:04<00:02, 301.12 examples/s]
Map:  70%|███████   | 1322/1882 [00:04<00:01, 327.10 examples/s]
Map:  72%|███████▏  | 1360/1882 [00:04<00:01, 328.74 examples/s]
Map:  75%|███████▌  | 1413/1882 [00:04<00:01, 330.86 examples/s]
Map:  78%|███████▊  | 1468/1882 [00:04<00:01, 300.25 examples/s]
Map:  80%|███████▉  | 1503/1882 [00:04<00:01, 269.60 examples/s]
Map:  82%|████████▏ | 1538/1882 [00:04<00:01, 248.84 examples/s]
Map:  84%|████████▎ | 1575/1882 [00:05<00:01, 271.39 examples/s]
Map:  86%|████████▌ | 1619/1882 [00:05<00:00, 305.62 examples/s]
Map:  88%|████████▊ | 1655/1882 [00:05<00:00, 304.96 examples/s]
Map:  91%|█████████ | 1710/1882 [00:05<00:00, 309.06 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 267.33 examples/s]
Map:  95%|█████████▍| 1781/1882 [00:05<00:00, 269.97 examples/s]
Map:  97%|█████████▋| 1824/1882 [00:05<00:00, 302.66 examples/s]
Map:  99%|█████████▉| 1861/1882 [00:05<00:00, 315.89 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 302.81 examples/s]
10/12/2024 15:19:57 - INFO - __main__ -     ***** Testing *****
10/12/2024 15:19:57 - INFO - __main__ -     Batch size = 8
10/12/2024 15:19:57 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 15:19:58 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 15:19:58 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 15:19:59 - INFO - knnlm -   Reading datastore took 0.9342856407165527 s
10/12/2024 15:20:00 - INFO - knnlm -   Moving index to GPU took 0.932204008102417 s
10/12/2024 15:20:00 - INFO - __main__ -   ******************************break-into
10/12/2024 15:20:00 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 15:20:00 - INFO - __main__ -     Num examples = 236
10/12/2024 15:20:00 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<31:37,  8.07s/it]
test ppl:   1%|          | 2/236 [00:10<17:25,  4.47s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:04,  3.11s/it]
test ppl:   2%|▏         | 4/236 [00:13<09:46,  2.53s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:19,  3.72s/it]
test ppl:   3%|▎         | 6/236 [00:21<12:25,  3.24s/it]
test ppl:   3%|▎         | 7/236 [00:23<11:28,  3.01s/it]
test ppl:   3%|▎         | 8/236 [00:28<12:58,  3.41s/it]
test ppl:   4%|▍         | 9/236 [00:33<15:46,  4.17s/it]
test ppl:   4%|▍         | 10/236 [00:36<14:21,  3.81s/it]
test ppl:   5%|▍         | 11/236 [00:39<12:37,  3.37s/it]
test ppl:   5%|▌         | 12/236 [00:45<15:24,  4.13s/it]
test ppl:   6%|▌         | 13/236 [00:49<16:06,  4.34s/it]
test ppl:   6%|▌         | 14/236 [00:55<17:46,  4.81s/it]
test ppl:   6%|▋         | 15/236 [00:57<14:33,  3.95s/it]
test ppl:   7%|▋         | 16/236 [00:59<12:11,  3.32s/it]
test ppl:   7%|▋         | 17/236 [01:05<14:56,  4.09s/it]
test ppl:   8%|▊         | 18/236 [01:07<12:14,  3.37s/it]
test ppl:   8%|▊         | 19/236 [01:11<13:21,  3.69s/it]
test ppl:   8%|▊         | 20/236 [01:13<11:13,  3.12s/it]
test ppl:   9%|▉         | 21/236 [01:15<10:15,  2.86s/it]
test ppl:   9%|▉         | 22/236 [01:21<13:26,  3.77s/it]
test ppl:  10%|▉         | 23/236 [01:24<12:02,  3.39s/it]
test ppl:  10%|█         | 24/236 [01:26<10:55,  3.09s/it]
test ppl:  11%|█         | 25/236 [01:28<09:33,  2.72s/it]
test ppl:  11%|█         | 26/236 [01:34<12:51,  3.67s/it]
test ppl:  11%|█▏        | 27/236 [01:38<13:19,  3.82s/it]
test ppl:  12%|█▏        | 28/236 [01:39<10:31,  3.04s/it]
test ppl:  12%|█▏        | 29/236 [01:42<09:44,  2.83s/it]
test ppl:  13%|█▎        | 30/236 [01:43<08:21,  2.44s/it]
test ppl:  13%|█▎        | 31/236 [01:46<08:47,  2.57s/it]
test ppl:  14%|█▎        | 32/236 [01:49<09:03,  2.67s/it]
test ppl:  14%|█▍        | 33/236 [01:55<12:18,  3.64s/it]
test ppl:  14%|█▍        | 34/236 [01:59<12:37,  3.75s/it]
test ppl:  15%|█▍        | 35/236 [02:01<11:20,  3.38s/it]
test ppl:  15%|█▌        | 36/236 [02:07<13:46,  4.13s/it]
test ppl:  16%|█▌        | 37/236 [02:13<15:27,  4.66s/it]
test ppl:  16%|█▌        | 38/236 [02:15<12:48,  3.88s/it]
test ppl:  17%|█▋        | 39/236 [02:17<10:24,  3.17s/it]
test ppl:  17%|█▋        | 40/236 [02:19<09:52,  3.02s/it]
test ppl:  17%|█▋        | 41/236 [02:22<09:20,  2.87s/it]
test ppl:  18%|█▊        | 42/236 [02:28<12:13,  3.78s/it]
test ppl:  18%|█▊        | 43/236 [02:34<14:11,  4.41s/it]
test ppl:  19%|█▊        | 44/236 [02:36<11:45,  3.67s/it]
test ppl:  19%|█▉        | 45/236 [02:38<10:03,  3.16s/it]
test ppl:  19%|█▉        | 46/236 [02:43<11:54,  3.76s/it]
test ppl:  20%|█▉        | 47/236 [02:49<13:53,  4.41s/it]
test ppl:  20%|██        | 48/236 [02:54<15:11,  4.85s/it]
test ppl:  21%|██        | 49/236 [02:58<13:39,  4.38s/it]
test ppl:  21%|██        | 50/236 [03:04<15:01,  4.85s/it]
test ppl:  22%|██▏       | 51/236 [03:10<15:55,  5.17s/it]
test ppl:  22%|██▏       | 52/236 [03:15<16:30,  5.38s/it]
test ppl:  22%|██▏       | 53/236 [03:21<16:28,  5.40s/it]
test ppl:  23%|██▎       | 54/236 [03:22<12:52,  4.24s/it]
test ppl:  23%|██▎       | 55/236 [03:28<14:03,  4.66s/it]
test ppl:  24%|██▎       | 56/236 [03:32<12:51,  4.29s/it]
test ppl:  24%|██▍       | 57/236 [03:34<11:14,  3.77s/it]
test ppl:  25%|██▍       | 58/236 [03:36<09:45,  3.29s/it]
test ppl:  25%|██▌       | 59/236 [03:42<11:59,  4.06s/it]
test ppl:  25%|██▌       | 60/236 [03:45<11:10,  3.81s/it]
test ppl:  26%|██▌       | 61/236 [03:51<12:54,  4.43s/it]
test ppl:  26%|██▋       | 62/236 [03:55<12:34,  4.34s/it]
test ppl:  27%|██▋       | 63/236 [03:58<10:53,  3.78s/it]
test ppl:  27%|██▋       | 64/236 [03:59<08:53,  3.10s/it]
test ppl:  28%|██▊       | 65/236 [04:01<07:18,  2.57s/it]
test ppl:  28%|██▊       | 66/236 [04:04<07:36,  2.69s/it]
test ppl:  28%|██▊       | 67/236 [04:08<08:40,  3.08s/it]
test ppl:  29%|██▉       | 68/236 [04:14<10:59,  3.92s/it]
test ppl:  29%|██▉       | 69/236 [04:19<12:32,  4.51s/it]
test ppl:  30%|██▉       | 70/236 [04:21<10:03,  3.64s/it]
test ppl:  30%|███       | 71/236 [04:25<10:18,  3.75s/it]
test ppl:  31%|███       | 72/236 [04:29<10:18,  3.77s/it]
test ppl:  31%|███       | 73/236 [04:33<10:18,  3.79s/it]
test ppl:  31%|███▏      | 74/236 [04:34<08:23,  3.11s/it]
test ppl:  32%|███▏      | 75/236 [04:40<10:33,  3.94s/it]
test ppl:  32%|███▏      | 76/236 [04:44<10:34,  3.96s/it]
test ppl:  33%|███▎      | 77/236 [04:46<09:10,  3.46s/it]
test ppl:  33%|███▎      | 78/236 [04:48<07:53,  3.00s/it]
test ppl:  33%|███▎      | 79/236 [04:53<09:24,  3.60s/it]
test ppl:  34%|███▍      | 80/236 [04:55<08:02,  3.10s/it]
test ppl:  34%|███▍      | 81/236 [05:01<10:09,  3.93s/it]
test ppl:  35%|███▍      | 82/236 [05:07<11:37,  4.53s/it]
test ppl:  35%|███▌      | 83/236 [05:09<09:36,  3.77s/it]
test ppl:  36%|███▌      | 84/236 [05:11<08:07,  3.20s/it]
test ppl:  36%|███▌      | 85/236 [05:17<09:54,  3.94s/it]
test ppl:  36%|███▋      | 86/236 [05:19<08:31,  3.41s/it]
test ppl:  37%|███▋      | 87/236 [05:21<07:29,  3.02s/it]
test ppl:  37%|███▋      | 88/236 [05:27<09:33,  3.88s/it]
test ppl:  38%|███▊      | 89/236 [05:33<10:58,  4.48s/it]
test ppl:  38%|███▊      | 90/236 [05:38<11:55,  4.90s/it]
test ppl:  39%|███▊      | 91/236 [05:44<12:31,  5.18s/it]
test ppl:  39%|███▉      | 92/236 [05:47<10:43,  4.47s/it]
test ppl:  39%|███▉      | 93/236 [05:53<11:38,  4.88s/it]
test ppl:  40%|███▉      | 94/236 [05:59<12:14,  5.17s/it]
test ppl:  40%|████      | 95/236 [06:02<10:52,  4.63s/it]
test ppl:  41%|████      | 96/236 [06:05<09:37,  4.12s/it]
test ppl:  41%|████      | 97/236 [06:11<10:45,  4.65s/it]
test ppl:  42%|████▏     | 98/236 [06:17<11:32,  5.01s/it]
test ppl:  42%|████▏     | 99/236 [06:23<12:02,  5.27s/it]
test ppl:  42%|████▏     | 100/236 [06:24<09:16,  4.09s/it]
test ppl:  43%|████▎     | 101/236 [06:30<10:24,  4.62s/it]
test ppl:  43%|████▎     | 102/236 [06:34<09:39,  4.33s/it]
test ppl:  44%|████▎     | 103/236 [06:36<08:07,  3.66s/it]
test ppl:  44%|████▍     | 104/236 [06:40<08:27,  3.84s/it]
test ppl:  44%|████▍     | 105/236 [06:44<08:26,  3.87s/it]
test ppl:  45%|████▍     | 106/236 [06:49<09:22,  4.33s/it]
test ppl:  45%|████▌     | 107/236 [06:51<07:50,  3.64s/it]
test ppl:  46%|████▌     | 108/236 [06:57<09:06,  4.27s/it]
test ppl:  46%|████▌     | 109/236 [07:02<09:17,  4.39s/it]
test ppl:  47%|████▋     | 110/236 [07:04<07:35,  3.62s/it]
test ppl:  47%|████▋     | 111/236 [07:07<07:44,  3.71s/it]
test ppl:  47%|████▋     | 112/236 [07:10<07:05,  3.43s/it]
test ppl:  48%|████▊     | 113/236 [07:12<06:00,  2.93s/it]
test ppl:  48%|████▊     | 114/236 [07:15<06:13,  3.06s/it]
test ppl:  49%|████▊     | 115/236 [07:21<07:51,  3.90s/it]
test ppl:  49%|████▉     | 116/236 [07:27<08:47,  4.40s/it]
test ppl:  50%|████▉     | 117/236 [07:29<07:12,  3.64s/it]
test ppl:  50%|█████     | 118/236 [07:33<07:35,  3.86s/it]
test ppl:  50%|█████     | 119/236 [07:36<07:12,  3.70s/it]
test ppl:  51%|█████     | 120/236 [07:38<05:46,  2.99s/it]
test ppl:  51%|█████▏    | 121/236 [07:42<06:31,  3.41s/it]
test ppl:  52%|█████▏    | 122/236 [07:47<07:15,  3.82s/it]
test ppl:  52%|█████▏    | 123/236 [07:49<06:15,  3.32s/it]
test ppl:  53%|█████▎    | 124/236 [07:52<05:53,  3.15s/it]
test ppl:  53%|█████▎    | 125/236 [07:55<06:09,  3.33s/it]
test ppl:  53%|█████▎    | 126/236 [07:59<06:17,  3.44s/it]
test ppl:  54%|█████▍    | 127/236 [08:01<05:23,  2.97s/it]
test ppl:  54%|█████▍    | 128/236 [08:03<04:57,  2.76s/it]
test ppl:  55%|█████▍    | 129/236 [08:06<05:01,  2.82s/it]
test ppl:  55%|█████▌    | 130/236 [08:11<05:49,  3.30s/it]
test ppl:  56%|█████▌    | 131/236 [08:17<07:07,  4.08s/it]
test ppl:  56%|█████▌    | 132/236 [08:19<06:14,  3.60s/it]
test ppl:  56%|█████▋    | 133/236 [08:23<06:20,  3.69s/it]
test ppl:  57%|█████▋    | 134/236 [08:29<07:14,  4.26s/it]
test ppl:  57%|█████▋    | 135/236 [08:33<07:29,  4.45s/it]
test ppl:  58%|█████▊    | 136/236 [08:35<05:47,  3.48s/it]
test ppl:  58%|█████▊    | 137/236 [08:41<06:56,  4.21s/it]
test ppl:  58%|█████▊    | 138/236 [08:44<06:22,  3.91s/it]
test ppl:  59%|█████▉    | 139/236 [08:46<05:39,  3.50s/it]
test ppl:  59%|█████▉    | 140/236 [08:48<04:56,  3.08s/it]
test ppl:  60%|█████▉    | 141/236 [08:51<04:47,  3.03s/it]
test ppl:  60%|██████    | 142/236 [08:53<04:18,  2.75s/it]
test ppl:  61%|██████    | 143/236 [08:59<05:43,  3.69s/it]
test ppl:  61%|██████    | 144/236 [09:02<05:13,  3.41s/it]
test ppl:  61%|██████▏   | 145/236 [09:08<06:07,  4.04s/it]
test ppl:  62%|██████▏   | 146/236 [09:12<06:15,  4.17s/it]
test ppl:  62%|██████▏   | 147/236 [09:18<06:56,  4.69s/it]
test ppl:  63%|██████▎   | 148/236 [09:24<07:26,  5.08s/it]
test ppl:  63%|██████▎   | 149/236 [09:27<06:37,  4.57s/it]
test ppl:  64%|██████▎   | 150/236 [09:31<06:19,  4.41s/it]
test ppl:  64%|██████▍   | 151/236 [09:37<06:52,  4.85s/it]
test ppl:  64%|██████▍   | 152/236 [09:43<07:12,  5.15s/it]
test ppl:  65%|██████▍   | 153/236 [09:49<07:24,  5.36s/it]
test ppl:  65%|██████▌   | 154/236 [09:51<06:09,  4.51s/it]
test ppl:  66%|██████▌   | 155/236 [09:54<05:18,  3.93s/it]
test ppl:  66%|██████▌   | 156/236 [09:56<04:32,  3.41s/it]
test ppl:  67%|██████▋   | 157/236 [09:58<04:00,  3.05s/it]
test ppl:  67%|██████▋   | 158/236 [10:04<05:03,  3.89s/it]
test ppl:  67%|██████▋   | 159/236 [10:10<05:45,  4.49s/it]
test ppl:  68%|██████▊   | 160/236 [10:11<04:25,  3.49s/it]
test ppl:  68%|██████▊   | 161/236 [10:13<03:34,  2.86s/it]
test ppl:  69%|██████▊   | 162/236 [10:16<03:32,  2.87s/it]
test ppl:  69%|██████▉   | 163/236 [10:18<03:21,  2.76s/it]
test ppl:  69%|██████▉   | 164/236 [10:22<03:38,  3.03s/it]
test ppl:  70%|██████▉   | 165/236 [10:26<04:01,  3.40s/it]
test ppl:  70%|███████   | 166/236 [10:29<03:56,  3.38s/it]
test ppl:  71%|███████   | 167/236 [10:31<03:13,  2.81s/it]
test ppl:  71%|███████   | 168/236 [10:37<04:13,  3.72s/it]
test ppl:  72%|███████▏  | 169/236 [10:42<04:43,  4.23s/it]
test ppl:  72%|███████▏  | 170/236 [10:48<05:12,  4.73s/it]
test ppl:  72%|███████▏  | 171/236 [10:49<04:01,  3.71s/it]
test ppl:  73%|███████▎  | 172/236 [10:52<03:30,  3.29s/it]
test ppl:  73%|███████▎  | 173/236 [10:55<03:30,  3.34s/it]
test ppl:  74%|███████▎  | 174/236 [11:01<04:14,  4.11s/it]
test ppl:  74%|███████▍  | 175/236 [11:03<03:29,  3.43s/it]
test ppl:  75%|███████▍  | 176/236 [11:08<03:51,  3.86s/it]
test ppl:  75%|███████▌  | 177/236 [11:14<04:23,  4.47s/it]
test ppl:  75%|███████▌  | 178/236 [11:20<04:44,  4.91s/it]
test ppl:  76%|███████▌  | 179/236 [11:26<04:57,  5.22s/it]
test ppl:  76%|███████▋  | 180/236 [11:30<04:41,  5.03s/it]
test ppl:  77%|███████▋  | 181/236 [11:36<04:50,  5.28s/it]
test ppl:  77%|███████▋  | 182/236 [11:38<03:50,  4.26s/it]
test ppl:  78%|███████▊  | 183/236 [11:40<03:14,  3.66s/it]
test ppl:  78%|███████▊  | 184/236 [11:42<02:35,  3.00s/it]
test ppl:  78%|███████▊  | 185/236 [11:46<02:54,  3.41s/it]
test ppl:  79%|███████▉  | 186/236 [11:52<03:27,  4.14s/it]
test ppl:  79%|███████▉  | 187/236 [11:58<03:49,  4.68s/it]
test ppl:  80%|███████▉  | 188/236 [12:04<04:02,  5.04s/it]
test ppl:  80%|████████  | 189/236 [12:10<04:08,  5.29s/it]
test ppl:  81%|████████  | 190/236 [12:14<03:45,  4.91s/it]
test ppl:  81%|████████  | 191/236 [12:18<03:33,  4.74s/it]
test ppl:  81%|████████▏ | 192/236 [12:20<03:00,  4.11s/it]
test ppl:  82%|████████▏ | 193/236 [12:26<03:19,  4.64s/it]
test ppl:  82%|████████▏ | 194/236 [12:29<02:49,  4.03s/it]
test ppl:  83%|████████▎ | 195/236 [12:32<02:33,  3.74s/it]
test ppl:  83%|████████▎ | 196/236 [12:34<02:08,  3.22s/it]
test ppl:  83%|████████▎ | 197/236 [12:37<01:57,  3.02s/it]
test ppl:  84%|████████▍ | 198/236 [12:43<02:27,  3.88s/it]
test ppl:  84%|████████▍ | 199/236 [12:45<02:10,  3.53s/it]
test ppl:  85%|████████▍ | 200/236 [12:51<02:32,  4.23s/it]
test ppl:  85%|████████▌ | 201/236 [12:53<02:04,  3.57s/it]
test ppl:  86%|████████▌ | 202/236 [12:58<02:11,  3.88s/it]
test ppl:  86%|████████▌ | 203/236 [13:04<02:28,  4.49s/it]
test ppl:  86%|████████▋ | 204/236 [13:05<01:54,  3.58s/it]
test ppl:  87%|████████▋ | 205/236 [13:11<02:12,  4.28s/it]
test ppl:  87%|████████▋ | 206/236 [13:14<01:59,  3.98s/it]
test ppl:  88%|████████▊ | 207/236 [13:20<02:11,  4.55s/it]
test ppl:  88%|████████▊ | 208/236 [13:23<01:55,  4.12s/it]
test ppl:  89%|████████▊ | 209/236 [13:29<02:06,  4.67s/it]
test ppl:  89%|████████▉ | 210/236 [13:32<01:43,  3.97s/it]
test ppl:  89%|████████▉ | 211/236 [13:36<01:45,  4.21s/it]
test ppl:  90%|████████▉ | 212/236 [13:41<01:44,  4.37s/it]
test ppl:  90%|█████████ | 213/236 [13:47<01:50,  4.81s/it]
test ppl:  91%|█████████ | 214/236 [13:49<01:24,  3.86s/it]
test ppl:  91%|█████████ | 215/236 [13:54<01:33,  4.47s/it]
test ppl:  92%|█████████▏| 216/236 [13:57<01:17,  3.89s/it]
test ppl:  92%|█████████▏| 217/236 [14:03<01:25,  4.51s/it]
test ppl:  92%|█████████▏| 218/236 [14:05<01:07,  3.74s/it]
test ppl:  93%|█████████▎| 219/236 [14:11<01:14,  4.39s/it]
test ppl:  93%|█████████▎| 220/236 [14:17<01:17,  4.83s/it]
test ppl:  94%|█████████▎| 221/236 [14:20<01:04,  4.31s/it]
test ppl:  94%|█████████▍| 222/236 [14:26<01:06,  4.78s/it]
test ppl:  94%|█████████▍| 223/236 [14:32<01:06,  5.11s/it]
test ppl:  95%|█████████▍| 224/236 [14:33<00:47,  3.96s/it]
test ppl:  95%|█████████▌| 225/236 [14:39<00:49,  4.53s/it]
test ppl:  96%|█████████▌| 226/236 [14:42<00:42,  4.26s/it]
test ppl:  96%|█████████▌| 227/236 [14:45<00:33,  3.69s/it]
test ppl:  97%|█████████▋| 228/236 [14:47<00:25,  3.18s/it]
test ppl:  97%|█████████▋| 229/236 [14:53<00:27,  3.99s/it]
test ppl:  97%|█████████▋| 230/236 [14:56<00:23,  3.84s/it]
test ppl:  98%|█████████▊| 231/236 [14:59<00:18,  3.69s/it]
test ppl:  98%|█████████▊| 232/236 [15:01<00:12,  3.11s/it]
test ppl:  99%|█████████▊| 233/236 [15:05<00:10,  3.39s/it]
test ppl:  99%|█████████▉| 234/236 [15:06<00:05,  2.74s/it]
test ppl: 100%|█████████▉| 235/236 [15:12<00:03,  3.68s/it]
test ppl: 100%|██████████| 236/236 [15:13<00:00,  2.77s/it]
test ppl: 100%|██████████| 236/236 [15:13<00:00,  3.87s/it]
10/12/2024 15:35:13 - INFO - __main__ -    em: 0.2099
10/12/2024 15:35:13 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.2 50:  em: 0.2099

--------------------------------------------------------------------------------
Running experiment with knn_temp=50, lmbda=0.4, k=16
2024-10-12 15:35:20.562747: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 15:35:20.582088: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 15:35:20.603835: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 15:35:20.610443: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 15:35:20.626324: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 15:35:21.615753: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 15:35:22 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.4, knn_temp=50, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 15:35:22 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:38:13,  2.20it/s]
Adding feature api:   4%|▍         | 7279/187062 [00:00<00:10, 17394.91it/s]
Adding feature api:   8%|▊         | 15627/187062 [00:00<00:05, 34213.93it/s]
Adding feature api:  13%|█▎        | 24074/187062 [00:00<00:03, 47613.56it/s]
Adding feature api:  17%|█▋        | 32588/187062 [00:00<00:02, 57963.49it/s]
Adding feature api:  22%|██▏       | 41087/187062 [00:00<00:02, 65601.47it/s]
Adding feature api:  27%|██▋       | 49589/187062 [00:01<00:01, 71186.66it/s]
Adding feature api:  31%|███       | 58079/187062 [00:01<00:01, 75180.07it/s]
Adding feature api:  36%|███▌      | 66612/187062 [00:01<00:01, 78159.99it/s]
Adding feature api:  40%|████      | 75084/187062 [00:01<00:01, 80097.30it/s]
Adding feature api:  45%|████▍     | 83605/187062 [00:01<00:01, 81614.21it/s]
Adding feature api:  49%|████▉     | 92134/187062 [00:01<00:01, 82706.39it/s]
Adding feature api:  54%|█████▍    | 100582/187062 [00:01<00:01, 82794.14it/s]
Adding feature api:  58%|█████▊    | 109124/187062 [00:01<00:00, 83574.47it/s]
Adding feature api:  63%|██████▎   | 117639/187062 [00:01<00:00, 84044.08it/s]
Adding feature api:  67%|██████▋   | 126144/187062 [00:01<00:00, 84341.49it/s]
Adding feature api:  72%|███████▏  | 134693/187062 [00:02<00:00, 84683.38it/s]
Adding feature api:  77%|███████▋  | 143237/187062 [00:02<00:00, 84909.07it/s]
Adding feature api:  81%|████████  | 151767/187062 [00:02<00:00, 85023.43it/s]
Adding feature api:  86%|████████▌ | 160289/187062 [00:02<00:00, 85081.16it/s]
Adding feature api:  90%|█████████ | 168808/187062 [00:02<00:00, 85055.08it/s]
Adding feature api:  95%|█████████▍| 177322/187062 [00:02<00:00, 85077.40it/s]
Adding feature api:  99%|█████████▉| 185835/187062 [00:02<00:00, 54794.16it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64951.70it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:33:58,  2.20it/s]
Adding feature datatype:   4%|▍         | 7126/187062 [00:00<00:10, 17068.01it/s]
Adding feature datatype:   8%|▊         | 15132/187062 [00:00<00:05, 33126.56it/s]
Adding feature datatype:  12%|█▏        | 23241/187062 [00:00<00:03, 45929.71it/s]
Adding feature datatype:  17%|█▋        | 31415/187062 [00:00<00:02, 55814.72it/s]
Adding feature datatype:  21%|██        | 39611/187062 [00:00<00:02, 63208.49it/s]
Adding feature datatype:  26%|██▌       | 47805/187062 [00:01<00:02, 68597.32it/s]
Adding feature datatype:  30%|██▉       | 55956/187062 [00:01<00:01, 72357.91it/s]
Adding feature datatype:  34%|███▍      | 64097/187062 [00:01<00:01, 75016.59it/s]
Adding feature datatype:  39%|███▊      | 72307/187062 [00:01<00:01, 77108.50it/s]
Adding feature datatype:  43%|████▎     | 80444/187062 [00:01<00:01, 78371.12it/s]
Adding feature datatype:  47%|████▋     | 88611/187062 [00:01<00:01, 79351.14it/s]
Adding feature datatype:  52%|█████▏    | 96826/187062 [00:01<00:01, 80183.34it/s]
Adding feature datatype:  56%|█████▌    | 105004/187062 [00:01<00:01, 80659.05it/s]
Adding feature datatype:  60%|██████    | 113157/187062 [00:01<00:00, 80918.78it/s]
Adding feature datatype:  65%|██████▍   | 121308/187062 [00:01<00:00, 80905.92it/s]
Adding feature datatype:  69%|██████▉   | 129548/187062 [00:02<00:00, 81351.25it/s]
Adding feature datatype:  74%|███████▎  | 137793/187062 [00:02<00:00, 81673.59it/s]
Adding feature datatype:  78%|███████▊  | 145982/187062 [00:02<00:00, 81735.34it/s]
Adding feature datatype:  82%|████████▏ | 154219/187062 [00:02<00:00, 81924.39it/s]
Adding feature datatype:  87%|████████▋ | 162422/187062 [00:02<00:00, 81950.04it/s]
Adding feature datatype:  91%|█████████ | 170626/187062 [00:02<00:00, 81974.17it/s]
Adding feature datatype:  96%|█████████▌| 178829/187062 [00:02<00:00, 75916.73it/s]
Adding feature datatype: 100%|█████████▉| 186514/187062 [00:02<00:00, 52225.29it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63197.01it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:14:56,  2.23it/s]
Adding feature literal:   4%|▍         | 7082/187062 [00:00<00:10, 17138.12it/s]
Adding feature literal:   8%|▊         | 15175/187062 [00:00<00:05, 33525.33it/s]
Adding feature literal:  12%|█▏        | 23342/187062 [00:00<00:03, 46449.70it/s]
Adding feature literal:  17%|█▋        | 31440/187062 [00:00<00:02, 56021.15it/s]
Adding feature literal:  21%|██        | 39625/187062 [00:00<00:02, 63346.13it/s]
Adding feature literal:  26%|██▌       | 47762/187062 [00:01<00:02, 68543.13it/s]
Adding feature literal:  30%|██▉       | 55873/187062 [00:01<00:01, 72208.95it/s]
Adding feature literal:  34%|███▍      | 64006/187062 [00:01<00:01, 74890.35it/s]
Adding feature literal:  38%|███▊      | 71964/187062 [00:01<00:01, 76247.70it/s]
Adding feature literal:  43%|████▎     | 80114/187062 [00:01<00:01, 77805.58it/s]
Adding feature literal:  47%|████▋     | 88129/187062 [00:01<00:01, 78493.66it/s]
Adding feature literal:  51%|█████▏    | 96224/187062 [00:01<00:01, 79224.72it/s]
Adding feature literal:  56%|█████▌    | 104427/187062 [00:01<00:01, 80060.98it/s]
Adding feature literal:  60%|██████    | 112515/187062 [00:01<00:00, 80202.19it/s]
Adding feature literal:  65%|██████▍   | 120657/187062 [00:01<00:00, 80563.31it/s]
Adding feature literal:  69%|██████▉   | 128842/187062 [00:02<00:00, 80946.02it/s]
Adding feature literal:  73%|███████▎  | 137052/187062 [00:02<00:00, 81290.38it/s]
Adding feature literal:  78%|███████▊  | 145209/187062 [00:02<00:00, 81373.57it/s]
Adding feature literal:  82%|████████▏ | 153387/187062 [00:02<00:00, 81480.47it/s]
Adding feature literal:  86%|████████▋ | 161582/187062 [00:02<00:00, 81620.69it/s]
Adding feature literal:  91%|█████████ | 169751/187062 [00:02<00:00, 81520.67it/s]
Adding feature literal:  95%|█████████▌| 177908/187062 [00:02<00:00, 79846.79it/s]
Adding feature literal:  99%|█████████▉| 185904/187062 [00:02<00:00, 52709.42it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63042.47it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:10:09,  2.24it/s]
Adding feature operator:   4%|▍         | 7135/187062 [00:00<00:10, 17311.32it/s]
Adding feature operator:   8%|▊         | 15255/187062 [00:00<00:05, 33755.28it/s]
Adding feature operator:  13%|█▎        | 23385/187062 [00:00<00:03, 46536.10it/s]
Adding feature operator:  17%|█▋        | 31586/187062 [00:00<00:02, 56377.69it/s]
Adding feature operator:  21%|██        | 39566/187062 [00:00<00:02, 63025.07it/s]
Adding feature operator:  26%|██▌       | 47818/187062 [00:01<00:02, 68648.80it/s]
Adding feature operator:  30%|██▉       | 55954/187062 [00:01<00:01, 72357.85it/s]
Adding feature operator:  34%|███▍      | 64192/187062 [00:01<00:01, 75305.59it/s]
Adding feature operator:  39%|███▊      | 72438/187062 [00:01<00:01, 77420.20it/s]
Adding feature operator:  43%|████▎     | 80663/187062 [00:01<00:01, 78853.99it/s]
Adding feature operator:  48%|████▊     | 88903/187062 [00:01<00:01, 79908.26it/s]
Adding feature operator:  52%|█████▏    | 97108/187062 [00:01<00:01, 80545.32it/s]
Adding feature operator:  56%|█████▋    | 105314/187062 [00:01<00:01, 80997.60it/s]
Adding feature operator:  61%|██████    | 113580/187062 [00:01<00:00, 81492.33it/s]
Adding feature operator:  65%|██████▌   | 121799/187062 [00:01<00:00, 81699.67it/s]
Adding feature operator:  70%|██████▉   | 130010/187062 [00:02<00:00, 81749.82it/s]
Adding feature operator:  74%|███████▍  | 138219/187062 [00:02<00:00, 81848.94it/s]
Adding feature operator:  78%|███████▊  | 146470/187062 [00:02<00:00, 82046.38it/s]
Adding feature operator:  83%|████████▎ | 154689/187062 [00:02<00:00, 81533.11it/s]
Adding feature operator:  87%|████████▋ | 162955/187062 [00:02<00:00, 81866.27it/s]
Adding feature operator:  92%|█████████▏| 171200/187062 [00:02<00:00, 82040.30it/s]
Adding feature operator:  96%|█████████▌| 179410/187062 [00:02<00:00, 73526.49it/s]
Adding feature operator: 100%|█████████▉| 186932/187062 [00:02<00:00, 52068.27it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63538.44it/s]
[2024-10-12 15:36:06,394] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 15:36:07 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 15:36:07 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 42/6548 [00:00<00:16, 388.54 examples/s]
Map:   1%|▏         | 84/6548 [00:00<00:30, 209.92 examples/s]
Map:   2%|▏         | 125/6548 [00:00<00:24, 262.32 examples/s]
Map:   3%|▎         | 173/6548 [00:00<00:19, 323.15 examples/s]
Map:   3%|▎         | 214/6548 [00:00<00:18, 346.95 examples/s]
Map:   4%|▍         | 260/6548 [00:00<00:19, 320.07 examples/s]
Map:   5%|▍         | 302/6548 [00:00<00:19, 319.41 examples/s]
Map:   5%|▌         | 347/6548 [00:01<00:20, 307.47 examples/s]
Map:   6%|▌         | 385/6548 [00:01<00:19, 323.94 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:17, 356.41 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:17, 342.22 examples/s]
Map:   8%|▊         | 511/6548 [00:01<00:17, 353.05 examples/s]
Map:   9%|▊         | 565/6548 [00:01<00:14, 399.93 examples/s]
Map:   9%|▉         | 607/6548 [00:01<00:15, 387.35 examples/s]
Map:  10%|▉         | 650/6548 [00:01<00:17, 337.39 examples/s]
Map:  11%|█         | 693/6548 [00:02<00:16, 357.66 examples/s]
Map:  11%|█         | 734/6548 [00:02<00:15, 370.60 examples/s]
Map:  12%|█▏        | 788/6548 [00:02<00:13, 413.65 examples/s]
Map:  13%|█▎        | 831/6548 [00:02<00:13, 412.81 examples/s]
Map:  13%|█▎        | 877/6548 [00:02<00:13, 422.42 examples/s]
Map:  14%|█▍        | 931/6548 [00:02<00:14, 381.95 examples/s]
Map:  15%|█▍        | 982/6548 [00:02<00:15, 356.32 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:23, 237.15 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:20, 261.31 examples/s]
Map:  17%|█▋        | 1126/6548 [00:03<00:17, 301.86 examples/s]
Map:  18%|█▊        | 1167/6548 [00:03<00:16, 322.34 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 338.85 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:15, 351.92 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:14, 364.47 examples/s]
Map:  20%|██        | 1336/6548 [00:04<00:15, 328.27 examples/s]
Map:  21%|██        | 1381/6548 [00:04<00:16, 309.82 examples/s]
Map:  22%|██▏       | 1420/6548 [00:04<00:15, 326.55 examples/s]
Map:  22%|██▏       | 1461/6548 [00:04<00:17, 292.62 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:16, 298.21 examples/s]
Map:  24%|██▎       | 1542/6548 [00:04<00:16, 294.90 examples/s]
Map:  24%|██▍       | 1579/6548 [00:04<00:16, 309.41 examples/s]
Map:  25%|██▍       | 1622/6548 [00:04<00:17, 287.12 examples/s]
Map:  25%|██▌       | 1655/6548 [00:05<00:17, 286.83 examples/s]
Map:  26%|██▌       | 1695/6548 [00:05<00:15, 308.45 examples/s]
Map:  26%|██▋       | 1735/6548 [00:05<00:14, 330.20 examples/s]
Map:  27%|██▋       | 1780/6548 [00:05<00:13, 360.50 examples/s]
Map:  28%|██▊       | 1843/6548 [00:05<00:12, 375.58 examples/s]
Map:  29%|██▉       | 1890/6548 [00:05<00:13, 346.63 examples/s]
Map:  30%|██▉       | 1933/6548 [00:05<00:12, 363.63 examples/s]
Map:  30%|███       | 1973/6548 [00:05<00:12, 372.46 examples/s]
Map:  31%|███       | 2019/6548 [00:06<00:18, 244.79 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:16, 268.28 examples/s]
Map:  32%|███▏      | 2107/6548 [00:06<00:15, 281.54 examples/s]
Map:  33%|███▎      | 2152/6548 [00:06<00:16, 270.83 examples/s]
Map:  33%|███▎      | 2192/6548 [00:06<00:14, 297.55 examples/s]
Map:  34%|███▍      | 2229/6548 [00:06<00:15, 284.29 examples/s]
Map:  35%|███▍      | 2271/6548 [00:07<00:15, 269.18 examples/s]
Map:  35%|███▌      | 2310/6548 [00:07<00:14, 292.67 examples/s]
Map:  36%|███▌      | 2352/6548 [00:07<00:13, 321.24 examples/s]
Map:  37%|███▋      | 2397/6548 [00:07<00:13, 309.13 examples/s]
Map:  37%|███▋      | 2438/6548 [00:07<00:13, 308.17 examples/s]
Map:  38%|███▊      | 2477/6548 [00:07<00:12, 318.84 examples/s]
Map:  38%|███▊      | 2517/6548 [00:07<00:12, 334.94 examples/s]
Map:  39%|███▉      | 2562/6548 [00:07<00:11, 359.80 examples/s]
Map:  40%|███▉      | 2608/6548 [00:08<00:10, 382.35 examples/s]
Map:  41%|████      | 2653/6548 [00:08<00:09, 400.23 examples/s]
Map:  41%|████▏     | 2704/6548 [00:08<00:10, 364.59 examples/s]
Map:  42%|████▏     | 2763/6548 [00:08<00:10, 367.99 examples/s]
Map:  43%|████▎     | 2811/6548 [00:08<00:10, 345.66 examples/s]
Map:  44%|████▎     | 2862/6548 [00:08<00:12, 302.93 examples/s]
Map:  44%|████▍     | 2900/6548 [00:08<00:11, 304.96 examples/s]
Map:  45%|████▌     | 2952/6548 [00:09<00:11, 316.19 examples/s]
Map:  46%|████▌     | 2988/6548 [00:09<00:11, 314.80 examples/s]
Map:  46%|████▌     | 3027/6548 [00:09<00:19, 180.21 examples/s]
Map:  47%|████▋     | 3062/6548 [00:09<00:17, 204.97 examples/s]
Map:  47%|████▋     | 3091/6548 [00:09<00:16, 215.44 examples/s]
Map:  48%|████▊     | 3133/6548 [00:10<00:13, 253.28 examples/s]
Map:  48%|████▊     | 3173/6548 [00:10<00:13, 255.83 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 249.16 examples/s]
Map:  49%|████▉     | 3238/6548 [00:10<00:12, 267.69 examples/s]
Map:  50%|████▉     | 3272/6548 [00:10<00:11, 279.91 examples/s]
Map:  50%|█████     | 3305/6548 [00:10<00:11, 289.54 examples/s]
Map:  51%|█████     | 3348/6548 [00:10<00:10, 310.44 examples/s]
Map:  52%|█████▏    | 3389/6548 [00:10<00:11, 284.02 examples/s]
Map:  52%|█████▏    | 3424/6548 [00:11<00:10, 299.25 examples/s]
Map:  53%|█████▎    | 3459/6548 [00:11<00:11, 262.67 examples/s]
Map:  53%|█████▎    | 3497/6548 [00:11<00:10, 287.59 examples/s]
Map:  54%|█████▍    | 3546/6548 [00:11<00:08, 334.66 examples/s]
Map:  55%|█████▍    | 3595/6548 [00:11<00:07, 373.86 examples/s]
Map:  56%|█████▌    | 3639/6548 [00:11<00:07, 384.36 examples/s]
Map:  56%|█████▋    | 3698/6548 [00:11<00:07, 382.92 examples/s]
Map:  57%|█████▋    | 3741/6548 [00:11<00:07, 393.53 examples/s]
Map:  58%|█████▊    | 3799/6548 [00:12<00:07, 390.05 examples/s]
Map:  59%|█████▊    | 3841/6548 [00:12<00:08, 335.93 examples/s]
Map:  59%|█████▉    | 3882/6548 [00:12<00:08, 310.94 examples/s]
Map:  60%|█████▉    | 3917/6548 [00:12<00:08, 318.57 examples/s]
Map:  60%|██████    | 3956/6548 [00:12<00:07, 324.10 examples/s]
Map:  61%|██████    | 4000/6548 [00:12<00:11, 226.98 examples/s]
Map:  62%|██████▏   | 4049/6548 [00:12<00:09, 274.24 examples/s]
Map:  62%|██████▏   | 4091/6548 [00:13<00:08, 301.01 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 320.00 examples/s]
Map:  64%|██████▎   | 4172/6548 [00:13<00:08, 287.61 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:13<00:07, 301.64 examples/s]
Map:  65%|██████▌   | 4259/6548 [00:13<00:06, 341.76 examples/s]
Map:  66%|██████▌   | 4298/6548 [00:13<00:06, 344.26 examples/s]
Map:  66%|██████▋   | 4345/6548 [00:13<00:05, 374.99 examples/s]
Map:  67%|██████▋   | 4388/6548 [00:13<00:06, 335.44 examples/s]
Map:  68%|██████▊   | 4428/6548 [00:14<00:06, 350.52 examples/s]
Map:  68%|██████▊   | 4469/6548 [00:14<00:06, 320.83 examples/s]
Map:  69%|██████▉   | 4512/6548 [00:14<00:06, 305.84 examples/s]
Map:  69%|██████▉   | 4546/6548 [00:14<00:06, 305.47 examples/s]
Map:  70%|███████   | 4584/6548 [00:14<00:06, 314.31 examples/s]
Map:  71%|███████   | 4632/6548 [00:14<00:05, 349.12 examples/s]
Map:  71%|███████▏  | 4673/6548 [00:14<00:05, 360.79 examples/s]
Map:  72%|███████▏  | 4730/6548 [00:14<00:05, 356.09 examples/s]
Map:  73%|███████▎  | 4779/6548 [00:15<00:04, 387.43 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 387.60 examples/s]
Map:  74%|███████▍  | 4876/6548 [00:15<00:04, 359.14 examples/s]
Map:  75%|███████▌  | 4936/6548 [00:15<00:04, 370.12 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:04, 386.13 examples/s]
Map:  77%|███████▋  | 5039/6548 [00:16<00:06, 251.41 examples/s]
Map:  78%|███████▊  | 5084/6548 [00:16<00:05, 259.89 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 267.43 examples/s]
Map:  79%|███████▉  | 5174/6548 [00:16<00:04, 285.47 examples/s]
Map:  80%|███████▉  | 5206/6548 [00:16<00:04, 280.01 examples/s]
Map:  80%|████████  | 5250/6548 [00:16<00:04, 279.73 examples/s]
Map:  81%|████████  | 5286/6548 [00:16<00:04, 295.54 examples/s]
Map:  81%|████████  | 5320/6548 [00:16<00:04, 297.14 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:04, 285.87 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:04, 284.40 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 316.91 examples/s]
Map:  84%|████████▍ | 5500/6548 [00:17<00:03, 312.30 examples/s]
Map:  85%|████████▍ | 5538/6548 [00:17<00:03, 326.88 examples/s]
Map:  85%|████████▌ | 5572/6548 [00:17<00:03, 318.32 examples/s]
Map:  86%|████████▌ | 5610/6548 [00:17<00:02, 322.21 examples/s]
Map:  86%|████████▌ | 5647/6548 [00:17<00:02, 331.18 examples/s]
Map:  87%|████████▋ | 5692/6548 [00:18<00:02, 314.94 examples/s]
Map:  88%|████████▊ | 5733/6548 [00:18<00:02, 337.54 examples/s]
Map:  88%|████████▊ | 5772/6548 [00:18<00:02, 350.45 examples/s]
Map:  89%|████████▊ | 5808/6548 [00:18<00:02, 349.25 examples/s]
Map:  89%|████████▉ | 5846/6548 [00:18<00:01, 354.56 examples/s]
Map:  90%|█████████ | 5897/6548 [00:18<00:01, 343.45 examples/s]
Map:  91%|█████████ | 5935/6548 [00:18<00:01, 350.80 examples/s]
Map:  91%|█████████▏| 5987/6548 [00:18<00:01, 345.49 examples/s]
Map:  92%|█████████▏| 6024/6548 [00:19<00:02, 217.73 examples/s]
Map:  92%|█████████▏| 6052/6548 [00:19<00:02, 226.02 examples/s]
Map:  93%|█████████▎| 6086/6548 [00:19<00:01, 247.41 examples/s]
Map:  93%|█████████▎| 6117/6548 [00:19<00:01, 252.48 examples/s]
Map:  94%|█████████▍| 6147/6548 [00:19<00:01, 262.31 examples/s]
Map:  94%|█████████▍| 6185/6548 [00:19<00:01, 290.44 examples/s]
Map:  95%|█████████▌| 6226/6548 [00:19<00:01, 320.59 examples/s]
Map:  96%|█████████▌| 6264/6548 [00:20<00:00, 332.34 examples/s]
Map:  96%|█████████▋| 6304/6548 [00:20<00:00, 348.55 examples/s]
Map:  97%|█████████▋| 6356/6548 [00:20<00:00, 341.00 examples/s]
Map:  98%|█████████▊| 6393/6548 [00:20<00:00, 346.44 examples/s]
Map:  98%|█████████▊| 6437/6548 [00:20<00:00, 366.97 examples/s]
Map:  99%|█████████▉| 6486/6548 [00:20<00:00, 396.57 examples/s]
Map: 100%|█████████▉| 6539/6548 [00:20<00:00, 378.43 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 313.24 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▎         | 33/903 [00:00<00:02, 314.85 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 344.93 examples/s]
Map:  13%|█▎        | 119/903 [00:00<00:02, 329.95 examples/s]
Map:  18%|█▊        | 164/903 [00:00<00:02, 368.46 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 391.09 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 397.05 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 388.64 examples/s]
Map:  40%|███▉      | 357/903 [00:00<00:01, 340.70 examples/s]
Map:  44%|████▎     | 395/903 [00:01<00:01, 304.13 examples/s]
Map:  48%|████▊     | 436/903 [00:01<00:01, 307.14 examples/s]
Map:  53%|█████▎    | 475/903 [00:01<00:01, 321.42 examples/s]
Map:  59%|█████▊    | 530/903 [00:01<00:01, 335.34 examples/s]
Map:  63%|██████▎   | 570/903 [00:01<00:00, 345.13 examples/s]
Map:  68%|██████▊   | 614/903 [00:01<00:00, 354.11 examples/s]
Map:  72%|███████▏  | 653/903 [00:01<00:00, 360.49 examples/s]
Map:  77%|███████▋  | 696/903 [00:01<00:00, 375.61 examples/s]
Map:  82%|████████▏ | 742/903 [00:02<00:00, 397.17 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 392.70 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 391.95 examples/s]
Map:  98%|█████████▊| 886/903 [00:02<00:00, 377.97 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 328.50 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 285.48 examples/s]
Map:   4%|▍         | 82/1882 [00:00<00:04, 361.66 examples/s]
Map:   7%|▋         | 135/1882 [00:00<00:05, 340.50 examples/s]
Map:  10%|▉         | 179/1882 [00:00<00:04, 371.63 examples/s]
Map:  12%|█▏        | 223/1882 [00:00<00:04, 333.70 examples/s]
Map:  14%|█▍        | 267/1882 [00:00<00:04, 357.21 examples/s]
Map:  17%|█▋        | 325/1882 [00:00<00:04, 355.17 examples/s]
Map:  20%|█▉        | 369/1882 [00:01<00:04, 327.86 examples/s]
Map:  22%|██▏       | 407/1882 [00:01<00:05, 290.66 examples/s]
Map:  24%|██▎       | 445/1882 [00:01<00:04, 308.70 examples/s]
Map:  26%|██▋       | 495/1882 [00:01<00:04, 313.12 examples/s]
Map:  29%|██▉       | 543/1882 [00:01<00:04, 308.29 examples/s]
Map:  31%|███       | 580/1882 [00:01<00:04, 321.05 examples/s]
Map:  34%|███▍      | 638/1882 [00:01<00:03, 380.59 examples/s]
Map:  37%|███▋      | 692/1882 [00:02<00:03, 364.00 examples/s]
Map:  39%|███▉      | 732/1882 [00:02<00:03, 368.06 examples/s]
Map:  41%|████      | 773/1882 [00:02<00:03, 355.16 examples/s]
Map:  44%|████▍     | 826/1882 [00:02<00:03, 346.23 examples/s]
Map:  46%|████▌     | 867/1882 [00:02<00:02, 354.80 examples/s]
Map:  48%|████▊     | 908/1882 [00:02<00:02, 359.34 examples/s]
Map:  51%|█████     | 956/1882 [00:02<00:02, 389.31 examples/s]
Map:  53%|█████▎    | 1000/1882 [00:03<00:03, 237.72 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 262.88 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:02, 274.58 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 285.04 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 292.27 examples/s]
Map:  62%|██████▏   | 1176/1882 [00:03<00:02, 307.10 examples/s]
Map:  65%|██████▌   | 1229/1882 [00:03<00:02, 284.99 examples/s]
Map:  67%|██████▋   | 1266/1882 [00:03<00:02, 302.94 examples/s]
Map:  69%|██████▉   | 1307/1882 [00:04<00:01, 327.50 examples/s]
Map:  72%|███████▏  | 1346/1882 [00:04<00:01, 339.01 examples/s]
Map:  74%|███████▍  | 1392/1882 [00:04<00:01, 319.49 examples/s]
Map:  76%|███████▌  | 1426/1882 [00:04<00:01, 276.41 examples/s]
Map:  78%|███████▊  | 1466/1882 [00:04<00:01, 304.01 examples/s]
Map:  80%|████████  | 1506/1882 [00:04<00:01, 266.82 examples/s]
Map:  82%|████████▏ | 1537/1882 [00:04<00:01, 274.33 examples/s]
Map:  84%|████████▍ | 1584/1882 [00:05<00:01, 284.62 examples/s]
Map:  86%|████████▌ | 1622/1882 [00:05<00:00, 305.28 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 313.47 examples/s]
Map:  91%|█████████ | 1713/1882 [00:05<00:00, 325.06 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 281.51 examples/s]
Map:  96%|█████████▌| 1799/1882 [00:05<00:00, 287.62 examples/s]
Map:  98%|█████████▊| 1844/1882 [00:05<00:00, 320.52 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 234.33 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 306.58 examples/s]
10/12/2024 15:37:09 - INFO - __main__ -     ***** Testing *****
10/12/2024 15:37:09 - INFO - __main__ -     Batch size = 8
10/12/2024 15:37:09 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 15:37:10 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 15:37:10 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 15:37:11 - INFO - knnlm -   Reading datastore took 0.9679348468780518 s
10/12/2024 15:37:11 - INFO - knnlm -   Moving index to GPU took 0.9103801250457764 s
10/12/2024 15:37:11 - INFO - __main__ -   ******************************break-into
10/12/2024 15:37:11 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 15:37:11 - INFO - __main__ -     Num examples = 236
10/12/2024 15:37:11 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<32:38,  8.34s/it]
test ppl:   1%|          | 2/236 [00:10<17:46,  4.56s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:17,  3.17s/it]
test ppl:   2%|▏         | 4/236 [00:17<16:23,  4.24s/it]
test ppl:   2%|▏         | 5/236 [00:23<18:37,  4.84s/it]
test ppl:   3%|▎         | 6/236 [00:29<19:55,  5.20s/it]
test ppl:   3%|▎         | 7/236 [00:31<15:42,  4.12s/it]
test ppl:   3%|▎         | 8/236 [00:35<15:51,  4.18s/it]
test ppl:   4%|▍         | 9/236 [00:37<13:21,  3.53s/it]
test ppl:   4%|▍         | 10/236 [00:40<11:55,  3.17s/it]
test ppl:   5%|▍         | 11/236 [00:42<10:57,  2.92s/it]
test ppl:   5%|▌         | 12/236 [00:48<14:18,  3.83s/it]
test ppl:   6%|▌         | 13/236 [00:54<16:33,  4.46s/it]
test ppl:   6%|▌         | 14/236 [00:56<14:07,  3.82s/it]
test ppl:   6%|▋         | 15/236 [00:57<11:15,  3.06s/it]
test ppl:   7%|▋         | 16/236 [00:59<09:53,  2.70s/it]
test ppl:   7%|▋         | 17/236 [01:05<13:20,  3.66s/it]
test ppl:   8%|▊         | 18/236 [01:07<11:08,  3.07s/it]
test ppl:   8%|▊         | 19/236 [01:11<12:36,  3.48s/it]
test ppl:   8%|▊         | 20/236 [01:13<10:42,  2.97s/it]
test ppl:   9%|▉         | 21/236 [01:18<12:47,  3.57s/it]
test ppl:   9%|▉         | 22/236 [01:24<15:14,  4.27s/it]
test ppl:  10%|▉         | 23/236 [01:26<13:18,  3.75s/it]
test ppl:  10%|█         | 24/236 [01:29<11:46,  3.33s/it]
test ppl:  11%|█         | 25/236 [01:31<10:03,  2.86s/it]
test ppl:  11%|█         | 26/236 [01:37<13:13,  3.78s/it]
test ppl:  11%|█▏        | 27/236 [01:40<12:50,  3.69s/it]
test ppl:  12%|█▏        | 28/236 [01:41<10:12,  2.94s/it]
test ppl:  12%|█▏        | 29/236 [01:44<09:32,  2.76s/it]
test ppl:  13%|█▎        | 30/236 [01:45<08:13,  2.39s/it]
test ppl:  13%|█▎        | 31/236 [01:47<07:47,  2.28s/it]
test ppl:  14%|█▎        | 32/236 [01:50<08:08,  2.39s/it]
test ppl:  14%|█▍        | 33/236 [01:56<11:41,  3.46s/it]
test ppl:  14%|█▍        | 34/236 [02:00<12:13,  3.63s/it]
test ppl:  15%|█▍        | 35/236 [02:02<11:03,  3.30s/it]
test ppl:  15%|█▌        | 36/236 [02:08<13:35,  4.08s/it]
test ppl:  16%|█▌        | 37/236 [02:14<15:22,  4.63s/it]
test ppl:  16%|█▌        | 38/236 [02:16<12:45,  3.87s/it]
test ppl:  17%|█▋        | 39/236 [02:18<10:39,  3.25s/it]
test ppl:  17%|█▋        | 40/236 [02:21<09:59,  3.06s/it]
test ppl:  17%|█▋        | 41/236 [02:22<08:47,  2.70s/it]
test ppl:  18%|█▊        | 42/236 [02:28<11:52,  3.67s/it]
test ppl:  18%|█▊        | 43/236 [02:34<13:57,  4.34s/it]
test ppl:  19%|█▊        | 44/236 [02:37<12:07,  3.79s/it]
test ppl:  19%|█▉        | 45/236 [02:39<10:20,  3.25s/it]
test ppl:  19%|█▉        | 46/236 [02:45<12:51,  4.06s/it]
test ppl:  20%|█▉        | 47/236 [02:46<10:24,  3.30s/it]
test ppl:  20%|██        | 48/236 [02:52<12:47,  4.08s/it]
test ppl:  21%|██        | 49/236 [02:56<12:26,  3.99s/it]
test ppl:  21%|██        | 50/236 [03:02<14:14,  4.59s/it]
test ppl:  22%|██▏       | 51/236 [03:06<14:03,  4.56s/it]
test ppl:  22%|██▏       | 52/236 [03:12<15:13,  4.97s/it]
test ppl:  22%|██▏       | 53/236 [03:16<14:15,  4.67s/it]
test ppl:  23%|██▎       | 54/236 [03:18<11:20,  3.74s/it]
test ppl:  23%|██▎       | 55/236 [03:24<13:05,  4.34s/it]
test ppl:  24%|██▎       | 56/236 [03:30<14:27,  4.82s/it]
test ppl:  24%|██▍       | 57/236 [03:32<12:08,  4.07s/it]
test ppl:  25%|██▍       | 58/236 [03:34<10:25,  3.51s/it]
test ppl:  25%|██▌       | 59/236 [03:40<12:30,  4.24s/it]
test ppl:  25%|██▌       | 60/236 [03:43<11:21,  3.87s/it]
test ppl:  26%|██▌       | 61/236 [03:49<13:04,  4.48s/it]
test ppl:  26%|██▋       | 62/236 [03:53<12:42,  4.38s/it]
test ppl:  27%|██▋       | 63/236 [03:56<10:58,  3.81s/it]
test ppl:  27%|██▋       | 64/236 [03:58<09:18,  3.25s/it]
test ppl:  28%|██▊       | 65/236 [03:59<07:36,  2.67s/it]
test ppl:  28%|██▊       | 66/236 [04:02<07:52,  2.78s/it]
test ppl:  28%|██▊       | 67/236 [04:05<07:54,  2.81s/it]
test ppl:  29%|██▉       | 68/236 [04:11<10:27,  3.73s/it]
test ppl:  29%|██▉       | 69/236 [04:17<12:11,  4.38s/it]
test ppl:  30%|██▉       | 70/236 [04:18<09:33,  3.46s/it]
test ppl:  30%|███       | 71/236 [04:21<09:24,  3.42s/it]
test ppl:  31%|███       | 72/236 [04:25<09:41,  3.55s/it]
test ppl:  31%|███       | 73/236 [04:31<11:34,  4.26s/it]
test ppl:  31%|███▏      | 74/236 [04:32<09:16,  3.44s/it]
test ppl:  32%|███▏      | 75/236 [04:38<11:13,  4.18s/it]
test ppl:  32%|███▏      | 76/236 [04:42<10:26,  3.91s/it]
test ppl:  33%|███▎      | 77/236 [04:44<09:04,  3.43s/it]
test ppl:  33%|███▎      | 78/236 [04:45<07:31,  2.86s/it]
test ppl:  33%|███▎      | 79/236 [04:49<08:19,  3.18s/it]
test ppl:  34%|███▍      | 80/236 [04:51<07:14,  2.78s/it]
test ppl:  34%|███▍      | 81/236 [04:57<09:35,  3.71s/it]
test ppl:  35%|███▍      | 82/236 [05:03<11:14,  4.38s/it]
test ppl:  35%|███▌      | 83/236 [05:09<12:20,  4.84s/it]
test ppl:  36%|███▌      | 84/236 [05:11<10:25,  4.12s/it]
test ppl:  36%|███▌      | 85/236 [05:16<10:23,  4.13s/it]
test ppl:  36%|███▋      | 86/236 [05:18<08:39,  3.46s/it]
test ppl:  37%|███▋      | 87/236 [05:20<08:01,  3.23s/it]
test ppl:  37%|███▋      | 88/236 [05:26<09:56,  4.03s/it]
test ppl:  38%|███▊      | 89/236 [05:32<11:15,  4.59s/it]
test ppl:  38%|███▊      | 90/236 [05:38<12:07,  4.99s/it]
test ppl:  39%|███▊      | 91/236 [05:43<12:04,  5.00s/it]
test ppl:  39%|███▉      | 92/236 [05:46<10:26,  4.35s/it]
test ppl:  39%|███▉      | 93/236 [05:52<11:27,  4.81s/it]
test ppl:  40%|███▉      | 94/236 [05:58<12:08,  5.13s/it]
test ppl:  40%|████      | 95/236 [05:59<09:48,  4.18s/it]
test ppl:  41%|████      | 96/236 [06:02<08:53,  3.81s/it]
test ppl:  41%|████      | 97/236 [06:08<10:16,  4.44s/it]
test ppl:  42%|████▏     | 98/236 [06:14<11:13,  4.88s/it]
test ppl:  42%|████▏     | 99/236 [06:20<11:50,  5.18s/it]
test ppl:  42%|████▏     | 100/236 [06:21<09:04,  4.00s/it]
test ppl:  43%|████▎     | 101/236 [06:27<10:16,  4.57s/it]
test ppl:  43%|████▎     | 102/236 [06:31<09:42,  4.35s/it]
test ppl:  44%|████▎     | 103/236 [06:33<07:42,  3.47s/it]
test ppl:  44%|████▍     | 104/236 [06:37<08:10,  3.71s/it]
test ppl:  44%|████▍     | 105/236 [06:41<08:34,  3.93s/it]
test ppl:  45%|████▍     | 106/236 [06:47<09:29,  4.38s/it]
test ppl:  45%|████▌     | 107/236 [06:49<07:50,  3.64s/it]
test ppl:  46%|████▌     | 108/236 [06:54<09:05,  4.26s/it]
test ppl:  46%|████▌     | 109/236 [06:59<09:17,  4.39s/it]
test ppl:  47%|████▋     | 110/236 [07:01<07:27,  3.55s/it]
test ppl:  47%|████▋     | 111/236 [07:05<07:40,  3.68s/it]
test ppl:  47%|████▋     | 112/236 [07:08<07:26,  3.60s/it]
test ppl:  48%|████▊     | 113/236 [07:10<06:15,  3.06s/it]
test ppl:  48%|████▊     | 114/236 [07:13<06:25,  3.16s/it]
test ppl:  49%|████▊     | 115/236 [07:19<08:01,  3.98s/it]
test ppl:  49%|████▉     | 116/236 [07:25<09:06,  4.56s/it]
test ppl:  50%|████▉     | 117/236 [07:27<07:25,  3.75s/it]
test ppl:  50%|█████     | 118/236 [07:33<08:37,  4.39s/it]
test ppl:  50%|█████     | 119/236 [07:35<07:34,  3.89s/it]
test ppl:  51%|█████     | 120/236 [07:37<06:09,  3.18s/it]
test ppl:  51%|█████▏    | 121/236 [07:43<07:39,  4.00s/it]
test ppl:  52%|█████▏    | 122/236 [07:48<08:03,  4.24s/it]
test ppl:  52%|█████▏    | 123/236 [07:50<06:48,  3.62s/it]
test ppl:  53%|█████▎    | 124/236 [07:52<06:04,  3.25s/it]
test ppl:  53%|█████▎    | 125/236 [07:55<05:36,  3.03s/it]
test ppl:  53%|█████▎    | 126/236 [08:00<06:35,  3.60s/it]
test ppl:  54%|█████▍    | 127/236 [08:02<05:43,  3.15s/it]
test ppl:  54%|█████▍    | 128/236 [08:04<05:11,  2.89s/it]
test ppl:  55%|█████▍    | 129/236 [08:07<05:11,  2.92s/it]
test ppl:  55%|█████▌    | 130/236 [08:10<05:01,  2.85s/it]
test ppl:  56%|█████▌    | 131/236 [08:16<06:35,  3.77s/it]
test ppl:  56%|█████▌    | 132/236 [08:18<05:52,  3.38s/it]
test ppl:  56%|█████▋    | 133/236 [08:22<06:05,  3.55s/it]
test ppl:  57%|█████▋    | 134/236 [08:26<06:12,  3.66s/it]
test ppl:  57%|█████▋    | 135/236 [08:32<07:18,  4.34s/it]
test ppl:  58%|█████▊    | 136/236 [08:33<05:41,  3.42s/it]
test ppl:  58%|█████▊    | 137/236 [08:39<06:53,  4.17s/it]
test ppl:  58%|█████▊    | 138/236 [08:42<06:21,  3.89s/it]
test ppl:  59%|█████▉    | 139/236 [08:44<05:16,  3.27s/it]
test ppl:  59%|█████▉    | 140/236 [08:46<04:29,  2.81s/it]
test ppl:  60%|█████▉    | 141/236 [08:49<04:29,  2.84s/it]
test ppl:  60%|██████    | 142/236 [08:51<04:06,  2.62s/it]
test ppl:  61%|██████    | 143/236 [08:57<05:36,  3.62s/it]
test ppl:  61%|██████    | 144/236 [09:00<05:08,  3.36s/it]
test ppl:  61%|██████▏   | 145/236 [09:05<06:04,  4.01s/it]
test ppl:  62%|██████▏   | 146/236 [09:10<06:16,  4.19s/it]
test ppl:  62%|██████▏   | 147/236 [09:16<06:59,  4.71s/it]
test ppl:  63%|██████▎   | 148/236 [09:22<07:36,  5.19s/it]
test ppl:  63%|██████▎   | 149/236 [09:28<07:51,  5.42s/it]
test ppl:  64%|██████▎   | 150/236 [09:34<07:59,  5.57s/it]
test ppl:  64%|██████▍   | 151/236 [09:40<08:02,  5.68s/it]
test ppl:  64%|██████▍   | 152/236 [09:46<08:02,  5.74s/it]
test ppl:  65%|██████▍   | 153/236 [09:52<08:00,  5.79s/it]
test ppl:  65%|██████▌   | 154/236 [09:54<06:34,  4.82s/it]
test ppl:  66%|██████▌   | 155/236 [09:57<05:39,  4.19s/it]
test ppl:  66%|██████▌   | 156/236 [09:59<04:47,  3.59s/it]
test ppl:  67%|██████▋   | 157/236 [10:01<04:11,  3.18s/it]
test ppl:  67%|██████▋   | 158/236 [10:07<05:12,  4.01s/it]
test ppl:  67%|██████▋   | 159/236 [10:08<04:02,  3.15s/it]
test ppl:  68%|██████▊   | 160/236 [10:10<03:14,  2.56s/it]
test ppl:  68%|██████▊   | 161/236 [10:11<02:45,  2.20s/it]
test ppl:  69%|██████▊   | 162/236 [10:13<02:41,  2.18s/it]
test ppl:  69%|██████▉   | 163/236 [10:16<02:47,  2.30s/it]
test ppl:  69%|██████▉   | 164/236 [10:20<03:23,  2.82s/it]
test ppl:  70%|██████▉   | 165/236 [10:23<03:35,  3.03s/it]
test ppl:  70%|███████   | 166/236 [10:25<03:00,  2.58s/it]
test ppl:  71%|███████   | 167/236 [10:26<02:35,  2.26s/it]
test ppl:  71%|███████   | 168/236 [10:30<03:13,  2.85s/it]
test ppl:  72%|███████▏  | 169/236 [10:36<04:13,  3.78s/it]
test ppl:  72%|███████▏  | 170/236 [10:42<04:53,  4.44s/it]
test ppl:  72%|███████▏  | 171/236 [10:44<03:48,  3.52s/it]
test ppl:  73%|███████▎  | 172/236 [10:50<04:31,  4.24s/it]
test ppl:  73%|███████▎  | 173/236 [10:54<04:20,  4.14s/it]
test ppl:  74%|███████▎  | 174/236 [10:57<04:12,  4.08s/it]
test ppl:  74%|███████▍  | 175/236 [10:59<03:29,  3.43s/it]
test ppl:  75%|███████▍  | 176/236 [11:05<04:10,  4.18s/it]
test ppl:  75%|███████▌  | 177/236 [11:11<04:38,  4.71s/it]
test ppl:  75%|███████▌  | 178/236 [11:17<04:55,  5.09s/it]
test ppl:  76%|███████▌  | 179/236 [11:23<05:04,  5.35s/it]
test ppl:  76%|███████▋  | 180/236 [11:28<04:42,  5.04s/it]
test ppl:  77%|███████▋  | 181/236 [11:33<04:51,  5.31s/it]
test ppl:  77%|███████▋  | 182/236 [11:35<03:51,  4.29s/it]
test ppl:  78%|███████▊  | 183/236 [11:38<03:15,  3.70s/it]
test ppl:  78%|███████▊  | 184/236 [11:39<02:37,  3.02s/it]
test ppl:  78%|███████▊  | 185/236 [11:43<02:46,  3.26s/it]
test ppl:  79%|███████▉  | 186/236 [11:45<02:26,  2.92s/it]
test ppl:  79%|███████▉  | 187/236 [11:51<03:09,  3.86s/it]
test ppl:  80%|███████▉  | 188/236 [11:57<03:35,  4.49s/it]
test ppl:  80%|████████  | 189/236 [12:03<03:51,  4.93s/it]
test ppl:  81%|████████  | 190/236 [12:07<03:37,  4.74s/it]
test ppl:  81%|████████  | 191/236 [12:11<03:20,  4.46s/it]
test ppl:  81%|████████▏ | 192/236 [12:14<02:52,  3.92s/it]
test ppl:  82%|████████▏ | 193/236 [12:20<03:14,  4.53s/it]
test ppl:  82%|████████▏ | 194/236 [12:22<02:46,  3.97s/it]
test ppl:  83%|████████▎ | 195/236 [12:26<02:32,  3.71s/it]
test ppl:  83%|████████▎ | 196/236 [12:28<02:08,  3.20s/it]
test ppl:  83%|████████▎ | 197/236 [12:30<01:52,  2.89s/it]
test ppl:  84%|████████▍ | 198/236 [12:32<01:39,  2.62s/it]
test ppl:  84%|████████▍ | 199/236 [12:34<01:37,  2.65s/it]
test ppl:  85%|████████▍ | 200/236 [12:40<02:10,  3.62s/it]
test ppl:  85%|████████▌ | 201/236 [12:43<01:56,  3.32s/it]
test ppl:  86%|████████▌ | 202/236 [12:48<02:06,  3.72s/it]
test ppl:  86%|████████▌ | 203/236 [12:53<02:23,  4.35s/it]
test ppl:  86%|████████▋ | 204/236 [12:55<01:53,  3.55s/it]
test ppl:  87%|████████▋ | 205/236 [13:01<02:12,  4.28s/it]
test ppl:  87%|████████▋ | 206/236 [13:04<01:59,  4.00s/it]
test ppl:  88%|████████▊ | 207/236 [13:10<02:12,  4.57s/it]
test ppl:  88%|████████▊ | 208/236 [13:14<01:56,  4.17s/it]
test ppl:  89%|████████▊ | 209/236 [13:20<02:07,  4.72s/it]
test ppl:  89%|████████▉ | 210/236 [13:22<01:44,  4.01s/it]
test ppl:  89%|████████▉ | 211/236 [13:26<01:40,  4.00s/it]
test ppl:  90%|████████▉ | 212/236 [13:32<01:49,  4.57s/it]
test ppl:  90%|█████████ | 213/236 [13:38<01:54,  4.97s/it]
test ppl:  91%|█████████ | 214/236 [13:39<01:27,  3.97s/it]
test ppl:  91%|█████████ | 215/236 [13:45<01:35,  4.56s/it]
test ppl:  92%|█████████▏| 216/236 [13:47<01:13,  3.69s/it]
test ppl:  92%|█████████▏| 217/236 [13:53<01:23,  4.40s/it]
test ppl:  92%|█████████▏| 218/236 [13:55<01:05,  3.65s/it]
test ppl:  93%|█████████▎| 219/236 [14:01<01:13,  4.34s/it]
test ppl:  93%|█████████▎| 220/236 [14:07<01:17,  4.83s/it]
test ppl:  94%|█████████▎| 221/236 [14:09<00:58,  3.90s/it]
test ppl:  94%|█████████▍| 222/236 [14:14<01:03,  4.51s/it]
test ppl:  94%|█████████▍| 223/236 [14:20<01:04,  4.93s/it]
test ppl:  95%|█████████▍| 224/236 [14:22<00:47,  3.99s/it]
test ppl:  95%|█████████▌| 225/236 [14:28<00:50,  4.56s/it]
test ppl:  96%|█████████▌| 226/236 [14:31<00:39,  3.95s/it]
test ppl:  96%|█████████▌| 227/236 [14:33<00:32,  3.59s/it]
test ppl:  97%|█████████▋| 228/236 [14:35<00:24,  3.12s/it]
test ppl:  97%|█████████▋| 229/236 [14:41<00:27,  3.95s/it]
test ppl:  97%|█████████▋| 230/236 [14:45<00:22,  3.81s/it]
test ppl:  98%|█████████▊| 231/236 [14:48<00:18,  3.67s/it]
test ppl:  98%|█████████▊| 232/236 [14:50<00:12,  3.10s/it]
test ppl:  99%|█████████▊| 233/236 [14:52<00:08,  2.81s/it]
test ppl:  99%|█████████▉| 234/236 [14:53<00:04,  2.33s/it]
test ppl: 100%|█████████▉| 235/236 [14:59<00:03,  3.40s/it]
test ppl: 100%|██████████| 236/236 [15:00<00:00,  2.58s/it]
test ppl: 100%|██████████| 236/236 [15:00<00:00,  3.81s/it]
10/12/2024 15:52:12 - INFO - __main__ -    em: 0.2094
10/12/2024 15:52:12 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.4 50:  em: 0.2094

--------------------------------------------------------------------------------
Running experiment with knn_temp=50, lmbda=0.4, k=32
2024-10-12 15:52:19.175102: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 15:52:19.194780: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 15:52:19.216585: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 15:52:19.223249: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 15:52:19.239239: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 15:52:20.228285: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 15:52:21 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.4, knn_temp=50, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 15:52:21 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:38:40,  2.20it/s]
Adding feature api:   4%|▍         | 7465/187062 [00:00<00:10, 17835.31it/s]
Adding feature api:   9%|▊         | 15973/187062 [00:00<00:04, 34946.55it/s]
Adding feature api:  13%|█▎        | 24512/187062 [00:00<00:03, 48393.41it/s]
Adding feature api:  18%|█▊        | 32800/187062 [00:00<00:02, 57903.98it/s]
Adding feature api:  22%|██▏       | 41319/187062 [00:00<00:02, 65614.47it/s]
Adding feature api:  27%|██▋       | 49883/187062 [00:01<00:01, 71372.62it/s]
Adding feature api:  31%|███▏      | 58469/187062 [00:01<00:01, 75589.19it/s]
Adding feature api:  36%|███▌      | 67090/187062 [00:01<00:01, 78708.37it/s]
Adding feature api:  40%|████      | 75465/187062 [00:01<00:01, 80194.15it/s]
Adding feature api:  45%|████▍     | 84047/187062 [00:01<00:01, 81861.44it/s]
Adding feature api:  50%|████▉     | 92631/187062 [00:01<00:01, 83037.83it/s]
Adding feature api:  54%|█████▍    | 101271/187062 [00:01<00:01, 84039.45it/s]
Adding feature api:  59%|█████▊    | 109801/187062 [00:01<00:00, 83914.28it/s]
Adding feature api:  63%|██████▎   | 118450/187062 [00:01<00:00, 84679.55it/s]
Adding feature api:  68%|██████▊   | 127025/187062 [00:01<00:00, 84995.69it/s]
Adding feature api:  72%|███████▏  | 135570/187062 [00:02<00:00, 85130.58it/s]
Adding feature api:  77%|███████▋  | 144114/187062 [00:02<00:00, 84546.37it/s]
Adding feature api:  82%|████████▏ | 152725/187062 [00:02<00:00, 85009.56it/s]
Adding feature api:  86%|████████▌ | 161340/187062 [00:02<00:00, 85348.95it/s]
Adding feature api:  91%|█████████ | 169910/187062 [00:02<00:00, 85452.45it/s]
Adding feature api:  95%|█████████▌| 178464/187062 [00:02<00:00, 80093.96it/s]
Adding feature api: 100%|█████████▉| 186547/187062 [00:02<00:00, 53496.16it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 65092.25it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:32:27,  2.21it/s]
Adding feature datatype:   4%|▍         | 7236/187062 [00:00<00:10, 17346.09it/s]
Adding feature datatype:   8%|▊         | 15478/187062 [00:00<00:05, 33946.04it/s]
Adding feature datatype:  13%|█▎        | 23821/187062 [00:00<00:03, 47161.62it/s]
Adding feature datatype:  17%|█▋        | 32118/187062 [00:00<00:02, 57049.12it/s]
Adding feature datatype:  21%|██▏       | 40076/187062 [00:00<00:02, 63422.47it/s]
Adding feature datatype:  26%|██▌       | 48368/187062 [00:01<00:02, 69032.67it/s]
Adding feature datatype:  30%|███       | 56716/187062 [00:01<00:01, 73241.31it/s]
Adding feature datatype:  35%|███▍      | 65024/187062 [00:01<00:01, 76130.92it/s]
Adding feature datatype:  39%|███▉      | 73313/187062 [00:01<00:01, 78128.72it/s]
Adding feature datatype:  44%|████▎     | 81575/187062 [00:01<00:01, 79461.70it/s]
Adding feature datatype:  48%|████▊     | 89764/187062 [00:01<00:01, 79732.16it/s]
Adding feature datatype:  52%|█████▏    | 98099/187062 [00:01<00:01, 80806.88it/s]
Adding feature datatype:  57%|█████▋    | 106451/187062 [00:01<00:00, 81613.18it/s]
Adding feature datatype:  61%|██████▏   | 114799/187062 [00:01<00:00, 82168.20it/s]
Adding feature datatype:  66%|██████▌   | 123194/187062 [00:01<00:00, 82698.39it/s]
Adding feature datatype:  70%|███████   | 131506/187062 [00:02<00:00, 81763.01it/s]
Adding feature datatype:  75%|███████▍  | 139815/187062 [00:02<00:00, 82154.61it/s]
Adding feature datatype:  79%|███████▉  | 148180/187062 [00:02<00:00, 82598.63it/s]
Adding feature datatype:  84%|████████▎ | 156510/187062 [00:02<00:00, 82807.14it/s]
Adding feature datatype:  88%|████████▊ | 164831/187062 [00:02<00:00, 82925.33it/s]
Adding feature datatype:  93%|█████████▎| 173206/187062 [00:02<00:00, 83171.40it/s]
Adding feature datatype:  97%|█████████▋| 181529/187062 [00:02<00:00, 64151.42it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63686.57it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:17:25,  2.23it/s]
Adding feature literal:   4%|▍         | 7179/187062 [00:00<00:10, 17349.90it/s]
Adding feature literal:   8%|▊         | 15384/187062 [00:00<00:05, 33954.44it/s]
Adding feature literal:  13%|█▎        | 23645/187062 [00:00<00:03, 47006.72it/s]
Adding feature literal:  17%|█▋        | 32005/187062 [00:00<00:02, 57143.09it/s]
Adding feature literal:  22%|██▏       | 40299/187062 [00:00<00:02, 64457.40it/s]
Adding feature literal:  26%|██▌       | 48593/187062 [00:01<00:01, 69784.31it/s]
Adding feature literal:  30%|███       | 56845/187062 [00:01<00:01, 73497.82it/s]
Adding feature literal:  35%|███▍      | 65159/187062 [00:01<00:01, 76333.31it/s]
Adding feature literal:  39%|███▉      | 73462/187062 [00:01<00:01, 78313.32it/s]
Adding feature literal:  44%|████▎     | 81798/187062 [00:01<00:01, 79809.80it/s]
Adding feature literal:  48%|████▊     | 90070/187062 [00:01<00:01, 80674.69it/s]
Adding feature literal:  53%|█████▎    | 98428/187062 [00:01<00:01, 81539.97it/s]
Adding feature literal:  57%|█████▋    | 106762/187062 [00:01<00:00, 82076.36it/s]
Adding feature literal:  62%|██████▏   | 115109/187062 [00:01<00:00, 82490.18it/s]
Adding feature literal:  66%|██████▌   | 123417/187062 [00:01<00:00, 82597.67it/s]
Adding feature literal:  70%|███████   | 131718/187062 [00:02<00:00, 82668.23it/s]
Adding feature literal:  75%|███████▍  | 140058/187062 [00:02<00:00, 82885.87it/s]
Adding feature literal:  79%|███████▉  | 148367/187062 [00:02<00:00, 82815.72it/s]
Adding feature literal:  84%|████████▎ | 156663/187062 [00:02<00:00, 82722.65it/s]
Adding feature literal:  88%|████████▊ | 164966/187062 [00:02<00:00, 82813.29it/s]
Adding feature literal:  93%|█████████▎| 173286/187062 [00:02<00:00, 82928.29it/s]
Adding feature literal:  97%|█████████▋| 181584/187062 [00:02<00:00, 63917.63it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63879.33it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:19:58,  2.23it/s]
Adding feature operator:   4%|▍         | 7242/187062 [00:00<00:10, 17477.60it/s]
Adding feature operator:   8%|▊         | 15514/187062 [00:00<00:05, 34204.19it/s]
Adding feature operator:  13%|█▎        | 23808/187062 [00:00<00:03, 47267.42it/s]
Adding feature operator:  17%|█▋        | 32145/187062 [00:00<00:02, 57262.60it/s]
Adding feature operator:  22%|██▏       | 40469/187062 [00:00<00:02, 64623.81it/s]
Adding feature operator:  26%|██▌       | 48868/187062 [00:01<00:01, 70204.18it/s]
Adding feature operator:  31%|███       | 57240/187062 [00:01<00:01, 74143.30it/s]
Adding feature operator:  35%|███▌      | 65618/187062 [00:01<00:01, 76975.98it/s]
Adding feature operator:  40%|███▉      | 74003/187062 [00:01<00:01, 79007.54it/s]
Adding feature operator:  44%|████▍     | 82359/187062 [00:01<00:01, 80356.77it/s]
Adding feature operator:  49%|████▊     | 90762/187062 [00:01<00:01, 81448.51it/s]
Adding feature operator:  53%|█████▎    | 99182/187062 [00:01<00:01, 82268.75it/s]
Adding feature operator:  57%|█████▋    | 107537/187062 [00:01<00:00, 82650.95it/s]
Adding feature operator:  62%|██████▏   | 115931/187062 [00:01<00:00, 83033.80it/s]
Adding feature operator:  66%|██████▋   | 124294/187062 [00:01<00:00, 83071.86it/s]
Adding feature operator:  71%|███████   | 132697/187062 [00:02<00:00, 83355.19it/s]
Adding feature operator:  75%|███████▌  | 141069/187062 [00:02<00:00, 83461.67it/s]
Adding feature operator:  80%|███████▉  | 149436/187062 [00:02<00:00, 83496.74it/s]
Adding feature operator:  84%|████████▍ | 157842/187062 [00:02<00:00, 83663.41it/s]
Adding feature operator:  89%|████████▉ | 166229/187062 [00:02<00:00, 83722.13it/s]
Adding feature operator:  93%|█████████▎| 174609/187062 [00:02<00:00, 83691.48it/s]
Adding feature operator:  98%|█████████▊| 182984/187062 [00:02<00:00, 59449.59it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 64296.36it/s]
[2024-10-12 15:53:05,172] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 15:53:06 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 15:53:06 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:16, 383.06 examples/s]
Map:   1%|▏         | 82/6548 [00:00<00:32, 197.41 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:24, 261.38 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 314.78 examples/s]
Map:   3%|▎         | 219/6548 [00:00<00:18, 340.58 examples/s]
Map:   4%|▍         | 283/6548 [00:00<00:19, 317.94 examples/s]
Map:   5%|▌         | 328/6548 [00:01<00:20, 303.53 examples/s]
Map:   6%|▌         | 365/6548 [00:01<00:19, 316.15 examples/s]
Map:   6%|▋         | 420/6548 [00:01<00:16, 370.85 examples/s]
Map:   7%|▋         | 462/6548 [00:01<00:18, 335.63 examples/s]
Map:   8%|▊         | 521/6548 [00:01<00:17, 343.47 examples/s]
Map:   9%|▊         | 570/6548 [00:01<00:15, 375.60 examples/s]
Map:   9%|▉         | 622/6548 [00:01<00:16, 354.40 examples/s]
Map:  10%|█         | 672/6548 [00:02<00:17, 342.46 examples/s]
Map:  11%|█         | 716/6548 [00:02<00:16, 361.98 examples/s]
Map:  12%|█▏        | 765/6548 [00:02<00:14, 388.48 examples/s]
Map:  12%|█▏        | 817/6548 [00:02<00:13, 414.68 examples/s]
Map:  13%|█▎        | 860/6548 [00:02<00:13, 416.21 examples/s]
Map:  14%|█▍        | 909/6548 [00:02<00:15, 372.71 examples/s]
Map:  15%|█▍        | 957/6548 [00:02<00:14, 384.65 examples/s]
Map:  15%|█▌        | 997/6548 [00:02<00:16, 335.75 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:24, 226.29 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:21, 253.72 examples/s]
Map:  17%|█▋        | 1126/6548 [00:03<00:18, 298.00 examples/s]
Map:  18%|█▊        | 1167/6548 [00:03<00:16, 320.31 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 337.60 examples/s]
Map:  19%|█▉        | 1267/6548 [00:03<00:14, 354.74 examples/s]
Map:  20%|██        | 1322/6548 [00:03<00:15, 342.67 examples/s]
Map:  21%|██        | 1370/6548 [00:04<00:16, 323.20 examples/s]
Map:  22%|██▏       | 1417/6548 [00:04<00:16, 313.33 examples/s]
Map:  22%|██▏       | 1454/6548 [00:04<00:17, 290.62 examples/s]
Map:  23%|██▎       | 1491/6548 [00:04<00:18, 275.02 examples/s]
Map:  23%|██▎       | 1527/6548 [00:04<00:17, 292.17 examples/s]
Map:  24%|██▍       | 1576/6548 [00:04<00:17, 290.79 examples/s]
Map:  25%|██▍       | 1610/6548 [00:05<00:17, 283.29 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:17, 284.21 examples/s]
Map:  26%|██▌       | 1685/6548 [00:05<00:17, 272.30 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:15, 301.89 examples/s]
Map:  27%|██▋       | 1770/6548 [00:05<00:14, 332.63 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:13, 341.32 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 349.91 examples/s]
Map:  29%|██▉       | 1897/6548 [00:05<00:14, 327.00 examples/s]
Map:  30%|██▉       | 1952/6548 [00:06<00:13, 335.53 examples/s]
Map:  30%|███       | 1993/6548 [00:06<00:12, 352.17 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:20, 221.72 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:17, 253.17 examples/s]
Map:  32%|███▏      | 2107/6548 [00:06<00:16, 271.48 examples/s]
Map:  33%|███▎      | 2152/6548 [00:06<00:16, 264.47 examples/s]
Map:  33%|███▎      | 2193/6548 [00:06<00:14, 294.71 examples/s]
Map:  34%|███▍      | 2230/6548 [00:07<00:14, 293.11 examples/s]
Map:  35%|███▍      | 2272/6548 [00:07<00:15, 273.83 examples/s]
Map:  35%|███▌      | 2308/6548 [00:07<00:14, 292.78 examples/s]
Map:  36%|███▌      | 2351/6548 [00:07<00:13, 320.37 examples/s]
Map:  37%|███▋      | 2397/6548 [00:07<00:13, 310.22 examples/s]
Map:  37%|███▋      | 2438/6548 [00:07<00:13, 307.63 examples/s]
Map:  38%|███▊      | 2489/6548 [00:07<00:13, 312.01 examples/s]
Map:  39%|███▉      | 2542/6548 [00:08<00:12, 317.02 examples/s]
Map:  40%|███▉      | 2593/6548 [00:08<00:11, 358.24 examples/s]
Map:  40%|████      | 2633/6548 [00:08<00:10, 366.98 examples/s]
Map:  41%|████      | 2682/6548 [00:08<00:11, 344.99 examples/s]
Map:  42%|████▏     | 2718/6548 [00:08<00:11, 342.83 examples/s]
Map:  42%|████▏     | 2762/6548 [00:08<00:10, 366.17 examples/s]
Map:  43%|████▎     | 2810/6548 [00:08<00:10, 347.78 examples/s]
Map:  44%|████▎     | 2860/6548 [00:09<00:13, 279.67 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 287.71 examples/s]
Map:  45%|████▌     | 2951/6548 [00:09<00:11, 301.88 examples/s]
Map:  46%|████▌     | 2988/6548 [00:09<00:11, 305.19 examples/s]
Map:  46%|████▌     | 3026/6548 [00:09<00:20, 170.65 examples/s]
Map:  47%|████▋     | 3058/6548 [00:10<00:18, 189.20 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 210.55 examples/s]
Map:  48%|████▊     | 3133/6548 [00:10<00:13, 247.77 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:13, 242.89 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 242.00 examples/s]
Map:  49%|████▉     | 3238/6548 [00:10<00:12, 262.42 examples/s]
Map:  50%|████▉     | 3272/6548 [00:10<00:11, 276.81 examples/s]
Map:  50%|█████     | 3306/6548 [00:10<00:11, 290.80 examples/s]
Map:  51%|█████     | 3348/6548 [00:11<00:10, 309.75 examples/s]
Map:  52%|█████▏    | 3389/6548 [00:11<00:11, 281.80 examples/s]
Map:  52%|█████▏    | 3421/6548 [00:11<00:11, 282.04 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 266.21 examples/s]
Map:  53%|█████▎    | 3484/6548 [00:11<00:11, 273.35 examples/s]
Map:  54%|█████▍    | 3529/6548 [00:11<00:09, 314.78 examples/s]
Map:  55%|█████▍    | 3574/6548 [00:11<00:08, 347.40 examples/s]
Map:  55%|█████▌    | 3612/6548 [00:11<00:08, 354.36 examples/s]
Map:  56%|█████▌    | 3662/6548 [00:12<00:08, 335.47 examples/s]
Map:  57%|█████▋    | 3707/6548 [00:12<00:07, 356.75 examples/s]
Map:  57%|█████▋    | 3749/6548 [00:12<00:07, 372.36 examples/s]
Map:  58%|█████▊    | 3788/6548 [00:12<00:07, 374.67 examples/s]
Map:  59%|█████▊    | 3831/6548 [00:12<00:08, 326.50 examples/s]
Map:  59%|█████▉    | 3887/6548 [00:12<00:07, 334.27 examples/s]
Map:  60%|██████    | 3929/6548 [00:12<00:07, 334.62 examples/s]
Map:  61%|██████    | 3987/6548 [00:12<00:07, 349.93 examples/s]
Map:  62%|██████▏   | 4030/6548 [00:13<00:09, 253.55 examples/s]
Map:  62%|██████▏   | 4079/6548 [00:13<00:08, 296.93 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 320.21 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:07, 298.61 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:13<00:07, 315.06 examples/s]
Map:  65%|██████▌   | 4260/6548 [00:13<00:06, 352.71 examples/s]
Map:  66%|██████▌   | 4325/6548 [00:14<00:05, 372.16 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:14<00:06, 360.19 examples/s]
Map:  67%|██████▋   | 4406/6548 [00:14<00:05, 363.31 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:05, 386.07 examples/s]
Map:  69%|██████▊   | 4498/6548 [00:14<00:06, 331.78 examples/s]
Map:  69%|██████▉   | 4545/6548 [00:14<00:06, 319.48 examples/s]
Map:  70%|███████   | 4586/6548 [00:14<00:06, 300.88 examples/s]
Map:  71%|███████   | 4633/6548 [00:14<00:05, 334.79 examples/s]
Map:  71%|███████▏  | 4673/6548 [00:15<00:05, 348.48 examples/s]
Map:  72%|███████▏  | 4717/6548 [00:15<00:04, 368.23 examples/s]
Map:  73%|███████▎  | 4785/6548 [00:15<00:04, 396.14 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 396.38 examples/s]
Map:  75%|███████▍  | 4887/6548 [00:15<00:04, 391.21 examples/s]
Map:  75%|███████▌  | 4928/6548 [00:15<00:04, 382.51 examples/s]
Map:  76%|███████▌  | 4980/6548 [00:15<00:03, 414.55 examples/s]
Map:  77%|███████▋  | 5036/6548 [00:16<00:06, 250.62 examples/s]
Map:  78%|███████▊  | 5082/6548 [00:16<00:05, 260.26 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 268.79 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 283.46 examples/s]
Map:  80%|███████▉  | 5207/6548 [00:16<00:04, 293.87 examples/s]
Map:  80%|████████  | 5247/6548 [00:16<00:04, 313.65 examples/s]
Map:  81%|████████  | 5288/6548 [00:16<00:03, 333.81 examples/s]
Map:  81%|████████▏ | 5325/6548 [00:17<00:03, 333.70 examples/s]
Map:  82%|████████▏ | 5374/6548 [00:17<00:03, 323.18 examples/s]
Map:  83%|████████▎ | 5428/6548 [00:17<00:03, 298.69 examples/s]
Map:  84%|████████▎ | 5468/6548 [00:17<00:03, 319.75 examples/s]
Map:  84%|████████▍ | 5503/6548 [00:17<00:03, 326.19 examples/s]
Map:  85%|████████▍ | 5543/6548 [00:17<00:02, 343.61 examples/s]
Map:  85%|████████▌ | 5582/6548 [00:17<00:03, 302.48 examples/s]
Map:  86%|████████▌ | 5631/6548 [00:18<00:02, 343.55 examples/s]
Map:  87%|████████▋ | 5671/6548 [00:18<00:02, 314.68 examples/s]
Map:  87%|████████▋ | 5709/6548 [00:18<00:02, 324.74 examples/s]
Map:  88%|████████▊ | 5753/6548 [00:18<00:02, 347.93 examples/s]
Map:  88%|████████▊ | 5790/6548 [00:18<00:02, 349.79 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:01, 351.27 examples/s]
Map:  90%|████████▉ | 5889/6548 [00:18<00:01, 362.21 examples/s]
Map:  91%|█████████ | 5927/6548 [00:18<00:01, 365.95 examples/s]
Map:  91%|█████████ | 5974/6548 [00:19<00:01, 346.04 examples/s]
Map:  92%|█████████▏| 6027/6548 [00:19<00:02, 240.30 examples/s]
Map:  93%|█████████▎| 6062/6548 [00:19<00:01, 257.06 examples/s]
Map:  93%|█████████▎| 6097/6548 [00:19<00:01, 272.01 examples/s]
Map:  94%|█████████▎| 6131/6548 [00:19<00:01, 286.02 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:19<00:01, 294.47 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:19<00:01, 311.34 examples/s]
Map:  96%|█████████▌| 6262/6548 [00:20<00:00, 321.08 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 339.09 examples/s]
Map:  97%|█████████▋| 6365/6548 [00:20<00:00, 359.17 examples/s]
Map:  98%|█████████▊| 6402/6548 [00:20<00:00, 355.15 examples/s]
Map:  99%|█████████▊| 6464/6548 [00:20<00:00, 373.00 examples/s]
Map: 100%|█████████▉| 6520/6548 [00:20<00:00, 368.91 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 312.80 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 318.02 examples/s]
Map:   8%|▊         | 68/903 [00:00<00:02, 316.74 examples/s]
Map:  13%|█▎        | 118/903 [00:00<00:02, 310.40 examples/s]
Map:  18%|█▊        | 162/903 [00:00<00:02, 347.80 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 373.33 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 380.10 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 376.32 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 331.26 examples/s]
Map:  45%|████▌     | 409/903 [00:01<00:01, 284.93 examples/s]
Map:  50%|█████     | 456/903 [00:01<00:01, 291.67 examples/s]
Map:  54%|█████▍    | 488/903 [00:01<00:01, 292.77 examples/s]
Map:  59%|█████▉    | 536/903 [00:01<00:01, 332.89 examples/s]
Map:  64%|██████▍   | 578/903 [00:01<00:00, 352.80 examples/s]
Map:  69%|██████▊   | 619/903 [00:01<00:00, 359.16 examples/s]
Map:  73%|███████▎  | 663/903 [00:01<00:00, 379.81 examples/s]
Map:  78%|███████▊  | 704/903 [00:02<00:00, 385.31 examples/s]
Map:  83%|████████▎ | 751/903 [00:02<00:00, 406.34 examples/s]
Map:  89%|████████▉ | 807/903 [00:02<00:00, 387.49 examples/s]
Map:  95%|█████████▍| 857/903 [00:02<00:00, 413.00 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 237.81 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 321.41 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 272.95 examples/s]
Map:   4%|▍         | 81/1882 [00:00<00:05, 351.28 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 345.29 examples/s]
Map:   9%|▊         | 161/1882 [00:00<00:04, 366.09 examples/s]
Map:  11%|█         | 203/1882 [00:00<00:05, 318.39 examples/s]
Map:  13%|█▎        | 253/1882 [00:00<00:04, 369.80 examples/s]
Map:  16%|█▌        | 302/1882 [00:00<00:04, 350.29 examples/s]
Map:  18%|█▊        | 345/1882 [00:00<00:04, 367.25 examples/s]
Map:  21%|██        | 396/1882 [00:01<00:04, 308.59 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 301.74 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 331.28 examples/s]
Map:  29%|██▉       | 543/1882 [00:01<00:04, 321.45 examples/s]
Map:  31%|███       | 587/1882 [00:01<00:03, 346.45 examples/s]
Map:  34%|███▍      | 644/1882 [00:01<00:03, 395.44 examples/s]
Map:  37%|███▋      | 704/1882 [00:02<00:03, 384.32 examples/s]
Map:  41%|████      | 768/1882 [00:02<00:02, 391.99 examples/s]
Map:  43%|████▎     | 809/1882 [00:02<00:03, 346.49 examples/s]
Map:  45%|████▌     | 851/1882 [00:02<00:02, 361.80 examples/s]
Map:  47%|████▋     | 893/1882 [00:02<00:02, 372.02 examples/s]
Map:  51%|█████     | 960/1882 [00:02<00:02, 391.14 examples/s]
Map:  53%|█████▎    | 1000/1882 [00:03<00:03, 252.36 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 274.58 examples/s]
Map:  58%|█████▊    | 1085/1882 [00:03<00:02, 281.81 examples/s]
Map:  60%|██████    | 1135/1882 [00:03<00:02, 290.95 examples/s]
Map:  62%|██████▏   | 1173/1882 [00:03<00:02, 304.54 examples/s]
Map:  64%|██████▍   | 1206/1882 [00:03<00:02, 273.75 examples/s]
Map:  66%|██████▌   | 1243/1882 [00:03<00:02, 294.40 examples/s]
Map:  69%|██████▉   | 1299/1882 [00:03<00:01, 316.33 examples/s]
Map:  71%|███████▏  | 1342/1882 [00:04<00:01, 340.75 examples/s]
Map:  74%|███████▎  | 1386/1882 [00:04<00:01, 315.94 examples/s]
Map:  76%|███████▌  | 1427/1882 [00:04<00:01, 283.24 examples/s]
Map:  78%|███████▊  | 1469/1882 [00:04<00:01, 312.12 examples/s]
Map:  80%|████████  | 1507/1882 [00:04<00:01, 272.78 examples/s]
Map:  82%|████████▏ | 1538/1882 [00:04<00:01, 272.47 examples/s]
Map:  84%|████████▍ | 1582/1882 [00:04<00:00, 307.68 examples/s]
Map:  86%|████████▌ | 1622/1882 [00:05<00:00, 328.51 examples/s]
Map:  89%|████████▊ | 1667/1882 [00:05<00:00, 301.84 examples/s]
Map:  91%|█████████ | 1713/1882 [00:05<00:00, 338.40 examples/s]
Map:  94%|█████████▎| 1763/1882 [00:05<00:00, 287.79 examples/s]
Map:  97%|█████████▋| 1820/1882 [00:05<00:00, 311.26 examples/s]
Map:  99%|█████████▉| 1860/1882 [00:05<00:00, 329.22 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 311.86 examples/s]
10/12/2024 15:54:08 - INFO - __main__ -     ***** Testing *****
10/12/2024 15:54:08 - INFO - __main__ -     Batch size = 8
10/12/2024 15:54:08 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 15:54:09 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 15:54:09 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 15:54:10 - INFO - knnlm -   Reading datastore took 0.9612436294555664 s
10/12/2024 15:54:11 - INFO - knnlm -   Moving index to GPU took 0.9030773639678955 s
10/12/2024 15:54:11 - INFO - __main__ -   ******************************break-into
10/12/2024 15:54:11 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 15:54:11 - INFO - __main__ -     Num examples = 236
10/12/2024 15:54:11 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:54,  7.89s/it]
test ppl:   1%|          | 2/236 [00:09<17:00,  4.36s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:50,  3.05s/it]
test ppl:   2%|▏         | 4/236 [00:17<15:59,  4.14s/it]
test ppl:   2%|▏         | 5/236 [00:22<18:15,  4.74s/it]
test ppl:   3%|▎         | 6/236 [00:28<18:45,  4.89s/it]
test ppl:   3%|▎         | 7/236 [00:29<14:54,  3.91s/it]
test ppl:   3%|▎         | 8/236 [00:34<15:14,  4.01s/it]
test ppl:   4%|▍         | 9/236 [00:36<12:54,  3.41s/it]
test ppl:   4%|▍         | 10/236 [00:42<15:40,  4.16s/it]
test ppl:   5%|▍         | 11/236 [00:44<13:30,  3.60s/it]
test ppl:   5%|▌         | 12/236 [00:49<14:39,  3.93s/it]
test ppl:   6%|▌         | 13/236 [00:54<16:42,  4.50s/it]
test ppl:   6%|▌         | 14/236 [00:57<14:11,  3.83s/it]
test ppl:   6%|▋         | 15/236 [00:58<11:24,  3.10s/it]
test ppl:   7%|▋         | 16/236 [01:00<09:57,  2.72s/it]
test ppl:   7%|▋         | 17/236 [01:06<13:19,  3.65s/it]
test ppl:   8%|▊         | 18/236 [01:07<11:06,  3.06s/it]
test ppl:   8%|▊         | 19/236 [01:12<12:30,  3.46s/it]
test ppl:   8%|▊         | 20/236 [01:14<10:36,  2.95s/it]
test ppl:   9%|▉         | 21/236 [01:19<13:38,  3.81s/it]
test ppl:   9%|▉         | 22/236 [01:25<15:43,  4.41s/it]
test ppl:  10%|▉         | 23/236 [01:28<13:36,  3.83s/it]
test ppl:  10%|█         | 24/236 [01:30<11:56,  3.38s/it]
test ppl:  11%|█         | 25/236 [01:36<14:28,  4.12s/it]
test ppl:  11%|█         | 26/236 [01:42<16:13,  4.63s/it]
test ppl:  11%|█▏        | 27/236 [01:45<14:51,  4.27s/it]
test ppl:  12%|█▏        | 28/236 [01:46<11:36,  3.35s/it]
test ppl:  12%|█▏        | 29/236 [01:49<10:29,  3.04s/it]
test ppl:  13%|█▎        | 30/236 [01:50<08:51,  2.58s/it]
test ppl:  13%|█▎        | 31/236 [01:52<08:12,  2.40s/it]
test ppl:  14%|█▎        | 32/236 [01:55<08:24,  2.47s/it]
test ppl:  14%|█▍        | 33/236 [01:57<08:19,  2.46s/it]
test ppl:  14%|█▍        | 34/236 [02:01<09:48,  2.91s/it]
test ppl:  15%|█▍        | 35/236 [02:04<09:20,  2.79s/it]
test ppl:  15%|█▌        | 36/236 [02:09<12:20,  3.70s/it]
test ppl:  16%|█▌        | 37/236 [02:15<14:25,  4.35s/it]
test ppl:  16%|█▌        | 38/236 [02:17<12:04,  3.66s/it]
test ppl:  17%|█▋        | 39/236 [02:19<10:09,  3.10s/it]
test ppl:  17%|█▋        | 40/236 [02:22<09:36,  2.94s/it]
test ppl:  17%|█▋        | 41/236 [02:24<08:29,  2.61s/it]
test ppl:  18%|█▊        | 42/236 [02:29<11:35,  3.58s/it]
test ppl:  18%|█▊        | 43/236 [02:35<13:41,  4.25s/it]
test ppl:  19%|█▊        | 44/236 [02:38<11:45,  3.68s/it]
test ppl:  19%|█▉        | 45/236 [02:40<10:03,  3.16s/it]
test ppl:  19%|█▉        | 46/236 [02:45<12:34,  3.97s/it]
test ppl:  20%|█▉        | 47/236 [02:47<10:11,  3.23s/it]
test ppl:  20%|██        | 48/236 [02:53<12:31,  4.00s/it]
test ppl:  21%|██        | 49/236 [02:56<11:37,  3.73s/it]
test ppl:  21%|██        | 50/236 [03:02<13:32,  4.37s/it]
test ppl:  22%|██▏       | 51/236 [03:08<14:49,  4.81s/it]
test ppl:  22%|██▏       | 52/236 [03:13<15:40,  5.11s/it]
test ppl:  22%|██▏       | 53/236 [03:18<15:16,  5.01s/it]
test ppl:  23%|██▎       | 54/236 [03:20<12:01,  3.96s/it]
test ppl:  23%|██▎       | 55/236 [03:25<13:29,  4.48s/it]
test ppl:  24%|██▎       | 56/236 [03:29<12:25,  4.14s/it]
test ppl:  24%|██▍       | 57/236 [03:31<10:42,  3.59s/it]
test ppl:  25%|██▍       | 58/236 [03:33<09:22,  3.16s/it]
test ppl:  25%|██▌       | 59/236 [03:39<11:40,  3.96s/it]
test ppl:  25%|██▌       | 60/236 [03:42<10:44,  3.66s/it]
test ppl:  26%|██▌       | 61/236 [03:48<12:33,  4.31s/it]
test ppl:  26%|██▋       | 62/236 [03:54<13:48,  4.76s/it]
test ppl:  27%|██▋       | 63/236 [03:56<11:42,  4.06s/it]
test ppl:  27%|██▋       | 64/236 [03:58<09:56,  3.47s/it]
test ppl:  28%|██▊       | 65/236 [03:59<08:02,  2.82s/it]
test ppl:  28%|██▊       | 66/236 [04:02<08:07,  2.87s/it]
test ppl:  28%|██▊       | 67/236 [04:08<10:34,  3.76s/it]
test ppl:  29%|██▉       | 68/236 [04:14<12:14,  4.37s/it]
test ppl:  29%|██▉       | 69/236 [04:20<13:22,  4.80s/it]
test ppl:  30%|██▉       | 70/236 [04:21<10:38,  3.85s/it]
test ppl:  30%|███       | 71/236 [04:27<12:12,  4.44s/it]
test ppl:  31%|███       | 72/236 [04:31<11:35,  4.24s/it]
test ppl:  31%|███       | 73/236 [04:36<12:29,  4.60s/it]
test ppl:  31%|███▏      | 74/236 [04:38<09:54,  3.67s/it]
test ppl:  32%|███▏      | 75/236 [04:44<11:34,  4.31s/it]
test ppl:  32%|███▏      | 76/236 [04:47<10:21,  3.89s/it]
test ppl:  33%|███▎      | 77/236 [04:49<08:59,  3.40s/it]
test ppl:  33%|███▎      | 78/236 [04:50<07:26,  2.83s/it]
test ppl:  33%|███▎      | 79/236 [04:54<08:13,  3.15s/it]
test ppl:  34%|███▍      | 80/236 [04:56<07:08,  2.75s/it]
test ppl:  34%|███▍      | 81/236 [05:02<09:28,  3.67s/it]
test ppl:  35%|███▍      | 82/236 [05:08<10:59,  4.28s/it]
test ppl:  35%|███▌      | 83/236 [05:10<09:40,  3.79s/it]
test ppl:  36%|███▌      | 84/236 [05:12<08:08,  3.22s/it]
test ppl:  36%|███▌      | 85/236 [05:16<08:45,  3.48s/it]
test ppl:  36%|███▋      | 86/236 [05:18<07:30,  3.01s/it]
test ppl:  37%|███▋      | 87/236 [05:20<06:46,  2.73s/it]
test ppl:  37%|███▋      | 88/236 [05:26<09:00,  3.65s/it]
test ppl:  38%|███▊      | 89/236 [05:32<10:32,  4.30s/it]
test ppl:  38%|███▊      | 90/236 [05:38<11:34,  4.76s/it]
test ppl:  39%|███▊      | 91/236 [05:43<11:35,  4.80s/it]
test ppl:  39%|███▉      | 92/236 [05:45<10:03,  4.19s/it]
test ppl:  39%|███▉      | 93/236 [05:51<11:08,  4.68s/it]
test ppl:  40%|███▉      | 94/236 [05:57<11:52,  5.02s/it]
test ppl:  40%|████      | 95/236 [06:00<10:15,  4.36s/it]
test ppl:  41%|████      | 96/236 [06:03<09:09,  3.93s/it]
test ppl:  41%|████      | 97/236 [06:09<10:25,  4.50s/it]
test ppl:  42%|████▏     | 98/236 [06:14<11:15,  4.90s/it]
test ppl:  42%|████▏     | 99/236 [06:20<11:49,  5.18s/it]
test ppl:  42%|████▏     | 100/236 [06:22<09:06,  4.02s/it]
test ppl:  43%|████▎     | 101/236 [06:27<10:15,  4.56s/it]
test ppl:  43%|████▎     | 102/236 [06:31<09:44,  4.36s/it]
test ppl:  44%|████▎     | 103/236 [06:33<07:42,  3.48s/it]
test ppl:  44%|████▍     | 104/236 [06:37<08:08,  3.70s/it]
test ppl:  44%|████▍     | 105/236 [06:41<08:30,  3.90s/it]
test ppl:  45%|████▍     | 106/236 [06:47<09:24,  4.34s/it]
test ppl:  45%|████▌     | 107/236 [06:49<07:46,  3.61s/it]
test ppl:  46%|████▌     | 108/236 [06:54<09:00,  4.22s/it]
test ppl:  46%|████▌     | 109/236 [06:58<08:46,  4.15s/it]
test ppl:  47%|████▋     | 110/236 [07:00<07:05,  3.38s/it]
test ppl:  47%|████▋     | 111/236 [07:04<07:24,  3.55s/it]
test ppl:  47%|████▋     | 112/236 [07:07<07:13,  3.50s/it]
test ppl:  48%|████▊     | 113/236 [07:09<06:05,  2.97s/it]
test ppl:  48%|████▊     | 114/236 [07:12<06:15,  3.08s/it]
test ppl:  49%|████▊     | 115/236 [07:18<07:52,  3.90s/it]
test ppl:  49%|████▉     | 116/236 [07:24<08:57,  4.48s/it]
test ppl:  50%|████▉     | 117/236 [07:26<07:18,  3.69s/it]
test ppl:  50%|█████     | 118/236 [07:30<07:40,  3.90s/it]
test ppl:  50%|█████     | 119/236 [07:35<08:04,  4.14s/it]
test ppl:  51%|█████     | 120/236 [07:36<06:28,  3.35s/it]
test ppl:  51%|█████▏    | 121/236 [07:42<07:50,  4.09s/it]
test ppl:  52%|█████▏    | 122/236 [07:47<08:08,  4.29s/it]
test ppl:  52%|█████▏    | 123/236 [07:49<06:51,  3.64s/it]
test ppl:  53%|█████▎    | 124/236 [07:52<06:12,  3.32s/it]
test ppl:  53%|█████▎    | 125/236 [07:57<07:32,  4.07s/it]
test ppl:  53%|█████▎    | 126/236 [08:02<07:54,  4.31s/it]
test ppl:  54%|█████▍    | 127/236 [08:04<06:36,  3.64s/it]
test ppl:  54%|█████▍    | 128/236 [08:07<05:48,  3.22s/it]
test ppl:  55%|█████▍    | 129/236 [08:09<05:36,  3.14s/it]
test ppl:  55%|█████▌    | 130/236 [08:12<05:17,  2.99s/it]
test ppl:  56%|█████▌    | 131/236 [08:18<06:44,  3.85s/it]
test ppl:  56%|█████▌    | 132/236 [08:20<05:56,  3.43s/it]
test ppl:  56%|█████▋    | 133/236 [08:24<06:07,  3.57s/it]
test ppl:  57%|█████▋    | 134/236 [08:28<06:12,  3.66s/it]
test ppl:  57%|█████▋    | 135/236 [08:34<07:15,  4.32s/it]
test ppl:  58%|█████▊    | 136/236 [08:35<05:39,  3.39s/it]
test ppl:  58%|█████▊    | 137/236 [08:41<06:49,  4.14s/it]
test ppl:  58%|█████▊    | 138/236 [08:44<06:17,  3.85s/it]
test ppl:  59%|█████▉    | 139/236 [08:47<05:36,  3.47s/it]
test ppl:  59%|█████▉    | 140/236 [08:49<04:41,  2.93s/it]
test ppl:  60%|█████▉    | 141/236 [08:51<04:36,  2.91s/it]
test ppl:  60%|██████    | 142/236 [08:54<04:10,  2.67s/it]
test ppl:  61%|██████    | 143/236 [08:59<05:21,  3.46s/it]
test ppl:  61%|██████    | 144/236 [09:02<04:57,  3.24s/it]
test ppl:  61%|██████▏   | 145/236 [09:07<06:01,  3.98s/it]
test ppl:  62%|██████▏   | 146/236 [09:12<06:11,  4.13s/it]
test ppl:  62%|██████▏   | 147/236 [09:18<06:53,  4.65s/it]
test ppl:  63%|██████▎   | 148/236 [09:24<07:23,  5.04s/it]
test ppl:  63%|██████▎   | 149/236 [09:27<06:34,  4.53s/it]
test ppl:  64%|██████▎   | 150/236 [09:33<07:03,  4.93s/it]
test ppl:  64%|██████▍   | 151/236 [09:39<07:22,  5.21s/it]
test ppl:  64%|██████▍   | 152/236 [09:44<07:32,  5.39s/it]
test ppl:  65%|██████▍   | 153/236 [09:49<07:17,  5.27s/it]
test ppl:  65%|██████▌   | 154/236 [09:52<06:04,  4.44s/it]
test ppl:  66%|██████▌   | 155/236 [09:55<05:14,  3.89s/it]
test ppl:  66%|██████▌   | 156/236 [09:57<04:29,  3.37s/it]
test ppl:  67%|██████▋   | 157/236 [09:59<03:58,  3.02s/it]
test ppl:  67%|██████▋   | 158/236 [10:05<05:01,  3.86s/it]
test ppl:  67%|██████▋   | 159/236 [10:11<05:42,  4.45s/it]
test ppl:  68%|██████▊   | 160/236 [10:12<04:23,  3.47s/it]
test ppl:  68%|██████▊   | 161/236 [10:13<03:32,  2.83s/it]
test ppl:  69%|██████▊   | 162/236 [10:16<03:35,  2.92s/it]
test ppl:  69%|██████▉   | 163/236 [10:19<03:24,  2.80s/it]
test ppl:  69%|██████▉   | 164/236 [10:22<03:25,  2.85s/it]
test ppl:  70%|██████▉   | 165/236 [10:26<04:01,  3.39s/it]
test ppl:  70%|███████   | 166/236 [10:29<03:34,  3.07s/it]
test ppl:  71%|███████   | 167/236 [10:30<02:58,  2.59s/it]
test ppl:  71%|███████   | 168/236 [10:34<03:28,  3.06s/it]
test ppl:  72%|███████▏  | 169/236 [10:40<04:21,  3.90s/it]
test ppl:  72%|███████▏  | 170/236 [10:46<04:56,  4.49s/it]
test ppl:  72%|███████▏  | 171/236 [10:47<03:50,  3.54s/it]
test ppl:  73%|███████▎  | 172/236 [10:53<04:30,  4.23s/it]
test ppl:  73%|███████▎  | 173/236 [10:56<04:07,  3.93s/it]
test ppl:  74%|███████▎  | 174/236 [11:02<04:39,  4.51s/it]
test ppl:  74%|███████▍  | 175/236 [11:04<03:45,  3.70s/it]
test ppl:  75%|███████▍  | 176/236 [11:10<04:19,  4.33s/it]
test ppl:  75%|███████▌  | 177/236 [11:16<04:42,  4.78s/it]
test ppl:  75%|███████▌  | 178/236 [11:22<04:56,  5.11s/it]
test ppl:  76%|███████▌  | 179/236 [11:27<05:04,  5.33s/it]
test ppl:  76%|███████▋  | 180/236 [11:32<04:40,  5.01s/it]
test ppl:  77%|███████▋  | 181/236 [11:38<04:48,  5.25s/it]
test ppl:  77%|███████▋  | 182/236 [11:39<03:48,  4.24s/it]
test ppl:  78%|███████▊  | 183/236 [11:42<03:13,  3.65s/it]
test ppl:  78%|███████▊  | 184/236 [11:43<02:35,  2.99s/it]
test ppl:  78%|███████▊  | 185/236 [11:47<02:43,  3.21s/it]
test ppl:  79%|███████▉  | 186/236 [11:49<02:22,  2.84s/it]
test ppl:  79%|███████▉  | 187/236 [11:55<03:04,  3.77s/it]
test ppl:  80%|███████▉  | 188/236 [12:01<03:30,  4.39s/it]
test ppl:  80%|████████  | 189/236 [12:06<03:46,  4.83s/it]
test ppl:  81%|████████  | 190/236 [12:10<03:25,  4.47s/it]
test ppl:  81%|████████  | 191/236 [12:14<03:11,  4.26s/it]
test ppl:  81%|████████▏ | 192/236 [12:16<02:45,  3.77s/it]
test ppl:  82%|████████▏ | 193/236 [12:22<03:08,  4.39s/it]
test ppl:  82%|████████▏ | 194/236 [12:25<02:41,  3.86s/it]
test ppl:  83%|████████▎ | 195/236 [12:28<02:28,  3.61s/it]
test ppl:  83%|████████▎ | 196/236 [12:30<02:05,  3.13s/it]
test ppl:  83%|████████▎ | 197/236 [12:32<01:50,  2.82s/it]
test ppl:  84%|████████▍ | 198/236 [12:38<02:21,  3.72s/it]
test ppl:  84%|████████▍ | 199/236 [12:41<02:06,  3.41s/it]
test ppl:  85%|████████▍ | 200/236 [12:46<02:28,  4.13s/it]
test ppl:  85%|████████▌ | 201/236 [12:48<02:02,  3.50s/it]
test ppl:  86%|████████▌ | 202/236 [12:53<02:10,  3.82s/it]
test ppl:  86%|████████▌ | 203/236 [12:59<02:26,  4.43s/it]
test ppl:  86%|████████▋ | 204/236 [13:00<01:53,  3.54s/it]
test ppl:  87%|████████▋ | 205/236 [13:06<02:11,  4.24s/it]
test ppl:  87%|████████▋ | 206/236 [13:09<01:58,  3.95s/it]
test ppl:  88%|████████▊ | 207/236 [13:15<02:10,  4.51s/it]
test ppl:  88%|████████▊ | 208/236 [13:18<01:54,  4.09s/it]
test ppl:  89%|████████▊ | 209/236 [13:24<02:05,  4.63s/it]
test ppl:  89%|████████▉ | 210/236 [13:27<01:42,  3.94s/it]
test ppl:  89%|████████▉ | 211/236 [13:30<01:37,  3.89s/it]
test ppl:  90%|████████▉ | 212/236 [13:36<01:47,  4.46s/it]
test ppl:  90%|█████████ | 213/236 [13:42<01:52,  4.87s/it]
test ppl:  91%|█████████ | 214/236 [13:44<01:25,  3.90s/it]
test ppl:  91%|█████████ | 215/236 [13:49<01:34,  4.48s/it]
test ppl:  92%|█████████▏| 216/236 [13:52<01:17,  3.90s/it]
test ppl:  92%|█████████▏| 217/236 [13:58<01:25,  4.51s/it]
test ppl:  92%|█████████▏| 218/236 [14:00<01:09,  3.88s/it]
test ppl:  93%|█████████▎| 219/236 [14:06<01:15,  4.47s/it]
test ppl:  93%|█████████▎| 220/236 [14:12<01:18,  4.88s/it]
test ppl:  94%|█████████▎| 221/236 [14:14<00:59,  3.93s/it]
test ppl:  94%|█████████▍| 222/236 [14:20<01:03,  4.51s/it]
test ppl:  94%|█████████▍| 223/236 [14:25<01:03,  4.91s/it]
test ppl:  95%|█████████▍| 224/236 [14:27<00:46,  3.90s/it]
test ppl:  95%|█████████▌| 225/236 [14:33<00:49,  4.48s/it]
test ppl:  96%|█████████▌| 226/236 [14:36<00:42,  4.22s/it]
test ppl:  96%|█████████▌| 227/236 [14:39<00:34,  3.81s/it]
test ppl:  97%|█████████▋| 228/236 [14:41<00:26,  3.28s/it]
test ppl:  97%|█████████▋| 229/236 [14:47<00:28,  4.04s/it]
test ppl:  97%|█████████▋| 230/236 [14:51<00:23,  3.86s/it]
test ppl:  98%|█████████▊| 231/236 [14:54<00:18,  3.70s/it]
test ppl:  98%|█████████▊| 232/236 [14:56<00:12,  3.11s/it]
test ppl:  99%|█████████▊| 233/236 [14:58<00:08,  2.82s/it]
test ppl:  99%|█████████▉| 234/236 [15:00<00:05,  2.54s/it]
test ppl: 100%|█████████▉| 235/236 [15:06<00:03,  3.53s/it]
test ppl: 100%|██████████| 236/236 [15:06<00:00,  2.66s/it]
test ppl: 100%|██████████| 236/236 [15:06<00:00,  3.84s/it]
10/12/2024 16:09:17 - INFO - __main__ -    em: 0.2078
10/12/2024 16:09:17 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.4 50:  em: 0.2078

--------------------------------------------------------------------------------
Running experiment with knn_temp=50, lmbda=0.4, k=64
2024-10-12 16:09:24.761005: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 16:09:24.780595: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 16:09:24.802334: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 16:09:24.808962: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 16:09:24.824965: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 16:09:25.815504: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 16:09:27 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.4, knn_temp=50, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 16:09:27 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:43:51,  2.19it/s]
Adding feature api:   3%|▎         | 6480/187062 [00:00<00:11, 15438.59it/s]
Adding feature api:   7%|▋         | 13997/187062 [00:00<00:05, 30606.13it/s]
Adding feature api:  11%|█▏        | 21308/187062 [00:00<00:03, 41918.93it/s]
Adding feature api:  15%|█▌        | 28867/187062 [00:00<00:03, 51193.75it/s]
Adding feature api:  19%|█▉        | 36445/187062 [00:00<00:02, 58136.10it/s]
Adding feature api:  24%|██▎       | 44004/187062 [00:01<00:02, 63152.30it/s]
Adding feature api:  27%|██▋       | 51315/187062 [00:01<00:02, 66049.97it/s]
Adding feature api:  31%|███▏      | 58897/187062 [00:01<00:01, 68916.97it/s]
Adding feature api:  36%|███▌      | 66473/187062 [00:01<00:01, 70937.16it/s]
Adding feature api:  40%|███▉      | 74044/187062 [00:01<00:01, 72352.84it/s]
Adding feature api:  44%|████▎     | 81503/187062 [00:01<00:01, 72552.38it/s]
Adding feature api:  48%|████▊     | 89077/187062 [00:01<00:01, 73496.43it/s]
Adding feature api:  52%|█████▏    | 96615/187062 [00:01<00:01, 74054.38it/s]
Adding feature api:  56%|█████▌    | 104200/187062 [00:01<00:01, 74589.98it/s]
Adding feature api:  60%|█████▉    | 111754/187062 [00:01<00:01, 74870.96it/s]
Adding feature api:  64%|██████▍   | 119280/187062 [00:02<00:00, 74472.33it/s]
Adding feature api:  68%|██████▊   | 126773/187062 [00:02<00:00, 74605.63it/s]
Adding feature api:  72%|███████▏  | 134335/187062 [00:02<00:00, 74906.22it/s]
Adding feature api:  76%|███████▌  | 141960/187062 [00:02<00:00, 75306.63it/s]
Adding feature api:  80%|███████▉  | 149501/187062 [00:02<00:00, 74845.67it/s]
Adding feature api:  84%|████████▍ | 157067/187062 [00:02<00:00, 75086.93it/s]
Adding feature api:  88%|████████▊ | 164647/187062 [00:02<00:00, 75299.57it/s]
Adding feature api:  92%|█████████▏| 172220/187062 [00:02<00:00, 75425.69it/s]
Adding feature api:  96%|█████████▌| 179766/187062 [00:02<00:00, 65103.32it/s]
Adding feature api: 100%|█████████▉| 186528/187062 [00:03<00:00, 47056.22it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 58780.65it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:33:15,  2.21it/s]
Adding feature datatype:   3%|▎         | 6366/187062 [00:00<00:11, 15253.72it/s]
Adding feature datatype:   7%|▋         | 13641/187062 [00:00<00:05, 29915.78it/s]
Adding feature datatype:  11%|█         | 20662/187062 [00:00<00:04, 40674.74it/s]
Adding feature datatype:  15%|█▍        | 27952/187062 [00:00<00:03, 49571.12it/s]
Adding feature datatype:  19%|█▉        | 35264/187062 [00:00<00:02, 56230.17it/s]
Adding feature datatype:  23%|██▎       | 42635/187062 [00:01<00:02, 61258.34it/s]
Adding feature datatype:  27%|██▋       | 49997/187062 [00:01<00:02, 64857.94it/s]
Adding feature datatype:  31%|███       | 57364/187062 [00:01<00:01, 67444.86it/s]
Adding feature datatype:  35%|███▍      | 64538/187062 [00:01<00:01, 68511.11it/s]
Adding feature datatype:  38%|███▊      | 71862/187062 [00:01<00:01, 69910.83it/s]
Adding feature datatype:  42%|████▏     | 79212/187062 [00:01<00:01, 70975.75it/s]
Adding feature datatype:  46%|████▋     | 86572/187062 [00:01<00:01, 71756.65it/s]
Adding feature datatype:  50%|█████     | 93916/187062 [00:01<00:01, 72258.86it/s]
Adding feature datatype:  54%|█████▍    | 101256/187062 [00:01<00:01, 72599.01it/s]
Adding feature datatype:  58%|█████▊    | 108569/187062 [00:01<00:01, 71983.06it/s]
Adding feature datatype:  62%|██████▏   | 115938/187062 [00:02<00:00, 72489.71it/s]
Adding feature datatype:  66%|██████▌   | 123304/187062 [00:02<00:00, 72837.62it/s]
Adding feature datatype:  70%|██████▉   | 130688/187062 [00:02<00:00, 73134.42it/s]
Adding feature datatype:  74%|███████▍  | 138064/187062 [00:02<00:00, 73320.02it/s]
Adding feature datatype:  78%|███████▊  | 145406/187062 [00:02<00:00, 72628.85it/s]
Adding feature datatype:  82%|████████▏ | 152748/187062 [00:02<00:00, 72863.03it/s]
Adding feature datatype:  86%|████████▌ | 160124/187062 [00:02<00:00, 73128.93it/s]
Adding feature datatype:  90%|████████▉ | 167442/187062 [00:02<00:00, 72947.81it/s]
Adding feature datatype:  93%|█████████▎| 174740/187062 [00:02<00:00, 72208.34it/s]
Adding feature datatype:  97%|█████████▋| 181965/187062 [00:03<00:00, 54537.72it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 57557.10it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:22:21,  2.22it/s]
Adding feature literal:   3%|▎         | 6293/187062 [00:00<00:11, 15167.81it/s]
Adding feature literal:   7%|▋         | 13534/187062 [00:00<00:05, 29828.69it/s]
Adding feature literal:  11%|█         | 20900/187062 [00:00<00:03, 41568.93it/s]
Adding feature literal:  15%|█▌        | 28248/187062 [00:00<00:03, 50399.25it/s]
Adding feature literal:  19%|█▉        | 35589/187062 [00:00<00:02, 56917.99it/s]
Adding feature literal:  23%|██▎       | 42790/187062 [00:01<00:02, 61264.02it/s]
Adding feature literal:  27%|██▋       | 49836/187062 [00:01<00:02, 63943.97it/s]
Adding feature literal:  31%|███       | 57207/187062 [00:01<00:01, 66813.37it/s]
Adding feature literal:  34%|███▍      | 64535/187062 [00:01<00:01, 68725.01it/s]
Adding feature literal:  38%|███▊      | 71912/187062 [00:01<00:01, 70221.10it/s]
Adding feature literal:  42%|████▏     | 79316/187062 [00:01<00:01, 71355.86it/s]
Adding feature literal:  46%|████▋     | 86729/187062 [00:01<00:01, 72182.77it/s]
Adding feature literal:  50%|█████     | 94135/187062 [00:01<00:01, 72741.22it/s]
Adding feature literal:  54%|█████▍    | 101504/187062 [00:01<00:01, 73022.11it/s]
Adding feature literal:  58%|█████▊    | 108889/187062 [00:01<00:01, 73269.23it/s]
Adding feature literal:  62%|██████▏   | 116302/187062 [00:02<00:00, 73525.43it/s]
Adding feature literal:  66%|██████▌   | 123705/187062 [00:02<00:00, 73673.22it/s]
Adding feature literal:  70%|███████   | 131102/187062 [00:02<00:00, 73760.58it/s]
Adding feature literal:  74%|███████▍  | 138493/187062 [00:02<00:00, 73803.35it/s]
Adding feature literal:  78%|███████▊  | 145883/187062 [00:02<00:00, 73717.92it/s]
Adding feature literal:  82%|████████▏ | 153261/187062 [00:02<00:00, 73718.11it/s]
Adding feature literal:  86%|████████▌ | 160645/187062 [00:02<00:00, 73752.50it/s]
Adding feature literal:  90%|████████▉ | 168024/187062 [00:02<00:00, 73319.09it/s]
Adding feature literal:  94%|█████████▍| 175420/187062 [00:02<00:00, 73507.38it/s]
Adding feature literal:  98%|█████████▊| 182773/187062 [00:03<00:00, 52314.01it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 57879.79it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:25:18,  2.22it/s]
Adding feature operator:   3%|▎         | 6343/187062 [00:00<00:11, 15263.79it/s]
Adding feature operator:   7%|▋         | 13637/187062 [00:00<00:05, 30018.63it/s]
Adding feature operator:  11%|█         | 20942/187062 [00:00<00:03, 41535.50it/s]
Adding feature operator:  15%|█▌        | 28295/187062 [00:00<00:03, 50383.04it/s]
Adding feature operator:  19%|█▉        | 35625/187062 [00:00<00:02, 56873.06it/s]
Adding feature operator:  23%|██▎       | 42911/187062 [00:01<00:02, 61476.59it/s]
Adding feature operator:  27%|██▋       | 50247/187062 [00:01<00:02, 64938.70it/s]
Adding feature operator:  31%|███       | 57646/187062 [00:01<00:01, 67598.35it/s]
Adding feature operator:  35%|███▍      | 65075/187062 [00:01<00:01, 69577.17it/s]
Adding feature operator:  39%|███▉      | 72489/187062 [00:01<00:01, 70931.89it/s]
Adding feature operator:  43%|████▎     | 79854/187062 [00:01<00:01, 71738.92it/s]
Adding feature operator:  47%|████▋     | 87214/187062 [00:01<00:01, 72292.93it/s]
Adding feature operator:  51%|█████     | 94562/187062 [00:01<00:01, 72644.79it/s]
Adding feature operator:  55%|█████▍    | 101959/187062 [00:01<00:01, 73039.00it/s]
Adding feature operator:  58%|█████▊    | 109331/187062 [00:01<00:01, 73241.82it/s]
Adding feature operator:  62%|██████▏   | 116692/187062 [00:02<00:00, 73308.69it/s]
Adding feature operator:  66%|██████▋   | 124050/187062 [00:02<00:00, 73388.53it/s]
Adding feature operator:  70%|███████   | 131421/187062 [00:02<00:00, 73483.17it/s]
Adding feature operator:  74%|███████▍  | 138789/187062 [00:02<00:00, 73533.37it/s]
Adding feature operator:  78%|███████▊  | 146152/187062 [00:02<00:00, 73557.53it/s]
Adding feature operator:  82%|████████▏ | 153514/187062 [00:02<00:00, 73552.83it/s]
Adding feature operator:  86%|████████▌ | 160902/187062 [00:02<00:00, 73648.58it/s]
Adding feature operator:  90%|████████▉ | 168270/187062 [00:02<00:00, 73499.43it/s]
Adding feature operator:  94%|█████████▍| 175643/187062 [00:02<00:00, 73566.19it/s]
Adding feature operator:  98%|█████████▊| 183002/187062 [00:03<00:00, 51665.17it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 57973.48it/s]
[2024-10-12 16:10:12,214] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 16:10:13 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 16:10:13 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 412.83 examples/s]
Map:   2%|▏         | 105/6548 [00:00<00:26, 243.34 examples/s]
Map:   2%|▏         | 137/6548 [00:00<00:24, 263.06 examples/s]
Map:   3%|▎         | 178/6548 [00:00<00:21, 297.03 examples/s]
Map:   3%|▎         | 225/6548 [00:00<00:18, 343.50 examples/s]
Map:   4%|▍         | 286/6548 [00:00<00:17, 359.66 examples/s]
Map:   5%|▌         | 328/6548 [00:01<00:19, 317.13 examples/s]
Map:   6%|▌         | 380/6548 [00:01<00:19, 324.62 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:17, 359.16 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 324.28 examples/s]
Map:   8%|▊         | 529/6548 [00:01<00:17, 339.79 examples/s]
Map:   9%|▉         | 575/6548 [00:01<00:16, 360.06 examples/s]
Map:   9%|▉         | 622/6548 [00:01<00:17, 335.38 examples/s]
Map:  10%|█         | 667/6548 [00:02<00:18, 322.83 examples/s]
Map:  11%|█         | 710/6548 [00:02<00:16, 345.15 examples/s]
Map:  12%|█▏        | 758/6548 [00:02<00:15, 373.83 examples/s]
Map:  12%|█▏        | 813/6548 [00:02<00:13, 410.63 examples/s]
Map:  13%|█▎        | 876/6548 [00:02<00:13, 406.48 examples/s]
Map:  14%|█▍        | 932/6548 [00:02<00:14, 380.06 examples/s]
Map:  15%|█▌        | 985/6548 [00:02<00:15, 366.18 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:22, 249.65 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:20, 271.73 examples/s]
Map:  17%|█▋        | 1124/6548 [00:03<00:17, 309.18 examples/s]
Map:  18%|█▊        | 1164/6548 [00:03<00:16, 326.12 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 346.05 examples/s]
Map:  19%|█▉        | 1249/6548 [00:03<00:14, 355.76 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:14, 368.39 examples/s]
Map:  21%|██        | 1355/6548 [00:04<00:16, 314.11 examples/s]
Map:  21%|██▏       | 1401/6548 [00:04<00:16, 309.48 examples/s]
Map:  22%|██▏       | 1436/6548 [00:04<00:17, 289.77 examples/s]
Map:  23%|██▎       | 1478/6548 [00:04<00:17, 283.83 examples/s]
Map:  23%|██▎       | 1508/6548 [00:04<00:17, 286.68 examples/s]
Map:  24%|██▎       | 1546/6548 [00:04<00:18, 273.09 examples/s]
Map:  24%|██▍       | 1582/6548 [00:04<00:17, 291.25 examples/s]
Map:  25%|██▍       | 1621/6548 [00:05<00:18, 270.34 examples/s]
Map:  25%|██▌       | 1653/6548 [00:05<00:18, 266.26 examples/s]
Map:  26%|██▌       | 1688/6548 [00:05<00:17, 285.24 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:15, 310.91 examples/s]
Map:  27%|██▋       | 1769/6548 [00:05<00:14, 335.36 examples/s]
Map:  28%|██▊       | 1807/6548 [00:05<00:13, 346.34 examples/s]
Map:  28%|██▊       | 1845/6548 [00:05<00:13, 343.53 examples/s]
Map:  29%|██▉       | 1890/6548 [00:05<00:14, 322.16 examples/s]
Map:  30%|██▉       | 1933/6548 [00:05<00:13, 346.51 examples/s]
Map:  30%|███       | 1987/6548 [00:06<00:13, 349.52 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:20, 222.78 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:17, 251.92 examples/s]
Map:  32%|███▏      | 2107/6548 [00:06<00:16, 269.08 examples/s]
Map:  33%|███▎      | 2139/6548 [00:06<00:16, 263.06 examples/s]
Map:  33%|███▎      | 2171/6548 [00:06<00:16, 272.87 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 287.53 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:14, 290.23 examples/s]
Map:  35%|███▌      | 2293/6548 [00:07<00:14, 299.09 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:13, 321.67 examples/s]
Map:  36%|███▋      | 2376/6548 [00:07<00:12, 321.05 examples/s]
Map:  37%|███▋      | 2418/6548 [00:07<00:12, 343.39 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:12, 327.36 examples/s]
Map:  38%|███▊      | 2501/6548 [00:07<00:13, 307.46 examples/s]
Map:  39%|███▉      | 2545/6548 [00:08<00:12, 330.11 examples/s]
Map:  40%|███▉      | 2594/6548 [00:08<00:10, 368.64 examples/s]
Map:  40%|████      | 2638/6548 [00:08<00:10, 385.02 examples/s]
Map:  41%|████      | 2694/6548 [00:08<00:11, 348.14 examples/s]
Map:  42%|████▏     | 2745/6548 [00:08<00:11, 342.96 examples/s]
Map:  43%|████▎     | 2795/6548 [00:08<00:11, 338.01 examples/s]
Map:  43%|████▎     | 2841/6548 [00:09<00:13, 279.13 examples/s]
Map:  44%|████▍     | 2875/6548 [00:09<00:12, 289.66 examples/s]
Map:  45%|████▍     | 2925/6548 [00:09<00:12, 280.92 examples/s]
Map:  45%|████▌     | 2967/6548 [00:09<00:11, 307.82 examples/s]
Map:  46%|████▌     | 3000/6548 [00:09<00:20, 176.80 examples/s]
Map:  46%|████▋     | 3044/6548 [00:10<00:17, 198.06 examples/s]
Map:  47%|████▋     | 3079/6548 [00:10<00:15, 222.53 examples/s]
Map:  48%|████▊     | 3120/6548 [00:10<00:13, 256.69 examples/s]
Map:  48%|████▊     | 3169/6548 [00:10<00:13, 255.28 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 249.70 examples/s]
Map:  50%|████▉     | 3247/6548 [00:10<00:12, 259.78 examples/s]
Map:  50%|█████     | 3284/6548 [00:10<00:11, 277.39 examples/s]
Map:  51%|█████     | 3317/6548 [00:10<00:11, 287.51 examples/s]
Map:  51%|█████     | 3348/6548 [00:11<00:11, 288.66 examples/s]
Map:  52%|█████▏    | 3380/6548 [00:11<00:10, 289.48 examples/s]
Map:  52%|█████▏    | 3425/6548 [00:11<00:11, 283.38 examples/s]
Map:  53%|█████▎    | 3459/6548 [00:11<00:12, 247.27 examples/s]
Map:  53%|█████▎    | 3493/6548 [00:11<00:11, 262.48 examples/s]
Map:  54%|█████▍    | 3543/6548 [00:11<00:09, 316.39 examples/s]
Map:  55%|█████▍    | 3591/6548 [00:11<00:08, 352.67 examples/s]
Map:  56%|█████▌    | 3637/6548 [00:11<00:07, 379.29 examples/s]
Map:  56%|█████▋    | 3697/6548 [00:12<00:07, 380.05 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:12<00:07, 386.78 examples/s]
Map:  58%|█████▊    | 3802/6548 [00:12<00:06, 393.64 examples/s]
Map:  59%|█████▊    | 3844/6548 [00:12<00:07, 341.64 examples/s]
Map:  60%|█████▉    | 3902/6548 [00:12<00:07, 346.60 examples/s]
Map:  60%|██████    | 3952/6548 [00:12<00:08, 322.96 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 240.94 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 291.70 examples/s]
Map:  63%|██████▎   | 4094/6548 [00:13<00:07, 311.51 examples/s]
Map:  63%|██████▎   | 4134/6548 [00:13<00:07, 326.73 examples/s]
Map:  64%|██████▍   | 4179/6548 [00:13<00:07, 304.90 examples/s]
Map:  64%|██████▍   | 4216/6548 [00:13<00:07, 317.75 examples/s]
Map:  65%|██████▌   | 4266/6548 [00:13<00:06, 360.69 examples/s]
Map:  66%|██████▌   | 4326/6548 [00:14<00:05, 371.66 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:14<00:06, 358.75 examples/s]
Map:  68%|██████▊   | 4432/6548 [00:14<00:05, 373.35 examples/s]
Map:  68%|██████▊   | 4483/6548 [00:14<00:05, 349.39 examples/s]
Map:  69%|██████▉   | 4526/6548 [00:14<00:06, 323.67 examples/s]
Map:  70%|██████▉   | 4579/6548 [00:14<00:06, 327.94 examples/s]
Map:  71%|███████   | 4617/6548 [00:14<00:05, 338.30 examples/s]
Map:  71%|███████▏  | 4666/6548 [00:14<00:05, 368.98 examples/s]
Map:  72%|███████▏  | 4715/6548 [00:15<00:05, 353.50 examples/s]
Map:  73%|███████▎  | 4753/6548 [00:15<00:05, 358.06 examples/s]
Map:  73%|███████▎  | 4810/6548 [00:15<00:04, 411.14 examples/s]
Map:  74%|███████▍  | 4861/6548 [00:15<00:04, 374.70 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 381.79 examples/s]
Map:  76%|███████▌  | 4960/6548 [00:15<00:03, 424.15 examples/s]
Map:  76%|███████▋  | 5006/6548 [00:16<00:06, 236.54 examples/s]
Map:  77%|███████▋  | 5053/6548 [00:16<00:05, 274.89 examples/s]
Map:  78%|███████▊  | 5101/6548 [00:16<00:05, 279.59 examples/s]
Map:  79%|███████▊  | 5145/6548 [00:16<00:05, 271.19 examples/s]
Map:  79%|███████▉  | 5185/6548 [00:16<00:04, 295.24 examples/s]
Map:  80%|███████▉  | 5233/6548 [00:16<00:04, 299.71 examples/s]
Map:  81%|████████  | 5286/6548 [00:16<00:04, 314.87 examples/s]
Map:  81%|████████▏ | 5328/6548 [00:17<00:04, 301.36 examples/s]
Map:  82%|████████▏ | 5385/6548 [00:17<00:03, 301.91 examples/s]
Map:  83%|████████▎ | 5428/6548 [00:17<00:04, 265.62 examples/s]
Map:  83%|████████▎ | 5462/6548 [00:17<00:03, 279.26 examples/s]
Map:  84%|████████▍ | 5503/6548 [00:17<00:03, 306.11 examples/s]
Map:  85%|████████▍ | 5543/6548 [00:17<00:03, 328.03 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:18<00:03, 290.60 examples/s]
Map:  86%|████████▌ | 5639/6548 [00:18<00:02, 344.41 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 314.54 examples/s]
Map:  87%|████████▋ | 5721/6548 [00:18<00:02, 333.81 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 339.04 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 345.60 examples/s]
Map:  89%|████████▉ | 5845/6548 [00:18<00:02, 342.32 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:18<00:01, 349.36 examples/s]
Map:  90%|█████████ | 5923/6548 [00:18<00:01, 360.69 examples/s]
Map:  91%|█████████ | 5961/6548 [00:19<00:01, 354.16 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 214.62 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:02, 249.14 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 281.72 examples/s]
Map:  94%|█████████▎| 6133/6548 [00:19<00:01, 265.07 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:19<00:01, 274.08 examples/s]
Map:  95%|█████████▍| 6208/6548 [00:20<00:01, 303.71 examples/s]
Map:  95%|█████████▌| 6249/6548 [00:20<00:00, 324.45 examples/s]
Map:  96%|█████████▋| 6304/6548 [00:20<00:00, 337.34 examples/s]
Map:  97%|█████████▋| 6340/6548 [00:20<00:00, 341.68 examples/s]
Map:  98%|█████████▊| 6385/6548 [00:20<00:00, 360.46 examples/s]
Map:  98%|█████████▊| 6425/6548 [00:20<00:00, 369.91 examples/s]
Map:  99%|█████████▉| 6474/6548 [00:20<00:00, 401.45 examples/s]
Map: 100%|█████████▉| 6538/6548 [00:20<00:00, 392.42 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 311.21 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 328.56 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 349.18 examples/s]
Map:  12%|█▏        | 110/903 [00:00<00:02, 322.06 examples/s]
Map:  17%|█▋        | 150/903 [00:00<00:02, 345.42 examples/s]
Map:  22%|██▏       | 202/903 [00:00<00:01, 401.51 examples/s]
Map:  29%|██▉       | 260/903 [00:00<00:01, 382.22 examples/s]
Map:  33%|███▎      | 302/903 [00:00<00:01, 376.10 examples/s]
Map:  39%|███▉      | 355/903 [00:00<00:01, 365.90 examples/s]
Map:  46%|████▌     | 413/903 [00:01<00:01, 289.11 examples/s]
Map:  50%|█████     | 456/903 [00:01<00:01, 287.01 examples/s]
Map:  54%|█████▍    | 488/903 [00:01<00:01, 289.85 examples/s]
Map:  59%|█████▉    | 537/903 [00:01<00:01, 330.09 examples/s]
Map:  65%|██████▍   | 583/903 [00:01<00:00, 361.05 examples/s]
Map:  69%|██████▉   | 622/903 [00:01<00:00, 362.75 examples/s]
Map:  74%|███████▎  | 665/903 [00:01<00:00, 367.30 examples/s]
Map:  78%|███████▊  | 706/903 [00:02<00:00, 371.48 examples/s]
Map:  84%|████████▍ | 757/903 [00:02<00:00, 408.39 examples/s]
Map:  90%|████████▉ | 812/903 [00:02<00:00, 389.20 examples/s]
Map:  95%|█████████▌| 862/903 [00:02<00:00, 394.34 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 243.70 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 325.97 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 37/1882 [00:00<00:06, 287.62 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 356.52 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 352.17 examples/s]
Map:   9%|▊         | 162/1882 [00:00<00:04, 375.72 examples/s]
Map:  11%|█         | 203/1882 [00:00<00:04, 354.03 examples/s]
Map:  13%|█▎        | 254/1882 [00:00<00:04, 400.86 examples/s]
Map:  16%|█▋        | 310/1882 [00:00<00:04, 379.44 examples/s]
Map:  19%|█▉        | 357/1882 [00:00<00:04, 353.35 examples/s]
Map:  21%|██        | 396/1882 [00:01<00:04, 312.60 examples/s]
Map:  23%|██▎       | 442/1882 [00:01<00:04, 309.68 examples/s]
Map:  26%|██▌       | 492/1882 [00:01<00:04, 315.44 examples/s]
Map:  28%|██▊       | 535/1882 [00:01<00:04, 303.38 examples/s]
Map:  31%|███       | 576/1882 [00:01<00:04, 323.56 examples/s]
Map:  34%|███▎      | 632/1882 [00:01<00:03, 378.85 examples/s]
Map:  36%|███▌      | 678/1882 [00:01<00:03, 384.91 examples/s]
Map:  39%|███▉      | 734/1882 [00:02<00:03, 377.88 examples/s]
Map:  41%|████      | 773/1882 [00:02<00:03, 361.54 examples/s]
Map:  44%|████▍     | 826/1882 [00:02<00:02, 352.46 examples/s]
Map:  46%|████▌     | 863/1882 [00:02<00:02, 353.28 examples/s]
Map:  48%|████▊     | 904/1882 [00:02<00:02, 364.33 examples/s]
Map:  50%|█████     | 947/1882 [00:02<00:02, 377.72 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 386.01 examples/s]
Map:  55%|█████▍    | 1032/1882 [00:03<00:03, 225.87 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 235.99 examples/s]
Map:  60%|█████▉    | 1120/1882 [00:03<00:02, 254.29 examples/s]
Map:  62%|██████▏   | 1172/1882 [00:03<00:02, 277.60 examples/s]
Map:  64%|██████▍   | 1205/1882 [00:03<00:02, 256.30 examples/s]
Map:  66%|██████▌   | 1245/1882 [00:03<00:02, 284.90 examples/s]
Map:  68%|██████▊   | 1283/1882 [00:03<00:01, 305.85 examples/s]
Map:  71%|███████   | 1334/1882 [00:04<00:01, 346.95 examples/s]
Map:  73%|███████▎  | 1374/1882 [00:04<00:01, 314.55 examples/s]
Map:  75%|███████▍  | 1409/1882 [00:04<00:01, 321.63 examples/s]
Map:  77%|███████▋  | 1447/1882 [00:04<00:01, 277.14 examples/s]
Map:  78%|███████▊  | 1477/1882 [00:04<00:01, 275.04 examples/s]
Map:  80%|████████  | 1507/1882 [00:04<00:01, 270.56 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 286.67 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:04<00:00, 313.85 examples/s]
Map:  87%|████████▋ | 1628/1882 [00:05<00:00, 349.04 examples/s]
Map:  88%|████████▊ | 1664/1882 [00:05<00:00, 341.87 examples/s]
Map:  91%|█████████ | 1712/1882 [00:05<00:00, 329.74 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 267.07 examples/s]
Map:  95%|█████████▍| 1785/1882 [00:05<00:00, 274.52 examples/s]
Map:  97%|█████████▋| 1830/1882 [00:05<00:00, 315.21 examples/s]
Map: 100%|█████████▉| 1875/1882 [00:05<00:00, 346.64 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 308.39 examples/s]
10/12/2024 16:11:15 - INFO - __main__ -     ***** Testing *****
10/12/2024 16:11:15 - INFO - __main__ -     Batch size = 8
10/12/2024 16:11:15 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 16:11:16 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 16:11:16 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 16:11:17 - INFO - knnlm -   Reading datastore took 0.9152443408966064 s
10/12/2024 16:11:18 - INFO - knnlm -   Moving index to GPU took 0.8956830501556396 s
10/12/2024 16:11:18 - INFO - __main__ -   ******************************break-into
10/12/2024 16:11:18 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 16:11:18 - INFO - __main__ -     Num examples = 236
10/12/2024 16:11:18 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:20,  7.49s/it]
test ppl:   1%|          | 2/236 [00:09<16:25,  4.21s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:33,  2.98s/it]
test ppl:   2%|▏         | 4/236 [00:16<15:57,  4.13s/it]
test ppl:   2%|▏         | 5/236 [00:22<18:21,  4.77s/it]
test ppl:   3%|▎         | 6/236 [00:28<19:46,  5.16s/it]
test ppl:   3%|▎         | 7/236 [00:30<15:36,  4.09s/it]
test ppl:   3%|▎         | 8/236 [00:35<16:57,  4.46s/it]
test ppl:   4%|▍         | 9/236 [00:41<18:37,  4.92s/it]
test ppl:   4%|▍         | 10/236 [00:47<19:43,  5.24s/it]
test ppl:   5%|▍         | 11/236 [00:50<16:57,  4.52s/it]
test ppl:   5%|▌         | 12/236 [00:56<18:27,  4.94s/it]
test ppl:   6%|▌         | 13/236 [01:02<19:27,  5.23s/it]
test ppl:   6%|▌         | 14/236 [01:04<16:08,  4.36s/it]
test ppl:   6%|▋         | 15/236 [01:07<14:13,  3.86s/it]
test ppl:   7%|▋         | 16/236 [01:09<11:58,  3.26s/it]
test ppl:   7%|▋         | 17/236 [01:15<15:15,  4.18s/it]
test ppl:   8%|▊         | 18/236 [01:17<12:29,  3.44s/it]
test ppl:   8%|▊         | 19/236 [01:21<13:34,  3.76s/it]
test ppl:   8%|▊         | 20/236 [01:23<11:23,  3.17s/it]
test ppl:   9%|▉         | 21/236 [01:25<10:30,  2.93s/it]
test ppl:   9%|▉         | 22/236 [01:31<13:41,  3.84s/it]
test ppl:  10%|▉         | 23/236 [01:34<12:15,  3.45s/it]
test ppl:  10%|█         | 24/236 [01:36<11:02,  3.13s/it]
test ppl:  11%|█         | 25/236 [01:42<13:59,  3.98s/it]
test ppl:  11%|█         | 26/236 [01:48<16:00,  4.58s/it]
test ppl:  11%|█▏        | 27/236 [01:52<14:47,  4.25s/it]
test ppl:  12%|█▏        | 28/236 [01:53<11:34,  3.34s/it]
test ppl:  12%|█▏        | 29/236 [01:55<10:30,  3.05s/it]
test ppl:  13%|█▎        | 30/236 [01:57<08:54,  2.59s/it]
test ppl:  13%|█▎        | 31/236 [01:59<08:26,  2.47s/it]
test ppl:  14%|█▎        | 32/236 [02:02<08:36,  2.53s/it]
test ppl:  14%|█▍        | 33/236 [02:05<09:04,  2.68s/it]
test ppl:  14%|█▍        | 34/236 [02:09<10:25,  3.09s/it]
test ppl:  15%|█▍        | 35/236 [02:11<09:49,  2.93s/it]
test ppl:  15%|█▌        | 36/236 [02:17<12:45,  3.83s/it]
test ppl:  16%|█▌        | 37/236 [02:23<14:49,  4.47s/it]
test ppl:  16%|█▌        | 38/236 [02:25<12:24,  3.76s/it]
test ppl:  17%|█▋        | 39/236 [02:27<10:08,  3.09s/it]
test ppl:  17%|█▋        | 40/236 [02:30<09:44,  2.98s/it]
test ppl:  17%|█▋        | 41/236 [02:32<08:37,  2.65s/it]
test ppl:  18%|█▊        | 42/236 [02:37<11:46,  3.64s/it]
test ppl:  18%|█▊        | 43/236 [02:43<13:55,  4.33s/it]
test ppl:  19%|█▊        | 44/236 [02:46<12:14,  3.82s/it]
test ppl:  19%|█▉        | 45/236 [02:48<10:24,  3.27s/it]
test ppl:  19%|█▉        | 46/236 [02:54<12:55,  4.08s/it]
test ppl:  20%|█▉        | 47/236 [02:56<10:27,  3.32s/it]
test ppl:  20%|██        | 48/236 [03:01<12:49,  4.09s/it]
test ppl:  21%|██        | 49/236 [03:06<13:14,  4.25s/it]
test ppl:  21%|██        | 50/236 [03:12<14:46,  4.77s/it]
test ppl:  22%|██▏       | 51/236 [03:18<15:47,  5.12s/it]
test ppl:  22%|██▏       | 52/236 [03:24<16:26,  5.36s/it]
test ppl:  22%|██▏       | 53/236 [03:29<15:53,  5.21s/it]
test ppl:  23%|██▎       | 54/236 [03:30<12:28,  4.12s/it]
test ppl:  23%|██▎       | 55/236 [03:36<13:55,  4.61s/it]
test ppl:  24%|██▎       | 56/236 [03:40<12:52,  4.29s/it]
test ppl:  24%|██▍       | 57/236 [03:42<11:02,  3.70s/it]
test ppl:  25%|██▍       | 58/236 [03:44<09:38,  3.25s/it]
test ppl:  25%|██▌       | 59/236 [03:50<11:57,  4.05s/it]
test ppl:  25%|██▌       | 60/236 [03:53<10:58,  3.74s/it]
test ppl:  26%|██▌       | 61/236 [03:59<12:49,  4.40s/it]
test ppl:  26%|██▋       | 62/236 [04:03<12:32,  4.32s/it]
test ppl:  27%|██▋       | 63/236 [04:06<10:52,  3.77s/it]
test ppl:  27%|██▋       | 64/236 [04:08<09:14,  3.22s/it]
test ppl:  28%|██▊       | 65/236 [04:09<07:34,  2.66s/it]
test ppl:  28%|██▊       | 66/236 [04:12<07:52,  2.78s/it]
test ppl:  28%|██▊       | 67/236 [04:18<10:30,  3.73s/it]
test ppl:  29%|██▉       | 68/236 [04:24<12:17,  4.39s/it]
test ppl:  29%|██▉       | 69/236 [04:30<13:30,  4.85s/it]
test ppl:  30%|██▉       | 70/236 [04:31<10:45,  3.89s/it]
test ppl:  30%|███       | 71/236 [04:35<10:28,  3.81s/it]
test ppl:  31%|███       | 72/236 [04:39<10:26,  3.82s/it]
test ppl:  31%|███       | 73/236 [04:43<10:31,  3.87s/it]
test ppl:  31%|███▏      | 74/236 [04:44<08:33,  3.17s/it]
test ppl:  32%|███▏      | 75/236 [04:50<10:42,  3.99s/it]
test ppl:  32%|███▏      | 76/236 [04:54<10:17,  3.86s/it]
test ppl:  33%|███▎      | 77/236 [04:56<08:58,  3.39s/it]
test ppl:  33%|███▎      | 78/236 [04:58<07:26,  2.83s/it]
test ppl:  33%|███▎      | 79/236 [05:02<08:17,  3.17s/it]
test ppl:  34%|███▍      | 80/236 [05:04<07:43,  2.97s/it]
test ppl:  34%|███▍      | 81/236 [05:10<09:57,  3.85s/it]
test ppl:  35%|███▍      | 82/236 [05:16<11:31,  4.49s/it]
test ppl:  35%|███▌      | 83/236 [05:18<09:33,  3.75s/it]
test ppl:  36%|███▌      | 84/236 [05:20<08:06,  3.20s/it]
test ppl:  36%|███▌      | 85/236 [05:24<08:47,  3.49s/it]
test ppl:  36%|███▋      | 86/236 [05:26<07:34,  3.03s/it]
test ppl:  37%|███▋      | 87/236 [05:28<06:51,  2.76s/it]
test ppl:  37%|███▋      | 88/236 [05:34<09:11,  3.73s/it]
test ppl:  38%|███▊      | 89/236 [05:40<10:46,  4.40s/it]
test ppl:  38%|███▊      | 90/236 [05:46<11:50,  4.86s/it]
test ppl:  39%|███▊      | 91/236 [05:51<11:50,  4.90s/it]
test ppl:  39%|███▉      | 92/236 [05:54<10:16,  4.28s/it]
test ppl:  39%|███▉      | 93/236 [06:00<11:24,  4.79s/it]
test ppl:  40%|███▉      | 94/236 [06:06<12:09,  5.14s/it]
test ppl:  40%|████      | 95/236 [06:09<10:28,  4.46s/it]
test ppl:  41%|████      | 96/236 [06:12<09:21,  4.01s/it]
test ppl:  41%|████      | 97/236 [06:18<10:37,  4.59s/it]
test ppl:  42%|████▏     | 98/236 [06:24<11:29,  4.99s/it]
test ppl:  42%|████▏     | 99/236 [06:30<12:03,  5.28s/it]
test ppl:  42%|████▏     | 100/236 [06:31<09:17,  4.10s/it]
test ppl:  43%|████▎     | 101/236 [06:37<10:16,  4.57s/it]
test ppl:  43%|████▎     | 102/236 [06:41<09:54,  4.44s/it]
test ppl:  44%|████▎     | 103/236 [06:42<07:50,  3.54s/it]
test ppl:  44%|████▍     | 104/236 [06:46<08:17,  3.77s/it]
test ppl:  44%|████▍     | 105/236 [06:51<08:23,  3.85s/it]
test ppl:  45%|████▍     | 106/236 [06:56<09:23,  4.33s/it]
test ppl:  45%|████▌     | 107/236 [06:58<08:03,  3.75s/it]
test ppl:  46%|████▌     | 108/236 [07:04<09:17,  4.36s/it]
test ppl:  46%|████▌     | 109/236 [07:08<09:01,  4.26s/it]
test ppl:  47%|████▋     | 110/236 [07:10<07:25,  3.53s/it]
test ppl:  47%|████▋     | 111/236 [07:14<07:40,  3.68s/it]
test ppl:  47%|████▋     | 112/236 [07:18<07:28,  3.61s/it]
test ppl:  48%|████▊     | 113/236 [07:19<06:17,  3.07s/it]
test ppl:  48%|████▊     | 114/236 [07:24<07:16,  3.58s/it]
test ppl:  49%|████▊     | 115/236 [07:30<08:38,  4.28s/it]
test ppl:  49%|████▉     | 116/236 [07:36<09:33,  4.78s/it]
test ppl:  50%|████▉     | 117/236 [07:38<07:44,  3.90s/it]
test ppl:  50%|█████     | 118/236 [07:42<07:55,  4.03s/it]
test ppl:  50%|█████     | 119/236 [07:47<08:17,  4.26s/it]
test ppl:  51%|█████     | 120/236 [07:48<06:32,  3.38s/it]
test ppl:  51%|█████▏    | 121/236 [07:54<07:56,  4.15s/it]
test ppl:  52%|█████▏    | 122/236 [07:59<08:16,  4.36s/it]
test ppl:  52%|█████▏    | 123/236 [08:01<06:58,  3.70s/it]
test ppl:  53%|█████▎    | 124/236 [08:04<06:24,  3.43s/it]
test ppl:  53%|█████▎    | 125/236 [08:10<07:44,  4.19s/it]
test ppl:  53%|█████▎    | 126/236 [08:14<07:25,  4.05s/it]
test ppl:  54%|█████▍    | 127/236 [08:16<06:18,  3.47s/it]
test ppl:  54%|█████▍    | 128/236 [08:18<05:36,  3.12s/it]
test ppl:  55%|█████▍    | 129/236 [08:21<05:27,  3.06s/it]
test ppl:  55%|█████▌    | 130/236 [08:24<05:28,  3.10s/it]
test ppl:  56%|█████▌    | 131/236 [08:30<06:55,  3.96s/it]
test ppl:  56%|█████▌    | 132/236 [08:33<06:06,  3.52s/it]
test ppl:  56%|█████▋    | 133/236 [08:37<06:16,  3.66s/it]
test ppl:  57%|█████▋    | 134/236 [08:41<06:21,  3.74s/it]
test ppl:  57%|█████▋    | 135/236 [08:45<06:41,  3.97s/it]
test ppl:  58%|█████▊    | 136/236 [08:46<05:16,  3.16s/it]
test ppl:  58%|█████▊    | 137/236 [08:52<06:36,  4.01s/it]
test ppl:  58%|█████▊    | 138/236 [08:56<06:10,  3.78s/it]
test ppl:  59%|█████▉    | 139/236 [08:58<05:33,  3.44s/it]
test ppl:  59%|█████▉    | 140/236 [09:00<04:39,  2.92s/it]
test ppl:  60%|█████▉    | 141/236 [09:03<04:37,  2.92s/it]
test ppl:  60%|██████    | 142/236 [09:05<04:11,  2.68s/it]
test ppl:  61%|██████    | 143/236 [09:11<05:40,  3.67s/it]
test ppl:  61%|██████    | 144/236 [09:14<05:12,  3.40s/it]
test ppl:  61%|██████▏   | 145/236 [09:20<06:15,  4.12s/it]
test ppl:  62%|██████▏   | 146/236 [09:24<06:23,  4.26s/it]
test ppl:  62%|██████▏   | 147/236 [09:30<07:04,  4.77s/it]
test ppl:  63%|██████▎   | 148/236 [09:36<07:33,  5.16s/it]
test ppl:  63%|██████▎   | 149/236 [09:40<06:42,  4.63s/it]
test ppl:  64%|██████▎   | 150/236 [09:46<07:12,  5.03s/it]
test ppl:  64%|██████▍   | 151/236 [09:51<07:30,  5.31s/it]
test ppl:  64%|██████▍   | 152/236 [09:57<07:41,  5.49s/it]
test ppl:  65%|██████▍   | 153/236 [10:03<07:38,  5.52s/it]
test ppl:  65%|██████▌   | 154/236 [10:06<06:19,  4.63s/it]
test ppl:  66%|██████▌   | 155/236 [10:08<05:26,  4.03s/it]
test ppl:  66%|██████▌   | 156/236 [10:10<04:38,  3.48s/it]
test ppl:  67%|██████▋   | 157/236 [10:13<04:05,  3.11s/it]
test ppl:  67%|██████▋   | 158/236 [10:19<05:09,  3.96s/it]
test ppl:  67%|██████▋   | 159/236 [10:25<05:51,  4.56s/it]
test ppl:  68%|██████▊   | 160/236 [10:26<04:29,  3.55s/it]
test ppl:  68%|██████▊   | 161/236 [10:27<03:37,  2.90s/it]
test ppl:  69%|██████▊   | 162/236 [10:30<03:40,  2.98s/it]
test ppl:  69%|██████▉   | 163/236 [10:33<03:28,  2.86s/it]
test ppl:  69%|██████▉   | 164/236 [10:39<04:34,  3.81s/it]
test ppl:  70%|██████▉   | 165/236 [10:43<04:38,  3.92s/it]
test ppl:  70%|███████   | 166/236 [10:45<03:52,  3.32s/it]
test ppl:  71%|███████   | 167/236 [10:46<03:11,  2.77s/it]
test ppl:  71%|███████   | 168/236 [10:52<04:13,  3.72s/it]
test ppl:  72%|███████▏  | 169/236 [10:57<04:35,  4.11s/it]
test ppl:  72%|███████▏  | 170/236 [11:03<05:07,  4.67s/it]
test ppl:  72%|███████▏  | 171/236 [11:05<03:58,  3.67s/it]
test ppl:  73%|███████▎  | 172/236 [11:11<04:38,  4.35s/it]
test ppl:  73%|███████▎  | 173/236 [11:17<05:04,  4.83s/it]
test ppl:  74%|███████▎  | 174/236 [11:23<05:20,  5.17s/it]
test ppl:  74%|███████▍  | 175/236 [11:24<04:14,  4.18s/it]
test ppl:  75%|███████▍  | 176/236 [11:30<04:41,  4.70s/it]
test ppl:  75%|███████▌  | 177/236 [11:36<04:59,  5.07s/it]
test ppl:  75%|███████▌  | 178/236 [11:42<05:09,  5.34s/it]
test ppl:  76%|███████▌  | 179/236 [11:48<05:15,  5.53s/it]
test ppl:  76%|███████▋  | 180/236 [11:54<05:16,  5.65s/it]
test ppl:  77%|███████▋  | 181/236 [12:00<05:15,  5.74s/it]
test ppl:  77%|███████▋  | 182/236 [12:02<04:07,  4.59s/it]
test ppl:  78%|███████▊  | 183/236 [12:04<03:26,  3.90s/it]
test ppl:  78%|███████▊  | 184/236 [12:06<02:43,  3.14s/it]
test ppl:  78%|███████▊  | 185/236 [12:09<02:50,  3.35s/it]
test ppl:  79%|███████▉  | 186/236 [12:11<02:27,  2.94s/it]
test ppl:  79%|███████▉  | 187/236 [12:18<03:09,  3.87s/it]
test ppl:  80%|███████▉  | 188/236 [12:23<03:35,  4.49s/it]
test ppl:  80%|████████  | 189/236 [12:29<03:51,  4.93s/it]
test ppl:  81%|████████  | 190/236 [12:34<03:37,  4.73s/it]
test ppl:  81%|████████  | 191/236 [12:38<03:28,  4.63s/it]
test ppl:  81%|████████▏ | 192/236 [12:41<02:57,  4.04s/it]
test ppl:  82%|████████▏ | 193/236 [12:47<03:18,  4.62s/it]
test ppl:  82%|████████▏ | 194/236 [12:49<02:49,  4.02s/it]
test ppl:  83%|████████▎ | 195/236 [12:52<02:33,  3.74s/it]
test ppl:  83%|████████▎ | 196/236 [12:54<02:09,  3.23s/it]
test ppl:  83%|████████▎ | 197/236 [12:57<01:53,  2.90s/it]
test ppl:  84%|████████▍ | 198/236 [13:03<02:24,  3.81s/it]
test ppl:  84%|████████▍ | 199/236 [13:05<02:09,  3.49s/it]
test ppl:  85%|████████▍ | 200/236 [13:11<02:31,  4.22s/it]
test ppl:  85%|████████▌ | 201/236 [13:13<02:05,  3.57s/it]
test ppl:  86%|████████▌ | 202/236 [13:19<02:25,  4.29s/it]
test ppl:  86%|████████▌ | 203/236 [13:25<02:37,  4.79s/it]
test ppl:  86%|████████▋ | 204/236 [13:27<02:01,  3.80s/it]
test ppl:  87%|████████▋ | 205/236 [13:33<02:18,  4.45s/it]
test ppl:  87%|████████▋ | 206/236 [13:36<02:03,  4.12s/it]
test ppl:  88%|████████▊ | 207/236 [13:42<02:15,  4.66s/it]
test ppl:  88%|████████▊ | 208/236 [13:45<01:58,  4.21s/it]
test ppl:  89%|████████▊ | 209/236 [13:51<02:08,  4.76s/it]
test ppl:  89%|████████▉ | 210/236 [13:53<01:45,  4.04s/it]
test ppl:  89%|████████▉ | 211/236 [13:58<01:46,  4.28s/it]
test ppl:  90%|████████▉ | 212/236 [14:04<01:54,  4.77s/it]
test ppl:  90%|█████████ | 213/236 [14:10<01:57,  5.12s/it]
test ppl:  91%|█████████ | 214/236 [14:11<01:27,  3.99s/it]
test ppl:  91%|█████████ | 215/236 [14:18<01:36,  4.61s/it]
test ppl:  92%|█████████▏| 216/236 [14:19<01:14,  3.73s/it]
test ppl:  92%|█████████▏| 217/236 [14:25<01:24,  4.43s/it]
test ppl:  92%|█████████▏| 218/236 [14:27<01:06,  3.69s/it]
test ppl:  93%|█████████▎| 219/236 [14:33<01:14,  4.37s/it]
test ppl:  93%|█████████▎| 220/236 [14:39<01:17,  4.84s/it]
test ppl:  94%|█████████▎| 221/236 [14:41<00:58,  3.91s/it]
test ppl:  94%|█████████▍| 222/236 [14:47<01:03,  4.53s/it]
test ppl:  94%|█████████▍| 223/236 [14:53<01:04,  4.95s/it]
test ppl:  95%|█████████▍| 224/236 [14:54<00:47,  3.94s/it]
test ppl:  95%|█████████▌| 225/236 [15:00<00:49,  4.53s/it]
test ppl:  96%|█████████▌| 226/236 [15:04<00:42,  4.28s/it]
test ppl:  96%|█████████▌| 227/236 [15:07<00:34,  3.86s/it]
test ppl:  97%|█████████▋| 228/236 [15:09<00:26,  3.29s/it]
test ppl:  97%|█████████▋| 229/236 [15:15<00:28,  4.08s/it]
test ppl:  97%|█████████▋| 230/236 [15:18<00:23,  3.91s/it]
test ppl:  98%|█████████▊| 231/236 [15:22<00:19,  3.99s/it]
test ppl:  98%|█████████▊| 232/236 [15:25<00:14,  3.51s/it]
test ppl:  99%|█████████▊| 233/236 [15:27<00:09,  3.25s/it]
test ppl:  99%|█████████▉| 234/236 [15:29<00:05,  2.72s/it]
test ppl: 100%|█████████▉| 235/236 [15:36<00:04,  4.10s/it]
test ppl: 100%|██████████| 236/236 [15:37<00:00,  3.11s/it]
test ppl: 100%|██████████| 236/236 [15:37<00:00,  3.97s/it]
10/12/2024 16:26:56 - INFO - __main__ -    em: 0.2078
10/12/2024 16:26:56 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.4 50:  em: 0.2078

--------------------------------------------------------------------------------
Running experiment with knn_temp=50, lmbda=0.6, k=16
2024-10-12 16:27:03.051237: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 16:27:03.070753: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 16:27:03.092577: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 16:27:03.099245: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 16:27:03.115233: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 16:27:04.109499: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 16:27:05 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.6, knn_temp=50, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 16:27:05 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:25:51,  2.22it/s]
Adding feature api:   4%|▍         | 7443/187062 [00:00<00:10, 17905.68it/s]
Adding feature api:   8%|▊         | 15658/187062 [00:00<00:04, 34337.02it/s]
Adding feature api:  13%|█▎        | 24231/187062 [00:00<00:03, 48088.35it/s]
Adding feature api:  18%|█▊        | 32801/187062 [00:00<00:02, 58489.65it/s]
Adding feature api:  22%|██▏       | 41449/187062 [00:00<00:02, 66415.55it/s]
Adding feature api:  27%|██▋       | 50087/187062 [00:01<00:01, 72165.25it/s]
Adding feature api:  31%|███▏      | 58680/187062 [00:01<00:01, 76175.95it/s]
Adding feature api:  36%|███▌      | 67297/187062 [00:01<00:01, 79113.36it/s]
Adding feature api:  41%|████      | 75954/187062 [00:01<00:01, 81316.48it/s]
Adding feature api:  45%|████▌     | 84607/187062 [00:01<00:01, 82864.23it/s]
Adding feature api:  50%|████▉     | 93189/187062 [00:01<00:01, 83742.01it/s]
Adding feature api:  54%|█████▍    | 101789/187062 [00:01<00:01, 84415.56it/s]
Adding feature api:  59%|█████▉    | 110432/187062 [00:01<00:00, 85014.62it/s]
Adding feature api:  64%|██████▎   | 119030/187062 [00:01<00:00, 85300.39it/s]
Adding feature api:  68%|██████▊   | 127622/187062 [00:01<00:00, 84911.95it/s]
Adding feature api:  73%|███████▎  | 136193/187062 [00:02<00:00, 85149.30it/s]
Adding feature api:  77%|███████▋  | 144840/187062 [00:02<00:00, 85543.10it/s]
Adding feature api:  82%|████████▏ | 153463/187062 [00:02<00:00, 85746.76it/s]
Adding feature api:  87%|████████▋ | 162107/187062 [00:02<00:00, 85952.18it/s]
Adding feature api:  91%|█████████▏| 170713/187062 [00:02<00:00, 85922.40it/s]
Adding feature api:  96%|█████████▌| 179313/187062 [00:02<00:00, 77084.41it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 65649.46it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:39:48,  2.20it/s]
Adding feature datatype:   4%|▍         | 7226/187062 [00:00<00:10, 17253.95it/s]
Adding feature datatype:   8%|▊         | 15488/187062 [00:00<00:05, 33879.02it/s]
Adding feature datatype:  13%|█▎        | 23827/187062 [00:00<00:03, 47072.83it/s]
Adding feature datatype:  17%|█▋        | 32157/187062 [00:00<00:02, 57060.41it/s]
Adding feature datatype:  22%|██▏       | 40513/187062 [00:00<00:02, 64546.35it/s]
Adding feature datatype:  26%|██▌       | 48895/187062 [00:01<00:01, 70087.72it/s]
Adding feature datatype:  31%|███       | 57235/187062 [00:01<00:01, 73963.70it/s]
Adding feature datatype:  35%|███▌      | 65592/187062 [00:01<00:01, 76785.19it/s]
Adding feature datatype:  40%|███▉      | 73975/187062 [00:01<00:01, 78865.62it/s]
Adding feature datatype:  44%|████▍     | 82353/187062 [00:01<00:01, 80322.35it/s]
Adding feature datatype:  49%|████▊     | 90747/187062 [00:01<00:01, 81396.74it/s]
Adding feature datatype:  53%|█████▎    | 99130/187062 [00:01<00:01, 82120.21it/s]
Adding feature datatype:  57%|█████▋    | 107465/187062 [00:01<00:00, 82345.41it/s]
Adding feature datatype:  62%|██████▏   | 115825/187062 [00:01<00:00, 82717.87it/s]
Adding feature datatype:  66%|██████▋   | 124255/187062 [00:01<00:00, 83190.81it/s]
Adding feature datatype:  71%|███████   | 132636/187062 [00:02<00:00, 83374.40it/s]
Adding feature datatype:  75%|███████▌  | 141004/187062 [00:02<00:00, 83437.43it/s]
Adding feature datatype:  80%|███████▉  | 149369/187062 [00:02<00:00, 83426.53it/s]
Adding feature datatype:  84%|████████▍ | 157740/187062 [00:02<00:00, 83508.13it/s]
Adding feature datatype:  89%|████████▉ | 166130/187062 [00:02<00:00, 83622.79it/s]
Adding feature datatype:  93%|█████████▎| 174528/187062 [00:02<00:00, 83728.46it/s]
Adding feature datatype:  98%|█████████▊| 182906/187062 [00:02<00:00, 60673.57it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 64308.67it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:41:59,  2.19it/s]
Adding feature literal:   4%|▍         | 7118/187062 [00:00<00:10, 16976.05it/s]
Adding feature literal:   8%|▊         | 15330/187062 [00:00<00:05, 33530.95it/s]
Adding feature literal:  13%|█▎        | 23564/187062 [00:00<00:03, 46530.45it/s]
Adding feature literal:  17%|█▋        | 31859/187062 [00:00<00:02, 56567.13it/s]
Adding feature literal:  21%|██▏       | 40109/187062 [00:00<00:02, 63890.68it/s]
Adding feature literal:  26%|██▌       | 48430/187062 [00:01<00:01, 69443.36it/s]
Adding feature literal:  30%|███       | 56635/187062 [00:01<00:01, 73110.72it/s]
Adding feature literal:  35%|███▍      | 64969/187062 [00:01<00:01, 76114.50it/s]
Adding feature literal:  39%|███▉      | 73268/187062 [00:01<00:01, 78145.85it/s]
Adding feature literal:  44%|████▎     | 81604/187062 [00:01<00:01, 79691.06it/s]
Adding feature literal:  48%|████▊     | 89871/187062 [00:01<00:01, 80576.25it/s]
Adding feature literal:  52%|█████▏    | 98167/187062 [00:01<00:01, 81284.43it/s]
Adding feature literal:  57%|█████▋    | 106417/187062 [00:01<00:01, 78022.76it/s]
Adding feature literal:  61%|██████    | 114332/187062 [00:01<00:00, 76659.38it/s]
Adding feature literal:  65%|██████▌   | 122079/187062 [00:01<00:00, 75474.72it/s]
Adding feature literal:  69%|██████▉   | 129683/187062 [00:02<00:00, 75012.14it/s]
Adding feature literal:  73%|███████▎  | 137223/187062 [00:02<00:00, 71721.44it/s]
Adding feature literal:  77%|███████▋  | 144931/187062 [00:02<00:00, 73236.93it/s]
Adding feature literal:  82%|████████▏ | 153194/187062 [00:02<00:00, 75941.90it/s]
Adding feature literal:  86%|████████▋ | 161497/187062 [00:02<00:00, 78006.00it/s]
Adding feature literal:  91%|█████████ | 169827/187062 [00:02<00:00, 79561.51it/s]
Adding feature literal:  95%|█████████▌| 177855/187062 [00:02<00:00, 79769.61it/s]
Adding feature literal:  99%|█████████▉| 185852/187062 [00:02<00:00, 52872.87it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 61990.70it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:43:41,  2.19it/s]
Adding feature operator:   4%|▍         | 7177/187062 [00:00<00:10, 17101.26it/s]
Adding feature operator:   8%|▊         | 15423/187062 [00:00<00:05, 33698.83it/s]
Adding feature operator:  13%|█▎        | 23658/187062 [00:00<00:03, 46649.19it/s]
Adding feature operator:  17%|█▋        | 31984/187062 [00:00<00:02, 56735.29it/s]
Adding feature operator:  22%|██▏       | 40318/187062 [00:00<00:02, 64248.84it/s]
Adding feature operator:  26%|██▌       | 48640/187062 [00:01<00:01, 69701.95it/s]
Adding feature operator:  30%|███       | 57009/187062 [00:01<00:01, 73771.64it/s]
Adding feature operator:  35%|███▍      | 65371/187062 [00:01<00:01, 76663.06it/s]
Adding feature operator:  39%|███▉      | 73530/187062 [00:01<00:01, 77858.63it/s]
Adding feature operator:  44%|████▍     | 81855/187062 [00:01<00:01, 79452.44it/s]
Adding feature operator:  48%|████▊     | 90134/187062 [00:01<00:01, 80441.69it/s]
Adding feature operator:  53%|█████▎    | 98468/187062 [00:01<00:01, 81303.47it/s]
Adding feature operator:  57%|█████▋    | 106842/187062 [00:01<00:00, 82029.04it/s]
Adding feature operator:  62%|██████▏   | 115166/187062 [00:01<00:00, 82388.46it/s]
Adding feature operator:  66%|██████▌   | 123499/187062 [00:01<00:00, 82669.43it/s]
Adding feature operator:  70%|███████   | 131820/187062 [00:02<00:00, 82829.54it/s]
Adding feature operator:  75%|███████▍  | 140147/187062 [00:02<00:00, 82960.55it/s]
Adding feature operator:  79%|███████▉  | 148530/187062 [00:02<00:00, 83220.49it/s]
Adding feature operator:  84%|████████▍ | 156867/187062 [00:02<00:00, 83138.22it/s]
Adding feature operator:  88%|████████▊ | 165199/187062 [00:02<00:00, 83191.39it/s]
Adding feature operator:  93%|█████████▎| 173530/187062 [00:02<00:00, 83225.53it/s]
Adding feature operator:  97%|█████████▋| 181858/187062 [00:02<00:00, 63544.66it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63925.04it/s]
[2024-10-12 16:27:48,799] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 16:27:50 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 16:27:50 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 46/6548 [00:00<00:14, 434.53 examples/s]
Map:   1%|▏         | 97/6548 [00:00<00:30, 214.65 examples/s]
Map:   2%|▏         | 128/6548 [00:00<00:27, 236.78 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:21, 292.43 examples/s]
Map:   3%|▎         | 224/6548 [00:00<00:18, 338.19 examples/s]
Map:   4%|▍         | 280/6548 [00:00<00:18, 333.48 examples/s]
Map:   5%|▌         | 332/6548 [00:01<00:20, 298.86 examples/s]
Map:   6%|▌         | 387/6548 [00:01<00:19, 313.76 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:18, 338.59 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 325.20 examples/s]
Map:   8%|▊         | 535/6548 [00:01<00:17, 346.98 examples/s]
Map:   9%|▉         | 577/6548 [00:01<00:17, 350.53 examples/s]
Map:   9%|▉         | 618/6548 [00:01<00:16, 357.25 examples/s]
Map:  10%|█         | 666/6548 [00:02<00:17, 329.38 examples/s]
Map:  11%|█         | 710/6548 [00:02<00:16, 351.79 examples/s]
Map:  12%|█▏        | 757/6548 [00:02<00:15, 376.37 examples/s]
Map:  12%|█▏        | 813/6548 [00:02<00:13, 411.87 examples/s]
Map:  13%|█▎        | 876/6548 [00:02<00:14, 402.23 examples/s]
Map:  14%|█▍        | 930/6548 [00:02<00:14, 381.18 examples/s]
Map:  15%|█▍        | 970/6548 [00:02<00:14, 374.01 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:23, 234.85 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 259.53 examples/s]
Map:  17%|█▋        | 1098/6548 [00:03<00:18, 291.31 examples/s]
Map:  17%|█▋        | 1145/6548 [00:03<00:16, 328.16 examples/s]
Map:  18%|█▊        | 1204/6548 [00:03<00:15, 347.15 examples/s]
Map:  19%|█▉        | 1262/6548 [00:03<00:14, 353.33 examples/s]
Map:  20%|█▉        | 1301/6548 [00:03<00:14, 358.69 examples/s]
Map:  21%|██        | 1352/6548 [00:04<00:16, 313.50 examples/s]
Map:  21%|██▏       | 1392/6548 [00:04<00:17, 288.37 examples/s]
Map:  22%|██▏       | 1431/6548 [00:04<00:16, 305.70 examples/s]
Map:  22%|██▏       | 1466/6548 [00:04<00:18, 271.20 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:18, 271.43 examples/s]
Map:  24%|██▎       | 1542/6548 [00:04<00:18, 272.93 examples/s]
Map:  24%|██▍       | 1577/6548 [00:04<00:17, 286.98 examples/s]
Map:  25%|██▍       | 1614/6548 [00:05<00:18, 268.17 examples/s]
Map:  25%|██▌       | 1646/6548 [00:05<00:17, 278.03 examples/s]
Map:  26%|██▌       | 1689/6548 [00:05<00:17, 272.64 examples/s]
Map:  26%|██▋       | 1728/6548 [00:05<00:16, 297.81 examples/s]
Map:  27%|██▋       | 1775/6548 [00:05<00:14, 338.88 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:13, 340.69 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 352.44 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 348.16 examples/s]
Map:  30%|██▉       | 1963/6548 [00:06<00:12, 354.40 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:19, 235.32 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:18, 244.89 examples/s]
Map:  32%|███▏      | 2066/6548 [00:06<00:16, 263.76 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:15, 278.60 examples/s]
Map:  33%|███▎      | 2137/6548 [00:06<00:15, 286.69 examples/s]
Map:  33%|███▎      | 2180/6548 [00:07<00:16, 270.90 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 276.40 examples/s]
Map:  34%|███▍      | 2255/6548 [00:07<00:16, 267.91 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:15, 272.02 examples/s]
Map:  36%|███▌      | 2331/6548 [00:07<00:13, 310.12 examples/s]
Map:  36%|███▋      | 2381/6548 [00:07<00:13, 315.36 examples/s]
Map:  37%|███▋      | 2420/6548 [00:07<00:12, 332.51 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:12, 319.49 examples/s]
Map:  38%|███▊      | 2496/6548 [00:08<00:12, 323.32 examples/s]
Map:  39%|███▊      | 2537/6548 [00:08<00:11, 341.63 examples/s]
Map:  40%|███▉      | 2592/6548 [00:08<00:10, 390.50 examples/s]
Map:  40%|████      | 2632/6548 [00:08<00:10, 390.55 examples/s]
Map:  41%|████      | 2682/6548 [00:08<00:10, 359.53 examples/s]
Map:  42%|████▏     | 2741/6548 [00:08<00:10, 366.25 examples/s]
Map:  42%|████▏     | 2779/6548 [00:08<00:10, 365.80 examples/s]
Map:  43%|████▎     | 2823/6548 [00:08<00:11, 336.42 examples/s]
Map:  44%|████▎     | 2862/6548 [00:09<00:12, 288.64 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 295.53 examples/s]
Map:  45%|████▌     | 2951/6548 [00:09<00:11, 308.14 examples/s]
Map:  46%|████▌     | 2991/6548 [00:09<00:13, 257.46 examples/s]
Map:  46%|████▌     | 3026/6548 [00:10<00:20, 173.94 examples/s]
Map:  47%|████▋     | 3058/6548 [00:10<00:17, 194.49 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 206.89 examples/s]
Map:  48%|████▊     | 3132/6548 [00:10<00:14, 243.59 examples/s]
Map:  48%|████▊     | 3169/6548 [00:10<00:14, 241.26 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:14, 233.18 examples/s]
Map:  49%|████▉     | 3231/6548 [00:10<00:13, 241.53 examples/s]
Map:  50%|████▉     | 3269/6548 [00:10<00:12, 267.55 examples/s]
Map:  50%|█████     | 3299/6548 [00:11<00:11, 274.85 examples/s]
Map:  51%|█████     | 3342/6548 [00:11<00:10, 309.95 examples/s]
Map:  52%|█████▏    | 3379/6548 [00:11<00:10, 316.50 examples/s]
Map:  52%|█████▏    | 3425/6548 [00:11<00:10, 289.72 examples/s]
Map:  53%|█████▎    | 3459/6548 [00:11<00:12, 249.12 examples/s]
Map:  53%|█████▎    | 3489/6548 [00:11<00:11, 258.91 examples/s]
Map:  54%|█████▍    | 3538/6548 [00:11<00:09, 313.77 examples/s]
Map:  55%|█████▍    | 3582/6548 [00:11<00:08, 344.78 examples/s]
Map:  55%|█████▌    | 3622/6548 [00:12<00:08, 355.06 examples/s]
Map:  56%|█████▌    | 3660/6548 [00:12<00:08, 355.40 examples/s]
Map:  57%|█████▋    | 3706/6548 [00:12<00:07, 383.02 examples/s]
Map:  57%|█████▋    | 3747/6548 [00:12<00:07, 386.41 examples/s]
Map:  58%|█████▊    | 3788/6548 [00:12<00:07, 386.58 examples/s]
Map:  59%|█████▊    | 3839/6548 [00:12<00:07, 352.56 examples/s]
Map:  59%|█████▉    | 3891/6548 [00:12<00:07, 347.03 examples/s]
Map:  60%|██████    | 3930/6548 [00:12<00:07, 337.69 examples/s]
Map:  61%|██████    | 3983/6548 [00:13<00:07, 341.27 examples/s]
Map:  62%|██████▏   | 4029/6548 [00:13<00:10, 248.90 examples/s]
Map:  62%|██████▏   | 4079/6548 [00:13<00:08, 294.65 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 317.97 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:07, 297.58 examples/s]
Map:  64%|██████▍   | 4206/6548 [00:13<00:07, 312.22 examples/s]
Map:  65%|██████▌   | 4267/6548 [00:13<00:06, 339.57 examples/s]
Map:  66%|██████▌   | 4309/6548 [00:14<00:06, 351.15 examples/s]
Map:  66%|██████▋   | 4346/6548 [00:14<00:06, 347.31 examples/s]
Map:  67%|██████▋   | 4398/6548 [00:14<00:06, 345.69 examples/s]
Map:  68%|██████▊   | 4440/6548 [00:14<00:05, 362.02 examples/s]
Map:  68%|██████▊   | 4483/6548 [00:14<00:06, 328.21 examples/s]
Map:  69%|██████▉   | 4530/6548 [00:14<00:06, 312.26 examples/s]
Map:  70%|██████▉   | 4571/6548 [00:14<00:05, 333.06 examples/s]
Map:  71%|███████   | 4626/6548 [00:15<00:05, 334.67 examples/s]
Map:  71%|███████▏  | 4670/6548 [00:15<00:05, 352.73 examples/s]
Map:  72%|███████▏  | 4712/6548 [00:15<00:05, 364.81 examples/s]
Map:  73%|███████▎  | 4751/6548 [00:15<00:04, 368.20 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 420.96 examples/s]
Map:  74%|███████▍  | 4853/6548 [00:15<00:04, 362.04 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 378.11 examples/s]
Map:  76%|███████▌  | 4955/6548 [00:15<00:03, 406.29 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:16<00:06, 244.33 examples/s]
Map:  77%|███████▋  | 5041/6548 [00:16<00:05, 266.56 examples/s]
Map:  78%|███████▊  | 5076/6548 [00:16<00:05, 279.27 examples/s]
Map:  78%|███████▊  | 5119/6548 [00:16<00:05, 276.56 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 286.19 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 286.76 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:16<00:04, 300.03 examples/s]
Map:  80%|████████  | 5256/6548 [00:17<00:04, 302.66 examples/s]
Map:  81%|████████  | 5305/6548 [00:17<00:03, 350.33 examples/s]
Map:  82%|████████▏ | 5346/6548 [00:17<00:03, 308.25 examples/s]
Map:  82%|████████▏ | 5388/6548 [00:17<00:03, 332.58 examples/s]
Map:  83%|████████▎ | 5429/6548 [00:17<00:03, 306.20 examples/s]
Map:  84%|████████▎ | 5473/6548 [00:17<00:03, 333.46 examples/s]
Map:  84%|████████▍ | 5509/6548 [00:17<00:03, 334.70 examples/s]
Map:  85%|████████▍ | 5554/6548 [00:17<00:02, 359.80 examples/s]
Map:  85%|████████▌ | 5595/6548 [00:18<00:02, 323.19 examples/s]
Map:  86%|████████▌ | 5642/6548 [00:18<00:02, 358.92 examples/s]
Map:  87%|████████▋ | 5682/6548 [00:18<00:02, 324.50 examples/s]
Map:  87%|████████▋ | 5722/6548 [00:18<00:02, 335.66 examples/s]
Map:  88%|████████▊ | 5765/6548 [00:18<00:02, 357.54 examples/s]
Map:  89%|████████▊ | 5802/6548 [00:18<00:02, 359.60 examples/s]
Map:  89%|████████▉ | 5844/6548 [00:18<00:02, 351.25 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:18<00:01, 352.46 examples/s]
Map:  90%|█████████ | 5922/6548 [00:18<00:01, 360.19 examples/s]
Map:  91%|█████████ | 5964/6548 [00:19<00:01, 325.45 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 203.08 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:02, 237.76 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 271.93 examples/s]
Map:  94%|█████████▎| 6124/6548 [00:19<00:01, 270.01 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:19<00:01, 288.54 examples/s]
Map:  95%|█████████▍| 6204/6548 [00:20<00:01, 305.78 examples/s]
Map:  95%|█████████▌| 6247/6548 [00:20<00:00, 334.45 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 336.92 examples/s]
Map:  97%|█████████▋| 6367/6548 [00:20<00:00, 353.38 examples/s]
Map:  98%|█████████▊| 6421/6548 [00:20<00:00, 352.33 examples/s]
Map:  99%|█████████▉| 6471/6548 [00:20<00:00, 382.28 examples/s]
Map: 100%|█████████▉| 6529/6548 [00:20<00:00, 367.22 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 310.60 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▎         | 32/903 [00:00<00:03, 287.27 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 330.34 examples/s]
Map:  13%|█▎        | 119/903 [00:00<00:02, 325.29 examples/s]
Map:  18%|█▊        | 163/903 [00:00<00:02, 362.12 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 386.83 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 393.11 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 384.94 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 337.72 examples/s]
Map:  44%|████▎     | 393/903 [00:01<00:01, 296.54 examples/s]
Map:  48%|████▊     | 434/903 [00:01<00:01, 321.31 examples/s]
Map:  53%|█████▎    | 478/903 [00:01<00:01, 309.80 examples/s]
Map:  57%|█████▋    | 516/903 [00:01<00:01, 322.02 examples/s]
Map:  62%|██████▏   | 561/903 [00:01<00:00, 347.73 examples/s]
Map:  68%|██████▊   | 613/903 [00:01<00:00, 374.60 examples/s]
Map:  74%|███████▎  | 665/903 [00:01<00:00, 356.75 examples/s]
Map:  78%|███████▊  | 708/903 [00:02<00:00, 367.75 examples/s]
Map:  85%|████████▍ | 765/903 [00:02<00:00, 417.23 examples/s]
Map:  91%|█████████ | 822/903 [00:02<00:00, 396.49 examples/s]
Map:  98%|█████████▊| 884/903 [00:02<00:00, 393.56 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 326.67 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 303.35 examples/s]
Map:   4%|▍         | 81/1882 [00:00<00:04, 361.44 examples/s]
Map:   7%|▋         | 127/1882 [00:00<00:05, 323.34 examples/s]
Map:   9%|▉         | 172/1882 [00:00<00:04, 362.64 examples/s]
Map:  12%|█▏        | 231/1882 [00:00<00:04, 367.67 examples/s]
Map:  15%|█▍        | 273/1882 [00:00<00:04, 381.66 examples/s]
Map:  18%|█▊        | 333/1882 [00:00<00:04, 380.08 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:04, 330.06 examples/s]
Map:  22%|██▏       | 411/1882 [00:01<00:04, 296.12 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 301.24 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 336.21 examples/s]
Map:  28%|██▊       | 533/1882 [00:01<00:04, 309.33 examples/s]
Map:  31%|███       | 576/1882 [00:01<00:03, 332.65 examples/s]
Map:  34%|███▎      | 635/1882 [00:01<00:03, 394.47 examples/s]
Map:  36%|███▌      | 677/1882 [00:01<00:03, 390.93 examples/s]
Map:  39%|███▉      | 732/1882 [00:02<00:03, 372.03 examples/s]
Map:  41%|████      | 773/1882 [00:02<00:03, 358.59 examples/s]
Map:  44%|████▍     | 831/1882 [00:02<00:02, 365.59 examples/s]
Map:  46%|████▌     | 869/1882 [00:02<00:02, 366.25 examples/s]
Map:  48%|████▊     | 908/1882 [00:02<00:02, 370.47 examples/s]
Map:  51%|█████     | 961/1882 [00:02<00:02, 409.20 examples/s]
Map:  54%|█████▍    | 1016/1882 [00:03<00:03, 253.81 examples/s]
Map:  56%|█████▌    | 1053/1882 [00:03<00:03, 273.24 examples/s]
Map:  58%|█████▊    | 1091/1882 [00:03<00:02, 288.89 examples/s]
Map:  60%|██████    | 1134/1882 [00:03<00:02, 287.47 examples/s]
Map:  62%|██████▏   | 1172/1882 [00:03<00:02, 303.54 examples/s]
Map:  64%|██████▍   | 1212/1882 [00:03<00:02, 281.22 examples/s]
Map:  66%|██████▋   | 1247/1882 [00:03<00:02, 295.48 examples/s]
Map:  68%|██████▊   | 1285/1882 [00:03<00:01, 314.01 examples/s]
Map:  71%|███████   | 1334/1882 [00:04<00:01, 353.42 examples/s]
Map:  73%|███████▎  | 1381/1882 [00:04<00:01, 332.91 examples/s]
Map:  76%|███████▌  | 1424/1882 [00:04<00:01, 307.32 examples/s]
Map:  78%|███████▊  | 1473/1882 [00:04<00:01, 304.36 examples/s]
Map:  80%|████████  | 1507/1882 [00:04<00:01, 270.03 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 284.74 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:04<00:00, 309.76 examples/s]
Map:  86%|████████▋ | 1626/1882 [00:04<00:00, 338.34 examples/s]
Map:  88%|████████▊ | 1662/1882 [00:05<00:00, 335.22 examples/s]
Map:  91%|█████████ | 1713/1882 [00:05<00:00, 328.23 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 280.32 examples/s]
Map:  96%|█████████▌| 1799/1882 [00:05<00:00, 285.66 examples/s]
Map:  98%|█████████▊| 1844/1882 [00:05<00:00, 318.70 examples/s]
Map: 100%|██████████| 1882/1882 [00:05<00:00, 229.70 examples/s]
Map: 100%|██████████| 1882/1882 [00:05<00:00, 313.87 examples/s]
10/12/2024 16:28:51 - INFO - __main__ -     ***** Testing *****
10/12/2024 16:28:51 - INFO - __main__ -     Batch size = 8
10/12/2024 16:28:51 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 16:28:52 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 16:28:52 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 16:28:53 - INFO - knnlm -   Reading datastore took 0.9433650970458984 s
10/12/2024 16:28:54 - INFO - knnlm -   Moving index to GPU took 0.917717695236206 s
10/12/2024 16:28:54 - INFO - __main__ -   ******************************break-into
10/12/2024 16:28:54 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 16:28:54 - INFO - __main__ -     Num examples = 236
10/12/2024 16:28:54 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:55,  7.64s/it]
test ppl:   1%|          | 2/236 [00:09<16:19,  4.19s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:34,  2.98s/it]
test ppl:   2%|▏         | 4/236 [00:12<09:30,  2.46s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:04,  3.66s/it]
test ppl:   3%|▎         | 6/236 [00:24<16:49,  4.39s/it]
test ppl:   3%|▎         | 7/236 [00:26<14:24,  3.78s/it]
test ppl:   3%|▎         | 8/236 [00:30<14:31,  3.82s/it]
test ppl:   4%|▍         | 9/236 [00:34<14:30,  3.83s/it]
test ppl:   4%|▍         | 10/236 [00:37<14:00,  3.72s/it]
test ppl:   5%|▍         | 11/236 [00:41<14:13,  3.79s/it]
test ppl:   5%|▌         | 12/236 [00:47<16:25,  4.40s/it]
test ppl:   6%|▌         | 13/236 [00:53<17:55,  4.82s/it]
test ppl:   6%|▌         | 14/236 [00:59<18:56,  5.12s/it]
test ppl:   6%|▋         | 15/236 [01:00<14:34,  3.96s/it]
test ppl:   7%|▋         | 16/236 [01:02<12:09,  3.32s/it]
test ppl:   7%|▋         | 17/236 [01:08<14:48,  4.06s/it]
test ppl:   8%|▊         | 18/236 [01:09<12:07,  3.34s/it]
test ppl:   8%|▊         | 19/236 [01:15<14:41,  4.06s/it]
test ppl:   8%|▊         | 20/236 [01:18<12:58,  3.61s/it]
test ppl:   9%|▉         | 21/236 [01:20<11:38,  3.25s/it]
test ppl:   9%|▉         | 22/236 [01:26<14:18,  4.01s/it]
test ppl:  10%|▉         | 23/236 [01:29<13:42,  3.86s/it]
test ppl:  10%|█         | 24/236 [01:32<11:51,  3.36s/it]
test ppl:  11%|█         | 25/236 [01:33<10:04,  2.87s/it]
test ppl:  11%|█         | 26/236 [01:38<12:07,  3.46s/it]
test ppl:  11%|█▏        | 27/236 [01:42<12:02,  3.46s/it]
test ppl:  12%|█▏        | 28/236 [01:43<09:52,  2.85s/it]
test ppl:  12%|█▏        | 29/236 [01:45<09:14,  2.68s/it]
test ppl:  13%|█▎        | 30/236 [01:47<08:00,  2.33s/it]
test ppl:  13%|█▎        | 31/236 [01:49<07:36,  2.23s/it]
test ppl:  14%|█▎        | 32/236 [01:51<07:56,  2.34s/it]
test ppl:  14%|█▍        | 33/236 [01:54<08:00,  2.37s/it]
test ppl:  14%|█▍        | 34/236 [01:58<09:43,  2.89s/it]
test ppl:  15%|█▍        | 35/236 [02:00<09:16,  2.77s/it]
test ppl:  15%|█▌        | 36/236 [02:06<12:14,  3.67s/it]
test ppl:  16%|█▌        | 37/236 [02:12<14:20,  4.32s/it]
test ppl:  16%|█▌        | 38/236 [02:14<11:59,  3.64s/it]
test ppl:  17%|█▋        | 39/236 [02:16<10:01,  3.05s/it]
test ppl:  17%|█▋        | 40/236 [02:17<08:15,  2.53s/it]
test ppl:  17%|█▋        | 41/236 [02:19<07:33,  2.33s/it]
test ppl:  18%|█▊        | 42/236 [02:25<10:55,  3.38s/it]
test ppl:  18%|█▊        | 43/236 [02:31<13:12,  4.11s/it]
test ppl:  19%|█▊        | 44/236 [02:32<11:03,  3.45s/it]
test ppl:  19%|█▉        | 45/236 [02:34<09:25,  2.96s/it]
test ppl:  19%|█▉        | 46/236 [02:40<12:05,  3.82s/it]
test ppl:  20%|█▉        | 47/236 [02:42<09:50,  3.12s/it]
test ppl:  20%|██        | 48/236 [02:47<12:16,  3.92s/it]
test ppl:  21%|██        | 49/236 [02:50<11:07,  3.57s/it]
test ppl:  21%|██        | 50/236 [02:56<13:10,  4.25s/it]
test ppl:  22%|██▏       | 51/236 [03:02<14:32,  4.72s/it]
test ppl:  22%|██▏       | 52/236 [03:08<15:26,  5.04s/it]
test ppl:  22%|██▏       | 53/236 [03:11<13:29,  4.42s/it]
test ppl:  23%|██▎       | 54/236 [03:12<10:46,  3.55s/it]
test ppl:  23%|██▎       | 55/236 [03:18<12:37,  4.18s/it]
test ppl:  24%|██▎       | 56/236 [03:24<14:01,  4.68s/it]
test ppl:  24%|██▍       | 57/236 [03:29<14:56,  5.01s/it]
test ppl:  25%|██▍       | 58/236 [03:32<12:25,  4.19s/it]
test ppl:  25%|██▌       | 59/236 [03:37<13:47,  4.68s/it]
test ppl:  25%|██▌       | 60/236 [03:41<12:26,  4.24s/it]
test ppl:  26%|██▌       | 61/236 [03:46<13:44,  4.71s/it]
test ppl:  26%|██▋       | 62/236 [03:50<13:02,  4.50s/it]
test ppl:  27%|██▋       | 63/236 [03:53<11:11,  3.88s/it]
test ppl:  27%|██▋       | 64/236 [03:54<09:06,  3.18s/it]
test ppl:  28%|██▊       | 65/236 [03:56<07:27,  2.62s/it]
test ppl:  28%|██▊       | 66/236 [03:59<07:42,  2.72s/it]
test ppl:  28%|██▊       | 67/236 [04:05<10:16,  3.65s/it]
test ppl:  29%|██▉       | 68/236 [04:10<11:32,  4.12s/it]
test ppl:  29%|██▉       | 69/236 [04:15<12:27,  4.48s/it]
test ppl:  30%|██▉       | 70/236 [04:16<09:44,  3.52s/it]
test ppl:  30%|███       | 71/236 [04:20<09:52,  3.59s/it]
test ppl:  31%|███       | 72/236 [04:22<08:34,  3.14s/it]
test ppl:  31%|███       | 73/236 [04:28<10:40,  3.93s/it]
test ppl:  31%|███▏      | 74/236 [04:29<08:38,  3.20s/it]
test ppl:  32%|███▏      | 75/236 [04:35<10:40,  3.98s/it]
test ppl:  32%|███▏      | 76/236 [04:41<12:02,  4.52s/it]
test ppl:  33%|███▎      | 77/236 [04:43<10:09,  3.84s/it]
test ppl:  33%|███▎      | 78/236 [04:45<08:26,  3.20s/it]
test ppl:  33%|███▎      | 79/236 [04:49<08:49,  3.37s/it]
test ppl:  34%|███▍      | 80/236 [04:51<07:51,  3.02s/it]
test ppl:  34%|███▍      | 81/236 [04:57<09:57,  3.86s/it]
test ppl:  35%|███▍      | 82/236 [05:03<11:24,  4.45s/it]
test ppl:  35%|███▌      | 83/236 [05:05<09:50,  3.86s/it]
test ppl:  36%|███▌      | 84/236 [05:07<08:38,  3.41s/it]
test ppl:  36%|███▌      | 85/236 [05:12<09:06,  3.62s/it]
test ppl:  36%|███▋      | 86/236 [05:13<07:25,  2.97s/it]
test ppl:  37%|███▋      | 87/236 [05:16<07:07,  2.87s/it]
test ppl:  37%|███▋      | 88/236 [05:21<09:14,  3.74s/it]
test ppl:  38%|███▊      | 89/236 [05:23<07:52,  3.21s/it]
test ppl:  38%|███▊      | 90/236 [05:29<09:42,  3.99s/it]
test ppl:  39%|███▊      | 91/236 [05:34<10:20,  4.28s/it]
test ppl:  39%|███▉      | 92/236 [05:37<09:10,  3.83s/it]
test ppl:  39%|███▉      | 93/236 [05:43<10:31,  4.42s/it]
test ppl:  40%|███▉      | 94/236 [05:49<11:26,  4.83s/it]
test ppl:  40%|████      | 95/236 [05:51<09:38,  4.11s/it]
test ppl:  41%|████      | 96/236 [05:55<09:18,  3.99s/it]
test ppl:  41%|████      | 97/236 [06:00<10:30,  4.54s/it]
test ppl:  42%|████▏     | 98/236 [06:06<11:19,  4.92s/it]
test ppl:  42%|████▏     | 99/236 [06:12<11:50,  5.19s/it]
test ppl:  42%|████▏     | 100/236 [06:13<09:04,  4.00s/it]
test ppl:  43%|████▎     | 101/236 [06:19<10:13,  4.54s/it]
test ppl:  43%|████▎     | 102/236 [06:23<09:42,  4.34s/it]
test ppl:  44%|████▎     | 103/236 [06:24<07:41,  3.47s/it]
test ppl:  44%|████▍     | 104/236 [06:28<07:30,  3.41s/it]
test ppl:  44%|████▍     | 105/236 [06:32<07:46,  3.56s/it]
test ppl:  45%|████▍     | 106/236 [06:37<08:51,  4.09s/it]
test ppl:  45%|████▌     | 107/236 [06:39<07:32,  3.51s/it]
test ppl:  46%|████▌     | 108/236 [06:44<08:15,  3.87s/it]
test ppl:  46%|████▌     | 109/236 [06:50<09:28,  4.48s/it]
test ppl:  47%|████▋     | 110/236 [06:51<07:35,  3.61s/it]
test ppl:  47%|████▋     | 111/236 [06:57<08:52,  4.26s/it]
test ppl:  47%|████▋     | 112/236 [07:03<09:45,  4.72s/it]
test ppl:  48%|████▊     | 113/236 [07:05<07:50,  3.83s/it]
test ppl:  48%|████▊     | 114/236 [07:09<08:05,  3.98s/it]
test ppl:  49%|████▊     | 115/236 [07:15<09:06,  4.52s/it]
test ppl:  49%|████▉     | 116/236 [07:21<09:48,  4.90s/it]
test ppl:  50%|████▉     | 117/236 [07:22<07:53,  3.98s/it]
test ppl:  50%|█████     | 118/236 [07:27<08:30,  4.32s/it]
test ppl:  50%|█████     | 119/236 [07:30<07:05,  3.63s/it]
test ppl:  51%|█████     | 120/236 [07:31<05:44,  2.97s/it]
test ppl:  51%|█████▏    | 121/236 [07:34<05:30,  2.88s/it]
test ppl:  52%|█████▏    | 122/236 [07:39<07:08,  3.76s/it]
test ppl:  52%|█████▏    | 123/236 [07:42<06:08,  3.26s/it]
test ppl:  53%|█████▎    | 124/236 [07:47<07:32,  4.04s/it]
test ppl:  53%|█████▎    | 125/236 [07:53<08:26,  4.56s/it]
test ppl:  53%|█████▎    | 126/236 [07:58<08:29,  4.63s/it]
test ppl:  54%|█████▍    | 127/236 [08:00<07:01,  3.86s/it]
test ppl:  54%|█████▍    | 128/236 [08:02<05:52,  3.26s/it]
test ppl:  55%|█████▍    | 129/236 [08:05<05:44,  3.22s/it]
test ppl:  55%|█████▌    | 130/236 [08:08<05:36,  3.17s/it]
test ppl:  56%|█████▌    | 131/236 [08:14<06:56,  3.96s/it]
test ppl:  56%|█████▌    | 132/236 [08:16<06:05,  3.51s/it]
test ppl:  56%|█████▋    | 133/236 [08:20<06:14,  3.64s/it]
test ppl:  57%|█████▋    | 134/236 [08:24<06:02,  3.56s/it]
test ppl:  57%|█████▋    | 135/236 [08:29<07:07,  4.23s/it]
test ppl:  58%|█████▊    | 136/236 [08:31<05:35,  3.36s/it]
test ppl:  58%|█████▊    | 137/236 [08:37<06:45,  4.10s/it]
test ppl:  58%|█████▊    | 138/236 [08:42<07:32,  4.61s/it]
test ppl:  59%|█████▉    | 139/236 [08:44<06:04,  3.76s/it]
test ppl:  59%|█████▉    | 140/236 [08:46<05:00,  3.13s/it]
test ppl:  60%|█████▉    | 141/236 [08:50<05:16,  3.33s/it]
test ppl:  60%|██████    | 142/236 [08:52<04:38,  2.97s/it]
test ppl:  61%|██████    | 143/236 [08:58<05:55,  3.82s/it]
test ppl:  61%|██████    | 144/236 [09:01<05:35,  3.64s/it]
test ppl:  61%|██████▏   | 145/236 [09:07<06:29,  4.28s/it]
test ppl:  62%|██████▏   | 146/236 [09:11<06:31,  4.36s/it]
test ppl:  62%|██████▏   | 147/236 [09:17<07:06,  4.79s/it]
test ppl:  63%|██████▎   | 148/236 [09:23<07:31,  5.13s/it]
test ppl:  63%|██████▎   | 149/236 [09:29<07:44,  5.33s/it]
test ppl:  64%|██████▎   | 150/236 [09:34<07:50,  5.47s/it]
test ppl:  64%|██████▍   | 151/236 [09:40<07:53,  5.57s/it]
test ppl:  64%|██████▍   | 152/236 [09:46<07:52,  5.63s/it]
test ppl:  65%|██████▍   | 153/236 [09:52<07:52,  5.69s/it]
test ppl:  65%|██████▌   | 154/236 [09:54<06:29,  4.75s/it]
test ppl:  66%|██████▌   | 155/236 [09:59<06:11,  4.58s/it]
test ppl:  66%|██████▌   | 156/236 [10:01<05:18,  3.98s/it]
test ppl:  67%|██████▋   | 157/236 [10:03<04:31,  3.44s/it]
test ppl:  67%|██████▋   | 158/236 [10:09<05:23,  4.15s/it]
test ppl:  67%|██████▋   | 159/236 [10:11<04:18,  3.36s/it]
test ppl:  68%|██████▊   | 160/236 [10:12<03:25,  2.70s/it]
test ppl:  68%|██████▊   | 161/236 [10:13<02:47,  2.24s/it]
test ppl:  69%|██████▊   | 162/236 [10:16<03:04,  2.49s/it]
test ppl:  69%|██████▉   | 163/236 [10:18<02:58,  2.45s/it]
test ppl:  69%|██████▉   | 164/236 [10:21<03:09,  2.64s/it]
test ppl:  70%|██████▉   | 165/236 [10:24<03:14,  2.74s/it]
test ppl:  70%|███████   | 166/236 [10:26<02:49,  2.42s/it]
test ppl:  71%|███████   | 167/236 [10:28<02:35,  2.25s/it]
test ppl:  71%|███████   | 168/236 [10:30<02:19,  2.05s/it]
test ppl:  72%|███████▏  | 169/236 [10:32<02:31,  2.26s/it]
test ppl:  72%|███████▏  | 170/236 [10:38<03:39,  3.33s/it]
test ppl:  72%|███████▏  | 171/236 [10:40<03:00,  2.77s/it]
test ppl:  73%|███████▎  | 172/236 [10:45<03:55,  3.68s/it]
test ppl:  73%|███████▎  | 173/236 [10:49<03:43,  3.54s/it]
test ppl:  74%|███████▎  | 174/236 [10:54<04:22,  4.24s/it]
test ppl:  74%|███████▍  | 175/236 [10:56<03:35,  3.53s/it]
test ppl:  75%|███████▍  | 176/236 [11:02<04:12,  4.21s/it]
test ppl:  75%|███████▌  | 177/236 [11:08<04:36,  4.69s/it]
test ppl:  75%|███████▌  | 178/236 [11:14<04:52,  5.04s/it]
test ppl:  76%|███████▌  | 179/236 [11:20<05:00,  5.27s/it]
test ppl:  76%|███████▋  | 180/236 [11:24<04:43,  5.06s/it]
test ppl:  77%|███████▋  | 181/236 [11:30<04:50,  5.28s/it]
test ppl:  77%|███████▋  | 182/236 [11:32<03:50,  4.26s/it]
test ppl:  78%|███████▊  | 183/236 [11:33<03:03,  3.46s/it]
test ppl:  78%|███████▊  | 184/236 [11:35<02:31,  2.91s/it]
test ppl:  78%|███████▊  | 185/236 [11:41<03:13,  3.79s/it]
test ppl:  79%|███████▉  | 186/236 [11:43<02:42,  3.25s/it]
test ppl:  79%|███████▉  | 187/236 [11:45<02:15,  2.76s/it]
test ppl:  80%|███████▉  | 188/236 [11:50<02:56,  3.67s/it]
test ppl:  80%|████████  | 189/236 [11:56<03:22,  4.31s/it]
test ppl:  81%|████████  | 190/236 [12:00<03:16,  4.28s/it]
test ppl:  81%|████████  | 191/236 [12:04<03:05,  4.12s/it]
test ppl:  81%|████████▏ | 192/236 [12:07<02:41,  3.66s/it]
test ppl:  82%|████████▏ | 193/236 [12:09<02:14,  3.13s/it]
test ppl:  82%|████████▏ | 194/236 [12:11<02:04,  2.96s/it]
test ppl:  83%|████████▎ | 195/236 [12:14<01:55,  2.83s/it]
test ppl:  83%|████████▎ | 196/236 [12:16<01:43,  2.59s/it]
test ppl:  83%|████████▎ | 197/236 [12:18<01:35,  2.45s/it]
test ppl:  84%|████████▍ | 198/236 [12:24<02:11,  3.45s/it]
test ppl:  84%|████████▍ | 199/236 [12:26<02:00,  3.25s/it]
test ppl:  85%|████████▍ | 200/236 [12:32<02:24,  4.01s/it]
test ppl:  85%|████████▌ | 201/236 [12:35<02:05,  3.58s/it]
test ppl:  86%|████████▌ | 202/236 [12:41<02:25,  4.27s/it]
test ppl:  86%|████████▌ | 203/236 [12:47<02:37,  4.78s/it]
test ppl:  86%|████████▋ | 204/236 [12:49<02:07,  3.98s/it]
test ppl:  87%|████████▋ | 205/236 [12:55<02:21,  4.57s/it]
test ppl:  87%|████████▋ | 206/236 [12:58<02:06,  4.20s/it]
test ppl:  88%|████████▊ | 207/236 [13:04<02:17,  4.73s/it]
test ppl:  88%|████████▊ | 208/236 [13:07<01:55,  4.14s/it]
test ppl:  89%|████████▊ | 209/236 [13:13<02:06,  4.70s/it]
test ppl:  89%|████████▉ | 210/236 [13:15<01:43,  4.00s/it]
test ppl:  89%|████████▉ | 211/236 [13:20<01:47,  4.31s/it]
test ppl:  90%|████████▉ | 212/236 [13:25<01:48,  4.52s/it]
test ppl:  90%|█████████ | 213/236 [13:31<01:53,  4.93s/it]
test ppl:  91%|█████████ | 214/236 [13:33<01:26,  3.94s/it]
test ppl:  91%|█████████ | 215/236 [13:39<01:35,  4.54s/it]
test ppl:  92%|█████████▏| 216/236 [13:41<01:18,  3.92s/it]
test ppl:  92%|█████████▏| 217/236 [13:47<01:25,  4.51s/it]
test ppl:  92%|█████████▏| 218/236 [13:50<01:11,  3.97s/it]
test ppl:  93%|█████████▎| 219/236 [13:55<01:16,  4.53s/it]
test ppl:  93%|█████████▎| 220/236 [14:00<01:14,  4.66s/it]
test ppl:  94%|█████████▎| 221/236 [14:02<00:56,  3.77s/it]
test ppl:  94%|█████████▍| 222/236 [14:08<01:01,  4.38s/it]
test ppl:  94%|█████████▍| 223/236 [14:14<01:02,  4.82s/it]
test ppl:  95%|█████████▍| 224/236 [14:15<00:46,  3.88s/it]
test ppl:  95%|█████████▌| 225/236 [14:20<00:43,  3.98s/it]
test ppl:  96%|█████████▌| 226/236 [14:22<00:34,  3.47s/it]
test ppl:  96%|█████████▌| 227/236 [14:25<00:29,  3.24s/it]
test ppl:  97%|█████████▋| 228/236 [14:26<00:22,  2.77s/it]
test ppl:  97%|█████████▋| 229/236 [14:32<00:25,  3.67s/it]
test ppl:  97%|█████████▋| 230/236 [14:35<00:21,  3.54s/it]
test ppl:  98%|█████████▊| 231/236 [14:39<00:17,  3.51s/it]
test ppl:  98%|█████████▊| 232/236 [14:41<00:12,  3.01s/it]
test ppl:  99%|█████████▊| 233/236 [14:43<00:08,  2.95s/it]
test ppl:  99%|█████████▉| 234/236 [14:45<00:05,  2.52s/it]
test ppl: 100%|█████████▉| 235/236 [14:51<00:03,  3.50s/it]
test ppl: 100%|██████████| 236/236 [14:51<00:00,  2.65s/it]
test ppl: 100%|██████████| 236/236 [14:51<00:00,  3.78s/it]
10/12/2024 16:43:46 - INFO - __main__ -    em: 0.1955
10/12/2024 16:43:46 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.6 50:  em: 0.1955

--------------------------------------------------------------------------------
Running experiment with knn_temp=50, lmbda=0.6, k=32
2024-10-12 16:43:53.196311: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 16:43:53.216037: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 16:43:53.238205: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 16:43:53.244963: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 16:43:53.260932: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 16:43:54.247835: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 16:43:55 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.6, knn_temp=50, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 16:43:55 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:45:50,  2.19it/s]
Adding feature api:   4%|▍         | 7530/187062 [00:00<00:10, 17921.44it/s]
Adding feature api:   9%|▊         | 16123/187062 [00:00<00:04, 35177.56it/s]
Adding feature api:  13%|█▎        | 24354/187062 [00:00<00:03, 47715.29it/s]
Adding feature api:  18%|█▊        | 32999/187062 [00:00<00:02, 58381.93it/s]
Adding feature api:  22%|██▏       | 41636/187062 [00:00<00:02, 66281.94it/s]
Adding feature api:  27%|██▋       | 50333/187062 [00:01<00:01, 72226.11it/s]
Adding feature api:  31%|███▏      | 58664/187062 [00:01<00:01, 75451.72it/s]
Adding feature api:  36%|███▌      | 67281/187062 [00:01<00:01, 78598.10it/s]
Adding feature api:  41%|████      | 75898/187062 [00:01<00:01, 80833.44it/s]
Adding feature api:  45%|████▌     | 84576/187062 [00:01<00:01, 82596.27it/s]
Adding feature api:  50%|████▉     | 93260/187062 [00:01<00:01, 83857.49it/s]
Adding feature api:  54%|█████▍    | 101826/187062 [00:01<00:01, 83567.15it/s]
Adding feature api:  59%|█████▉    | 110511/187062 [00:01<00:00, 84539.29it/s]
Adding feature api:  64%|██████▎   | 119235/187062 [00:01<00:00, 85342.50it/s]
Adding feature api:  68%|██████▊   | 127919/187062 [00:01<00:00, 85786.75it/s]
Adding feature api:  73%|███████▎  | 136543/187062 [00:02<00:00, 84914.53it/s]
Adding feature api:  78%|███████▊  | 145255/187062 [00:02<00:00, 85566.99it/s]
Adding feature api:  82%|████████▏ | 153956/187062 [00:02<00:00, 85996.14it/s]
Adding feature api:  87%|████████▋ | 162639/187062 [00:02<00:00, 86244.32it/s]
Adding feature api:  92%|█████████▏| 171317/187062 [00:02<00:00, 86401.67it/s]
Adding feature api:  96%|█████████▌| 179966/187062 [00:02<00:00, 73882.54it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 65353.96it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:44:29,  2.19it/s]
Adding feature datatype:   4%|▍         | 7278/187062 [00:00<00:10, 17334.05it/s]
Adding feature datatype:   8%|▊         | 15617/187062 [00:00<00:05, 34103.20it/s]
Adding feature datatype:  13%|█▎        | 23763/187062 [00:00<00:03, 46705.84it/s]
Adding feature datatype:  17%|█▋        | 32079/187062 [00:00<00:02, 56747.00it/s]
Adding feature datatype:  22%|██▏       | 40449/187062 [00:00<00:02, 64356.56it/s]
Adding feature datatype:  26%|██▌       | 48871/187062 [00:01<00:01, 70065.23it/s]
Adding feature datatype:  31%|███       | 57294/187062 [00:01<00:01, 74187.67it/s]
Adding feature datatype:  35%|███▍      | 65437/187062 [00:01<00:01, 76312.23it/s]
Adding feature datatype:  39%|███▉      | 73827/187062 [00:01<00:01, 78554.25it/s]
Adding feature datatype:  44%|████▍     | 82211/187062 [00:01<00:01, 80122.81it/s]
Adding feature datatype:  48%|████▊     | 90579/187062 [00:01<00:01, 81180.23it/s]
Adding feature datatype:  53%|█████▎    | 98872/187062 [00:01<00:01, 81614.27it/s]
Adding feature datatype:  57%|█████▋    | 107291/187062 [00:01<00:00, 82381.00it/s]
Adding feature datatype:  62%|██████▏   | 115639/187062 [00:01<00:00, 82706.52it/s]
Adding feature datatype:  66%|██████▋   | 124068/187062 [00:01<00:00, 83179.13it/s]
Adding feature datatype:  71%|███████   | 132469/187062 [00:02<00:00, 83426.60it/s]
Adding feature datatype:  75%|███████▌  | 140919/187062 [00:02<00:00, 83747.09it/s]
Adding feature datatype:  80%|███████▉  | 149363/187062 [00:02<00:00, 83953.51it/s]
Adding feature datatype:  84%|████████▍ | 157774/187062 [00:02<00:00, 83936.31it/s]
Adding feature datatype:  89%|████████▉ | 166215/187062 [00:02<00:00, 84076.09it/s]
Adding feature datatype:  93%|█████████▎| 174653/187062 [00:02<00:00, 84164.76it/s]
Adding feature datatype:  98%|█████████▊| 183075/187062 [00:02<00:00, 59766.10it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 64189.07it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:48:47,  2.18it/s]
Adding feature literal:   4%|▍         | 7256/187062 [00:00<00:10, 17242.45it/s]
Adding feature literal:   8%|▊         | 15315/187062 [00:00<00:05, 33297.00it/s]
Adding feature literal:  13%|█▎        | 23708/187062 [00:00<00:03, 46754.85it/s]
Adding feature literal:  17%|█▋        | 32126/187062 [00:00<00:02, 57054.28it/s]
Adding feature literal:  22%|██▏       | 40562/187062 [00:00<00:02, 64757.95it/s]
Adding feature literal:  26%|██▌       | 48846/187062 [00:01<00:01, 69950.38it/s]
Adding feature literal:  31%|███       | 57288/187062 [00:01<00:01, 74158.97it/s]
Adding feature literal:  35%|███▌      | 65747/187062 [00:01<00:01, 77221.21it/s]
Adding feature literal:  40%|███▉      | 74221/187062 [00:01<00:01, 79440.06it/s]
Adding feature literal:  44%|████▍     | 82660/187062 [00:01<00:01, 80908.16it/s]
Adding feature literal:  49%|████▊     | 91002/187062 [00:01<00:01, 81446.08it/s]
Adding feature literal:  53%|█████▎    | 99322/187062 [00:01<00:01, 78548.66it/s]
Adding feature literal:  57%|█████▋    | 107321/187062 [00:01<00:01, 77638.28it/s]
Adding feature literal:  62%|██████▏   | 115750/187062 [00:01<00:00, 79561.06it/s]
Adding feature literal:  66%|██████▋   | 124201/187062 [00:01<00:00, 81005.12it/s]
Adding feature literal:  71%|███████   | 132655/187062 [00:02<00:00, 82043.47it/s]
Adding feature literal:  75%|███████▌  | 141049/187062 [00:02<00:00, 82602.96it/s]
Adding feature literal:  80%|███████▉  | 149475/187062 [00:02<00:00, 83092.65it/s]
Adding feature literal:  84%|████████▍ | 157901/187062 [00:02<00:00, 83440.08it/s]
Adding feature literal:  89%|████████▉ | 166347/187062 [00:02<00:00, 83743.77it/s]
Adding feature literal:  93%|█████████▎| 174802/187062 [00:02<00:00, 83982.34it/s]
Adding feature literal:  98%|█████████▊| 183209/187062 [00:02<00:00, 59359.98it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63775.76it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:55:54,  2.17it/s]
Adding feature operator:   4%|▍         | 7267/187062 [00:00<00:10, 17203.23it/s]
Adding feature operator:   8%|▊         | 15641/187062 [00:00<00:05, 34018.46it/s]
Adding feature operator:  13%|█▎        | 24050/187062 [00:00<00:03, 47299.32it/s]
Adding feature operator:  17%|█▋        | 32479/187062 [00:00<00:02, 57463.05it/s]
Adding feature operator:  22%|██▏       | 40916/187062 [00:00<00:02, 65046.67it/s]
Adding feature operator:  26%|██▋       | 49420/187062 [00:01<00:01, 70786.20it/s]
Adding feature operator:  31%|███       | 57897/187062 [00:01<00:01, 74851.23it/s]
Adding feature operator:  35%|███▌      | 66354/187062 [00:01<00:01, 77702.07it/s]
Adding feature operator:  40%|████      | 74879/187062 [00:01<00:01, 79931.17it/s]
Adding feature operator:  45%|████▍     | 83414/187062 [00:01<00:01, 81537.01it/s]
Adding feature operator:  49%|████▉     | 91934/187062 [00:01<00:01, 82626.64it/s]
Adding feature operator:  54%|█████▎    | 100444/187062 [00:01<00:01, 83362.61it/s]
Adding feature operator:  58%|█████▊    | 108907/187062 [00:01<00:00, 83506.03it/s]
Adding feature operator:  63%|██████▎   | 117368/187062 [00:01<00:00, 83833.04it/s]
Adding feature operator:  67%|██████▋   | 125857/187062 [00:01<00:00, 84148.11it/s]
Adding feature operator:  72%|███████▏  | 134413/187062 [00:02<00:00, 84568.14it/s]
Adding feature operator:  76%|███████▋  | 142909/187062 [00:02<00:00, 84682.69it/s]
Adding feature operator:  81%|████████  | 151399/187062 [00:02<00:00, 84382.80it/s]
Adding feature operator:  85%|████████▌ | 159869/187062 [00:02<00:00, 84475.33it/s]
Adding feature operator:  90%|█████████ | 168359/187062 [00:02<00:00, 84599.10it/s]
Adding feature operator:  95%|█████████▍| 176827/187062 [00:02<00:00, 84607.40it/s]
Adding feature operator:  99%|█████████▉| 185294/187062 [00:02<00:00, 55514.69it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 64664.60it/s]
[2024-10-12 16:44:39,173] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 16:44:40 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 16:44:40 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 408.66 examples/s]
Map:   1%|▏         | 90/6548 [00:00<00:28, 230.41 examples/s]
Map:   2%|▏         | 128/6548 [00:00<00:23, 273.70 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:19, 323.66 examples/s]
Map:   3%|▎         | 225/6548 [00:00<00:17, 365.16 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:17, 360.99 examples/s]
Map:   5%|▌         | 346/6548 [00:01<00:20, 309.64 examples/s]
Map:   6%|▌         | 385/6548 [00:01<00:19, 320.57 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:17, 349.17 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:19, 307.70 examples/s]
Map:   8%|▊         | 520/6548 [00:01<00:19, 306.94 examples/s]
Map:   9%|▊         | 570/6548 [00:01<00:17, 347.91 examples/s]
Map:   9%|▉         | 622/6548 [00:01<00:17, 335.18 examples/s]
Map:  10%|█         | 671/6548 [00:02<00:17, 329.52 examples/s]
Map:  11%|█         | 716/6548 [00:02<00:16, 352.64 examples/s]
Map:  12%|█▏        | 765/6548 [00:02<00:15, 381.33 examples/s]
Map:  12%|█▏        | 817/6548 [00:02<00:13, 409.48 examples/s]
Map:  13%|█▎        | 860/6548 [00:02<00:13, 412.65 examples/s]
Map:  14%|█▍        | 915/6548 [00:02<00:14, 392.38 examples/s]
Map:  15%|█▍        | 957/6548 [00:02<00:14, 394.81 examples/s]
Map:  15%|█▌        | 1000/6548 [00:03<00:23, 233.20 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:21, 256.94 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:19, 281.86 examples/s]
Map:  17%|█▋        | 1124/6548 [00:03<00:16, 323.30 examples/s]
Map:  18%|█▊        | 1164/6548 [00:03<00:15, 337.96 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 355.76 examples/s]
Map:  19%|█▉        | 1249/6548 [00:03<00:14, 362.82 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:13, 375.57 examples/s]
Map:  21%|██        | 1355/6548 [00:04<00:16, 312.52 examples/s]
Map:  21%|██▏       | 1402/6548 [00:04<00:16, 309.29 examples/s]
Map:  22%|██▏       | 1436/6548 [00:04<00:17, 286.93 examples/s]
Map:  22%|██▏       | 1469/6548 [00:04<00:17, 294.12 examples/s]
Map:  23%|██▎       | 1500/6548 [00:04<00:17, 295.48 examples/s]
Map:  23%|██▎       | 1533/6548 [00:04<00:16, 300.00 examples/s]
Map:  24%|██▍       | 1569/6548 [00:04<00:15, 313.95 examples/s]
Map:  25%|██▍       | 1610/6548 [00:05<00:17, 287.04 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:16, 289.63 examples/s]
Map:  26%|██▌       | 1695/6548 [00:05<00:16, 299.55 examples/s]
Map:  26%|██▋       | 1735/6548 [00:05<00:14, 322.79 examples/s]
Map:  27%|██▋       | 1780/6548 [00:05<00:13, 354.64 examples/s]
Map:  28%|██▊       | 1843/6548 [00:05<00:12, 372.23 examples/s]
Map:  29%|██▉       | 1884/6548 [00:05<00:14, 327.47 examples/s]
Map:  29%|██▉       | 1926/6548 [00:05<00:13, 341.65 examples/s]
Map:  30%|███       | 1967/6548 [00:06<00:12, 356.94 examples/s]
Map:  31%|███       | 2017/6548 [00:06<00:19, 238.25 examples/s]
Map:  31%|███▏      | 2049/6548 [00:06<00:18, 249.28 examples/s]
Map:  32%|███▏      | 2087/6548 [00:06<00:16, 274.32 examples/s]
Map:  32%|███▏      | 2124/6548 [00:06<00:15, 285.61 examples/s]
Map:  33%|███▎      | 2159/6548 [00:06<00:16, 263.97 examples/s]
Map:  34%|███▍      | 2210/6548 [00:06<00:13, 319.26 examples/s]
Map:  34%|███▍      | 2256/6548 [00:07<00:15, 280.41 examples/s]
Map:  35%|███▌      | 2310/6548 [00:07<00:14, 296.18 examples/s]
Map:  36%|███▌      | 2351/6548 [00:07<00:13, 319.64 examples/s]
Map:  37%|███▋      | 2403/6548 [00:07<00:12, 327.00 examples/s]
Map:  37%|███▋      | 2438/6548 [00:07<00:13, 314.72 examples/s]
Map:  38%|███▊      | 2477/6548 [00:07<00:12, 324.57 examples/s]
Map:  38%|███▊      | 2517/6548 [00:07<00:12, 326.12 examples/s]
Map:  39%|███▉      | 2562/6548 [00:08<00:11, 350.38 examples/s]
Map:  40%|███▉      | 2608/6548 [00:08<00:10, 374.70 examples/s]
Map:  41%|████      | 2654/6548 [00:08<00:09, 393.58 examples/s]
Map:  41%|████▏     | 2704/6548 [00:08<00:10, 362.34 examples/s]
Map:  42%|████▏     | 2763/6548 [00:08<00:10, 366.27 examples/s]
Map:  43%|████▎     | 2809/6548 [00:08<00:10, 342.48 examples/s]
Map:  43%|████▎     | 2846/6548 [00:08<00:12, 286.43 examples/s]
Map:  44%|████▍     | 2880/6548 [00:09<00:12, 295.78 examples/s]
Map:  45%|████▍     | 2923/6548 [00:09<00:12, 279.32 examples/s]
Map:  45%|████▌     | 2965/6548 [00:09<00:11, 306.54 examples/s]
Map:  46%|████▌     | 3000/6548 [00:09<00:20, 172.83 examples/s]
Map:  46%|████▋     | 3043/6548 [00:09<00:17, 195.84 examples/s]
Map:  47%|████▋     | 3073/6548 [00:10<00:16, 207.30 examples/s]
Map:  48%|████▊     | 3115/6548 [00:10<00:13, 246.69 examples/s]
Map:  48%|████▊     | 3149/6548 [00:10<00:13, 244.81 examples/s]
Map:  49%|████▊     | 3183/6548 [00:10<00:13, 246.58 examples/s]
Map:  49%|████▉     | 3213/6548 [00:10<00:14, 237.41 examples/s]
Map:  50%|████▉     | 3245/6548 [00:10<00:13, 253.06 examples/s]
Map:  50%|█████     | 3280/6548 [00:10<00:12, 272.23 examples/s]
Map:  51%|█████     | 3321/6548 [00:10<00:10, 302.80 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:11<00:10, 301.53 examples/s]
Map:  52%|█████▏    | 3404/6548 [00:11<00:11, 277.17 examples/s]
Map:  53%|█████▎    | 3445/6548 [00:11<00:10, 302.55 examples/s]
Map:  53%|█████▎    | 3479/6548 [00:11<00:11, 261.75 examples/s]
Map:  54%|█████▍    | 3524/6548 [00:11<00:09, 304.41 examples/s]
Map:  54%|█████▍    | 3566/6548 [00:11<00:09, 329.67 examples/s]
Map:  55%|█████▌    | 3614/6548 [00:11<00:08, 365.93 examples/s]
Map:  56%|█████▌    | 3670/6548 [00:11<00:07, 367.23 examples/s]
Map:  57%|█████▋    | 3716/6548 [00:12<00:07, 385.77 examples/s]
Map:  58%|█████▊    | 3769/6548 [00:12<00:07, 366.47 examples/s]
Map:  58%|█████▊    | 3811/6548 [00:12<00:07, 374.89 examples/s]
Map:  59%|█████▉    | 3865/6548 [00:12<00:08, 312.56 examples/s]
Map:  60%|█████▉    | 3914/6548 [00:12<00:07, 331.17 examples/s]
Map:  61%|██████    | 3964/6548 [00:12<00:07, 330.50 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 235.03 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 287.95 examples/s]
Map:  63%|██████▎   | 4095/6548 [00:13<00:07, 312.28 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 323.34 examples/s]
Map:  64%|██████▍   | 4194/6548 [00:13<00:07, 324.08 examples/s]
Map:  65%|██████▍   | 4231/6548 [00:13<00:07, 320.18 examples/s]
Map:  65%|██████▌   | 4277/6548 [00:13<00:06, 350.86 examples/s]
Map:  66%|██████▌   | 4317/6548 [00:13<00:06, 360.74 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:14<00:06, 349.44 examples/s]
Map:  67%|██████▋   | 4405/6548 [00:14<00:06, 353.23 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:05, 379.11 examples/s]
Map:  69%|██████▊   | 4498/6548 [00:14<00:06, 338.33 examples/s]
Map:  69%|██████▉   | 4545/6548 [00:14<00:06, 326.07 examples/s]
Map:  70%|███████   | 4584/6548 [00:14<00:06, 315.17 examples/s]
Map:  71%|███████   | 4625/6548 [00:14<00:05, 334.11 examples/s]
Map:  71%|███████▏  | 4669/6548 [00:14<00:05, 358.56 examples/s]
Map:  72%|███████▏  | 4726/6548 [00:15<00:05, 361.71 examples/s]
Map:  73%|███████▎  | 4793/6548 [00:15<00:04, 385.04 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 373.31 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 349.91 examples/s]
Map:  76%|███████▌  | 4958/6548 [00:15<00:04, 389.14 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:16<00:06, 247.79 examples/s]
Map:  77%|███████▋  | 5037/6548 [00:16<00:05, 268.29 examples/s]
Map:  78%|███████▊  | 5081/6548 [00:16<00:05, 271.56 examples/s]
Map:  78%|███████▊  | 5116/6548 [00:16<00:04, 286.42 examples/s]
Map:  79%|███████▉  | 5159/6548 [00:16<00:04, 279.40 examples/s]
Map:  80%|███████▉  | 5207/6548 [00:16<00:04, 278.93 examples/s]
Map:  80%|████████  | 5246/6548 [00:16<00:04, 298.63 examples/s]
Map:  81%|████████  | 5286/6548 [00:16<00:03, 319.77 examples/s]
Map:  81%|████████▏ | 5322/6548 [00:17<00:03, 327.89 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:04, 294.11 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 289.79 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 321.56 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 318.77 examples/s]
Map:  85%|████████▍ | 5546/6548 [00:17<00:02, 341.41 examples/s]
Map:  85%|████████▌ | 5582/6548 [00:17<00:03, 299.69 examples/s]
Map:  86%|████████▌ | 5619/6548 [00:18<00:02, 313.70 examples/s]
Map:  87%|████████▋ | 5668/6548 [00:18<00:02, 314.67 examples/s]
Map:  87%|████████▋ | 5702/6548 [00:18<00:02, 318.55 examples/s]
Map:  88%|████████▊ | 5743/6548 [00:18<00:02, 339.42 examples/s]
Map:  88%|████████▊ | 5781/6548 [00:18<00:02, 341.10 examples/s]
Map:  89%|████████▉ | 5825/6548 [00:18<00:02, 343.93 examples/s]
Map:  90%|████████▉ | 5866/6548 [00:18<00:01, 353.69 examples/s]
Map:  90%|█████████ | 5908/6548 [00:18<00:01, 368.18 examples/s]
Map:  91%|█████████ | 5959/6548 [00:18<00:01, 355.02 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 209.93 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:02, 242.47 examples/s]
Map:  93%|█████████▎| 6073/6548 [00:19<00:01, 256.92 examples/s]
Map:  93%|█████████▎| 6120/6548 [00:19<00:01, 267.04 examples/s]
Map:  94%|█████████▍| 6168/6548 [00:19<00:01, 280.56 examples/s]
Map:  95%|█████████▍| 6201/6548 [00:20<00:01, 289.55 examples/s]
Map:  95%|█████████▌| 6247/6548 [00:20<00:00, 324.81 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 332.86 examples/s]
Map:  97%|█████████▋| 6363/6548 [00:20<00:00, 351.36 examples/s]
Map:  98%|█████████▊| 6418/6548 [00:20<00:00, 349.83 examples/s]
Map:  99%|█████████▉| 6469/6548 [00:20<00:00, 383.99 examples/s]
Map: 100%|█████████▉| 6528/6548 [00:20<00:00, 385.19 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 311.53 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   3%|▎         | 31/903 [00:00<00:03, 280.23 examples/s]
Map:   7%|▋         | 62/903 [00:00<00:02, 294.09 examples/s]
Map:  11%|█         | 96/903 [00:00<00:02, 305.79 examples/s]
Map:  16%|█▌        | 142/903 [00:00<00:02, 303.31 examples/s]
Map:  21%|██        | 190/903 [00:00<00:02, 355.90 examples/s]
Map:  25%|██▌       | 230/903 [00:00<00:01, 366.44 examples/s]
Map:  30%|███       | 271/903 [00:00<00:01, 377.36 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 378.97 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 327.59 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 299.03 examples/s]
Map:  49%|████▉     | 444/903 [00:01<00:01, 301.84 examples/s]
Map:  53%|█████▎    | 478/903 [00:01<00:01, 308.75 examples/s]
Map:  57%|█████▋    | 516/903 [00:01<00:01, 322.94 examples/s]
Map:  62%|██████▏   | 561/903 [00:01<00:00, 351.35 examples/s]
Map:  68%|██████▊   | 613/903 [00:01<00:00, 378.35 examples/s]
Map:  73%|███████▎  | 663/903 [00:01<00:00, 351.77 examples/s]
Map:  78%|███████▊  | 700/903 [00:02<00:00, 353.59 examples/s]
Map:  82%|████████▏ | 742/903 [00:02<00:00, 367.81 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 370.43 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 374.90 examples/s]
Map:  96%|█████████▌| 866/903 [00:02<00:00, 379.41 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 314.48 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 296.09 examples/s]
Map:   4%|▍         | 83/1882 [00:00<00:04, 371.86 examples/s]
Map:   7%|▋         | 124/1882 [00:00<00:05, 307.89 examples/s]
Map:   9%|▉         | 167/1882 [00:00<00:04, 345.67 examples/s]
Map:  12%|█▏        | 221/1882 [00:00<00:05, 328.21 examples/s]
Map:  14%|█▍        | 267/1882 [00:00<00:04, 351.89 examples/s]
Map:  17%|█▋        | 325/1882 [00:00<00:04, 352.91 examples/s]
Map:  19%|█▉        | 364/1882 [00:01<00:04, 321.26 examples/s]
Map:  21%|██▏       | 402/1882 [00:01<00:05, 295.83 examples/s]
Map:  23%|██▎       | 439/1882 [00:01<00:04, 311.27 examples/s]
Map:  25%|██▌       | 473/1882 [00:01<00:04, 316.84 examples/s]
Map:  27%|██▋       | 507/1882 [00:01<00:04, 317.25 examples/s]
Map:  29%|██▉       | 543/1882 [00:01<00:04, 327.59 examples/s]
Map:  31%|███       | 587/1882 [00:01<00:03, 357.80 examples/s]
Map:  34%|███▍      | 644/1882 [00:01<00:02, 412.91 examples/s]
Map:  37%|███▋      | 704/1882 [00:02<00:03, 392.06 examples/s]
Map:  41%|████      | 768/1882 [00:02<00:02, 398.04 examples/s]
Map:  44%|████▍     | 829/1882 [00:02<00:02, 356.05 examples/s]
Map:  46%|████▌     | 867/1882 [00:02<00:02, 359.21 examples/s]
Map:  48%|████▊     | 908/1882 [00:02<00:02, 364.50 examples/s]
Map:  51%|█████     | 961/1882 [00:02<00:02, 401.09 examples/s]
Map:  54%|█████▍    | 1016/1882 [00:03<00:03, 254.56 examples/s]
Map:  56%|█████▌    | 1054/1882 [00:03<00:03, 274.12 examples/s]
Map:  58%|█████▊    | 1091/1882 [00:03<00:02, 290.85 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 296.75 examples/s]
Map:  62%|██████▏   | 1176/1882 [00:03<00:02, 309.52 examples/s]
Map:  64%|██████▍   | 1213/1882 [00:03<00:02, 285.70 examples/s]
Map:  67%|██████▋   | 1255/1882 [00:03<00:02, 313.03 examples/s]
Map:  69%|██████▉   | 1296/1882 [00:03<00:01, 336.25 examples/s]
Map:  71%|███████   | 1340/1882 [00:04<00:01, 359.84 examples/s]
Map:  74%|███████▎  | 1385/1882 [00:04<00:01, 334.55 examples/s]
Map:  76%|███████▌  | 1426/1882 [00:04<00:01, 298.64 examples/s]
Map:  78%|███████▊  | 1465/1882 [00:04<00:01, 314.25 examples/s]
Map:  80%|███████▉  | 1504/1882 [00:04<00:01, 269.43 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 262.53 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:04<00:01, 288.31 examples/s]
Map:  86%|████████▋ | 1626/1882 [00:05<00:00, 320.75 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 322.44 examples/s]
Map:  91%|█████████ | 1710/1882 [00:05<00:00, 310.87 examples/s]
Map:  93%|█████████▎| 1746/1882 [00:05<00:00, 266.34 examples/s]
Map:  95%|█████████▍| 1785/1882 [00:05<00:00, 256.67 examples/s]
Map:  97%|█████████▋| 1830/1882 [00:05<00:00, 297.46 examples/s]
Map: 100%|█████████▉| 1875/1882 [00:05<00:00, 330.66 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 309.20 examples/s]
10/12/2024 16:45:42 - INFO - __main__ -     ***** Testing *****
10/12/2024 16:45:42 - INFO - __main__ -     Batch size = 8
10/12/2024 16:45:42 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 16:45:43 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 16:45:43 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 16:45:44 - INFO - knnlm -   Reading datastore took 0.950477123260498 s
10/12/2024 16:45:45 - INFO - knnlm -   Moving index to GPU took 0.915198802947998 s
10/12/2024 16:45:45 - INFO - __main__ -   ******************************break-into
10/12/2024 16:45:45 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 16:45:45 - INFO - __main__ -     Num examples = 236
10/12/2024 16:45:45 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:17,  7.48s/it]
test ppl:   1%|          | 2/236 [00:09<16:06,  4.13s/it]
test ppl:   1%|▏         | 3/236 [00:15<19:06,  4.92s/it]
test ppl:   2%|▏         | 4/236 [00:16<14:05,  3.64s/it]
test ppl:   2%|▏         | 5/236 [00:22<17:02,  4.43s/it]
test ppl:   3%|▎         | 6/236 [00:28<18:47,  4.90s/it]
test ppl:   3%|▎         | 7/236 [00:30<14:55,  3.91s/it]
test ppl:   3%|▎         | 8/236 [00:35<16:26,  4.33s/it]
test ppl:   4%|▍         | 9/236 [00:37<13:43,  3.63s/it]
test ppl:   4%|▍         | 10/236 [00:41<13:32,  3.60s/it]
test ppl:   5%|▍         | 11/236 [00:45<13:56,  3.72s/it]
test ppl:   5%|▌         | 12/236 [00:50<16:16,  4.36s/it]
test ppl:   6%|▌         | 13/236 [00:56<17:52,  4.81s/it]
test ppl:   6%|▌         | 14/236 [01:02<18:58,  5.13s/it]
test ppl:   6%|▋         | 15/236 [01:04<15:03,  4.09s/it]
test ppl:   7%|▋         | 16/236 [01:06<12:24,  3.39s/it]
test ppl:   7%|▋         | 17/236 [01:11<15:02,  4.12s/it]
test ppl:   8%|▊         | 18/236 [01:14<13:08,  3.62s/it]
test ppl:   8%|▊         | 19/236 [01:19<14:59,  4.14s/it]
test ppl:   8%|▊         | 20/236 [01:22<13:11,  3.66s/it]
test ppl:   9%|▉         | 21/236 [01:24<11:26,  3.19s/it]
test ppl:   9%|▉         | 22/236 [01:30<14:14,  3.99s/it]
test ppl:  10%|▉         | 23/236 [01:32<12:34,  3.54s/it]
test ppl:  10%|█         | 24/236 [01:34<11:04,  3.13s/it]
test ppl:  11%|█         | 25/236 [01:40<13:50,  3.94s/it]
test ppl:  11%|█         | 26/236 [01:46<15:47,  4.51s/it]
test ppl:  11%|█▏        | 27/236 [01:50<14:34,  4.18s/it]
test ppl:  12%|█▏        | 28/236 [01:51<11:23,  3.29s/it]
test ppl:  12%|█▏        | 29/236 [01:53<10:17,  2.98s/it]
test ppl:  13%|█▎        | 30/236 [01:55<08:44,  2.55s/it]
test ppl:  13%|█▎        | 31/236 [01:57<08:08,  2.38s/it]
test ppl:  14%|█▎        | 32/236 [02:02<11:36,  3.41s/it]
test ppl:  14%|█▍        | 33/236 [02:05<10:33,  3.12s/it]
test ppl:  14%|█▍        | 34/236 [02:09<11:23,  3.38s/it]
test ppl:  15%|█▍        | 35/236 [02:11<10:28,  3.13s/it]
test ppl:  15%|█▌        | 36/236 [02:17<13:08,  3.94s/it]
test ppl:  16%|█▌        | 37/236 [02:23<14:59,  4.52s/it]
test ppl:  16%|█▌        | 38/236 [02:25<12:28,  3.78s/it]
test ppl:  17%|█▋        | 39/236 [02:27<10:24,  3.17s/it]
test ppl:  17%|█▋        | 40/236 [02:28<08:33,  2.62s/it]
test ppl:  17%|█▋        | 41/236 [02:30<07:45,  2.39s/it]
test ppl:  18%|█▊        | 42/236 [02:36<11:06,  3.44s/it]
test ppl:  18%|█▊        | 43/236 [02:42<13:21,  4.15s/it]
test ppl:  19%|█▊        | 44/236 [02:44<11:32,  3.61s/it]
test ppl:  19%|█▉        | 45/236 [02:46<09:46,  3.07s/it]
test ppl:  19%|█▉        | 46/236 [02:52<12:23,  3.91s/it]
test ppl:  20%|█▉        | 47/236 [02:53<10:03,  3.19s/it]
test ppl:  20%|██        | 48/236 [02:59<12:28,  3.98s/it]
test ppl:  21%|██        | 49/236 [03:04<13:44,  4.41s/it]
test ppl:  21%|██        | 50/236 [03:10<15:04,  4.86s/it]
test ppl:  22%|██▏       | 51/236 [03:16<15:55,  5.17s/it]
test ppl:  22%|██▏       | 52/236 [03:22<16:27,  5.37s/it]
test ppl:  22%|██▏       | 53/236 [03:28<16:48,  5.51s/it]
test ppl:  23%|██▎       | 54/236 [03:29<13:05,  4.32s/it]
test ppl:  23%|██▎       | 55/236 [03:35<14:12,  4.71s/it]
test ppl:  24%|██▎       | 56/236 [03:41<15:10,  5.06s/it]
test ppl:  24%|██▍       | 57/236 [03:43<12:38,  4.23s/it]
test ppl:  25%|██▍       | 58/236 [03:46<10:49,  3.65s/it]
test ppl:  25%|██▌       | 59/236 [03:51<12:43,  4.31s/it]
test ppl:  25%|██▌       | 60/236 [03:55<11:47,  4.02s/it]
test ppl:  26%|██▌       | 61/236 [04:01<13:19,  4.57s/it]
test ppl:  26%|██▋       | 62/236 [04:06<14:22,  4.95s/it]
test ppl:  27%|██▋       | 63/236 [04:09<12:07,  4.21s/it]
test ppl:  27%|██▋       | 64/236 [04:10<09:45,  3.41s/it]
test ppl:  28%|██▊       | 65/236 [04:12<07:54,  2.78s/it]
test ppl:  28%|██▊       | 66/236 [04:15<08:03,  2.84s/it]
test ppl:  28%|██▊       | 67/236 [04:21<10:33,  3.75s/it]
test ppl:  29%|██▉       | 68/236 [04:27<12:16,  4.38s/it]
test ppl:  29%|██▉       | 69/236 [04:32<13:24,  4.82s/it]
test ppl:  30%|██▉       | 70/236 [04:38<14:09,  5.12s/it]
test ppl:  30%|███       | 71/236 [04:42<12:59,  4.73s/it]
test ppl:  31%|███       | 72/236 [04:45<11:12,  4.10s/it]
test ppl:  31%|███       | 73/236 [04:50<12:33,  4.62s/it]
test ppl:  31%|███▏      | 74/236 [04:52<09:57,  3.69s/it]
test ppl:  32%|███▏      | 75/236 [04:58<11:38,  4.34s/it]
test ppl:  32%|███▏      | 76/236 [05:01<10:27,  3.92s/it]
test ppl:  33%|███▎      | 77/236 [05:03<09:05,  3.43s/it]
test ppl:  33%|███▎      | 78/236 [05:05<07:42,  2.92s/it]
test ppl:  33%|███▎      | 79/236 [05:09<08:23,  3.20s/it]
test ppl:  34%|███▍      | 80/236 [05:11<07:44,  2.98s/it]
test ppl:  34%|███▍      | 81/236 [05:17<09:54,  3.83s/it]
test ppl:  35%|███▍      | 82/236 [05:23<11:24,  4.45s/it]
test ppl:  35%|███▌      | 83/236 [05:25<09:51,  3.87s/it]
test ppl:  36%|███▌      | 84/236 [05:28<08:40,  3.43s/it]
test ppl:  36%|███▌      | 85/236 [05:32<09:10,  3.65s/it]
test ppl:  36%|███▋      | 86/236 [05:34<07:35,  3.04s/it]
test ppl:  37%|███▋      | 87/236 [05:36<06:49,  2.75s/it]
test ppl:  37%|███▋      | 88/236 [05:41<09:04,  3.68s/it]
test ppl:  38%|███▊      | 89/236 [05:43<07:45,  3.17s/it]
test ppl:  38%|███▊      | 90/236 [05:49<09:39,  3.97s/it]
test ppl:  39%|███▊      | 91/236 [05:54<10:15,  4.25s/it]
test ppl:  39%|███▉      | 92/236 [05:57<09:08,  3.81s/it]
test ppl:  39%|███▉      | 93/236 [06:03<10:31,  4.42s/it]
test ppl:  40%|███▉      | 94/236 [06:08<11:23,  4.81s/it]
test ppl:  40%|████      | 95/236 [06:11<09:45,  4.15s/it]
test ppl:  41%|████      | 96/236 [06:15<09:28,  4.06s/it]
test ppl:  41%|████      | 97/236 [06:21<10:38,  4.59s/it]
test ppl:  42%|████▏     | 98/236 [06:27<11:26,  4.97s/it]
test ppl:  42%|████▏     | 99/236 [06:33<11:57,  5.24s/it]
test ppl:  42%|████▏     | 100/236 [06:34<09:09,  4.04s/it]
test ppl:  43%|████▎     | 101/236 [06:40<10:18,  4.58s/it]
test ppl:  43%|████▎     | 102/236 [06:44<09:47,  4.38s/it]
test ppl:  44%|████▎     | 103/236 [06:45<07:44,  3.49s/it]
test ppl:  44%|████▍     | 104/236 [06:49<08:10,  3.71s/it]
test ppl:  44%|████▍     | 105/236 [06:53<08:16,  3.79s/it]
test ppl:  45%|████▍     | 106/236 [06:59<09:14,  4.27s/it]
test ppl:  45%|████▌     | 107/236 [07:01<07:53,  3.67s/it]
test ppl:  46%|████▌     | 108/236 [07:04<07:43,  3.62s/it]
test ppl:  46%|████▌     | 109/236 [07:10<08:42,  4.11s/it]
test ppl:  47%|████▋     | 110/236 [07:11<07:02,  3.35s/it]
test ppl:  47%|████▋     | 111/236 [07:15<07:03,  3.39s/it]
test ppl:  47%|████▋     | 112/236 [07:20<07:58,  3.86s/it]
test ppl:  48%|████▊     | 113/236 [07:21<06:37,  3.23s/it]
test ppl:  48%|████▊     | 114/236 [07:25<06:51,  3.37s/it]
test ppl:  49%|████▊     | 115/236 [07:31<08:17,  4.11s/it]
test ppl:  49%|████▉     | 116/236 [07:37<09:16,  4.64s/it]
test ppl:  50%|████▉     | 117/236 [07:39<07:32,  3.80s/it]
test ppl:  50%|█████     | 118/236 [07:44<08:15,  4.20s/it]
test ppl:  50%|█████     | 119/236 [07:46<06:59,  3.59s/it]
test ppl:  51%|█████     | 120/236 [07:47<05:41,  2.94s/it]
test ppl:  51%|█████▏    | 121/236 [07:50<05:26,  2.84s/it]
test ppl:  52%|█████▏    | 122/236 [07:56<07:06,  3.74s/it]
test ppl:  52%|█████▏    | 123/236 [07:58<06:07,  3.25s/it]
test ppl:  53%|█████▎    | 124/236 [08:00<05:38,  3.02s/it]
test ppl:  53%|█████▎    | 125/236 [08:06<07:09,  3.87s/it]
test ppl:  53%|█████▎    | 126/236 [08:11<07:35,  4.14s/it]
test ppl:  54%|█████▍    | 127/236 [08:13<06:16,  3.46s/it]
test ppl:  54%|█████▍    | 128/236 [08:15<05:21,  2.98s/it]
test ppl:  55%|█████▍    | 129/236 [08:17<05:06,  2.87s/it]
test ppl:  55%|█████▌    | 130/236 [08:20<05:10,  2.93s/it]
test ppl:  56%|█████▌    | 131/236 [08:26<06:39,  3.81s/it]
test ppl:  56%|█████▌    | 132/236 [08:31<07:02,  4.06s/it]
test ppl:  56%|█████▋    | 133/236 [08:35<06:52,  4.00s/it]
test ppl:  57%|█████▋    | 134/236 [08:38<06:29,  3.82s/it]
test ppl:  57%|█████▋    | 135/236 [08:44<07:27,  4.43s/it]
test ppl:  58%|█████▊    | 136/236 [08:45<05:49,  3.50s/it]
test ppl:  58%|█████▊    | 137/236 [08:51<06:56,  4.21s/it]
test ppl:  58%|█████▊    | 138/236 [08:55<06:31,  3.99s/it]
test ppl:  59%|█████▉    | 139/236 [08:56<05:22,  3.33s/it]
test ppl:  59%|█████▉    | 140/236 [08:58<04:31,  2.83s/it]
test ppl:  60%|█████▉    | 141/236 [09:02<04:57,  3.13s/it]
test ppl:  60%|██████    | 142/236 [09:04<04:25,  2.83s/it]
test ppl:  61%|██████    | 143/236 [09:10<05:47,  3.74s/it]
test ppl:  61%|██████    | 144/236 [09:14<05:51,  3.82s/it]
test ppl:  61%|██████▏   | 145/236 [09:20<06:43,  4.43s/it]
test ppl:  62%|██████▏   | 146/236 [09:25<06:56,  4.63s/it]
test ppl:  62%|██████▏   | 147/236 [09:31<07:25,  5.00s/it]
test ppl:  63%|██████▎   | 148/236 [09:37<07:45,  5.29s/it]
test ppl:  63%|██████▎   | 149/236 [09:43<07:55,  5.46s/it]
test ppl:  64%|██████▎   | 150/236 [09:48<08:00,  5.59s/it]
test ppl:  64%|██████▍   | 151/236 [09:54<08:02,  5.67s/it]
test ppl:  64%|██████▍   | 152/236 [10:00<08:00,  5.72s/it]
test ppl:  65%|██████▍   | 153/236 [10:06<07:58,  5.76s/it]
test ppl:  65%|██████▌   | 154/236 [10:07<06:06,  4.47s/it]
test ppl:  66%|██████▌   | 155/236 [10:11<05:45,  4.26s/it]
test ppl:  66%|██████▌   | 156/236 [10:14<04:56,  3.70s/it]
test ppl:  67%|██████▋   | 157/236 [10:16<04:16,  3.25s/it]
test ppl:  67%|██████▋   | 158/236 [10:22<05:14,  4.03s/it]
test ppl:  67%|██████▋   | 159/236 [10:28<05:52,  4.58s/it]
test ppl:  68%|██████▊   | 160/236 [10:29<04:30,  3.56s/it]
test ppl:  68%|██████▊   | 161/236 [10:30<03:36,  2.89s/it]
test ppl:  69%|██████▊   | 162/236 [10:33<03:38,  2.96s/it]
test ppl:  69%|██████▉   | 163/236 [10:36<03:22,  2.78s/it]
test ppl:  69%|██████▉   | 164/236 [10:38<03:22,  2.81s/it]
test ppl:  70%|██████▉   | 165/236 [10:43<03:46,  3.19s/it]
test ppl:  70%|███████   | 166/236 [10:44<03:06,  2.67s/it]
test ppl:  71%|███████   | 167/236 [10:45<02:39,  2.31s/it]
test ppl:  71%|███████   | 168/236 [10:51<03:49,  3.38s/it]
test ppl:  72%|███████▏  | 169/236 [10:56<04:05,  3.67s/it]
test ppl:  72%|███████▏  | 170/236 [11:02<04:45,  4.33s/it]
test ppl:  72%|███████▏  | 171/236 [11:03<03:43,  3.44s/it]
test ppl:  73%|███████▎  | 172/236 [11:09<04:26,  4.16s/it]
test ppl:  73%|███████▎  | 173/236 [11:12<04:04,  3.88s/it]
test ppl:  74%|███████▎  | 174/236 [11:18<04:37,  4.48s/it]
test ppl:  74%|███████▍  | 175/236 [11:20<03:45,  3.70s/it]
test ppl:  75%|███████▍  | 176/236 [11:26<04:20,  4.34s/it]
test ppl:  75%|███████▌  | 177/236 [11:31<04:42,  4.80s/it]
test ppl:  75%|███████▌  | 178/236 [11:37<04:57,  5.13s/it]
test ppl:  76%|███████▌  | 179/236 [11:43<05:05,  5.35s/it]
test ppl:  76%|███████▋  | 180/236 [11:49<05:07,  5.49s/it]
test ppl:  77%|███████▋  | 181/236 [11:54<04:53,  5.34s/it]
test ppl:  77%|███████▋  | 182/236 [11:56<03:52,  4.31s/it]
test ppl:  78%|███████▊  | 183/236 [11:57<03:05,  3.49s/it]
test ppl:  78%|███████▊  | 184/236 [11:59<02:30,  2.89s/it]
test ppl:  78%|███████▊  | 185/236 [12:03<02:40,  3.16s/it]
test ppl:  79%|███████▉  | 186/236 [12:05<02:19,  2.79s/it]
test ppl:  79%|███████▉  | 187/236 [12:06<01:59,  2.45s/it]
test ppl:  80%|███████▉  | 188/236 [12:12<02:46,  3.47s/it]
test ppl:  80%|████████  | 189/236 [12:18<03:17,  4.19s/it]
test ppl:  81%|████████  | 190/236 [12:22<03:13,  4.20s/it]
test ppl:  81%|████████  | 191/236 [12:26<03:03,  4.07s/it]
test ppl:  81%|████████▏ | 192/236 [12:29<02:42,  3.69s/it]
test ppl:  82%|████████▏ | 193/236 [12:35<03:06,  4.34s/it]
test ppl:  82%|████████▏ | 194/236 [12:37<02:40,  3.82s/it]
test ppl:  83%|████████▎ | 195/236 [12:40<02:20,  3.44s/it]
test ppl:  83%|████████▎ | 196/236 [12:42<02:00,  3.02s/it]
test ppl:  83%|████████▎ | 197/236 [12:48<02:30,  3.87s/it]
test ppl:  84%|████████▍ | 198/236 [12:54<02:49,  4.46s/it]
test ppl:  84%|████████▍ | 199/236 [12:56<02:26,  3.96s/it]
test ppl:  85%|████████▍ | 200/236 [13:02<02:42,  4.53s/it]
test ppl:  85%|████████▌ | 201/236 [13:05<02:18,  3.94s/it]
test ppl:  86%|████████▌ | 202/236 [13:11<02:33,  4.50s/it]
test ppl:  86%|████████▌ | 203/236 [13:17<02:42,  4.92s/it]
test ppl:  86%|████████▋ | 204/236 [13:18<02:06,  3.96s/it]
test ppl:  87%|████████▋ | 205/236 [13:24<02:20,  4.54s/it]
test ppl:  87%|████████▋ | 206/236 [13:28<02:05,  4.19s/it]
test ppl:  88%|████████▊ | 207/236 [13:33<02:15,  4.69s/it]
test ppl:  88%|████████▊ | 208/236 [13:36<01:56,  4.16s/it]
test ppl:  89%|████████▊ | 209/236 [13:42<02:06,  4.69s/it]
test ppl:  89%|████████▉ | 210/236 [13:45<01:43,  3.99s/it]
test ppl:  89%|████████▉ | 211/236 [13:49<01:45,  4.21s/it]
test ppl:  90%|████████▉ | 212/236 [13:55<01:52,  4.69s/it]
test ppl:  90%|█████████ | 213/236 [14:01<01:55,  5.04s/it]
test ppl:  91%|█████████ | 214/236 [14:02<01:26,  3.93s/it]
test ppl:  91%|█████████ | 215/236 [14:08<01:34,  4.51s/it]
test ppl:  92%|█████████▏| 216/236 [14:10<01:13,  3.65s/it]
test ppl:  92%|█████████▏| 217/236 [14:16<01:22,  4.34s/it]
test ppl:  92%|█████████▏| 218/236 [14:18<01:04,  3.61s/it]
test ppl:  93%|█████████▎| 219/236 [14:24<01:12,  4.29s/it]
test ppl:  93%|█████████▎| 220/236 [14:29<01:16,  4.76s/it]
test ppl:  94%|█████████▎| 221/236 [14:31<00:57,  3.85s/it]
test ppl:  94%|█████████▍| 222/236 [14:37<01:02,  4.45s/it]
test ppl:  94%|█████████▍| 223/236 [14:43<01:03,  4.88s/it]
test ppl:  95%|█████████▍| 224/236 [14:49<01:02,  5.17s/it]
test ppl:  95%|█████████▌| 225/236 [14:53<00:53,  4.88s/it]
test ppl:  96%|█████████▌| 226/236 [14:55<00:40,  4.09s/it]
test ppl:  96%|█████████▌| 227/236 [14:58<00:33,  3.68s/it]
test ppl:  97%|█████████▋| 228/236 [15:00<00:24,  3.08s/it]
test ppl:  97%|█████████▋| 229/236 [15:05<00:27,  3.91s/it]
test ppl:  97%|█████████▋| 230/236 [15:10<00:23,  4.00s/it]
test ppl:  98%|█████████▊| 231/236 [15:13<00:19,  3.83s/it]
test ppl:  98%|█████████▊| 232/236 [15:15<00:12,  3.24s/it]
test ppl:  99%|█████████▊| 233/236 [15:18<00:09,  3.12s/it]
test ppl:  99%|█████████▉| 234/236 [15:19<00:05,  2.64s/it]
test ppl: 100%|█████████▉| 235/236 [15:25<00:03,  3.60s/it]
test ppl: 100%|██████████| 236/236 [15:26<00:00,  2.72s/it]
test ppl: 100%|██████████| 236/236 [15:26<00:00,  3.92s/it]
10/12/2024 17:01:11 - INFO - __main__ -    em: 0.1993
10/12/2024 17:01:11 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.6 50:  em: 0.1993

--------------------------------------------------------------------------------
Running experiment with knn_temp=50, lmbda=0.6, k=64
2024-10-12 17:01:18.288330: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 17:01:18.307981: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 17:01:18.329942: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 17:01:18.336606: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 17:01:18.352613: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 17:01:19.344375: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 17:01:20 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.6, knn_temp=50, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 17:01:20 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:35:09,  2.20it/s]
Adding feature api:   4%|▍         | 7213/187062 [00:00<00:10, 17265.84it/s]
Adding feature api:   8%|▊         | 15455/187062 [00:00<00:05, 33868.24it/s]
Adding feature api:  13%|█▎        | 23803/187062 [00:00<00:03, 47107.22it/s]
Adding feature api:  17%|█▋        | 32200/187062 [00:00<00:02, 57279.95it/s]
Adding feature api:  22%|██▏       | 40593/187062 [00:00<00:02, 64814.06it/s]
Adding feature api:  26%|██▌       | 49028/187062 [00:01<00:01, 70433.24it/s]
Adding feature api:  31%|███       | 57437/187062 [00:01<00:01, 74410.84it/s]
Adding feature api:  35%|███▌      | 65823/187062 [00:01<00:01, 77184.31it/s]
Adding feature api:  40%|███▉      | 74248/187062 [00:01<00:01, 79270.84it/s]
Adding feature api:  44%|████▍     | 82681/187062 [00:01<00:01, 80771.55it/s]
Adding feature api:  49%|████▊     | 91070/187062 [00:01<00:01, 81697.39it/s]
Adding feature api:  53%|█████▎    | 99414/187062 [00:01<00:01, 81647.10it/s]
Adding feature api:  58%|█████▊    | 107846/187062 [00:01<00:00, 82441.67it/s]
Adding feature api:  62%|██████▏   | 116279/187062 [00:01<00:00, 83001.90it/s]
Adding feature api:  67%|██████▋   | 124709/187062 [00:01<00:00, 83388.49it/s]
Adding feature api:  71%|███████   | 133143/187062 [00:02<00:00, 83669.13it/s]
Adding feature api:  76%|███████▌  | 141540/187062 [00:02<00:00, 83640.07it/s]
Adding feature api:  80%|████████  | 149925/187062 [00:02<00:00, 83629.46it/s]
Adding feature api:  85%|████████▍ | 158376/187062 [00:02<00:00, 83891.54it/s]
Adding feature api:  89%|████████▉ | 166800/187062 [00:02<00:00, 83993.83it/s]
Adding feature api:  94%|█████████▎| 175207/187062 [00:02<00:00, 83953.88it/s]
Adding feature api:  98%|█████████▊| 183608/187062 [00:02<00:00, 58109.79it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64322.92it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:38:26,  2.20it/s]
Adding feature datatype:   4%|▍         | 7071/187062 [00:00<00:10, 16895.69it/s]
Adding feature datatype:   8%|▊         | 15176/187062 [00:00<00:05, 33221.37it/s]
Adding feature datatype:  12%|█▏        | 23369/187062 [00:00<00:03, 46206.37it/s]
Adding feature datatype:  17%|█▋        | 31546/187062 [00:00<00:02, 56013.99it/s]
Adding feature datatype:  21%|██        | 39748/187062 [00:00<00:02, 63362.17it/s]
Adding feature datatype:  26%|██▌       | 47928/187062 [00:01<00:02, 68663.89it/s]
Adding feature datatype:  30%|███       | 56140/187062 [00:01<00:01, 72581.86it/s]
Adding feature datatype:  34%|███▍      | 64326/187062 [00:01<00:01, 75305.35it/s]
Adding feature datatype:  39%|███▉      | 72560/187062 [00:01<00:01, 77383.38it/s]
Adding feature datatype:  43%|████▎     | 80750/187062 [00:01<00:01, 78721.54it/s]
Adding feature datatype:  48%|████▊     | 88923/187062 [00:01<00:01, 79614.92it/s]
Adding feature datatype:  52%|█████▏    | 97155/187062 [00:01<00:01, 80420.21it/s]
Adding feature datatype:  56%|█████▋    | 105366/187062 [00:01<00:01, 80923.97it/s]
Adding feature datatype:  61%|██████    | 113581/187062 [00:01<00:00, 81289.65it/s]
Adding feature datatype:  65%|██████▌   | 121805/187062 [00:01<00:00, 81571.13it/s]
Adding feature datatype:  70%|██████▉   | 130017/187062 [00:02<00:00, 81733.68it/s]
Adding feature datatype:  74%|███████▍  | 138249/187062 [00:02<00:00, 81906.63it/s]
Adding feature datatype:  78%|███████▊  | 146482/187062 [00:02<00:00, 82031.70it/s]
Adding feature datatype:  83%|████████▎ | 154728/187062 [00:02<00:00, 82158.92it/s]
Adding feature datatype:  87%|████████▋ | 162954/187062 [00:02<00:00, 82107.71it/s]
Adding feature datatype:  92%|█████████▏| 171188/187062 [00:02<00:00, 82176.01it/s]
Adding feature datatype:  96%|█████████▌| 179411/187062 [00:02<00:00, 72930.52it/s]
Adding feature datatype: 100%|█████████▉| 186900/187062 [00:02<00:00, 51590.23it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63252.32it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:35:17,  2.20it/s]
Adding feature literal:   4%|▎         | 6974/187062 [00:00<00:10, 16692.19it/s]
Adding feature literal:   8%|▊         | 14901/187062 [00:00<00:05, 32637.40it/s]
Adding feature literal:  12%|█▏        | 22907/187062 [00:00<00:03, 45291.27it/s]
Adding feature literal:  17%|█▋        | 30919/187062 [00:00<00:02, 54903.38it/s]
Adding feature literal:  21%|██        | 38925/187062 [00:00<00:02, 62015.72it/s]
Adding feature literal:  25%|██▌       | 46964/187062 [00:01<00:02, 67302.16it/s]
Adding feature literal:  29%|██▉       | 55008/187062 [00:01<00:01, 71128.53it/s]
Adding feature literal:  34%|███▎      | 63063/187062 [00:01<00:01, 73894.44it/s]
Adding feature literal:  38%|███▊      | 70924/187062 [00:01<00:01, 75144.83it/s]
Adding feature literal:  42%|████▏     | 79016/187062 [00:01<00:01, 76854.90it/s]
Adding feature literal:  47%|████▋     | 87014/187062 [00:01<00:01, 77782.77it/s]
Adding feature literal:  51%|█████     | 95075/187062 [00:01<00:01, 78623.11it/s]
Adding feature literal:  55%|█████▌    | 103187/187062 [00:01<00:01, 79367.55it/s]
Adding feature literal:  59%|█████▉    | 111261/187062 [00:01<00:00, 79777.34it/s]
Adding feature literal:  64%|██████▍   | 119310/187062 [00:01<00:00, 79989.77it/s]
Adding feature literal:  68%|██████▊   | 127371/187062 [00:02<00:00, 80172.62it/s]
Adding feature literal:  72%|███████▏  | 135439/187062 [00:02<00:00, 80321.49it/s]
Adding feature literal:  77%|███████▋  | 143507/187062 [00:02<00:00, 80428.01it/s]
Adding feature literal:  81%|████████  | 151572/187062 [00:02<00:00, 80491.60it/s]
Adding feature literal:  85%|████████▌ | 159640/187062 [00:02<00:00, 80546.63it/s]
Adding feature literal:  90%|████████▉ | 167702/187062 [00:02<00:00, 80552.76it/s]
Adding feature literal:  94%|█████████▍| 175763/187062 [00:02<00:00, 79903.39it/s]
Adding feature literal:  98%|█████████▊| 183758/187062 [00:02<00:00, 55750.85it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 62297.36it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:36:07,  2.20it/s]
Adding feature operator:   4%|▍         | 7062/187062 [00:00<00:10, 16895.19it/s]
Adding feature operator:   8%|▊         | 15118/187062 [00:00<00:05, 33111.48it/s]
Adding feature operator:  12%|█▏        | 23256/187062 [00:00<00:03, 45988.90it/s]
Adding feature operator:  17%|█▋        | 31381/187062 [00:00<00:02, 55718.05it/s]
Adding feature operator:  21%|██        | 39508/187062 [00:00<00:02, 62940.76it/s]
Adding feature operator:  25%|██▌       | 47465/187062 [00:01<00:02, 67722.48it/s]
Adding feature operator:  30%|██▉       | 55592/187062 [00:01<00:01, 71667.58it/s]
Adding feature operator:  34%|███▍      | 63755/187062 [00:01<00:01, 74593.91it/s]
Adding feature operator:  38%|███▊      | 71906/187062 [00:01<00:01, 76636.19it/s]
Adding feature operator:  43%|████▎     | 80081/187062 [00:01<00:01, 78151.72it/s]
Adding feature operator:  47%|████▋     | 88249/187062 [00:01<00:01, 79200.48it/s]
Adding feature operator:  52%|█████▏    | 96405/187062 [00:01<00:01, 79902.73it/s]
Adding feature operator:  56%|█████▌    | 104514/187062 [00:01<00:01, 80215.07it/s]
Adding feature operator:  60%|██████    | 112725/187062 [00:01<00:00, 80780.04it/s]
Adding feature operator:  65%|██████▍   | 120866/187062 [00:01<00:00, 80967.28it/s]
Adding feature operator:  69%|██████▉   | 129004/187062 [00:02<00:00, 81005.03it/s]
Adding feature operator:  73%|███████▎  | 137165/187062 [00:02<00:00, 81182.75it/s]
Adding feature operator:  78%|███████▊  | 145306/187062 [00:02<00:00, 81248.08it/s]
Adding feature operator:  82%|████████▏ | 153445/187062 [00:02<00:00, 80772.71it/s]
Adding feature operator:  86%|████████▋ | 161621/187062 [00:02<00:00, 81063.83it/s]
Adding feature operator:  91%|█████████ | 169739/187062 [00:02<00:00, 81097.08it/s]
Adding feature operator:  95%|█████████▌| 177854/187062 [00:02<00:00, 80325.70it/s]
Adding feature operator:  99%|█████████▉| 185892/187062 [00:02<00:00, 52540.75it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 62856.16it/s]
[2024-10-12 17:02:04,182] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 17:02:05 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 17:02:05 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 417.95 examples/s]
Map:   2%|▏         | 106/6548 [00:00<00:25, 247.91 examples/s]
Map:   2%|▏         | 136/6548 [00:00<00:24, 259.35 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:21, 299.16 examples/s]
Map:   3%|▎         | 220/6548 [00:00<00:19, 331.82 examples/s]
Map:   4%|▍         | 272/6548 [00:00<00:18, 335.47 examples/s]
Map:   5%|▍         | 308/6548 [00:01<00:20, 298.10 examples/s]
Map:   5%|▌         | 350/6548 [00:01<00:19, 325.84 examples/s]
Map:   6%|▌         | 392/6548 [00:01<00:17, 348.61 examples/s]
Map:   7%|▋         | 436/6548 [00:01<00:16, 368.07 examples/s]
Map:   7%|▋         | 481/6548 [00:01<00:19, 314.80 examples/s]
Map:   8%|▊         | 516/6548 [00:01<00:18, 321.85 examples/s]
Map:   9%|▊         | 566/6548 [00:01<00:16, 365.45 examples/s]
Map:   9%|▉         | 605/6548 [00:01<00:16, 362.16 examples/s]
Map:  10%|▉         | 644/6548 [00:02<00:19, 309.62 examples/s]
Map:  11%|█         | 691/6548 [00:02<00:17, 340.92 examples/s]
Map:  11%|█         | 731/6548 [00:02<00:16, 349.73 examples/s]
Map:  12%|█▏        | 785/6548 [00:02<00:14, 394.17 examples/s]
Map:  13%|█▎        | 831/6548 [00:02<00:14, 388.14 examples/s]
Map:  13%|█▎        | 872/6548 [00:02<00:14, 392.30 examples/s]
Map:  14%|█▍        | 931/6548 [00:02<00:14, 379.10 examples/s]
Map:  15%|█▍        | 970/6548 [00:02<00:15, 363.64 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:25, 218.83 examples/s]
Map:  16%|█▌        | 1049/6548 [00:03<00:23, 238.05 examples/s]
Map:  17%|█▋        | 1088/6548 [00:03<00:20, 267.45 examples/s]
Map:  17%|█▋        | 1131/6548 [00:03<00:17, 301.89 examples/s]
Map:  18%|█▊        | 1175/6548 [00:03<00:16, 323.41 examples/s]
Map:  19%|█▊        | 1218/6548 [00:03<00:15, 344.56 examples/s]
Map:  19%|█▉        | 1258/6548 [00:03<00:15, 347.97 examples/s]
Map:  20%|█▉        | 1301/6548 [00:03<00:14, 359.39 examples/s]
Map:  21%|██        | 1344/6548 [00:04<00:17, 292.36 examples/s]
Map:  21%|██        | 1384/6548 [00:04<00:18, 282.81 examples/s]
Map:  22%|██▏       | 1423/6548 [00:04<00:16, 304.37 examples/s]
Map:  22%|██▏       | 1457/6548 [00:04<00:18, 281.34 examples/s]
Map:  23%|██▎       | 1496/6548 [00:04<00:18, 273.11 examples/s]
Map:  23%|██▎       | 1531/6548 [00:04<00:17, 289.49 examples/s]
Map:  24%|██▍       | 1577/6548 [00:05<00:17, 285.12 examples/s]
Map:  25%|██▍       | 1614/6548 [00:05<00:18, 268.87 examples/s]
Map:  25%|██▌       | 1645/6548 [00:05<00:17, 276.67 examples/s]
Map:  26%|██▌       | 1686/6548 [00:05<00:18, 268.36 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:16, 295.41 examples/s]
Map:  27%|██▋       | 1769/6548 [00:05<00:14, 323.44 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 333.46 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 341.84 examples/s]
Map:  29%|██▉       | 1896/6548 [00:06<00:14, 321.89 examples/s]
Map:  30%|██▉       | 1935/6548 [00:06<00:13, 331.56 examples/s]
Map:  30%|███       | 1981/6548 [00:06<00:12, 356.30 examples/s]
Map:  31%|███       | 2018/6548 [00:06<00:21, 211.64 examples/s]
Map:  31%|███▏      | 2049/6548 [00:06<00:19, 225.91 examples/s]
Map:  32%|███▏      | 2092/6548 [00:06<00:16, 262.40 examples/s]
Map:  32%|███▏      | 2126/6548 [00:06<00:16, 275.48 examples/s]
Map:  33%|███▎      | 2167/6548 [00:07<00:16, 258.20 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 277.67 examples/s]
Map:  34%|███▍      | 2247/6548 [00:07<00:17, 247.42 examples/s]
Map:  35%|███▍      | 2277/6548 [00:07<00:16, 256.12 examples/s]
Map:  35%|███▌      | 2321/6548 [00:07<00:14, 295.92 examples/s]
Map:  36%|███▌      | 2355/6548 [00:07<00:14, 284.65 examples/s]
Map:  36%|███▋      | 2389/6548 [00:07<00:14, 292.89 examples/s]
Map:  37%|███▋      | 2429/6548 [00:07<00:12, 319.50 examples/s]
Map:  38%|███▊      | 2477/6548 [00:08<00:13, 305.70 examples/s]
Map:  38%|███▊      | 2514/6548 [00:08<00:13, 310.28 examples/s]
Map:  39%|███▉      | 2554/6548 [00:08<00:12, 332.54 examples/s]
Map:  40%|███▉      | 2599/6548 [00:08<00:10, 362.35 examples/s]
Map:  40%|████      | 2641/6548 [00:08<00:10, 375.22 examples/s]
Map:  41%|████      | 2699/6548 [00:08<00:10, 367.07 examples/s]
Map:  42%|████▏     | 2737/6548 [00:08<00:10, 357.41 examples/s]
Map:  42%|████▏     | 2775/6548 [00:08<00:10, 361.63 examples/s]
Map:  43%|████▎     | 2826/6548 [00:09<00:10, 347.63 examples/s]
Map:  44%|████▍     | 2873/6548 [00:09<00:12, 283.92 examples/s]
Map:  44%|████▍     | 2904/6548 [00:09<00:13, 266.06 examples/s]
Map:  45%|████▍     | 2941/6548 [00:09<00:12, 285.84 examples/s]
Map:  46%|████▌     | 2988/6548 [00:09<00:12, 282.04 examples/s]
Map:  46%|████▌     | 3025/6548 [00:10<00:22, 159.91 examples/s]
Map:  47%|████▋     | 3061/6548 [00:10<00:18, 186.35 examples/s]
Map:  47%|████▋     | 3093/6548 [00:10<00:16, 208.42 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 246.59 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:13, 246.40 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 243.22 examples/s]
Map:  49%|████▉     | 3231/6548 [00:10<00:13, 249.34 examples/s]
Map:  50%|████▉     | 3269/6548 [00:11<00:12, 272.06 examples/s]
Map:  51%|█████     | 3324/6548 [00:11<00:10, 301.54 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:11<00:10, 297.39 examples/s]
Map:  52%|█████▏    | 3399/6548 [00:11<00:11, 263.30 examples/s]
Map:  53%|█████▎    | 3441/6548 [00:11<00:10, 296.90 examples/s]
Map:  53%|█████▎    | 3480/6548 [00:11<00:11, 268.20 examples/s]
Map:  54%|█████▍    | 3525/6548 [00:11<00:09, 307.72 examples/s]
Map:  54%|█████▍    | 3567/6548 [00:12<00:08, 332.81 examples/s]
Map:  55%|█████▌    | 3614/6548 [00:12<00:07, 366.84 examples/s]
Map:  56%|█████▌    | 3671/6548 [00:12<00:07, 366.59 examples/s]
Map:  57%|█████▋    | 3718/6548 [00:12<00:07, 386.14 examples/s]
Map:  58%|█████▊    | 3776/6548 [00:12<00:07, 382.11 examples/s]
Map:  58%|█████▊    | 3816/6548 [00:12<00:07, 385.34 examples/s]
Map:  59%|█████▉    | 3864/6548 [00:12<00:08, 328.72 examples/s]
Map:  60%|█████▉    | 3904/6548 [00:12<00:07, 343.60 examples/s]
Map:  60%|██████    | 3947/6548 [00:13<00:08, 317.84 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 238.52 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 291.31 examples/s]
Map:  63%|██████▎   | 4096/6548 [00:13<00:07, 315.69 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 325.84 examples/s]
Map:  64%|██████▍   | 4194/6548 [00:13<00:07, 327.54 examples/s]
Map:  65%|██████▍   | 4242/6548 [00:14<00:07, 323.59 examples/s]
Map:  65%|██████▌   | 4288/6548 [00:14<00:06, 351.77 examples/s]
Map:  66%|██████▌   | 4334/6548 [00:14<00:05, 374.47 examples/s]
Map:  67%|██████▋   | 4388/6548 [00:14<00:06, 357.84 examples/s]
Map:  68%|██████▊   | 4432/6548 [00:14<00:05, 371.11 examples/s]
Map:  68%|██████▊   | 4483/6548 [00:14<00:05, 346.34 examples/s]
Map:  69%|██████▉   | 4526/6548 [00:14<00:06, 318.11 examples/s]
Map:  70%|██████▉   | 4570/6548 [00:15<00:06, 308.34 examples/s]
Map:  70%|███████   | 4610/6548 [00:15<00:06, 315.44 examples/s]
Map:  71%|███████   | 4658/6548 [00:15<00:05, 352.93 examples/s]
Map:  72%|███████▏  | 4715/6548 [00:15<00:05, 357.50 examples/s]
Map:  73%|███████▎  | 4775/6548 [00:15<00:04, 366.96 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 380.84 examples/s]
Map:  75%|███████▍  | 4886/6548 [00:15<00:04, 378.80 examples/s]
Map:  75%|███████▌  | 4932/6548 [00:15<00:04, 384.81 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:16<00:03, 397.23 examples/s]
Map:  77%|███████▋  | 5038/6548 [00:16<00:05, 253.75 examples/s]
Map:  78%|███████▊  | 5082/6548 [00:16<00:05, 260.36 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 268.99 examples/s]
Map:  79%|███████▊  | 5149/6548 [00:16<00:05, 270.84 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:17<00:04, 280.50 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:17<00:04, 294.55 examples/s]
Map:  80%|████████  | 5256/6548 [00:17<00:04, 297.97 examples/s]
Map:  81%|████████  | 5312/6548 [00:17<00:03, 362.44 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 312.35 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 303.31 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 331.49 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 326.75 examples/s]
Map:  85%|████████▍ | 5548/6548 [00:18<00:02, 348.88 examples/s]
Map:  86%|████████▌ | 5602/6548 [00:18<00:03, 306.19 examples/s]
Map:  86%|████████▌ | 5646/6548 [00:18<00:02, 332.77 examples/s]
Map:  87%|████████▋ | 5691/6548 [00:18<00:02, 321.62 examples/s]
Map:  88%|████████▊ | 5731/6548 [00:18<00:02, 334.66 examples/s]
Map:  88%|████████▊ | 5772/6548 [00:18<00:02, 351.40 examples/s]
Map:  89%|████████▊ | 5809/6548 [00:18<00:02, 352.64 examples/s]
Map:  90%|████████▉ | 5862/6548 [00:19<00:01, 344.42 examples/s]
Map:  90%|█████████ | 5901/6548 [00:19<00:01, 355.21 examples/s]
Map:  91%|█████████ | 5944/6548 [00:19<00:01, 324.50 examples/s]
Map:  91%|█████████▏| 5987/6548 [00:19<00:01, 334.28 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 225.87 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 262.19 examples/s]
Map:  93%|█████████▎| 6120/6548 [00:20<00:01, 256.06 examples/s]
Map:  94%|█████████▍| 6167/6548 [00:20<00:01, 270.89 examples/s]
Map:  95%|█████████▍| 6198/6548 [00:20<00:01, 278.02 examples/s]
Map:  95%|█████████▌| 6247/6548 [00:20<00:00, 318.01 examples/s]
Map:  96%|█████████▋| 6303/6548 [00:20<00:00, 329.12 examples/s]
Map:  97%|█████████▋| 6340/6548 [00:20<00:00, 335.90 examples/s]
Map:  98%|█████████▊| 6386/6548 [00:20<00:00, 356.28 examples/s]
Map:  98%|█████████▊| 6425/6548 [00:20<00:00, 364.23 examples/s]
Map:  99%|█████████▉| 6472/6548 [00:20<00:00, 391.33 examples/s]
Map:  99%|█████████▉| 6515/6548 [00:21<00:00, 385.04 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 307.80 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 319.12 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 342.75 examples/s]
Map:  13%|█▎        | 116/903 [00:00<00:02, 339.01 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 354.34 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 405.53 examples/s]
Map:  29%|██▉       | 263/903 [00:00<00:01, 378.82 examples/s]
Map:  34%|███▍      | 308/903 [00:00<00:01, 393.93 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 340.09 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 313.82 examples/s]
Map:  51%|█████     | 460/903 [00:01<00:01, 312.89 examples/s]
Map:  57%|█████▋    | 516/903 [00:01<00:01, 327.07 examples/s]
Map:  62%|██████▏   | 561/903 [00:01<00:00, 348.88 examples/s]
Map:  68%|██████▊   | 613/903 [00:01<00:00, 374.07 examples/s]
Map:  75%|███████▍  | 673/903 [00:01<00:00, 378.21 examples/s]
Map:  79%|███████▉  | 717/903 [00:01<00:00, 384.57 examples/s]
Map:  85%|████████▍ | 766/903 [00:02<00:00, 403.85 examples/s]
Map:  91%|█████████ | 819/903 [00:02<00:00, 383.96 examples/s]
Map:  95%|█████████▌| 862/903 [00:02<00:00, 369.25 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 222.19 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 325.08 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 35/1882 [00:00<00:06, 270.75 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 343.91 examples/s]
Map:   7%|▋         | 124/1882 [00:00<00:05, 312.52 examples/s]
Map:   9%|▉         | 169/1882 [00:00<00:04, 351.36 examples/s]
Map:  12%|█▏        | 228/1882 [00:00<00:04, 352.82 examples/s]
Map:  14%|█▍        | 269/1882 [00:00<00:04, 366.76 examples/s]
Map:  17%|█▋        | 325/1882 [00:00<00:04, 360.77 examples/s]
Map:  19%|█▉        | 364/1882 [00:01<00:04, 324.91 examples/s]
Map:  22%|██▏       | 414/1882 [00:01<00:05, 285.97 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 294.77 examples/s]
Map:  26%|██▌       | 492/1882 [00:01<00:04, 326.69 examples/s]
Map:  28%|██▊       | 536/1882 [00:01<00:04, 299.13 examples/s]
Map:  31%|███       | 576/1882 [00:01<00:04, 318.21 examples/s]
Map:  34%|███▎      | 635/1882 [00:01<00:03, 380.27 examples/s]
Map:  36%|███▌      | 677/1882 [00:02<00:03, 378.46 examples/s]
Map:  39%|███▉      | 733/1882 [00:02<00:03, 371.96 examples/s]
Map:  41%|████      | 773/1882 [00:02<00:03, 356.90 examples/s]
Map:  44%|████▍     | 831/1882 [00:02<00:02, 363.78 examples/s]
Map:  46%|████▌     | 868/1882 [00:02<00:02, 363.58 examples/s]
Map:  48%|████▊     | 908/1882 [00:02<00:02, 367.44 examples/s]
Map:  51%|█████     | 961/1882 [00:02<00:02, 404.96 examples/s]
Map:  54%|█████▍    | 1015/1882 [00:03<00:03, 240.26 examples/s]
Map:  56%|█████▌    | 1053/1882 [00:03<00:03, 262.40 examples/s]
Map:  58%|█████▊    | 1098/1882 [00:03<00:02, 266.30 examples/s]
Map:  60%|██████    | 1130/1882 [00:03<00:02, 272.31 examples/s]
Map:  62%|██████▏   | 1175/1882 [00:03<00:02, 276.15 examples/s]
Map:  64%|██████▍   | 1206/1882 [00:03<00:02, 254.37 examples/s]
Map:  66%|██████▌   | 1243/1882 [00:03<00:02, 277.90 examples/s]
Map:  68%|██████▊   | 1274/1882 [00:04<00:02, 284.61 examples/s]
Map:  70%|██████▉   | 1317/1882 [00:04<00:01, 319.17 examples/s]
Map:  72%|███████▏  | 1358/1882 [00:04<00:01, 334.13 examples/s]
Map:  75%|███████▍  | 1411/1882 [00:04<00:01, 335.69 examples/s]
Map:  78%|███████▊  | 1469/1882 [00:04<00:01, 301.34 examples/s]
Map:  80%|███████▉  | 1502/1882 [00:04<00:01, 267.52 examples/s]
Map:  82%|████████▏ | 1544/1882 [00:04<00:01, 269.06 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:05<00:01, 293.96 examples/s]
Map:  86%|████████▋ | 1627/1882 [00:05<00:00, 326.45 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 327.41 examples/s]
Map:  91%|█████████ | 1716/1882 [00:05<00:00, 332.69 examples/s]
Map:  94%|█████████▎| 1763/1882 [00:05<00:00, 284.15 examples/s]
Map:  95%|█████████▌| 1794/1882 [00:05<00:00, 287.86 examples/s]
Map:  98%|█████████▊| 1841/1882 [00:05<00:00, 325.01 examples/s]
Map: 100%|█████████▉| 1880/1882 [00:05<00:00, 336.36 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 304.38 examples/s]
10/12/2024 17:03:07 - INFO - __main__ -     ***** Testing *****
10/12/2024 17:03:07 - INFO - __main__ -     Batch size = 8
10/12/2024 17:03:07 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 17:03:08 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 17:03:08 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 17:03:09 - INFO - knnlm -   Reading datastore took 0.9570310115814209 s
10/12/2024 17:03:10 - INFO - knnlm -   Moving index to GPU took 0.8948307037353516 s
10/12/2024 17:03:10 - INFO - __main__ -   ******************************break-into
10/12/2024 17:03:10 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 17:03:10 - INFO - __main__ -     Num examples = 236
10/12/2024 17:03:10 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:07,  7.44s/it]
test ppl:   1%|          | 2/236 [00:09<16:17,  4.18s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:37,  2.99s/it]
test ppl:   2%|▏         | 4/236 [00:16<15:55,  4.12s/it]
test ppl:   2%|▏         | 5/236 [00:22<18:15,  4.74s/it]
test ppl:   3%|▎         | 6/236 [00:28<19:39,  5.13s/it]
test ppl:   3%|▎         | 7/236 [00:30<15:31,  4.07s/it]
test ppl:   3%|▎         | 8/236 [00:35<16:45,  4.41s/it]
test ppl:   4%|▍         | 9/236 [00:41<18:24,  4.86s/it]
test ppl:   4%|▍         | 10/236 [00:44<15:54,  4.22s/it]
test ppl:   5%|▍         | 11/236 [00:46<13:19,  3.55s/it]
test ppl:   5%|▌         | 12/236 [00:52<15:52,  4.25s/it]
test ppl:   6%|▌         | 13/236 [00:57<17:36,  4.74s/it]
test ppl:   6%|▌         | 14/236 [01:03<18:48,  5.08s/it]
test ppl:   6%|▋         | 15/236 [01:05<14:30,  3.94s/it]
test ppl:   7%|▋         | 16/236 [01:06<12:07,  3.31s/it]
test ppl:   7%|▋         | 17/236 [01:11<12:55,  3.54s/it]
test ppl:   8%|▊         | 18/236 [01:14<13:04,  3.60s/it]
test ppl:   8%|▊         | 19/236 [01:20<15:29,  4.28s/it]
test ppl:   8%|▊         | 20/236 [01:23<13:32,  3.76s/it]
test ppl:   9%|▉         | 21/236 [01:24<11:23,  3.18s/it]
test ppl:   9%|▉         | 22/236 [01:30<14:13,  3.99s/it]
test ppl:  10%|▉         | 23/236 [01:33<12:34,  3.54s/it]
test ppl:  10%|█         | 24/236 [01:35<11:06,  3.14s/it]
test ppl:  11%|█         | 25/236 [01:41<13:54,  3.96s/it]
test ppl:  11%|█         | 26/236 [01:47<15:51,  4.53s/it]
test ppl:  11%|█▏        | 27/236 [01:50<14:38,  4.20s/it]
test ppl:  12%|█▏        | 28/236 [01:51<11:26,  3.30s/it]
test ppl:  12%|█▏        | 29/236 [01:53<10:03,  2.92s/it]
test ppl:  13%|█▎        | 30/236 [01:55<08:36,  2.51s/it]
test ppl:  13%|█▎        | 31/236 [01:57<08:02,  2.36s/it]
test ppl:  14%|█▎        | 32/236 [02:00<08:38,  2.54s/it]
test ppl:  14%|█▍        | 33/236 [02:03<08:56,  2.64s/it]
test ppl:  14%|█▍        | 34/236 [02:07<10:15,  3.05s/it]
test ppl:  15%|█▍        | 35/236 [02:13<13:01,  3.89s/it]
test ppl:  15%|█▌        | 36/236 [02:19<14:56,  4.48s/it]
test ppl:  16%|█▌        | 37/236 [02:24<16:15,  4.90s/it]
test ppl:  16%|█▌        | 38/236 [02:27<13:21,  4.05s/it]
test ppl:  17%|█▋        | 39/236 [02:28<11:06,  3.38s/it]
test ppl:  17%|█▋        | 40/236 [02:30<09:03,  2.77s/it]
test ppl:  17%|█▋        | 41/236 [02:32<08:07,  2.50s/it]
test ppl:  18%|█▊        | 42/236 [02:37<11:22,  3.52s/it]
test ppl:  18%|█▊        | 43/236 [02:43<13:33,  4.22s/it]
test ppl:  19%|█▊        | 44/236 [02:46<12:03,  3.77s/it]
test ppl:  19%|█▉        | 45/236 [02:48<10:08,  3.19s/it]
test ppl:  19%|█▉        | 46/236 [02:54<12:40,  4.00s/it]
test ppl:  20%|█▉        | 47/236 [02:55<10:16,  3.26s/it]
test ppl:  20%|██        | 48/236 [03:01<12:38,  4.03s/it]
test ppl:  21%|██        | 49/236 [03:05<12:34,  4.03s/it]
test ppl:  21%|██        | 50/236 [03:11<14:15,  4.60s/it]
test ppl:  22%|██▏       | 51/236 [03:17<15:22,  4.99s/it]
test ppl:  22%|██▏       | 52/236 [03:23<16:05,  5.25s/it]
test ppl:  22%|██▏       | 53/236 [03:27<14:58,  4.91s/it]
test ppl:  23%|██▎       | 54/236 [03:28<11:48,  3.89s/it]
test ppl:  23%|██▎       | 55/236 [03:34<13:19,  4.42s/it]
test ppl:  24%|██▎       | 56/236 [03:37<12:19,  4.11s/it]
test ppl:  24%|██▍       | 57/236 [03:40<10:38,  3.57s/it]
test ppl:  25%|██▍       | 58/236 [03:42<09:26,  3.18s/it]
test ppl:  25%|██▌       | 59/236 [03:48<11:45,  3.99s/it]
test ppl:  25%|██▌       | 60/236 [03:51<11:03,  3.77s/it]
test ppl:  26%|██▌       | 61/236 [03:57<12:48,  4.39s/it]
test ppl:  26%|██▋       | 62/236 [04:03<14:00,  4.83s/it]
test ppl:  27%|██▋       | 63/236 [04:05<11:52,  4.12s/it]
test ppl:  27%|██▋       | 64/236 [04:07<09:35,  3.34s/it]
test ppl:  28%|██▊       | 65/236 [04:08<07:47,  2.73s/it]
test ppl:  28%|██▊       | 66/236 [04:11<07:58,  2.82s/it]
test ppl:  28%|██▊       | 67/236 [04:17<10:30,  3.73s/it]
test ppl:  29%|██▉       | 68/236 [04:23<12:14,  4.37s/it]
test ppl:  29%|██▉       | 69/236 [04:29<13:24,  4.82s/it]
test ppl:  30%|██▉       | 70/236 [04:35<14:10,  5.13s/it]
test ppl:  30%|███       | 71/236 [04:38<12:43,  4.62s/it]
test ppl:  31%|███       | 72/236 [04:42<11:56,  4.37s/it]
test ppl:  31%|███       | 73/236 [04:48<13:04,  4.82s/it]
test ppl:  31%|███▏      | 74/236 [04:49<10:19,  3.82s/it]
test ppl:  32%|███▏      | 75/236 [04:55<11:53,  4.43s/it]
test ppl:  32%|███▏      | 76/236 [05:01<12:57,  4.86s/it]
test ppl:  33%|███▎      | 77/236 [05:05<12:03,  4.55s/it]
test ppl:  33%|███▎      | 78/236 [05:06<09:34,  3.64s/it]
test ppl:  33%|███▎      | 79/236 [05:10<09:44,  3.72s/it]
test ppl:  34%|███▍      | 80/236 [05:12<08:00,  3.08s/it]
test ppl:  34%|███▍      | 81/236 [05:18<10:04,  3.90s/it]
test ppl:  35%|███▍      | 82/236 [05:23<11:32,  4.50s/it]
test ppl:  35%|███▌      | 83/236 [05:27<10:27,  4.10s/it]
test ppl:  36%|███▌      | 84/236 [05:29<08:42,  3.44s/it]
test ppl:  36%|███▌      | 85/236 [05:33<09:14,  3.67s/it]
test ppl:  36%|███▋      | 86/236 [05:35<08:03,  3.23s/it]
test ppl:  37%|███▋      | 87/236 [05:37<07:10,  2.89s/it]
test ppl:  37%|███▋      | 88/236 [05:43<09:18,  3.78s/it]
test ppl:  38%|███▊      | 89/236 [05:49<10:47,  4.40s/it]
test ppl:  38%|███▊      | 90/236 [05:55<11:46,  4.84s/it]
test ppl:  39%|███▊      | 91/236 [06:00<11:44,  4.86s/it]
test ppl:  39%|███▉      | 92/236 [06:02<10:10,  4.24s/it]
test ppl:  39%|███▉      | 93/236 [06:08<11:15,  4.73s/it]
test ppl:  40%|███▉      | 94/236 [06:14<11:54,  5.03s/it]
test ppl:  40%|████      | 95/236 [06:17<10:07,  4.31s/it]
test ppl:  41%|████      | 96/236 [06:19<09:04,  3.89s/it]
test ppl:  41%|████      | 97/236 [06:25<10:22,  4.48s/it]
test ppl:  42%|████▏     | 98/236 [06:31<11:14,  4.89s/it]
test ppl:  42%|████▏     | 99/236 [06:37<11:49,  5.18s/it]
test ppl:  42%|████▏     | 100/236 [06:38<09:03,  3.99s/it]
test ppl:  43%|████▎     | 101/236 [06:44<10:14,  4.55s/it]
test ppl:  43%|████▎     | 102/236 [06:48<09:44,  4.36s/it]
test ppl:  44%|████▎     | 103/236 [06:49<07:42,  3.48s/it]
test ppl:  44%|████▍     | 104/236 [06:54<08:08,  3.70s/it]
test ppl:  44%|████▍     | 105/236 [06:58<08:14,  3.78s/it]
test ppl:  45%|████▍     | 106/236 [07:03<09:13,  4.25s/it]
test ppl:  45%|████▌     | 107/236 [07:05<07:48,  3.63s/it]
test ppl:  46%|████▌     | 108/236 [07:09<07:38,  3.59s/it]
test ppl:  46%|████▌     | 109/236 [07:14<08:38,  4.08s/it]
test ppl:  47%|████▋     | 110/236 [07:15<06:59,  3.33s/it]
test ppl:  47%|████▋     | 111/236 [07:19<07:22,  3.54s/it]
test ppl:  47%|████▋     | 112/236 [07:25<08:45,  4.24s/it]
test ppl:  48%|████▊     | 113/236 [07:27<07:09,  3.49s/it]
test ppl:  48%|████▊     | 114/236 [07:31<07:08,  3.51s/it]
test ppl:  49%|████▊     | 115/236 [07:36<08:29,  4.21s/it]
test ppl:  49%|████▉     | 116/236 [07:42<09:24,  4.71s/it]
test ppl:  50%|████▉     | 117/236 [07:44<07:38,  3.85s/it]
test ppl:  50%|█████     | 118/236 [07:49<08:19,  4.23s/it]
test ppl:  50%|█████     | 119/236 [07:51<07:01,  3.60s/it]
test ppl:  51%|█████     | 120/236 [07:53<05:44,  2.97s/it]
test ppl:  51%|█████▏    | 121/236 [07:59<07:20,  3.83s/it]
test ppl:  52%|█████▏    | 122/236 [08:05<08:25,  4.43s/it]
test ppl:  52%|█████▏    | 123/236 [08:10<09:09,  4.86s/it]
test ppl:  53%|█████▎    | 124/236 [08:13<07:33,  4.05s/it]
test ppl:  53%|█████▎    | 125/236 [08:19<08:29,  4.59s/it]
test ppl:  53%|█████▎    | 126/236 [08:22<07:55,  4.32s/it]
test ppl:  54%|█████▍    | 127/236 [08:28<08:41,  4.78s/it]
test ppl:  54%|█████▍    | 128/236 [08:30<07:02,  3.91s/it]
test ppl:  55%|█████▍    | 129/236 [08:32<06:15,  3.51s/it]
test ppl:  55%|█████▌    | 130/236 [08:36<06:05,  3.44s/it]
test ppl:  56%|█████▌    | 131/236 [08:43<08:01,  4.59s/it]
test ppl:  56%|█████▌    | 132/236 [08:50<09:19,  5.38s/it]
test ppl:  56%|█████▋    | 133/236 [08:55<08:57,  5.22s/it]
test ppl:  57%|█████▋    | 134/236 [08:59<08:21,  4.91s/it]
test ppl:  57%|█████▋    | 135/236 [09:07<09:27,  5.62s/it]
test ppl:  58%|█████▊    | 136/236 [09:08<07:21,  4.41s/it]
test ppl:  58%|█████▊    | 137/236 [09:15<08:42,  5.28s/it]
test ppl:  58%|█████▊    | 138/236 [09:20<08:14,  5.05s/it]
test ppl:  59%|█████▉    | 139/236 [09:23<07:09,  4.42s/it]
test ppl:  59%|█████▉    | 140/236 [09:25<05:56,  3.72s/it]
test ppl:  60%|█████▉    | 141/236 [09:30<06:22,  4.03s/it]
test ppl:  60%|██████    | 142/236 [09:32<05:38,  3.60s/it]
test ppl:  61%|██████    | 143/236 [09:40<07:16,  4.70s/it]
test ppl:  61%|██████    | 144/236 [09:43<06:34,  4.29s/it]
test ppl:  61%|██████▏   | 145/236 [09:48<06:59,  4.61s/it]
test ppl:  62%|██████▏   | 146/236 [09:55<07:53,  5.26s/it]
test ppl:  62%|██████▏   | 147/236 [10:02<08:41,  5.86s/it]
test ppl:  63%|██████▎   | 148/236 [10:10<09:15,  6.31s/it]
test ppl:  63%|██████▎   | 149/236 [10:17<09:34,  6.60s/it]
test ppl:  64%|██████▎   | 150/236 [10:24<09:45,  6.80s/it]
test ppl:  64%|██████▍   | 151/236 [10:32<09:49,  6.94s/it]
test ppl:  64%|██████▍   | 152/236 [10:39<09:50,  7.03s/it]
test ppl:  65%|██████▍   | 153/236 [10:46<09:48,  7.09s/it]
test ppl:  65%|██████▌   | 154/236 [10:48<07:30,  5.49s/it]
test ppl:  66%|██████▌   | 155/236 [10:51<06:28,  4.79s/it]
test ppl:  66%|██████▌   | 156/236 [10:54<05:38,  4.23s/it]
test ppl:  67%|██████▋   | 157/236 [10:56<04:35,  3.49s/it]
test ppl:  67%|██████▋   | 158/236 [11:03<05:59,  4.61s/it]
test ppl:  67%|██████▋   | 159/236 [11:10<06:55,  5.40s/it]
test ppl:  68%|██████▊   | 160/236 [11:13<05:43,  4.51s/it]
test ppl:  68%|██████▊   | 161/236 [11:14<04:33,  3.65s/it]
test ppl:  69%|██████▊   | 162/236 [11:17<04:06,  3.34s/it]
test ppl:  69%|██████▉   | 163/236 [11:19<03:33,  2.92s/it]
test ppl:  69%|██████▉   | 164/236 [11:24<04:13,  3.52s/it]
test ppl:  70%|██████▉   | 165/236 [11:27<04:13,  3.57s/it]
test ppl:  70%|███████   | 166/236 [11:30<03:55,  3.36s/it]
test ppl:  71%|███████   | 167/236 [11:32<03:19,  2.89s/it]
test ppl:  71%|███████   | 168/236 [11:37<04:05,  3.61s/it]
test ppl:  72%|███████▏  | 169/236 [11:43<04:36,  4.13s/it]
test ppl:  72%|███████▏  | 170/236 [11:50<05:35,  5.08s/it]
test ppl:  72%|███████▏  | 171/236 [11:52<04:23,  4.05s/it]
test ppl:  73%|███████▎  | 172/236 [11:59<05:21,  5.02s/it]
test ppl:  73%|███████▎  | 173/236 [12:03<05:02,  4.80s/it]
test ppl:  74%|███████▎  | 174/236 [12:10<05:44,  5.55s/it]
test ppl:  74%|███████▍  | 175/236 [12:13<04:38,  4.57s/it]
test ppl:  75%|███████▍  | 176/236 [12:20<05:21,  5.37s/it]
test ppl:  75%|███████▌  | 177/236 [12:27<05:50,  5.94s/it]
test ppl:  75%|███████▌  | 178/236 [12:35<06:08,  6.35s/it]
test ppl:  76%|███████▌  | 179/236 [12:42<06:17,  6.62s/it]
test ppl:  76%|███████▋  | 180/236 [12:47<05:39,  6.07s/it]
test ppl:  77%|███████▋  | 181/236 [12:53<05:37,  6.14s/it]
test ppl:  77%|███████▋  | 182/236 [12:55<04:29,  4.99s/it]
test ppl:  78%|███████▊  | 183/236 [12:57<03:36,  4.08s/it]
test ppl:  78%|███████▊  | 184/236 [12:59<02:55,  3.37s/it]
test ppl:  78%|███████▊  | 185/236 [13:06<03:52,  4.56s/it]
test ppl:  79%|███████▉  | 186/236 [13:08<03:14,  3.89s/it]
test ppl:  79%|███████▉  | 187/236 [13:16<04:01,  4.92s/it]
test ppl:  80%|███████▉  | 188/236 [13:23<04:30,  5.63s/it]
test ppl:  80%|████████  | 189/236 [13:30<04:47,  6.12s/it]
test ppl:  81%|████████  | 190/236 [13:36<04:29,  5.85s/it]
test ppl:  81%|████████  | 191/236 [13:40<04:06,  5.49s/it]
test ppl:  81%|████████▏ | 192/236 [13:43<03:31,  4.81s/it]
test ppl:  82%|████████▏ | 193/236 [13:46<02:51,  3.99s/it]
test ppl:  82%|████████▏ | 194/236 [13:49<02:37,  3.76s/it]
test ppl:  83%|████████▎ | 195/236 [13:53<02:34,  3.76s/it]
test ppl:  83%|████████▎ | 196/236 [13:55<02:14,  3.37s/it]
test ppl:  83%|████████▎ | 197/236 [13:58<02:02,  3.15s/it]
test ppl:  84%|████████▍ | 198/236 [14:05<02:46,  4.37s/it]
test ppl:  84%|████████▍ | 199/236 [14:09<02:35,  4.21s/it]
test ppl:  85%|████████▍ | 200/236 [14:16<03:04,  5.12s/it]
test ppl:  85%|████████▌ | 201/236 [14:19<02:38,  4.53s/it]
test ppl:  86%|████████▌ | 202/236 [14:26<03:01,  5.32s/it]
test ppl:  86%|████████▌ | 203/236 [14:33<03:14,  5.90s/it]
test ppl:  86%|████████▋ | 204/236 [14:36<02:32,  4.77s/it]
test ppl:  87%|████████▋ | 205/236 [14:43<02:51,  5.53s/it]
test ppl:  87%|████████▋ | 206/236 [14:47<02:32,  5.07s/it]
test ppl:  88%|████████▊ | 207/236 [14:54<02:46,  5.73s/it]
test ppl:  88%|████████▊ | 208/236 [14:58<02:20,  5.02s/it]
test ppl:  89%|████████▊ | 209/236 [15:05<02:34,  5.72s/it]
test ppl:  89%|████████▉ | 210/236 [15:08<02:06,  4.87s/it]
test ppl:  89%|████████▉ | 211/236 [15:14<02:09,  5.16s/it]
test ppl:  90%|████████▉ | 212/236 [15:21<02:18,  5.78s/it]
test ppl:  90%|█████████ | 213/236 [15:28<02:22,  6.21s/it]
test ppl:  91%|█████████ | 214/236 [15:30<01:46,  4.84s/it]
test ppl:  91%|█████████ | 215/236 [15:37<01:56,  5.56s/it]
test ppl:  92%|█████████▏| 216/236 [15:39<01:30,  4.50s/it]
test ppl:  92%|█████████▏| 217/236 [15:46<01:41,  5.36s/it]
test ppl:  92%|█████████▏| 218/236 [15:54<01:46,  5.92s/it]
test ppl:  93%|█████████▎| 219/236 [16:01<01:47,  6.33s/it]
test ppl:  93%|█████████▎| 220/236 [16:08<01:45,  6.61s/it]
test ppl:  94%|█████████▎| 221/236 [16:10<01:18,  5.26s/it]
test ppl:  94%|█████████▍| 222/236 [16:18<01:22,  5.87s/it]
test ppl:  94%|█████████▍| 223/236 [16:25<01:21,  6.29s/it]
test ppl:  95%|█████████▍| 224/236 [16:27<01:02,  5.18s/it]
test ppl:  95%|█████████▌| 225/236 [16:33<00:57,  5.18s/it]
test ppl:  96%|█████████▌| 226/236 [16:35<00:44,  4.46s/it]
test ppl:  96%|█████████▌| 227/236 [16:39<00:37,  4.14s/it]
test ppl:  97%|█████████▋| 228/236 [16:41<00:29,  3.66s/it]
test ppl:  97%|█████████▋| 229/236 [16:49<00:33,  4.73s/it]
test ppl:  97%|█████████▋| 230/236 [16:53<00:27,  4.59s/it]
test ppl:  98%|█████████▊| 231/236 [16:57<00:22,  4.45s/it]
test ppl:  98%|█████████▊| 232/236 [16:59<00:15,  3.80s/it]
test ppl:  99%|█████████▊| 233/236 [17:03<00:11,  3.73s/it]
test ppl:  99%|█████████▉| 234/236 [17:04<00:06,  3.06s/it]
test ppl: 100%|█████████▉| 235/236 [17:12<00:04,  4.32s/it]
test ppl: 100%|██████████| 236/236 [17:12<00:00,  3.26s/it]
test ppl: 100%|██████████| 236/236 [17:12<00:00,  4.38s/it]
10/12/2024 17:20:22 - INFO - __main__ -    em: 0.2040
10/12/2024 17:20:22 - INFO - __main__ -   Finish and take 19m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.6 50:  em: 0.2040

--------------------------------------------------------------------------------
Running experiment with knn_temp=100, lmbda=0.2, k=16
2024-10-12 17:20:29.944539: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 17:20:29.964156: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 17:20:29.985952: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 17:20:29.992595: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 17:20:30.008643: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 17:20:30.999384: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 17:20:32 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.2, knn_temp=100, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 17:20:32 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:35:54,  2.20it/s]
Adding feature api:   4%|▍         | 7170/187062 [00:00<00:10, 17155.55it/s]
Adding feature api:   8%|▊         | 15652/187062 [00:00<00:04, 34392.14it/s]
Adding feature api:  13%|█▎        | 24180/187062 [00:00<00:03, 47968.33it/s]
Adding feature api:  18%|█▊        | 32779/187062 [00:00<00:02, 58460.58it/s]
Adding feature api:  22%|██▏       | 41398/187062 [00:00<00:02, 66300.35it/s]
Adding feature api:  27%|██▋       | 50020/187062 [00:01<00:01, 72030.14it/s]
Adding feature api:  31%|███▏      | 58593/187062 [00:01<00:01, 76018.70it/s]
Adding feature api:  36%|███▌      | 67210/187062 [00:01<00:01, 79000.91it/s]
Adding feature api:  41%|████      | 75841/187062 [00:01<00:01, 81158.70it/s]
Adding feature api:  45%|████▌     | 84447/187062 [00:01<00:01, 82612.61it/s]
Adding feature api:  50%|████▉     | 93035/187062 [00:01<00:01, 83584.22it/s]
Adding feature api:  54%|█████▍    | 101664/187062 [00:01<00:01, 84389.54it/s]
Adding feature api:  59%|█████▉    | 110281/187062 [00:01<00:00, 84919.63it/s]
Adding feature api:  64%|██████▎   | 118861/187062 [00:01<00:00, 84627.98it/s]
Adding feature api:  68%|██████▊   | 127458/187062 [00:01<00:00, 85026.07it/s]
Adding feature api:  73%|███████▎  | 136078/187062 [00:02<00:00, 85373.73it/s]
Adding feature api:  77%|███████▋  | 144705/187062 [00:02<00:00, 85638.25it/s]
Adding feature api:  82%|████████▏ | 153386/187062 [00:02<00:00, 85986.07it/s]
Adding feature api:  87%|████████▋ | 162000/187062 [00:02<00:00, 85993.63it/s]
Adding feature api:  91%|█████████ | 170611/187062 [00:02<00:00, 85961.17it/s]
Adding feature api:  96%|█████████▌| 179215/187062 [00:02<00:00, 77569.65it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 65476.06it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:22:26,  2.22it/s]
Adding feature datatype:   4%|▍         | 7191/187062 [00:00<00:10, 17331.54it/s]
Adding feature datatype:   8%|▊         | 15406/187062 [00:00<00:05, 33932.95it/s]
Adding feature datatype:  13%|█▎        | 23676/187062 [00:00<00:03, 46995.55it/s]
Adding feature datatype:  17%|█▋        | 31916/187062 [00:00<00:02, 56793.00it/s]
Adding feature datatype:  21%|██▏       | 40191/187062 [00:00<00:02, 64145.61it/s]
Adding feature datatype:  26%|██▌       | 48506/187062 [00:01<00:01, 69619.24it/s]
Adding feature datatype:  30%|███       | 56795/187062 [00:01<00:01, 73487.49it/s]
Adding feature datatype:  35%|███▍      | 65073/187062 [00:01<00:01, 76217.01it/s]
Adding feature datatype:  39%|███▉      | 73346/187062 [00:01<00:01, 78142.58it/s]
Adding feature datatype:  44%|████▎     | 81657/187062 [00:01<00:01, 79615.86it/s]
Adding feature datatype:  48%|████▊     | 89930/187062 [00:01<00:01, 80542.23it/s]
Adding feature datatype:  52%|█████▏    | 98165/187062 [00:01<00:01, 81080.39it/s]
Adding feature datatype:  57%|█████▋    | 106490/187062 [00:01<00:00, 81727.55it/s]
Adding feature datatype:  61%|██████▏   | 114822/187062 [00:01<00:00, 82201.87it/s]
Adding feature datatype:  66%|██████▌   | 123141/187062 [00:01<00:00, 82496.47it/s]
Adding feature datatype:  70%|███████   | 131468/187062 [00:02<00:00, 82727.03it/s]
Adding feature datatype:  75%|███████▍  | 139785/187062 [00:02<00:00, 82852.55it/s]
Adding feature datatype:  79%|███████▉  | 148120/187062 [00:02<00:00, 82999.51it/s]
Adding feature datatype:  84%|████████▎ | 156435/187062 [00:02<00:00, 83009.65it/s]
Adding feature datatype:  88%|████████▊ | 164781/187062 [00:02<00:00, 83141.60it/s]
Adding feature datatype:  93%|█████████▎| 173184/187062 [00:02<00:00, 83407.30it/s]
Adding feature datatype:  97%|█████████▋| 181530/187062 [00:02<00:00, 65330.62it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63999.76it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:29:36,  2.21it/s]
Adding feature literal:   4%|▍         | 7183/187062 [00:00<00:10, 17245.16it/s]
Adding feature literal:   8%|▊         | 15355/187062 [00:00<00:05, 33710.97it/s]
Adding feature literal:  13%|█▎        | 23596/187062 [00:00<00:03, 46727.34it/s]
Adding feature literal:  17%|█▋        | 31838/187062 [00:00<00:02, 56590.21it/s]
Adding feature literal:  21%|██▏       | 40125/187062 [00:00<00:02, 64027.51it/s]
Adding feature literal:  26%|██▌       | 48341/187062 [00:01<00:02, 69246.23it/s]
Adding feature literal:  30%|███       | 56641/187062 [00:01<00:01, 73251.90it/s]
Adding feature literal:  35%|███▍      | 64961/187062 [00:01<00:01, 76175.46it/s]
Adding feature literal:  39%|███▉      | 73220/187062 [00:01<00:01, 78069.89it/s]
Adding feature literal:  44%|████▎     | 81514/187062 [00:01<00:01, 79513.20it/s]
Adding feature literal:  48%|████▊     | 89708/187062 [00:01<00:01, 79576.19it/s]
Adding feature literal:  52%|█████▏    | 98011/187062 [00:01<00:01, 80598.81it/s]
Adding feature literal:  57%|█████▋    | 106329/187062 [00:01<00:00, 81366.14it/s]
Adding feature literal:  61%|██████▏   | 114618/187062 [00:01<00:00, 81819.50it/s]
Adding feature literal:  66%|██████▌   | 122911/187062 [00:01<00:00, 82150.96it/s]
Adding feature literal:  70%|███████   | 131199/187062 [00:02<00:00, 82365.95it/s]
Adding feature literal:  75%|███████▍  | 139528/187062 [00:02<00:00, 82641.26it/s]
Adding feature literal:  79%|███████▉  | 147813/187062 [00:02<00:00, 82680.91it/s]
Adding feature literal:  83%|████████▎ | 156158/187062 [00:02<00:00, 82909.98it/s]
Adding feature literal:  88%|████████▊ | 164497/187062 [00:02<00:00, 83052.41it/s]
Adding feature literal:  92%|█████████▏| 172819/187062 [00:02<00:00, 83101.02it/s]
Adding feature literal:  97%|█████████▋| 181135/187062 [00:02<00:00, 67271.18it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63802.83it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:21:50,  2.22it/s]
Adding feature operator:   4%|▍         | 7176/187062 [00:00<00:10, 17301.06it/s]
Adding feature operator:   8%|▊         | 15441/187062 [00:00<00:05, 34039.49it/s]
Adding feature operator:  13%|█▎        | 23762/187062 [00:00<00:03, 47211.62it/s]
Adding feature operator:  17%|█▋        | 32129/187062 [00:00<00:02, 57301.36it/s]
Adding feature operator:  22%|██▏       | 40491/187062 [00:00<00:02, 64756.53it/s]
Adding feature operator:  26%|██▌       | 48837/187062 [00:01<00:01, 70143.39it/s]
Adding feature operator:  31%|███       | 57194/187062 [00:01<00:01, 74057.53it/s]
Adding feature operator:  35%|███▌      | 65611/187062 [00:01<00:01, 76422.49it/s]
Adding feature operator:  40%|███▉      | 73952/187062 [00:01<00:01, 78476.99it/s]
Adding feature operator:  44%|████▍     | 82314/187062 [00:01<00:01, 79996.25it/s]
Adding feature operator:  48%|████▊     | 90670/187062 [00:01<00:01, 81053.36it/s]
Adding feature operator:  53%|█████▎    | 99086/187062 [00:01<00:01, 81977.01it/s]
Adding feature operator:  57%|█████▋    | 107415/187062 [00:01<00:00, 82368.41it/s]
Adding feature operator:  62%|██████▏   | 115751/187062 [00:01<00:00, 82663.73it/s]
Adding feature operator:  66%|██████▋   | 124092/187062 [00:01<00:00, 82884.45it/s]
Adding feature operator:  71%|███████   | 132452/187062 [00:02<00:00, 83097.06it/s]
Adding feature operator:  75%|███████▌  | 140791/187062 [00:02<00:00, 83158.96it/s]
Adding feature operator:  80%|███████▉  | 149163/187062 [00:02<00:00, 83325.69it/s]
Adding feature operator:  84%|████████▍ | 157531/187062 [00:02<00:00, 83430.20it/s]
Adding feature operator:  89%|████████▊ | 165887/187062 [00:02<00:00, 83465.98it/s]
Adding feature operator:  93%|█████████▎| 174245/187062 [00:02<00:00, 83498.34it/s]
Adding feature operator:  98%|█████████▊| 182600/187062 [00:02<00:00, 60994.74it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 64232.03it/s]
[2024-10-12 17:21:15,746] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 17:21:17 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 17:21:17 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:16, 388.65 examples/s]
Map:   1%|          | 81/6548 [00:00<00:31, 204.90 examples/s]
Map:   2%|▏         | 125/6548 [00:00<00:24, 261.19 examples/s]
Map:   3%|▎         | 172/6548 [00:00<00:20, 314.20 examples/s]
Map:   3%|▎         | 221/6548 [00:00<00:20, 313.03 examples/s]
Map:   4%|▍         | 268/6548 [00:00<00:20, 307.40 examples/s]
Map:   5%|▍         | 304/6548 [00:01<00:19, 313.18 examples/s]
Map:   5%|▌         | 343/6548 [00:01<00:21, 290.51 examples/s]
Map:   6%|▌         | 385/6548 [00:01<00:19, 314.30 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:17, 347.07 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:19, 313.74 examples/s]
Map:   8%|▊         | 507/6548 [00:01<00:18, 321.27 examples/s]
Map:   9%|▊         | 557/6548 [00:01<00:16, 357.49 examples/s]
Map:   9%|▉         | 607/6548 [00:01<00:17, 341.54 examples/s]
Map:  10%|▉         | 646/6548 [00:02<00:19, 297.59 examples/s]
Map:  11%|█         | 691/6548 [00:02<00:17, 326.49 examples/s]
Map:  11%|█         | 731/6548 [00:02<00:17, 338.74 examples/s]
Map:  12%|█▏        | 785/6548 [00:02<00:15, 383.08 examples/s]
Map:  13%|█▎        | 831/6548 [00:02<00:14, 389.33 examples/s]
Map:  13%|█▎        | 877/6548 [00:02<00:14, 402.36 examples/s]
Map:  14%|█▍        | 923/6548 [00:02<00:15, 365.85 examples/s]
Map:  15%|█▍        | 961/6548 [00:02<00:15, 367.45 examples/s]
Map:  15%|█▌        | 1000/6548 [00:03<00:26, 212.85 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:23, 238.59 examples/s]
Map:  16%|█▋        | 1076/6548 [00:03<00:20, 265.03 examples/s]
Map:  17%|█▋        | 1122/6548 [00:03<00:17, 305.91 examples/s]
Map:  18%|█▊        | 1163/6548 [00:03<00:16, 329.27 examples/s]
Map:  18%|█▊        | 1205/6548 [00:03<00:15, 348.37 examples/s]
Map:  19%|█▉        | 1262/6548 [00:03<00:14, 354.45 examples/s]
Map:  20%|█▉        | 1301/6548 [00:04<00:14, 359.59 examples/s]
Map:  20%|██        | 1342/6548 [00:04<00:16, 321.67 examples/s]
Map:  21%|██        | 1381/6548 [00:04<00:17, 297.11 examples/s]
Map:  22%|██▏       | 1420/6548 [00:04<00:16, 316.93 examples/s]
Map:  22%|██▏       | 1459/6548 [00:04<00:17, 296.09 examples/s]
Map:  23%|██▎       | 1496/6548 [00:04<00:18, 278.12 examples/s]
Map:  23%|██▎       | 1531/6548 [00:04<00:17, 293.25 examples/s]
Map:  24%|██▍       | 1578/6548 [00:05<00:17, 288.86 examples/s]
Map:  25%|██▍       | 1608/6548 [00:05<00:17, 280.25 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:18, 263.87 examples/s]
Map:  26%|██▌       | 1686/6548 [00:05<00:18, 263.76 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:16, 293.53 examples/s]
Map:  27%|██▋       | 1770/6548 [00:05<00:14, 325.04 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 334.95 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 346.27 examples/s]
Map:  29%|██▉       | 1906/6548 [00:06<00:13, 337.25 examples/s]
Map:  30%|██▉       | 1963/6548 [00:06<00:13, 348.38 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:19, 234.68 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:18, 245.20 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:16, 275.13 examples/s]
Map:  32%|███▏      | 2107/6548 [00:06<00:15, 289.61 examples/s]
Map:  33%|███▎      | 2142/6548 [00:07<00:17, 258.05 examples/s]
Map:  33%|███▎      | 2179/6548 [00:07<00:15, 273.21 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 278.94 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:15, 275.24 examples/s]
Map:  35%|███▌      | 2293/6548 [00:07<00:14, 288.49 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:13, 314.66 examples/s]
Map:  36%|███▋      | 2377/6548 [00:07<00:13, 318.59 examples/s]
Map:  37%|███▋      | 2419/6548 [00:07<00:12, 343.26 examples/s]
Map:  38%|███▊      | 2459/6548 [00:08<00:12, 330.18 examples/s]
Map:  38%|███▊      | 2496/6548 [00:08<00:12, 332.24 examples/s]
Map:  39%|███▊      | 2537/6548 [00:08<00:11, 348.71 examples/s]
Map:  40%|███▉      | 2592/6548 [00:08<00:09, 396.10 examples/s]
Map:  41%|████      | 2653/6548 [00:08<00:09, 398.31 examples/s]
Map:  41%|████▏     | 2709/6548 [00:08<00:11, 344.19 examples/s]
Map:  42%|████▏     | 2761/6548 [00:08<00:11, 343.22 examples/s]
Map:  43%|████▎     | 2805/6548 [00:09<00:11, 324.63 examples/s]
Map:  43%|████▎     | 2844/6548 [00:09<00:13, 267.21 examples/s]
Map:  44%|████▍     | 2880/6548 [00:09<00:13, 281.44 examples/s]
Map:  45%|████▍     | 2922/6548 [00:09<00:13, 269.50 examples/s]
Map:  45%|████▌     | 2960/6548 [00:09<00:12, 283.60 examples/s]
Map:  46%|████▌     | 2991/6548 [00:09<00:14, 244.36 examples/s]
Map:  46%|████▌     | 3027/6548 [00:10<00:21, 163.45 examples/s]
Map:  47%|████▋     | 3062/6548 [00:10<00:18, 192.06 examples/s]
Map:  47%|████▋     | 3093/6548 [00:10<00:16, 212.80 examples/s]
Map:  48%|████▊     | 3133/6548 [00:10<00:13, 250.38 examples/s]
Map:  48%|████▊     | 3175/6548 [00:10<00:13, 257.40 examples/s]
Map:  49%|████▉     | 3216/6548 [00:10<00:13, 247.37 examples/s]
Map:  50%|████▉     | 3245/6548 [00:10<00:13, 250.32 examples/s]
Map:  50%|█████     | 3280/6548 [00:11<00:12, 268.99 examples/s]
Map:  51%|█████     | 3322/6548 [00:11<00:10, 301.56 examples/s]
Map:  51%|█████▏    | 3358/6548 [00:11<00:11, 276.50 examples/s]
Map:  52%|█████▏    | 3389/6548 [00:11<00:11, 265.94 examples/s]
Map:  52%|█████▏    | 3422/6548 [00:11<00:11, 280.38 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 271.51 examples/s]
Map:  53%|█████▎    | 3497/6548 [00:11<00:11, 274.06 examples/s]
Map:  54%|█████▍    | 3546/6548 [00:11<00:09, 322.86 examples/s]
Map:  55%|█████▍    | 3595/6548 [00:12<00:08, 364.17 examples/s]
Map:  56%|█████▌    | 3639/6548 [00:12<00:07, 378.23 examples/s]
Map:  57%|█████▋    | 3700/6548 [00:12<00:07, 383.20 examples/s]
Map:  57%|█████▋    | 3742/6548 [00:12<00:07, 390.35 examples/s]
Map:  58%|█████▊    | 3804/6548 [00:12<00:06, 396.40 examples/s]
Map:  59%|█████▉    | 3864/6548 [00:12<00:08, 332.41 examples/s]
Map:  60%|█████▉    | 3912/6548 [00:12<00:07, 362.13 examples/s]
Map:  60%|██████    | 3952/6548 [00:13<00:08, 324.04 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 243.50 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 295.11 examples/s]
Map:  63%|██████▎   | 4096/6548 [00:13<00:07, 317.96 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 329.00 examples/s]
Map:  64%|██████▍   | 4195/6548 [00:13<00:07, 333.20 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:06, 335.85 examples/s]
Map:  65%|██████▌   | 4276/6548 [00:14<00:06, 348.28 examples/s]
Map:  66%|██████▌   | 4318/6548 [00:14<00:06, 363.83 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:14<00:06, 343.17 examples/s]
Map:  67%|██████▋   | 4405/6548 [00:14<00:06, 347.56 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:05, 374.01 examples/s]
Map:  69%|██████▊   | 4498/6548 [00:14<00:06, 332.72 examples/s]
Map:  69%|██████▉   | 4546/6548 [00:14<00:06, 319.52 examples/s]
Map:  70%|███████   | 4584/6548 [00:15<00:06, 316.44 examples/s]
Map:  71%|███████   | 4626/6548 [00:15<00:05, 338.54 examples/s]
Map:  71%|███████▏  | 4668/6548 [00:15<00:05, 344.35 examples/s]
Map:  72%|███████▏  | 4728/6548 [00:15<00:05, 361.00 examples/s]
Map:  73%|███████▎  | 4768/6548 [00:15<00:04, 369.16 examples/s]
Map:  74%|███████▎  | 4820/6548 [00:15<00:04, 406.50 examples/s]
Map:  74%|███████▍  | 4875/6548 [00:15<00:04, 362.88 examples/s]
Map:  75%|███████▌  | 4913/6548 [00:15<00:04, 365.20 examples/s]
Map:  76%|███████▌  | 4969/6548 [00:15<00:03, 412.22 examples/s]
Map:  77%|███████▋  | 5013/6548 [00:16<00:06, 230.70 examples/s]
Map:  77%|███████▋  | 5055/6548 [00:16<00:05, 262.81 examples/s]
Map:  78%|███████▊  | 5101/6548 [00:16<00:05, 272.35 examples/s]
Map:  79%|███████▊  | 5141/6548 [00:16<00:05, 270.37 examples/s]
Map:  79%|███████▉  | 5178/6548 [00:16<00:04, 290.81 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:17<00:04, 292.11 examples/s]
Map:  81%|████████  | 5279/6548 [00:17<00:04, 312.09 examples/s]
Map:  81%|████████  | 5318/6548 [00:17<00:03, 327.33 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 297.87 examples/s]
Map:  83%|████████▎ | 5407/6548 [00:17<00:04, 285.11 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 317.20 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 318.12 examples/s]
Map:  85%|████████▍ | 5547/6548 [00:18<00:02, 342.68 examples/s]
Map:  85%|████████▌ | 5584/6548 [00:18<00:03, 306.51 examples/s]
Map:  86%|████████▌ | 5631/6548 [00:18<00:02, 344.00 examples/s]
Map:  87%|████████▋ | 5677/6548 [00:18<00:02, 327.26 examples/s]
Map:  88%|████████▊ | 5730/6548 [00:18<00:02, 329.44 examples/s]
Map:  88%|████████▊ | 5772/6548 [00:18<00:02, 345.67 examples/s]
Map:  89%|████████▊ | 5808/6548 [00:18<00:02, 344.81 examples/s]
Map:  89%|████████▉ | 5846/6548 [00:18<00:01, 351.92 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:19<00:01, 354.55 examples/s]
Map:  90%|█████████ | 5923/6548 [00:19<00:01, 364.16 examples/s]
Map:  91%|█████████ | 5966/6548 [00:19<00:01, 332.32 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 239.76 examples/s]
Map:  93%|█████████▎| 6075/6548 [00:19<00:01, 258.89 examples/s]
Map:  93%|█████████▎| 6112/6548 [00:19<00:01, 246.52 examples/s]
Map:  94%|█████████▍| 6147/6548 [00:20<00:01, 264.61 examples/s]
Map:  94%|█████████▍| 6186/6548 [00:20<00:01, 289.79 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:20<00:01, 307.94 examples/s]
Map:  96%|█████████▌| 6261/6548 [00:20<00:00, 321.14 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 338.41 examples/s]
Map:  97%|█████████▋| 6339/6548 [00:20<00:00, 345.33 examples/s]
Map:  98%|█████████▊| 6386/6548 [00:20<00:00, 366.84 examples/s]
Map:  98%|█████████▊| 6428/6548 [00:20<00:00, 376.81 examples/s]
Map:  99%|█████████▉| 6477/6548 [00:20<00:00, 404.70 examples/s]
Map: 100%|█████████▉| 6538/6548 [00:21<00:00, 396.47 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 308.58 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 328.03 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 350.23 examples/s]
Map:  13%|█▎        | 116/903 [00:00<00:02, 346.80 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 362.72 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 412.01 examples/s]
Map:  29%|██▉       | 263/903 [00:00<00:01, 382.40 examples/s]
Map:  34%|███▍      | 308/903 [00:00<00:01, 397.60 examples/s]
Map:  40%|███▉      | 357/903 [00:00<00:01, 340.59 examples/s]
Map:  44%|████▎     | 395/903 [00:01<00:01, 304.58 examples/s]
Map:  48%|████▊     | 436/903 [00:01<00:01, 306.74 examples/s]
Map:  53%|█████▎    | 475/903 [00:01<00:01, 319.83 examples/s]
Map:  59%|█████▉    | 531/903 [00:01<00:01, 333.11 examples/s]
Map:  63%|██████▎   | 570/903 [00:01<00:00, 343.86 examples/s]
Map:  68%|██████▊   | 614/903 [00:01<00:00, 365.18 examples/s]
Map:  72%|███████▏  | 653/903 [00:01<00:00, 370.78 examples/s]
Map:  77%|███████▋  | 696/903 [00:01<00:00, 380.75 examples/s]
Map:  82%|████████▏ | 736/903 [00:02<00:00, 383.85 examples/s]
Map:  88%|████████▊ | 792/903 [00:02<00:00, 375.88 examples/s]
Map:  92%|█████████▏| 831/903 [00:02<00:00, 375.80 examples/s]
Map:  98%|█████████▊| 884/903 [00:02<00:00, 390.76 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 327.01 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 299.16 examples/s]
Map:   4%|▍         | 79/1882 [00:00<00:05, 353.47 examples/s]
Map:   7%|▋         | 124/1882 [00:00<00:05, 322.15 examples/s]
Map:   9%|▉         | 166/1882 [00:00<00:04, 353.71 examples/s]
Map:  11%|█         | 203/1882 [00:00<00:05, 335.29 examples/s]
Map:  13%|█▎        | 253/1882 [00:00<00:04, 382.60 examples/s]
Map:  16%|█▋        | 310/1882 [00:00<00:04, 368.04 examples/s]
Map:  19%|█▊        | 350/1882 [00:00<00:04, 370.74 examples/s]
Map:  21%|██        | 396/1882 [00:01<00:04, 299.66 examples/s]
Map:  23%|██▎       | 442/1882 [00:01<00:04, 299.19 examples/s]
Map:  25%|██▌       | 479/1882 [00:01<00:04, 311.87 examples/s]
Map:  28%|██▊       | 534/1882 [00:01<00:04, 316.54 examples/s]
Map:  31%|███       | 576/1882 [00:01<00:03, 334.89 examples/s]
Map:  34%|███▎      | 634/1882 [00:01<00:03, 390.42 examples/s]
Map:  36%|███▌      | 677/1882 [00:01<00:03, 388.35 examples/s]
Map:  39%|███▉      | 733/1882 [00:02<00:03, 378.61 examples/s]
Map:  41%|████      | 773/1882 [00:02<00:03, 363.66 examples/s]
Map:  44%|████▍     | 831/1882 [00:02<00:02, 367.03 examples/s]
Map:  47%|████▋     | 892/1882 [00:02<00:02, 377.52 examples/s]
Map:  49%|████▉     | 930/1882 [00:02<00:02, 371.69 examples/s]
Map:  52%|█████▏    | 980/1882 [00:02<00:02, 401.76 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 256.29 examples/s]
Map:  58%|█████▊    | 1085/1882 [00:03<00:02, 266.31 examples/s]
Map:  60%|██████    | 1135/1882 [00:03<00:02, 279.92 examples/s]
Map:  62%|██████▏   | 1172/1882 [00:03<00:02, 296.69 examples/s]
Map:  64%|██████▍   | 1206/1882 [00:03<00:02, 272.35 examples/s]
Map:  66%|██████▋   | 1250/1882 [00:03<00:02, 306.46 examples/s]
Map:  69%|██████▉   | 1307/1882 [00:03<00:01, 318.31 examples/s]
Map:  72%|███████▏  | 1347/1882 [00:04<00:01, 332.79 examples/s]
Map:  74%|███████▍  | 1397/1882 [00:04<00:01, 329.35 examples/s]
Map:  77%|███████▋  | 1443/1882 [00:04<00:01, 302.23 examples/s]
Map:  78%|███████▊  | 1475/1882 [00:04<00:01, 294.74 examples/s]
Map:  80%|████████  | 1506/1882 [00:04<00:01, 283.23 examples/s]
Map:  82%|████████▏ | 1537/1882 [00:04<00:01, 288.55 examples/s]
Map:  84%|████████▎ | 1575/1882 [00:04<00:00, 310.23 examples/s]
Map:  86%|████████▌ | 1619/1882 [00:04<00:00, 340.08 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 338.02 examples/s]
Map:  91%|█████████ | 1712/1882 [00:05<00:00, 337.93 examples/s]
Map:  93%|█████████▎| 1749/1882 [00:05<00:00, 282.19 examples/s]
Map:  95%|█████████▍| 1779/1882 [00:05<00:00, 284.72 examples/s]
Map:  97%|█████████▋| 1820/1882 [00:05<00:00, 311.31 examples/s]
Map:  99%|█████████▉| 1859/1882 [00:05<00:00, 329.45 examples/s]
Map: 100%|██████████| 1882/1882 [00:05<00:00, 314.02 examples/s]
10/12/2024 17:22:18 - INFO - __main__ -     ***** Testing *****
10/12/2024 17:22:18 - INFO - __main__ -     Batch size = 8
10/12/2024 17:22:18 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 17:22:19 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 17:22:19 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 17:22:20 - INFO - knnlm -   Reading datastore took 0.9052772521972656 s
10/12/2024 17:22:21 - INFO - knnlm -   Moving index to GPU took 0.9031250476837158 s
10/12/2024 17:22:21 - INFO - __main__ -   ******************************break-into
10/12/2024 17:22:21 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 17:22:21 - INFO - __main__ -     Num examples = 236
10/12/2024 17:22:21 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:43,  7.84s/it]
test ppl:   1%|          | 2/236 [00:09<17:06,  4.39s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:56,  3.07s/it]
test ppl:   2%|▏         | 4/236 [00:12<09:43,  2.52s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:25,  3.75s/it]
test ppl:   3%|▎         | 6/236 [00:21<12:30,  3.26s/it]
test ppl:   3%|▎         | 7/236 [00:23<11:34,  3.03s/it]
test ppl:   3%|▎         | 8/236 [00:28<13:05,  3.44s/it]
test ppl:   4%|▍         | 9/236 [00:34<15:59,  4.23s/it]
test ppl:   4%|▍         | 10/236 [00:37<14:27,  3.84s/it]
test ppl:   5%|▍         | 11/236 [00:39<12:43,  3.39s/it]
test ppl:   5%|▌         | 12/236 [00:45<15:34,  4.17s/it]
test ppl:   6%|▌         | 13/236 [00:51<17:29,  4.71s/it]
test ppl:   6%|▌         | 14/236 [00:53<14:46,  3.99s/it]
test ppl:   6%|▋         | 15/236 [00:56<13:21,  3.63s/it]
test ppl:   7%|▋         | 16/236 [00:58<11:22,  3.10s/it]
test ppl:   7%|▋         | 17/236 [01:04<14:27,  3.96s/it]
test ppl:   8%|▊         | 18/236 [01:05<11:56,  3.28s/it]
test ppl:   8%|▊         | 19/236 [01:10<13:11,  3.65s/it]
test ppl:   8%|▊         | 20/236 [01:12<11:07,  3.09s/it]
test ppl:   9%|▉         | 21/236 [01:14<10:14,  2.86s/it]
test ppl:   9%|▉         | 22/236 [01:20<13:32,  3.80s/it]
test ppl:  10%|▉         | 23/236 [01:23<12:08,  3.42s/it]
test ppl:  10%|█         | 24/236 [01:25<10:59,  3.11s/it]
test ppl:  11%|█         | 25/236 [01:27<09:37,  2.74s/it]
test ppl:  11%|█         | 26/236 [01:33<12:57,  3.70s/it]
test ppl:  11%|█▏        | 27/236 [01:37<13:26,  3.86s/it]
test ppl:  12%|█▏        | 28/236 [01:38<10:52,  3.14s/it]
test ppl:  12%|█▏        | 29/236 [01:41<10:01,  2.91s/it]
test ppl:  13%|█▎        | 30/236 [01:42<08:34,  2.50s/it]
test ppl:  13%|█▎        | 31/236 [01:44<08:03,  2.36s/it]
test ppl:  14%|█▎        | 32/236 [01:47<08:34,  2.52s/it]
test ppl:  14%|█▍        | 33/236 [01:53<12:01,  3.55s/it]
test ppl:  14%|█▍        | 34/236 [01:57<12:27,  3.70s/it]
test ppl:  15%|█▍        | 35/236 [02:00<11:15,  3.36s/it]
test ppl:  15%|█▌        | 36/236 [02:06<13:46,  4.13s/it]
test ppl:  16%|█▌        | 37/236 [02:12<15:30,  4.68s/it]
test ppl:  16%|█▌        | 38/236 [02:14<12:52,  3.90s/it]
test ppl:  17%|█▋        | 39/236 [02:15<10:27,  3.19s/it]
test ppl:  17%|█▋        | 40/236 [02:18<10:05,  3.09s/it]
test ppl:  17%|█▋        | 41/236 [02:21<09:30,  2.92s/it]
test ppl:  18%|█▊        | 42/236 [02:27<12:24,  3.84s/it]
test ppl:  18%|█▊        | 43/236 [02:33<14:21,  4.47s/it]
test ppl:  19%|█▊        | 44/236 [02:35<12:14,  3.83s/it]
test ppl:  19%|█▉        | 45/236 [02:37<10:25,  3.28s/it]
test ppl:  19%|█▉        | 46/236 [02:43<12:56,  4.09s/it]
test ppl:  20%|█▉        | 47/236 [02:49<14:40,  4.66s/it]
test ppl:  20%|██        | 48/236 [02:55<15:48,  5.04s/it]
test ppl:  21%|██        | 49/236 [03:01<16:33,  5.31s/it]
test ppl:  21%|██        | 50/236 [03:07<17:07,  5.52s/it]
test ppl:  22%|██▏       | 51/236 [03:11<16:04,  5.22s/it]
test ppl:  22%|██▏       | 52/236 [03:17<16:39,  5.43s/it]
test ppl:  22%|██▏       | 53/236 [03:22<15:39,  5.13s/it]
test ppl:  23%|██▎       | 54/236 [03:23<12:18,  4.06s/it]
test ppl:  23%|██▎       | 55/236 [03:29<13:42,  4.54s/it]
test ppl:  24%|██▎       | 56/236 [03:32<12:38,  4.21s/it]
test ppl:  24%|██▍       | 57/236 [03:35<11:06,  3.72s/it]
test ppl:  25%|██▍       | 58/236 [03:37<09:07,  3.08s/it]
test ppl:  25%|██▌       | 59/236 [03:43<11:35,  3.93s/it]
test ppl:  25%|██▌       | 60/236 [03:46<10:55,  3.73s/it]
test ppl:  26%|██▌       | 61/236 [03:52<12:47,  4.39s/it]
test ppl:  26%|██▋       | 62/236 [03:56<12:31,  4.32s/it]
test ppl:  27%|██▋       | 63/236 [03:59<11:41,  4.06s/it]
test ppl:  27%|██▋       | 64/236 [04:01<09:27,  3.30s/it]
test ppl:  28%|██▊       | 65/236 [04:02<07:43,  2.71s/it]
test ppl:  28%|██▊       | 66/236 [04:05<07:55,  2.80s/it]
test ppl:  28%|██▊       | 67/236 [04:10<10:01,  3.56s/it]
test ppl:  29%|██▉       | 68/236 [04:16<11:58,  4.27s/it]
test ppl:  29%|██▉       | 69/236 [04:21<12:11,  4.38s/it]
test ppl:  30%|██▉       | 70/236 [04:23<09:49,  3.55s/it]
test ppl:  30%|███       | 71/236 [04:26<09:49,  3.58s/it]
test ppl:  31%|███       | 72/236 [04:30<10:00,  3.66s/it]
test ppl:  31%|███       | 73/236 [04:34<10:08,  3.73s/it]
test ppl:  31%|███▏      | 74/236 [04:36<08:17,  3.07s/it]
test ppl:  32%|███▏      | 75/236 [04:42<10:33,  3.93s/it]
test ppl:  32%|███▏      | 76/236 [04:46<10:55,  4.10s/it]
test ppl:  33%|███▎      | 77/236 [04:48<09:26,  3.56s/it]
test ppl:  33%|███▎      | 78/236 [04:50<08:05,  3.07s/it]
test ppl:  33%|███▎      | 79/236 [04:55<09:36,  3.67s/it]
test ppl:  34%|███▍      | 80/236 [04:57<08:12,  3.15s/it]
test ppl:  34%|███▍      | 81/236 [05:03<10:17,  3.99s/it]
test ppl:  35%|███▍      | 82/236 [05:09<11:46,  4.58s/it]
test ppl:  35%|███▌      | 83/236 [05:11<09:44,  3.82s/it]
test ppl:  36%|███▌      | 84/236 [05:13<08:13,  3.25s/it]
test ppl:  36%|███▌      | 85/236 [05:17<08:52,  3.53s/it]
test ppl:  36%|███▋      | 86/236 [05:20<07:50,  3.14s/it]
test ppl:  37%|███▋      | 87/236 [05:22<07:29,  3.01s/it]
test ppl:  37%|███▋      | 88/236 [05:28<09:35,  3.89s/it]
test ppl:  38%|███▊      | 89/236 [05:31<08:47,  3.59s/it]
test ppl:  38%|███▊      | 90/236 [05:37<10:26,  4.29s/it]
test ppl:  39%|███▊      | 91/236 [05:43<11:33,  4.78s/it]
test ppl:  39%|███▉      | 92/236 [05:46<10:04,  4.20s/it]
test ppl:  39%|███▉      | 93/236 [05:52<11:15,  4.72s/it]
test ppl:  40%|███▉      | 94/236 [05:58<12:02,  5.09s/it]
test ppl:  40%|████      | 95/236 [06:02<11:34,  4.93s/it]
test ppl:  41%|████      | 96/236 [06:05<10:08,  4.35s/it]
test ppl:  41%|████      | 97/236 [06:11<11:10,  4.83s/it]
test ppl:  42%|████▏     | 98/236 [06:17<11:52,  5.16s/it]
test ppl:  42%|████▏     | 99/236 [06:23<12:19,  5.40s/it]
test ppl:  42%|████▏     | 100/236 [06:24<09:28,  4.18s/it]
test ppl:  43%|████▎     | 101/236 [06:30<10:35,  4.71s/it]
test ppl:  43%|████▎     | 102/236 [06:34<09:49,  4.40s/it]
test ppl:  44%|████▎     | 103/236 [06:36<08:15,  3.72s/it]
test ppl:  44%|████▍     | 104/236 [06:40<08:35,  3.90s/it]
test ppl:  44%|████▍     | 105/236 [06:44<08:33,  3.92s/it]
test ppl:  45%|████▍     | 106/236 [06:50<09:30,  4.39s/it]
test ppl:  45%|████▌     | 107/236 [06:52<07:56,  3.69s/it]
test ppl:  46%|████▌     | 108/236 [06:58<09:12,  4.32s/it]
test ppl:  46%|████▌     | 109/236 [07:03<09:24,  4.44s/it]
test ppl:  47%|████▋     | 110/236 [07:04<07:41,  3.66s/it]
test ppl:  47%|████▋     | 111/236 [07:08<07:50,  3.76s/it]
test ppl:  47%|████▋     | 112/236 [07:13<08:05,  3.92s/it]
test ppl:  48%|████▊     | 113/236 [07:14<06:42,  3.28s/it]
test ppl:  48%|████▊     | 114/236 [07:18<06:43,  3.30s/it]
test ppl:  49%|████▊     | 115/236 [07:24<08:15,  4.09s/it]
test ppl:  49%|████▉     | 116/236 [07:29<09:06,  4.55s/it]
test ppl:  50%|████▉     | 117/236 [07:31<07:25,  3.75s/it]
test ppl:  50%|█████     | 118/236 [07:35<07:38,  3.88s/it]
test ppl:  50%|█████     | 119/236 [07:39<07:15,  3.72s/it]
test ppl:  51%|█████     | 120/236 [07:40<05:49,  3.01s/it]
test ppl:  51%|█████▏    | 121/236 [07:46<07:27,  3.89s/it]
test ppl:  52%|█████▏    | 122/236 [07:51<07:56,  4.18s/it]
test ppl:  52%|█████▏    | 123/236 [07:53<06:44,  3.58s/it]
test ppl:  53%|█████▎    | 124/236 [07:56<06:14,  3.35s/it]
test ppl:  53%|█████▎    | 125/236 [07:58<05:44,  3.10s/it]
test ppl:  53%|█████▎    | 126/236 [08:02<06:02,  3.29s/it]
test ppl:  54%|█████▍    | 127/236 [08:04<05:13,  2.88s/it]
test ppl:  54%|█████▍    | 128/236 [08:06<04:51,  2.70s/it]
test ppl:  55%|█████▍    | 129/236 [08:11<05:36,  3.14s/it]
test ppl:  55%|█████▌    | 130/236 [08:14<05:30,  3.12s/it]
test ppl:  56%|█████▌    | 131/236 [08:20<06:57,  3.97s/it]
test ppl:  56%|█████▌    | 132/236 [08:22<06:07,  3.53s/it]
test ppl:  56%|█████▋    | 133/236 [08:26<06:17,  3.66s/it]
test ppl:  57%|█████▋    | 134/236 [08:32<07:14,  4.26s/it]
test ppl:  57%|█████▋    | 135/236 [08:38<08:00,  4.76s/it]
test ppl:  58%|█████▊    | 136/236 [08:39<06:11,  3.72s/it]
test ppl:  58%|█████▊    | 137/236 [08:45<07:14,  4.39s/it]
test ppl:  58%|█████▊    | 138/236 [08:48<06:36,  4.05s/it]
test ppl:  59%|█████▉    | 139/236 [08:51<05:50,  3.62s/it]
test ppl:  59%|█████▉    | 140/236 [08:52<04:53,  3.06s/it]
test ppl:  60%|█████▉    | 141/236 [08:58<05:51,  3.70s/it]
test ppl:  60%|██████    | 142/236 [09:00<05:03,  3.23s/it]
test ppl:  61%|██████    | 143/236 [09:06<06:17,  4.06s/it]
test ppl:  61%|██████    | 144/236 [09:09<05:37,  3.67s/it]
test ppl:  61%|██████▏   | 145/236 [09:14<06:25,  4.24s/it]
test ppl:  62%|██████▏   | 146/236 [09:19<06:30,  4.33s/it]
test ppl:  62%|██████▏   | 147/236 [09:25<07:09,  4.83s/it]
test ppl:  63%|██████▎   | 148/236 [09:31<07:37,  5.20s/it]
test ppl:  63%|██████▎   | 149/236 [09:34<06:46,  4.67s/it]
test ppl:  64%|██████▎   | 150/236 [09:38<06:24,  4.47s/it]
test ppl:  64%|██████▍   | 151/236 [09:44<06:58,  4.92s/it]
test ppl:  64%|██████▍   | 152/236 [09:50<07:18,  5.22s/it]
test ppl:  65%|██████▍   | 153/236 [09:56<07:31,  5.44s/it]
test ppl:  65%|██████▌   | 154/236 [09:59<06:14,  4.57s/it]
test ppl:  66%|██████▌   | 155/236 [10:01<05:25,  4.02s/it]
test ppl:  66%|██████▌   | 156/236 [10:04<04:37,  3.47s/it]
test ppl:  67%|██████▋   | 157/236 [10:06<04:04,  3.10s/it]
test ppl:  67%|██████▋   | 158/236 [10:12<05:08,  3.96s/it]
test ppl:  67%|██████▋   | 159/236 [10:16<05:02,  3.93s/it]
test ppl:  68%|██████▊   | 160/236 [10:17<03:56,  3.11s/it]
test ppl:  68%|██████▊   | 161/236 [10:18<03:14,  2.59s/it]
test ppl:  69%|██████▊   | 162/236 [10:21<03:24,  2.76s/it]
test ppl:  69%|██████▉   | 163/236 [10:24<03:17,  2.70s/it]
test ppl:  69%|██████▉   | 164/236 [10:28<03:35,  3.00s/it]
test ppl:  70%|██████▉   | 165/236 [10:32<03:59,  3.37s/it]
test ppl:  70%|███████   | 166/236 [10:35<03:55,  3.37s/it]
test ppl:  71%|███████   | 167/236 [10:37<03:13,  2.81s/it]
test ppl:  71%|███████   | 168/236 [10:41<03:42,  3.27s/it]
test ppl:  72%|███████▏  | 169/236 [10:46<04:24,  3.94s/it]
test ppl:  72%|███████▏  | 170/236 [10:52<05:00,  4.55s/it]
test ppl:  72%|███████▏  | 171/236 [10:54<03:53,  3.59s/it]
test ppl:  73%|███████▎  | 172/236 [11:00<04:35,  4.30s/it]
test ppl:  73%|███████▎  | 173/236 [11:03<04:16,  4.07s/it]
test ppl:  74%|███████▎  | 174/236 [11:07<04:09,  4.03s/it]
test ppl:  74%|███████▍  | 175/236 [11:09<03:26,  3.38s/it]
test ppl:  75%|███████▍  | 176/236 [11:14<03:50,  3.84s/it]
test ppl:  75%|███████▌  | 177/236 [11:20<04:24,  4.48s/it]
test ppl:  75%|███████▌  | 178/236 [11:26<04:46,  4.93s/it]
test ppl:  76%|███████▌  | 179/236 [11:32<04:58,  5.24s/it]
test ppl:  76%|███████▋  | 180/236 [11:37<04:43,  5.06s/it]
test ppl:  77%|███████▋  | 181/236 [11:42<04:52,  5.32s/it]
test ppl:  77%|███████▋  | 182/236 [11:44<03:52,  4.30s/it]
test ppl:  78%|███████▊  | 183/236 [11:47<03:15,  3.70s/it]
test ppl:  78%|███████▊  | 184/236 [11:48<02:37,  3.03s/it]
test ppl:  78%|███████▊  | 185/236 [11:53<02:56,  3.45s/it]
test ppl:  79%|███████▉  | 186/236 [11:59<03:29,  4.20s/it]
test ppl:  79%|███████▉  | 187/236 [12:05<03:52,  4.75s/it]
test ppl:  80%|███████▉  | 188/236 [12:11<04:05,  5.11s/it]
test ppl:  80%|████████  | 189/236 [12:16<04:11,  5.36s/it]
test ppl:  81%|████████  | 190/236 [12:21<03:50,  5.01s/it]
test ppl:  81%|████████  | 191/236 [12:25<03:37,  4.82s/it]
test ppl:  81%|████████▏ | 192/236 [12:28<03:03,  4.18s/it]
test ppl:  82%|████████▏ | 193/236 [12:34<03:22,  4.71s/it]
test ppl:  82%|████████▏ | 194/236 [12:36<02:52,  4.10s/it]
test ppl:  83%|████████▎ | 195/236 [12:39<02:35,  3.80s/it]
test ppl:  83%|████████▎ | 196/236 [12:41<02:10,  3.27s/it]
test ppl:  83%|████████▎ | 197/236 [12:44<01:54,  2.93s/it]
test ppl:  84%|████████▍ | 198/236 [12:50<02:25,  3.83s/it]
test ppl:  84%|████████▍ | 199/236 [12:52<02:09,  3.51s/it]
test ppl:  85%|████████▍ | 200/236 [12:58<02:33,  4.28s/it]
test ppl:  85%|████████▌ | 201/236 [13:00<02:06,  3.61s/it]
test ppl:  86%|████████▌ | 202/236 [13:05<02:13,  3.93s/it]
test ppl:  86%|████████▌ | 203/236 [13:11<02:29,  4.54s/it]
test ppl:  86%|████████▋ | 204/236 [13:13<01:55,  3.62s/it]
test ppl:  87%|████████▋ | 205/236 [13:19<02:14,  4.33s/it]
test ppl:  87%|████████▋ | 206/236 [13:22<02:01,  4.03s/it]
test ppl:  88%|████████▊ | 207/236 [13:28<02:13,  4.61s/it]
test ppl:  88%|████████▊ | 208/236 [13:31<01:57,  4.18s/it]
test ppl:  89%|████████▊ | 209/236 [13:37<02:07,  4.73s/it]
test ppl:  89%|████████▉ | 210/236 [13:39<01:44,  4.03s/it]
test ppl:  89%|████████▉ | 211/236 [13:44<01:46,  4.27s/it]
test ppl:  90%|████████▉ | 212/236 [13:50<01:54,  4.77s/it]
test ppl:  90%|█████████ | 213/236 [13:56<01:57,  5.12s/it]
test ppl:  91%|█████████ | 214/236 [13:58<01:29,  4.08s/it]
test ppl:  91%|█████████ | 215/236 [14:04<01:37,  4.65s/it]
test ppl:  92%|█████████▏| 216/236 [14:06<01:20,  4.03s/it]
test ppl:  92%|█████████▏| 217/236 [14:12<01:27,  4.63s/it]
test ppl:  92%|█████████▏| 218/236 [14:14<01:08,  3.83s/it]
test ppl:  93%|█████████▎| 219/236 [14:20<01:16,  4.48s/it]
test ppl:  93%|█████████▎| 220/236 [14:26<01:18,  4.92s/it]
test ppl:  94%|█████████▎| 221/236 [14:29<01:05,  4.39s/it]
test ppl:  94%|█████████▍| 222/236 [14:35<01:08,  4.86s/it]
test ppl:  94%|█████████▍| 223/236 [14:41<01:07,  5.19s/it]
test ppl:  95%|█████████▍| 224/236 [14:43<00:48,  4.03s/it]
test ppl:  95%|█████████▌| 225/236 [14:49<00:50,  4.60s/it]
test ppl:  96%|█████████▌| 226/236 [14:52<00:42,  4.29s/it]
test ppl:  96%|█████████▌| 227/236 [14:55<00:33,  3.73s/it]
test ppl:  97%|█████████▋| 228/236 [14:57<00:25,  3.22s/it]
test ppl:  97%|█████████▋| 229/236 [15:03<00:28,  4.03s/it]
test ppl:  97%|█████████▋| 230/236 [15:06<00:23,  3.89s/it]
test ppl:  98%|█████████▊| 231/236 [15:09<00:18,  3.74s/it]
test ppl:  98%|█████████▊| 232/236 [15:11<00:12,  3.15s/it]
test ppl:  99%|█████████▊| 233/236 [15:13<00:08,  2.85s/it]
test ppl:  99%|█████████▉| 234/236 [15:15<00:04,  2.36s/it]
test ppl: 100%|█████████▉| 235/236 [15:21<00:03,  3.44s/it]
test ppl: 100%|██████████| 236/236 [15:21<00:00,  2.60s/it]
test ppl: 100%|██████████| 236/236 [15:21<00:00,  3.91s/it]
10/12/2024 17:37:43 - INFO - __main__ -    em: 0.2099
10/12/2024 17:37:43 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.2 100:  em: 0.2099

--------------------------------------------------------------------------------
Running experiment with knn_temp=100, lmbda=0.2, k=32
2024-10-12 17:37:50.036045: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 17:37:50.055536: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 17:37:50.077271: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 17:37:50.083879: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 17:37:50.099974: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 17:37:51.088302: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 17:37:52 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.2, knn_temp=100, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 17:37:52 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:51:17,  2.18it/s]
Adding feature api:   3%|▎         | 6384/187062 [00:00<00:11, 15150.01it/s]
Adding feature api:   7%|▋         | 13681/187062 [00:00<00:05, 29788.62it/s]
Adding feature api:  11%|█▏        | 21052/187062 [00:00<00:04, 41453.34it/s]
Adding feature api:  15%|█▌        | 28479/187062 [00:00<00:03, 50477.91it/s]
Adding feature api:  19%|█▉        | 35892/187062 [00:00<00:02, 57149.05it/s]
Adding feature api:  23%|██▎       | 43290/187062 [00:01<00:02, 61980.80it/s]
Adding feature api:  27%|██▋       | 50721/187062 [00:01<00:02, 65566.27it/s]
Adding feature api:  31%|███       | 58137/187062 [00:01<00:01, 68086.16it/s]
Adding feature api:  35%|███▌      | 65604/187062 [00:01<00:01, 70031.06it/s]
Adding feature api:  39%|███▉      | 73023/187062 [00:01<00:01, 71264.62it/s]
Adding feature api:  43%|████▎     | 80371/187062 [00:01<00:01, 71600.26it/s]
Adding feature api:  47%|████▋     | 87790/187062 [00:01<00:01, 72369.20it/s]
Adding feature api:  51%|█████     | 95221/187062 [00:01<00:01, 72945.49it/s]
Adding feature api:  55%|█████▍    | 102626/187062 [00:01<00:01, 73273.14it/s]
Adding feature api:  59%|█████▉    | 110079/187062 [00:01<00:01, 73646.48it/s]
Adding feature api:  63%|██████▎   | 117504/187062 [00:02<00:00, 73824.76it/s]
Adding feature api:  67%|██████▋   | 124957/187062 [00:02<00:00, 74034.35it/s]
Adding feature api:  71%|███████   | 132410/187062 [00:02<00:00, 74179.57it/s]
Adding feature api:  75%|███████▍  | 139842/187062 [00:02<00:00, 74135.37it/s]
Adding feature api:  79%|███████▊  | 147265/187062 [00:02<00:00, 74108.80it/s]
Adding feature api:  83%|████████▎ | 154683/187062 [00:02<00:00, 73986.84it/s]
Adding feature api:  87%|████████▋ | 162089/187062 [00:02<00:00, 74006.91it/s]
Adding feature api:  91%|█████████ | 169520/187062 [00:02<00:00, 74094.42it/s]
Adding feature api:  95%|█████████▍| 176932/187062 [00:02<00:00, 73552.64it/s]
Adding feature api:  99%|█████████▊| 184290/187062 [00:03<00:00, 49213.29it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 58083.10it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:24:45,  2.22it/s]
Adding feature datatype:   3%|▎         | 6295/187062 [00:00<00:11, 15152.71it/s]
Adding feature datatype:   7%|▋         | 13433/187062 [00:00<00:05, 29540.27it/s]
Adding feature datatype:  11%|█         | 20625/187062 [00:00<00:04, 40883.47it/s]
Adding feature datatype:  15%|█▍        | 27846/187062 [00:00<00:03, 49548.79it/s]
Adding feature datatype:  19%|█▊        | 34979/187062 [00:00<00:02, 55716.84it/s]
Adding feature datatype:  23%|██▎       | 42175/187062 [00:01<00:02, 60394.79it/s]
Adding feature datatype:  26%|██▋       | 49418/187062 [00:01<00:02, 63901.03it/s]
Adding feature datatype:  30%|███       | 56621/187062 [00:01<00:01, 66290.16it/s]
Adding feature datatype:  34%|███▍      | 63878/187062 [00:01<00:01, 68145.31it/s]
Adding feature datatype:  38%|███▊      | 71145/187062 [00:01<00:01, 69486.15it/s]
Adding feature datatype:  42%|████▏     | 78349/187062 [00:01<00:01, 70245.43it/s]
Adding feature datatype:  46%|████▌     | 85618/187062 [00:01<00:01, 70972.09it/s]
Adding feature datatype:  50%|████▉     | 92857/187062 [00:01<00:01, 71393.31it/s]
Adding feature datatype:  54%|█████▎    | 100115/187062 [00:01<00:01, 71745.95it/s]
Adding feature datatype:  57%|█████▋    | 107383/187062 [00:01<00:01, 72025.08it/s]
Adding feature datatype:  61%|██████▏   | 114622/187062 [00:02<00:01, 72025.05it/s]
Adding feature datatype:  65%|██████▌   | 121850/187062 [00:02<00:00, 72075.89it/s]
Adding feature datatype:  69%|██████▉   | 129076/187062 [00:02<00:00, 71834.40it/s]
Adding feature datatype:  73%|███████▎  | 136335/187062 [00:02<00:00, 72056.96it/s]
Adding feature datatype:  77%|███████▋  | 143569/187062 [00:02<00:00, 72141.09it/s]
Adding feature datatype:  81%|████████  | 150790/187062 [00:02<00:00, 72121.79it/s]
Adding feature datatype:  84%|████████▍ | 158019/187062 [00:02<00:00, 72171.62it/s]
Adding feature datatype:  88%|████████▊ | 165260/187062 [00:02<00:00, 72240.33it/s]
Adding feature datatype:  92%|█████████▏| 172487/187062 [00:02<00:00, 72240.78it/s]
Adding feature datatype:  96%|█████████▌| 179713/187062 [00:03<00:00, 63203.90it/s]
Adding feature datatype: 100%|█████████▉| 186239/187062 [00:03<00:00, 46213.51it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 57231.59it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:31:44,  2.21it/s]
Adding feature literal:   3%|▎         | 6192/187062 [00:00<00:12, 14848.80it/s]
Adding feature literal:   7%|▋         | 13325/187062 [00:00<00:05, 29260.88it/s]
Adding feature literal:  11%|█         | 19882/187062 [00:00<00:04, 38959.06it/s]
Adding feature literal:  14%|█▍        | 26351/187062 [00:00<00:03, 46064.65it/s]
Adding feature literal:  18%|█▊        | 32820/187062 [00:00<00:03, 51333.86it/s]
Adding feature literal:  21%|██        | 39285/187062 [00:01<00:02, 55166.18it/s]
Adding feature literal:  24%|██▍       | 45758/187062 [00:01<00:02, 57952.39it/s]
Adding feature literal:  28%|██▊       | 52236/187062 [00:01<00:02, 59957.50it/s]
Adding feature literal:  31%|███▏      | 58705/187062 [00:01<00:02, 61356.14it/s]
Adding feature literal:  35%|███▍      | 65145/187062 [00:01<00:01, 62258.89it/s]
Adding feature literal:  38%|███▊      | 71599/187062 [00:01<00:01, 62935.62it/s]
Adding feature literal:  42%|████▏     | 78058/187062 [00:01<00:01, 63428.44it/s]
Adding feature literal:  45%|████▌     | 84495/187062 [00:01<00:01, 63161.57it/s]
Adding feature literal:  49%|████▉     | 91493/187062 [00:01<00:01, 65187.52it/s]
Adding feature literal:  53%|█████▎    | 98747/187062 [00:01<00:01, 67378.45it/s]
Adding feature literal:  57%|█████▋    | 105938/187062 [00:02<00:01, 68731.13it/s]
Adding feature literal:  60%|██████    | 113163/187062 [00:02<00:01, 69781.84it/s]
Adding feature literal:  64%|██████▍   | 120375/187062 [00:02<00:00, 70479.22it/s]
Adding feature literal:  68%|██████▊   | 127603/187062 [00:02<00:00, 71017.71it/s]
Adding feature literal:  72%|███████▏  | 134851/187062 [00:02<00:00, 71454.88it/s]
Adding feature literal:  76%|███████▌  | 142062/187062 [00:02<00:00, 71649.14it/s]
Adding feature literal:  80%|███████▉  | 149232/187062 [00:02<00:00, 71591.43it/s]
Adding feature literal:  84%|████████▎ | 156396/187062 [00:02<00:00, 71603.09it/s]
Adding feature literal:  87%|████████▋ | 163603/187062 [00:02<00:00, 71739.58it/s]
Adding feature literal:  91%|█████████▏| 170817/187062 [00:02<00:00, 71846.00it/s]
Adding feature literal:  95%|█████████▌| 178003/187062 [00:03<00:00, 70142.96it/s]
Adding feature literal:  99%|█████████▉| 185027/187062 [00:03<00:00, 47216.88it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 55052.13it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:23:15,  2.22it/s]
Adding feature operator:   3%|▎         | 6245/187062 [00:00<00:12, 15044.53it/s]
Adding feature operator:   7%|▋         | 13383/187062 [00:00<00:05, 29468.15it/s]
Adding feature operator:  11%|█         | 20530/187062 [00:00<00:04, 40715.10it/s]
Adding feature operator:  15%|█▍        | 27679/187062 [00:00<00:03, 49229.20it/s]
Adding feature operator:  19%|█▊        | 34903/187062 [00:00<00:02, 55745.81it/s]
Adding feature operator:  22%|██▏       | 41897/187062 [00:01<00:02, 59832.72it/s]
Adding feature operator:  26%|██▋       | 49131/187062 [00:01<00:02, 63476.85it/s]
Adding feature operator:  30%|███       | 56335/187062 [00:01<00:01, 65992.99it/s]
Adding feature operator:  34%|███▍      | 63561/187062 [00:01<00:01, 67844.70it/s]
Adding feature operator:  38%|███▊      | 70760/187062 [00:01<00:01, 69073.05it/s]
Adding feature operator:  42%|████▏     | 78004/187062 [00:01<00:01, 70075.02it/s]
Adding feature operator:  46%|████▌     | 85255/187062 [00:01<00:01, 70801.51it/s]
Adding feature operator:  49%|████▉     | 92459/187062 [00:01<00:01, 71170.02it/s]
Adding feature operator:  53%|█████▎    | 99694/187062 [00:01<00:01, 71521.39it/s]
Adding feature operator:  57%|█████▋    | 106905/187062 [00:01<00:01, 71696.26it/s]
Adding feature operator:  61%|██████    | 114123/187062 [00:02<00:01, 71837.79it/s]
Adding feature operator:  65%|██████▍   | 121384/187062 [00:02<00:00, 72067.46it/s]
Adding feature operator:  69%|██████▉   | 128609/187062 [00:02<00:00, 72033.08it/s]
Adding feature operator:  73%|███████▎  | 135825/187062 [00:02<00:00, 71536.27it/s]
Adding feature operator:  76%|███████▋  | 143015/187062 [00:02<00:00, 71643.01it/s]
Adding feature operator:  80%|████████  | 150216/187062 [00:02<00:00, 71751.48it/s]
Adding feature operator:  84%|████████▍ | 157469/187062 [00:02<00:00, 71983.32it/s]
Adding feature operator:  88%|████████▊ | 164671/187062 [00:02<00:00, 71886.27it/s]
Adding feature operator:  92%|█████████▏| 171896/187062 [00:02<00:00, 71993.69it/s]
Adding feature operator:  96%|█████████▌| 179098/187062 [00:02<00:00, 65436.36it/s]
Adding feature operator:  99%|█████████▉| 185758/187062 [00:03<00:00, 46714.29it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 57075.03it/s]
[2024-10-12 17:38:37,540] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 17:38:38 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 17:38:38 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 417.87 examples/s]
Map:   1%|▏         | 86/6548 [00:00<00:29, 218.64 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:23, 271.09 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:19, 324.18 examples/s]
Map:   3%|▎         | 220/6548 [00:00<00:18, 351.06 examples/s]
Map:   4%|▍         | 286/6548 [00:00<00:16, 372.60 examples/s]
Map:   5%|▌         | 328/6548 [00:01<00:19, 326.44 examples/s]
Map:   6%|▌         | 385/6548 [00:01<00:18, 337.40 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:16, 362.13 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:19, 310.84 examples/s]
Map:   8%|▊         | 529/6548 [00:01<00:18, 329.85 examples/s]
Map:   9%|▉         | 575/6548 [00:01<00:17, 350.82 examples/s]
Map:   9%|▉         | 614/6548 [00:01<00:16, 358.06 examples/s]
Map:  10%|█         | 660/6548 [00:02<00:18, 323.20 examples/s]
Map:  11%|█         | 706/6548 [00:02<00:16, 353.73 examples/s]
Map:  11%|█▏        | 749/6548 [00:02<00:15, 370.04 examples/s]
Map:  12%|█▏        | 802/6548 [00:02<00:14, 409.52 examples/s]
Map:  13%|█▎        | 863/6548 [00:02<00:14, 402.57 examples/s]
Map:  14%|█▍        | 908/6548 [00:02<00:14, 385.72 examples/s]
Map:  15%|█▍        | 970/6548 [00:02<00:14, 377.75 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:23, 238.78 examples/s]
Map:  16%|█▌        | 1054/6548 [00:03<00:20, 262.19 examples/s]
Map:  17%|█▋        | 1098/6548 [00:03<00:18, 294.01 examples/s]
Map:  17%|█▋        | 1145/6548 [00:03<00:16, 330.52 examples/s]
Map:  18%|█▊        | 1203/6548 [00:03<00:15, 346.33 examples/s]
Map:  19%|█▉        | 1258/6548 [00:03<00:15, 348.63 examples/s]
Map:  20%|█▉        | 1299/6548 [00:03<00:14, 360.22 examples/s]
Map:  20%|██        | 1340/6548 [00:04<00:15, 328.55 examples/s]
Map:  21%|██        | 1379/6548 [00:04<00:17, 295.98 examples/s]
Map:  22%|██▏       | 1417/6548 [00:04<00:16, 311.06 examples/s]
Map:  22%|██▏       | 1458/6548 [00:04<00:17, 295.40 examples/s]
Map:  23%|██▎       | 1493/6548 [00:04<00:18, 270.20 examples/s]
Map:  23%|██▎       | 1530/6548 [00:04<00:17, 291.70 examples/s]
Map:  24%|██▍       | 1576/6548 [00:04<00:17, 286.62 examples/s]
Map:  25%|██▍       | 1611/6548 [00:05<00:18, 266.15 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:18, 270.17 examples/s]
Map:  26%|██▌       | 1693/6548 [00:05<00:17, 285.10 examples/s]
Map:  26%|██▋       | 1730/6548 [00:05<00:15, 303.39 examples/s]
Map:  27%|██▋       | 1774/6548 [00:05<00:14, 336.67 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 337.24 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 345.45 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 334.86 examples/s]
Map:  30%|██▉       | 1947/6548 [00:06<00:13, 351.88 examples/s]
Map:  30%|███       | 1991/6548 [00:06<00:12, 371.08 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:20, 223.39 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:17, 254.07 examples/s]
Map:  32%|███▏      | 2107/6548 [00:06<00:16, 270.44 examples/s]
Map:  33%|███▎      | 2142/6548 [00:06<00:18, 242.53 examples/s]
Map:  33%|███▎      | 2180/6548 [00:06<00:16, 269.24 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 276.28 examples/s]
Map:  34%|███▍      | 2247/6548 [00:07<00:17, 250.47 examples/s]
Map:  35%|███▌      | 2294/6548 [00:07<00:15, 266.45 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:14, 294.41 examples/s]
Map:  36%|███▋      | 2377/6548 [00:07<00:13, 302.62 examples/s]
Map:  37%|███▋      | 2412/6548 [00:07<00:13, 311.84 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:13, 307.90 examples/s]
Map:  38%|███▊      | 2495/6548 [00:08<00:13, 307.47 examples/s]
Map:  39%|███▊      | 2531/6548 [00:08<00:12, 312.23 examples/s]
Map:  40%|███▉      | 2588/6548 [00:08<00:10, 376.91 examples/s]
Map:  40%|████      | 2627/6548 [00:08<00:10, 378.03 examples/s]
Map:  41%|████      | 2676/6548 [00:08<00:10, 352.60 examples/s]
Map:  41%|████▏     | 2716/6548 [00:08<00:11, 342.57 examples/s]
Map:  42%|████▏     | 2758/6548 [00:08<00:10, 359.90 examples/s]
Map:  43%|████▎     | 2806/6548 [00:08<00:11, 334.57 examples/s]
Map:  43%|████▎     | 2842/6548 [00:09<00:13, 269.30 examples/s]
Map:  44%|████▍     | 2879/6548 [00:09<00:12, 289.14 examples/s]
Map:  45%|████▍     | 2923/6548 [00:09<00:13, 272.76 examples/s]
Map:  45%|████▌     | 2961/6548 [00:09<00:12, 291.84 examples/s]
Map:  46%|████▌     | 2996/6548 [00:09<00:15, 236.46 examples/s]
Map:  46%|████▋     | 3039/6548 [00:10<00:20, 171.28 examples/s]
Map:  47%|████▋     | 3073/6548 [00:10<00:18, 192.40 examples/s]
Map:  48%|████▊     | 3112/6548 [00:10<00:15, 218.95 examples/s]
Map:  48%|████▊     | 3148/6548 [00:10<00:13, 244.84 examples/s]
Map:  49%|████▊     | 3186/6548 [00:10<00:13, 246.57 examples/s]
Map:  49%|████▉     | 3218/6548 [00:10<00:13, 243.96 examples/s]
Map:  50%|████▉     | 3252/6548 [00:10<00:12, 264.96 examples/s]
Map:  50%|█████     | 3286/6548 [00:10<00:11, 277.60 examples/s]
Map:  51%|█████     | 3331/6548 [00:11<00:10, 313.80 examples/s]
Map:  52%|█████▏    | 3380/6548 [00:11<00:10, 310.29 examples/s]
Map:  52%|█████▏    | 3426/6548 [00:11<00:10, 306.93 examples/s]
Map:  53%|█████▎    | 3462/6548 [00:11<00:11, 276.71 examples/s]
Map:  53%|█████▎    | 3493/6548 [00:11<00:10, 278.30 examples/s]
Map:  54%|█████▍    | 3543/6548 [00:11<00:09, 329.09 examples/s]
Map:  55%|█████▍    | 3591/6548 [00:11<00:08, 360.11 examples/s]
Map:  56%|█████▌    | 3637/6548 [00:11<00:07, 384.21 examples/s]
Map:  56%|█████▋    | 3697/6548 [00:12<00:07, 384.73 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:12<00:07, 390.91 examples/s]
Map:  58%|█████▊    | 3800/6548 [00:12<00:07, 381.21 examples/s]
Map:  59%|█████▊    | 3845/6548 [00:12<00:08, 316.93 examples/s]
Map:  59%|█████▉    | 3882/6548 [00:12<00:08, 321.32 examples/s]
Map:  60%|█████▉    | 3916/6548 [00:12<00:08, 317.33 examples/s]
Map:  61%|██████    | 3973/6548 [00:12<00:07, 327.41 examples/s]
Map:  62%|██████▏   | 4030/6548 [00:13<00:09, 253.04 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 292.83 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 316.75 examples/s]
Map:  64%|██████▎   | 4167/6548 [00:13<00:07, 304.08 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:13<00:08, 286.12 examples/s]
Map:  65%|██████▌   | 4260/6548 [00:13<00:06, 326.86 examples/s]
Map:  66%|██████▌   | 4298/6548 [00:14<00:06, 331.86 examples/s]
Map:  66%|██████▋   | 4345/6548 [00:14<00:06, 363.82 examples/s]
Map:  67%|██████▋   | 4397/6548 [00:14<00:06, 348.78 examples/s]
Map:  68%|██████▊   | 4439/6548 [00:14<00:05, 362.74 examples/s]
Map:  68%|██████▊   | 4484/6548 [00:14<00:06, 339.90 examples/s]
Map:  69%|██████▉   | 4527/6548 [00:14<00:06, 313.62 examples/s]
Map:  70%|██████▉   | 4566/6548 [00:14<00:06, 329.91 examples/s]
Map:  70%|███████   | 4603/6548 [00:14<00:06, 314.42 examples/s]
Map:  71%|███████   | 4647/6548 [00:15<00:05, 343.64 examples/s]
Map:  72%|███████▏  | 4683/6548 [00:15<00:05, 345.01 examples/s]
Map:  72%|███████▏  | 4730/6548 [00:15<00:04, 366.40 examples/s]
Map:  73%|███████▎  | 4777/6548 [00:15<00:04, 387.40 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 396.67 examples/s]
Map:  75%|███████▍  | 4888/6548 [00:15<00:04, 390.80 examples/s]
Map:  76%|███████▌  | 4953/6548 [00:15<00:04, 396.78 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:16<00:06, 249.57 examples/s]
Map:  77%|███████▋  | 5041/6548 [00:16<00:05, 269.80 examples/s]
Map:  78%|███████▊  | 5076/6548 [00:16<00:05, 281.94 examples/s]
Map:  78%|███████▊  | 5121/6548 [00:16<00:05, 285.17 examples/s]
Map:  79%|███████▉  | 5174/6548 [00:16<00:04, 293.61 examples/s]
Map:  80%|███████▉  | 5207/6548 [00:16<00:04, 292.47 examples/s]
Map:  80%|████████  | 5246/6548 [00:16<00:04, 311.93 examples/s]
Map:  81%|████████  | 5279/6548 [00:17<00:04, 313.21 examples/s]
Map:  81%|████████  | 5318/6548 [00:17<00:03, 329.26 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 299.54 examples/s]
Map:  83%|████████▎ | 5407/6548 [00:17<00:03, 285.53 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 319.38 examples/s]
Map:  84%|████████▍ | 5492/6548 [00:17<00:03, 334.71 examples/s]
Map:  84%|████████▍ | 5529/6548 [00:17<00:03, 338.67 examples/s]
Map:  85%|████████▌ | 5570/6548 [00:17<00:02, 354.00 examples/s]
Map:  86%|████████▌ | 5621/6548 [00:18<00:02, 345.49 examples/s]
Map:  87%|████████▋ | 5671/6548 [00:18<00:02, 338.99 examples/s]
Map:  87%|████████▋ | 5722/6548 [00:18<00:02, 332.79 examples/s]
Map:  88%|████████▊ | 5764/6548 [00:18<00:02, 351.80 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 355.54 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:01, 360.22 examples/s]
Map:  90%|████████▉ | 5884/6548 [00:18<00:01, 361.93 examples/s]
Map:  90%|█████████ | 5924/6548 [00:18<00:01, 369.12 examples/s]
Map:  91%|█████████ | 5965/6548 [00:19<00:01, 332.50 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 218.84 examples/s]
Map:  92%|█████████▏| 6041/6548 [00:19<00:01, 255.29 examples/s]
Map:  93%|█████████▎| 6073/6548 [00:19<00:01, 266.08 examples/s]
Map:  93%|█████████▎| 6117/6548 [00:19<00:01, 261.33 examples/s]
Map:  94%|█████████▍| 6147/6548 [00:19<00:01, 269.33 examples/s]
Map:  94%|█████████▍| 6185/6548 [00:19<00:01, 295.38 examples/s]
Map:  95%|█████████▌| 6227/6548 [00:20<00:00, 325.18 examples/s]
Map:  96%|█████████▌| 6265/6548 [00:20<00:00, 337.44 examples/s]
Map:  96%|█████████▋| 6305/6548 [00:20<00:00, 353.07 examples/s]
Map:  97%|█████████▋| 6366/6548 [00:20<00:00, 369.95 examples/s]
Map:  98%|█████████▊| 6416/6548 [00:20<00:00, 352.69 examples/s]
Map:  99%|█████████▊| 6464/6548 [00:20<00:00, 381.22 examples/s]
Map: 100%|█████████▉| 6521/6548 [00:20<00:00, 378.51 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 310.89 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 326.55 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 350.22 examples/s]
Map:  12%|█▏        | 110/903 [00:00<00:02, 321.42 examples/s]
Map:  17%|█▋        | 150/903 [00:00<00:02, 343.95 examples/s]
Map:  22%|██▏       | 201/903 [00:00<00:01, 397.95 examples/s]
Map:  29%|██▉       | 260/903 [00:00<00:01, 383.28 examples/s]
Map:  34%|███▍      | 309/903 [00:00<00:01, 395.27 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 340.05 examples/s]
Map:  46%|████▌     | 413/903 [00:01<00:01, 325.23 examples/s]
Map:  51%|█████     | 461/903 [00:01<00:01, 320.97 examples/s]
Map:  55%|█████▍    | 495/903 [00:01<00:01, 322.27 examples/s]
Map:  60%|█████▉    | 540/903 [00:01<00:01, 351.38 examples/s]
Map:  65%|██████▌   | 588/903 [00:01<00:00, 378.11 examples/s]
Map:  70%|███████   | 633/903 [00:01<00:00, 383.30 examples/s]
Map:  77%|███████▋  | 696/903 [00:01<00:00, 385.31 examples/s]
Map:  82%|████████▏ | 742/903 [00:02<00:00, 401.92 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 396.11 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 397.79 examples/s]
Map:  97%|█████████▋| 873/903 [00:02<00:00, 413.93 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 334.46 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 296.46 examples/s]
Map:   4%|▍         | 83/1882 [00:00<00:04, 371.52 examples/s]
Map:   7%|▋         | 130/1882 [00:00<00:05, 324.47 examples/s]
Map:   9%|▉         | 175/1882 [00:00<00:04, 362.98 examples/s]
Map:  13%|█▎        | 236/1882 [00:00<00:04, 374.86 examples/s]
Map:  15%|█▍        | 277/1882 [00:00<00:04, 382.73 examples/s]
Map:  18%|█▊        | 334/1882 [00:00<00:04, 361.19 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:04, 311.60 examples/s]
Map:  22%|██▏       | 411/1882 [00:01<00:05, 284.85 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 293.61 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 329.25 examples/s]
Map:  28%|██▊       | 536/1882 [00:01<00:04, 309.64 examples/s]
Map:  31%|███       | 577/1882 [00:01<00:03, 332.89 examples/s]
Map:  33%|███▎      | 622/1882 [00:01<00:03, 361.22 examples/s]
Map:  36%|███▌      | 682/1882 [00:02<00:03, 365.70 examples/s]
Map:  38%|███▊      | 723/1882 [00:02<00:03, 369.76 examples/s]
Map:  41%|████      | 768/1882 [00:02<00:02, 385.14 examples/s]
Map:  44%|████▍     | 826/1882 [00:02<00:03, 333.08 examples/s]
Map:  46%|████▌     | 867/1882 [00:02<00:02, 345.66 examples/s]
Map:  48%|████▊     | 908/1882 [00:02<00:02, 355.67 examples/s]
Map:  51%|█████     | 960/1882 [00:02<00:02, 392.12 examples/s]
Map:  54%|█████▍    | 1017/1882 [00:03<00:03, 252.55 examples/s]
Map:  56%|█████▌    | 1054/1882 [00:03<00:03, 267.68 examples/s]
Map:  58%|█████▊    | 1091/1882 [00:03<00:02, 284.45 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 293.12 examples/s]
Map:  63%|██████▎   | 1177/1882 [00:03<00:02, 285.58 examples/s]
Map:  65%|██████▌   | 1224/1882 [00:03<00:02, 287.32 examples/s]
Map:  67%|██████▋   | 1256/1882 [00:03<00:02, 288.83 examples/s]
Map:  69%|██████▉   | 1305/1882 [00:04<00:01, 333.61 examples/s]
Map:  72%|███████▏  | 1346/1882 [00:04<00:01, 344.68 examples/s]
Map:  74%|███████▍  | 1393/1882 [00:04<00:01, 325.26 examples/s]
Map:  76%|███████▌  | 1427/1882 [00:04<00:01, 283.46 examples/s]
Map:  78%|███████▊  | 1468/1882 [00:04<00:01, 311.76 examples/s]
Map:  80%|███████▉  | 1503/1882 [00:04<00:01, 271.71 examples/s]
Map:  82%|████████▏ | 1535/1882 [00:04<00:01, 273.92 examples/s]
Map:  84%|████████▎ | 1575/1882 [00:04<00:01, 299.79 examples/s]
Map:  86%|████████▌ | 1619/1882 [00:05<00:00, 330.74 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 330.40 examples/s]
Map:  91%|█████████ | 1708/1882 [00:05<00:00, 324.62 examples/s]
Map:  93%|█████████▎| 1749/1882 [00:05<00:00, 274.96 examples/s]
Map:  95%|█████████▌| 1794/1882 [00:05<00:00, 280.11 examples/s]
Map:  98%|█████████▊| 1841/1882 [00:05<00:00, 318.17 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 230.32 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 308.41 examples/s]
10/12/2024 17:39:40 - INFO - __main__ -     ***** Testing *****
10/12/2024 17:39:40 - INFO - __main__ -     Batch size = 8
10/12/2024 17:39:40 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 17:39:41 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 17:39:41 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 17:39:42 - INFO - knnlm -   Reading datastore took 0.9118657112121582 s
10/12/2024 17:39:43 - INFO - knnlm -   Moving index to GPU took 0.9054470062255859 s
10/12/2024 17:39:43 - INFO - __main__ -   ******************************break-into
10/12/2024 17:39:43 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 17:39:43 - INFO - __main__ -     Num examples = 236
10/12/2024 17:39:43 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<33:49,  8.64s/it]
test ppl:   1%|          | 2/236 [00:10<19:12,  4.93s/it]
test ppl:   1%|▏         | 3/236 [00:12<13:34,  3.50s/it]
test ppl:   2%|▏         | 4/236 [00:14<11:10,  2.89s/it]
test ppl:   2%|▏         | 5/236 [00:21<16:51,  4.38s/it]
test ppl:   3%|▎         | 6/236 [00:24<14:40,  3.83s/it]
test ppl:   3%|▎         | 7/236 [00:27<13:36,  3.57s/it]
test ppl:   3%|▎         | 8/236 [00:32<15:26,  4.06s/it]
test ppl:   4%|▍         | 9/236 [00:35<13:32,  3.58s/it]
test ppl:   4%|▍         | 10/236 [00:38<13:30,  3.58s/it]
test ppl:   5%|▍         | 11/236 [00:41<12:33,  3.35s/it]
test ppl:   5%|▌         | 12/236 [00:48<16:40,  4.47s/it]
test ppl:   6%|▌         | 13/236 [00:54<18:02,  4.85s/it]
test ppl:   6%|▌         | 14/236 [01:01<20:25,  5.52s/it]
test ppl:   6%|▋         | 15/236 [01:04<17:23,  4.72s/it]
test ppl:   7%|▋         | 16/236 [01:06<14:33,  3.97s/it]
test ppl:   7%|▋         | 17/236 [01:13<17:50,  4.89s/it]
test ppl:   8%|▊         | 18/236 [01:15<14:37,  4.02s/it]
test ppl:   8%|▊         | 19/236 [01:20<15:57,  4.41s/it]
test ppl:   8%|▊         | 20/236 [01:22<13:23,  3.72s/it]
test ppl:   9%|▉         | 21/236 [01:25<12:14,  3.42s/it]
test ppl:   9%|▉         | 22/236 [01:32<16:01,  4.50s/it]
test ppl:  10%|▉         | 23/236 [01:35<14:21,  4.05s/it]
test ppl:  10%|█         | 24/236 [01:38<12:59,  3.68s/it]
test ppl:  11%|█         | 25/236 [01:40<11:22,  3.23s/it]
test ppl:  11%|█         | 26/236 [01:47<15:17,  4.37s/it]
test ppl:  11%|█▏        | 27/236 [01:52<15:51,  4.55s/it]
test ppl:  12%|█▏        | 28/236 [01:54<12:32,  3.62s/it]
test ppl:  12%|█▏        | 29/236 [01:56<11:38,  3.37s/it]
test ppl:  13%|█▎        | 30/236 [01:58<09:58,  2.91s/it]
test ppl:  13%|█▎        | 31/236 [02:01<09:24,  2.75s/it]
test ppl:  14%|█▎        | 32/236 [02:04<10:03,  2.96s/it]
test ppl:  14%|█▍        | 33/236 [02:11<14:08,  4.18s/it]
test ppl:  14%|█▍        | 34/236 [02:16<14:40,  4.36s/it]
test ppl:  15%|█▍        | 35/236 [02:19<13:15,  3.96s/it]
test ppl:  15%|█▌        | 36/236 [02:26<16:14,  4.87s/it]
test ppl:  16%|█▌        | 37/236 [02:33<18:19,  5.52s/it]
test ppl:  16%|█▌        | 38/236 [02:35<15:11,  4.61s/it]
test ppl:  17%|█▋        | 39/236 [02:37<12:21,  3.76s/it]
test ppl:  17%|█▋        | 40/236 [02:40<11:46,  3.60s/it]
test ppl:  17%|█▋        | 41/236 [02:43<11:07,  3.42s/it]
test ppl:  18%|█▊        | 42/236 [02:51<14:36,  4.52s/it]
test ppl:  18%|█▊        | 43/236 [02:58<16:56,  5.27s/it]
test ppl:  19%|█▊        | 44/236 [03:00<14:27,  4.52s/it]
test ppl:  19%|█▉        | 45/236 [03:03<12:18,  3.86s/it]
test ppl:  19%|█▉        | 46/236 [03:10<15:16,  4.82s/it]
test ppl:  20%|█▉        | 47/236 [03:17<17:19,  5.50s/it]
test ppl:  20%|██        | 48/236 [03:24<18:38,  5.95s/it]
test ppl:  21%|██        | 49/236 [03:28<16:39,  5.34s/it]
test ppl:  21%|██        | 50/236 [03:35<18:10,  5.86s/it]
test ppl:  22%|██▏       | 51/236 [03:40<17:34,  5.70s/it]
test ppl:  22%|██▏       | 52/236 [03:47<18:41,  6.09s/it]
test ppl:  22%|██▏       | 53/236 [03:54<18:56,  6.21s/it]
test ppl:  23%|██▎       | 54/236 [03:55<14:50,  4.90s/it]
test ppl:  23%|██▎       | 55/236 [04:02<16:24,  5.44s/it]
test ppl:  24%|██▎       | 56/236 [04:06<15:03,  5.02s/it]
test ppl:  24%|██▍       | 57/236 [04:09<13:13,  4.43s/it]
test ppl:  25%|██▍       | 58/236 [04:11<10:50,  3.66s/it]
test ppl:  25%|██▌       | 59/236 [04:18<13:44,  4.66s/it]
test ppl:  25%|██▌       | 60/236 [04:22<12:56,  4.41s/it]
test ppl:  26%|██▌       | 61/236 [04:29<15:08,  5.19s/it]
test ppl:  26%|██▋       | 62/236 [04:34<14:49,  5.11s/it]
test ppl:  27%|██▋       | 63/236 [04:37<12:51,  4.46s/it]
test ppl:  27%|██▋       | 64/236 [04:39<10:30,  3.66s/it]
test ppl:  28%|██▊       | 65/236 [04:40<08:39,  3.04s/it]
test ppl:  28%|██▊       | 66/236 [04:44<09:03,  3.20s/it]
test ppl:  28%|██▊       | 67/236 [04:51<12:14,  4.35s/it]
test ppl:  29%|██▉       | 68/236 [04:58<14:25,  5.15s/it]
test ppl:  29%|██▉       | 69/236 [05:05<15:52,  5.71s/it]
test ppl:  30%|██▉       | 70/236 [05:07<12:38,  4.57s/it]
test ppl:  30%|███       | 71/236 [05:12<12:44,  4.63s/it]
test ppl:  31%|███       | 72/236 [05:16<12:35,  4.61s/it]
test ppl:  31%|███       | 73/236 [05:21<12:30,  4.60s/it]
test ppl:  31%|███▏      | 74/236 [05:22<10:09,  3.76s/it]
test ppl:  32%|███▏      | 75/236 [05:29<12:42,  4.74s/it]
test ppl:  32%|███▏      | 76/236 [05:34<12:10,  4.56s/it]
test ppl:  33%|███▎      | 77/236 [05:36<10:37,  4.01s/it]
test ppl:  33%|███▎      | 78/236 [05:39<09:12,  3.49s/it]
test ppl:  33%|███▎      | 79/236 [05:45<11:05,  4.24s/it]
test ppl:  34%|███▍      | 80/236 [05:47<09:30,  3.66s/it]
test ppl:  34%|███▍      | 81/236 [05:54<12:03,  4.67s/it]
test ppl:  35%|███▍      | 82/236 [06:01<13:49,  5.38s/it]
test ppl:  35%|███▌      | 83/236 [06:03<11:26,  4.48s/it]
test ppl:  36%|███▌      | 84/236 [06:06<09:39,  3.81s/it]
test ppl:  36%|███▌      | 85/236 [06:11<10:26,  4.15s/it]
test ppl:  36%|███▋      | 86/236 [06:13<08:58,  3.59s/it]
test ppl:  37%|███▋      | 87/236 [06:15<08:07,  3.27s/it]
test ppl:  37%|███▋      | 88/236 [06:22<10:50,  4.39s/it]
test ppl:  38%|███▊      | 89/236 [06:29<12:41,  5.18s/it]
test ppl:  38%|███▊      | 90/236 [06:36<13:57,  5.73s/it]
test ppl:  39%|███▊      | 91/236 [06:42<13:54,  5.76s/it]
test ppl:  39%|███▉      | 92/236 [06:46<12:04,  5.03s/it]
test ppl:  39%|███▉      | 93/236 [06:53<13:23,  5.62s/it]
test ppl:  40%|███▉      | 94/236 [07:00<14:17,  6.04s/it]
test ppl:  40%|████      | 95/236 [07:04<12:45,  5.43s/it]
test ppl:  41%|████      | 96/236 [07:07<11:20,  4.86s/it]
test ppl:  41%|████      | 97/236 [07:14<12:45,  5.51s/it]
test ppl:  42%|████▏     | 98/236 [07:21<13:42,  5.96s/it]
test ppl:  42%|████▏     | 99/236 [07:28<14:19,  6.27s/it]
test ppl:  42%|████▏     | 100/236 [07:30<11:01,  4.87s/it]
test ppl:  43%|████▎     | 101/236 [07:37<12:24,  5.51s/it]
test ppl:  43%|████▎     | 102/236 [07:41<11:31,  5.16s/it]
test ppl:  44%|████▎     | 103/236 [07:44<09:41,  4.37s/it]
test ppl:  44%|████▍     | 104/236 [07:49<10:05,  4.59s/it]
test ppl:  44%|████▍     | 105/236 [07:53<10:04,  4.62s/it]
test ppl:  45%|████▍     | 106/236 [08:00<11:11,  5.16s/it]
test ppl:  45%|████▌     | 107/236 [08:02<09:20,  4.35s/it]
test ppl:  46%|████▌     | 108/236 [08:09<10:50,  5.08s/it]
test ppl:  46%|████▌     | 109/236 [08:15<11:04,  5.23s/it]
test ppl:  47%|████▋     | 110/236 [08:17<09:02,  4.31s/it]
test ppl:  47%|████▋     | 111/236 [08:22<09:13,  4.43s/it]
test ppl:  47%|████▋     | 112/236 [08:25<08:27,  4.10s/it]
test ppl:  48%|████▊     | 113/236 [08:27<07:10,  3.50s/it]
test ppl:  48%|████▊     | 114/236 [08:31<07:23,  3.64s/it]
test ppl:  49%|████▊     | 115/236 [08:38<09:22,  4.65s/it]
test ppl:  49%|████▉     | 116/236 [08:45<10:29,  5.25s/it]
test ppl:  50%|████▉     | 117/236 [08:47<08:35,  4.34s/it]
test ppl:  50%|█████     | 118/236 [08:52<08:54,  4.53s/it]
test ppl:  50%|█████     | 119/236 [08:56<08:29,  4.36s/it]
test ppl:  51%|█████     | 120/236 [08:57<06:48,  3.53s/it]
test ppl:  51%|█████▏    | 121/236 [09:04<08:45,  4.57s/it]
test ppl:  52%|█████▏    | 122/236 [09:10<09:20,  4.92s/it]
test ppl:  52%|█████▏    | 123/236 [09:13<07:56,  4.21s/it]
test ppl:  53%|█████▎    | 124/236 [09:16<07:21,  3.94s/it]
test ppl:  53%|█████▎    | 125/236 [09:19<06:45,  3.65s/it]
test ppl:  53%|█████▎    | 126/236 [09:23<07:06,  3.88s/it]
test ppl:  54%|█████▍    | 127/236 [09:26<06:09,  3.39s/it]
test ppl:  54%|█████▍    | 128/236 [09:28<05:43,  3.18s/it]
test ppl:  55%|█████▍    | 129/236 [09:32<06:04,  3.40s/it]
test ppl:  55%|█████▌    | 130/236 [09:37<06:59,  3.96s/it]
test ppl:  56%|█████▌    | 131/236 [09:44<08:32,  4.88s/it]
test ppl:  56%|█████▌    | 132/236 [09:47<07:27,  4.30s/it]
test ppl:  56%|█████▋    | 133/236 [09:52<07:34,  4.42s/it]
test ppl:  57%|█████▋    | 134/236 [09:59<08:38,  5.09s/it]
test ppl:  57%|█████▋    | 135/236 [10:06<09:31,  5.66s/it]
test ppl:  58%|█████▊    | 136/236 [10:07<07:19,  4.39s/it]
test ppl:  58%|█████▊    | 137/236 [10:14<08:34,  5.20s/it]
test ppl:  58%|█████▊    | 138/236 [10:18<07:49,  4.79s/it]
test ppl:  59%|█████▉    | 139/236 [10:21<06:54,  4.27s/it]
test ppl:  59%|█████▉    | 140/236 [10:23<05:45,  3.60s/it]
test ppl:  60%|█████▉    | 141/236 [10:27<05:37,  3.55s/it]
test ppl:  60%|██████    | 142/236 [10:29<05:05,  3.25s/it]
test ppl:  61%|██████    | 143/236 [10:36<06:48,  4.40s/it]
test ppl:  61%|██████    | 144/236 [10:40<06:13,  4.06s/it]
test ppl:  61%|██████▏   | 145/236 [10:46<07:18,  4.82s/it]
test ppl:  62%|██████▏   | 146/236 [10:52<07:29,  5.00s/it]
test ppl:  62%|██████▏   | 147/236 [10:59<08:19,  5.62s/it]
test ppl:  63%|██████▎   | 148/236 [11:06<08:55,  6.08s/it]
test ppl:  63%|██████▎   | 149/236 [11:10<07:55,  5.46s/it]
test ppl:  64%|██████▎   | 150/236 [11:15<07:33,  5.27s/it]
test ppl:  64%|██████▍   | 151/236 [11:22<08:13,  5.80s/it]
test ppl:  64%|██████▍   | 152/236 [11:29<08:37,  6.16s/it]
test ppl:  65%|██████▍   | 153/236 [11:36<08:52,  6.42s/it]
test ppl:  65%|██████▌   | 154/236 [11:39<07:22,  5.39s/it]
test ppl:  66%|██████▌   | 155/236 [11:42<06:21,  4.71s/it]
test ppl:  66%|██████▌   | 156/236 [11:44<05:25,  4.07s/it]
test ppl:  67%|██████▋   | 157/236 [11:47<04:47,  3.64s/it]
test ppl:  67%|██████▋   | 158/236 [11:54<06:03,  4.66s/it]
test ppl:  67%|██████▋   | 159/236 [12:01<06:53,  5.37s/it]
test ppl:  68%|██████▊   | 160/236 [12:02<05:17,  4.18s/it]
test ppl:  68%|██████▊   | 161/236 [12:04<04:16,  3.41s/it]
test ppl:  69%|██████▊   | 162/236 [12:08<04:19,  3.51s/it]
test ppl:  69%|██████▉   | 163/236 [12:11<04:05,  3.37s/it]
test ppl:  69%|██████▉   | 164/236 [12:15<04:23,  3.66s/it]
test ppl:  70%|██████▉   | 165/236 [12:21<05:10,  4.37s/it]
test ppl:  70%|███████   | 166/236 [12:25<04:57,  4.25s/it]
test ppl:  71%|███████   | 167/236 [12:27<04:01,  3.50s/it]
test ppl:  71%|███████   | 168/236 [12:32<04:32,  4.00s/it]
test ppl:  72%|███████▏  | 169/236 [12:39<05:17,  4.74s/it]
test ppl:  72%|███████▏  | 170/236 [12:46<05:59,  5.44s/it]
test ppl:  72%|███████▏  | 171/236 [12:47<04:38,  4.29s/it]
test ppl:  73%|███████▎  | 172/236 [12:50<04:04,  3.82s/it]
test ppl:  73%|███████▎  | 173/236 [12:54<04:07,  3.92s/it]
test ppl:  74%|███████▎  | 174/236 [13:01<05:01,  4.86s/it]
test ppl:  74%|███████▍  | 175/236 [13:03<04:07,  4.06s/it]
test ppl:  75%|███████▍  | 176/236 [13:09<04:35,  4.59s/it]
test ppl:  75%|███████▌  | 177/236 [13:16<05:14,  5.32s/it]
test ppl:  75%|███████▌  | 178/236 [13:23<05:39,  5.85s/it]
test ppl:  76%|███████▌  | 179/236 [13:30<05:54,  6.21s/it]
test ppl:  76%|███████▋  | 180/236 [13:36<05:35,  6.00s/it]
test ppl:  77%|███████▋  | 181/236 [13:43<05:46,  6.30s/it]
test ppl:  77%|███████▋  | 182/236 [13:45<04:34,  5.09s/it]
test ppl:  78%|███████▊  | 183/236 [13:48<03:52,  4.39s/it]
test ppl:  78%|███████▊  | 184/236 [13:50<03:06,  3.59s/it]
test ppl:  78%|███████▊  | 185/236 [13:55<03:28,  4.09s/it]
test ppl:  79%|███████▉  | 186/236 [14:02<04:08,  4.97s/it]
test ppl:  79%|███████▉  | 187/236 [14:09<04:35,  5.62s/it]
test ppl:  80%|███████▉  | 188/236 [14:16<04:50,  6.05s/it]
test ppl:  80%|████████  | 189/236 [14:23<04:58,  6.34s/it]
test ppl:  81%|████████  | 190/236 [14:28<04:30,  5.89s/it]
test ppl:  81%|████████  | 191/236 [14:33<04:15,  5.68s/it]
test ppl:  81%|████████▏ | 192/236 [14:36<03:36,  4.92s/it]
test ppl:  82%|████████▏ | 193/236 [14:43<03:59,  5.56s/it]
test ppl:  82%|████████▏ | 194/236 [14:46<03:22,  4.83s/it]
test ppl:  83%|████████▎ | 195/236 [14:50<03:03,  4.48s/it]
test ppl:  83%|████████▎ | 196/236 [14:53<02:34,  3.86s/it]
test ppl:  83%|████████▎ | 197/236 [14:56<02:21,  3.62s/it]
test ppl:  84%|████████▍ | 198/236 [15:03<02:56,  4.65s/it]
test ppl:  84%|████████▍ | 199/236 [15:06<02:36,  4.22s/it]
test ppl:  85%|████████▍ | 200/236 [15:13<03:02,  5.06s/it]
test ppl:  85%|████████▌ | 201/236 [15:15<02:29,  4.27s/it]
test ppl:  86%|████████▌ | 202/236 [15:21<02:38,  4.65s/it]
test ppl:  86%|████████▌ | 203/236 [15:27<02:52,  5.24s/it]
test ppl:  86%|████████▋ | 204/236 [15:29<02:14,  4.20s/it]
test ppl:  87%|████████▋ | 205/236 [15:36<02:37,  5.07s/it]
test ppl:  87%|████████▋ | 206/236 [15:40<02:21,  4.73s/it]
test ppl:  88%|████████▊ | 207/236 [15:47<02:37,  5.42s/it]
test ppl:  88%|████████▊ | 208/236 [15:51<02:17,  4.92s/it]
test ppl:  89%|████████▊ | 209/236 [15:58<02:30,  5.58s/it]
test ppl:  89%|████████▉ | 210/236 [16:01<02:03,  4.75s/it]
test ppl:  89%|████████▉ | 211/236 [16:07<02:06,  5.04s/it]
test ppl:  90%|████████▉ | 212/236 [16:12<02:05,  5.24s/it]
test ppl:  90%|█████████ | 213/236 [16:19<02:12,  5.78s/it]
test ppl:  91%|█████████ | 214/236 [16:21<01:41,  4.64s/it]
test ppl:  91%|█████████ | 215/236 [16:28<01:52,  5.36s/it]
test ppl:  92%|█████████▏| 216/236 [16:32<01:33,  4.67s/it]
test ppl:  92%|█████████▏| 217/236 [16:39<01:42,  5.41s/it]
test ppl:  92%|█████████▏| 218/236 [16:41<01:20,  4.48s/it]
test ppl:  93%|█████████▎| 219/236 [16:48<01:29,  5.26s/it]
test ppl:  93%|█████████▎| 220/236 [16:55<01:32,  5.80s/it]
test ppl:  94%|█████████▎| 221/236 [16:59<01:17,  5.17s/it]
test ppl:  94%|█████████▍| 222/236 [17:06<01:20,  5.73s/it]
test ppl:  94%|█████████▍| 223/236 [17:13<01:19,  6.12s/it]
test ppl:  95%|█████████▍| 224/236 [17:14<00:56,  4.75s/it]
test ppl:  95%|█████████▌| 225/236 [17:21<00:59,  5.43s/it]
test ppl:  96%|█████████▌| 226/236 [17:26<00:51,  5.10s/it]
test ppl:  96%|█████████▌| 227/236 [17:29<00:39,  4.41s/it]
test ppl:  97%|█████████▋| 228/236 [17:31<00:30,  3.81s/it]
test ppl:  97%|█████████▋| 229/236 [17:38<00:33,  4.77s/it]
test ppl:  97%|█████████▋| 230/236 [17:42<00:27,  4.59s/it]
test ppl:  98%|█████████▊| 231/236 [17:46<00:22,  4.41s/it]
test ppl:  98%|█████████▊| 232/236 [17:48<00:14,  3.72s/it]
test ppl:  99%|█████████▊| 233/236 [17:51<00:10,  3.37s/it]
test ppl:  99%|█████████▉| 234/236 [17:52<00:05,  2.80s/it]
test ppl: 100%|█████████▉| 235/236 [17:59<00:04,  4.07s/it]
test ppl: 100%|██████████| 236/236 [18:00<00:00,  3.08s/it]
test ppl: 100%|██████████| 236/236 [18:00<00:00,  4.58s/it]
10/12/2024 17:57:43 - INFO - __main__ -    em: 0.2099
10/12/2024 17:57:43 - INFO - __main__ -   Finish and take 19m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.2 100:  em: 0.2099

--------------------------------------------------------------------------------
Running experiment with knn_temp=100, lmbda=0.2, k=64
2024-10-12 17:57:50.726984: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 17:57:50.746690: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 17:57:50.768748: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 17:57:50.775432: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 17:57:50.791536: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 17:57:51.781710: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 17:57:53 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.2, knn_temp=100, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 17:57:53 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:47:50,  2.18it/s]
Adding feature api:   4%|▍         | 7069/187062 [00:00<00:10, 16773.28it/s]
Adding feature api:   8%|▊         | 15473/187062 [00:00<00:05, 33801.75it/s]
Adding feature api:  13%|█▎        | 23999/187062 [00:00<00:03, 47467.97it/s]
Adding feature api:  17%|█▋        | 32543/187062 [00:00<00:02, 57911.46it/s]
Adding feature api:  22%|██▏       | 40811/187062 [00:00<00:02, 64897.24it/s]
Adding feature api:  26%|██▋       | 49416/187062 [00:01<00:01, 70970.40it/s]
Adding feature api:  31%|███       | 57935/187062 [00:01<00:01, 75105.62it/s]
Adding feature api:  35%|███▌      | 66186/187062 [00:01<00:01, 77279.04it/s]
Adding feature api:  40%|███▉      | 74745/187062 [00:01<00:01, 79732.47it/s]
Adding feature api:  45%|████▍     | 83249/187062 [00:01<00:01, 81305.68it/s]
Adding feature api:  49%|████▉     | 91632/187062 [00:01<00:01, 81413.72it/s]
Adding feature api:  54%|█████▎    | 100146/187062 [00:01<00:01, 82516.84it/s]
Adding feature api:  58%|█████▊    | 108608/187062 [00:01<00:00, 83141.33it/s]
Adding feature api:  63%|██████▎   | 117136/187062 [00:01<00:00, 83779.01it/s]
Adding feature api:  67%|██████▋   | 125576/187062 [00:01<00:00, 83430.23it/s]
Adding feature api:  72%|███████▏  | 134191/187062 [00:02<00:00, 84237.66it/s]
Adding feature api:  76%|███████▋  | 142827/187062 [00:02<00:00, 84869.89it/s]
Adding feature api:  81%|████████  | 151337/187062 [00:02<00:00, 84157.42it/s]
Adding feature api:  85%|████████▌ | 159881/187062 [00:02<00:00, 84535.68it/s]
Adding feature api:  90%|█████████ | 168494/187062 [00:02<00:00, 85009.37it/s]
Adding feature api:  95%|█████████▍| 177004/187062 [00:02<00:00, 84208.29it/s]
Adding feature api:  99%|█████████▉| 185433/187062 [00:02<00:00, 55350.89it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64514.33it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:13:55,  2.24it/s]
Adding feature datatype:   4%|▍         | 7070/187062 [00:00<00:10, 17118.43it/s]
Adding feature datatype:   8%|▊         | 15152/187062 [00:00<00:05, 33469.66it/s]
Adding feature datatype:  12%|█▏        | 23274/187062 [00:00<00:03, 46286.60it/s]
Adding feature datatype:  17%|█▋        | 31457/187062 [00:00<00:02, 56137.25it/s]
Adding feature datatype:  21%|██        | 39613/187062 [00:00<00:02, 63347.35it/s]
Adding feature datatype:  26%|██▌       | 47799/187062 [00:01<00:02, 68682.99it/s]
Adding feature datatype:  30%|██▉       | 55956/187062 [00:01<00:01, 72440.35it/s]
Adding feature datatype:  34%|███▍      | 64178/187062 [00:01<00:01, 75315.18it/s]
Adding feature datatype:  39%|███▊      | 72316/187062 [00:01<00:01, 77108.57it/s]
Adding feature datatype:  43%|████▎     | 80523/187062 [00:01<00:01, 78576.54it/s]
Adding feature datatype:  47%|████▋     | 88713/187062 [00:01<00:01, 79564.31it/s]
Adding feature datatype:  52%|█████▏    | 96921/187062 [00:01<00:01, 80314.27it/s]
Adding feature datatype:  56%|█████▌    | 105143/187062 [00:01<00:01, 80882.58it/s]
Adding feature datatype:  61%|██████    | 113364/187062 [00:01<00:00, 81276.81it/s]
Adding feature datatype:  65%|██████▍   | 121550/187062 [00:01<00:00, 81432.19it/s]
Adding feature datatype:  69%|██████▉   | 129753/187062 [00:02<00:00, 81608.69it/s]
Adding feature datatype:  74%|███████▍  | 138014/187062 [00:02<00:00, 81905.71it/s]
Adding feature datatype:  78%|███████▊  | 146225/187062 [00:02<00:00, 81911.71it/s]
Adding feature datatype:  83%|████████▎ | 154431/187062 [00:02<00:00, 81927.73it/s]
Adding feature datatype:  87%|████████▋ | 162634/187062 [00:02<00:00, 81957.53it/s]
Adding feature datatype:  91%|█████████▏| 170872/187062 [00:02<00:00, 82083.45it/s]
Adding feature datatype:  96%|█████████▌| 179086/187062 [00:02<00:00, 74741.42it/s]
Adding feature datatype: 100%|█████████▉| 186691/187062 [00:02<00:00, 52024.20it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63375.48it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:27:04,  2.22it/s]
Adding feature literal:   4%|▍         | 7127/187062 [00:00<00:10, 17134.10it/s]
Adding feature literal:   8%|▊         | 15268/187062 [00:00<00:05, 33565.72it/s]
Adding feature literal:  13%|█▎        | 23454/187062 [00:00<00:03, 46484.51it/s]
Adding feature literal:  17%|█▋        | 31571/187062 [00:00<00:02, 56074.07it/s]
Adding feature literal:  21%|██▏       | 39823/187062 [00:00<00:02, 63560.14it/s]
Adding feature literal:  26%|██▌       | 48047/187062 [00:01<00:02, 68939.22it/s]
Adding feature literal:  30%|███       | 56290/187062 [00:01<00:01, 72869.56it/s]
Adding feature literal:  34%|███▍      | 64519/187062 [00:01<00:01, 75636.10it/s]
Adding feature literal:  39%|███▉      | 72562/187062 [00:01<00:01, 75714.78it/s]
Adding feature literal:  43%|████▎     | 80829/187062 [00:01<00:01, 77752.86it/s]
Adding feature literal:  48%|████▊     | 89076/187062 [00:01<00:01, 79144.23it/s]
Adding feature literal:  52%|█████▏    | 97323/187062 [00:01<00:01, 80129.50it/s]
Adding feature literal:  56%|█████▋    | 105526/187062 [00:01<00:01, 80692.46it/s]
Adding feature literal:  61%|██████    | 113773/187062 [00:01<00:00, 81221.97it/s]
Adding feature literal:  65%|██████▌   | 121994/187062 [00:01<00:00, 81515.35it/s]
Adding feature literal:  70%|██████▉   | 130304/187062 [00:02<00:00, 81988.73it/s]
Adding feature literal:  74%|███████▍  | 138533/187062 [00:02<00:00, 81964.22it/s]
Adding feature literal:  78%|███████▊  | 146820/187062 [00:02<00:00, 82233.41it/s]
Adding feature literal:  83%|████████▎ | 155098/187062 [00:02<00:00, 82394.67it/s]
Adding feature literal:  87%|████████▋ | 163348/187062 [00:02<00:00, 82127.26it/s]
Adding feature literal:  92%|█████████▏| 171653/187062 [00:02<00:00, 82399.71it/s]
Adding feature literal:  96%|█████████▌| 179899/187062 [00:02<00:00, 71105.44it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63344.86it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:14:32,  2.24it/s]
Adding feature operator:   4%|▍         | 7103/187062 [00:00<00:10, 17192.83it/s]
Adding feature operator:   8%|▊         | 15275/187062 [00:00<00:05, 33771.70it/s]
Adding feature operator:  13%|█▎        | 23452/187062 [00:00<00:03, 46658.41it/s]
Adding feature operator:  17%|█▋        | 31661/187062 [00:00<00:02, 56479.91it/s]
Adding feature operator:  21%|██▏       | 39938/187062 [00:00<00:02, 63936.00it/s]
Adding feature operator:  26%|██▌       | 48183/187062 [00:01<00:02, 69273.82it/s]
Adding feature operator:  30%|███       | 56425/187062 [00:01<00:01, 73108.11it/s]
Adding feature operator:  34%|███▍      | 64464/187062 [00:01<00:01, 75247.62it/s]
Adding feature operator:  39%|███▉      | 72701/187062 [00:01<00:01, 77353.19it/s]
Adding feature operator:  43%|████▎     | 80946/187062 [00:01<00:01, 78864.52it/s]
Adding feature operator:  48%|████▊     | 89213/187062 [00:01<00:01, 79996.68it/s]
Adding feature operator:  52%|█████▏    | 97492/187062 [00:01<00:01, 80829.09it/s]
Adding feature operator:  57%|█████▋    | 105723/187062 [00:01<00:01, 81271.31it/s]
Adding feature operator:  61%|██████    | 113970/187062 [00:01<00:00, 81628.46it/s]
Adding feature operator:  65%|██████▌   | 122214/187062 [00:01<00:00, 81869.15it/s]
Adding feature operator:  70%|██████▉   | 130471/187062 [00:02<00:00, 82078.53it/s]
Adding feature operator:  74%|███████▍  | 138708/187062 [00:02<00:00, 82120.50it/s]
Adding feature operator:  79%|███████▊  | 146956/187062 [00:02<00:00, 82227.21it/s]
Adding feature operator:  83%|████████▎ | 155227/187062 [00:02<00:00, 82368.85it/s]
Adding feature operator:  87%|████████▋ | 163513/187062 [00:02<00:00, 82515.02it/s]
Adding feature operator:  92%|█████████▏| 171777/187062 [00:02<00:00, 82551.58it/s]
Adding feature operator:  96%|█████████▌| 180037/187062 [00:02<00:00, 71032.68it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63594.03it/s]
[2024-10-12 17:58:37,018] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 17:58:38 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 17:58:38 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 413.54 examples/s]
Map:   2%|▏         | 108/6548 [00:00<00:26, 243.76 examples/s]
Map:   2%|▏         | 152/6548 [00:00<00:21, 294.73 examples/s]
Map:   3%|▎         | 193/6548 [00:00<00:20, 310.08 examples/s]
Map:   4%|▎         | 243/6548 [00:00<00:17, 360.30 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:18, 329.73 examples/s]
Map:   5%|▌         | 334/6548 [00:01<00:19, 318.25 examples/s]
Map:   6%|▌         | 373/6548 [00:01<00:18, 331.89 examples/s]
Map:   6%|▋         | 425/6548 [00:01<00:16, 377.05 examples/s]
Map:   7%|▋         | 465/6548 [00:01<00:19, 319.43 examples/s]
Map:   8%|▊         | 521/6548 [00:01<00:18, 328.44 examples/s]
Map:   9%|▊         | 570/6548 [00:01<00:16, 363.32 examples/s]
Map:   9%|▉         | 622/6548 [00:01<00:17, 343.09 examples/s]
Map:  10%|█         | 666/6548 [00:02<00:18, 317.51 examples/s]
Map:  11%|█         | 710/6548 [00:02<00:17, 342.87 examples/s]
Map:  12%|█▏        | 758/6548 [00:02<00:15, 371.36 examples/s]
Map:  12%|█▏        | 813/6548 [00:02<00:14, 408.81 examples/s]
Map:  13%|█▎        | 876/6548 [00:02<00:14, 402.88 examples/s]
Map:  14%|█▍        | 920/6548 [00:02<00:15, 362.19 examples/s]
Map:  15%|█▍        | 969/6548 [00:02<00:14, 388.00 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:24, 228.71 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 254.61 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:18, 289.39 examples/s]
Map:  18%|█▊        | 1146/6548 [00:03<00:16, 327.39 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 345.24 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:14, 355.56 examples/s]
Map:  20%|█▉        | 1301/6548 [00:03<00:15, 341.06 examples/s]
Map:  21%|██        | 1350/6548 [00:04<00:16, 324.19 examples/s]
Map:  21%|██        | 1391/6548 [00:04<00:16, 303.59 examples/s]
Map:  22%|██▏       | 1430/6548 [00:04<00:15, 321.68 examples/s]
Map:  22%|██▏       | 1469/6548 [00:04<00:17, 287.19 examples/s]
Map:  23%|██▎       | 1523/6548 [00:04<00:16, 305.13 examples/s]
Map:  24%|██▍       | 1560/6548 [00:04<00:17, 285.34 examples/s]
Map:  24%|██▍       | 1596/6548 [00:04<00:16, 294.84 examples/s]
Map:  25%|██▍       | 1633/6548 [00:05<00:17, 273.84 examples/s]
Map:  26%|██▌       | 1678/6548 [00:05<00:17, 271.96 examples/s]
Map:  26%|██▋       | 1720/6548 [00:05<00:16, 301.05 examples/s]
Map:  27%|██▋       | 1765/6548 [00:05<00:14, 335.39 examples/s]
Map:  28%|██▊       | 1807/6548 [00:05<00:13, 349.44 examples/s]
Map:  28%|██▊       | 1849/6548 [00:05<00:12, 365.66 examples/s]
Map:  29%|██▉       | 1890/6548 [00:05<00:14, 328.27 examples/s]
Map:  30%|██▉       | 1933/6548 [00:05<00:13, 350.29 examples/s]
Map:  30%|███       | 1973/6548 [00:06<00:12, 362.43 examples/s]
Map:  31%|███       | 2018/6548 [00:06<00:20, 223.72 examples/s]
Map:  31%|███▏      | 2049/6548 [00:06<00:19, 236.20 examples/s]
Map:  32%|███▏      | 2092/6548 [00:06<00:16, 271.51 examples/s]
Map:  32%|███▏      | 2126/6548 [00:06<00:15, 283.16 examples/s]
Map:  33%|███▎      | 2159/6548 [00:06<00:17, 250.47 examples/s]
Map:  34%|███▍      | 2210/6548 [00:07<00:14, 308.47 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:15, 274.29 examples/s]
Map:  35%|███▌      | 2293/6548 [00:07<00:14, 286.50 examples/s]
Map:  36%|███▌      | 2345/6548 [00:07<00:13, 303.24 examples/s]
Map:  37%|███▋      | 2396/6548 [00:07<00:13, 304.80 examples/s]
Map:  37%|███▋      | 2438/6548 [00:07<00:13, 304.29 examples/s]
Map:  38%|███▊      | 2476/6548 [00:07<00:12, 320.80 examples/s]
Map:  38%|███▊      | 2517/6548 [00:08<00:12, 327.99 examples/s]
Map:  39%|███▉      | 2573/6548 [00:08<00:11, 342.19 examples/s]
Map:  40%|███▉      | 2615/6548 [00:08<00:10, 358.83 examples/s]
Map:  41%|████      | 2658/6548 [00:08<00:11, 348.71 examples/s]
Map:  41%|████      | 2697/6548 [00:08<00:10, 357.44 examples/s]
Map:  42%|████▏     | 2734/6548 [00:08<00:11, 333.46 examples/s]
Map:  42%|████▏     | 2773/6548 [00:08<00:11, 335.89 examples/s]
Map:  43%|████▎     | 2808/6548 [00:08<00:11, 334.91 examples/s]
Map:  43%|████▎     | 2844/6548 [00:09<00:13, 279.38 examples/s]
Map:  44%|████▍     | 2879/6548 [00:09<00:12, 294.76 examples/s]
Map:  45%|████▍     | 2921/6548 [00:09<00:13, 271.98 examples/s]
Map:  45%|████▌     | 2965/6548 [00:09<00:11, 301.74 examples/s]
Map:  46%|████▌     | 3000/6548 [00:09<00:20, 175.20 examples/s]
Map:  46%|████▋     | 3043/6548 [00:10<00:17, 197.90 examples/s]
Map:  47%|████▋     | 3073/6548 [00:10<00:16, 208.00 examples/s]
Map:  48%|████▊     | 3115/6548 [00:10<00:14, 240.52 examples/s]
Map:  48%|████▊     | 3149/6548 [00:10<00:14, 241.59 examples/s]
Map:  49%|████▊     | 3183/6548 [00:10<00:13, 258.60 examples/s]
Map:  49%|████▉     | 3221/6548 [00:10<00:13, 243.51 examples/s]
Map:  50%|████▉     | 3262/6548 [00:10<00:11, 276.80 examples/s]
Map:  50%|█████     | 3295/6548 [00:10<00:11, 276.45 examples/s]
Map:  51%|█████     | 3340/6548 [00:11<00:10, 317.17 examples/s]
Map:  52%|█████▏    | 3378/6548 [00:11<00:09, 320.10 examples/s]
Map:  52%|█████▏    | 3430/6548 [00:11<00:10, 283.52 examples/s]
Map:  53%|█████▎    | 3473/6548 [00:11<00:12, 248.24 examples/s]
Map:  54%|█████▎    | 3517/6548 [00:11<00:10, 285.82 examples/s]
Map:  54%|█████▍    | 3562/6548 [00:11<00:09, 320.85 examples/s]
Map:  55%|█████▌    | 3611/6548 [00:11<00:08, 356.58 examples/s]
Map:  56%|█████▌    | 3667/6548 [00:12<00:08, 359.71 examples/s]
Map:  57%|█████▋    | 3713/6548 [00:12<00:07, 382.25 examples/s]
Map:  58%|█████▊    | 3774/6548 [00:12<00:07, 379.19 examples/s]
Map:  58%|█████▊    | 3820/6548 [00:12<00:07, 349.46 examples/s]
Map:  59%|█████▉    | 3864/6548 [00:12<00:08, 317.90 examples/s]
Map:  60%|█████▉    | 3902/6548 [00:12<00:08, 330.20 examples/s]
Map:  60%|██████    | 3956/6548 [00:12<00:08, 302.87 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 228.17 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 280.87 examples/s]
Map:  63%|██████▎   | 4095/6548 [00:13<00:08, 304.54 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 316.05 examples/s]
Map:  64%|██████▍   | 4188/6548 [00:13<00:07, 306.40 examples/s]
Map:  65%|██████▍   | 4241/6548 [00:13<00:07, 317.18 examples/s]
Map:  65%|██████▌   | 4288/6548 [00:14<00:06, 344.98 examples/s]
Map:  66%|██████▌   | 4332/6548 [00:14<00:06, 365.47 examples/s]
Map:  67%|██████▋   | 4381/6548 [00:14<00:06, 340.15 examples/s]
Map:  68%|██████▊   | 4427/6548 [00:14<00:05, 359.79 examples/s]
Map:  68%|██████▊   | 4474/6548 [00:14<00:06, 342.89 examples/s]
Map:  69%|██████▉   | 4520/6548 [00:14<00:06, 327.25 examples/s]
Map:  70%|██████▉   | 4572/6548 [00:14<00:06, 328.87 examples/s]
Map:  71%|███████   | 4626/6548 [00:15<00:05, 329.27 examples/s]
Map:  71%|███████▏  | 4668/6548 [00:15<00:05, 347.07 examples/s]
Map:  72%|███████▏  | 4727/6548 [00:15<00:05, 360.58 examples/s]
Map:  73%|███████▎  | 4768/6548 [00:15<00:04, 369.61 examples/s]
Map:  74%|███████▎  | 4820/6548 [00:15<00:04, 405.25 examples/s]
Map:  74%|███████▍  | 4874/6548 [00:15<00:04, 360.77 examples/s]
Map:  75%|███████▌  | 4914/6548 [00:15<00:04, 368.64 examples/s]
Map:  76%|███████▌  | 4970/6548 [00:15<00:03, 414.65 examples/s]
Map:  77%|███████▋  | 5030/6548 [00:16<00:06, 235.47 examples/s]
Map:  78%|███████▊  | 5075/6548 [00:16<00:05, 247.73 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 248.49 examples/s]
Map:  79%|███████▊  | 5154/6548 [00:16<00:05, 264.60 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:05, 270.16 examples/s]
Map:  80%|███████▉  | 5222/6548 [00:16<00:04, 283.96 examples/s]
Map:  80%|████████  | 5256/6548 [00:17<00:04, 284.42 examples/s]
Map:  81%|████████  | 5312/6548 [00:17<00:03, 349.02 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 305.08 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 298.23 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 328.29 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 325.36 examples/s]
Map:  85%|████████▍ | 5547/6548 [00:17<00:02, 347.26 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:18<00:03, 310.86 examples/s]
Map:  86%|████████▌ | 5632/6548 [00:18<00:02, 345.98 examples/s]
Map:  87%|████████▋ | 5678/6548 [00:18<00:02, 319.78 examples/s]
Map:  87%|████████▋ | 5728/6548 [00:18<00:02, 313.91 examples/s]
Map:  88%|████████▊ | 5773/6548 [00:18<00:02, 334.78 examples/s]
Map:  89%|████████▉ | 5813/6548 [00:18<00:02, 342.66 examples/s]
Map:  89%|████████▉ | 5856/6548 [00:18<00:01, 354.02 examples/s]
Map:  90%|█████████ | 5913/6548 [00:19<00:01, 361.22 examples/s]
Map:  91%|█████████ | 5964/6548 [00:19<00:01, 338.60 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 215.75 examples/s]
Map:  92%|█████████▏| 6042/6548 [00:19<00:02, 249.48 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 277.41 examples/s]
Map:  94%|█████████▎| 6124/6548 [00:19<00:01, 274.08 examples/s]
Map:  94%|█████████▍| 6165/6548 [00:20<00:01, 291.72 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:20<00:01, 310.51 examples/s]
Map:  96%|█████████▌| 6262/6548 [00:20<00:00, 320.46 examples/s]
Map:  96%|█████████▋| 6304/6548 [00:20<00:00, 341.89 examples/s]
Map:  97%|█████████▋| 6340/6548 [00:20<00:00, 344.21 examples/s]
Map:  98%|█████████▊| 6387/6548 [00:20<00:00, 366.98 examples/s]
Map:  98%|█████████▊| 6428/6548 [00:20<00:00, 375.89 examples/s]
Map:  99%|█████████▉| 6478/6548 [00:20<00:00, 405.72 examples/s]
Map: 100%|█████████▉| 6531/6548 [00:20<00:00, 382.71 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 309.52 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 326.75 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 348.78 examples/s]
Map:  13%|█▎        | 116/903 [00:00<00:02, 344.49 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 360.19 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 409.99 examples/s]
Map:  29%|██▉       | 263/903 [00:00<00:01, 382.20 examples/s]
Map:  35%|███▌      | 317/903 [00:00<00:01, 366.33 examples/s]
Map:  39%|███▉      | 355/903 [00:00<00:01, 369.31 examples/s]
Map:  45%|████▌     | 409/903 [00:01<00:01, 281.55 examples/s]
Map:  51%|█████     | 457/903 [00:01<00:01, 291.45 examples/s]
Map:  56%|█████▋    | 510/903 [00:01<00:01, 306.65 examples/s]
Map:  62%|██████▏   | 558/903 [00:01<00:01, 339.08 examples/s]
Map:  67%|██████▋   | 609/903 [00:01<00:00, 377.82 examples/s]
Map:  72%|███████▏  | 653/903 [00:01<00:00, 347.95 examples/s]
Map:  77%|███████▋  | 693/903 [00:02<00:00, 358.37 examples/s]
Map:  84%|████████▍ | 757/903 [00:02<00:00, 377.95 examples/s]
Map:  90%|████████▉ | 812/903 [00:02<00:00, 371.02 examples/s]
Map:  95%|█████████▍| 854/903 [00:02<00:00, 378.32 examples/s]
Map:  99%|█████████▉| 898/903 [00:02<00:00, 335.53 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 321.87 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 35/1882 [00:00<00:06, 273.03 examples/s]
Map:   4%|▍         | 75/1882 [00:00<00:05, 332.51 examples/s]
Map:   6%|▌         | 110/1882 [00:00<00:05, 330.34 examples/s]
Map:   9%|▉         | 165/1882 [00:00<00:05, 343.12 examples/s]
Map:  11%|█         | 202/1882 [00:00<00:04, 336.36 examples/s]
Map:  13%|█▎        | 245/1882 [00:00<00:04, 359.11 examples/s]
Map:  15%|█▍        | 282/1882 [00:00<00:04, 359.08 examples/s]
Map:  17%|█▋        | 325/1882 [00:00<00:04, 365.92 examples/s]
Map:  20%|█▉        | 369/1882 [00:01<00:04, 330.61 examples/s]
Map:  22%|██▏       | 407/1882 [00:01<00:05, 290.47 examples/s]
Map:  24%|██▎       | 445/1882 [00:01<00:04, 310.08 examples/s]
Map:  26%|██▌       | 482/1882 [00:01<00:04, 323.71 examples/s]
Map:  28%|██▊       | 532/1882 [00:01<00:04, 308.18 examples/s]
Map:  31%|███       | 576/1882 [00:01<00:03, 331.29 examples/s]
Map:  34%|███▎      | 633/1882 [00:01<00:03, 386.32 examples/s]
Map:  36%|███▌      | 677/1882 [00:01<00:03, 385.71 examples/s]
Map:  39%|███▉      | 734/1882 [00:02<00:03, 377.30 examples/s]
Map:  41%|████      | 773/1882 [00:02<00:03, 359.41 examples/s]
Map:  44%|████▎     | 819/1882 [00:02<00:03, 336.56 examples/s]
Map:  45%|████▌     | 855/1882 [00:02<00:03, 339.16 examples/s]
Map:  48%|████▊     | 899/1882 [00:02<00:02, 363.56 examples/s]
Map:  51%|█████     | 961/1882 [00:02<00:02, 378.28 examples/s]
Map:  53%|█████▎    | 1000/1882 [00:03<00:03, 239.21 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 262.88 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:02, 274.14 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 284.65 examples/s]
Map:  61%|██████    | 1144/1882 [00:03<00:02, 273.04 examples/s]
Map:  63%|██████▎   | 1177/1882 [00:03<00:02, 268.91 examples/s]
Map:  65%|██████▌   | 1226/1882 [00:03<00:02, 285.45 examples/s]
Map:  67%|██████▋   | 1256/1882 [00:03<00:02, 286.02 examples/s]
Map:  69%|██████▉   | 1305/1882 [00:04<00:01, 333.18 examples/s]
Map:  71%|███████▏  | 1341/1882 [00:04<00:01, 339.47 examples/s]
Map:  74%|███████▎  | 1385/1882 [00:04<00:01, 321.59 examples/s]
Map:  76%|███████▌  | 1426/1882 [00:04<00:01, 291.98 examples/s]
Map:  78%|███████▊  | 1468/1882 [00:04<00:01, 320.66 examples/s]
Map:  80%|███████▉  | 1503/1882 [00:04<00:01, 278.37 examples/s]
Map:  82%|████████▏ | 1535/1882 [00:04<00:01, 280.17 examples/s]
Map:  84%|████████▎ | 1575/1882 [00:04<00:01, 305.39 examples/s]
Map:  86%|████████▌ | 1619/1882 [00:05<00:00, 335.80 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 334.94 examples/s]
Map:  91%|█████████ | 1713/1882 [00:05<00:00, 339.16 examples/s]
Map:  93%|█████████▎| 1748/1882 [00:05<00:00, 286.20 examples/s]
Map:  95%|█████████▌| 1794/1882 [00:05<00:00, 290.27 examples/s]
Map:  98%|█████████▊| 1841/1882 [00:05<00:00, 326.62 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 236.50 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 308.92 examples/s]
10/12/2024 17:59:40 - INFO - __main__ -     ***** Testing *****
10/12/2024 17:59:40 - INFO - __main__ -     Batch size = 8
10/12/2024 17:59:40 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 17:59:41 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 17:59:41 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 17:59:42 - INFO - knnlm -   Reading datastore took 0.9666733741760254 s
10/12/2024 17:59:43 - INFO - knnlm -   Moving index to GPU took 0.967383861541748 s
10/12/2024 17:59:43 - INFO - __main__ -   ******************************break-into
10/12/2024 17:59:43 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 17:59:43 - INFO - __main__ -     Num examples = 236
10/12/2024 17:59:43 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<31:35,  8.07s/it]
test ppl:   1%|          | 2/236 [00:10<17:25,  4.47s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:04,  3.11s/it]
test ppl:   2%|▏         | 4/236 [00:13<09:47,  2.53s/it]
test ppl:   2%|▏         | 5/236 [00:19<14:21,  3.73s/it]
test ppl:   3%|▎         | 6/236 [00:21<12:26,  3.25s/it]
test ppl:   3%|▎         | 7/236 [00:23<11:31,  3.02s/it]
test ppl:   3%|▎         | 8/236 [00:28<13:00,  3.42s/it]
test ppl:   4%|▍         | 9/236 [00:34<15:51,  4.19s/it]
test ppl:   4%|▍         | 10/236 [00:37<14:26,  3.84s/it]
test ppl:   5%|▍         | 11/236 [00:39<12:41,  3.39s/it]
test ppl:   5%|▌         | 12/236 [00:45<15:28,  4.15s/it]
test ppl:   6%|▌         | 13/236 [00:50<16:10,  4.35s/it]
test ppl:   6%|▌         | 14/236 [00:56<17:50,  4.82s/it]
test ppl:   6%|▋         | 15/236 [00:58<15:06,  4.10s/it]
test ppl:   7%|▋         | 16/236 [01:00<13:03,  3.56s/it]
test ppl:   7%|▋         | 17/236 [01:07<16:39,  4.57s/it]
test ppl:   8%|▊         | 18/236 [01:09<13:48,  3.80s/it]
test ppl:   8%|▊         | 19/236 [01:15<15:23,  4.26s/it]
test ppl:   8%|▊         | 20/236 [01:17<13:01,  3.62s/it]
test ppl:   9%|▉         | 21/236 [01:19<11:59,  3.35s/it]
test ppl:   9%|▉         | 22/236 [01:26<15:54,  4.46s/it]
test ppl:  10%|▉         | 23/236 [01:29<14:17,  4.02s/it]
test ppl:  10%|█         | 24/236 [01:32<12:58,  3.67s/it]
test ppl:  11%|█         | 25/236 [01:35<11:22,  3.23s/it]
test ppl:  11%|█         | 26/236 [01:42<15:19,  4.38s/it]
test ppl:  11%|█▏        | 27/236 [01:47<15:52,  4.56s/it]
test ppl:  12%|█▏        | 28/236 [01:48<12:33,  3.62s/it]
test ppl:  12%|█▏        | 29/236 [01:51<11:38,  3.37s/it]
test ppl:  13%|█▎        | 30/236 [01:53<09:59,  2.91s/it]
test ppl:  13%|█▎        | 31/236 [01:56<10:30,  3.08s/it]
test ppl:  14%|█▎        | 32/236 [01:59<10:49,  3.18s/it]
test ppl:  14%|█▍        | 33/236 [02:07<14:41,  4.34s/it]
test ppl:  14%|█▍        | 34/236 [02:11<15:04,  4.48s/it]
test ppl:  15%|█▍        | 35/236 [02:14<13:32,  4.04s/it]
test ppl:  15%|█▌        | 36/236 [02:21<16:27,  4.94s/it]
test ppl:  16%|█▌        | 37/236 [02:28<18:27,  5.57s/it]
test ppl:  16%|█▌        | 38/236 [02:31<15:18,  4.64s/it]
test ppl:  17%|█▋        | 39/236 [02:33<12:25,  3.78s/it]
test ppl:  17%|█▋        | 40/236 [02:36<11:48,  3.62s/it]
test ppl:  17%|█▋        | 41/236 [02:39<11:09,  3.43s/it]
test ppl:  18%|█▊        | 42/236 [02:46<14:38,  4.53s/it]
test ppl:  18%|█▊        | 43/236 [02:53<16:58,  5.28s/it]
test ppl:  19%|█▊        | 44/236 [02:55<14:03,  4.39s/it]
test ppl:  19%|█▉        | 45/236 [02:58<12:02,  3.78s/it]
test ppl:  19%|█▉        | 46/236 [03:04<14:15,  4.50s/it]
test ppl:  20%|█▉        | 47/236 [03:11<16:36,  5.27s/it]
test ppl:  20%|██        | 48/236 [03:18<18:09,  5.80s/it]
test ppl:  21%|██        | 49/236 [03:22<16:19,  5.24s/it]
test ppl:  21%|██        | 50/236 [03:29<17:58,  5.80s/it]
test ppl:  22%|██▏       | 51/236 [03:36<19:03,  6.18s/it]
test ppl:  22%|██▏       | 52/236 [03:43<19:43,  6.43s/it]
test ppl:  22%|██▏       | 53/236 [03:50<19:41,  6.45s/it]
test ppl:  23%|██▎       | 54/236 [03:51<15:22,  5.07s/it]
test ppl:  23%|██▎       | 55/236 [03:58<16:49,  5.58s/it]
test ppl:  24%|██▎       | 56/236 [04:02<15:22,  5.12s/it]
test ppl:  24%|██▍       | 57/236 [04:05<13:26,  4.50s/it]
test ppl:  25%|██▍       | 58/236 [04:08<11:40,  3.94s/it]
test ppl:  25%|██▌       | 59/236 [04:15<14:22,  4.87s/it]
test ppl:  25%|██▌       | 60/236 [04:19<13:24,  4.57s/it]
test ppl:  26%|██▌       | 61/236 [04:25<14:45,  5.06s/it]
test ppl:  26%|██▋       | 62/236 [04:30<14:34,  5.02s/it]
test ppl:  27%|██▋       | 63/236 [04:33<12:41,  4.40s/it]
test ppl:  27%|██▋       | 64/236 [04:35<10:23,  3.62s/it]
test ppl:  28%|██▊       | 65/236 [04:36<08:34,  3.01s/it]
test ppl:  28%|██▊       | 66/236 [04:40<09:00,  3.18s/it]
test ppl:  28%|██▊       | 67/236 [04:47<12:14,  4.34s/it]
test ppl:  29%|██▉       | 68/236 [04:54<14:26,  5.15s/it]
test ppl:  29%|██▉       | 69/236 [05:01<15:54,  5.72s/it]
test ppl:  30%|██▉       | 70/236 [05:03<12:40,  4.58s/it]
test ppl:  30%|███       | 71/236 [05:08<12:47,  4.65s/it]
test ppl:  31%|███       | 72/236 [05:12<12:38,  4.62s/it]
test ppl:  31%|███       | 73/236 [05:17<12:33,  4.62s/it]
test ppl:  31%|███▏      | 74/236 [05:19<10:12,  3.78s/it]
test ppl:  32%|███▏      | 75/236 [05:26<12:45,  4.75s/it]
test ppl:  32%|███▏      | 76/236 [05:31<12:45,  4.78s/it]
test ppl:  33%|███▎      | 77/236 [05:33<11:01,  4.16s/it]
test ppl:  33%|███▎      | 78/236 [05:36<09:28,  3.60s/it]
test ppl:  33%|███▎      | 79/236 [05:42<11:17,  4.32s/it]
test ppl:  34%|███▍      | 80/236 [05:44<09:39,  3.71s/it]
test ppl:  34%|███▍      | 81/236 [05:51<12:09,  4.71s/it]
test ppl:  35%|███▍      | 82/236 [05:58<13:53,  5.41s/it]
test ppl:  35%|███▌      | 83/236 [06:00<11:29,  4.51s/it]
test ppl:  36%|███▌      | 84/236 [06:03<09:43,  3.84s/it]
test ppl:  36%|███▌      | 85/236 [06:09<11:52,  4.72s/it]
test ppl:  36%|███▋      | 86/236 [06:12<10:13,  4.09s/it]
test ppl:  37%|███▋      | 87/236 [06:15<08:59,  3.62s/it]
test ppl:  37%|███▋      | 88/236 [06:22<11:25,  4.63s/it]
test ppl:  38%|███▊      | 89/236 [06:29<13:06,  5.35s/it]
test ppl:  38%|███▊      | 90/236 [06:36<14:15,  5.86s/it]
test ppl:  39%|███▊      | 91/236 [06:43<14:58,  6.20s/it]
test ppl:  39%|███▉      | 92/236 [06:46<12:50,  5.35s/it]
test ppl:  39%|███▉      | 93/236 [06:53<13:54,  5.84s/it]
test ppl:  40%|███▉      | 94/236 [07:00<14:39,  6.19s/it]
test ppl:  40%|████      | 95/236 [07:04<13:00,  5.54s/it]
test ppl:  41%|████      | 96/236 [07:08<11:31,  4.94s/it]
test ppl:  41%|████      | 97/236 [07:15<12:53,  5.56s/it]
test ppl:  42%|████▏     | 98/236 [07:22<13:48,  6.00s/it]
test ppl:  42%|████▏     | 99/236 [07:29<14:23,  6.31s/it]
test ppl:  42%|████▏     | 100/236 [07:30<11:04,  4.89s/it]
test ppl:  43%|████▎     | 101/236 [07:37<12:25,  5.53s/it]
test ppl:  43%|████▎     | 102/236 [07:42<11:32,  5.17s/it]
test ppl:  44%|████▎     | 103/236 [07:44<09:42,  4.38s/it]
test ppl:  44%|████▍     | 104/236 [07:49<10:06,  4.59s/it]
test ppl:  44%|████▍     | 105/236 [07:54<10:05,  4.62s/it]
test ppl:  45%|████▍     | 106/236 [08:00<11:12,  5.17s/it]
test ppl:  45%|████▌     | 107/236 [08:03<09:21,  4.35s/it]
test ppl:  46%|████▌     | 108/236 [08:07<09:06,  4.27s/it]
test ppl:  46%|████▌     | 109/236 [08:12<09:52,  4.67s/it]
test ppl:  47%|████▋     | 110/236 [08:15<08:13,  3.91s/it]
test ppl:  47%|████▋     | 111/236 [08:19<08:18,  3.99s/it]
test ppl:  47%|████▋     | 112/236 [08:22<07:49,  3.79s/it]
test ppl:  48%|████▊     | 113/236 [08:24<06:43,  3.28s/it]
test ppl:  48%|████▊     | 114/236 [08:28<07:08,  3.51s/it]
test ppl:  49%|████▊     | 115/236 [08:35<09:11,  4.55s/it]
test ppl:  49%|████▉     | 116/236 [08:42<10:20,  5.17s/it]
test ppl:  50%|████▉     | 117/236 [08:44<08:29,  4.28s/it]
test ppl:  50%|█████     | 118/236 [08:49<08:59,  4.57s/it]
test ppl:  50%|█████     | 119/236 [08:53<08:32,  4.38s/it]
test ppl:  51%|█████     | 120/236 [08:55<06:50,  3.54s/it]
test ppl:  51%|█████▏    | 121/236 [09:02<08:47,  4.58s/it]
test ppl:  52%|█████▏    | 122/236 [09:08<09:21,  4.92s/it]
test ppl:  52%|█████▏    | 123/236 [09:10<07:56,  4.22s/it]
test ppl:  53%|█████▎    | 124/236 [09:13<07:21,  3.94s/it]
test ppl:  53%|█████▎    | 125/236 [09:18<07:34,  4.09s/it]
test ppl:  53%|█████▎    | 126/236 [09:22<07:40,  4.18s/it]
test ppl:  54%|█████▍    | 127/236 [09:25<06:32,  3.60s/it]
test ppl:  54%|█████▍    | 128/236 [09:27<05:59,  3.33s/it]
test ppl:  55%|█████▍    | 129/236 [09:32<06:45,  3.79s/it]
test ppl:  55%|█████▌    | 130/236 [09:37<07:28,  4.23s/it]
test ppl:  56%|█████▌    | 131/236 [09:44<08:52,  5.07s/it]
test ppl:  56%|█████▌    | 132/236 [09:47<07:41,  4.43s/it]
test ppl:  56%|█████▋    | 133/236 [09:52<07:44,  4.51s/it]
test ppl:  57%|█████▋    | 134/236 [09:57<07:59,  4.70s/it]
test ppl:  57%|█████▋    | 135/236 [10:04<09:05,  5.40s/it]
test ppl:  58%|█████▊    | 136/236 [10:06<07:01,  4.21s/it]
test ppl:  58%|█████▊    | 137/236 [10:13<08:22,  5.07s/it]
test ppl:  58%|█████▊    | 138/236 [10:17<07:40,  4.70s/it]
test ppl:  59%|█████▉    | 139/236 [10:20<06:48,  4.21s/it]
test ppl:  59%|█████▉    | 140/236 [10:22<05:55,  3.71s/it]
test ppl:  60%|█████▉    | 141/236 [10:26<05:44,  3.63s/it]
test ppl:  60%|██████    | 142/236 [10:28<05:10,  3.30s/it]
test ppl:  61%|██████    | 143/236 [10:35<06:51,  4.42s/it]
test ppl:  61%|██████    | 144/236 [10:38<06:14,  4.08s/it]
test ppl:  61%|██████▏   | 145/236 [10:45<07:20,  4.84s/it]
test ppl:  62%|██████▏   | 146/236 [10:50<07:30,  5.00s/it]
test ppl:  62%|██████▏   | 147/236 [10:57<08:19,  5.62s/it]
test ppl:  63%|██████▎   | 148/236 [11:04<08:30,  5.80s/it]
test ppl:  63%|██████▎   | 149/236 [11:07<07:20,  5.06s/it]
test ppl:  64%|██████▎   | 150/236 [11:11<06:48,  4.75s/it]
test ppl:  64%|██████▍   | 151/236 [11:17<07:11,  5.08s/it]
test ppl:  64%|██████▍   | 152/236 [11:23<07:25,  5.30s/it]
test ppl:  65%|██████▍   | 153/236 [11:29<07:33,  5.46s/it]
test ppl:  65%|██████▌   | 154/236 [11:31<06:15,  4.58s/it]
test ppl:  66%|██████▌   | 155/236 [11:34<05:22,  3.98s/it]
test ppl:  66%|██████▌   | 156/236 [11:36<04:34,  3.43s/it]
test ppl:  67%|██████▋   | 157/236 [11:38<04:01,  3.06s/it]
test ppl:  67%|██████▋   | 158/236 [11:44<05:04,  3.90s/it]
test ppl:  67%|██████▋   | 159/236 [11:50<05:44,  4.48s/it]
test ppl:  68%|██████▊   | 160/236 [11:51<04:24,  3.49s/it]
test ppl:  68%|██████▊   | 161/236 [11:52<03:33,  2.85s/it]
test ppl:  69%|██████▊   | 162/236 [11:55<03:31,  2.86s/it]
test ppl:  69%|██████▉   | 163/236 [11:58<03:21,  2.76s/it]
test ppl:  69%|██████▉   | 164/236 [12:01<03:36,  3.01s/it]
test ppl:  70%|██████▉   | 165/236 [12:07<04:23,  3.72s/it]
test ppl:  70%|███████   | 166/236 [12:10<04:11,  3.59s/it]
test ppl:  71%|███████   | 167/236 [12:11<03:24,  2.96s/it]
test ppl:  71%|███████   | 168/236 [12:16<03:48,  3.36s/it]
test ppl:  72%|███████▏  | 169/236 [12:21<04:25,  3.96s/it]
test ppl:  72%|███████▏  | 170/236 [12:27<04:59,  4.54s/it]
test ppl:  72%|███████▏  | 171/236 [12:28<03:52,  3.58s/it]
test ppl:  73%|███████▎  | 172/236 [12:31<03:24,  3.19s/it]
test ppl:  73%|███████▎  | 173/236 [12:34<03:26,  3.27s/it]
test ppl:  74%|███████▎  | 174/236 [12:40<04:11,  4.05s/it]
test ppl:  74%|███████▍  | 175/236 [12:42<03:26,  3.38s/it]
test ppl:  75%|███████▍  | 176/236 [12:47<03:49,  3.82s/it]
test ppl:  75%|███████▌  | 177/236 [12:52<04:21,  4.43s/it]
test ppl:  75%|███████▌  | 178/236 [12:58<04:42,  4.87s/it]
test ppl:  76%|███████▌  | 179/236 [13:04<04:54,  5.17s/it]
test ppl:  76%|███████▋  | 180/236 [13:09<04:39,  4.99s/it]
test ppl:  77%|███████▋  | 181/236 [13:15<04:48,  5.24s/it]
test ppl:  77%|███████▋  | 182/236 [13:16<03:48,  4.23s/it]
test ppl:  78%|███████▊  | 183/236 [13:19<03:13,  3.65s/it]
test ppl:  78%|███████▊  | 184/236 [13:20<02:35,  2.98s/it]
test ppl:  78%|███████▊  | 185/236 [13:25<02:53,  3.40s/it]
test ppl:  79%|███████▉  | 186/236 [13:30<03:26,  4.13s/it]
test ppl:  79%|███████▉  | 187/236 [13:36<03:48,  4.67s/it]
test ppl:  80%|███████▉  | 188/236 [13:42<04:01,  5.03s/it]
test ppl:  80%|████████  | 189/236 [13:48<04:08,  5.29s/it]
test ppl:  81%|████████  | 190/236 [13:52<03:45,  4.90s/it]
test ppl:  81%|████████  | 191/236 [13:56<03:32,  4.73s/it]
test ppl:  81%|████████▏ | 192/236 [13:59<03:00,  4.09s/it]
test ppl:  82%|████████▏ | 193/236 [14:05<03:18,  4.63s/it]
test ppl:  82%|████████▏ | 194/236 [14:07<02:48,  4.02s/it]
test ppl:  83%|████████▎ | 195/236 [14:11<02:32,  3.73s/it]
test ppl:  83%|████████▎ | 196/236 [14:13<02:08,  3.22s/it]
test ppl:  83%|████████▎ | 197/236 [14:15<01:57,  3.02s/it]
test ppl:  84%|████████▍ | 198/236 [14:21<02:27,  3.87s/it]
test ppl:  84%|████████▍ | 199/236 [14:24<02:10,  3.52s/it]
test ppl:  85%|████████▍ | 200/236 [14:30<02:31,  4.22s/it]
test ppl:  85%|████████▌ | 201/236 [14:32<02:04,  3.56s/it]
test ppl:  86%|████████▌ | 202/236 [14:36<02:11,  3.87s/it]
test ppl:  86%|████████▌ | 203/236 [14:42<02:27,  4.47s/it]
test ppl:  86%|████████▋ | 204/236 [14:43<01:54,  3.57s/it]
test ppl:  87%|████████▋ | 205/236 [14:49<02:12,  4.27s/it]
test ppl:  87%|████████▋ | 206/236 [14:53<01:59,  3.97s/it]
test ppl:  88%|████████▊ | 207/236 [14:58<02:11,  4.54s/it]
test ppl:  88%|████████▊ | 208/236 [15:02<01:55,  4.11s/it]
test ppl:  89%|████████▊ | 209/236 [15:08<02:05,  4.66s/it]
test ppl:  89%|████████▉ | 210/236 [15:10<01:43,  3.96s/it]
test ppl:  89%|████████▉ | 211/236 [15:15<01:45,  4.21s/it]
test ppl:  90%|████████▉ | 212/236 [15:19<01:44,  4.36s/it]
test ppl:  90%|█████████ | 213/236 [15:25<01:50,  4.81s/it]
test ppl:  91%|█████████ | 214/236 [15:27<01:24,  3.86s/it]
test ppl:  91%|█████████ | 215/236 [15:33<01:33,  4.46s/it]
test ppl:  92%|█████████▏| 216/236 [15:35<01:17,  3.89s/it]
test ppl:  92%|█████████▏| 217/236 [15:41<01:25,  4.51s/it]
test ppl:  92%|█████████▏| 218/236 [15:43<01:07,  3.74s/it]
test ppl:  93%|█████████▎| 219/236 [15:49<01:14,  4.38s/it]
test ppl:  93%|█████████▎| 220/236 [15:55<01:17,  4.82s/it]
test ppl:  94%|█████████▎| 221/236 [15:58<01:04,  4.30s/it]
test ppl:  94%|█████████▍| 222/236 [16:04<01:06,  4.77s/it]
test ppl:  94%|█████████▍| 223/236 [16:10<01:06,  5.10s/it]
test ppl:  95%|█████████▍| 224/236 [16:11<00:47,  3.95s/it]
test ppl:  95%|█████████▌| 225/236 [16:17<00:49,  4.52s/it]
test ppl:  96%|█████████▌| 226/236 [16:20<00:42,  4.25s/it]
test ppl:  96%|█████████▌| 227/236 [16:23<00:33,  3.70s/it]
test ppl:  97%|█████████▋| 228/236 [16:25<00:25,  3.19s/it]
test ppl:  97%|█████████▋| 229/236 [16:31<00:27,  3.99s/it]
test ppl:  97%|█████████▋| 230/236 [16:34<00:23,  3.84s/it]
test ppl:  98%|█████████▊| 231/236 [16:38<00:18,  3.69s/it]
test ppl:  98%|█████████▊| 232/236 [16:39<00:12,  3.11s/it]
test ppl:  99%|█████████▊| 233/236 [16:43<00:10,  3.39s/it]
test ppl:  99%|█████████▉| 234/236 [16:45<00:05,  2.74s/it]
test ppl: 100%|█████████▉| 235/236 [16:50<00:03,  3.68s/it]
test ppl: 100%|██████████| 236/236 [16:51<00:00,  2.77s/it]
test ppl: 100%|██████████| 236/236 [16:51<00:00,  4.29s/it]
10/12/2024 18:16:35 - INFO - __main__ -    em: 0.2088
10/12/2024 18:16:35 - INFO - __main__ -   Finish and take 18m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.2 100:  em: 0.2088

--------------------------------------------------------------------------------
Running experiment with knn_temp=100, lmbda=0.4, k=16
2024-10-12 18:16:41.983079: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 18:16:42.002653: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 18:16:42.024591: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 18:16:42.031229: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 18:16:42.047309: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 18:16:43.035299: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 18:16:44 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.4, knn_temp=100, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 18:16:44 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:37:27,  2.20it/s]
Adding feature api:   4%|▎         | 6926/187062 [00:00<00:10, 16558.21it/s]
Adding feature api:   8%|▊         | 15105/187062 [00:00<00:05, 33164.71it/s]
Adding feature api:  12%|█▏        | 23349/187062 [00:00<00:03, 46304.69it/s]
Adding feature api:  17%|█▋        | 31628/187062 [00:00<00:02, 56369.56it/s]
Adding feature api:  21%|██        | 39642/187062 [00:00<00:02, 63087.11it/s]
Adding feature api:  26%|██▌       | 47937/187062 [00:01<00:02, 68799.44it/s]
Adding feature api:  30%|███       | 56242/187062 [00:01<00:01, 72947.46it/s]
Adding feature api:  35%|███▍      | 64596/187062 [00:01<00:01, 76059.05it/s]
Adding feature api:  39%|███▉      | 72879/187062 [00:01<00:01, 78059.37it/s]
Adding feature api:  43%|████▎     | 81030/187062 [00:01<00:01, 78828.79it/s]
Adding feature api:  48%|████▊     | 89313/187062 [00:01<00:01, 80015.99it/s]
Adding feature api:  52%|█████▏    | 97617/187062 [00:01<00:01, 80916.22it/s]
Adding feature api:  57%|█████▋    | 105902/187062 [00:01<00:00, 81491.81it/s]
Adding feature api:  61%|██████    | 114136/187062 [00:01<00:00, 81187.04it/s]
Adding feature api:  65%|██████▌   | 122441/187062 [00:01<00:00, 81741.30it/s]
Adding feature api:  70%|██████▉   | 130786/187062 [00:02<00:00, 82250.15it/s]
Adding feature api:  74%|███████▍  | 139109/187062 [00:02<00:00, 82540.10it/s]
Adding feature api:  79%|███████▉  | 147385/187062 [00:02<00:00, 81755.63it/s]
Adding feature api:  83%|████████▎ | 155621/187062 [00:02<00:00, 81933.43it/s]
Adding feature api:  88%|████████▊ | 163839/187062 [00:02<00:00, 82004.68it/s]
Adding feature api:  92%|█████████▏| 172062/187062 [00:02<00:00, 82069.14it/s]
Adding feature api:  96%|█████████▋| 180275/187062 [00:02<00:00, 69618.13it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 63381.21it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:59:08,  2.17it/s]
Adding feature datatype:   4%|▎         | 7003/187062 [00:00<00:10, 16549.41it/s]
Adding feature datatype:   8%|▊         | 14909/187062 [00:00<00:05, 32326.40it/s]
Adding feature datatype:  12%|█▏        | 22819/187062 [00:00<00:03, 44721.59it/s]
Adding feature datatype:  16%|█▋        | 30792/187062 [00:00<00:02, 54334.58it/s]
Adding feature datatype:  21%|██        | 38392/187062 [00:00<00:02, 60437.92it/s]
Adding feature datatype:  25%|██▍       | 46345/187062 [00:01<00:02, 65914.79it/s]
Adding feature datatype:  29%|██▉       | 54289/187062 [00:01<00:01, 69846.65it/s]
Adding feature datatype:  33%|███▎      | 62258/187062 [00:01<00:01, 72732.45it/s]
Adding feature datatype:  38%|███▊      | 70251/187062 [00:01<00:01, 74856.22it/s]
Adding feature datatype:  42%|████▏     | 78251/187062 [00:01<00:01, 76379.92it/s]
Adding feature datatype:  46%|████▌     | 86128/187062 [00:01<00:01, 76610.20it/s]
Adding feature datatype:  50%|█████     | 94127/187062 [00:01<00:01, 77612.23it/s]
Adding feature datatype:  55%|█████▍    | 102074/187062 [00:01<00:01, 78164.44it/s]
Adding feature datatype:  59%|█████▉    | 110065/187062 [00:01<00:00, 78683.09it/s]
Adding feature datatype:  63%|██████▎   | 118034/187062 [00:01<00:00, 78983.32it/s]
Adding feature datatype:  67%|██████▋   | 126036/187062 [00:02<00:00, 79290.55it/s]
Adding feature datatype:  72%|███████▏  | 133994/187062 [00:02<00:00, 78434.18it/s]
Adding feature datatype:  76%|███████▌  | 141999/187062 [00:02<00:00, 78912.60it/s]
Adding feature datatype:  80%|████████  | 149982/187062 [00:02<00:00, 79183.41it/s]
Adding feature datatype:  84%|████████▍ | 157933/187062 [00:02<00:00, 79280.16it/s]
Adding feature datatype:  89%|████████▊ | 165987/187062 [00:02<00:00, 79654.15it/s]
Adding feature datatype:  93%|█████████▎| 173959/187062 [00:02<00:00, 78857.78it/s]
Adding feature datatype:  97%|█████████▋| 181851/187062 [00:02<00:00, 60831.93it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 61585.40it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:40:28,  2.19it/s]
Adding feature literal:   4%|▎         | 6960/187062 [00:00<00:10, 16612.72it/s]
Adding feature literal:   8%|▊         | 14974/187062 [00:00<00:05, 32765.88it/s]
Adding feature literal:  12%|█▏        | 22981/187062 [00:00<00:03, 45368.97it/s]
Adding feature literal:  17%|█▋        | 31034/187062 [00:00<00:02, 55062.61it/s]
Adding feature literal:  21%|██        | 39015/187062 [00:00<00:02, 62053.40it/s]
Adding feature literal:  25%|██▌       | 47119/187062 [00:01<00:02, 67510.54it/s]
Adding feature literal:  29%|██▉       | 55155/187062 [00:01<00:01, 71250.03it/s]
Adding feature literal:  34%|███▍      | 63241/187062 [00:01<00:01, 74072.52it/s]
Adding feature literal:  38%|███▊      | 71123/187062 [00:01<00:01, 75374.20it/s]
Adding feature literal:  42%|████▏     | 78994/187062 [00:01<00:01, 74160.59it/s]
Adding feature literal:  46%|████▋     | 86646/187062 [00:01<00:01, 73357.96it/s]
Adding feature literal:  50%|█████     | 94147/187062 [00:01<00:01, 72858.74it/s]
Adding feature literal:  54%|█████▍    | 101547/187062 [00:01<00:01, 72391.20it/s]
Adding feature literal:  58%|█████▊    | 108865/187062 [00:01<00:01, 72141.65it/s]
Adding feature literal:  62%|██████▏   | 116134/187062 [00:01<00:00, 71923.84it/s]
Adding feature literal:  66%|██████▌   | 123365/187062 [00:02<00:00, 71737.52it/s]
Adding feature literal:  70%|███████   | 131407/187062 [00:02<00:00, 74291.19it/s]
Adding feature literal:  75%|███████▍  | 139469/187062 [00:02<00:00, 76162.93it/s]
Adding feature literal:  79%|███████▉  | 147568/187062 [00:02<00:00, 77595.52it/s]
Adding feature literal:  83%|████████▎ | 155655/187062 [00:02<00:00, 78570.11it/s]
Adding feature literal:  88%|████████▊ | 163708/187062 [00:02<00:00, 79152.20it/s]
Adding feature literal:  92%|█████████▏| 171797/187062 [00:02<00:00, 79670.00it/s]
Adding feature literal:  96%|█████████▌| 179770/187062 [00:02<00:00, 69905.12it/s]
Adding feature literal: 100%|█████████▉| 186981/187062 [00:03<00:00, 50386.54it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 60665.71it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:38:32,  2.20it/s]
Adding feature operator:   4%|▎         | 6887/187062 [00:00<00:10, 16455.22it/s]
Adding feature operator:   8%|▊         | 14923/187062 [00:00<00:05, 32716.78it/s]
Adding feature operator:  12%|█▏        | 22984/187062 [00:00<00:03, 45484.46it/s]
Adding feature operator:  17%|█▋        | 31044/187062 [00:00<00:02, 55169.36it/s]
Adding feature operator:  21%|██        | 39101/187062 [00:00<00:02, 62348.09it/s]
Adding feature operator:  25%|██▌       | 47187/187062 [00:01<00:02, 67671.63it/s]
Adding feature operator:  29%|██▉       | 55104/187062 [00:01<00:01, 71018.59it/s]
Adding feature operator:  34%|███▍      | 63206/187062 [00:01<00:01, 73954.74it/s]
Adding feature operator:  38%|███▊      | 71266/187062 [00:01<00:01, 75918.23it/s]
Adding feature operator:  42%|████▏     | 79368/187062 [00:01<00:01, 77431.39it/s]
Adding feature operator:  47%|████▋     | 87459/187062 [00:01<00:01, 78465.35it/s]
Adding feature operator:  51%|█████     | 95619/187062 [00:01<00:01, 79395.68it/s]
Adding feature operator:  55%|█████▌    | 103729/187062 [00:01<00:01, 79903.50it/s]
Adding feature operator:  60%|█████▉    | 111890/187062 [00:01<00:00, 80413.37it/s]
Adding feature operator:  64%|██████▍   | 119990/187062 [00:01<00:00, 80476.45it/s]
Adding feature operator:  69%|██████▊   | 128151/187062 [00:02<00:00, 80814.51it/s]
Adding feature operator:  73%|███████▎  | 136306/187062 [00:02<00:00, 81033.85it/s]
Adding feature operator:  77%|███████▋  | 144445/187062 [00:02<00:00, 81137.30it/s]
Adding feature operator:  82%|████████▏ | 152573/187062 [00:02<00:00, 81128.72it/s]
Adding feature operator:  86%|████████▌ | 160696/187062 [00:02<00:00, 81096.86it/s]
Adding feature operator:  90%|█████████ | 168813/187062 [00:02<00:00, 80965.24it/s]
Adding feature operator:  95%|█████████▍| 176915/187062 [00:02<00:00, 80958.89it/s]
Adding feature operator:  99%|█████████▉| 185015/187062 [00:02<00:00, 53927.46it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 62594.48it/s]
[2024-10-12 18:17:28,377] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 18:17:29 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 18:17:29 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 42/6548 [00:00<00:16, 405.95 examples/s]
Map:   2%|▏         | 107/6548 [00:00<00:26, 247.65 examples/s]
Map:   2%|▏         | 141/6548 [00:00<00:23, 271.98 examples/s]
Map:   3%|▎         | 180/6548 [00:00<00:20, 303.70 examples/s]
Map:   3%|▎         | 227/6548 [00:00<00:18, 350.87 examples/s]
Map:   4%|▍         | 286/6548 [00:00<00:17, 356.00 examples/s]
Map:   5%|▍         | 327/6548 [00:01<00:20, 311.03 examples/s]
Map:   6%|▌         | 363/6548 [00:01<00:19, 320.55 examples/s]
Map:   6%|▋         | 417/6548 [00:01<00:16, 373.76 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:17, 350.64 examples/s]
Map:   8%|▊         | 511/6548 [00:01<00:16, 358.64 examples/s]
Map:   9%|▊         | 563/6548 [00:01<00:15, 397.08 examples/s]
Map:   9%|▉         | 606/6548 [00:01<00:14, 402.89 examples/s]
Map:  10%|█         | 660/6548 [00:01<00:17, 331.39 examples/s]
Map:  11%|█         | 706/6548 [00:02<00:16, 357.61 examples/s]
Map:  11%|█▏        | 748/6548 [00:02<00:15, 369.73 examples/s]
Map:  12%|█▏        | 800/6548 [00:02<00:14, 406.81 examples/s]
Map:  13%|█▎        | 862/6548 [00:02<00:13, 407.99 examples/s]
Map:  14%|█▍        | 917/6548 [00:02<00:14, 390.56 examples/s]
Map:  15%|█▍        | 971/6548 [00:02<00:14, 379.06 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:22, 241.68 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:20, 265.44 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:18, 298.09 examples/s]
Map:  18%|█▊        | 1146/6548 [00:03<00:16, 334.10 examples/s]
Map:  18%|█▊        | 1185/6548 [00:03<00:15, 342.63 examples/s]
Map:  19%|█▊        | 1227/6548 [00:03<00:14, 356.09 examples/s]
Map:  20%|█▉        | 1280/6548 [00:03<00:15, 350.36 examples/s]
Map:  20%|██        | 1326/6548 [00:03<00:15, 332.30 examples/s]
Map:  21%|██        | 1369/6548 [00:04<00:16, 310.34 examples/s]
Map:  22%|██▏       | 1408/6548 [00:04<00:17, 294.29 examples/s]
Map:  22%|██▏       | 1461/6548 [00:04<00:18, 274.93 examples/s]
Map:  23%|██▎       | 1493/6548 [00:04<00:17, 281.71 examples/s]
Map:  23%|██▎       | 1530/6548 [00:04<00:16, 299.67 examples/s]
Map:  24%|██▍       | 1576/6548 [00:04<00:17, 291.73 examples/s]
Map:  25%|██▍       | 1609/6548 [00:04<00:17, 287.66 examples/s]
Map:  25%|██▌       | 1639/6548 [00:05<00:17, 288.61 examples/s]
Map:  26%|██▌       | 1676/6548 [00:05<00:18, 265.27 examples/s]
Map:  26%|██▌       | 1717/6548 [00:05<00:16, 295.59 examples/s]
Map:  27%|██▋       | 1765/6548 [00:05<00:14, 337.72 examples/s]
Map:  28%|██▊       | 1807/6548 [00:05<00:13, 350.89 examples/s]
Map:  28%|██▊       | 1848/6548 [00:05<00:12, 365.51 examples/s]
Map:  29%|██▉       | 1901/6548 [00:05<00:13, 351.05 examples/s]
Map:  30%|██▉       | 1961/6548 [00:05<00:12, 360.76 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:18, 243.56 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:17, 252.46 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:15, 281.08 examples/s]
Map:  32%|███▏      | 2105/6548 [00:06<00:15, 289.42 examples/s]
Map:  33%|███▎      | 2142/6548 [00:06<00:16, 265.82 examples/s]
Map:  33%|███▎      | 2182/6548 [00:06<00:14, 294.51 examples/s]
Map:  34%|███▍      | 2229/6548 [00:07<00:14, 292.08 examples/s]
Map:  35%|███▍      | 2271/6548 [00:07<00:15, 281.39 examples/s]
Map:  35%|███▌      | 2310/6548 [00:07<00:13, 302.90 examples/s]
Map:  36%|███▌      | 2352/6548 [00:07<00:12, 329.49 examples/s]
Map:  37%|███▋      | 2405/6548 [00:07<00:12, 332.82 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:12, 326.30 examples/s]
Map:  38%|███▊      | 2496/6548 [00:07<00:12, 330.20 examples/s]
Map:  39%|███▉      | 2538/6548 [00:07<00:11, 348.03 examples/s]
Map:  40%|███▉      | 2592/6548 [00:08<00:10, 392.16 examples/s]
Map:  40%|████      | 2634/6548 [00:08<00:09, 395.25 examples/s]
Map:  41%|████      | 2682/6548 [00:08<00:10, 362.25 examples/s]
Map:  42%|████▏     | 2741/6548 [00:08<00:10, 367.73 examples/s]
Map:  42%|████▏     | 2780/6548 [00:08<00:10, 366.79 examples/s]
Map:  43%|████▎     | 2828/6548 [00:08<00:12, 299.96 examples/s]
Map:  44%|████▍     | 2879/6548 [00:08<00:11, 308.75 examples/s]
Map:  45%|████▍     | 2924/6548 [00:09<00:12, 290.80 examples/s]
Map:  45%|████▌     | 2961/6548 [00:09<00:11, 303.55 examples/s]
Map:  46%|████▌     | 2996/6548 [00:09<00:14, 240.74 examples/s]
Map:  46%|████▋     | 3044/6548 [00:09<00:19, 181.03 examples/s]
Map:  47%|████▋     | 3075/6548 [00:09<00:17, 198.88 examples/s]
Map:  48%|████▊     | 3115/6548 [00:10<00:14, 232.18 examples/s]
Map:  48%|████▊     | 3149/6548 [00:10<00:14, 235.11 examples/s]
Map:  49%|████▊     | 3186/6548 [00:10<00:12, 259.34 examples/s]
Map:  49%|████▉     | 3216/6548 [00:10<00:13, 252.42 examples/s]
Map:  50%|████▉     | 3245/6548 [00:10<00:12, 255.58 examples/s]
Map:  50%|█████     | 3280/6548 [00:10<00:11, 275.20 examples/s]
Map:  51%|█████     | 3322/6548 [00:10<00:10, 307.56 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:10<00:10, 305.36 examples/s]
Map:  52%|█████▏    | 3411/6548 [00:11<00:10, 285.60 examples/s]
Map:  53%|█████▎    | 3445/6548 [00:11<00:10, 294.54 examples/s]
Map:  53%|█████▎    | 3480/6548 [00:11<00:11, 265.38 examples/s]
Map:  54%|█████▍    | 3527/6548 [00:11<00:09, 311.26 examples/s]
Map:  55%|█████▍    | 3571/6548 [00:11<00:08, 339.78 examples/s]
Map:  55%|█████▌    | 3618/6548 [00:11<00:07, 373.38 examples/s]
Map:  56%|█████▌    | 3676/6548 [00:11<00:07, 370.18 examples/s]
Map:  57%|█████▋    | 3722/6548 [00:11<00:07, 390.38 examples/s]
Map:  58%|█████▊    | 3784/6548 [00:12<00:07, 392.39 examples/s]
Map:  59%|█████▊    | 3839/6548 [00:12<00:07, 358.02 examples/s]
Map:  59%|█████▉    | 3885/6548 [00:12<00:07, 336.07 examples/s]
Map:  60%|██████    | 3929/6548 [00:12<00:07, 338.43 examples/s]
Map:  61%|██████    | 3973/6548 [00:12<00:07, 350.52 examples/s]
Map:  62%|██████▏   | 4029/6548 [00:12<00:09, 263.05 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 303.43 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 324.05 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:07, 299.58 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:13<00:07, 315.00 examples/s]
Map:  65%|██████▌   | 4259/6548 [00:13<00:06, 349.12 examples/s]
Map:  66%|██████▌   | 4298/6548 [00:13<00:06, 348.87 examples/s]
Map:  66%|██████▋   | 4344/6548 [00:13<00:05, 375.31 examples/s]
Map:  67%|██████▋   | 4399/6548 [00:13<00:05, 369.82 examples/s]
Map:  68%|██████▊   | 4439/6548 [00:14<00:05, 375.98 examples/s]
Map:  68%|██████▊   | 4485/6548 [00:14<00:05, 346.65 examples/s]
Map:  69%|██████▉   | 4530/6548 [00:14<00:06, 321.92 examples/s]
Map:  70%|██████▉   | 4570/6548 [00:14<00:05, 336.89 examples/s]
Map:  71%|███████   | 4626/6548 [00:14<00:05, 336.43 examples/s]
Map:  71%|███████▏  | 4670/6548 [00:14<00:05, 353.61 examples/s]
Map:  72%|███████▏  | 4712/6548 [00:14<00:05, 366.35 examples/s]
Map:  73%|███████▎  | 4751/6548 [00:14<00:04, 369.50 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 421.65 examples/s]
Map:  74%|███████▍  | 4853/6548 [00:15<00:04, 350.34 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 371.45 examples/s]
Map:  76%|███████▌  | 4959/6548 [00:15<00:03, 413.42 examples/s]
Map:  77%|███████▋  | 5012/6548 [00:15<00:06, 244.56 examples/s]
Map:  77%|███████▋  | 5054/6548 [00:15<00:05, 273.82 examples/s]
Map:  78%|███████▊  | 5101/6548 [00:16<00:05, 281.81 examples/s]
Map:  79%|███████▊  | 5155/6548 [00:16<00:04, 287.53 examples/s]
Map:  80%|███████▉  | 5207/6548 [00:16<00:04, 293.61 examples/s]
Map:  80%|████████  | 5242/6548 [00:16<00:04, 297.39 examples/s]
Map:  81%|████████  | 5285/6548 [00:16<00:03, 318.06 examples/s]
Map:  81%|████████  | 5320/6548 [00:16<00:03, 324.97 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:16<00:03, 302.42 examples/s]
Map:  83%|████████▎ | 5405/6548 [00:17<00:03, 286.09 examples/s]
Map:  83%|████████▎ | 5447/6548 [00:17<00:03, 315.28 examples/s]
Map:  84%|████████▍ | 5502/6548 [00:17<00:03, 328.60 examples/s]
Map:  85%|████████▍ | 5540/6548 [00:17<00:02, 339.20 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:17<00:03, 308.10 examples/s]
Map:  86%|████████▌ | 5639/6548 [00:17<00:02, 357.54 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:17<00:02, 320.80 examples/s]
Map:  87%|████████▋ | 5722/6548 [00:18<00:02, 334.71 examples/s]
Map:  88%|████████▊ | 5766/6548 [00:18<00:02, 358.70 examples/s]
Map:  89%|████████▊ | 5804/6548 [00:18<00:02, 363.01 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:01, 364.59 examples/s]
Map:  90%|████████▉ | 5889/6548 [00:18<00:01, 373.74 examples/s]
Map:  91%|█████████ | 5928/6548 [00:18<00:01, 376.44 examples/s]
Map:  91%|█████████▏| 5988/6548 [00:18<00:01, 350.48 examples/s]
Map:  92%|█████████▏| 6027/6548 [00:19<00:02, 237.53 examples/s]
Map:  93%|█████████▎| 6062/6548 [00:19<00:01, 256.42 examples/s]
Map:  93%|█████████▎| 6097/6548 [00:19<00:01, 263.04 examples/s]
Map:  94%|█████████▎| 6131/6548 [00:19<00:01, 274.64 examples/s]
Map:  94%|█████████▍| 6170/6548 [00:19<00:01, 301.66 examples/s]
Map:  95%|█████████▍| 6208/6548 [00:19<00:01, 320.92 examples/s]
Map:  95%|█████████▌| 6249/6548 [00:19<00:00, 340.25 examples/s]
Map:  96%|█████████▋| 6303/6548 [00:19<00:00, 346.11 examples/s]
Map:  97%|█████████▋| 6367/6548 [00:20<00:00, 360.78 examples/s]
Map:  98%|█████████▊| 6409/6548 [00:20<00:00, 373.66 examples/s]
Map:  99%|█████████▊| 6453/6548 [00:20<00:00, 389.58 examples/s]
Map:  99%|█████████▉| 6495/6548 [00:20<00:00, 384.95 examples/s]
Map: 100%|█████████▉| 6537/6548 [00:20<00:00, 391.02 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 317.38 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 320.84 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 312.53 examples/s]
Map:  11%|█▏        | 102/903 [00:00<00:02, 313.46 examples/s]
Map:  16%|█▌        | 140/903 [00:00<00:02, 335.25 examples/s]
Map:  21%|██        | 190/903 [00:00<00:01, 381.80 examples/s]
Map:  25%|██▌       | 230/903 [00:00<00:01, 384.34 examples/s]
Map:  30%|███       | 271/903 [00:00<00:01, 389.12 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 386.00 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 335.59 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 319.63 examples/s]
Map:  51%|█████     | 460/903 [00:01<00:01, 314.43 examples/s]
Map:  56%|█████▋    | 508/903 [00:01<00:01, 313.68 examples/s]
Map:  62%|██████▏   | 558/903 [00:01<00:00, 347.51 examples/s]
Map:  67%|██████▋   | 609/903 [00:01<00:00, 384.52 examples/s]
Map:  73%|███████▎  | 663/903 [00:01<00:00, 373.04 examples/s]
Map:  78%|███████▊  | 704/903 [00:01<00:00, 380.82 examples/s]
Map:  83%|████████▎ | 751/903 [00:02<00:00, 400.83 examples/s]
Map:  89%|████████▉ | 807/903 [00:02<00:00, 384.82 examples/s]
Map:  94%|█████████▍| 849/903 [00:02<00:00, 386.94 examples/s]
Map:  99%|█████████▊| 890/903 [00:02<00:00, 340.46 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 325.14 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 35/1882 [00:00<00:06, 275.81 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 348.35 examples/s]
Map:   6%|▌         | 117/1882 [00:00<00:05, 335.54 examples/s]
Map:   8%|▊         | 156/1882 [00:00<00:04, 346.77 examples/s]
Map:  10%|█         | 193/1882 [00:00<00:04, 353.48 examples/s]
Map:  12%|█▏        | 233/1882 [00:00<00:04, 365.47 examples/s]
Map:  15%|█▍        | 278/1882 [00:00<00:04, 380.42 examples/s]
Map:  18%|█▊        | 334/1882 [00:00<00:04, 362.38 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:04, 308.78 examples/s]
Map:  22%|██▏       | 411/1882 [00:01<00:05, 282.94 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 293.28 examples/s]
Map:  26%|██▌       | 494/1882 [00:01<00:04, 331.82 examples/s]
Map:  29%|██▊       | 538/1882 [00:01<00:04, 310.82 examples/s]
Map:  31%|███       | 580/1882 [00:01<00:03, 336.22 examples/s]
Map:  34%|███▍      | 638/1882 [00:01<00:03, 396.14 examples/s]
Map:  37%|███▋      | 696/1882 [00:02<00:03, 386.24 examples/s]
Map:  40%|████      | 760/1882 [00:02<00:02, 396.49 examples/s]
Map:  43%|████▎     | 801/1882 [00:02<00:03, 338.15 examples/s]
Map:  45%|████▍     | 843/1882 [00:02<00:02, 354.82 examples/s]
Map:  48%|████▊     | 900/1882 [00:02<00:02, 358.04 examples/s]
Map:  50%|█████     | 946/1882 [00:02<00:02, 378.87 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 387.02 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 244.94 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 259.60 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 271.88 examples/s]
Map:  61%|██████    | 1139/1882 [00:03<00:02, 280.47 examples/s]
Map:  62%|██████▏   | 1174/1882 [00:03<00:02, 296.14 examples/s]
Map:  65%|██████▍   | 1222/1882 [00:03<00:02, 270.21 examples/s]
Map:  67%|██████▋   | 1259/1882 [00:03<00:02, 284.85 examples/s]
Map:  69%|██████▉   | 1307/1882 [00:04<00:01, 321.20 examples/s]
Map:  72%|███████▏  | 1347/1882 [00:04<00:01, 335.80 examples/s]
Map:  74%|███████▍  | 1392/1882 [00:04<00:01, 320.85 examples/s]
Map:  76%|███████▌  | 1427/1882 [00:04<00:01, 277.85 examples/s]
Map:  78%|███████▊  | 1470/1882 [00:04<00:01, 308.20 examples/s]
Map:  80%|███████▉  | 1504/1882 [00:04<00:01, 264.37 examples/s]
Map:  82%|████████▏ | 1538/1882 [00:04<00:01, 266.76 examples/s]
Map:  84%|████████▎ | 1575/1882 [00:04<00:01, 289.70 examples/s]
Map:  86%|████████▌ | 1619/1882 [00:05<00:00, 322.43 examples/s]
Map:  89%|████████▊ | 1666/1882 [00:05<00:00, 313.74 examples/s]
Map:  90%|█████████ | 1703/1882 [00:05<00:00, 326.51 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 286.27 examples/s]
Map:  95%|█████████▍| 1785/1882 [00:05<00:00, 288.85 examples/s]
Map:  97%|█████████▋| 1830/1882 [00:05<00:00, 326.45 examples/s]
Map: 100%|█████████▉| 1875/1882 [00:05<00:00, 355.43 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 309.34 examples/s]
10/12/2024 18:18:31 - INFO - __main__ -     ***** Testing *****
10/12/2024 18:18:31 - INFO - __main__ -     Batch size = 8
10/12/2024 18:18:31 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 18:18:32 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 18:18:32 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 18:18:33 - INFO - knnlm -   Reading datastore took 0.9501409530639648 s
10/12/2024 18:18:33 - INFO - knnlm -   Moving index to GPU took 0.9281473159790039 s
10/12/2024 18:18:33 - INFO - __main__ -   ******************************break-into
10/12/2024 18:18:33 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 18:18:33 - INFO - __main__ -     Num examples = 236
10/12/2024 18:18:33 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:34,  7.55s/it]
test ppl:   1%|          | 2/236 [00:09<16:29,  4.23s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:34,  2.98s/it]
test ppl:   2%|▏         | 4/236 [00:12<09:33,  2.47s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:12,  3.69s/it]
test ppl:   3%|▎         | 6/236 [00:24<17:00,  4.44s/it]
test ppl:   3%|▎         | 7/236 [00:26<13:45,  3.60s/it]
test ppl:   3%|▎         | 8/236 [00:30<14:29,  3.82s/it]
test ppl:   4%|▍         | 9/236 [00:32<12:25,  3.28s/it]
test ppl:   4%|▍         | 10/236 [00:35<11:24,  3.03s/it]
test ppl:   5%|▍         | 11/236 [00:37<10:34,  2.82s/it]
test ppl:   5%|▌         | 12/236 [00:43<13:59,  3.75s/it]
test ppl:   6%|▌         | 13/236 [00:49<16:18,  4.39s/it]
test ppl:   6%|▌         | 14/236 [00:51<13:55,  3.76s/it]
test ppl:   6%|▋         | 15/236 [00:53<12:11,  3.31s/it]
test ppl:   7%|▋         | 16/236 [00:55<10:32,  2.87s/it]
test ppl:   7%|▋         | 17/236 [01:01<13:46,  3.77s/it]
test ppl:   8%|▊         | 18/236 [01:03<11:26,  3.15s/it]
test ppl:   8%|▊         | 19/236 [01:07<12:46,  3.53s/it]
test ppl:   8%|▊         | 20/236 [01:09<10:48,  3.00s/it]
test ppl:   9%|▉         | 21/236 [01:12<11:09,  3.11s/it]
test ppl:   9%|▉         | 22/236 [01:18<14:03,  3.94s/it]
test ppl:  10%|▉         | 23/236 [01:21<12:28,  3.51s/it]
test ppl:  10%|█         | 24/236 [01:23<11:10,  3.16s/it]
test ppl:  11%|█         | 25/236 [01:25<09:37,  2.74s/it]
test ppl:  11%|█         | 26/236 [01:31<12:52,  3.68s/it]
test ppl:  11%|█▏        | 27/236 [01:34<12:33,  3.61s/it]
test ppl:  12%|█▏        | 28/236 [01:35<10:00,  2.88s/it]
test ppl:  12%|█▏        | 29/236 [01:38<09:22,  2.72s/it]
test ppl:  13%|█▎        | 30/236 [01:39<08:05,  2.36s/it]
test ppl:  13%|█▎        | 31/236 [01:41<07:40,  2.25s/it]
test ppl:  14%|█▎        | 32/236 [01:44<08:02,  2.37s/it]
test ppl:  14%|█▍        | 33/236 [01:50<11:34,  3.42s/it]
test ppl:  14%|█▍        | 34/236 [01:54<12:05,  3.59s/it]
test ppl:  15%|█▍        | 35/236 [01:56<10:57,  3.27s/it]
test ppl:  15%|█▌        | 36/236 [02:02<13:28,  4.04s/it]
test ppl:  16%|█▌        | 37/236 [02:08<15:15,  4.60s/it]
test ppl:  16%|█▌        | 38/236 [02:10<12:41,  3.84s/it]
test ppl:  17%|█▋        | 39/236 [02:12<10:36,  3.23s/it]
test ppl:  17%|█▋        | 40/236 [02:14<10:01,  3.07s/it]
test ppl:  17%|█▋        | 41/236 [02:16<08:47,  2.71s/it]
test ppl:  18%|█▊        | 42/236 [02:22<11:51,  3.67s/it]
test ppl:  18%|█▊        | 43/236 [02:28<13:55,  4.33s/it]
test ppl:  19%|█▊        | 44/236 [02:31<12:04,  3.78s/it]
test ppl:  19%|█▉        | 45/236 [02:33<10:16,  3.23s/it]
test ppl:  19%|█▉        | 46/236 [02:38<12:45,  4.03s/it]
test ppl:  20%|█▉        | 47/236 [02:40<10:19,  3.28s/it]
test ppl:  20%|██        | 48/236 [02:46<12:40,  4.05s/it]
test ppl:  21%|██        | 49/236 [02:52<14:18,  4.59s/it]
test ppl:  21%|██        | 50/236 [02:58<15:28,  4.99s/it]
test ppl:  22%|██▏       | 51/236 [03:03<16:12,  5.26s/it]
test ppl:  22%|██▏       | 52/236 [03:09<16:41,  5.44s/it]
test ppl:  22%|██▏       | 53/236 [03:14<16:00,  5.25s/it]
test ppl:  23%|██▎       | 54/236 [03:16<12:32,  4.14s/it]
test ppl:  23%|██▎       | 55/236 [03:21<13:53,  4.60s/it]
test ppl:  24%|██▎       | 56/236 [03:25<12:43,  4.24s/it]
test ppl:  24%|██▍       | 57/236 [03:30<13:55,  4.67s/it]
test ppl:  25%|██▍       | 58/236 [03:33<11:37,  3.92s/it]
test ppl:  25%|██▌       | 59/236 [03:38<13:17,  4.51s/it]
test ppl:  25%|██▌       | 60/236 [03:42<12:00,  4.09s/it]
test ppl:  26%|██▌       | 61/236 [03:47<13:29,  4.62s/it]
test ppl:  26%|██▋       | 62/236 [03:52<12:57,  4.47s/it]
test ppl:  27%|██▋       | 63/236 [03:54<11:09,  3.87s/it]
test ppl:  27%|██▋       | 64/236 [03:56<09:27,  3.30s/it]
test ppl:  28%|██▊       | 65/236 [03:57<07:42,  2.71s/it]
test ppl:  28%|██▊       | 66/236 [04:00<07:55,  2.80s/it]
test ppl:  28%|██▊       | 67/236 [04:06<10:29,  3.72s/it]
test ppl:  29%|██▉       | 68/236 [04:12<12:13,  4.37s/it]
test ppl:  29%|██▉       | 69/236 [04:18<13:23,  4.81s/it]
test ppl:  30%|██▉       | 70/236 [04:19<10:23,  3.76s/it]
test ppl:  30%|███       | 71/236 [04:23<09:57,  3.62s/it]
test ppl:  31%|███       | 72/236 [04:26<10:02,  3.67s/it]
test ppl:  31%|███       | 73/236 [04:30<09:58,  3.67s/it]
test ppl:  31%|███▏      | 74/236 [04:31<08:09,  3.02s/it]
test ppl:  32%|███▏      | 75/236 [04:37<10:23,  3.87s/it]
test ppl:  32%|███▏      | 76/236 [04:41<10:02,  3.77s/it]
test ppl:  33%|███▎      | 77/236 [04:43<08:48,  3.32s/it]
test ppl:  33%|███▎      | 78/236 [04:45<07:55,  3.01s/it]
test ppl:  33%|███▎      | 79/236 [04:49<08:35,  3.29s/it]
test ppl:  34%|███▍      | 80/236 [04:51<07:24,  2.85s/it]
test ppl:  34%|███▍      | 81/236 [04:57<09:40,  3.75s/it]
test ppl:  35%|███▍      | 82/236 [05:03<11:10,  4.35s/it]
test ppl:  35%|███▌      | 83/236 [05:06<09:57,  3.91s/it]
test ppl:  36%|███▌      | 84/236 [05:08<08:44,  3.45s/it]
test ppl:  36%|███▌      | 85/236 [05:12<09:11,  3.65s/it]
test ppl:  36%|███▋      | 86/236 [05:14<07:49,  3.13s/it]
test ppl:  37%|███▋      | 87/236 [05:17<07:26,  2.99s/it]
test ppl:  37%|███▋      | 88/236 [05:23<09:29,  3.85s/it]
test ppl:  38%|███▊      | 89/236 [05:28<10:54,  4.45s/it]
test ppl:  38%|███▊      | 90/236 [05:34<11:51,  4.87s/it]
test ppl:  39%|███▊      | 91/236 [05:39<11:51,  4.91s/it]
test ppl:  39%|███▉      | 92/236 [05:42<10:16,  4.28s/it]
test ppl:  39%|███▉      | 93/236 [05:48<11:18,  4.75s/it]
test ppl:  40%|███▉      | 94/236 [05:54<12:01,  5.08s/it]
test ppl:  40%|████      | 95/236 [05:56<09:43,  4.14s/it]
test ppl:  41%|████      | 96/236 [05:59<08:48,  3.77s/it]
test ppl:  41%|████      | 97/236 [06:05<10:10,  4.39s/it]
test ppl:  42%|████▏     | 98/236 [06:10<11:07,  4.83s/it]
test ppl:  42%|████▏     | 99/236 [06:16<11:44,  5.14s/it]
test ppl:  42%|████▏     | 100/236 [06:18<09:03,  4.00s/it]
test ppl:  43%|████▎     | 101/236 [06:23<10:14,  4.56s/it]
test ppl:  43%|████▎     | 102/236 [06:27<09:45,  4.37s/it]
test ppl:  44%|████▎     | 103/236 [06:29<07:43,  3.48s/it]
test ppl:  44%|████▍     | 104/236 [06:33<08:09,  3.71s/it]
test ppl:  44%|████▍     | 105/236 [06:37<08:32,  3.91s/it]
test ppl:  45%|████▍     | 106/236 [06:43<09:26,  4.36s/it]
test ppl:  45%|████▌     | 107/236 [06:45<07:47,  3.62s/it]
test ppl:  46%|████▌     | 108/236 [06:50<09:03,  4.24s/it]
test ppl:  46%|████▌     | 109/236 [06:55<09:15,  4.37s/it]
test ppl:  47%|████▋     | 110/236 [06:57<07:53,  3.76s/it]
test ppl:  47%|████▋     | 111/236 [07:01<07:58,  3.83s/it]
test ppl:  47%|████▋     | 112/236 [07:05<07:38,  3.70s/it]
test ppl:  48%|████▊     | 113/236 [07:07<06:23,  3.12s/it]
test ppl:  48%|████▊     | 114/236 [07:10<06:28,  3.19s/it]
test ppl:  49%|████▊     | 115/236 [07:16<08:02,  3.99s/it]
test ppl:  49%|████▉     | 116/236 [07:22<09:06,  4.55s/it]
test ppl:  50%|████▉     | 117/236 [07:23<07:24,  3.74s/it]
test ppl:  50%|█████     | 118/236 [07:29<08:35,  4.37s/it]
test ppl:  50%|█████     | 119/236 [07:32<07:32,  3.87s/it]
test ppl:  51%|█████     | 120/236 [07:33<06:00,  3.11s/it]
test ppl:  51%|█████▏    | 121/236 [07:39<07:32,  3.93s/it]
test ppl:  52%|█████▏    | 122/236 [07:44<07:57,  4.19s/it]
test ppl:  52%|█████▏    | 123/236 [07:46<06:43,  3.57s/it]
test ppl:  53%|█████▎    | 124/236 [07:49<06:00,  3.22s/it]
test ppl:  53%|█████▎    | 125/236 [07:51<05:33,  3.00s/it]
test ppl:  53%|█████▎    | 126/236 [07:56<06:33,  3.58s/it]
test ppl:  54%|█████▍    | 127/236 [07:58<05:41,  3.14s/it]
test ppl:  54%|█████▍    | 128/236 [08:00<05:09,  2.87s/it]
test ppl:  55%|█████▍    | 129/236 [08:03<05:08,  2.88s/it]
test ppl:  55%|█████▌    | 130/236 [08:06<04:58,  2.82s/it]
test ppl:  56%|█████▌    | 131/236 [08:12<06:32,  3.74s/it]
test ppl:  56%|█████▌    | 132/236 [08:14<05:48,  3.36s/it]
test ppl:  56%|█████▋    | 133/236 [08:18<06:02,  3.52s/it]
test ppl:  57%|█████▋    | 134/236 [08:22<06:09,  3.62s/it]
test ppl:  57%|█████▋    | 135/236 [08:28<07:14,  4.30s/it]
test ppl:  58%|█████▊    | 136/236 [08:29<05:38,  3.39s/it]
test ppl:  58%|█████▊    | 137/236 [08:35<06:49,  4.14s/it]
test ppl:  58%|█████▊    | 138/236 [08:38<06:18,  3.86s/it]
test ppl:  59%|█████▉    | 139/236 [08:40<05:13,  3.24s/it]
test ppl:  59%|█████▉    | 140/236 [08:42<04:25,  2.77s/it]
test ppl:  60%|█████▉    | 141/236 [08:45<04:26,  2.80s/it]
test ppl:  60%|██████    | 142/236 [08:47<04:03,  2.59s/it]
test ppl:  61%|██████    | 143/236 [08:53<05:32,  3.58s/it]
test ppl:  61%|██████    | 144/236 [08:55<05:05,  3.32s/it]
test ppl:  61%|██████▏   | 145/236 [09:01<06:00,  3.97s/it]
test ppl:  62%|██████▏   | 146/236 [09:05<06:13,  4.15s/it]
test ppl:  62%|██████▏   | 147/236 [09:11<06:55,  4.67s/it]
test ppl:  63%|██████▎   | 148/236 [09:17<07:25,  5.06s/it]
test ppl:  63%|██████▎   | 149/236 [09:23<07:42,  5.31s/it]
test ppl:  64%|██████▎   | 150/236 [09:29<07:51,  5.48s/it]
test ppl:  64%|██████▍   | 151/236 [09:35<07:56,  5.60s/it]
test ppl:  64%|██████▍   | 152/236 [09:41<07:56,  5.68s/it]
test ppl:  65%|██████▍   | 153/236 [09:47<07:55,  5.73s/it]
test ppl:  65%|██████▌   | 154/236 [09:49<06:30,  4.77s/it]
test ppl:  66%|██████▌   | 155/236 [09:52<05:35,  4.14s/it]
test ppl:  66%|██████▌   | 156/236 [09:54<04:43,  3.55s/it]
test ppl:  67%|██████▋   | 157/236 [09:56<04:08,  3.14s/it]
test ppl:  67%|██████▋   | 158/236 [10:02<05:09,  3.96s/it]
test ppl:  67%|██████▋   | 159/236 [10:03<04:00,  3.12s/it]
test ppl:  68%|██████▊   | 160/236 [10:04<03:12,  2.53s/it]
test ppl:  68%|██████▊   | 161/236 [10:06<02:43,  2.18s/it]
test ppl:  69%|██████▊   | 162/236 [10:08<02:39,  2.16s/it]
test ppl:  69%|██████▉   | 163/236 [10:10<02:45,  2.27s/it]
test ppl:  69%|██████▉   | 164/236 [10:15<03:39,  3.06s/it]
test ppl:  70%|██████▉   | 165/236 [10:18<03:36,  3.05s/it]
test ppl:  70%|███████   | 166/236 [10:20<03:05,  2.65s/it]
test ppl:  71%|███████   | 167/236 [10:21<02:38,  2.30s/it]
test ppl:  71%|███████   | 168/236 [10:27<03:49,  3.37s/it]
test ppl:  72%|███████▏  | 169/236 [10:33<04:36,  4.13s/it]
test ppl:  72%|███████▏  | 170/236 [10:39<05:08,  4.67s/it]
test ppl:  72%|███████▏  | 171/236 [10:40<03:58,  3.67s/it]
test ppl:  73%|███████▎  | 172/236 [10:46<04:37,  4.34s/it]
test ppl:  73%|███████▎  | 173/236 [10:50<04:24,  4.19s/it]
test ppl:  74%|███████▎  | 174/236 [10:56<04:51,  4.70s/it]
test ppl:  74%|███████▍  | 175/236 [10:58<03:55,  3.86s/it]
test ppl:  75%|███████▍  | 176/236 [11:03<04:17,  4.30s/it]
test ppl:  75%|███████▌  | 177/236 [11:09<04:41,  4.77s/it]
test ppl:  75%|███████▌  | 178/236 [11:15<04:56,  5.11s/it]
test ppl:  76%|███████▌  | 179/236 [11:21<05:04,  5.34s/it]
test ppl:  76%|███████▋  | 180/236 [11:27<05:07,  5.50s/it]
test ppl:  77%|███████▋  | 181/236 [11:33<05:08,  5.61s/it]
test ppl:  77%|███████▋  | 182/236 [11:35<04:02,  4.49s/it]
test ppl:  78%|███████▊  | 183/236 [11:37<03:22,  3.83s/it]
test ppl:  78%|███████▊  | 184/236 [11:38<02:41,  3.11s/it]
test ppl:  78%|███████▊  | 185/236 [11:42<02:48,  3.31s/it]
test ppl:  79%|███████▉  | 186/236 [11:44<02:25,  2.92s/it]
test ppl:  79%|███████▉  | 187/236 [11:50<03:07,  3.83s/it]
test ppl:  80%|███████▉  | 188/236 [11:56<03:33,  4.45s/it]
test ppl:  80%|████████  | 189/236 [12:02<03:49,  4.88s/it]
test ppl:  81%|████████  | 190/236 [12:06<03:27,  4.52s/it]
test ppl:  81%|████████  | 191/236 [12:09<03:13,  4.30s/it]
test ppl:  81%|████████▏ | 192/236 [12:12<02:47,  3.80s/it]
test ppl:  82%|████████▏ | 193/236 [12:18<03:10,  4.42s/it]
test ppl:  82%|████████▏ | 194/236 [12:20<02:42,  3.88s/it]
test ppl:  83%|████████▎ | 195/236 [12:23<02:19,  3.40s/it]
test ppl:  83%|████████▎ | 196/236 [12:25<01:59,  2.99s/it]
test ppl:  83%|████████▎ | 197/236 [12:27<01:46,  2.73s/it]
test ppl:  84%|████████▍ | 198/236 [12:29<01:34,  2.50s/it]
test ppl:  84%|████████▍ | 199/236 [12:31<01:34,  2.56s/it]
test ppl:  85%|████████▍ | 200/236 [12:37<02:07,  3.54s/it]
test ppl:  85%|████████▌ | 201/236 [12:40<01:53,  3.25s/it]
test ppl:  86%|████████▌ | 202/236 [12:45<02:04,  3.66s/it]
test ppl:  86%|████████▌ | 203/236 [12:50<02:22,  4.33s/it]
test ppl:  86%|████████▋ | 204/236 [12:52<01:52,  3.52s/it]
test ppl:  87%|████████▋ | 205/236 [12:58<02:11,  4.24s/it]
test ppl:  87%|████████▋ | 206/236 [13:01<01:58,  3.96s/it]
test ppl:  88%|████████▊ | 207/236 [13:07<02:11,  4.53s/it]
test ppl:  88%|████████▊ | 208/236 [13:10<01:55,  4.12s/it]
test ppl:  89%|████████▊ | 209/236 [13:16<02:06,  4.67s/it]
test ppl:  89%|████████▉ | 210/236 [13:19<01:43,  3.97s/it]
test ppl:  89%|████████▉ | 211/236 [13:23<01:39,  3.96s/it]
test ppl:  90%|████████▉ | 212/236 [13:28<01:48,  4.53s/it]
test ppl:  90%|█████████ | 213/236 [13:34<01:53,  4.93s/it]
test ppl:  91%|█████████ | 214/236 [13:36<01:26,  3.94s/it]
test ppl:  91%|█████████ | 215/236 [13:42<01:34,  4.52s/it]
test ppl:  92%|█████████▏| 216/236 [13:43<01:13,  3.66s/it]
test ppl:  92%|█████████▏| 217/236 [13:49<01:22,  4.35s/it]
test ppl:  92%|█████████▏| 218/236 [13:52<01:07,  3.77s/it]
test ppl:  93%|█████████▎| 219/236 [13:58<01:14,  4.41s/it]
test ppl:  93%|█████████▎| 220/236 [14:03<01:17,  4.84s/it]
test ppl:  94%|█████████▎| 221/236 [14:07<01:04,  4.32s/it]
test ppl:  94%|█████████▍| 222/236 [14:12<01:07,  4.79s/it]
test ppl:  94%|█████████▍| 223/236 [14:18<01:06,  5.11s/it]
test ppl:  95%|█████████▍| 224/236 [14:20<00:49,  4.11s/it]
test ppl:  95%|█████████▌| 225/236 [14:26<00:50,  4.64s/it]
test ppl:  96%|█████████▌| 226/236 [14:28<00:39,  3.99s/it]
test ppl:  96%|█████████▌| 227/236 [14:31<00:32,  3.65s/it]
test ppl:  97%|█████████▋| 228/236 [14:33<00:25,  3.16s/it]
test ppl:  97%|█████████▋| 229/236 [14:39<00:27,  3.96s/it]
test ppl:  97%|█████████▋| 230/236 [14:43<00:22,  3.81s/it]
test ppl:  98%|█████████▊| 231/236 [14:46<00:18,  3.68s/it]
test ppl:  98%|█████████▊| 232/236 [14:48<00:12,  3.10s/it]
test ppl:  99%|█████████▊| 233/236 [14:50<00:08,  2.81s/it]
test ppl:  99%|█████████▉| 234/236 [14:51<00:04,  2.33s/it]
test ppl: 100%|█████████▉| 235/236 [14:57<00:03,  3.39s/it]
test ppl: 100%|██████████| 236/236 [14:58<00:00,  2.57s/it]
test ppl: 100%|██████████| 236/236 [14:58<00:00,  3.81s/it]
10/12/2024 18:33:32 - INFO - __main__ -    em: 0.2078
10/12/2024 18:33:32 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.4 100:  em: 0.2078

--------------------------------------------------------------------------------
Running experiment with knn_temp=100, lmbda=0.4, k=32
2024-10-12 18:33:39.045306: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 18:33:39.064820: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 18:33:39.086539: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 18:33:39.093156: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 18:33:39.109090: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 18:33:40.098835: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 18:33:41 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.4, knn_temp=100, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 18:33:41 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:48:01,  2.18it/s]
Adding feature api:   3%|▎         | 6447/187062 [00:00<00:11, 15325.92it/s]
Adding feature api:   7%|▋         | 13865/187062 [00:00<00:05, 30245.95it/s]
Adding feature api:  11%|█▏        | 21195/187062 [00:00<00:03, 41691.75it/s]
Adding feature api:  15%|█▌        | 28753/187062 [00:00<00:03, 51018.10it/s]
Adding feature api:  19%|█▉        | 36347/187062 [00:00<00:02, 58050.12it/s]
Adding feature api:  23%|██▎       | 43907/187062 [00:01<00:02, 63091.61it/s]
Adding feature api:  27%|██▋       | 51230/187062 [00:01<00:02, 66041.38it/s]
Adding feature api:  31%|███▏      | 58767/187062 [00:01<00:01, 68777.35it/s]
Adding feature api:  35%|███▌      | 66323/187062 [00:01<00:01, 70780.47it/s]
Adding feature api:  39%|███▉      | 73857/187062 [00:01<00:01, 72131.82it/s]
Adding feature api:  43%|████▎     | 81294/187062 [00:01<00:01, 72487.28it/s]
Adding feature api:  47%|████▋     | 88849/187062 [00:01<00:01, 73395.27it/s]
Adding feature api:  52%|█████▏    | 96408/187062 [00:01<00:01, 74048.80it/s]
Adding feature api:  56%|█████▌    | 103967/187062 [00:01<00:01, 74508.56it/s]
Adding feature api:  60%|█████▉    | 111557/187062 [00:01<00:01, 74921.51it/s]
Adding feature api:  64%|██████▎   | 119088/187062 [00:02<00:00, 74444.86it/s]
Adding feature api:  68%|██████▊   | 126623/187062 [00:02<00:00, 74711.94it/s]
Adding feature api:  72%|███████▏  | 134172/187062 [00:02<00:00, 74941.88it/s]
Adding feature api:  76%|███████▌  | 141787/187062 [00:02<00:00, 75300.19it/s]
Adding feature api:  80%|███████▉  | 149327/187062 [00:02<00:00, 74853.52it/s]
Adding feature api:  84%|████████▍ | 156893/187062 [00:02<00:00, 75093.20it/s]
Adding feature api:  88%|████████▊ | 164408/187062 [00:02<00:00, 75079.49it/s]
Adding feature api:  92%|█████████▏| 171929/187062 [00:02<00:00, 75117.95it/s]
Adding feature api:  96%|█████████▌| 179444/187062 [00:02<00:00, 66082.62it/s]
Adding feature api: 100%|█████████▉| 186252/187062 [00:03<00:00, 47490.09it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 58722.13it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:33:08,  2.21it/s]
Adding feature datatype:   3%|▎         | 6351/187062 [00:00<00:11, 15218.85it/s]
Adding feature datatype:   7%|▋         | 13597/187062 [00:00<00:05, 29816.94it/s]
Adding feature datatype:  11%|█         | 20882/187062 [00:00<00:04, 41307.17it/s]
Adding feature datatype:  15%|█▍        | 27891/187062 [00:00<00:03, 49247.58it/s]
Adding feature datatype:  19%|█▉        | 35219/187062 [00:00<00:02, 56044.75it/s]
Adding feature datatype:  23%|██▎       | 42547/187062 [00:01<00:02, 61002.30it/s]
Adding feature datatype:  27%|██▋       | 49862/187062 [00:01<00:02, 64538.97it/s]
Adding feature datatype:  31%|███       | 57189/187062 [00:01<00:01, 67103.13it/s]
Adding feature datatype:  35%|███▍      | 64549/187062 [00:01<00:01, 69021.33it/s]
Adding feature datatype:  38%|███▊      | 71755/187062 [00:01<00:01, 69526.45it/s]
Adding feature datatype:  42%|████▏     | 79171/187062 [00:01<00:01, 70898.31it/s]
Adding feature datatype:  46%|████▌     | 86498/187062 [00:01<00:01, 71602.90it/s]
Adding feature datatype:  50%|█████     | 93844/187062 [00:01<00:01, 72154.88it/s]
Adding feature datatype:  54%|█████▍    | 101178/187062 [00:01<00:01, 72506.17it/s]
Adding feature datatype:  58%|█████▊    | 108482/187062 [00:01<00:01, 71896.39it/s]
Adding feature datatype:  62%|██████▏   | 115859/187062 [00:02<00:00, 72452.47it/s]
Adding feature datatype:  66%|██████▌   | 123226/187062 [00:02<00:00, 72814.83it/s]
Adding feature datatype:  70%|██████▉   | 130556/187062 [00:02<00:00, 72958.43it/s]
Adding feature datatype:  74%|███████▎  | 137936/187062 [00:02<00:00, 73208.90it/s]
Adding feature datatype:  78%|███████▊  | 145305/187062 [00:02<00:00, 73350.99it/s]
Adding feature datatype:  82%|████████▏ | 152647/187062 [00:02<00:00, 72694.76it/s]
Adding feature datatype:  86%|████████▌ | 160006/187062 [00:02<00:00, 72959.18it/s]
Adding feature datatype:  89%|████████▉ | 167358/187062 [00:02<00:00, 73125.98it/s]
Adding feature datatype:  93%|█████████▎| 174698/187062 [00:02<00:00, 73206.49it/s]
Adding feature datatype:  97%|█████████▋| 182021/187062 [00:03<00:00, 54651.75it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 57611.30it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:21:32,  2.22it/s]
Adding feature literal:   3%|▎         | 6325/187062 [00:00<00:11, 15251.56it/s]
Adding feature literal:   7%|▋         | 13572/187062 [00:00<00:05, 29911.64it/s]
Adding feature literal:  11%|█         | 20720/187062 [00:00<00:04, 41048.45it/s]
Adding feature literal:  15%|█▍        | 27248/187062 [00:00<00:03, 47755.45it/s]
Adding feature literal:  18%|█▊        | 34343/187062 [00:00<00:02, 54327.55it/s]
Adding feature literal:  22%|██▏       | 41682/187062 [00:01<00:02, 59820.06it/s]
Adding feature literal:  26%|██▌       | 48970/187062 [00:01<00:02, 63626.40it/s]
Adding feature literal:  30%|███       | 56343/187062 [00:01<00:01, 66595.76it/s]
Adding feature literal:  34%|███▍      | 63651/187062 [00:01<00:01, 68511.06it/s]
Adding feature literal:  38%|███▊      | 70999/187062 [00:01<00:01, 69986.13it/s]
Adding feature literal:  42%|████▏     | 78355/187062 [00:01<00:01, 71048.14it/s]
Adding feature literal:  46%|████▌     | 85718/187062 [00:01<00:01, 71818.33it/s]
Adding feature literal:  50%|████▉     | 93069/187062 [00:01<00:01, 72320.77it/s]
Adding feature literal:  54%|█████▎    | 100422/187062 [00:01<00:01, 72679.62it/s]
Adding feature literal:  58%|█████▊    | 107762/187062 [00:01<00:01, 72893.04it/s]
Adding feature literal:  62%|██████▏   | 115126/187062 [00:02<00:00, 73114.41it/s]
Adding feature literal:  65%|██████▌   | 122487/187062 [00:02<00:00, 73261.20it/s]
Adding feature literal:  69%|██████▉   | 129853/187062 [00:02<00:00, 73378.00it/s]
Adding feature literal:  73%|███████▎  | 137242/187062 [00:02<00:00, 73529.82it/s]
Adding feature literal:  77%|███████▋  | 144647/187062 [00:02<00:00, 73683.15it/s]
Adding feature literal:  81%|████████▏ | 152022/187062 [00:02<00:00, 73692.47it/s]
Adding feature literal:  85%|████████▌ | 159396/187062 [00:02<00:00, 73521.01it/s]
Adding feature literal:  89%|████████▉ | 166782/187062 [00:02<00:00, 73620.95it/s]
Adding feature literal:  93%|█████████▎| 174147/187062 [00:02<00:00, 73105.01it/s]
Adding feature literal:  97%|█████████▋| 181460/187062 [00:03<00:00, 56903.34it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 57584.55it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:25:23,  2.22it/s]
Adding feature operator:   3%|▎         | 6344/187062 [00:00<00:11, 15265.31it/s]
Adding feature operator:   7%|▋         | 13591/187062 [00:00<00:05, 29899.18it/s]
Adding feature operator:  11%|█         | 20949/187062 [00:00<00:03, 41588.74it/s]
Adding feature operator:  15%|█▌        | 28329/187062 [00:00<00:03, 50496.31it/s]
Adding feature operator:  19%|█▉        | 35742/187062 [00:00<00:02, 57188.73it/s]
Adding feature operator:  23%|██▎       | 43132/187062 [00:01<00:02, 62001.74it/s]
Adding feature operator:  27%|██▋       | 50459/187062 [00:01<00:02, 65284.54it/s]
Adding feature operator:  31%|███       | 57865/187062 [00:01<00:01, 67862.27it/s]
Adding feature operator:  35%|███▍      | 65248/187062 [00:01<00:01, 69624.70it/s]
Adding feature operator:  39%|███▉      | 72649/187062 [00:01<00:01, 70925.90it/s]
Adding feature operator:  43%|████▎     | 80022/187062 [00:01<00:01, 71758.78it/s]
Adding feature operator:  47%|████▋     | 87446/187062 [00:01<00:01, 72496.82it/s]
Adding feature operator:  51%|█████     | 94825/187062 [00:01<00:01, 72881.11it/s]
Adding feature operator:  55%|█████▍    | 102228/187062 [00:01<00:01, 73223.54it/s]
Adding feature operator:  59%|█████▊    | 109614/187062 [00:01<00:01, 73410.92it/s]
Adding feature operator:  63%|██████▎   | 117027/187062 [00:02<00:00, 73622.92it/s]
Adding feature operator:  67%|██████▋   | 124449/187062 [00:02<00:00, 73799.00it/s]
Adding feature operator:  70%|███████   | 131847/187062 [00:02<00:00, 73751.91it/s]
Adding feature operator:  74%|███████▍  | 139243/187062 [00:02<00:00, 73811.64it/s]
Adding feature operator:  78%|███████▊  | 146634/187062 [00:02<00:00, 71224.69it/s]
Adding feature operator:  82%|████████▏ | 153783/187062 [00:02<00:00, 69550.32it/s]
Adding feature operator:  86%|████████▌ | 160762/187062 [00:02<00:00, 68497.55it/s]
Adding feature operator:  90%|████████▉ | 167995/187062 [00:02<00:00, 69605.05it/s]
Adding feature operator:  94%|█████████▎| 175326/187062 [00:02<00:00, 70687.22it/s]
Adding feature operator:  98%|█████████▊| 182409/187062 [00:03<00:00, 52404.24it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 57466.94it/s]
[2024-10-12 18:34:26,640] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 18:34:28 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 18:34:28 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 42/6548 [00:00<00:16, 387.58 examples/s]
Map:   1%|▏         | 90/6548 [00:00<00:27, 231.47 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:24, 262.11 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 317.82 examples/s]
Map:   3%|▎         | 225/6548 [00:00<00:17, 362.21 examples/s]
Map:   4%|▍         | 283/6548 [00:00<00:17, 358.80 examples/s]
Map:   5%|▍         | 325/6548 [00:01<00:20, 306.58 examples/s]
Map:   6%|▌         | 362/6548 [00:01<00:19, 309.61 examples/s]
Map:   6%|▋         | 414/6548 [00:01<00:17, 358.22 examples/s]
Map:   7%|▋         | 454/6548 [00:01<00:17, 350.73 examples/s]
Map:   8%|▊         | 511/6548 [00:01<00:17, 350.82 examples/s]
Map:   9%|▊         | 565/6548 [00:01<00:15, 393.29 examples/s]
Map:   9%|▉         | 607/6548 [00:01<00:15, 382.92 examples/s]
Map:  10%|█         | 658/6548 [00:01<00:16, 348.56 examples/s]
Map:  11%|█         | 704/6548 [00:02<00:15, 373.73 examples/s]
Map:  12%|█▏        | 768/6548 [00:02<00:14, 390.45 examples/s]
Map:  12%|█▏        | 817/6548 [00:02<00:13, 411.00 examples/s]
Map:  13%|█▎        | 873/6548 [00:02<00:14, 392.14 examples/s]
Map:  14%|█▍        | 931/6548 [00:02<00:14, 382.91 examples/s]
Map:  15%|█▌        | 987/6548 [00:02<00:15, 368.88 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:22, 249.59 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:20, 271.26 examples/s]
Map:  17%|█▋        | 1124/6548 [00:03<00:17, 308.69 examples/s]
Map:  18%|█▊        | 1163/6548 [00:03<00:16, 325.51 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 343.88 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:14, 355.05 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:14, 366.94 examples/s]
Map:  21%|██        | 1355/6548 [00:04<00:16, 316.89 examples/s]
Map:  21%|██▏       | 1401/6548 [00:04<00:16, 310.72 examples/s]
Map:  22%|██▏       | 1436/6548 [00:04<00:17, 294.35 examples/s]
Map:  23%|██▎       | 1480/6548 [00:04<00:16, 301.09 examples/s]
Map:  23%|██▎       | 1516/6548 [00:04<00:16, 313.17 examples/s]
Map:  24%|██▍       | 1558/6548 [00:04<00:16, 298.62 examples/s]
Map:  24%|██▍       | 1594/6548 [00:04<00:16, 304.49 examples/s]
Map:  25%|██▍       | 1633/6548 [00:04<00:17, 283.95 examples/s]
Map:  25%|██▌       | 1665/6548 [00:05<00:18, 258.61 examples/s]
Map:  26%|██▌       | 1703/6548 [00:05<00:17, 283.83 examples/s]
Map:  27%|██▋       | 1745/6548 [00:05<00:15, 313.30 examples/s]
Map:  27%|██▋       | 1791/6548 [00:05<00:13, 345.36 examples/s]
Map:  28%|██▊       | 1837/6548 [00:05<00:12, 364.88 examples/s]
Map:  29%|██▉       | 1885/6548 [00:05<00:13, 340.97 examples/s]
Map:  29%|██▉       | 1925/6548 [00:05<00:13, 349.77 examples/s]
Map:  30%|███       | 1967/6548 [00:05<00:12, 361.91 examples/s]
Map:  31%|███       | 2017/6548 [00:06<00:19, 238.34 examples/s]
Map:  31%|███▏      | 2048/6548 [00:06<00:18, 247.76 examples/s]
Map:  32%|███▏      | 2090/6548 [00:06<00:15, 282.58 examples/s]
Map:  32%|███▏      | 2124/6548 [00:06<00:15, 289.12 examples/s]
Map:  33%|███▎      | 2167/6548 [00:06<00:17, 253.43 examples/s]
Map:  34%|███▍      | 2213/6548 [00:06<00:15, 272.86 examples/s]
Map:  34%|███▍      | 2243/6548 [00:07<00:17, 246.25 examples/s]
Map:  35%|███▍      | 2273/6548 [00:07<00:16, 257.12 examples/s]
Map:  35%|███▌      | 2312/6548 [00:07<00:14, 286.42 examples/s]
Map:  36%|███▌      | 2355/6548 [00:07<00:14, 298.02 examples/s]
Map:  37%|███▋      | 2397/6548 [00:07<00:12, 327.41 examples/s]
Map:  37%|███▋      | 2438/6548 [00:07<00:12, 318.63 examples/s]
Map:  38%|███▊      | 2471/6548 [00:07<00:12, 318.68 examples/s]
Map:  38%|███▊      | 2518/6548 [00:07<00:12, 311.12 examples/s]
Map:  39%|███▉      | 2567/6548 [00:08<00:11, 354.42 examples/s]
Map:  40%|███▉      | 2614/6548 [00:08<00:10, 378.87 examples/s]
Map:  41%|████      | 2658/6548 [00:08<00:10, 360.04 examples/s]
Map:  41%|████      | 2698/6548 [00:08<00:10, 369.19 examples/s]
Map:  42%|████▏     | 2736/6548 [00:08<00:10, 347.57 examples/s]
Map:  42%|████▏     | 2774/6548 [00:08<00:10, 353.90 examples/s]
Map:  43%|████▎     | 2824/6548 [00:08<00:10, 342.79 examples/s]
Map:  44%|████▎     | 2862/6548 [00:08<00:12, 291.02 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 297.52 examples/s]
Map:  45%|████▌     | 2952/6548 [00:09<00:11, 311.68 examples/s]
Map:  46%|████▌     | 2986/6548 [00:09<00:11, 315.12 examples/s]
Map:  46%|████▌     | 3026/6548 [00:09<00:21, 162.25 examples/s]
Map:  47%|████▋     | 3062/6548 [00:09<00:18, 189.85 examples/s]
Map:  47%|████▋     | 3098/6548 [00:10<00:15, 218.07 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 248.90 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:13, 253.28 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 248.35 examples/s]
Map:  49%|████▉     | 3238/6548 [00:10<00:12, 267.84 examples/s]
Map:  50%|████▉     | 3268/6548 [00:10<00:12, 272.54 examples/s]
Map:  51%|█████     | 3322/6548 [00:10<00:10, 295.67 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:10<00:10, 294.17 examples/s]
Map:  52%|█████▏    | 3421/6548 [00:11<00:11, 277.02 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 272.03 examples/s]
Map:  53%|█████▎    | 3486/6548 [00:11<00:11, 274.63 examples/s]
Map:  54%|█████▍    | 3521/6548 [00:11<00:10, 290.65 examples/s]
Map:  54%|█████▍    | 3565/6548 [00:11<00:09, 323.87 examples/s]
Map:  55%|█████▌    | 3611/6548 [00:11<00:08, 357.46 examples/s]
Map:  56%|█████▌    | 3667/6548 [00:11<00:08, 355.41 examples/s]
Map:  57%|█████▋    | 3712/6548 [00:12<00:07, 376.84 examples/s]
Map:  57%|█████▋    | 3752/6548 [00:12<00:07, 365.93 examples/s]
Map:  58%|█████▊    | 3800/6548 [00:12<00:06, 393.83 examples/s]
Map:  59%|█████▊    | 3841/6548 [00:12<00:08, 336.82 examples/s]
Map:  60%|█████▉    | 3898/6548 [00:12<00:07, 348.91 examples/s]
Map:  60%|██████    | 3940/6548 [00:12<00:08, 321.61 examples/s]
Map:  61%|██████    | 3989/6548 [00:12<00:07, 358.41 examples/s]
Map:  62%|██████▏   | 4030/6548 [00:13<00:09, 252.93 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 295.82 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 319.73 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:08, 297.43 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:13<00:07, 311.28 examples/s]
Map:  65%|██████▌   | 4270/6548 [00:13<00:06, 337.21 examples/s]
Map:  66%|██████▌   | 4309/6548 [00:13<00:06, 343.55 examples/s]
Map:  66%|██████▋   | 4346/6548 [00:13<00:06, 340.78 examples/s]
Map:  67%|██████▋   | 4400/6548 [00:14<00:06, 339.39 examples/s]
Map:  68%|██████▊   | 4445/6548 [00:14<00:05, 365.55 examples/s]
Map:  69%|██████▊   | 4491/6548 [00:14<00:06, 341.44 examples/s]
Map:  69%|██████▉   | 4535/6548 [00:14<00:06, 324.11 examples/s]
Map:  70%|██████▉   | 4570/6548 [00:14<00:06, 322.17 examples/s]
Map:  70%|███████   | 4610/6548 [00:14<00:05, 325.00 examples/s]
Map:  71%|███████   | 4657/6548 [00:14<00:05, 360.88 examples/s]
Map:  72%|███████▏  | 4712/6548 [00:15<00:05, 359.38 examples/s]
Map:  73%|███████▎  | 4750/6548 [00:15<00:04, 362.08 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 409.19 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 395.20 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 370.32 examples/s]
Map:  76%|███████▌  | 4958/6548 [00:15<00:03, 408.59 examples/s]
Map:  77%|███████▋  | 5013/6548 [00:16<00:06, 246.01 examples/s]
Map:  77%|███████▋  | 5054/6548 [00:16<00:05, 273.36 examples/s]
Map:  78%|███████▊  | 5101/6548 [00:16<00:05, 280.62 examples/s]
Map:  79%|███████▊  | 5155/6548 [00:16<00:04, 287.47 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 286.28 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:16<00:04, 298.65 examples/s]
Map:  81%|████████  | 5285/6548 [00:16<00:03, 331.37 examples/s]
Map:  81%|████████▏ | 5321/6548 [00:16<00:03, 335.19 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 309.49 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 299.74 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 329.08 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 326.98 examples/s]
Map:  85%|████████▍ | 5548/6548 [00:17<00:02, 349.15 examples/s]
Map:  85%|████████▌ | 5595/6548 [00:17<00:02, 325.35 examples/s]
Map:  86%|████████▌ | 5642/6548 [00:17<00:02, 357.16 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 321.94 examples/s]
Map:  87%|████████▋ | 5722/6548 [00:18<00:02, 334.87 examples/s]
Map:  88%|████████▊ | 5765/6548 [00:18<00:02, 355.65 examples/s]
Map:  89%|████████▊ | 5802/6548 [00:18<00:02, 358.05 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:01, 361.66 examples/s]
Map:  90%|████████▉ | 5889/6548 [00:18<00:01, 369.30 examples/s]
Map:  91%|█████████ | 5927/6548 [00:18<00:01, 370.02 examples/s]
Map:  91%|█████████ | 5968/6548 [00:18<00:01, 330.95 examples/s]
Map:  92%|█████████▏| 6025/6548 [00:19<00:02, 235.82 examples/s]
Map:  93%|█████████▎| 6068/6548 [00:19<00:01, 245.64 examples/s]
Map:  93%|█████████▎| 6098/6548 [00:19<00:01, 250.69 examples/s]
Map:  94%|█████████▎| 6135/6548 [00:19<00:01, 269.61 examples/s]
Map:  94%|█████████▍| 6167/6548 [00:19<00:01, 279.17 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:19<00:01, 293.84 examples/s]
Map:  96%|█████████▌| 6262/6548 [00:20<00:00, 307.67 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 327.58 examples/s]
Map:  97%|█████████▋| 6357/6548 [00:20<00:00, 331.15 examples/s]
Map:  98%|█████████▊| 6394/6548 [00:20<00:00, 338.08 examples/s]
Map:  98%|█████████▊| 6437/6548 [00:20<00:00, 358.60 examples/s]
Map:  99%|█████████▉| 6486/6548 [00:20<00:00, 389.17 examples/s]
Map: 100%|█████████▉| 6529/6548 [00:20<00:00, 344.01 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 313.17 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 316.74 examples/s]
Map:   8%|▊         | 71/903 [00:00<00:02, 333.92 examples/s]
Map:  13%|█▎        | 118/903 [00:00<00:02, 304.61 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 323.81 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 380.64 examples/s]
Map:  29%|██▉       | 263/903 [00:00<00:01, 362.53 examples/s]
Map:  33%|███▎      | 302/903 [00:00<00:01, 361.28 examples/s]
Map:  39%|███▉      | 354/903 [00:01<00:01, 351.56 examples/s]
Map:  43%|████▎     | 390/903 [00:01<00:01, 280.42 examples/s]
Map:  47%|████▋     | 425/903 [00:01<00:01, 294.94 examples/s]
Map:  53%|█████▎    | 475/903 [00:01<00:01, 293.92 examples/s]
Map:  56%|█████▋    | 508/903 [00:01<00:01, 300.82 examples/s]
Map:  61%|██████    | 553/903 [00:01<00:01, 334.16 examples/s]
Map:  66%|██████▌   | 592/903 [00:01<00:00, 344.23 examples/s]
Map:  71%|███████▏  | 645/903 [00:01<00:00, 342.62 examples/s]
Map:  77%|███████▋  | 691/903 [00:02<00:00, 363.06 examples/s]
Map:  83%|████████▎ | 747/903 [00:02<00:00, 358.71 examples/s]
Map:  89%|████████▉ | 802/903 [00:02<00:00, 353.92 examples/s]
Map:  94%|█████████▎| 845/903 [00:02<00:00, 353.98 examples/s]
Map:  98%|█████████▊| 885/903 [00:02<00:00, 363.84 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 310.23 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 289.62 examples/s]
Map:   4%|▍         | 82/1882 [00:00<00:04, 365.18 examples/s]
Map:   7%|▋         | 130/1882 [00:00<00:05, 322.94 examples/s]
Map:   9%|▉         | 173/1882 [00:00<00:04, 356.64 examples/s]
Map:  12%|█▏        | 224/1882 [00:00<00:04, 343.81 examples/s]
Map:  14%|█▍        | 268/1882 [00:00<00:04, 366.29 examples/s]
Map:  18%|█▊        | 330/1882 [00:00<00:04, 379.24 examples/s]
Map:  20%|█▉        | 369/1882 [00:01<00:04, 336.86 examples/s]
Map:  22%|██▏       | 411/1882 [00:01<00:05, 281.30 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 290.65 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 326.03 examples/s]
Map:  29%|██▉       | 543/1882 [00:01<00:04, 317.37 examples/s]
Map:  31%|███       | 586/1882 [00:01<00:03, 342.91 examples/s]
Map:  34%|███▍      | 641/1882 [00:01<00:03, 389.36 examples/s]
Map:  37%|███▋      | 696/1882 [00:02<00:03, 373.72 examples/s]
Map:  40%|████      | 760/1882 [00:02<00:02, 388.19 examples/s]
Map:  43%|████▎     | 809/1882 [00:02<00:03, 351.32 examples/s]
Map:  45%|████▌     | 852/1882 [00:02<00:02, 367.71 examples/s]
Map:  48%|████▊     | 900/1882 [00:02<00:02, 347.94 examples/s]
Map:  50%|████▉     | 938/1882 [00:02<00:02, 353.61 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 372.51 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 241.91 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 256.87 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 269.69 examples/s]
Map:  61%|██████    | 1146/1882 [00:03<00:02, 261.11 examples/s]
Map:  63%|██████▎   | 1177/1882 [00:03<00:02, 267.65 examples/s]
Map:  64%|██████▍   | 1207/1882 [00:03<00:02, 274.42 examples/s]
Map:  66%|██████▌   | 1244/1882 [00:03<00:02, 296.72 examples/s]
Map:  68%|██████▊   | 1277/1882 [00:03<00:02, 299.59 examples/s]
Map:  70%|███████   | 1318/1882 [00:04<00:01, 328.69 examples/s]
Map:  72%|███████▏  | 1360/1882 [00:04<00:01, 336.02 examples/s]
Map:  75%|███████▌  | 1413/1882 [00:04<00:01, 336.67 examples/s]
Map:  78%|███████▊  | 1469/1882 [00:04<00:01, 304.37 examples/s]
Map:  80%|████████  | 1506/1882 [00:04<00:01, 268.38 examples/s]
Map:  82%|████████▏ | 1537/1882 [00:04<00:01, 273.81 examples/s]
Map:  83%|████████▎ | 1566/1882 [00:04<00:01, 276.36 examples/s]
Map:  86%|████████▌ | 1615/1882 [00:05<00:00, 327.12 examples/s]
Map:  88%|████████▊ | 1664/1882 [00:05<00:00, 325.02 examples/s]
Map:  90%|█████████ | 1698/1882 [00:05<00:00, 328.08 examples/s]
Map:  92%|█████████▏| 1734/1882 [00:05<00:00, 278.62 examples/s]
Map:  94%|█████████▍| 1765/1882 [00:05<00:00, 275.05 examples/s]
Map:  96%|█████████▌| 1799/1882 [00:05<00:00, 285.32 examples/s]
Map:  98%|█████████▊| 1844/1882 [00:05<00:00, 323.02 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 225.30 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 306.79 examples/s]
10/12/2024 18:35:30 - INFO - __main__ -     ***** Testing *****
10/12/2024 18:35:30 - INFO - __main__ -     Batch size = 8
10/12/2024 18:35:30 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 18:35:31 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 18:35:31 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 18:35:32 - INFO - knnlm -   Reading datastore took 0.9616217613220215 s
10/12/2024 18:35:33 - INFO - knnlm -   Moving index to GPU took 0.9974989891052246 s
10/12/2024 18:35:33 - INFO - __main__ -   ******************************break-into
10/12/2024 18:35:33 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 18:35:33 - INFO - __main__ -     Num examples = 236
10/12/2024 18:35:33 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:35,  7.56s/it]
test ppl:   1%|          | 2/236 [00:09<16:34,  4.25s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:39,  3.00s/it]
test ppl:   2%|▏         | 4/236 [00:16<16:04,  4.16s/it]
test ppl:   2%|▏         | 5/236 [00:22<18:27,  4.80s/it]
test ppl:   3%|▎         | 6/236 [00:28<19:53,  5.19s/it]
test ppl:   3%|▎         | 7/236 [00:30<15:42,  4.11s/it]
test ppl:   3%|▎         | 8/236 [00:35<15:52,  4.18s/it]
test ppl:   4%|▍         | 9/236 [00:37<13:23,  3.54s/it]
test ppl:   4%|▍         | 10/236 [00:43<16:08,  4.29s/it]
test ppl:   5%|▍         | 11/236 [00:45<13:53,  3.71s/it]
test ppl:   5%|▌         | 12/236 [00:50<15:04,  4.04s/it]
test ppl:   6%|▌         | 13/236 [00:56<17:09,  4.62s/it]
test ppl:   6%|▌         | 14/236 [00:58<14:33,  3.93s/it]
test ppl:   6%|▋         | 15/236 [01:00<11:41,  3.18s/it]
test ppl:   7%|▋         | 16/236 [01:01<10:12,  2.78s/it]
test ppl:   7%|▋         | 17/236 [01:07<13:39,  3.74s/it]
test ppl:   8%|▊         | 18/236 [01:09<11:22,  3.13s/it]
test ppl:   8%|▊         | 19/236 [01:14<12:50,  3.55s/it]
test ppl:   8%|▊         | 20/236 [01:15<10:52,  3.02s/it]
test ppl:   9%|▉         | 21/236 [01:21<13:56,  3.89s/it]
test ppl:   9%|▉         | 22/236 [01:27<16:05,  4.51s/it]
test ppl:  10%|▉         | 23/236 [01:30<13:54,  3.92s/it]
test ppl:  10%|█         | 24/236 [01:32<12:12,  3.46s/it]
test ppl:  11%|█         | 25/236 [01:38<14:47,  4.21s/it]
test ppl:  11%|█         | 26/236 [01:44<16:34,  4.74s/it]
test ppl:  11%|█▏        | 27/236 [01:48<15:11,  4.36s/it]
test ppl:  12%|█▏        | 28/236 [01:49<11:52,  3.42s/it]
test ppl:  12%|█▏        | 29/236 [01:51<10:42,  3.10s/it]
test ppl:  13%|█▎        | 30/236 [01:53<09:02,  2.63s/it]
test ppl:  13%|█▎        | 31/236 [01:55<08:22,  2.45s/it]
test ppl:  14%|█▎        | 32/236 [01:58<08:49,  2.59s/it]
test ppl:  14%|█▍        | 33/236 [02:00<08:39,  2.56s/it]
test ppl:  14%|█▍        | 34/236 [02:04<10:07,  3.01s/it]
test ppl:  15%|█▍        | 35/236 [02:07<09:37,  2.87s/it]
test ppl:  15%|█▌        | 36/236 [02:13<12:38,  3.79s/it]
test ppl:  16%|█▌        | 37/236 [02:19<14:44,  4.45s/it]
test ppl:  16%|█▌        | 38/236 [02:21<12:20,  3.74s/it]
test ppl:  17%|█▋        | 39/236 [02:22<10:05,  3.07s/it]
test ppl:  17%|█▋        | 40/236 [02:24<08:22,  2.56s/it]
test ppl:  17%|█▋        | 41/236 [02:26<07:40,  2.36s/it]
test ppl:  18%|█▊        | 42/236 [02:32<11:09,  3.45s/it]
test ppl:  18%|█▊        | 43/236 [02:37<13:30,  4.20s/it]
test ppl:  19%|█▊        | 44/236 [02:40<11:23,  3.56s/it]
test ppl:  19%|█▉        | 45/236 [02:42<10:22,  3.26s/it]
test ppl:  19%|█▉        | 46/236 [02:48<12:55,  4.08s/it]
test ppl:  20%|█▉        | 47/236 [02:50<10:27,  3.32s/it]
test ppl:  20%|██        | 48/236 [02:56<12:51,  4.10s/it]
test ppl:  21%|██        | 49/236 [02:58<11:32,  3.70s/it]
test ppl:  21%|██        | 50/236 [03:04<13:36,  4.39s/it]
test ppl:  22%|██▏       | 51/236 [03:09<13:39,  4.43s/it]
test ppl:  22%|██▏       | 52/236 [03:15<14:58,  4.89s/it]
test ppl:  22%|██▏       | 53/236 [03:20<14:53,  4.88s/it]
test ppl:  23%|██▎       | 54/236 [03:21<11:46,  3.88s/it]
test ppl:  23%|██▎       | 55/236 [03:27<13:26,  4.45s/it]
test ppl:  24%|██▎       | 56/236 [03:30<12:27,  4.15s/it]
test ppl:  24%|██▍       | 57/236 [03:33<10:45,  3.61s/it]
test ppl:  25%|██▍       | 58/236 [03:35<09:26,  3.19s/it]
test ppl:  25%|██▌       | 59/236 [03:41<11:50,  4.01s/it]
test ppl:  25%|██▌       | 60/236 [03:44<10:54,  3.72s/it]
test ppl:  26%|██▌       | 61/236 [03:50<12:47,  4.39s/it]
test ppl:  26%|██▋       | 62/236 [03:56<14:04,  4.85s/it]
test ppl:  27%|██▋       | 63/236 [03:58<11:56,  4.14s/it]
test ppl:  27%|██▋       | 64/236 [04:00<09:38,  3.36s/it]
test ppl:  28%|██▊       | 65/236 [04:01<07:50,  2.75s/it]
test ppl:  28%|██▊       | 66/236 [04:04<08:03,  2.84s/it]
test ppl:  28%|██▊       | 67/236 [04:10<10:38,  3.78s/it]
test ppl:  29%|██▉       | 68/236 [04:16<12:24,  4.43s/it]
test ppl:  29%|██▉       | 69/236 [04:22<13:35,  4.88s/it]
test ppl:  30%|██▉       | 70/236 [04:24<10:48,  3.91s/it]
test ppl:  30%|███       | 71/236 [04:27<10:30,  3.82s/it]
test ppl:  31%|███       | 72/236 [04:31<10:28,  3.83s/it]
test ppl:  31%|███       | 73/236 [04:37<11:49,  4.35s/it]
test ppl:  31%|███▏      | 74/236 [04:38<09:27,  3.51s/it]
test ppl:  32%|███▏      | 75/236 [04:44<11:21,  4.23s/it]
test ppl:  32%|███▏      | 76/236 [04:48<10:43,  4.02s/it]
test ppl:  33%|███▎      | 77/236 [04:50<09:17,  3.51s/it]
test ppl:  33%|███▎      | 78/236 [04:52<07:59,  3.03s/it]
test ppl:  33%|███▎      | 79/236 [04:56<08:40,  3.31s/it]
test ppl:  34%|███▍      | 80/236 [04:58<07:32,  2.90s/it]
test ppl:  34%|███▍      | 81/236 [05:04<09:51,  3.81s/it]
test ppl:  35%|███▍      | 82/236 [05:10<11:21,  4.43s/it]
test ppl:  35%|███▌      | 83/236 [05:12<09:26,  3.71s/it]
test ppl:  36%|███▌      | 84/236 [05:14<08:01,  3.17s/it]
test ppl:  36%|███▌      | 85/236 [05:18<08:43,  3.47s/it]
test ppl:  36%|███▋      | 86/236 [05:20<07:31,  3.01s/it]
test ppl:  37%|███▋      | 87/236 [05:22<06:48,  2.74s/it]
test ppl:  37%|███▋      | 88/236 [05:28<09:08,  3.70s/it]
test ppl:  38%|███▊      | 89/236 [05:34<10:43,  4.38s/it]
test ppl:  38%|███▊      | 90/236 [05:40<11:48,  4.86s/it]
test ppl:  39%|███▊      | 91/236 [05:45<11:49,  4.89s/it]
test ppl:  39%|███▉      | 92/236 [05:48<10:16,  4.28s/it]
test ppl:  39%|███▉      | 93/236 [05:54<11:23,  4.78s/it]
test ppl:  40%|███▉      | 94/236 [06:00<12:08,  5.13s/it]
test ppl:  40%|████      | 95/236 [06:02<10:28,  4.46s/it]
test ppl:  41%|████      | 96/236 [06:05<09:22,  4.01s/it]
test ppl:  41%|████      | 97/236 [06:11<10:38,  4.60s/it]
test ppl:  42%|████▏     | 98/236 [06:17<11:31,  5.01s/it]
test ppl:  42%|████▏     | 99/236 [06:23<12:05,  5.29s/it]
test ppl:  42%|████▏     | 100/236 [06:25<09:18,  4.11s/it]
test ppl:  43%|████▎     | 101/236 [06:30<10:16,  4.57s/it]
test ppl:  43%|████▎     | 102/236 [06:34<09:27,  4.24s/it]
test ppl:  44%|████▎     | 103/236 [06:35<07:32,  3.40s/it]
test ppl:  44%|████▍     | 104/236 [06:39<08:04,  3.67s/it]
test ppl:  44%|████▍     | 105/236 [06:44<08:31,  3.90s/it]
test ppl:  45%|████▍     | 106/236 [06:49<09:28,  4.37s/it]
test ppl:  45%|████▌     | 107/236 [06:51<07:49,  3.64s/it]
test ppl:  46%|████▌     | 108/236 [06:57<09:07,  4.28s/it]
test ppl:  46%|████▌     | 109/236 [07:01<08:54,  4.21s/it]
test ppl:  47%|████▋     | 110/236 [07:03<07:20,  3.50s/it]
test ppl:  47%|████▋     | 111/236 [07:07<07:37,  3.66s/it]
test ppl:  47%|████▋     | 112/236 [07:10<07:26,  3.60s/it]
test ppl:  48%|████▊     | 113/236 [07:12<06:15,  3.05s/it]
test ppl:  48%|████▊     | 114/236 [07:16<06:23,  3.15s/it]
test ppl:  49%|████▊     | 115/236 [07:22<08:01,  3.98s/it]
test ppl:  49%|████▉     | 116/236 [07:28<09:09,  4.58s/it]
test ppl:  50%|████▉     | 117/236 [07:29<07:28,  3.77s/it]
test ppl:  50%|█████     | 118/236 [07:34<07:51,  3.99s/it]
test ppl:  50%|█████     | 119/236 [07:39<08:15,  4.23s/it]
test ppl:  51%|█████     | 120/236 [07:40<06:30,  3.37s/it]
test ppl:  51%|█████▏    | 121/236 [07:46<07:56,  4.14s/it]
test ppl:  52%|█████▏    | 122/236 [07:51<08:16,  4.35s/it]
test ppl:  52%|█████▏    | 123/236 [07:53<06:58,  3.71s/it]
test ppl:  53%|█████▎    | 124/236 [07:56<06:24,  3.44s/it]
test ppl:  53%|█████▎    | 125/236 [08:02<07:45,  4.19s/it]
test ppl:  53%|█████▎    | 126/236 [08:06<07:25,  4.05s/it]
test ppl:  54%|█████▍    | 127/236 [08:08<06:19,  3.48s/it]
test ppl:  54%|█████▍    | 128/236 [08:10<05:37,  3.12s/it]
test ppl:  55%|█████▍    | 129/236 [08:13<05:28,  3.07s/it]
test ppl:  55%|█████▌    | 130/236 [08:18<06:34,  3.72s/it]
test ppl:  56%|█████▌    | 131/236 [08:24<07:40,  4.39s/it]
test ppl:  56%|█████▌    | 132/236 [08:27<06:37,  3.82s/it]
test ppl:  56%|█████▋    | 133/236 [08:31<06:37,  3.86s/it]
test ppl:  57%|█████▋    | 134/236 [08:34<06:35,  3.88s/it]
test ppl:  57%|█████▋    | 135/236 [08:40<07:34,  4.50s/it]
test ppl:  58%|█████▊    | 136/236 [08:42<05:53,  3.53s/it]
test ppl:  58%|█████▊    | 137/236 [08:48<07:01,  4.26s/it]
test ppl:  58%|█████▊    | 138/236 [08:51<06:27,  3.96s/it]
test ppl:  59%|█████▉    | 139/236 [08:54<05:44,  3.55s/it]
test ppl:  59%|█████▉    | 140/236 [08:55<04:47,  3.00s/it]
test ppl:  60%|█████▉    | 141/236 [08:58<04:42,  2.97s/it]
test ppl:  60%|██████    | 142/236 [09:00<04:15,  2.72s/it]
test ppl:  61%|██████    | 143/236 [09:06<05:28,  3.53s/it]
test ppl:  61%|██████    | 144/236 [09:08<05:03,  3.30s/it]
test ppl:  61%|██████▏   | 145/236 [09:14<06:08,  4.05s/it]
test ppl:  62%|██████▏   | 146/236 [09:19<06:18,  4.21s/it]
test ppl:  62%|██████▏   | 147/236 [09:25<07:01,  4.74s/it]
test ppl:  63%|██████▎   | 148/236 [09:31<07:32,  5.14s/it]
test ppl:  63%|██████▎   | 149/236 [09:34<06:41,  4.62s/it]
test ppl:  64%|██████▎   | 150/236 [09:40<07:12,  5.02s/it]
test ppl:  64%|██████▍   | 151/236 [09:46<07:30,  5.30s/it]
test ppl:  64%|██████▍   | 152/236 [09:52<07:41,  5.49s/it]
test ppl:  65%|██████▍   | 153/236 [09:58<07:46,  5.63s/it]
test ppl:  65%|██████▌   | 154/236 [10:01<06:38,  4.87s/it]
test ppl:  66%|██████▌   | 155/236 [10:04<05:54,  4.38s/it]
test ppl:  66%|██████▌   | 156/236 [10:07<05:09,  3.87s/it]
test ppl:  67%|██████▋   | 157/236 [10:10<04:38,  3.53s/it]
test ppl:  67%|██████▋   | 158/236 [10:17<06:04,  4.68s/it]
test ppl:  67%|██████▋   | 159/236 [10:25<07:02,  5.48s/it]
test ppl:  68%|██████▊   | 160/236 [10:26<05:24,  4.27s/it]
test ppl:  68%|██████▊   | 161/236 [10:28<04:22,  3.50s/it]
test ppl:  69%|██████▊   | 162/236 [10:32<04:27,  3.62s/it]
test ppl:  69%|██████▉   | 163/236 [10:35<04:13,  3.48s/it]
test ppl:  69%|██████▉   | 164/236 [10:41<05:03,  4.22s/it]
test ppl:  70%|██████▉   | 165/236 [10:46<05:22,  4.54s/it]
test ppl:  70%|███████   | 166/236 [10:48<04:32,  3.89s/it]
test ppl:  71%|███████   | 167/236 [10:50<03:45,  3.27s/it]
test ppl:  71%|███████   | 168/236 [10:57<05:05,  4.49s/it]
test ppl:  72%|███████▏  | 169/236 [11:03<05:28,  4.90s/it]
test ppl:  72%|███████▏  | 170/236 [11:11<06:12,  5.64s/it]
test ppl:  72%|███████▏  | 171/236 [11:12<04:48,  4.44s/it]
test ppl:  73%|███████▎  | 172/236 [11:20<05:40,  5.31s/it]
test ppl:  73%|███████▎  | 173/236 [11:24<05:16,  5.03s/it]
test ppl:  74%|███████▎  | 174/236 [11:31<05:55,  5.74s/it]
test ppl:  74%|███████▍  | 175/236 [11:34<04:46,  4.70s/it]
test ppl:  75%|███████▍  | 176/236 [11:40<05:11,  5.19s/it]
test ppl:  75%|███████▌  | 177/236 [11:48<05:45,  5.86s/it]
test ppl:  75%|███████▌  | 178/236 [11:55<06:07,  6.33s/it]
test ppl:  76%|███████▌  | 179/236 [12:02<06:19,  6.65s/it]
test ppl:  76%|███████▋  | 180/236 [12:10<06:24,  6.87s/it]
test ppl:  77%|███████▋  | 181/236 [12:17<06:26,  7.02s/it]
test ppl:  77%|███████▋  | 182/236 [12:19<05:03,  5.62s/it]
test ppl:  78%|███████▊  | 183/236 [12:22<04:14,  4.80s/it]
test ppl:  78%|███████▊  | 184/236 [12:24<03:22,  3.89s/it]
test ppl:  78%|███████▊  | 185/236 [12:32<04:12,  4.96s/it]
test ppl:  79%|███████▉  | 186/236 [12:34<03:30,  4.21s/it]
test ppl:  79%|███████▉  | 187/236 [12:41<04:14,  5.19s/it]
test ppl:  80%|███████▉  | 188/236 [12:49<04:41,  5.86s/it]
test ppl:  80%|████████  | 189/236 [12:56<04:56,  6.32s/it]
test ppl:  81%|████████  | 190/236 [13:01<04:26,  5.80s/it]
test ppl:  81%|████████  | 191/236 [13:06<04:06,  5.48s/it]
test ppl:  81%|████████▏ | 192/236 [13:09<03:32,  4.82s/it]
test ppl:  82%|████████▏ | 193/236 [13:16<04:00,  5.60s/it]
test ppl:  82%|████████▏ | 194/236 [13:20<03:25,  4.90s/it]
test ppl:  83%|████████▎ | 195/236 [13:23<03:07,  4.58s/it]
test ppl:  83%|████████▎ | 196/236 [13:26<02:38,  3.96s/it]
test ppl:  83%|████████▎ | 197/236 [13:29<02:19,  3.56s/it]
test ppl:  84%|████████▍ | 198/236 [13:36<02:58,  4.71s/it]
test ppl:  84%|████████▍ | 199/236 [13:39<02:39,  4.31s/it]
test ppl:  85%|████████▍ | 200/236 [13:47<03:08,  5.23s/it]
test ppl:  85%|████████▌ | 201/236 [13:49<02:34,  4.42s/it]
test ppl:  86%|████████▌ | 202/236 [13:57<03:00,  5.31s/it]
test ppl:  86%|████████▌ | 203/236 [14:04<03:15,  5.93s/it]
test ppl:  86%|████████▋ | 204/236 [14:06<02:30,  4.70s/it]
test ppl:  87%|████████▋ | 205/236 [14:13<02:51,  5.52s/it]
test ppl:  87%|████████▋ | 206/236 [14:17<02:33,  5.11s/it]
test ppl:  88%|████████▊ | 207/236 [14:25<02:47,  5.79s/it]
test ppl:  88%|████████▊ | 208/236 [14:29<02:26,  5.23s/it]
test ppl:  89%|████████▊ | 209/236 [14:36<02:39,  5.90s/it]
test ppl:  89%|████████▉ | 210/236 [14:39<02:10,  5.01s/it]
test ppl:  89%|████████▉ | 211/236 [14:45<02:08,  5.13s/it]
test ppl:  90%|████████▉ | 212/236 [14:52<02:19,  5.80s/it]
test ppl:  90%|█████████ | 213/236 [14:59<02:24,  6.28s/it]
test ppl:  91%|█████████ | 214/236 [15:01<01:50,  5.00s/it]
test ppl:  91%|█████████ | 215/236 [15:09<02:00,  5.73s/it]
test ppl:  92%|█████████▏| 216/236 [15:12<01:39,  4.97s/it]
test ppl:  92%|█████████▏| 217/236 [15:19<01:48,  5.73s/it]
test ppl:  92%|█████████▏| 218/236 [15:22<01:28,  4.92s/it]
test ppl:  93%|█████████▎| 219/236 [15:30<01:36,  5.67s/it]
test ppl:  93%|█████████▎| 220/236 [15:37<01:39,  6.19s/it]
test ppl:  94%|█████████▎| 221/236 [15:41<01:20,  5.33s/it]
test ppl:  94%|█████████▍| 222/236 [15:48<01:23,  5.96s/it]
test ppl:  94%|█████████▍| 223/236 [15:55<01:23,  6.39s/it]
test ppl:  95%|█████████▍| 224/236 [15:57<01:00,  5.06s/it]
test ppl:  95%|█████████▌| 225/236 [16:05<01:03,  5.75s/it]
test ppl:  96%|█████████▌| 226/236 [16:08<00:50,  5.06s/it]
test ppl:  96%|█████████▌| 227/236 [16:12<00:41,  4.62s/it]
test ppl:  97%|█████████▋| 228/236 [16:14<00:31,  3.95s/it]
test ppl:  97%|█████████▋| 229/236 [16:22<00:34,  4.98s/it]
test ppl:  97%|█████████▋| 230/236 [16:26<00:28,  4.79s/it]
test ppl:  98%|█████████▊| 231/236 [16:30<00:23,  4.62s/it]
test ppl:  98%|█████████▊| 232/236 [16:32<00:15,  3.89s/it]
test ppl:  99%|█████████▊| 233/236 [16:35<00:10,  3.53s/it]
test ppl:  99%|█████████▉| 234/236 [16:37<00:06,  3.18s/it]
test ppl: 100%|█████████▉| 235/236 [16:45<00:04,  4.44s/it]
test ppl: 100%|██████████| 236/236 [16:46<00:00,  3.35s/it]
test ppl: 100%|██████████| 236/236 [16:46<00:00,  4.26s/it]
10/12/2024 18:52:19 - INFO - __main__ -    em: 0.2078
10/12/2024 18:52:19 - INFO - __main__ -   Finish and take 18m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.4 100:  em: 0.2078

--------------------------------------------------------------------------------
Running experiment with knn_temp=100, lmbda=0.4, k=64
2024-10-12 18:52:26.220995: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 18:52:26.240612: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 18:52:26.262397: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 18:52:26.269044: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 18:52:26.284990: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 18:52:27.274957: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 18:52:28 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.4, knn_temp=100, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 18:52:28 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:38:24,  2.20it/s]
Adding feature api:   4%|▍         | 7215/187062 [00:00<00:10, 17240.45it/s]
Adding feature api:   8%|▊         | 15778/187062 [00:00<00:04, 34644.76it/s]
Adding feature api:  13%|█▎        | 24406/187062 [00:00<00:03, 48410.79it/s]
Adding feature api:  18%|█▊        | 33020/187062 [00:00<00:02, 58815.66it/s]
Adding feature api:  22%|██▏       | 41659/187062 [00:00<00:02, 66608.47it/s]
Adding feature api:  27%|██▋       | 50062/187062 [00:01<00:01, 71616.76it/s]
Adding feature api:  31%|███▏      | 58738/187062 [00:01<00:01, 76025.90it/s]
Adding feature api:  36%|███▌      | 67361/187062 [00:01<00:01, 79023.33it/s]
Adding feature api:  41%|████      | 75968/187062 [00:01<00:01, 81104.19it/s]
Adding feature api:  45%|████▌     | 84438/187062 [00:01<00:01, 82042.20it/s]
Adding feature api:  50%|████▉     | 93087/187062 [00:01<00:01, 83364.73it/s]
Adding feature api:  54%|█████▍    | 101766/187062 [00:01<00:01, 84384.96it/s]
Adding feature api:  59%|█████▉    | 110437/187062 [00:01<00:00, 85078.73it/s]
Adding feature api:  64%|██████▎   | 119034/187062 [00:01<00:00, 84793.60it/s]
Adding feature api:  68%|██████▊   | 127721/187062 [00:01<00:00, 85411.55it/s]
Adding feature api:  73%|███████▎  | 136409/187062 [00:02<00:00, 85846.72it/s]
Adding feature api:  78%|███████▊  | 145025/187062 [00:02<00:00, 85927.81it/s]
Adding feature api:  82%|████████▏ | 153685/187062 [00:02<00:00, 86127.66it/s]
Adding feature api:  87%|████████▋ | 162314/187062 [00:02<00:00, 85515.36it/s]
Adding feature api:  91%|█████████▏| 170901/187062 [00:02<00:00, 85620.35it/s]
Adding feature api:  96%|█████████▌| 179472/187062 [00:02<00:00, 76423.92it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 65469.63it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:08:16,  2.25it/s]
Adding feature datatype:   4%|▎         | 6939/187062 [00:00<00:10, 16853.40it/s]
Adding feature datatype:   8%|▊         | 15170/187062 [00:00<00:05, 33714.82it/s]
Adding feature datatype:  13%|█▎        | 23457/187062 [00:00<00:03, 46937.14it/s]
Adding feature datatype:  17%|█▋        | 31762/187062 [00:00<00:02, 56961.88it/s]
Adding feature datatype:  21%|██▏       | 40038/187062 [00:00<00:02, 64286.38it/s]
Adding feature datatype:  26%|██▌       | 48013/187062 [00:01<00:02, 68701.22it/s]
Adding feature datatype:  30%|███       | 56360/187062 [00:01<00:01, 73008.38it/s]
Adding feature datatype:  35%|███▍      | 64637/187062 [00:01<00:01, 75879.10it/s]
Adding feature datatype:  39%|███▉      | 73005/187062 [00:01<00:01, 78185.42it/s]
Adding feature datatype:  43%|████▎     | 81363/187062 [00:01<00:01, 79786.34it/s]
Adding feature datatype:  48%|████▊     | 89713/187062 [00:01<00:01, 80891.15it/s]
Adding feature datatype:  52%|█████▏    | 97971/187062 [00:01<00:01, 80669.79it/s]
Adding feature datatype:  57%|█████▋    | 106262/187062 [00:01<00:00, 81333.19it/s]
Adding feature datatype:  61%|██████▏   | 114580/187062 [00:01<00:00, 81880.84it/s]
Adding feature datatype:  66%|██████▌   | 122924/187062 [00:01<00:00, 82345.69it/s]
Adding feature datatype:  70%|███████   | 131244/187062 [00:02<00:00, 82599.15it/s]
Adding feature datatype:  75%|███████▍  | 139592/187062 [00:02<00:00, 82860.56it/s]
Adding feature datatype:  79%|███████▉  | 147899/187062 [00:02<00:00, 82013.36it/s]
Adding feature datatype:  84%|████████▎ | 156275/187062 [00:02<00:00, 82531.38it/s]
Adding feature datatype:  88%|████████▊ | 164605/187062 [00:02<00:00, 82759.67it/s]
Adding feature datatype:  92%|█████████▏| 172921/187062 [00:02<00:00, 82875.67it/s]
Adding feature datatype:  97%|█████████▋| 181215/187062 [00:02<00:00, 66177.57it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63841.41it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:11:50,  2.24it/s]
Adding feature literal:   4%|▍         | 7288/187062 [00:00<00:10, 17666.62it/s]
Adding feature literal:   8%|▊         | 15577/187062 [00:00<00:04, 34442.94it/s]
Adding feature literal:  13%|█▎        | 23887/187062 [00:00<00:03, 47517.12it/s]
Adding feature literal:  17%|█▋        | 32241/187062 [00:00<00:02, 57509.07it/s]
Adding feature literal:  22%|██▏       | 40581/187062 [00:00<00:02, 64854.37it/s]
Adding feature literal:  26%|██▌       | 48901/187062 [00:01<00:01, 70144.32it/s]
Adding feature literal:  31%|███       | 57213/187062 [00:01<00:01, 73928.95it/s]
Adding feature literal:  35%|███▌      | 65636/187062 [00:01<00:01, 76959.00it/s]
Adding feature literal:  40%|███▉      | 74030/187062 [00:01<00:01, 79024.26it/s]
Adding feature literal:  44%|████▍     | 82393/187062 [00:01<00:01, 80390.67it/s]
Adding feature literal:  48%|████▊     | 90722/187062 [00:01<00:01, 81252.75it/s]
Adding feature literal:  53%|█████▎    | 99089/187062 [00:01<00:01, 81973.18it/s]
Adding feature literal:  57%|█████▋    | 107474/187062 [00:01<00:00, 82531.73it/s]
Adding feature literal:  62%|██████▏   | 115870/187062 [00:01<00:00, 82957.87it/s]
Adding feature literal:  66%|██████▋   | 124225/187062 [00:01<00:00, 83029.23it/s]
Adding feature literal:  71%|███████   | 132660/187062 [00:02<00:00, 83422.82it/s]
Adding feature literal:  75%|███████▌  | 141137/187062 [00:02<00:00, 83825.75it/s]
Adding feature literal:  80%|███████▉  | 149540/187062 [00:02<00:00, 83665.98it/s]
Adding feature literal:  84%|████████▍ | 157921/187062 [00:02<00:00, 83599.77it/s]
Adding feature literal:  89%|████████▉ | 166319/187062 [00:02<00:00, 83712.12it/s]
Adding feature literal:  93%|█████████▎| 174698/187062 [00:02<00:00, 83513.86it/s]
Adding feature literal:  98%|█████████▊| 183055/187062 [00:02<00:00, 59460.66it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 64398.23it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:18:00,  2.23it/s]
Adding feature operator:   4%|▍         | 7216/187062 [00:00<00:10, 17433.75it/s]
Adding feature operator:   8%|▊         | 15305/187062 [00:00<00:05, 33715.27it/s]
Adding feature operator:  13%|█▎        | 23565/187062 [00:00<00:03, 46826.82it/s]
Adding feature operator:  17%|█▋        | 31772/187062 [00:00<00:02, 56589.28it/s]
Adding feature operator:  21%|██▏       | 40002/187062 [00:00<00:02, 63878.07it/s]
Adding feature operator:  26%|██▌       | 48279/187062 [00:01<00:02, 69322.92it/s]
Adding feature operator:  30%|███       | 56521/187062 [00:01<00:01, 73142.02it/s]
Adding feature operator:  35%|███▍      | 64808/187062 [00:01<00:01, 76000.76it/s]
Adding feature operator:  39%|███▉      | 73077/187062 [00:01<00:01, 77976.36it/s]
Adding feature operator:  43%|████▎     | 81369/187062 [00:01<00:01, 79441.90it/s]
Adding feature operator:  48%|████▊     | 89608/187062 [00:01<00:01, 80319.38it/s]
Adding feature operator:  52%|█████▏    | 97885/187062 [00:01<00:01, 81048.62it/s]
Adding feature operator:  57%|█████▋    | 106187/187062 [00:01<00:00, 81637.00it/s]
Adding feature operator:  61%|██████    | 114503/187062 [00:01<00:00, 82092.13it/s]
Adding feature operator:  66%|██████▌   | 122785/187062 [00:01<00:00, 82307.92it/s]
Adding feature operator:  70%|███████   | 131118/187062 [00:02<00:00, 82613.61it/s]
Adding feature operator:  75%|███████▍  | 139447/187062 [00:02<00:00, 82814.78it/s]
Adding feature operator:  79%|███████▉  | 147749/187062 [00:02<00:00, 82776.45it/s]
Adding feature operator:  83%|████████▎ | 156041/187062 [00:02<00:00, 82794.65it/s]
Adding feature operator:  88%|████████▊ | 164349/187062 [00:02<00:00, 82877.16it/s]
Adding feature operator:  92%|█████████▏| 172677/187062 [00:02<00:00, 82994.80it/s]
Adding feature operator:  97%|█████████▋| 180982/187062 [00:02<00:00, 67199.03it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63863.44it/s]
[2024-10-12 18:53:12,289] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 18:53:13 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 18:53:13 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:17, 380.35 examples/s]
Map:   1%|▏         | 84/6548 [00:00<00:32, 200.94 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:24, 258.60 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 313.41 examples/s]
Map:   3%|▎         | 225/6548 [00:00<00:17, 357.25 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:17, 357.49 examples/s]
Map:   5%|▌         | 335/6548 [00:01<00:21, 292.16 examples/s]
Map:   6%|▌         | 391/6548 [00:01<00:19, 311.23 examples/s]
Map:   7%|▋         | 433/6548 [00:01<00:18, 333.56 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 325.12 examples/s]
Map:   8%|▊         | 510/6548 [00:01<00:18, 335.26 examples/s]
Map:   9%|▊         | 561/6548 [00:01<00:15, 377.43 examples/s]
Map:   9%|▉         | 604/6548 [00:01<00:15, 383.62 examples/s]
Map:  10%|█         | 660/6548 [00:02<00:18, 323.43 examples/s]
Map:  11%|█         | 706/6548 [00:02<00:16, 349.55 examples/s]
Map:  11%|█▏        | 748/6548 [00:02<00:15, 364.17 examples/s]
Map:  12%|█▏        | 801/6548 [00:02<00:14, 403.74 examples/s]
Map:  13%|█▎        | 862/6548 [00:02<00:14, 403.77 examples/s]
Map:  14%|█▍        | 916/6548 [00:02<00:14, 387.13 examples/s]
Map:  15%|█▍        | 957/6548 [00:02<00:14, 388.03 examples/s]
Map:  15%|█▌        | 997/6548 [00:02<00:16, 343.90 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:24, 226.78 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:21, 253.34 examples/s]
Map:  17%|█▋        | 1123/6548 [00:03<00:18, 294.38 examples/s]
Map:  18%|█▊        | 1162/6548 [00:03<00:17, 314.69 examples/s]
Map:  18%|█▊        | 1205/6548 [00:03<00:15, 338.09 examples/s]
Map:  19%|█▉        | 1259/6548 [00:03<00:15, 339.20 examples/s]
Map:  20%|█▉        | 1299/6548 [00:03<00:14, 351.17 examples/s]
Map:  21%|██        | 1355/6548 [00:04<00:16, 306.40 examples/s]
Map:  21%|██▏       | 1398/6548 [00:04<00:17, 294.48 examples/s]
Map:  22%|██▏       | 1436/6548 [00:04<00:18, 282.97 examples/s]
Map:  22%|██▏       | 1473/6548 [00:04<00:18, 274.08 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:17, 287.52 examples/s]
Map:  24%|██▎       | 1555/6548 [00:04<00:17, 289.61 examples/s]
Map:  24%|██▍       | 1596/6548 [00:05<00:18, 273.21 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:18, 271.29 examples/s]
Map:  26%|██▌       | 1684/6548 [00:05<00:18, 266.77 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:16, 294.68 examples/s]
Map:  27%|██▋       | 1770/6548 [00:05<00:14, 323.91 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 331.87 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 343.78 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 344.13 examples/s]
Map:  30%|██▉       | 1947/6548 [00:06<00:12, 358.66 examples/s]
Map:  30%|███       | 1991/6548 [00:06<00:12, 375.46 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:19, 226.87 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:17, 256.99 examples/s]
Map:  32%|███▏      | 2107/6548 [00:06<00:16, 273.26 examples/s]
Map:  33%|███▎      | 2142/6548 [00:06<00:17, 251.25 examples/s]
Map:  33%|███▎      | 2181/6548 [00:07<00:15, 277.22 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 283.85 examples/s]
Map:  34%|███▍      | 2255/6548 [00:07<00:15, 272.91 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:15, 277.23 examples/s]
Map:  36%|███▌      | 2331/6548 [00:07<00:13, 314.96 examples/s]
Map:  36%|███▋      | 2375/6548 [00:07<00:13, 301.61 examples/s]
Map:  37%|███▋      | 2411/6548 [00:07<00:13, 313.37 examples/s]
Map:  38%|███▊      | 2460/6548 [00:07<00:13, 310.21 examples/s]
Map:  38%|███▊      | 2499/6548 [00:08<00:12, 327.82 examples/s]
Map:  39%|███▉      | 2544/6548 [00:08<00:11, 347.38 examples/s]
Map:  40%|███▉      | 2594/6548 [00:08<00:10, 383.07 examples/s]
Map:  40%|████      | 2638/6548 [00:08<00:09, 394.66 examples/s]
Map:  41%|████      | 2690/6548 [00:08<00:11, 347.43 examples/s]
Map:  42%|████▏     | 2745/6548 [00:08<00:11, 344.99 examples/s]
Map:  43%|████▎     | 2783/6548 [00:08<00:10, 348.55 examples/s]
Map:  43%|████▎     | 2828/6548 [00:09<00:13, 283.54 examples/s]
Map:  44%|████▍     | 2873/6548 [00:09<00:12, 284.16 examples/s]
Map:  44%|████▍     | 2904/6548 [00:09<00:13, 267.97 examples/s]
Map:  45%|████▌     | 2950/6548 [00:09<00:11, 305.62 examples/s]
Map:  46%|████▌     | 2991/6548 [00:09<00:14, 246.39 examples/s]
Map:  46%|████▌     | 3026/6548 [00:10<00:20, 170.04 examples/s]
Map:  47%|████▋     | 3062/6548 [00:10<00:17, 197.60 examples/s]
Map:  47%|████▋     | 3097/6548 [00:10<00:15, 224.29 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 256.15 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:13, 258.19 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 251.03 examples/s]
Map:  50%|████▉     | 3245/6548 [00:10<00:13, 252.37 examples/s]
Map:  50%|█████     | 3280/6548 [00:10<00:12, 269.82 examples/s]
Map:  51%|█████     | 3320/6548 [00:11<00:10, 296.41 examples/s]
Map:  51%|█████▏    | 3366/6548 [00:11<00:10, 297.81 examples/s]
Map:  52%|█████▏    | 3404/6548 [00:11<00:11, 276.07 examples/s]
Map:  53%|█████▎    | 3442/6548 [00:11<00:10, 299.36 examples/s]
Map:  53%|█████▎    | 3486/6548 [00:11<00:11, 277.51 examples/s]
Map:  54%|█████▍    | 3532/6548 [00:11<00:09, 317.73 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:11<00:08, 343.13 examples/s]
Map:  55%|█████▌    | 3622/6548 [00:11<00:07, 366.93 examples/s]
Map:  56%|█████▌    | 3661/6548 [00:12<00:07, 369.95 examples/s]
Map:  57%|█████▋    | 3706/6548 [00:12<00:07, 389.94 examples/s]
Map:  57%|█████▋    | 3763/6548 [00:12<00:07, 382.49 examples/s]
Map:  58%|█████▊    | 3807/6548 [00:12<00:07, 389.50 examples/s]
Map:  59%|█████▉    | 3853/6548 [00:12<00:07, 344.03 examples/s]
Map:  60%|█████▉    | 3914/6548 [00:12<00:07, 345.80 examples/s]
Map:  60%|██████    | 3956/6548 [00:12<00:07, 324.18 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 238.41 examples/s]
Map:  62%|██████▏   | 4055/6548 [00:13<00:08, 293.21 examples/s]
Map:  63%|██████▎   | 4097/6548 [00:13<00:07, 316.94 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 328.28 examples/s]
Map:  64%|██████▍   | 4194/6548 [00:13<00:07, 327.67 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:06, 333.01 examples/s]
Map:  65%|██████▌   | 4278/6548 [00:13<00:06, 351.44 examples/s]
Map:  66%|██████▌   | 4317/6548 [00:14<00:06, 359.35 examples/s]
Map:  67%|██████▋   | 4374/6548 [00:14<00:06, 353.75 examples/s]
Map:  68%|██████▊   | 4432/6548 [00:14<00:05, 362.99 examples/s]
Map:  68%|██████▊   | 4482/6548 [00:14<00:06, 340.92 examples/s]
Map:  69%|██████▉   | 4526/6548 [00:14<00:06, 317.08 examples/s]
Map:  70%|██████▉   | 4562/6548 [00:14<00:06, 325.61 examples/s]
Map:  71%|███████   | 4619/6548 [00:14<00:05, 338.38 examples/s]
Map:  71%|███████   | 4665/6548 [00:15<00:05, 363.07 examples/s]
Map:  72%|███████▏  | 4723/6548 [00:15<00:04, 365.62 examples/s]
Map:  73%|███████▎  | 4762/6548 [00:15<00:04, 366.15 examples/s]
Map:  74%|███████▎  | 4816/6548 [00:15<00:04, 406.97 examples/s]
Map:  75%|███████▍  | 4880/6548 [00:15<00:04, 364.28 examples/s]
Map:  75%|███████▌  | 4927/6548 [00:15<00:04, 368.38 examples/s]
Map:  76%|███████▌  | 4975/6548 [00:15<00:04, 391.40 examples/s]
Map:  77%|███████▋  | 5030/6548 [00:16<00:06, 236.80 examples/s]
Map:  77%|███████▋  | 5065/6548 [00:16<00:05, 252.74 examples/s]
Map:  78%|███████▊  | 5110/6548 [00:16<00:05, 260.19 examples/s]
Map:  79%|███████▊  | 5155/6548 [00:16<00:05, 266.76 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:05, 270.17 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:16<00:04, 286.00 examples/s]
Map:  80%|████████  | 5256/6548 [00:17<00:04, 293.08 examples/s]
Map:  81%|████████  | 5307/6548 [00:17<00:03, 345.72 examples/s]
Map:  82%|████████▏ | 5346/6548 [00:17<00:03, 303.93 examples/s]
Map:  82%|████████▏ | 5388/6548 [00:17<00:03, 327.18 examples/s]
Map:  83%|████████▎ | 5429/6548 [00:17<00:03, 305.34 examples/s]
Map:  84%|████████▎ | 5473/6548 [00:17<00:03, 331.95 examples/s]
Map:  84%|████████▍ | 5509/6548 [00:17<00:03, 331.91 examples/s]
Map:  85%|████████▍ | 5552/6548 [00:17<00:02, 355.53 examples/s]
Map:  85%|████████▌ | 5593/6548 [00:18<00:02, 318.52 examples/s]
Map:  86%|████████▌ | 5641/6548 [00:18<00:02, 353.82 examples/s]
Map:  87%|████████▋ | 5680/6548 [00:18<00:02, 305.40 examples/s]
Map:  88%|████████▊ | 5733/6548 [00:18<00:02, 316.66 examples/s]
Map:  88%|████████▊ | 5772/6548 [00:18<00:02, 333.02 examples/s]
Map:  89%|████████▊ | 5808/6548 [00:18<00:02, 335.91 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:02, 348.43 examples/s]
Map:  90%|████████▉ | 5889/6548 [00:18<00:01, 359.54 examples/s]
Map:  91%|█████████ | 5927/6548 [00:18<00:01, 363.42 examples/s]
Map:  91%|█████████ | 5973/6548 [00:19<00:01, 339.33 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 237.81 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 270.30 examples/s]
Map:  93%|█████████▎| 6120/6548 [00:19<00:01, 259.95 examples/s]
Map:  94%|█████████▍| 6158/6548 [00:19<00:01, 282.61 examples/s]
Map:  95%|█████████▍| 6190/6548 [00:20<00:01, 288.96 examples/s]
Map:  95%|█████████▌| 6234/6548 [00:20<00:00, 322.81 examples/s]
Map:  96%|█████████▌| 6271/6548 [00:20<00:00, 326.56 examples/s]
Map:  96%|█████████▋| 6310/6548 [00:20<00:00, 338.41 examples/s]
Map:  97%|█████████▋| 6365/6548 [00:20<00:00, 380.98 examples/s]
Map:  98%|█████████▊| 6421/6548 [00:20<00:00, 365.10 examples/s]
Map:  99%|█████████▉| 6471/6548 [00:20<00:00, 394.08 examples/s]
Map: 100%|█████████▉| 6529/6548 [00:20<00:00, 375.35 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 311.09 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   3%|▎         | 29/903 [00:00<00:03, 263.86 examples/s]
Map:   8%|▊         | 68/903 [00:00<00:02, 324.04 examples/s]
Map:  13%|█▎        | 118/903 [00:00<00:02, 318.05 examples/s]
Map:  18%|█▊        | 162/903 [00:00<00:02, 353.41 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 380.35 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 387.94 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 381.73 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 335.36 examples/s]
Map:  44%|████▎     | 395/903 [00:01<00:01, 300.81 examples/s]
Map:  48%|████▊     | 436/903 [00:01<00:01, 302.50 examples/s]
Map:  52%|█████▏    | 471/903 [00:01<00:01, 311.89 examples/s]
Map:  56%|█████▋    | 508/903 [00:01<00:01, 310.37 examples/s]
Map:  62%|██████▏   | 557/903 [00:01<00:00, 348.36 examples/s]
Map:  67%|██████▋   | 604/903 [00:01<00:00, 377.75 examples/s]
Map:  72%|███████▏  | 652/903 [00:01<00:00, 348.80 examples/s]
Map:  77%|███████▋  | 696/903 [00:02<00:00, 364.30 examples/s]
Map:  82%|████████▏ | 742/903 [00:02<00:00, 385.93 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 380.48 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 382.65 examples/s]
Map:  96%|█████████▋| 871/903 [00:02<00:00, 398.33 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 321.91 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 296.47 examples/s]
Map:   4%|▍         | 81/1882 [00:00<00:04, 363.59 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 349.28 examples/s]
Map:   9%|▊         | 160/1882 [00:00<00:04, 368.48 examples/s]
Map:  11%|█         | 207/1882 [00:00<00:04, 343.47 examples/s]
Map:  13%|█▎        | 253/1882 [00:00<00:04, 375.66 examples/s]
Map:  16%|█▌        | 301/1882 [00:00<00:04, 338.05 examples/s]
Map:  18%|█▊        | 343/1882 [00:00<00:04, 356.66 examples/s]
Map:  21%|██        | 394/1882 [00:01<00:04, 310.09 examples/s]
Map:  23%|██▎       | 438/1882 [00:01<00:04, 303.30 examples/s]
Map:  25%|██▌       | 474/1882 [00:01<00:04, 315.13 examples/s]
Map:  27%|██▋       | 509/1882 [00:01<00:04, 301.30 examples/s]
Map:  29%|██▉       | 552/1882 [00:01<00:04, 331.72 examples/s]
Map:  32%|███▏      | 602/1882 [00:01<00:03, 367.98 examples/s]
Map:  35%|███▍      | 653/1882 [00:01<00:03, 386.02 examples/s]
Map:  38%|███▊      | 709/1882 [00:02<00:03, 380.46 examples/s]
Map:  40%|███▉      | 748/1882 [00:02<00:02, 379.93 examples/s]
Map:  42%|████▏     | 799/1882 [00:02<00:03, 343.89 examples/s]
Map:  45%|████▍     | 846/1882 [00:02<00:02, 369.37 examples/s]
Map:  48%|████▊     | 897/1882 [00:02<00:02, 353.15 examples/s]
Map:  50%|████▉     | 940/1882 [00:02<00:02, 368.65 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 383.25 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 249.32 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 262.89 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 275.11 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 284.73 examples/s]
Map:  62%|██████▏   | 1176/1882 [00:03<00:02, 301.89 examples/s]
Map:  65%|██████▌   | 1229/1882 [00:03<00:02, 281.88 examples/s]
Map:  68%|██████▊   | 1277/1882 [00:03<00:02, 287.53 examples/s]
Map:  70%|███████   | 1318/1882 [00:04<00:01, 313.30 examples/s]
Map:  72%|███████▏  | 1360/1882 [00:04<00:01, 323.93 examples/s]
Map:  75%|███████▌  | 1413/1882 [00:04<00:01, 328.35 examples/s]
Map:  77%|███████▋  | 1457/1882 [00:04<00:01, 309.68 examples/s]
Map:  79%|███████▉  | 1493/1882 [00:04<00:01, 283.52 examples/s]
Map:  81%|████████  | 1524/1882 [00:04<00:01, 281.36 examples/s]
Map:  83%|████████▎ | 1553/1882 [00:04<00:01, 278.49 examples/s]
Map:  85%|████████▌ | 1602/1882 [00:04<00:00, 328.81 examples/s]
Map:  87%|████████▋ | 1639/1882 [00:05<00:00, 318.58 examples/s]
Map:  90%|████████▉ | 1691/1882 [00:05<00:00, 320.72 examples/s]
Map:  92%|█████████▏| 1726/1882 [00:05<00:00, 323.32 examples/s]
Map:  94%|█████████▍| 1772/1882 [00:05<00:00, 287.19 examples/s]
Map:  96%|█████████▌| 1807/1882 [00:05<00:00, 296.36 examples/s]
Map:  98%|█████████▊| 1851/1882 [00:05<00:00, 329.09 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 311.37 examples/s]
10/12/2024 18:54:15 - INFO - __main__ -     ***** Testing *****
10/12/2024 18:54:15 - INFO - __main__ -     Batch size = 8
10/12/2024 18:54:15 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 18:54:16 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 18:54:16 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 18:54:17 - INFO - knnlm -   Reading datastore took 0.9729321002960205 s
10/12/2024 18:54:18 - INFO - knnlm -   Moving index to GPU took 0.972731351852417 s
10/12/2024 18:54:18 - INFO - __main__ -   ******************************break-into
10/12/2024 18:54:18 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 18:54:18 - INFO - __main__ -     Num examples = 236
10/12/2024 18:54:18 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<31:36,  8.07s/it]
test ppl:   1%|          | 2/236 [00:09<17:18,  4.44s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:59,  3.09s/it]
test ppl:   2%|▏         | 4/236 [00:17<16:06,  4.17s/it]
test ppl:   2%|▏         | 5/236 [00:23<18:21,  4.77s/it]
test ppl:   3%|▎         | 6/236 [00:28<19:40,  5.13s/it]
test ppl:   3%|▎         | 7/236 [00:30<15:31,  4.07s/it]
test ppl:   3%|▎         | 8/236 [00:36<16:48,  4.42s/it]
test ppl:   4%|▍         | 9/236 [00:41<18:26,  4.87s/it]
test ppl:   4%|▍         | 10/236 [00:47<19:32,  5.19s/it]
test ppl:   5%|▍         | 11/236 [00:50<16:46,  4.48s/it]
test ppl:   5%|▌         | 12/236 [00:56<18:16,  4.89s/it]
test ppl:   6%|▌         | 13/236 [01:02<19:15,  5.18s/it]
test ppl:   6%|▌         | 14/236 [01:04<15:57,  4.32s/it]
test ppl:   6%|▋         | 15/236 [01:06<13:17,  3.61s/it]
test ppl:   7%|▋         | 16/236 [01:08<11:18,  3.09s/it]
test ppl:   7%|▋         | 17/236 [01:14<14:17,  3.92s/it]
test ppl:   8%|▊         | 18/236 [01:16<11:47,  3.25s/it]
test ppl:   8%|▊         | 19/236 [01:20<13:00,  3.60s/it]
test ppl:   8%|▊         | 20/236 [01:22<10:58,  3.05s/it]
test ppl:   9%|▉         | 21/236 [01:24<10:10,  2.84s/it]
test ppl:   9%|▉         | 22/236 [01:30<13:21,  3.74s/it]
test ppl:  10%|▉         | 23/236 [01:32<11:58,  3.37s/it]
test ppl:  10%|█         | 24/236 [01:35<10:48,  3.06s/it]
test ppl:  11%|█         | 25/236 [01:41<13:43,  3.90s/it]
test ppl:  11%|█         | 26/236 [01:46<15:43,  4.49s/it]
test ppl:  11%|█▏        | 27/236 [01:51<15:16,  4.39s/it]
test ppl:  12%|█▏        | 28/236 [01:52<11:54,  3.44s/it]
test ppl:  12%|█▏        | 29/236 [01:54<10:41,  3.10s/it]
test ppl:  13%|█▎        | 30/236 [01:56<09:00,  2.62s/it]
test ppl:  13%|█▎        | 31/236 [01:58<08:18,  2.43s/it]
test ppl:  14%|█▎        | 32/236 [02:00<08:38,  2.54s/it]
test ppl:  14%|█▍        | 33/236 [02:03<08:58,  2.65s/it]
test ppl:  14%|█▍        | 34/236 [02:07<10:16,  3.05s/it]
test ppl:  15%|█▍        | 35/236 [02:10<09:41,  2.89s/it]
test ppl:  15%|█▌        | 36/236 [02:16<12:35,  3.78s/it]
test ppl:  16%|█▌        | 37/236 [02:22<14:36,  4.41s/it]
test ppl:  16%|█▌        | 38/236 [02:24<12:12,  3.70s/it]
test ppl:  17%|█▋        | 39/236 [02:25<09:59,  3.04s/it]
test ppl:  17%|█▋        | 40/236 [02:28<09:34,  2.93s/it]
test ppl:  17%|█▋        | 41/236 [02:30<08:29,  2.61s/it]
test ppl:  18%|█▊        | 42/236 [02:36<11:37,  3.60s/it]
test ppl:  18%|█▊        | 43/236 [02:41<13:45,  4.28s/it]
test ppl:  19%|█▊        | 44/236 [02:43<11:31,  3.60s/it]
test ppl:  19%|█▉        | 45/236 [02:45<09:54,  3.11s/it]
test ppl:  19%|█▉        | 46/236 [02:51<12:30,  3.95s/it]
test ppl:  20%|█▉        | 47/236 [02:53<10:08,  3.22s/it]
test ppl:  20%|██        | 48/236 [02:59<12:32,  4.00s/it]
test ppl:  21%|██        | 49/236 [03:03<12:43,  4.08s/it]
test ppl:  21%|██        | 50/236 [03:09<14:21,  4.63s/it]
test ppl:  22%|██▏       | 51/236 [03:15<15:26,  5.01s/it]
test ppl:  22%|██▏       | 52/236 [03:21<16:08,  5.26s/it]
test ppl:  22%|██▏       | 53/236 [03:25<15:38,  5.13s/it]
test ppl:  23%|██▎       | 54/236 [03:27<12:16,  4.05s/it]
test ppl:  23%|██▎       | 55/236 [03:33<13:37,  4.52s/it]
test ppl:  24%|██▎       | 56/236 [03:36<12:31,  4.18s/it]
test ppl:  24%|██▍       | 57/236 [03:38<10:46,  3.61s/it]
test ppl:  25%|██▍       | 58/236 [03:40<09:26,  3.18s/it]
test ppl:  25%|██▌       | 59/236 [03:46<11:44,  3.98s/it]
test ppl:  25%|██▌       | 60/236 [03:49<10:48,  3.68s/it]
test ppl:  26%|██▌       | 61/236 [03:55<12:37,  4.33s/it]
test ppl:  26%|██▋       | 62/236 [03:59<12:21,  4.26s/it]
test ppl:  27%|██▋       | 63/236 [04:02<11:22,  3.95s/it]
test ppl:  27%|██▋       | 64/236 [04:04<09:33,  3.34s/it]
test ppl:  28%|██▊       | 65/236 [04:06<07:47,  2.73s/it]
test ppl:  28%|██▊       | 66/236 [04:09<07:58,  2.82s/it]
test ppl:  28%|██▊       | 67/236 [04:14<10:30,  3.73s/it]
test ppl:  29%|██▉       | 68/236 [04:20<12:14,  4.37s/it]
test ppl:  29%|██▉       | 69/236 [04:26<13:24,  4.81s/it]
test ppl:  30%|██▉       | 70/236 [04:28<10:40,  3.86s/it]
test ppl:  30%|███       | 71/236 [04:34<12:08,  4.41s/it]
test ppl:  31%|███       | 72/236 [04:37<11:33,  4.23s/it]
test ppl:  31%|███       | 73/236 [04:41<11:15,  4.15s/it]
test ppl:  31%|███▏      | 74/236 [04:43<09:03,  3.36s/it]
test ppl:  32%|███▏      | 75/236 [04:49<11:01,  4.11s/it]
test ppl:  32%|███▏      | 76/236 [04:52<10:26,  3.91s/it]
test ppl:  33%|███▎      | 77/236 [04:54<09:04,  3.42s/it]
test ppl:  33%|███▎      | 78/236 [04:56<07:48,  2.97s/it]
test ppl:  33%|███▎      | 79/236 [05:00<08:29,  3.25s/it]
test ppl:  34%|███▍      | 80/236 [05:02<07:24,  2.85s/it]
test ppl:  34%|███▍      | 81/236 [05:08<09:40,  3.74s/it]
test ppl:  35%|███▍      | 82/236 [05:14<11:14,  4.38s/it]
test ppl:  35%|███▌      | 83/236 [05:16<09:20,  3.66s/it]
test ppl:  36%|███▌      | 84/236 [05:18<07:55,  3.13s/it]
test ppl:  36%|███▌      | 85/236 [05:22<08:36,  3.42s/it]
test ppl:  36%|███▋      | 86/236 [05:24<07:25,  2.97s/it]
test ppl:  37%|███▋      | 87/236 [05:26<06:43,  2.71s/it]
test ppl:  37%|███▋      | 88/236 [05:32<08:59,  3.65s/it]
test ppl:  38%|███▊      | 89/236 [05:37<10:32,  4.30s/it]
test ppl:  38%|███▊      | 90/236 [05:43<11:35,  4.77s/it]
test ppl:  39%|███▊      | 91/236 [05:48<11:36,  4.80s/it]
test ppl:  39%|███▉      | 92/236 [05:51<10:04,  4.20s/it]
test ppl:  39%|███▉      | 93/236 [05:57<11:10,  4.69s/it]
test ppl:  40%|███▉      | 94/236 [06:03<11:54,  5.03s/it]
test ppl:  40%|████      | 95/236 [06:06<10:16,  4.38s/it]
test ppl:  41%|████      | 96/236 [06:08<09:11,  3.94s/it]
test ppl:  41%|████      | 97/236 [06:14<10:27,  4.51s/it]
test ppl:  42%|████▏     | 98/236 [06:20<11:19,  4.92s/it]
test ppl:  42%|████▏     | 99/236 [06:26<11:52,  5.20s/it]
test ppl:  42%|████▏     | 100/236 [06:27<09:08,  4.04s/it]
test ppl:  43%|████▎     | 101/236 [06:33<10:18,  4.58s/it]
test ppl:  43%|████▎     | 102/236 [06:37<09:34,  4.29s/it]
test ppl:  44%|████▎     | 103/236 [06:39<07:48,  3.52s/it]
test ppl:  44%|████▍     | 104/236 [06:43<08:12,  3.73s/it]
test ppl:  44%|████▍     | 105/236 [06:47<08:17,  3.80s/it]
test ppl:  45%|████▍     | 106/236 [06:52<09:15,  4.27s/it]
test ppl:  45%|████▌     | 107/236 [06:54<07:56,  3.70s/it]
test ppl:  46%|████▌     | 108/236 [06:59<08:08,  3.81s/it]
test ppl:  46%|████▌     | 109/236 [07:03<08:10,  3.86s/it]
test ppl:  47%|████▋     | 110/236 [07:05<07:13,  3.44s/it]
test ppl:  47%|████▋     | 111/236 [07:09<07:25,  3.56s/it]
test ppl:  47%|████▋     | 112/236 [07:12<07:15,  3.51s/it]
test ppl:  48%|████▊     | 113/236 [07:14<06:07,  2.99s/it]
test ppl:  48%|████▊     | 114/236 [07:19<07:06,  3.50s/it]
test ppl:  49%|████▊     | 115/236 [07:24<08:28,  4.20s/it]
test ppl:  49%|████▉     | 116/236 [07:30<09:23,  4.69s/it]
test ppl:  50%|████▉     | 117/236 [07:32<07:36,  3.84s/it]
test ppl:  50%|█████     | 118/236 [07:36<07:47,  3.96s/it]
test ppl:  50%|█████     | 119/236 [07:40<07:19,  3.76s/it]
test ppl:  51%|█████     | 120/236 [07:41<05:51,  3.03s/it]
test ppl:  51%|█████▏    | 121/236 [07:47<07:25,  3.87s/it]
test ppl:  52%|█████▏    | 122/236 [07:52<07:52,  4.14s/it]
test ppl:  52%|█████▏    | 123/236 [07:54<06:40,  3.54s/it]
test ppl:  53%|█████▎    | 124/236 [07:57<06:10,  3.31s/it]
test ppl:  53%|█████▎    | 125/236 [08:02<07:31,  4.07s/it]
test ppl:  53%|█████▎    | 126/236 [08:06<07:14,  3.95s/it]
test ppl:  54%|█████▍    | 127/236 [08:08<06:10,  3.39s/it]
test ppl:  54%|█████▍    | 128/236 [08:10<05:29,  3.05s/it]
test ppl:  55%|█████▍    | 129/236 [08:13<05:21,  3.00s/it]
test ppl:  55%|█████▌    | 130/236 [08:16<05:22,  3.04s/it]
test ppl:  56%|█████▌    | 131/236 [08:22<06:47,  3.89s/it]
test ppl:  56%|█████▌    | 132/236 [08:25<05:59,  3.46s/it]
test ppl:  56%|█████▋    | 133/236 [08:29<06:09,  3.59s/it]
test ppl:  57%|█████▋    | 134/236 [08:34<07:05,  4.17s/it]
test ppl:  57%|█████▋    | 135/236 [08:40<07:37,  4.53s/it]
test ppl:  58%|█████▊    | 136/236 [08:41<05:54,  3.55s/it]
test ppl:  58%|█████▊    | 137/236 [08:47<07:00,  4.25s/it]
test ppl:  58%|█████▊    | 138/236 [08:50<06:25,  3.94s/it]
test ppl:  59%|█████▉    | 139/236 [08:52<05:42,  3.53s/it]
test ppl:  59%|█████▉    | 140/236 [08:54<04:45,  2.97s/it]
test ppl:  60%|█████▉    | 141/236 [08:57<04:39,  2.94s/it]
test ppl:  60%|██████    | 142/236 [08:59<04:12,  2.69s/it]
test ppl:  61%|██████    | 143/236 [09:05<05:38,  3.64s/it]
test ppl:  61%|██████    | 144/236 [09:08<05:09,  3.36s/it]
test ppl:  61%|██████▏   | 145/236 [09:13<06:10,  4.07s/it]
test ppl:  62%|██████▏   | 146/236 [09:18<06:18,  4.20s/it]
test ppl:  62%|██████▏   | 147/236 [09:24<06:58,  4.70s/it]
test ppl:  63%|██████▎   | 148/236 [09:30<07:27,  5.08s/it]
test ppl:  63%|██████▎   | 149/236 [09:33<06:36,  4.56s/it]
test ppl:  64%|██████▎   | 150/236 [09:39<07:06,  4.96s/it]
test ppl:  64%|██████▍   | 151/236 [09:45<07:24,  5.23s/it]
test ppl:  64%|██████▍   | 152/236 [09:51<07:34,  5.41s/it]
test ppl:  65%|██████▍   | 153/236 [09:56<07:31,  5.43s/it]
test ppl:  65%|██████▌   | 154/236 [09:59<06:13,  4.55s/it]
test ppl:  66%|██████▌   | 155/236 [10:01<05:21,  3.97s/it]
test ppl:  66%|██████▌   | 156/236 [10:03<04:33,  3.42s/it]
test ppl:  67%|██████▋   | 157/236 [10:06<04:01,  3.05s/it]
test ppl:  67%|██████▋   | 158/236 [10:11<05:03,  3.90s/it]
test ppl:  67%|██████▋   | 159/236 [10:17<05:45,  4.48s/it]
test ppl:  68%|██████▊   | 160/236 [10:19<04:25,  3.49s/it]
test ppl:  68%|██████▊   | 161/236 [10:20<03:33,  2.85s/it]
test ppl:  69%|██████▊   | 162/236 [10:23<03:36,  2.93s/it]
test ppl:  69%|██████▉   | 163/236 [10:26<03:25,  2.81s/it]
test ppl:  69%|██████▉   | 164/236 [10:30<03:50,  3.20s/it]
test ppl:  70%|██████▉   | 165/236 [10:35<04:37,  3.91s/it]
test ppl:  70%|███████   | 166/236 [10:37<03:51,  3.31s/it]
test ppl:  71%|███████   | 167/236 [10:39<03:10,  2.76s/it]
test ppl:  71%|███████   | 168/236 [10:44<04:10,  3.68s/it]
test ppl:  72%|███████▏  | 169/236 [10:50<04:41,  4.20s/it]
test ppl:  72%|███████▏  | 170/236 [10:56<05:10,  4.70s/it]
test ppl:  72%|███████▏  | 171/236 [10:57<04:00,  3.69s/it]
test ppl:  73%|███████▎  | 172/236 [11:03<04:37,  4.34s/it]
test ppl:  73%|███████▎  | 173/236 [11:06<04:17,  4.08s/it]
test ppl:  74%|███████▎  | 174/236 [11:12<04:46,  4.62s/it]
test ppl:  74%|███████▍  | 175/236 [11:14<03:50,  3.78s/it]
test ppl:  75%|███████▍  | 176/236 [11:19<04:12,  4.20s/it]
test ppl:  75%|███████▌  | 177/236 [11:25<04:37,  4.71s/it]
test ppl:  75%|███████▌  | 178/236 [11:31<04:53,  5.06s/it]
test ppl:  76%|███████▌  | 179/236 [11:37<05:02,  5.30s/it]
test ppl:  76%|███████▋  | 180/236 [11:41<04:34,  4.90s/it]
test ppl:  77%|███████▋  | 181/236 [11:47<04:44,  5.18s/it]
test ppl:  77%|███████▋  | 182/236 [11:49<03:46,  4.19s/it]
test ppl:  78%|███████▊  | 183/236 [11:51<03:11,  3.62s/it]
test ppl:  78%|███████▊  | 184/236 [11:52<02:32,  2.94s/it]
test ppl:  78%|███████▊  | 185/236 [11:56<02:42,  3.18s/it]
test ppl:  79%|███████▉  | 186/236 [11:58<02:21,  2.82s/it]
test ppl:  79%|███████▉  | 187/236 [12:04<03:03,  3.75s/it]
test ppl:  80%|███████▉  | 188/236 [12:10<03:30,  4.39s/it]
test ppl:  80%|████████  | 189/236 [12:16<03:47,  4.83s/it]
test ppl:  81%|████████  | 190/236 [12:20<03:33,  4.65s/it]
test ppl:  81%|████████  | 191/236 [12:24<03:24,  4.55s/it]
test ppl:  81%|████████▏ | 192/236 [12:27<02:54,  3.97s/it]
test ppl:  82%|████████▏ | 193/236 [12:33<03:15,  4.54s/it]
test ppl:  82%|████████▏ | 194/236 [12:35<02:46,  3.97s/it]
test ppl:  83%|████████▎ | 195/236 [12:38<02:31,  3.69s/it]
test ppl:  83%|████████▎ | 196/236 [12:40<02:07,  3.19s/it]
test ppl:  83%|████████▎ | 197/236 [12:42<01:51,  2.87s/it]
test ppl:  84%|████████▍ | 198/236 [12:48<02:22,  3.76s/it]
test ppl:  84%|████████▍ | 199/236 [12:51<02:07,  3.44s/it]
test ppl:  85%|████████▍ | 200/236 [12:57<02:29,  4.16s/it]
test ppl:  85%|████████▌ | 201/236 [12:59<02:03,  3.52s/it]
test ppl:  86%|████████▌ | 202/236 [13:05<02:23,  4.22s/it]
test ppl:  86%|████████▌ | 203/236 [13:11<02:35,  4.71s/it]
test ppl:  86%|████████▋ | 204/236 [13:12<01:59,  3.74s/it]
test ppl:  87%|████████▋ | 205/236 [13:18<02:15,  4.38s/it]
test ppl:  87%|████████▋ | 206/236 [13:21<02:01,  4.06s/it]
test ppl:  88%|████████▊ | 207/236 [13:27<02:13,  4.59s/it]
test ppl:  88%|████████▊ | 208/236 [13:31<01:59,  4.26s/it]
test ppl:  89%|████████▊ | 209/236 [13:36<02:08,  4.77s/it]
test ppl:  89%|████████▉ | 210/236 [13:39<01:44,  4.04s/it]
test ppl:  89%|████████▉ | 211/236 [13:43<01:38,  3.95s/it]
test ppl:  90%|████████▉ | 212/236 [13:48<01:48,  4.51s/it]
test ppl:  90%|█████████ | 213/236 [13:54<01:52,  4.91s/it]
test ppl:  91%|█████████ | 214/236 [13:56<01:24,  3.84s/it]
test ppl:  91%|█████████ | 215/236 [14:01<01:33,  4.44s/it]
test ppl:  92%|█████████▏| 216/236 [14:03<01:12,  3.61s/it]
test ppl:  92%|█████████▏| 217/236 [14:09<01:22,  4.32s/it]
test ppl:  92%|█████████▏| 218/236 [14:11<01:04,  3.61s/it]
test ppl:  93%|█████████▎| 219/236 [14:17<01:12,  4.29s/it]
test ppl:  93%|█████████▎| 220/236 [14:23<01:16,  4.76s/it]
test ppl:  94%|█████████▎| 221/236 [14:25<01:02,  4.13s/it]
test ppl:  94%|█████████▍| 222/236 [14:31<01:05,  4.66s/it]
test ppl:  94%|█████████▍| 223/236 [14:37<01:05,  5.02s/it]
test ppl:  95%|█████████▍| 224/236 [14:39<00:47,  3.98s/it]
test ppl:  95%|█████████▌| 225/236 [14:45<00:49,  4.54s/it]
test ppl:  96%|█████████▌| 226/236 [14:48<00:40,  4.09s/it]
test ppl:  96%|█████████▌| 227/236 [14:50<00:32,  3.63s/it]
test ppl:  97%|█████████▋| 228/236 [14:52<00:24,  3.11s/it]
test ppl:  97%|█████████▋| 229/236 [14:58<00:27,  3.93s/it]
test ppl:  97%|█████████▋| 230/236 [15:01<00:22,  3.80s/it]
test ppl:  98%|█████████▊| 231/236 [15:05<00:18,  3.67s/it]
test ppl:  98%|█████████▊| 232/236 [15:07<00:12,  3.15s/it]
test ppl:  99%|█████████▊| 233/236 [15:09<00:08,  2.85s/it]
test ppl:  99%|█████████▉| 234/236 [15:10<00:04,  2.36s/it]
test ppl: 100%|█████████▉| 235/236 [15:16<00:03,  3.41s/it]
test ppl: 100%|██████████| 236/236 [15:17<00:00,  2.58s/it]
test ppl: 100%|██████████| 236/236 [15:17<00:00,  3.89s/it]
10/12/2024 19:09:35 - INFO - __main__ -    em: 0.2056
10/12/2024 19:09:35 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.4 100:  em: 0.2056

--------------------------------------------------------------------------------
Running experiment with knn_temp=100, lmbda=0.6, k=16
2024-10-12 19:09:42.707858: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 19:09:42.727390: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 19:09:42.749190: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 19:09:42.755798: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 19:09:42.771735: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 19:09:43.768257: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 19:09:45 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.6, knn_temp=100, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 19:09:45 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:37:51,  2.20it/s]
Adding feature api:   4%|▍         | 7308/187062 [00:00<00:10, 17467.47it/s]
Adding feature api:   8%|▊         | 15430/187062 [00:00<00:05, 33694.63it/s]
Adding feature api:  13%|█▎        | 23857/187062 [00:00<00:03, 47180.41it/s]
Adding feature api:  17%|█▋        | 32334/187062 [00:00<00:02, 57548.42it/s]
Adding feature api:  22%|██▏       | 40786/187062 [00:00<00:02, 65172.06it/s]
Adding feature api:  26%|██▋       | 49106/187062 [00:01<00:01, 70136.88it/s]
Adding feature api:  31%|███       | 57545/187062 [00:01<00:01, 74276.85it/s]
Adding feature api:  35%|███▌      | 66018/187062 [00:01<00:01, 77341.35it/s]
Adding feature api:  40%|███▉      | 74485/187062 [00:01<00:01, 79503.25it/s]
Adding feature api:  44%|████▍     | 82939/187062 [00:01<00:01, 80995.08it/s]
Adding feature api:  49%|████▉     | 91287/187062 [00:01<00:01, 81367.07it/s]
Adding feature api:  53%|█████▎    | 99765/187062 [00:01<00:01, 82379.32it/s]
Adding feature api:  58%|█████▊    | 108251/187062 [00:01<00:00, 83118.45it/s]
Adding feature api:  62%|██████▏   | 116664/187062 [00:01<00:00, 83417.68it/s]
Adding feature api:  67%|██████▋   | 125067/187062 [00:01<00:00, 83064.19it/s]
Adding feature api:  71%|███████▏  | 133537/187062 [00:02<00:00, 83548.28it/s]
Adding feature api:  76%|███████▌  | 141985/187062 [00:02<00:00, 83825.80it/s]
Adding feature api:  80%|████████  | 150407/187062 [00:02<00:00, 83940.70it/s]
Adding feature api:  85%|████████▍ | 158817/187062 [00:02<00:00, 83480.32it/s]
Adding feature api:  89%|████████▉ | 167269/187062 [00:02<00:00, 83788.39it/s]
Adding feature api:  94%|█████████▍| 175726/187062 [00:02<00:00, 84021.45it/s]
Adding feature api:  98%|█████████▊| 184134/187062 [00:02<00:00, 57186.25it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64369.80it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:24:05,  2.22it/s]
Adding feature datatype:   4%|▍         | 7138/187062 [00:00<00:10, 17188.26it/s]
Adding feature datatype:   8%|▊         | 15317/187062 [00:00<00:05, 33723.33it/s]
Adding feature datatype:  13%|█▎        | 23548/187062 [00:00<00:03, 46732.09it/s]
Adding feature datatype:  17%|█▋        | 31791/187062 [00:00<00:02, 56607.04it/s]
Adding feature datatype:  21%|██▏       | 40017/187062 [00:00<00:02, 63873.31it/s]
Adding feature datatype:  26%|██▌       | 47856/187062 [00:01<00:02, 68053.68it/s]
Adding feature datatype:  30%|██▉       | 56051/187062 [00:01<00:01, 72104.13it/s]
Adding feature datatype:  34%|███▍      | 64259/187062 [00:01<00:01, 75034.63it/s]
Adding feature datatype:  39%|███▊      | 72432/187062 [00:01<00:01, 77014.23it/s]
Adding feature datatype:  43%|████▎     | 80666/187062 [00:01<00:01, 78594.33it/s]
Adding feature datatype:  47%|████▋     | 88764/187062 [00:01<00:01, 78858.77it/s]
Adding feature datatype:  52%|█████▏    | 96989/187062 [00:01<00:01, 79863.87it/s]
Adding feature datatype:  56%|█████▋    | 105246/187062 [00:01<00:01, 80668.05it/s]
Adding feature datatype:  61%|██████    | 113492/187062 [00:01<00:00, 81202.44it/s]
Adding feature datatype:  65%|██████▌   | 121712/187062 [00:01<00:00, 81497.56it/s]
Adding feature datatype:  69%|██████▉   | 129976/187062 [00:02<00:00, 81838.75it/s]
Adding feature datatype:  74%|███████▍  | 138189/187062 [00:02<00:00, 80795.03it/s]
Adding feature datatype:  78%|███████▊  | 146420/187062 [00:02<00:00, 81242.12it/s]
Adding feature datatype:  83%|████████▎ | 154652/187062 [00:02<00:00, 81560.62it/s]
Adding feature datatype:  87%|████████▋ | 162897/187062 [00:02<00:00, 81823.64it/s]
Adding feature datatype:  91%|█████████▏| 171126/187062 [00:02<00:00, 81961.82it/s]
Adding feature datatype:  96%|█████████▌| 179329/187062 [00:02<00:00, 73053.62it/s]
Adding feature datatype: 100%|█████████▉| 186818/187062 [00:02<00:00, 51978.69it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63276.75it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:10:20,  2.24it/s]
Adding feature literal:   4%|▍         | 7079/187062 [00:00<00:10, 17174.02it/s]
Adding feature literal:   8%|▊         | 15167/187062 [00:00<00:05, 33570.54it/s]
Adding feature literal:  12%|█▏        | 23293/187062 [00:00<00:03, 46391.03it/s]
Adding feature literal:  17%|█▋        | 31385/187062 [00:00<00:02, 55971.85it/s]
Adding feature literal:  21%|██        | 39505/187062 [00:00<00:02, 63131.66it/s]
Adding feature literal:  25%|██▌       | 47660/187062 [00:01<00:02, 68443.55it/s]
Adding feature literal:  30%|██▉       | 55819/187062 [00:01<00:01, 72279.35it/s]
Adding feature literal:  34%|███▍      | 63968/187062 [00:01<00:01, 74987.08it/s]
Adding feature literal:  39%|███▊      | 72080/187062 [00:01<00:01, 76800.12it/s]
Adding feature literal:  43%|████▎     | 80181/187062 [00:01<00:01, 78042.09it/s]
Adding feature literal:  47%|████▋     | 88358/187062 [00:01<00:01, 79152.14it/s]
Adding feature literal:  52%|█████▏    | 96524/187062 [00:01<00:01, 79899.53it/s]
Adding feature literal:  56%|█████▌    | 104745/187062 [00:01<00:01, 80587.51it/s]
Adding feature literal:  60%|██████    | 112949/187062 [00:01<00:00, 81020.40it/s]
Adding feature literal:  65%|██████▍   | 121109/187062 [00:01<00:00, 81021.43it/s]
Adding feature literal:  69%|██████▉   | 129274/187062 [00:02<00:00, 81207.44it/s]
Adding feature literal:  73%|███████▎  | 137455/187062 [00:02<00:00, 81385.74it/s]
Adding feature literal:  78%|███████▊  | 145672/187062 [00:02<00:00, 81617.87it/s]
Adding feature literal:  82%|████████▏ | 153854/187062 [00:02<00:00, 81676.61it/s]
Adding feature literal:  87%|████████▋ | 162032/187062 [00:02<00:00, 81679.49it/s]
Adding feature literal:  91%|█████████ | 170207/187062 [00:02<00:00, 81698.96it/s]
Adding feature literal:  95%|█████████▌| 178382/187062 [00:02<00:00, 77704.70it/s]
Adding feature literal: 100%|█████████▉| 186197/187062 [00:02<00:00, 52262.79it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63172.72it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:14:45,  2.24it/s]
Adding feature operator:   4%|▍         | 7104/187062 [00:00<00:10, 17193.35it/s]
Adding feature operator:   8%|▊         | 15261/187062 [00:00<00:05, 33732.17it/s]
Adding feature operator:  13%|█▎        | 23495/187062 [00:00<00:03, 46781.87it/s]
Adding feature operator:  17%|█▋        | 31723/187062 [00:00<00:02, 56622.26it/s]
Adding feature operator:  21%|██▏       | 39928/187062 [00:00<00:02, 63834.79it/s]
Adding feature operator:  26%|██▌       | 48041/187062 [00:01<00:02, 68820.71it/s]
Adding feature operator:  30%|███       | 56280/187062 [00:01<00:01, 72779.21it/s]
Adding feature operator:  35%|███▍      | 64540/187062 [00:01<00:01, 75666.79it/s]
Adding feature operator:  39%|███▉      | 72718/187062 [00:01<00:01, 77472.95it/s]
Adding feature operator:  43%|████▎     | 80982/187062 [00:01<00:01, 79005.54it/s]
Adding feature operator:  48%|████▊     | 89264/187062 [00:01<00:01, 80139.30it/s]
Adding feature operator:  52%|█████▏    | 97505/187062 [00:01<00:01, 80815.20it/s]
Adding feature operator:  57%|█████▋    | 105754/187062 [00:01<00:00, 81314.81it/s]
Adding feature operator:  61%|██████    | 114077/187062 [00:01<00:00, 81887.27it/s]
Adding feature operator:  65%|██████▌   | 122355/187062 [00:01<00:00, 82147.75it/s]
Adding feature operator:  70%|██████▉   | 130611/187062 [00:02<00:00, 82190.74it/s]
Adding feature operator:  74%|███████▍  | 138863/187062 [00:02<00:00, 82288.45it/s]
Adding feature operator:  79%|███████▊  | 147112/187062 [00:02<00:00, 82255.07it/s]
Adding feature operator:  83%|████████▎ | 155356/187062 [00:02<00:00, 82309.49it/s]
Adding feature operator:  87%|████████▋ | 163597/187062 [00:02<00:00, 82228.30it/s]
Adding feature operator:  92%|█████████▏| 171827/187062 [00:02<00:00, 82240.70it/s]
Adding feature operator:  96%|█████████▋| 180056/187062 [00:02<00:00, 70695.83it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63621.44it/s]
[2024-10-12 19:10:28,999] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 19:10:30 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 19:10:30 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 39/6548 [00:00<00:17, 374.52 examples/s]
Map:   1%|▏         | 90/6548 [00:00<00:28, 225.13 examples/s]
Map:   2%|▏         | 129/6548 [00:00<00:23, 271.18 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 317.98 examples/s]
Map:   3%|▎         | 220/6548 [00:00<00:18, 346.77 examples/s]
Map:   4%|▍         | 284/6548 [00:00<00:17, 365.10 examples/s]
Map:   5%|▍         | 325/6548 [00:01<00:20, 310.07 examples/s]
Map:   6%|▌         | 364/6548 [00:01<00:19, 324.09 examples/s]
Map:   6%|▋         | 418/6548 [00:01<00:16, 375.19 examples/s]
Map:   7%|▋         | 469/6548 [00:01<00:16, 358.60 examples/s]
Map:   8%|▊         | 521/6548 [00:01<00:17, 353.16 examples/s]
Map:   9%|▊         | 572/6548 [00:01<00:15, 386.68 examples/s]
Map:   9%|▉         | 622/6548 [00:01<00:17, 346.99 examples/s]
Map:  10%|█         | 679/6548 [00:02<00:16, 349.58 examples/s]
Map:  11%|█         | 720/6548 [00:02<00:16, 361.55 examples/s]
Map:  12%|█▏        | 765/6548 [00:02<00:15, 381.60 examples/s]
Map:  12%|█▏        | 815/6548 [00:02<00:13, 410.35 examples/s]
Map:  13%|█▎        | 873/6548 [00:02<00:14, 388.66 examples/s]
Map:  14%|█▍        | 932/6548 [00:02<00:15, 370.36 examples/s]
Map:  15%|█▍        | 972/6548 [00:02<00:14, 375.12 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:23, 236.55 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:20, 262.30 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:18, 296.76 examples/s]
Map:  18%|█▊        | 1147/6548 [00:03<00:16, 336.24 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 352.23 examples/s]
Map:  19%|█▉        | 1267/6548 [00:03<00:14, 363.99 examples/s]
Map:  20%|██        | 1325/6548 [00:03<00:14, 363.25 examples/s]
Map:  21%|██        | 1370/6548 [00:04<00:15, 336.14 examples/s]
Map:  22%|██▏       | 1417/6548 [00:04<00:15, 322.89 examples/s]
Map:  22%|██▏       | 1461/6548 [00:04<00:17, 297.02 examples/s]
Map:  23%|██▎       | 1494/6548 [00:04<00:16, 301.76 examples/s]
Map:  23%|██▎       | 1526/6548 [00:04<00:16, 304.48 examples/s]
Map:  24%|██▍       | 1560/6548 [00:04<00:16, 301.21 examples/s]
Map:  24%|██▍       | 1596/6548 [00:04<00:15, 309.52 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:16, 294.58 examples/s]
Map:  26%|██▌       | 1685/6548 [00:05<00:17, 284.98 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:15, 311.95 examples/s]
Map:  27%|██▋       | 1771/6548 [00:05<00:13, 341.87 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:13, 347.01 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 356.41 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 351.28 examples/s]
Map:  30%|██▉       | 1961/6548 [00:05<00:12, 355.05 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:18, 239.70 examples/s]
Map:  31%|███       | 2042/6548 [00:06<00:18, 247.66 examples/s]
Map:  32%|███▏      | 2083/6548 [00:06<00:16, 277.44 examples/s]
Map:  32%|███▏      | 2118/6548 [00:06<00:15, 279.86 examples/s]
Map:  33%|███▎      | 2152/6548 [00:06<00:17, 254.38 examples/s]
Map:  34%|███▎      | 2194/6548 [00:06<00:15, 288.97 examples/s]
Map:  34%|███▍      | 2235/6548 [00:07<00:16, 256.53 examples/s]
Map:  35%|███▍      | 2271/6548 [00:07<00:15, 273.82 examples/s]
Map:  35%|███▌      | 2309/6548 [00:07<00:14, 294.55 examples/s]
Map:  36%|███▌      | 2350/6548 [00:07<00:13, 319.76 examples/s]
Map:  37%|███▋      | 2399/6548 [00:07<00:12, 319.85 examples/s]
Map:  37%|███▋      | 2438/6548 [00:07<00:13, 310.25 examples/s]
Map:  38%|███▊      | 2472/6548 [00:07<00:12, 314.84 examples/s]
Map:  38%|███▊      | 2510/6548 [00:07<00:12, 330.63 examples/s]
Map:  39%|███▉      | 2551/6548 [00:07<00:11, 346.88 examples/s]
Map:  40%|███▉      | 2598/6548 [00:08<00:10, 378.78 examples/s]
Map:  40%|████      | 2639/6548 [00:08<00:10, 384.92 examples/s]
Map:  41%|████      | 2696/6548 [00:08<00:10, 362.56 examples/s]
Map:  42%|████▏     | 2745/6548 [00:08<00:11, 338.07 examples/s]
Map:  43%|████▎     | 2783/6548 [00:08<00:10, 343.30 examples/s]
Map:  43%|████▎     | 2826/6548 [00:08<00:12, 309.44 examples/s]
Map:  44%|████▎     | 2862/6548 [00:08<00:13, 273.33 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 284.52 examples/s]
Map:  45%|████▌     | 2952/6548 [00:09<00:11, 301.96 examples/s]
Map:  46%|████▌     | 2988/6548 [00:09<00:11, 304.12 examples/s]
Map:  46%|████▌     | 3028/6548 [00:09<00:20, 172.90 examples/s]
Map:  47%|████▋     | 3064/6548 [00:09<00:17, 200.84 examples/s]
Map:  47%|████▋     | 3094/6548 [00:10<00:15, 217.78 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 252.93 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:13, 257.16 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 250.67 examples/s]
Map:  49%|████▉     | 3232/6548 [00:10<00:12, 258.31 examples/s]
Map:  50%|████▉     | 3265/6548 [00:10<00:11, 273.85 examples/s]
Map:  50%|█████     | 3295/6548 [00:10<00:12, 269.32 examples/s]
Map:  51%|█████     | 3339/6548 [00:10<00:10, 313.03 examples/s]
Map:  52%|█████▏    | 3387/6548 [00:10<00:10, 312.52 examples/s]
Map:  52%|█████▏    | 3422/6548 [00:11<00:11, 280.68 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 268.38 examples/s]
Map:  53%|█████▎    | 3496/6548 [00:11<00:11, 267.64 examples/s]
Map:  54%|█████▍    | 3545/6548 [00:11<00:09, 317.37 examples/s]
Map:  55%|█████▍    | 3591/6548 [00:11<00:08, 350.94 examples/s]
Map:  56%|█████▌    | 3637/6548 [00:11<00:07, 377.14 examples/s]
Map:  56%|█████▋    | 3696/6548 [00:11<00:07, 379.98 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:12<00:07, 385.70 examples/s]
Map:  58%|█████▊    | 3800/6548 [00:12<00:07, 388.60 examples/s]
Map:  59%|█████▊    | 3841/6548 [00:12<00:08, 327.77 examples/s]
Map:  59%|█████▉    | 3885/6548 [00:12<00:08, 315.69 examples/s]
Map:  60%|██████    | 3929/6548 [00:12<00:08, 322.21 examples/s]
Map:  61%|██████    | 3972/6548 [00:12<00:07, 344.31 examples/s]
Map:  62%|██████▏   | 4029/6548 [00:13<00:10, 251.87 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 294.31 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 318.54 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:08, 295.52 examples/s]
Map:  64%|██████▍   | 4206/6548 [00:13<00:07, 308.24 examples/s]
Map:  65%|██████▌   | 4266/6548 [00:13<00:06, 335.68 examples/s]
Map:  66%|██████▌   | 4324/6548 [00:13<00:06, 349.35 examples/s]
Map:  67%|██████▋   | 4376/6548 [00:14<00:06, 347.39 examples/s]
Map:  67%|██████▋   | 4413/6548 [00:14<00:06, 349.13 examples/s]
Map:  68%|██████▊   | 4458/6548 [00:14<00:05, 371.46 examples/s]
Map:  69%|██████▊   | 4497/6548 [00:14<00:06, 315.20 examples/s]
Map:  69%|██████▉   | 4535/6548 [00:14<00:06, 288.26 examples/s]
Map:  70%|██████▉   | 4574/6548 [00:14<00:06, 309.70 examples/s]
Map:  70%|███████   | 4610/6548 [00:14<00:06, 314.44 examples/s]
Map:  71%|███████   | 4656/6548 [00:14<00:05, 350.51 examples/s]
Map:  72%|███████▏  | 4712/6548 [00:15<00:05, 353.46 examples/s]
Map:  73%|███████▎  | 4776/6548 [00:15<00:04, 369.45 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 378.04 examples/s]
Map:  75%|███████▍  | 4880/6548 [00:15<00:04, 354.64 examples/s]
Map:  75%|███████▌  | 4928/6548 [00:15<00:04, 362.00 examples/s]
Map:  76%|███████▌  | 4979/6548 [00:15<00:03, 393.98 examples/s]
Map:  77%|███████▋  | 5037/6548 [00:16<00:06, 248.76 examples/s]
Map:  78%|███████▊  | 5081/6548 [00:16<00:05, 256.49 examples/s]
Map:  78%|███████▊  | 5116/6548 [00:16<00:05, 272.32 examples/s]
Map:  79%|███████▉  | 5166/6548 [00:16<00:04, 287.05 examples/s]
Map:  80%|███████▉  | 5211/6548 [00:16<00:04, 282.69 examples/s]
Map:  80%|████████  | 5254/6548 [00:16<00:04, 311.62 examples/s]
Map:  81%|████████  | 5313/6548 [00:16<00:03, 334.53 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:04, 290.12 examples/s]
Map:  83%|████████▎ | 5405/6548 [00:17<00:04, 277.58 examples/s]
Map:  83%|████████▎ | 5448/6548 [00:17<00:03, 307.01 examples/s]
Map:  84%|████████▍ | 5486/6548 [00:17<00:03, 321.01 examples/s]
Map:  85%|████████▍ | 5547/6548 [00:17<00:02, 340.75 examples/s]
Map:  85%|████████▌ | 5584/6548 [00:17<00:03, 307.92 examples/s]
Map:  86%|████████▌ | 5623/6548 [00:17<00:02, 325.89 examples/s]
Map:  86%|████████▋ | 5664/6548 [00:18<00:02, 305.68 examples/s]
Map:  87%|████████▋ | 5697/6548 [00:18<00:02, 301.65 examples/s]
Map:  88%|████████▊ | 5740/6548 [00:18<00:02, 327.08 examples/s]
Map:  88%|████████▊ | 5781/6548 [00:18<00:02, 335.24 examples/s]
Map:  89%|████████▉ | 5825/6548 [00:18<00:02, 338.74 examples/s]
Map:  90%|████████▉ | 5862/6548 [00:18<00:01, 345.92 examples/s]
Map:  90%|█████████ | 5901/6548 [00:18<00:01, 355.42 examples/s]
Map:  91%|█████████ | 5938/6548 [00:18<00:01, 355.75 examples/s]
Map:  91%|█████████▏| 5988/6548 [00:19<00:01, 341.77 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 212.69 examples/s]
Map:  93%|█████████▎| 6076/6548 [00:19<00:01, 239.65 examples/s]
Map:  93%|█████████▎| 6117/6548 [00:19<00:01, 239.23 examples/s]
Map:  94%|█████████▍| 6147/6548 [00:19<00:01, 250.12 examples/s]
Map:  94%|█████████▍| 6187/6548 [00:19<00:01, 281.64 examples/s]
Map:  95%|█████████▌| 6228/6548 [00:20<00:01, 311.30 examples/s]
Map:  96%|█████████▌| 6265/6548 [00:20<00:00, 324.78 examples/s]
Map:  96%|█████████▋| 6306/6548 [00:20<00:00, 345.58 examples/s]
Map:  97%|█████████▋| 6363/6548 [00:20<00:00, 349.57 examples/s]
Map:  98%|█████████▊| 6418/6548 [00:20<00:00, 347.86 examples/s]
Map:  99%|█████████▉| 6468/6548 [00:20<00:00, 382.40 examples/s]
Map: 100%|█████████▉| 6525/6548 [00:20<00:00, 378.97 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 311.56 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 327.62 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 348.50 examples/s]
Map:  13%|█▎        | 115/903 [00:00<00:02, 340.38 examples/s]
Map:  17%|█▋        | 154/903 [00:00<00:02, 356.42 examples/s]
Map:  23%|██▎       | 206/903 [00:00<00:01, 401.29 examples/s]
Map:  27%|██▋       | 248/903 [00:00<00:01, 400.67 examples/s]
Map:  33%|███▎      | 302/903 [00:00<00:01, 374.07 examples/s]
Map:  38%|███▊      | 347/903 [00:00<00:01, 344.36 examples/s]
Map:  43%|████▎     | 390/903 [00:01<00:01, 293.97 examples/s]
Map:  48%|████▊     | 433/903 [00:01<00:01, 323.67 examples/s]
Map:  53%|█████▎    | 478/903 [00:01<00:01, 308.60 examples/s]
Map:  57%|█████▋    | 514/903 [00:01<00:01, 319.42 examples/s]
Map:  62%|██████▏   | 559/903 [00:01<00:00, 347.25 examples/s]
Map:  67%|██████▋   | 608/903 [00:01<00:00, 383.21 examples/s]
Map:  72%|███████▏  | 653/903 [00:01<00:00, 350.35 examples/s]
Map:  77%|███████▋  | 696/903 [00:01<00:00, 365.65 examples/s]
Map:  82%|████████▏ | 741/903 [00:02<00:00, 386.35 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 381.34 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 383.37 examples/s]
Map:  96%|█████████▋| 871/903 [00:02<00:00, 398.20 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 327.41 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 302.43 examples/s]
Map:   4%|▍         | 82/1882 [00:00<00:04, 373.08 examples/s]
Map:   7%|▋         | 135/1882 [00:00<00:05, 345.34 examples/s]
Map:  10%|▉         | 180/1882 [00:00<00:04, 377.49 examples/s]
Map:  13%|█▎        | 240/1882 [00:00<00:04, 381.59 examples/s]
Map:  15%|█▍        | 280/1882 [00:00<00:04, 383.01 examples/s]
Map:  18%|█▊        | 334/1882 [00:00<00:04, 365.57 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:04, 330.81 examples/s]
Map:  22%|██▏       | 411/1882 [00:01<00:04, 297.01 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 302.54 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 337.77 examples/s]
Map:  29%|██▉       | 544/1882 [00:01<00:04, 326.62 examples/s]
Map:  31%|███       | 587/1882 [00:01<00:03, 349.86 examples/s]
Map:  34%|███▍      | 644/1882 [00:01<00:03, 400.41 examples/s]
Map:  37%|███▋      | 704/1882 [00:01<00:03, 383.93 examples/s]
Map:  41%|████      | 768/1882 [00:02<00:02, 391.20 examples/s]
Map:  44%|████▍     | 826/1882 [00:02<00:03, 340.01 examples/s]
Map:  47%|████▋     | 882/1882 [00:02<00:02, 345.84 examples/s]
Map:  49%|████▉     | 922/1882 [00:02<00:02, 354.33 examples/s]
Map:  52%|█████▏    | 973/1882 [00:02<00:02, 387.58 examples/s]
Map:  54%|█████▍    | 1015/1882 [00:03<00:03, 241.52 examples/s]
Map:  56%|█████▌    | 1053/1882 [00:03<00:03, 263.76 examples/s]
Map:  58%|█████▊    | 1095/1882 [00:03<00:03, 261.31 examples/s]
Map:  60%|█████▉    | 1129/1882 [00:03<00:02, 268.50 examples/s]
Map:  62%|██████▏   | 1164/1882 [00:03<00:02, 284.64 examples/s]
Map:  64%|██████▍   | 1205/1882 [00:03<00:02, 265.57 examples/s]
Map:  66%|██████▌   | 1242/1882 [00:03<00:02, 286.17 examples/s]
Map:  68%|██████▊   | 1273/1882 [00:03<00:02, 289.42 examples/s]
Map:  70%|██████▉   | 1317/1882 [00:04<00:01, 325.71 examples/s]
Map:  72%|███████▏  | 1358/1882 [00:04<00:01, 339.49 examples/s]
Map:  75%|███████▍  | 1411/1882 [00:04<00:01, 339.53 examples/s]
Map:  78%|███████▊  | 1467/1882 [00:04<00:01, 296.17 examples/s]
Map:  80%|███████▉  | 1504/1882 [00:04<00:01, 262.92 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 276.59 examples/s]
Map:  84%|████████▍ | 1581/1882 [00:04<00:01, 295.43 examples/s]
Map:  86%|████████▌ | 1620/1882 [00:05<00:00, 315.00 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 316.06 examples/s]
Map:  91%|█████████ | 1713/1882 [00:05<00:00, 325.34 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 282.19 examples/s]
Map:  96%|█████████▌| 1799/1882 [00:05<00:00, 286.76 examples/s]
Map:  98%|█████████▊| 1844/1882 [00:05<00:00, 319.51 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 228.83 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 308.58 examples/s]
10/12/2024 19:11:32 - INFO - __main__ -     ***** Testing *****
10/12/2024 19:11:32 - INFO - __main__ -     Batch size = 8
10/12/2024 19:11:32 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 19:11:32 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 19:11:32 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 19:11:33 - INFO - knnlm -   Reading datastore took 0.902348518371582 s
10/12/2024 19:11:34 - INFO - knnlm -   Moving index to GPU took 0.904534101486206 s
10/12/2024 19:11:34 - INFO - __main__ -   ******************************break-into
10/12/2024 19:11:34 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 19:11:34 - INFO - __main__ -     Num examples = 236
10/12/2024 19:11:34 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:03,  7.42s/it]
test ppl:   1%|          | 2/236 [00:09<16:01,  4.11s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:19,  2.92s/it]
test ppl:   2%|▏         | 4/236 [00:12<09:24,  2.43s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:05,  3.66s/it]
test ppl:   3%|▎         | 6/236 [00:24<16:57,  4.42s/it]
test ppl:   3%|▎         | 7/236 [00:26<13:42,  3.59s/it]
test ppl:   3%|▎         | 8/236 [00:30<14:31,  3.82s/it]
test ppl:   4%|▍         | 9/236 [00:36<16:52,  4.46s/it]
test ppl:   4%|▍         | 10/236 [00:40<16:08,  4.29s/it]
test ppl:   5%|▍         | 11/236 [00:44<15:44,  4.20s/it]
test ppl:   5%|▌         | 12/236 [00:49<17:33,  4.70s/it]
test ppl:   6%|▌         | 13/236 [00:55<18:46,  5.05s/it]
test ppl:   6%|▌         | 14/236 [01:01<19:36,  5.30s/it]
test ppl:   6%|▋         | 15/236 [01:04<16:23,  4.45s/it]
test ppl:   7%|▋         | 16/236 [01:10<17:54,  4.89s/it]
test ppl:   7%|▋         | 17/236 [01:15<18:53,  5.18s/it]
test ppl:   8%|▊         | 18/236 [01:21<19:31,  5.37s/it]
test ppl:   8%|▊         | 19/236 [01:27<19:56,  5.51s/it]
test ppl:   8%|▊         | 20/236 [01:30<16:39,  4.63s/it]
test ppl:   9%|▉         | 21/236 [01:32<14:13,  3.97s/it]
test ppl:   9%|▉         | 22/236 [01:38<16:10,  4.53s/it]
test ppl:  10%|▉         | 23/236 [01:41<14:35,  4.11s/it]
test ppl:  10%|█         | 24/236 [01:43<12:29,  3.54s/it]
test ppl:  11%|█         | 25/236 [01:49<14:52,  4.23s/it]
test ppl:  11%|█         | 26/236 [01:55<16:30,  4.72s/it]
test ppl:  11%|█▏        | 27/236 [01:58<15:07,  4.34s/it]
test ppl:  12%|█▏        | 28/236 [02:00<11:47,  3.40s/it]
test ppl:  12%|█▏        | 29/236 [02:02<10:35,  3.07s/it]
test ppl:  13%|█▎        | 30/236 [02:03<08:58,  2.61s/it]
test ppl:  13%|█▎        | 31/236 [02:05<08:17,  2.43s/it]
test ppl:  14%|█▎        | 32/236 [02:08<08:28,  2.49s/it]
test ppl:  14%|█▍        | 33/236 [02:11<08:22,  2.48s/it]
test ppl:  14%|█▍        | 34/236 [02:13<08:19,  2.47s/it]
test ppl:  15%|█▍        | 35/236 [02:16<08:19,  2.49s/it]
test ppl:  15%|█▌        | 36/236 [02:21<11:38,  3.49s/it]
test ppl:  16%|█▌        | 37/236 [02:27<13:55,  4.20s/it]
test ppl:  16%|█▌        | 38/236 [02:29<11:44,  3.56s/it]
test ppl:  17%|█▋        | 39/236 [02:31<09:55,  3.03s/it]
test ppl:  17%|█▋        | 40/236 [02:33<08:29,  2.60s/it]
test ppl:  17%|█▋        | 41/236 [02:35<07:43,  2.37s/it]
test ppl:  18%|█▊        | 42/236 [02:40<11:05,  3.43s/it]
test ppl:  18%|█▊        | 43/236 [02:46<13:20,  4.15s/it]
test ppl:  19%|█▊        | 44/236 [02:49<11:31,  3.60s/it]
test ppl:  19%|█▉        | 45/236 [02:50<09:45,  3.07s/it]
test ppl:  19%|█▉        | 46/236 [02:56<12:23,  3.91s/it]
test ppl:  20%|█▉        | 47/236 [02:58<10:03,  3.19s/it]
test ppl:  20%|██        | 48/236 [03:04<12:29,  3.98s/it]
test ppl:  21%|██        | 49/236 [03:07<12:13,  3.92s/it]
test ppl:  21%|██        | 50/236 [03:13<14:00,  4.52s/it]
test ppl:  22%|██▏       | 51/236 [03:19<15:11,  4.92s/it]
test ppl:  22%|██▏       | 52/236 [03:25<15:57,  5.20s/it]
test ppl:  22%|██▏       | 53/236 [03:28<13:52,  4.55s/it]
test ppl:  23%|██▎       | 54/236 [03:30<11:03,  3.64s/it]
test ppl:  23%|██▎       | 55/236 [03:35<12:52,  4.27s/it]
test ppl:  24%|██▎       | 56/236 [03:39<12:00,  4.00s/it]
test ppl:  24%|██▍       | 57/236 [03:41<10:25,  3.49s/it]
test ppl:  25%|██▍       | 58/236 [03:43<09:17,  3.13s/it]
test ppl:  25%|██▌       | 59/236 [03:49<11:38,  3.95s/it]
test ppl:  25%|██▌       | 60/236 [03:52<10:51,  3.70s/it]
test ppl:  26%|██▌       | 61/236 [03:58<12:39,  4.34s/it]
test ppl:  26%|██▋       | 62/236 [04:02<12:19,  4.25s/it]
test ppl:  27%|██▋       | 63/236 [04:05<10:42,  3.71s/it]
test ppl:  27%|██▋       | 64/236 [04:06<08:46,  3.06s/it]
test ppl:  28%|██▊       | 65/236 [04:07<07:13,  2.53s/it]
test ppl:  28%|██▊       | 66/236 [04:10<07:35,  2.68s/it]
test ppl:  28%|██▊       | 67/236 [04:16<10:14,  3.64s/it]
test ppl:  29%|██▉       | 68/236 [04:22<11:35,  4.14s/it]
test ppl:  29%|██▉       | 69/236 [04:26<11:49,  4.25s/it]
test ppl:  30%|██▉       | 70/236 [04:27<09:17,  3.36s/it]
test ppl:  30%|███       | 71/236 [04:32<09:57,  3.62s/it]
test ppl:  31%|███       | 72/236 [04:37<11:17,  4.13s/it]
test ppl:  31%|███       | 73/236 [04:43<12:37,  4.65s/it]
test ppl:  31%|███▏      | 74/236 [04:44<10:00,  3.71s/it]
test ppl:  32%|███▏      | 75/236 [04:50<11:41,  4.35s/it]
test ppl:  32%|███▏      | 76/236 [04:56<12:48,  4.80s/it]
test ppl:  33%|███▎      | 77/236 [04:58<10:43,  4.05s/it]
test ppl:  33%|███▎      | 78/236 [05:00<08:50,  3.36s/it]
test ppl:  33%|███▎      | 79/236 [05:04<09:12,  3.52s/it]
test ppl:  34%|███▍      | 80/236 [05:06<07:52,  3.03s/it]
test ppl:  34%|███▍      | 81/236 [05:12<09:59,  3.87s/it]
test ppl:  35%|███▍      | 82/236 [05:18<11:28,  4.47s/it]
test ppl:  35%|███▌      | 83/236 [05:20<09:58,  3.91s/it]
test ppl:  36%|███▌      | 84/236 [05:23<08:45,  3.46s/it]
test ppl:  36%|███▌      | 85/236 [05:27<09:14,  3.68s/it]
test ppl:  36%|███▋      | 86/236 [05:29<07:50,  3.14s/it]
test ppl:  37%|███▋      | 87/236 [05:31<07:25,  2.99s/it]
test ppl:  37%|███▋      | 88/236 [05:37<09:28,  3.84s/it]
test ppl:  38%|███▊      | 89/236 [05:43<10:52,  4.44s/it]
test ppl:  38%|███▊      | 90/236 [05:49<11:50,  4.87s/it]
test ppl:  39%|███▊      | 91/236 [05:54<11:50,  4.90s/it]
test ppl:  39%|███▉      | 92/236 [05:57<10:14,  4.27s/it]
test ppl:  39%|███▉      | 93/236 [06:02<11:17,  4.74s/it]
test ppl:  40%|███▉      | 94/236 [06:08<11:59,  5.07s/it]
test ppl:  40%|████      | 95/236 [06:11<10:10,  4.33s/it]
test ppl:  41%|████      | 96/236 [06:15<09:41,  4.16s/it]
test ppl:  41%|████      | 97/236 [06:20<10:48,  4.66s/it]
test ppl:  42%|████▏     | 98/236 [06:26<11:32,  5.02s/it]
test ppl:  42%|████▏     | 99/236 [06:32<12:02,  5.27s/it]
test ppl:  42%|████▏     | 100/236 [06:33<09:15,  4.09s/it]
test ppl:  43%|████▎     | 101/236 [06:39<10:22,  4.61s/it]
test ppl:  43%|████▎     | 102/236 [06:43<09:50,  4.41s/it]
test ppl:  44%|████▎     | 103/236 [06:45<07:46,  3.51s/it]
test ppl:  44%|████▍     | 104/236 [06:49<08:11,  3.72s/it]
test ppl:  44%|████▍     | 105/236 [06:53<08:16,  3.79s/it]
test ppl:  45%|████▍     | 106/236 [06:58<09:14,  4.27s/it]
test ppl:  45%|████▌     | 107/236 [07:00<07:49,  3.64s/it]
test ppl:  46%|████▌     | 108/236 [07:05<08:28,  3.97s/it]
test ppl:  46%|████▌     | 109/236 [07:10<08:49,  4.17s/it]
test ppl:  47%|████▋     | 110/236 [07:11<07:08,  3.40s/it]
test ppl:  47%|████▋     | 111/236 [07:17<08:36,  4.13s/it]
test ppl:  47%|████▋     | 112/236 [07:23<09:36,  4.65s/it]
test ppl:  48%|████▊     | 113/236 [07:25<07:45,  3.78s/it]
test ppl:  48%|████▊     | 114/236 [07:29<07:37,  3.75s/it]
test ppl:  49%|████▊     | 115/236 [07:34<08:49,  4.38s/it]
test ppl:  49%|████▉     | 116/236 [07:40<09:38,  4.82s/it]
test ppl:  50%|████▉     | 117/236 [07:42<07:47,  3.93s/it]
test ppl:  50%|█████     | 118/236 [07:47<08:26,  4.29s/it]
test ppl:  50%|█████     | 119/236 [07:49<07:03,  3.62s/it]
test ppl:  51%|█████     | 120/236 [07:51<05:46,  2.99s/it]
test ppl:  51%|█████▏    | 121/236 [07:53<05:33,  2.90s/it]
test ppl:  52%|█████▏    | 122/236 [07:59<07:11,  3.78s/it]
test ppl:  52%|█████▏    | 123/236 [08:01<06:11,  3.29s/it]
test ppl:  53%|█████▎    | 124/236 [08:05<06:04,  3.26s/it]
test ppl:  53%|█████▎    | 125/236 [08:10<07:27,  4.03s/it]
test ppl:  53%|█████▎    | 126/236 [08:15<07:46,  4.24s/it]
test ppl:  54%|█████▍    | 127/236 [08:17<06:31,  3.60s/it]
test ppl:  54%|█████▍    | 128/236 [08:19<05:32,  3.08s/it]
test ppl:  55%|█████▍    | 129/236 [08:22<05:21,  3.00s/it]
test ppl:  55%|█████▌    | 130/236 [08:25<05:20,  3.02s/it]
test ppl:  56%|█████▌    | 131/236 [08:31<06:46,  3.87s/it]
test ppl:  56%|█████▌    | 132/236 [08:33<05:58,  3.45s/it]
test ppl:  56%|█████▋    | 133/236 [08:37<06:10,  3.60s/it]
test ppl:  57%|█████▋    | 134/236 [08:41<06:00,  3.54s/it]
test ppl:  57%|█████▋    | 135/236 [08:44<05:59,  3.56s/it]
test ppl:  58%|█████▊    | 136/236 [08:46<04:46,  2.86s/it]
test ppl:  58%|█████▊    | 137/236 [08:51<06:12,  3.76s/it]
test ppl:  58%|█████▊    | 138/236 [08:55<05:55,  3.63s/it]
test ppl:  59%|█████▉    | 139/236 [08:57<04:58,  3.07s/it]
test ppl:  59%|█████▉    | 140/236 [08:58<04:15,  2.66s/it]
test ppl:  60%|█████▉    | 141/236 [09:02<04:46,  3.01s/it]
test ppl:  60%|██████    | 142/236 [09:04<04:18,  2.74s/it]
test ppl:  61%|██████    | 143/236 [09:10<05:41,  3.68s/it]
test ppl:  61%|██████    | 144/236 [09:13<05:10,  3.38s/it]
test ppl:  61%|██████▏   | 145/236 [09:19<06:14,  4.12s/it]
test ppl:  62%|██████▏   | 146/236 [09:24<06:36,  4.41s/it]
test ppl:  62%|██████▏   | 147/236 [09:29<07:11,  4.84s/it]
test ppl:  63%|██████▎   | 148/236 [09:35<07:35,  5.18s/it]
test ppl:  63%|██████▎   | 149/236 [09:41<07:47,  5.38s/it]
test ppl:  64%|██████▎   | 150/236 [09:47<07:54,  5.52s/it]
test ppl:  64%|██████▍   | 151/236 [09:53<07:57,  5.62s/it]
test ppl:  64%|██████▍   | 152/236 [09:59<07:56,  5.68s/it]
test ppl:  65%|██████▍   | 153/236 [10:05<07:55,  5.72s/it]
test ppl:  65%|██████▌   | 154/236 [10:07<06:32,  4.79s/it]
test ppl:  66%|██████▌   | 155/236 [10:10<05:33,  4.12s/it]
test ppl:  66%|██████▌   | 156/236 [10:12<04:47,  3.60s/it]
test ppl:  67%|██████▋   | 157/236 [10:14<03:51,  2.93s/it]
test ppl:  67%|██████▋   | 158/236 [10:19<04:57,  3.81s/it]
test ppl:  67%|██████▋   | 159/236 [10:21<04:00,  3.12s/it]
test ppl:  68%|██████▊   | 160/236 [10:22<03:12,  2.53s/it]
test ppl:  68%|██████▊   | 161/236 [10:23<02:39,  2.12s/it]
test ppl:  69%|██████▊   | 162/236 [10:26<02:58,  2.42s/it]
test ppl:  69%|██████▉   | 163/236 [10:29<02:58,  2.45s/it]
test ppl:  69%|██████▉   | 164/236 [10:32<03:10,  2.65s/it]
test ppl:  70%|██████▉   | 165/236 [10:35<03:21,  2.84s/it]
test ppl:  70%|███████   | 166/236 [10:37<02:55,  2.50s/it]
test ppl:  71%|███████   | 167/236 [10:38<02:31,  2.19s/it]
test ppl:  71%|███████   | 168/236 [10:40<02:26,  2.15s/it]
test ppl:  72%|███████▏  | 169/236 [10:46<03:22,  3.02s/it]
test ppl:  72%|███████▏  | 170/236 [10:51<04:15,  3.88s/it]
test ppl:  72%|███████▏  | 171/236 [10:53<03:22,  3.12s/it]
test ppl:  73%|███████▎  | 172/236 [10:59<04:12,  3.94s/it]
test ppl:  73%|███████▎  | 173/236 [11:02<03:56,  3.76s/it]
test ppl:  74%|███████▎  | 174/236 [11:08<04:33,  4.40s/it]
test ppl:  74%|███████▍  | 175/236 [11:14<04:54,  4.84s/it]
test ppl:  75%|███████▍  | 176/236 [11:20<05:08,  5.14s/it]
test ppl:  75%|███████▌  | 177/236 [11:25<05:16,  5.36s/it]
test ppl:  75%|███████▌  | 178/236 [11:31<05:20,  5.53s/it]
test ppl:  76%|███████▌  | 179/236 [11:37<05:20,  5.63s/it]
test ppl:  76%|███████▋  | 180/236 [11:43<05:18,  5.69s/it]
test ppl:  77%|███████▋  | 181/236 [11:49<05:15,  5.74s/it]
test ppl:  77%|███████▋  | 182/236 [11:51<04:07,  4.58s/it]
test ppl:  78%|███████▊  | 183/236 [11:52<03:15,  3.69s/it]
test ppl:  78%|███████▊  | 184/236 [11:54<02:36,  3.00s/it]
test ppl:  78%|███████▊  | 185/236 [11:58<02:57,  3.49s/it]
test ppl:  79%|███████▉  | 186/236 [12:00<02:31,  3.04s/it]
test ppl:  79%|███████▉  | 187/236 [12:02<02:08,  2.62s/it]
test ppl:  80%|███████▉  | 188/236 [12:08<02:52,  3.59s/it]
test ppl:  80%|████████  | 189/236 [12:14<03:20,  4.27s/it]
test ppl:  81%|████████  | 190/236 [12:18<03:15,  4.26s/it]
test ppl:  81%|████████  | 191/236 [12:22<03:05,  4.11s/it]
test ppl:  81%|████████▏ | 192/236 [12:24<02:41,  3.66s/it]
test ppl:  82%|████████▏ | 193/236 [12:30<03:06,  4.33s/it]
test ppl:  82%|████████▏ | 194/236 [12:33<02:40,  3.82s/it]
test ppl:  83%|████████▎ | 195/236 [12:35<02:10,  3.19s/it]
test ppl:  83%|████████▎ | 196/236 [12:37<01:53,  2.84s/it]
test ppl:  83%|████████▎ | 197/236 [12:39<01:42,  2.63s/it]
test ppl:  84%|████████▍ | 198/236 [12:45<02:16,  3.59s/it]
test ppl:  84%|████████▍ | 199/236 [12:47<02:04,  3.36s/it]
test ppl:  85%|████████▍ | 200/236 [12:53<02:27,  4.11s/it]
test ppl:  85%|████████▌ | 201/236 [12:56<02:07,  3.65s/it]
test ppl:  86%|████████▌ | 202/236 [13:02<02:26,  4.30s/it]
test ppl:  86%|████████▌ | 203/236 [13:08<02:37,  4.77s/it]
test ppl:  86%|████████▋ | 204/236 [13:10<02:06,  3.96s/it]
test ppl:  87%|████████▋ | 205/236 [13:15<02:12,  4.29s/it]
test ppl:  87%|████████▋ | 206/236 [13:18<01:59,  3.99s/it]
test ppl:  88%|████████▊ | 207/236 [13:24<02:11,  4.55s/it]
test ppl:  88%|████████▊ | 208/236 [13:27<01:51,  4.00s/it]
test ppl:  89%|████████▊ | 209/236 [13:32<02:03,  4.58s/it]
test ppl:  89%|████████▉ | 210/236 [13:35<01:41,  3.90s/it]
test ppl:  89%|████████▉ | 211/236 [13:39<01:39,  3.97s/it]
test ppl:  90%|████████▉ | 212/236 [13:44<01:40,  4.20s/it]
test ppl:  90%|█████████ | 213/236 [13:49<01:47,  4.69s/it]
test ppl:  91%|█████████ | 214/236 [13:51<01:22,  3.77s/it]
test ppl:  91%|█████████ | 215/236 [13:57<01:32,  4.39s/it]
test ppl:  92%|█████████▏| 216/236 [13:59<01:11,  3.57s/it]
test ppl:  92%|█████████▏| 217/236 [14:05<01:21,  4.28s/it]
test ppl:  92%|█████████▏| 218/236 [14:07<01:08,  3.82s/it]
test ppl:  93%|█████████▎| 219/236 [14:13<01:15,  4.44s/it]
test ppl:  93%|█████████▎| 220/236 [14:19<01:17,  4.86s/it]
test ppl:  94%|█████████▎| 221/236 [14:21<00:59,  3.94s/it]
test ppl:  94%|█████████▍| 222/236 [14:27<01:03,  4.52s/it]
test ppl:  94%|█████████▍| 223/236 [14:33<01:03,  4.92s/it]
test ppl:  95%|█████████▍| 224/236 [14:34<00:45,  3.79s/it]
test ppl:  95%|█████████▌| 225/236 [14:38<00:43,  3.92s/it]
test ppl:  96%|█████████▌| 226/236 [14:41<00:35,  3.53s/it]
test ppl:  96%|█████████▌| 227/236 [14:43<00:29,  3.31s/it]
test ppl:  97%|█████████▋| 228/236 [14:45<00:22,  2.82s/it]
test ppl:  97%|█████████▋| 229/236 [14:51<00:26,  3.73s/it]
test ppl:  97%|█████████▋| 230/236 [14:55<00:23,  3.88s/it]
test ppl:  98%|█████████▊| 231/236 [14:59<00:18,  3.75s/it]
test ppl:  98%|█████████▊| 232/236 [15:00<00:12,  3.18s/it]
test ppl:  99%|█████████▊| 233/236 [15:03<00:09,  3.08s/it]
test ppl:  99%|█████████▉| 234/236 [15:04<00:05,  2.52s/it]
test ppl: 100%|█████████▉| 235/236 [15:10<00:03,  3.44s/it]
test ppl: 100%|██████████| 236/236 [15:11<00:00,  2.60s/it]
test ppl: 100%|██████████| 236/236 [15:11<00:00,  3.86s/it]
10/12/2024 19:26:45 - INFO - __main__ -    em: 0.1977
10/12/2024 19:26:45 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.6 100:  em: 0.1977

--------------------------------------------------------------------------------
Running experiment with knn_temp=100, lmbda=0.6, k=32
2024-10-12 19:26:52.802569: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 19:26:52.822204: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 19:26:52.844310: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 19:26:52.851033: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 19:26:52.867099: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 19:26:53.860491: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 19:26:55 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.6, knn_temp=100, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 19:26:55 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:48:13,  2.18it/s]
Adding feature api:   3%|▎         | 6135/187062 [00:00<00:12, 14582.63it/s]
Adding feature api:   7%|▋         | 13194/187062 [00:00<00:06, 28780.03it/s]
Adding feature api:  11%|█         | 20292/187062 [00:00<00:04, 39998.92it/s]
Adding feature api:  15%|█▍        | 27441/187062 [00:00<00:03, 48665.98it/s]
Adding feature api:  18%|█▊        | 34594/187062 [00:00<00:02, 55118.57it/s]
Adding feature api:  22%|██▏       | 41753/187062 [00:01<00:02, 59849.52it/s]
Adding feature api:  26%|██▌       | 48872/187062 [00:01<00:02, 63147.26it/s]
Adding feature api:  30%|██▉       | 56033/187062 [00:01<00:01, 65630.03it/s]
Adding feature api:  34%|███▍      | 63203/187062 [00:01<00:01, 67421.31it/s]
Adding feature api:  38%|███▊      | 70336/187062 [00:01<00:01, 68579.98it/s]
Adding feature api:  41%|████▏     | 77456/187062 [00:01<00:01, 69358.95it/s]
Adding feature api:  45%|████▌     | 84542/187062 [00:01<00:01, 69317.96it/s]
Adding feature api:  49%|████▉     | 91679/187062 [00:01<00:01, 69927.73it/s]
Adding feature api:  53%|█████▎    | 98830/187062 [00:01<00:01, 70398.33it/s]
Adding feature api:  57%|█████▋    | 105993/187062 [00:01<00:01, 70765.53it/s]
Adding feature api:  60%|██████    | 113152/187062 [00:02<00:01, 71011.19it/s]
Adding feature api:  64%|██████▍   | 120312/187062 [00:02<00:00, 71185.20it/s]
Adding feature api:  68%|██████▊   | 127488/187062 [00:02<00:00, 71355.82it/s]
Adding feature api:  72%|███████▏  | 134670/187062 [00:02<00:00, 71493.93it/s]
Adding feature api:  76%|███████▌  | 141885/187062 [00:02<00:00, 71689.19it/s]
Adding feature api:  80%|███████▉  | 149073/187062 [00:02<00:00, 71743.14it/s]
Adding feature api:  84%|████████▎ | 156252/187062 [00:02<00:00, 71691.45it/s]
Adding feature api:  87%|████████▋ | 163425/187062 [00:02<00:00, 71620.06it/s]
Adding feature api:  91%|█████████ | 170606/187062 [00:02<00:00, 71674.68it/s]
Adding feature api:  95%|█████████▌| 177775/187062 [00:02<00:00, 70638.61it/s]
Adding feature api:  99%|█████████▉| 184844/187062 [00:03<00:00, 46694.70it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 56461.93it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:24:45,  2.22it/s]
Adding feature datatype:   3%|▎         | 6031/187062 [00:00<00:12, 14517.17it/s]
Adding feature datatype:   7%|▋         | 12941/187062 [00:00<00:06, 28483.34it/s]
Adding feature datatype:  11%|█         | 19886/187062 [00:00<00:04, 39448.77it/s]
Adding feature datatype:  14%|█▍        | 26855/187062 [00:00<00:03, 47812.74it/s]
Adding feature datatype:  18%|█▊        | 33807/187062 [00:00<00:02, 53959.45it/s]
Adding feature datatype:  22%|██▏       | 40773/187062 [00:01<00:02, 58479.97it/s]
Adding feature datatype:  26%|██▌       | 47773/187062 [00:01<00:02, 61836.62it/s]
Adding feature datatype:  29%|██▉       | 54775/187062 [00:01<00:02, 64240.03it/s]
Adding feature datatype:  33%|███▎      | 61755/187062 [00:01<00:01, 65875.19it/s]
Adding feature datatype:  37%|███▋      | 68781/187062 [00:01<00:01, 67174.51it/s]
Adding feature datatype:  41%|████      | 75806/187062 [00:01<00:01, 68089.32it/s]
Adding feature datatype:  44%|████▍     | 82795/187062 [00:01<00:01, 68625.84it/s]
Adding feature datatype:  48%|████▊     | 89822/187062 [00:01<00:01, 69116.11it/s]
Adding feature datatype:  52%|█████▏    | 96828/187062 [00:01<00:01, 69396.42it/s]
Adding feature datatype:  56%|█████▌    | 103839/187062 [00:01<00:01, 69608.75it/s]
Adding feature datatype:  59%|█████▉    | 110844/187062 [00:02<00:01, 69739.04it/s]
Adding feature datatype:  63%|██████▎   | 117843/187062 [00:02<00:00, 69346.52it/s]
Adding feature datatype:  67%|██████▋   | 124870/187062 [00:02<00:00, 69621.32it/s]
Adding feature datatype:  71%|███████   | 131890/187062 [00:02<00:00, 69791.61it/s]
Adding feature datatype:  74%|███████▍  | 138878/187062 [00:02<00:00, 69768.15it/s]
Adding feature datatype:  78%|███████▊  | 145891/187062 [00:02<00:00, 69873.13it/s]
Adding feature datatype:  82%|████████▏ | 152884/187062 [00:02<00:00, 69887.99it/s]
Adding feature datatype:  85%|████████▌ | 159879/187062 [00:02<00:00, 69904.74it/s]
Adding feature datatype:  89%|████████▉ | 166884/187062 [00:02<00:00, 69945.65it/s]
Adding feature datatype:  93%|█████████▎| 173881/187062 [00:02<00:00, 69950.07it/s]
Adding feature datatype:  97%|█████████▋| 180878/187062 [00:03<00:00, 56984.08it/s]
Adding feature datatype: 100%|█████████▉| 186969/187062 [00:03<00:00, 44047.61it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 55746.12it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:28:27,  2.21it/s]
Adding feature literal:   3%|▎         | 5955/187062 [00:00<00:12, 14305.76it/s]
Adding feature literal:   7%|▋         | 12801/187062 [00:00<00:06, 28142.05it/s]
Adding feature literal:  11%|█         | 19682/187062 [00:00<00:04, 39015.63it/s]
Adding feature literal:  14%|█▍        | 26595/187062 [00:00<00:03, 47337.70it/s]
Adding feature literal:  18%|█▊        | 33542/187062 [00:00<00:02, 53600.79it/s]
Adding feature literal:  22%|██▏       | 40465/187062 [00:01<00:02, 58100.17it/s]
Adding feature literal:  25%|██▌       | 47426/187062 [00:01<00:02, 61452.68it/s]
Adding feature literal:  29%|██▉       | 54379/187062 [00:01<00:02, 63825.36it/s]
Adding feature literal:  33%|███▎      | 61345/187062 [00:01<00:01, 65549.71it/s]
Adding feature literal:  36%|███▋      | 68272/187062 [00:01<00:01, 66654.09it/s]
Adding feature literal:  40%|████      | 75196/187062 [00:01<00:01, 67423.72it/s]
Adding feature literal:  44%|████▍     | 82168/187062 [00:01<00:01, 68106.22it/s]
Adding feature literal:  48%|████▊     | 89080/187062 [00:01<00:01, 67924.16it/s]
Adding feature literal:  51%|█████▏    | 96022/187062 [00:01<00:01, 68367.61it/s]
Adding feature literal:  55%|█████▌    | 102947/187062 [00:01<00:01, 68630.04it/s]
Adding feature literal:  59%|█████▊    | 109845/187062 [00:02<00:01, 68692.71it/s]
Adding feature literal:  62%|██████▏   | 116791/187062 [00:02<00:01, 68918.93it/s]
Adding feature literal:  66%|██████▌   | 123722/187062 [00:02<00:00, 69035.53it/s]
Adding feature literal:  70%|██████▉   | 130701/187062 [00:02<00:00, 69259.57it/s]
Adding feature literal:  74%|███████▎  | 137668/187062 [00:02<00:00, 69382.14it/s]
Adding feature literal:  77%|███████▋  | 144613/187062 [00:02<00:00, 69395.81it/s]
Adding feature literal:  81%|████████  | 151562/187062 [00:02<00:00, 69422.08it/s]
Adding feature literal:  85%|████████▍ | 158509/187062 [00:02<00:00, 69435.33it/s]
Adding feature literal:  88%|████████▊ | 165466/187062 [00:02<00:00, 69474.15it/s]
Adding feature literal:  92%|█████████▏| 172421/187062 [00:02<00:00, 69495.33it/s]
Adding feature literal:  96%|█████████▌| 179372/187062 [00:03<00:00, 61447.55it/s]
Adding feature literal:  99%|█████████▉| 185689/187062 [00:03<00:00, 45164.17it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 55326.96it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:24:13,  2.22it/s]
Adding feature operator:   3%|▎         | 6003/187062 [00:00<00:12, 14453.99it/s]
Adding feature operator:   7%|▋         | 12945/187062 [00:00<00:06, 28522.11it/s]
Adding feature operator:  11%|█         | 19923/187062 [00:00<00:04, 39562.17it/s]
Adding feature operator:  14%|█▍        | 26935/187062 [00:00<00:03, 48014.66it/s]
Adding feature operator:  18%|█▊        | 33724/187062 [00:00<00:02, 53642.55it/s]
Adding feature operator:  22%|██▏       | 40768/187062 [00:01<00:02, 58479.60it/s]
Adding feature operator:  26%|██▌       | 47780/187062 [00:01<00:02, 61871.62it/s]
Adding feature operator:  29%|██▉       | 54835/187062 [00:01<00:02, 64422.51it/s]
Adding feature operator:  33%|███▎      | 61874/187062 [00:01<00:01, 66185.26it/s]
Adding feature operator:  37%|███▋      | 68887/187062 [00:01<00:01, 67355.85it/s]
Adding feature operator:  41%|████      | 75887/187062 [00:01<00:01, 68140.45it/s]
Adding feature operator:  44%|████▍     | 82906/187062 [00:01<00:01, 68750.26it/s]
Adding feature operator:  48%|████▊     | 89918/187062 [00:01<00:01, 69157.70it/s]
Adding feature operator:  52%|█████▏    | 96905/187062 [00:01<00:01, 69057.27it/s]
Adding feature operator:  56%|█████▌    | 103950/187062 [00:01<00:01, 69471.59it/s]
Adding feature operator:  59%|█████▉    | 110970/187062 [00:02<00:01, 69686.80it/s]
Adding feature operator:  63%|██████▎   | 117983/187062 [00:02<00:00, 69818.41it/s]
Adding feature operator:  67%|██████▋   | 124983/187062 [00:02<00:00, 69313.50it/s]
Adding feature operator:  71%|███████   | 131976/187062 [00:02<00:00, 69494.30it/s]
Adding feature operator:  74%|███████▍  | 139002/187062 [00:02<00:00, 69722.48it/s]
Adding feature operator:  78%|███████▊  | 146045/187062 [00:02<00:00, 69932.54it/s]
Adding feature operator:  82%|████████▏ | 153087/187062 [00:02<00:00, 70077.95it/s]
Adding feature operator:  86%|████████▌ | 160099/187062 [00:02<00:00, 70066.15it/s]
Adding feature operator:  89%|████████▉ | 167127/187062 [00:02<00:00, 70129.23it/s]
Adding feature operator:  93%|█████████▎| 174190/187062 [00:02<00:00, 70276.52it/s]
Adding feature operator:  97%|█████████▋| 181219/187062 [00:03<00:00, 56084.39it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 55814.04it/s]
[2024-10-12 19:27:40,676] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 19:27:42 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 19:27:42 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:16, 385.47 examples/s]
Map:   1%|          | 79/6548 [00:00<00:35, 184.40 examples/s]
Map:   2%|▏         | 124/6548 [00:00<00:24, 257.41 examples/s]
Map:   3%|▎         | 167/6548 [00:00<00:20, 303.88 examples/s]
Map:   3%|▎         | 219/6548 [00:00<00:19, 317.97 examples/s]
Map:   4%|▍         | 281/6548 [00:00<00:18, 334.56 examples/s]
Map:   5%|▌         | 330/6548 [00:01<00:21, 290.69 examples/s]
Map:   6%|▌         | 362/6548 [00:01<00:21, 293.43 examples/s]
Map:   6%|▋         | 414/6548 [00:01<00:17, 343.51 examples/s]
Map:   7%|▋         | 454/6548 [00:01<00:17, 339.29 examples/s]
Map:   8%|▊         | 502/6548 [00:01<00:19, 317.13 examples/s]
Map:   9%|▊         | 557/6548 [00:01<00:16, 369.20 examples/s]
Map:   9%|▉         | 599/6548 [00:01<00:15, 379.44 examples/s]
Map:  10%|█         | 662/6548 [00:02<00:17, 342.87 examples/s]
Map:  11%|█         | 708/6548 [00:02<00:15, 365.60 examples/s]
Map:  11%|█▏        | 752/6548 [00:02<00:15, 381.41 examples/s]
Map:  12%|█▏        | 806/6548 [00:02<00:13, 418.95 examples/s]
Map:  13%|█▎        | 863/6548 [00:02<00:14, 395.44 examples/s]
Map:  14%|█▍        | 907/6548 [00:02<00:14, 393.50 examples/s]
Map:  15%|█▍        | 969/6548 [00:02<00:14, 396.06 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:23, 236.86 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 261.04 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:18, 294.15 examples/s]
Map:  18%|█▊        | 1146/6548 [00:03<00:16, 330.51 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 347.71 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:14, 356.84 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:14, 366.58 examples/s]
Map:  20%|██        | 1342/6548 [00:04<00:17, 296.95 examples/s]
Map:  21%|██        | 1381/6548 [00:04<00:18, 280.11 examples/s]
Map:  22%|██▏       | 1417/6548 [00:04<00:17, 295.96 examples/s]
Map:  22%|██▏       | 1457/6548 [00:04<00:17, 283.01 examples/s]
Map:  23%|██▎       | 1496/6548 [00:04<00:18, 274.40 examples/s]
Map:  23%|██▎       | 1531/6548 [00:04<00:17, 289.91 examples/s]
Map:  24%|██▍       | 1578/6548 [00:04<00:16, 293.64 examples/s]
Map:  25%|██▍       | 1609/6548 [00:05<00:17, 285.07 examples/s]
Map:  25%|██▌       | 1647/6548 [00:05<00:18, 267.54 examples/s]
Map:  26%|██▌       | 1677/6548 [00:05<00:17, 273.77 examples/s]
Map:  26%|██▌       | 1715/6548 [00:05<00:16, 298.74 examples/s]
Map:  27%|██▋       | 1761/6548 [00:05<00:14, 338.25 examples/s]
Map:  28%|██▊       | 1803/6548 [00:05<00:13, 357.89 examples/s]
Map:  28%|██▊       | 1843/6548 [00:05<00:12, 366.99 examples/s]
Map:  29%|██▉       | 1887/6548 [00:05<00:13, 335.55 examples/s]
Map:  29%|██▉       | 1925/6548 [00:06<00:13, 346.16 examples/s]
Map:  30%|███       | 1967/6548 [00:06<00:12, 361.99 examples/s]
Map:  31%|███       | 2017/6548 [00:06<00:18, 238.68 examples/s]
Map:  31%|███▏      | 2049/6548 [00:06<00:18, 249.47 examples/s]
Map:  32%|███▏      | 2092/6548 [00:06<00:15, 282.02 examples/s]
Map:  32%|███▏      | 2126/6548 [00:06<00:15, 290.41 examples/s]
Map:  33%|███▎      | 2159/6548 [00:06<00:17, 253.69 examples/s]
Map:  34%|███▍      | 2211/6548 [00:07<00:13, 312.64 examples/s]
Map:  35%|███▍      | 2265/6548 [00:07<00:15, 285.39 examples/s]
Map:  35%|███▌      | 2311/6548 [00:07<00:15, 281.36 examples/s]
Map:  36%|███▌      | 2355/6548 [00:07<00:14, 292.38 examples/s]
Map:  37%|███▋      | 2397/6548 [00:07<00:12, 319.36 examples/s]
Map:  37%|███▋      | 2438/6548 [00:07<00:13, 315.63 examples/s]
Map:  38%|███▊      | 2477/6548 [00:07<00:12, 324.44 examples/s]
Map:  38%|███▊      | 2517/6548 [00:08<00:11, 338.76 examples/s]
Map:  39%|███▉      | 2562/6548 [00:08<00:11, 362.13 examples/s]
Map:  40%|███▉      | 2608/6548 [00:08<00:10, 383.54 examples/s]
Map:  41%|████      | 2654/6548 [00:08<00:09, 400.86 examples/s]
Map:  41%|████▏     | 2704/6548 [00:08<00:10, 368.20 examples/s]
Map:  42%|████▏     | 2763/6548 [00:08<00:10, 370.83 examples/s]
Map:  43%|████▎     | 2811/6548 [00:08<00:10, 347.08 examples/s]
Map:  44%|████▎     | 2862/6548 [00:09<00:12, 295.74 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 300.85 examples/s]
Map:  45%|████▌     | 2951/6548 [00:09<00:11, 310.61 examples/s]
Map:  46%|████▌     | 2988/6548 [00:09<00:11, 312.34 examples/s]
Map:  46%|████▌     | 3026/6548 [00:09<00:19, 180.15 examples/s]
Map:  47%|████▋     | 3058/6548 [00:10<00:17, 199.03 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 209.02 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 249.86 examples/s]
Map:  48%|████▊     | 3168/6548 [00:10<00:13, 248.41 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 246.21 examples/s]
Map:  49%|████▉     | 3238/6548 [00:10<00:12, 266.60 examples/s]
Map:  50%|████▉     | 3272/6548 [00:10<00:11, 280.37 examples/s]
Map:  50%|█████     | 3306/6548 [00:10<00:11, 293.62 examples/s]
Map:  51%|█████     | 3348/6548 [00:10<00:10, 314.25 examples/s]
Map:  52%|█████▏    | 3389/6548 [00:11<00:11, 285.20 examples/s]
Map:  52%|█████▏    | 3421/6548 [00:11<00:10, 287.33 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 277.57 examples/s]
Map:  53%|█████▎    | 3493/6548 [00:11<00:11, 267.88 examples/s]
Map:  54%|█████▍    | 3544/6548 [00:11<00:09, 325.16 examples/s]
Map:  55%|█████▍    | 3591/6548 [00:11<00:08, 358.94 examples/s]
Map:  56%|█████▌    | 3639/6548 [00:11<00:07, 381.35 examples/s]
Map:  56%|█████▋    | 3696/6548 [00:11<00:07, 376.89 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:12<00:07, 382.20 examples/s]
Map:  58%|█████▊    | 3800/6548 [00:12<00:07, 375.22 examples/s]
Map:  59%|█████▊    | 3839/6548 [00:12<00:08, 330.74 examples/s]
Map:  59%|█████▉    | 3887/6548 [00:12<00:08, 324.86 examples/s]
Map:  60%|█████▉    | 3922/6548 [00:12<00:08, 311.09 examples/s]
Map:  60%|██████    | 3961/6548 [00:12<00:07, 328.44 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 226.71 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 284.50 examples/s]
Map:  63%|██████▎   | 4095/6548 [00:13<00:07, 308.24 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 320.91 examples/s]
Map:  64%|██████▍   | 4195/6548 [00:13<00:07, 326.02 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:06, 331.81 examples/s]
Map:  65%|██████▌   | 4282/6548 [00:13<00:06, 359.09 examples/s]
Map:  66%|██████▌   | 4325/6548 [00:13<00:05, 370.88 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:14<00:06, 357.95 examples/s]
Map:  67%|██████▋   | 4406/6548 [00:14<00:05, 362.43 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:05, 386.71 examples/s]
Map:  69%|██████▊   | 4498/6548 [00:14<00:06, 341.61 examples/s]
Map:  69%|██████▉   | 4546/6548 [00:14<00:06, 327.44 examples/s]
Map:  70%|███████   | 4584/6548 [00:14<00:05, 329.18 examples/s]
Map:  71%|███████   | 4633/6548 [00:14<00:05, 362.32 examples/s]
Map:  71%|███████▏  | 4673/6548 [00:14<00:05, 370.09 examples/s]
Map:  72%|███████▏  | 4715/6548 [00:15<00:04, 382.20 examples/s]
Map:  73%|███████▎  | 4784/6548 [00:15<00:04, 408.68 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 406.66 examples/s]
Map:  75%|███████▍  | 4887/6548 [00:15<00:04, 393.88 examples/s]
Map:  76%|███████▌  | 4951/6548 [00:15<00:04, 391.96 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:15<00:06, 256.00 examples/s]
Map:  77%|███████▋  | 5038/6548 [00:16<00:05, 276.36 examples/s]
Map:  78%|███████▊  | 5081/6548 [00:16<00:05, 277.08 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 281.57 examples/s]
Map:  79%|███████▉  | 5170/6548 [00:16<00:04, 297.65 examples/s]
Map:  80%|███████▉  | 5211/6548 [00:16<00:04, 284.50 examples/s]
Map:  80%|████████  | 5252/6548 [00:16<00:04, 310.98 examples/s]
Map:  81%|████████  | 5292/6548 [00:16<00:03, 328.78 examples/s]
Map:  81%|████████▏ | 5330/6548 [00:17<00:03, 323.70 examples/s]
Map:  82%|████████▏ | 5388/6548 [00:17<00:03, 325.37 examples/s]
Map:  83%|████████▎ | 5423/6548 [00:17<00:03, 287.33 examples/s]
Map:  83%|████████▎ | 5461/6548 [00:17<00:03, 301.59 examples/s]
Map:  84%|████████▍ | 5502/6548 [00:17<00:03, 325.39 examples/s]
Map:  85%|████████▍ | 5538/6548 [00:17<00:03, 333.73 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:17<00:03, 307.69 examples/s]
Map:  86%|████████▌ | 5639/6548 [00:17<00:02, 359.81 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 322.16 examples/s]
Map:  87%|████████▋ | 5722/6548 [00:18<00:02, 335.38 examples/s]
Map:  88%|████████▊ | 5765/6548 [00:18<00:02, 356.47 examples/s]
Map:  89%|████████▉ | 5825/6548 [00:18<00:02, 355.63 examples/s]
Map:  90%|████████▉ | 5866/6548 [00:18<00:01, 361.68 examples/s]
Map:  90%|█████████ | 5907/6548 [00:18<00:01, 369.70 examples/s]
Map:  91%|█████████ | 5960/6548 [00:18<00:01, 361.23 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 226.64 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:01, 256.45 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 286.21 examples/s]
Map:  93%|█████████▎| 6117/6548 [00:19<00:01, 265.74 examples/s]
Map:  94%|█████████▍| 6167/6548 [00:19<00:01, 283.06 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:19<00:01, 304.08 examples/s]
Map:  96%|█████████▌| 6262/6548 [00:20<00:00, 315.29 examples/s]
Map:  96%|█████████▋| 6303/6548 [00:20<00:00, 336.06 examples/s]
Map:  97%|█████████▋| 6363/6548 [00:20<00:00, 353.31 examples/s]
Map:  98%|█████████▊| 6418/6548 [00:20<00:00, 351.32 examples/s]
Map:  99%|█████████▉| 6468/6548 [00:20<00:00, 384.40 examples/s]
Map: 100%|█████████▉| 6526/6548 [00:20<00:00, 381.68 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 314.02 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▎         | 33/903 [00:00<00:02, 309.52 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 335.88 examples/s]
Map:  13%|█▎        | 119/903 [00:00<00:02, 322.34 examples/s]
Map:  18%|█▊        | 163/903 [00:00<00:02, 358.99 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 384.79 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 392.13 examples/s]
Map:  34%|███▍      | 310/903 [00:00<00:01, 377.07 examples/s]
Map:  39%|███▉      | 356/903 [00:00<00:01, 350.47 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 299.96 examples/s]
Map:  50%|█████     | 455/903 [00:01<00:01, 292.27 examples/s]
Map:  54%|█████▍    | 488/903 [00:01<00:01, 294.55 examples/s]
Map:  59%|█████▉    | 536/903 [00:01<00:01, 333.26 examples/s]
Map:  64%|██████▍   | 578/903 [00:01<00:00, 353.59 examples/s]
Map:  70%|███████   | 635/903 [00:01<00:00, 357.54 examples/s]
Map:  75%|███████▍  | 676/903 [00:01<00:00, 366.58 examples/s]
Map:  79%|███████▉  | 717/903 [00:02<00:00, 375.37 examples/s]
Map:  85%|████████▍ | 766/903 [00:02<00:00, 393.99 examples/s]
Map:  91%|█████████ | 823/903 [00:02<00:00, 386.86 examples/s]
Map:  98%|█████████▊| 884/903 [00:02<00:00, 386.27 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 323.78 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 36/1882 [00:00<00:06, 276.97 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 349.68 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 344.92 examples/s]
Map:   9%|▊         | 162/1882 [00:00<00:04, 370.75 examples/s]
Map:  11%|█         | 203/1882 [00:00<00:04, 338.70 examples/s]
Map:  13%|█▎        | 253/1882 [00:00<00:04, 385.39 examples/s]
Map:  16%|█▌        | 302/1882 [00:00<00:04, 349.43 examples/s]
Map:  18%|█▊        | 346/1882 [00:00<00:04, 371.05 examples/s]
Map:  21%|██        | 396/1882 [00:01<00:04, 314.39 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 313.54 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 343.71 examples/s]
Map:  29%|██▉       | 546/1882 [00:01<00:03, 336.11 examples/s]
Map:  31%|███▏      | 591/1882 [00:01<00:03, 360.86 examples/s]
Map:  34%|███▍      | 646/1882 [00:01<00:03, 406.64 examples/s]
Map:  37%|███▋      | 704/1882 [00:01<00:03, 391.75 examples/s]
Map:  41%|████      | 768/1882 [00:02<00:02, 398.97 examples/s]
Map:  44%|████▍     | 830/1882 [00:02<00:02, 360.07 examples/s]
Map:  46%|████▌     | 868/1882 [00:02<00:02, 361.62 examples/s]
Map:  48%|████▊     | 908/1882 [00:02<00:02, 366.11 examples/s]
Map:  51%|█████     | 960/1882 [00:02<00:02, 400.44 examples/s]
Map:  54%|█████▍    | 1017/1882 [00:03<00:03, 257.59 examples/s]
Map:  56%|█████▌    | 1053/1882 [00:03<00:03, 274.93 examples/s]
Map:  58%|█████▊    | 1091/1882 [00:03<00:02, 289.40 examples/s]
Map:  61%|██████    | 1139/1882 [00:03<00:02, 293.67 examples/s]
Map:  62%|██████▏   | 1176/1882 [00:03<00:02, 308.11 examples/s]
Map:  65%|██████▌   | 1224/1882 [00:03<00:02, 276.24 examples/s]
Map:  67%|██████▋   | 1256/1882 [00:03<00:02, 277.55 examples/s]
Map:  69%|██████▉   | 1299/1882 [00:03<00:01, 309.67 examples/s]
Map:  71%|███████   | 1337/1882 [00:04<00:01, 323.74 examples/s]
Map:  74%|███████▎  | 1384/1882 [00:04<00:01, 317.90 examples/s]
Map:  76%|███████▌  | 1426/1882 [00:04<00:01, 288.38 examples/s]
Map:  78%|███████▊  | 1468/1882 [00:04<00:01, 316.48 examples/s]
Map:  80%|████████  | 1506/1882 [00:04<00:01, 271.61 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 281.08 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:04<00:00, 306.43 examples/s]
Map:  86%|████████▋ | 1627/1882 [00:04<00:00, 337.81 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 333.98 examples/s]
Map:  90%|█████████ | 1698/1882 [00:05<00:00, 336.33 examples/s]
Map:  92%|█████████▏| 1734/1882 [00:05<00:00, 290.92 examples/s]
Map:  94%|█████████▍| 1766/1882 [00:05<00:00, 287.91 examples/s]
Map:  97%|█████████▋| 1820/1882 [00:05<00:00, 305.62 examples/s]
Map:  99%|█████████▉| 1859/1882 [00:05<00:00, 324.37 examples/s]
Map: 100%|██████████| 1882/1882 [00:05<00:00, 314.99 examples/s]
10/12/2024 19:28:43 - INFO - __main__ -     ***** Testing *****
10/12/2024 19:28:43 - INFO - __main__ -     Batch size = 8
10/12/2024 19:28:43 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 19:28:44 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 19:28:44 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 19:28:45 - INFO - knnlm -   Reading datastore took 0.9665226936340332 s
10/12/2024 19:28:46 - INFO - knnlm -   Moving index to GPU took 0.9802253246307373 s
10/12/2024 19:28:46 - INFO - __main__ -   ******************************break-into
10/12/2024 19:28:46 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 19:28:46 - INFO - __main__ -     Num examples = 236
10/12/2024 19:28:46 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:16,  7.48s/it]
test ppl:   1%|          | 2/236 [00:09<16:04,  4.12s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:35,  2.99s/it]
test ppl:   2%|▏         | 4/236 [00:16<15:52,  4.11s/it]
test ppl:   2%|▏         | 5/236 [00:22<18:11,  4.73s/it]
test ppl:   3%|▎         | 6/236 [00:28<19:33,  5.10s/it]
test ppl:   3%|▎         | 7/236 [00:30<16:02,  4.20s/it]
test ppl:   3%|▎         | 8/236 [00:35<17:12,  4.53s/it]
test ppl:   4%|▍         | 9/236 [00:41<18:40,  4.94s/it]
test ppl:   4%|▍         | 10/236 [00:45<17:32,  4.66s/it]
test ppl:   5%|▍         | 11/236 [00:47<14:26,  3.85s/it]
test ppl:   5%|▌         | 12/236 [00:53<16:36,  4.45s/it]
test ppl:   6%|▌         | 13/236 [00:59<18:04,  4.87s/it]
test ppl:   6%|▌         | 14/236 [01:05<19:05,  5.16s/it]
test ppl:   6%|▋         | 15/236 [01:06<14:41,  3.99s/it]
test ppl:   7%|▋         | 16/236 [01:08<12:10,  3.32s/it]
test ppl:   7%|▋         | 17/236 [01:12<12:55,  3.54s/it]
test ppl:   8%|▊         | 18/236 [01:14<11:39,  3.21s/it]
test ppl:   8%|▊         | 19/236 [01:20<14:26,  3.99s/it]
test ppl:   8%|▊         | 20/236 [01:22<11:57,  3.32s/it]
test ppl:   9%|▉         | 21/236 [01:25<11:27,  3.20s/it]
test ppl:   9%|▉         | 22/236 [01:31<14:14,  3.99s/it]
test ppl:  10%|▉         | 23/236 [01:33<12:34,  3.54s/it]
test ppl:  10%|█         | 24/236 [01:35<11:05,  3.14s/it]
test ppl:  11%|█         | 25/236 [01:41<13:54,  3.95s/it]
test ppl:  11%|█         | 26/236 [01:47<15:48,  4.52s/it]
test ppl:  11%|█▏        | 27/236 [01:50<14:35,  4.19s/it]
test ppl:  12%|█▏        | 28/236 [01:52<11:24,  3.29s/it]
test ppl:  12%|█▏        | 29/236 [01:54<10:20,  3.00s/it]
test ppl:  13%|█▎        | 30/236 [01:56<08:46,  2.56s/it]
test ppl:  13%|█▎        | 31/236 [01:58<08:08,  2.38s/it]
test ppl:  14%|█▎        | 32/236 [02:00<08:39,  2.55s/it]
test ppl:  14%|█▍        | 33/236 [02:03<08:29,  2.51s/it]
test ppl:  14%|█▍        | 34/236 [02:07<09:55,  2.95s/it]
test ppl:  15%|█▍        | 35/236 [02:09<09:26,  2.82s/it]
test ppl:  15%|█▌        | 36/236 [02:15<12:23,  3.72s/it]
test ppl:  16%|█▌        | 37/236 [02:21<14:25,  4.35s/it]
test ppl:  16%|█▌        | 38/236 [02:23<12:04,  3.66s/it]
test ppl:  17%|█▋        | 39/236 [02:26<10:52,  3.31s/it]
test ppl:  17%|█▋        | 40/236 [02:27<08:53,  2.72s/it]
test ppl:  17%|█▋        | 41/236 [02:29<07:58,  2.45s/it]
test ppl:  18%|█▊        | 42/236 [02:35<11:15,  3.48s/it]
test ppl:  18%|█▊        | 43/236 [02:40<13:26,  4.18s/it]
test ppl:  19%|█▊        | 44/236 [02:42<11:18,  3.53s/it]
test ppl:  19%|█▉        | 45/236 [02:44<09:43,  3.05s/it]
test ppl:  19%|█▉        | 46/236 [02:50<12:20,  3.90s/it]
test ppl:  20%|█▉        | 47/236 [02:52<10:01,  3.18s/it]
test ppl:  20%|██        | 48/236 [02:58<12:26,  3.97s/it]
test ppl:  21%|██        | 49/236 [03:01<11:48,  3.79s/it]
test ppl:  21%|██        | 50/236 [03:07<13:41,  4.42s/it]
test ppl:  22%|██▏       | 51/236 [03:13<14:56,  4.84s/it]
test ppl:  22%|██▏       | 52/236 [03:18<15:44,  5.13s/it]
test ppl:  22%|██▏       | 53/236 [03:24<16:17,  5.34s/it]
test ppl:  23%|██▎       | 54/236 [03:26<12:43,  4.20s/it]
test ppl:  23%|██▎       | 55/236 [03:31<13:55,  4.61s/it]
test ppl:  24%|██▎       | 56/236 [03:35<12:42,  4.24s/it]
test ppl:  24%|██▍       | 57/236 [03:37<10:54,  3.65s/it]
test ppl:  25%|██▍       | 58/236 [03:39<09:37,  3.24s/it]
test ppl:  25%|██▌       | 59/236 [03:45<11:51,  4.02s/it]
test ppl:  25%|██▌       | 60/236 [03:48<11:06,  3.79s/it]
test ppl:  26%|██▌       | 61/236 [03:54<12:49,  4.40s/it]
test ppl:  26%|██▋       | 62/236 [04:00<14:00,  4.83s/it]
test ppl:  27%|██▋       | 63/236 [04:02<11:52,  4.12s/it]
test ppl:  27%|██▋       | 64/236 [04:04<09:34,  3.34s/it]
test ppl:  28%|██▊       | 65/236 [04:05<07:46,  2.73s/it]
test ppl:  28%|██▊       | 66/236 [04:08<08:00,  2.83s/it]
test ppl:  28%|██▊       | 67/236 [04:14<10:30,  3.73s/it]
test ppl:  29%|██▉       | 68/236 [04:20<12:12,  4.36s/it]
test ppl:  29%|██▉       | 69/236 [04:26<13:21,  4.80s/it]
test ppl:  30%|██▉       | 70/236 [04:32<14:06,  5.10s/it]
test ppl:  30%|███       | 71/236 [04:36<13:02,  4.74s/it]
test ppl:  31%|███       | 72/236 [04:38<11:13,  4.11s/it]
test ppl:  31%|███       | 73/236 [04:44<12:33,  4.62s/it]
test ppl:  31%|███▏      | 74/236 [04:46<09:57,  3.69s/it]
test ppl:  32%|███▏      | 75/236 [04:51<11:36,  4.33s/it]
test ppl:  32%|███▏      | 76/236 [04:54<10:25,  3.91s/it]
test ppl:  33%|███▎      | 77/236 [04:57<09:03,  3.42s/it]
test ppl:  33%|███▎      | 78/236 [04:58<07:40,  2.92s/it]
test ppl:  33%|███▎      | 79/236 [05:02<08:23,  3.21s/it]
test ppl:  34%|███▍      | 80/236 [05:04<07:04,  2.72s/it]
test ppl:  34%|███▍      | 81/236 [05:10<09:24,  3.64s/it]
test ppl:  35%|███▍      | 82/236 [05:15<11:03,  4.31s/it]
test ppl:  35%|███▌      | 83/236 [05:19<10:12,  4.00s/it]
test ppl:  36%|███▌      | 84/236 [05:21<08:42,  3.44s/it]
test ppl:  36%|███▌      | 85/236 [05:25<09:13,  3.66s/it]
test ppl:  36%|███▋      | 86/236 [05:27<07:33,  3.02s/it]
test ppl:  37%|███▋      | 87/236 [05:29<06:48,  2.74s/it]
test ppl:  37%|███▋      | 88/236 [05:34<09:02,  3.66s/it]
test ppl:  38%|███▊      | 89/236 [05:40<10:34,  4.32s/it]
test ppl:  38%|███▊      | 90/236 [05:47<11:56,  4.90s/it]
test ppl:  39%|███▊      | 91/236 [05:51<11:49,  4.89s/it]
test ppl:  39%|███▉      | 92/236 [05:54<10:13,  4.26s/it]
test ppl:  39%|███▉      | 93/236 [06:00<11:16,  4.73s/it]
test ppl:  40%|███▉      | 94/236 [06:06<11:53,  5.03s/it]
test ppl:  40%|████      | 95/236 [06:08<10:06,  4.30s/it]
test ppl:  41%|████      | 96/236 [06:11<09:04,  3.89s/it]
test ppl:  41%|████      | 97/236 [06:17<10:20,  4.47s/it]
test ppl:  42%|████▏     | 98/236 [06:23<11:12,  4.88s/it]
test ppl:  42%|████▏     | 99/236 [06:29<11:46,  5.16s/it]
test ppl:  42%|████▏     | 100/236 [06:30<09:04,  4.01s/it]
test ppl:  43%|████▎     | 101/236 [06:36<10:14,  4.55s/it]
test ppl:  43%|████▎     | 102/236 [06:40<09:43,  4.36s/it]
test ppl:  44%|████▎     | 103/236 [06:41<07:42,  3.48s/it]
test ppl:  44%|████▍     | 104/236 [06:45<08:07,  3.69s/it]
test ppl:  44%|████▍     | 105/236 [06:49<08:13,  3.77s/it]
test ppl:  45%|████▍     | 106/236 [06:55<09:12,  4.25s/it]
test ppl:  45%|████▌     | 107/236 [06:57<07:38,  3.55s/it]
test ppl:  46%|████▌     | 108/236 [07:00<07:31,  3.52s/it]
test ppl:  46%|████▌     | 109/236 [07:05<08:32,  4.04s/it]
test ppl:  47%|████▋     | 110/236 [07:07<06:55,  3.30s/it]
test ppl:  47%|████▋     | 111/236 [07:11<07:29,  3.60s/it]
test ppl:  47%|████▋     | 112/236 [07:16<08:15,  4.00s/it]
test ppl:  48%|████▊     | 113/236 [07:18<06:48,  3.32s/it]
test ppl:  48%|████▊     | 114/236 [07:22<06:58,  3.43s/it]
test ppl:  49%|████▊     | 115/236 [07:27<08:21,  4.14s/it]
test ppl:  49%|████▉     | 116/236 [07:33<09:17,  4.64s/it]
test ppl:  50%|████▉     | 117/236 [07:35<07:32,  3.80s/it]
test ppl:  50%|█████     | 118/236 [07:40<08:03,  4.10s/it]
test ppl:  50%|█████     | 119/236 [07:43<07:19,  3.76s/it]
test ppl:  51%|█████     | 120/236 [07:44<05:56,  3.07s/it]
test ppl:  51%|█████▏    | 121/236 [07:48<06:28,  3.38s/it]
test ppl:  52%|█████▏    | 122/236 [07:54<07:48,  4.11s/it]
test ppl:  52%|█████▏    | 123/236 [07:56<06:37,  3.51s/it]
test ppl:  53%|█████▎    | 124/236 [07:59<05:57,  3.19s/it]
test ppl:  53%|█████▎    | 125/236 [08:05<07:22,  3.98s/it]
test ppl:  53%|█████▎    | 126/236 [08:09<07:25,  4.05s/it]
test ppl:  54%|█████▍    | 127/236 [08:11<06:10,  3.40s/it]
test ppl:  54%|█████▍    | 128/236 [08:13<05:17,  2.94s/it]
test ppl:  55%|█████▍    | 129/236 [08:15<05:10,  2.90s/it]
test ppl:  55%|█████▌    | 130/236 [08:18<05:12,  2.95s/it]
test ppl:  56%|█████▌    | 131/236 [08:24<06:40,  3.81s/it]
test ppl:  56%|█████▌    | 132/236 [08:30<07:39,  4.42s/it]
test ppl:  56%|█████▋    | 133/236 [08:34<07:17,  4.25s/it]
test ppl:  57%|█████▋    | 134/236 [08:37<06:47,  4.00s/it]
test ppl:  57%|█████▋    | 135/236 [08:43<07:39,  4.55s/it]
test ppl:  58%|█████▊    | 136/236 [08:44<05:58,  3.58s/it]
test ppl:  58%|█████▊    | 137/236 [08:50<07:02,  4.27s/it]
test ppl:  58%|█████▊    | 138/236 [08:54<06:39,  4.07s/it]
test ppl:  59%|█████▉    | 139/236 [08:56<05:28,  3.39s/it]
test ppl:  59%|█████▉    | 140/236 [08:57<04:36,  2.88s/it]
test ppl:  60%|█████▉    | 141/236 [09:01<05:00,  3.16s/it]
test ppl:  60%|██████    | 142/236 [09:03<04:27,  2.85s/it]
test ppl:  61%|██████    | 143/236 [09:08<05:00,  3.23s/it]
test ppl:  61%|██████    | 144/236 [09:10<04:42,  3.07s/it]
test ppl:  61%|██████▏   | 145/236 [09:14<05:07,  3.38s/it]
test ppl:  62%|██████▏   | 146/236 [09:19<05:48,  3.87s/it]
test ppl:  62%|██████▏   | 147/236 [09:25<06:37,  4.47s/it]
test ppl:  63%|██████▎   | 148/236 [09:31<07:12,  4.91s/it]
test ppl:  63%|██████▎   | 149/236 [09:37<07:31,  5.20s/it]
test ppl:  64%|██████▎   | 150/236 [09:43<07:43,  5.39s/it]
test ppl:  64%|██████▍   | 151/236 [09:49<07:50,  5.53s/it]
test ppl:  64%|██████▍   | 152/236 [09:55<07:52,  5.62s/it]
test ppl:  65%|██████▍   | 153/236 [10:00<07:51,  5.68s/it]
test ppl:  65%|██████▌   | 154/236 [10:02<06:02,  4.42s/it]
test ppl:  66%|██████▌   | 155/236 [10:04<05:12,  3.85s/it]
test ppl:  66%|██████▌   | 156/236 [10:07<04:33,  3.42s/it]
test ppl:  67%|██████▋   | 157/236 [10:09<04:00,  3.05s/it]
test ppl:  67%|██████▋   | 158/236 [10:15<05:03,  3.89s/it]
test ppl:  67%|██████▋   | 159/236 [10:16<04:02,  3.15s/it]
test ppl:  68%|██████▊   | 160/236 [10:17<03:14,  2.55s/it]
test ppl:  68%|██████▊   | 161/236 [10:19<02:43,  2.18s/it]
test ppl:  69%|██████▊   | 162/236 [10:22<03:01,  2.46s/it]
test ppl:  69%|██████▉   | 163/236 [10:24<03:00,  2.48s/it]
test ppl:  69%|██████▉   | 164/236 [10:27<03:06,  2.59s/it]
test ppl:  70%|██████▉   | 165/236 [10:30<03:12,  2.72s/it]
test ppl:  70%|███████   | 166/236 [10:32<02:44,  2.35s/it]
test ppl:  71%|███████   | 167/236 [10:33<02:23,  2.08s/it]
test ppl:  71%|███████   | 168/236 [10:39<03:38,  3.21s/it]
test ppl:  72%|███████▏  | 169/236 [10:43<03:56,  3.53s/it]
test ppl:  72%|███████▏  | 170/236 [10:49<04:39,  4.23s/it]
test ppl:  72%|███████▏  | 171/236 [10:50<03:38,  3.36s/it]
test ppl:  73%|███████▎  | 172/236 [10:56<04:22,  4.10s/it]
test ppl:  73%|███████▎  | 173/236 [11:01<04:22,  4.17s/it]
test ppl:  74%|███████▎  | 174/236 [11:06<04:49,  4.67s/it]
test ppl:  74%|███████▍  | 175/236 [11:12<05:05,  5.01s/it]
test ppl:  75%|███████▍  | 176/236 [11:18<05:14,  5.25s/it]
test ppl:  75%|███████▌  | 177/236 [11:24<05:20,  5.43s/it]
test ppl:  75%|███████▌  | 178/236 [11:30<05:22,  5.56s/it]
test ppl:  76%|███████▌  | 179/236 [11:36<05:21,  5.64s/it]
test ppl:  76%|███████▋  | 180/236 [11:40<05:00,  5.37s/it]
test ppl:  77%|███████▋  | 181/236 [11:45<04:50,  5.28s/it]
test ppl:  77%|███████▋  | 182/236 [11:47<03:50,  4.26s/it]
test ppl:  78%|███████▊  | 183/236 [11:49<03:03,  3.45s/it]
test ppl:  78%|███████▊  | 184/236 [11:50<02:27,  2.83s/it]
test ppl:  78%|███████▊  | 185/236 [11:54<02:40,  3.15s/it]
test ppl:  79%|███████▉  | 186/236 [11:56<02:18,  2.77s/it]
test ppl:  79%|███████▉  | 187/236 [12:02<03:01,  3.71s/it]
test ppl:  80%|███████▉  | 188/236 [12:08<03:29,  4.36s/it]
test ppl:  80%|████████  | 189/236 [12:14<03:45,  4.80s/it]
test ppl:  81%|████████  | 190/236 [12:18<03:32,  4.63s/it]
test ppl:  81%|████████  | 191/236 [12:22<03:23,  4.52s/it]
test ppl:  81%|████████▏ | 192/236 [12:25<02:55,  4.00s/it]
test ppl:  82%|████████▏ | 193/236 [12:27<02:26,  3.40s/it]
test ppl:  82%|████████▏ | 194/236 [12:30<02:12,  3.16s/it]
test ppl:  83%|████████▎ | 195/236 [12:33<02:07,  3.12s/it]
test ppl:  83%|████████▎ | 196/236 [12:35<01:57,  2.93s/it]
test ppl:  83%|████████▎ | 197/236 [12:37<01:44,  2.68s/it]
test ppl:  84%|████████▍ | 198/236 [12:43<02:17,  3.63s/it]
test ppl:  84%|████████▍ | 199/236 [12:46<02:04,  3.38s/it]
test ppl:  85%|████████▍ | 200/236 [12:52<02:27,  4.11s/it]
test ppl:  85%|████████▌ | 201/236 [12:54<02:07,  3.65s/it]
test ppl:  86%|████████▌ | 202/236 [13:00<02:25,  4.28s/it]
test ppl:  86%|████████▌ | 203/236 [13:06<02:36,  4.75s/it]
test ppl:  86%|████████▋ | 204/236 [13:07<02:02,  3.84s/it]
test ppl:  87%|████████▋ | 205/236 [13:13<02:14,  4.34s/it]
test ppl:  87%|████████▋ | 206/236 [13:16<02:00,  4.01s/it]
test ppl:  88%|████████▊ | 207/236 [13:22<02:11,  4.55s/it]
test ppl:  88%|████████▊ | 208/236 [13:25<01:51,  3.99s/it]
test ppl:  89%|████████▊ | 209/236 [13:31<02:03,  4.56s/it]
test ppl:  89%|████████▉ | 210/236 [13:33<01:41,  3.89s/it]
test ppl:  89%|████████▉ | 211/236 [13:37<01:34,  3.80s/it]
test ppl:  90%|████████▉ | 212/236 [13:42<01:41,  4.22s/it]
test ppl:  90%|█████████ | 213/236 [13:48<01:48,  4.71s/it]
test ppl:  91%|█████████ | 214/236 [13:49<01:21,  3.69s/it]
test ppl:  91%|█████████ | 215/236 [13:55<01:30,  4.33s/it]
test ppl:  92%|█████████▏| 216/236 [13:56<01:10,  3.53s/it]
test ppl:  92%|█████████▏| 217/236 [14:02<01:18,  4.15s/it]
test ppl:  92%|█████████▏| 218/236 [14:05<01:06,  3.69s/it]
test ppl:  93%|█████████▎| 219/236 [14:10<01:13,  4.34s/it]
test ppl:  93%|█████████▎| 220/236 [14:16<01:16,  4.79s/it]
test ppl:  94%|█████████▎| 221/236 [14:18<00:58,  3.90s/it]
test ppl:  94%|█████████▍| 222/236 [14:24<01:02,  4.48s/it]
test ppl:  94%|█████████▍| 223/236 [14:30<01:03,  4.89s/it]
test ppl:  95%|█████████▍| 224/236 [14:32<00:50,  4.18s/it]
test ppl:  95%|█████████▌| 225/236 [14:38<00:51,  4.67s/it]
test ppl:  96%|█████████▌| 226/236 [14:41<00:40,  4.06s/it]
test ppl:  96%|█████████▌| 227/236 [14:43<00:32,  3.66s/it]
test ppl:  97%|█████████▋| 228/236 [14:45<00:24,  3.06s/it]
test ppl:  97%|█████████▋| 229/236 [14:47<00:18,  2.62s/it]
test ppl:  97%|█████████▋| 230/236 [14:51<00:18,  3.09s/it]
test ppl:  98%|█████████▊| 231/236 [14:54<00:15,  3.19s/it]
test ppl:  98%|█████████▊| 232/236 [14:56<00:11,  2.78s/it]
test ppl:  99%|█████████▊| 233/236 [14:59<00:08,  2.80s/it]
test ppl:  99%|█████████▉| 234/236 [15:00<00:04,  2.28s/it]
test ppl: 100%|█████████▉| 235/236 [15:06<00:03,  3.34s/it]
test ppl: 100%|██████████| 236/236 [15:07<00:00,  2.53s/it]
test ppl: 100%|██████████| 236/236 [15:07<00:00,  3.84s/it]
10/12/2024 19:43:53 - INFO - __main__ -    em: 0.2024
10/12/2024 19:43:53 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.6 100:  em: 0.2024

--------------------------------------------------------------------------------
Running experiment with knn_temp=100, lmbda=0.6, k=64
2024-10-12 19:44:00.190335: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 19:44:00.209994: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 19:44:00.231786: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 19:44:00.238411: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 19:44:00.254466: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 19:44:01.248281: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 19:44:02 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.6, knn_temp=100, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 19:44:02 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:49:55,  2.18it/s]
Adding feature api:   3%|▎         | 6347/187062 [00:00<00:11, 15072.74it/s]
Adding feature api:   7%|▋         | 13677/187062 [00:00<00:05, 29822.96it/s]
Adding feature api:  11%|█         | 21002/187062 [00:00<00:04, 41362.19it/s]
Adding feature api:  15%|█▌        | 28432/187062 [00:00<00:03, 50424.63it/s]
Adding feature api:  19%|█▉        | 35638/187062 [00:00<00:02, 56527.90it/s]
Adding feature api:  23%|██▎       | 42976/187062 [00:01<00:02, 61366.96it/s]
Adding feature api:  27%|██▋       | 50434/187062 [00:01<00:02, 65210.11it/s]
Adding feature api:  31%|███       | 57876/187062 [00:01<00:01, 67912.10it/s]
Adding feature api:  35%|███▍      | 65293/187062 [00:01<00:01, 69758.23it/s]
Adding feature api:  39%|███▉      | 72717/187062 [00:01<00:01, 71087.75it/s]
Adding feature api:  43%|████▎     | 80158/187062 [00:01<00:01, 72074.37it/s]
Adding feature api:  47%|████▋     | 87557/187062 [00:01<00:01, 72642.71it/s]
Adding feature api:  51%|█████     | 94931/187062 [00:01<00:01, 72505.27it/s]
Adding feature api:  55%|█████▍    | 102405/187062 [00:01<00:01, 73167.65it/s]
Adding feature api:  59%|█████▊    | 109852/187062 [00:01<00:01, 73553.60it/s]
Adding feature api:  63%|██████▎   | 117246/187062 [00:02<00:00, 73605.03it/s]
Adding feature api:  67%|██████▋   | 124634/187062 [00:02<00:00, 73649.79it/s]
Adding feature api:  71%|███████   | 132066/187062 [00:02<00:00, 73847.15it/s]
Adding feature api:  75%|███████▍  | 139464/187062 [00:02<00:00, 73748.11it/s]
Adding feature api:  79%|███████▊  | 146901/187062 [00:02<00:00, 73933.00it/s]
Adding feature api:  82%|████████▏ | 154322/187062 [00:02<00:00, 74013.81it/s]
Adding feature api:  86%|████████▋ | 161740/187062 [00:02<00:00, 74062.88it/s]
Adding feature api:  90%|█████████ | 169160/187062 [00:02<00:00, 74101.99it/s]
Adding feature api:  94%|█████████▍| 176609/187062 [00:02<00:00, 74215.37it/s]
Adding feature api:  98%|█████████▊| 184033/187062 [00:03<00:00, 49953.94it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 58067.39it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:49:52,  2.18it/s]
Adding feature datatype:   3%|▎         | 6229/187062 [00:00<00:12, 14793.27it/s]
Adding feature datatype:   7%|▋         | 13351/187062 [00:00<00:05, 29087.12it/s]
Adding feature datatype:  11%|█         | 20563/187062 [00:00<00:04, 40521.12it/s]
Adding feature datatype:  15%|█▍        | 27794/187062 [00:00<00:03, 49267.47it/s]
Adding feature datatype:  19%|█▊        | 35036/187062 [00:00<00:02, 55799.76it/s]
Adding feature datatype:  23%|██▎       | 42239/187062 [00:01<00:02, 60459.42it/s]
Adding feature datatype:  26%|██▋       | 49450/187062 [00:01<00:02, 63847.60it/s]
Adding feature datatype:  30%|███       | 56683/187062 [00:01<00:01, 66335.98it/s]
Adding feature datatype:  34%|███▍      | 63930/187062 [00:01<00:01, 68147.29it/s]
Adding feature datatype:  38%|███▊      | 71181/187062 [00:01<00:01, 69440.87it/s]
Adding feature datatype:  42%|████▏     | 78440/187062 [00:01<00:01, 70375.96it/s]
Adding feature datatype:  46%|████▌     | 85707/187062 [00:01<00:01, 71059.17it/s]
Adding feature datatype:  50%|████▉     | 92977/187062 [00:01<00:01, 71548.50it/s]
Adding feature datatype:  54%|█████▎    | 100231/187062 [00:01<00:01, 71843.56it/s]
Adding feature datatype:  58%|█████▊    | 107573/187062 [00:01<00:01, 72313.53it/s]
Adding feature datatype:  61%|██████▏   | 114896/187062 [00:02<00:00, 72585.90it/s]
Adding feature datatype:  65%|██████▌   | 122190/187062 [00:02<00:00, 72691.53it/s]
Adding feature datatype:  69%|██████▉   | 129478/187062 [00:02<00:00, 72709.60it/s]
Adding feature datatype:  73%|███████▎  | 136762/187062 [00:02<00:00, 72282.24it/s]
Adding feature datatype:  77%|███████▋  | 144000/187062 [00:02<00:00, 72300.12it/s]
Adding feature datatype:  81%|████████  | 151267/187062 [00:02<00:00, 72409.56it/s]
Adding feature datatype:  85%|████████▍ | 158541/187062 [00:02<00:00, 72507.37it/s]
Adding feature datatype:  89%|████████▊ | 165796/187062 [00:02<00:00, 72498.11it/s]
Adding feature datatype:  93%|█████████▎| 173066/187062 [00:02<00:00, 72556.07it/s]
Adding feature datatype:  96%|█████████▋| 180324/187062 [00:03<00:00, 61619.56it/s]
Adding feature datatype: 100%|█████████▉| 186772/187062 [00:03<00:00, 45973.21it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 57296.14it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:43:44,  2.19it/s]
Adding feature literal:   3%|▎         | 5736/187062 [00:00<00:13, 13666.75it/s]
Adding feature literal:   6%|▋         | 12076/187062 [00:00<00:06, 26296.12it/s]
Adding feature literal:  10%|█         | 19261/187062 [00:00<00:04, 38421.98it/s]
Adding feature literal:  14%|█▍        | 26470/187062 [00:00<00:03, 47696.91it/s]
Adding feature literal:  18%|█▊        | 33669/187062 [00:00<00:02, 54557.00it/s]
Adding feature literal:  22%|██▏       | 40873/187062 [00:01<00:02, 59580.71it/s]
Adding feature literal:  26%|██▌       | 48110/187062 [00:01<00:02, 63302.05it/s]
Adding feature literal:  30%|██▉       | 55332/187062 [00:01<00:01, 65918.47it/s]
Adding feature literal:  33%|███▎      | 62584/187062 [00:01<00:01, 67866.99it/s]
Adding feature literal:  37%|███▋      | 69863/187062 [00:01<00:01, 69327.39it/s]
Adding feature literal:  41%|████      | 77158/187062 [00:01<00:01, 70404.83it/s]
Adding feature literal:  45%|████▌     | 84405/187062 [00:01<00:01, 71017.77it/s]
Adding feature literal:  49%|████▉     | 91674/187062 [00:01<00:01, 71515.34it/s]
Adding feature literal:  53%|█████▎    | 98901/187062 [00:01<00:01, 71215.18it/s]
Adding feature literal:  57%|█████▋    | 106138/187062 [00:01<00:01, 71556.24it/s]
Adding feature literal:  61%|██████    | 113393/187062 [00:02<00:01, 71849.91it/s]
Adding feature literal:  65%|██████▍   | 120685/187062 [00:02<00:00, 72168.82it/s]
Adding feature literal:  68%|██████▊   | 127921/187062 [00:02<00:00, 72081.12it/s]
Adding feature literal:  72%|███████▏  | 135191/187062 [00:02<00:00, 72265.66it/s]
Adding feature literal:  76%|███████▌  | 142438/187062 [00:02<00:00, 72323.86it/s]
Adding feature literal:  80%|████████  | 149677/187062 [00:02<00:00, 72327.57it/s]
Adding feature literal:  84%|████████▍ | 156919/187062 [00:02<00:00, 72353.32it/s]
Adding feature literal:  88%|████████▊ | 164158/187062 [00:02<00:00, 72314.00it/s]
Adding feature literal:  92%|█████████▏| 171457/187062 [00:02<00:00, 72515.82it/s]
Adding feature literal:  96%|█████████▌| 178711/187062 [00:02<00:00, 67801.64it/s]
Adding feature literal:  99%|█████████▉| 185555/187062 [00:03<00:00, 47136.39it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 56892.24it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:44:33,  2.19it/s]
Adding feature operator:   3%|▎         | 6190/187062 [00:00<00:12, 14742.22it/s]
Adding feature operator:   7%|▋         | 13344/187062 [00:00<00:05, 29160.28it/s]
Adding feature operator:  11%|█         | 20503/187062 [00:00<00:04, 40450.98it/s]
Adding feature operator:  15%|█▍        | 27739/187062 [00:00<00:03, 49240.14it/s]
Adding feature operator:  19%|█▊        | 34940/187062 [00:00<00:02, 55669.63it/s]
Adding feature operator:  23%|██▎       | 42216/187062 [00:01<00:02, 60581.29it/s]
Adding feature operator:  26%|██▋       | 49278/187062 [00:01<00:02, 63502.69it/s]
Adding feature operator:  30%|███       | 56575/187062 [00:01<00:01, 66280.11it/s]
Adding feature operator:  34%|███▍      | 63856/187062 [00:01<00:01, 68208.94it/s]
Adding feature operator:  38%|███▊      | 71158/187062 [00:01<00:01, 69635.57it/s]
Adding feature operator:  42%|████▏     | 78461/187062 [00:01<00:01, 70643.49it/s]
Adding feature operator:  46%|████▌     | 85757/187062 [00:01<00:01, 71333.60it/s]
Adding feature operator:  50%|████▉     | 93030/187062 [00:01<00:01, 71750.55it/s]
Adding feature operator:  54%|█████▎    | 100328/187062 [00:01<00:01, 72115.23it/s]
Adding feature operator:  58%|█████▊    | 107634/187062 [00:01<00:01, 72396.25it/s]
Adding feature operator:  61%|██████▏   | 114911/187062 [00:02<00:00, 72497.94it/s]
Adding feature operator:  65%|██████▌   | 122187/187062 [00:02<00:00, 70146.57it/s]
Adding feature operator:  69%|██████▉   | 129237/187062 [00:02<00:00, 68417.92it/s]
Adding feature operator:  73%|███████▎  | 136109/187062 [00:02<00:00, 66534.79it/s]
Adding feature operator:  76%|███████▋  | 142790/187062 [00:02<00:00, 65937.69it/s]
Adding feature operator:  80%|███████▉  | 149402/187062 [00:02<00:00, 65372.44it/s]
Adding feature operator:  83%|████████▎ | 155951/187062 [00:02<00:00, 65134.45it/s]
Adding feature operator:  87%|████████▋ | 163169/187062 [00:02<00:00, 67188.85it/s]
Adding feature operator:  91%|█████████ | 170385/187062 [00:02<00:00, 68650.60it/s]
Adding feature operator:  95%|█████████▍| 177579/187062 [00:02<00:00, 69623.11it/s]
Adding feature operator:  99%|█████████▊| 184550/187062 [00:03<00:00, 47313.60it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 56053.38it/s]
[2024-10-12 19:44:47,926] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 19:44:49 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 19:44:49 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 45/6548 [00:00<00:15, 426.87 examples/s]
Map:   2%|▏         | 108/6548 [00:00<00:25, 250.74 examples/s]
Map:   2%|▏         | 151/6548 [00:00<00:22, 286.58 examples/s]
Map:   3%|▎         | 197/6548 [00:00<00:20, 316.76 examples/s]
Map:   4%|▍         | 247/6548 [00:00<00:17, 358.72 examples/s]
Map:   4%|▍         | 293/6548 [00:00<00:18, 329.98 examples/s]
Map:   5%|▌         | 346/6548 [00:01<00:20, 296.02 examples/s]
Map:   6%|▌         | 388/6548 [00:01<00:19, 322.32 examples/s]
Map:   7%|▋         | 434/6548 [00:01<00:17, 352.10 examples/s]
Map:   7%|▋         | 476/6548 [00:01<00:18, 326.33 examples/s]
Map:   8%|▊         | 512/6548 [00:01<00:18, 330.49 examples/s]
Map:   9%|▊         | 565/6548 [00:01<00:15, 379.84 examples/s]
Map:   9%|▉         | 607/6548 [00:01<00:15, 371.89 examples/s]
Map:  10%|▉         | 653/6548 [00:02<00:19, 306.82 examples/s]
Map:  11%|█         | 693/6548 [00:02<00:17, 326.28 examples/s]
Map:  11%|█         | 733/6548 [00:02<00:16, 343.69 examples/s]
Map:  12%|█▏        | 785/6548 [00:02<00:14, 385.74 examples/s]
Map:  13%|█▎        | 831/6548 [00:02<00:14, 382.07 examples/s]
Map:  13%|█▎        | 873/6548 [00:02<00:14, 390.81 examples/s]
Map:  14%|█▍        | 932/6548 [00:02<00:15, 371.97 examples/s]
Map:  15%|█▌        | 987/6548 [00:02<00:15, 360.33 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:23, 238.93 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:20, 263.10 examples/s]
Map:  17%|█▋        | 1126/6548 [00:03<00:17, 303.69 examples/s]
Map:  18%|█▊        | 1170/6548 [00:03<00:16, 329.55 examples/s]
Map:  18%|█▊        | 1209/6548 [00:03<00:15, 340.56 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:14, 353.64 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:14, 367.52 examples/s]
Map:  20%|██        | 1342/6548 [00:04<00:15, 338.19 examples/s]
Map:  21%|██        | 1380/6548 [00:04<00:17, 303.44 examples/s]
Map:  22%|██▏       | 1431/6548 [00:04<00:16, 306.16 examples/s]
Map:  23%|██▎       | 1475/6548 [00:04<00:18, 275.81 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:17, 288.82 examples/s]
Map:  24%|██▎       | 1542/6548 [00:04<00:17, 287.41 examples/s]
Map:  24%|██▍       | 1576/6548 [00:04<00:17, 290.08 examples/s]
Map:  25%|██▍       | 1610/6548 [00:05<00:17, 280.80 examples/s]
Map:  25%|██▌       | 1640/6548 [00:05<00:17, 280.32 examples/s]
Map:  26%|██▌       | 1675/6548 [00:05<00:19, 252.78 examples/s]
Map:  26%|██▌       | 1716/6548 [00:05<00:16, 285.53 examples/s]
Map:  27%|██▋       | 1761/6548 [00:05<00:14, 324.77 examples/s]
Map:  28%|██▊       | 1803/6548 [00:05<00:13, 348.14 examples/s]
Map:  28%|██▊       | 1843/6548 [00:05<00:13, 360.38 examples/s]
Map:  29%|██▉       | 1887/6548 [00:05<00:14, 329.71 examples/s]
Map:  30%|██▉       | 1940/6548 [00:06<00:13, 335.13 examples/s]
Map:  30%|███       | 1985/6548 [00:06<00:12, 359.09 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:19, 226.29 examples/s]
Map:  32%|███▏      | 2071/6548 [00:06<00:17, 256.61 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 267.08 examples/s]
Map:  33%|███▎      | 2136/6548 [00:06<00:15, 275.97 examples/s]
Map:  33%|███▎      | 2179/6548 [00:07<00:16, 263.67 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 271.75 examples/s]
Map:  34%|███▍      | 2247/6548 [00:07<00:16, 255.60 examples/s]
Map:  35%|███▍      | 2277/6548 [00:07<00:16, 262.02 examples/s]
Map:  35%|███▌      | 2319/6548 [00:07<00:14, 299.41 examples/s]
Map:  36%|███▌      | 2355/6548 [00:07<00:14, 297.40 examples/s]
Map:  37%|███▋      | 2392/6548 [00:07<00:13, 313.59 examples/s]
Map:  37%|███▋      | 2435/6548 [00:07<00:11, 343.84 examples/s]
Map:  38%|███▊      | 2478/6548 [00:07<00:12, 316.41 examples/s]
Map:  38%|███▊      | 2517/6548 [00:08<00:12, 332.06 examples/s]
Map:  39%|███▉      | 2562/6548 [00:08<00:11, 358.44 examples/s]
Map:  40%|███▉      | 2608/6548 [00:08<00:10, 381.42 examples/s]
Map:  41%|████      | 2654/6548 [00:08<00:09, 400.36 examples/s]
Map:  41%|████▏     | 2704/6548 [00:08<00:10, 365.72 examples/s]
Map:  42%|████▏     | 2763/6548 [00:08<00:10, 368.63 examples/s]
Map:  43%|████▎     | 2811/6548 [00:08<00:10, 344.08 examples/s]
Map:  44%|████▎     | 2862/6548 [00:09<00:12, 301.17 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:11, 305.05 examples/s]
Map:  45%|████▌     | 2950/6548 [00:09<00:11, 310.41 examples/s]
Map:  46%|████▌     | 2988/6548 [00:09<00:12, 286.98 examples/s]
Map:  46%|████▌     | 3026/6548 [00:09<00:20, 170.52 examples/s]
Map:  47%|████▋     | 3058/6548 [00:10<00:18, 190.46 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 207.48 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 249.14 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:13, 254.57 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 252.19 examples/s]
Map:  50%|████▉     | 3247/6548 [00:10<00:12, 261.53 examples/s]
Map:  50%|█████     | 3284/6548 [00:10<00:11, 277.32 examples/s]
Map:  51%|█████     | 3325/6548 [00:10<00:10, 307.24 examples/s]
Map:  51%|█████▏    | 3367/6548 [00:11<00:10, 293.61 examples/s]
Map:  52%|█████▏    | 3407/6548 [00:11<00:11, 284.13 examples/s]
Map:  53%|█████▎    | 3445/6548 [00:11<00:10, 304.87 examples/s]
Map:  53%|█████▎    | 3489/6548 [00:11<00:12, 253.29 examples/s]
Map:  54%|█████▍    | 3534/6548 [00:11<00:10, 292.52 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:11<00:09, 321.69 examples/s]
Map:  55%|█████▌    | 3622/6548 [00:11<00:08, 351.26 examples/s]
Map:  56%|█████▌    | 3661/6548 [00:12<00:08, 359.28 examples/s]
Map:  57%|█████▋    | 3706/6548 [00:12<00:07, 382.85 examples/s]
Map:  57%|█████▋    | 3759/6548 [00:12<00:07, 360.87 examples/s]
Map:  58%|█████▊    | 3797/6548 [00:12<00:07, 364.47 examples/s]
Map:  59%|█████▊    | 3836/6548 [00:12<00:08, 322.41 examples/s]
Map:  59%|█████▉    | 3888/6548 [00:12<00:08, 326.88 examples/s]
Map:  60%|██████    | 3929/6548 [00:12<00:07, 327.93 examples/s]
Map:  61%|██████    | 3964/6548 [00:12<00:07, 331.44 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 222.40 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 282.87 examples/s]
Map:  63%|██████▎   | 4096/6548 [00:13<00:07, 310.70 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 323.02 examples/s]
Map:  64%|██████▍   | 4187/6548 [00:13<00:07, 307.84 examples/s]
Map:  65%|██████▍   | 4233/6548 [00:13<00:07, 304.22 examples/s]
Map:  65%|██████▌   | 4273/6548 [00:13<00:07, 318.63 examples/s]
Map:  66%|██████▌   | 4316/6548 [00:14<00:06, 340.73 examples/s]
Map:  67%|██████▋   | 4362/6548 [00:14<00:06, 326.08 examples/s]
Map:  67%|██████▋   | 4400/6548 [00:14<00:06, 331.69 examples/s]
Map:  68%|██████▊   | 4446/6548 [00:14<00:05, 362.68 examples/s]
Map:  69%|██████▊   | 4492/6548 [00:14<00:06, 339.84 examples/s]
Map:  69%|██████▉   | 4535/6548 [00:14<00:06, 320.79 examples/s]
Map:  70%|██████▉   | 4577/6548 [00:14<00:05, 338.82 examples/s]
Map:  71%|███████   | 4633/6548 [00:15<00:05, 348.84 examples/s]
Map:  71%|███████▏  | 4673/6548 [00:15<00:05, 356.66 examples/s]
Map:  72%|███████▏  | 4729/6548 [00:15<00:05, 361.07 examples/s]
Map:  73%|███████▎  | 4793/6548 [00:15<00:04, 379.01 examples/s]
Map:  74%|███████▍  | 4852/6548 [00:15<00:04, 377.87 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 353.47 examples/s]
Map:  76%|███████▌  | 4958/6548 [00:15<00:04, 390.56 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:16<00:06, 238.22 examples/s]
Map:  77%|███████▋  | 5037/6548 [00:16<00:05, 260.15 examples/s]
Map:  78%|███████▊  | 5082/6548 [00:16<00:05, 267.98 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 275.57 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 289.13 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 287.20 examples/s]
Map:  80%|███████▉  | 5221/6548 [00:16<00:04, 288.28 examples/s]
Map:  80%|████████  | 5256/6548 [00:17<00:04, 294.20 examples/s]
Map:  81%|████████  | 5312/6548 [00:17<00:03, 360.49 examples/s]
Map:  82%|████████▏ | 5361/6548 [00:17<00:03, 302.98 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 297.21 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 326.96 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 323.95 examples/s]
Map:  85%|████████▍ | 5547/6548 [00:17<00:02, 347.83 examples/s]
Map:  85%|████████▌ | 5597/6548 [00:18<00:03, 301.05 examples/s]
Map:  86%|████████▌ | 5644/6548 [00:18<00:02, 336.30 examples/s]
Map:  87%|████████▋ | 5687/6548 [00:18<00:02, 314.84 examples/s]
Map:  88%|████████▊ | 5731/6548 [00:18<00:02, 333.83 examples/s]
Map:  88%|████████▊ | 5773/6548 [00:18<00:02, 348.28 examples/s]
Map:  89%|████████▉ | 5813/6548 [00:18<00:02, 353.44 examples/s]
Map:  90%|████████▉ | 5866/6548 [00:18<00:01, 348.58 examples/s]
Map:  90%|█████████ | 5923/6548 [00:19<00:01, 354.53 examples/s]
Map:  91%|█████████ | 5960/6548 [00:19<00:01, 348.74 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 219.79 examples/s]
Map:  92%|█████████▏| 6042/6548 [00:19<00:01, 254.48 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 283.09 examples/s]
Map:  94%|█████████▎| 6124/6548 [00:19<00:01, 278.84 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:20<00:01, 289.71 examples/s]
Map:  95%|█████████▍| 6207/6548 [00:20<00:01, 314.18 examples/s]
Map:  95%|█████████▌| 6249/6548 [00:20<00:00, 335.05 examples/s]
Map:  96%|█████████▋| 6304/6548 [00:20<00:00, 343.64 examples/s]
Map:  97%|█████████▋| 6340/6548 [00:20<00:00, 345.16 examples/s]
Map:  98%|█████████▊| 6386/6548 [00:20<00:00, 364.56 examples/s]
Map:  98%|█████████▊| 6428/6548 [00:20<00:00, 374.04 examples/s]
Map:  99%|█████████▉| 6476/6548 [00:20<00:00, 399.99 examples/s]
Map: 100%|█████████▉| 6538/6548 [00:20<00:00, 394.52 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 310.41 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 323.94 examples/s]
Map:   8%|▊         | 73/903 [00:00<00:02, 346.56 examples/s]
Map:  13%|█▎        | 120/903 [00:00<00:02, 323.84 examples/s]
Map:  18%|█▊        | 166/903 [00:00<00:02, 365.58 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 386.88 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 392.95 examples/s]
Map:  34%|███▍      | 310/903 [00:00<00:01, 374.37 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 318.09 examples/s]
Map:  44%|████▎     | 395/903 [00:01<00:01, 284.16 examples/s]
Map:  48%|████▊     | 436/903 [00:01<00:01, 291.97 examples/s]
Map:  53%|█████▎    | 475/903 [00:01<00:01, 309.77 examples/s]
Map:  57%|█████▋    | 512/903 [00:01<00:01, 320.05 examples/s]
Map:  62%|██████▏   | 560/903 [00:01<00:00, 354.97 examples/s]
Map:  68%|██████▊   | 610/903 [00:01<00:00, 385.40 examples/s]
Map:  74%|███████▎  | 665/903 [00:01<00:00, 364.98 examples/s]
Map:  78%|███████▊  | 706/903 [00:02<00:00, 368.61 examples/s]
Map:  84%|████████▎ | 756/903 [00:02<00:00, 401.52 examples/s]
Map:  90%|████████▉ | 812/903 [00:02<00:00, 385.35 examples/s]
Map:  95%|█████████▌| 862/903 [00:02<00:00, 387.94 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 233.78 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 322.19 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 297.58 examples/s]
Map:   4%|▍         | 81/1882 [00:00<00:04, 365.40 examples/s]
Map:   7%|▋         | 128/1882 [00:00<00:05, 324.50 examples/s]
Map:   9%|▉         | 172/1882 [00:00<00:04, 360.57 examples/s]
Map:  12%|█▏        | 228/1882 [00:00<00:04, 354.91 examples/s]
Map:  14%|█▍        | 269/1882 [00:00<00:04, 369.38 examples/s]
Map:  18%|█▊        | 331/1882 [00:00<00:04, 381.54 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:04, 306.56 examples/s]
Map:  22%|██▏       | 414/1882 [00:01<00:05, 286.60 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 293.95 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 329.52 examples/s]
Map:  28%|██▊       | 536/1882 [00:01<00:04, 301.96 examples/s]
Map:  31%|███       | 576/1882 [00:01<00:04, 320.54 examples/s]
Map:  33%|███▎      | 620/1882 [00:01<00:03, 349.21 examples/s]
Map:  35%|███▌      | 663/1882 [00:01<00:03, 365.08 examples/s]
Map:  38%|███▊      | 706/1882 [00:02<00:03, 379.20 examples/s]
Map:  41%|████      | 768/1882 [00:02<00:02, 386.33 examples/s]
Map:  43%|████▎     | 815/1882 [00:02<00:02, 356.02 examples/s]
Map:  46%|████▌     | 867/1882 [00:02<00:02, 348.94 examples/s]
Map:  48%|████▊     | 908/1882 [00:02<00:02, 355.18 examples/s]
Map:  50%|█████     | 946/1882 [00:02<00:02, 353.76 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 369.36 examples/s]
Map:  55%|█████▌    | 1039/1882 [00:03<00:03, 242.17 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 256.91 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 270.74 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 281.30 examples/s]
Map:  63%|██████▎   | 1177/1882 [00:03<00:02, 278.29 examples/s]
Map:  64%|██████▍   | 1213/1882 [00:03<00:02, 292.35 examples/s]
Map:  66%|██████▋   | 1247/1882 [00:03<00:02, 304.30 examples/s]
Map:  68%|██████▊   | 1286/1882 [00:03<00:01, 325.67 examples/s]
Map:  70%|███████   | 1324/1882 [00:04<00:01, 333.73 examples/s]
Map:  72%|███████▏  | 1360/1882 [00:04<00:01, 331.20 examples/s]
Map:  75%|███████▌  | 1413/1882 [00:04<00:01, 334.76 examples/s]
Map:  77%|███████▋  | 1448/1882 [00:04<00:01, 293.40 examples/s]
Map:  79%|███████▉  | 1493/1882 [00:04<00:01, 282.99 examples/s]
Map:  81%|████████  | 1523/1882 [00:04<00:01, 283.06 examples/s]
Map:  83%|████████▎ | 1553/1882 [00:04<00:01, 277.50 examples/s]
Map:  85%|████████▌ | 1604/1882 [00:05<00:00, 334.02 examples/s]
Map:  87%|████████▋ | 1639/1882 [00:05<00:00, 331.54 examples/s]
Map:  89%|████████▉ | 1673/1882 [00:05<00:00, 292.34 examples/s]
Map:  91%|█████████ | 1716/1882 [00:05<00:00, 324.71 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 276.31 examples/s]
Map:  95%|█████████▌| 1794/1882 [00:05<00:00, 272.85 examples/s]
Map:  98%|█████████▊| 1841/1882 [00:05<00:00, 313.77 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 225.05 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 307.42 examples/s]
10/12/2024 19:45:51 - INFO - __main__ -     ***** Testing *****
10/12/2024 19:45:51 - INFO - __main__ -     Batch size = 8
10/12/2024 19:45:51 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 19:45:51 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 19:45:51 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 19:45:52 - INFO - knnlm -   Reading datastore took 0.9173660278320312 s
10/12/2024 19:45:53 - INFO - knnlm -   Moving index to GPU took 0.999126672744751 s
10/12/2024 19:45:53 - INFO - __main__ -   ******************************break-into
10/12/2024 19:45:53 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 19:45:53 - INFO - __main__ -     Num examples = 236
10/12/2024 19:45:53 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:27,  7.52s/it]
test ppl:   1%|          | 2/236 [00:09<16:27,  4.22s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:34,  2.98s/it]
test ppl:   2%|▏         | 4/236 [00:16<15:58,  4.13s/it]
test ppl:   2%|▏         | 5/236 [00:22<18:21,  4.77s/it]
test ppl:   3%|▎         | 6/236 [00:28<19:45,  5.15s/it]
test ppl:   3%|▎         | 7/236 [00:30<15:36,  4.09s/it]
test ppl:   3%|▎         | 8/236 [00:35<16:53,  4.45s/it]
test ppl:   4%|▍         | 9/236 [00:41<18:33,  4.91s/it]
test ppl:   4%|▍         | 10/236 [00:47<19:40,  5.22s/it]
test ppl:   5%|▍         | 11/236 [00:49<15:56,  4.25s/it]
test ppl:   5%|▌         | 12/236 [00:55<17:45,  4.75s/it]
test ppl:   6%|▌         | 13/236 [01:01<18:58,  5.11s/it]
test ppl:   6%|▌         | 14/236 [01:07<19:49,  5.36s/it]
test ppl:   6%|▋         | 15/236 [01:08<15:13,  4.13s/it]
test ppl:   7%|▋         | 16/236 [01:10<12:38,  3.45s/it]
test ppl:   7%|▋         | 17/236 [01:14<13:16,  3.64s/it]
test ppl:   8%|▊         | 18/236 [01:16<11:06,  3.06s/it]
test ppl:   8%|▊         | 19/236 [01:22<14:08,  3.91s/it]
test ppl:   8%|▊         | 20/236 [01:24<11:47,  3.27s/it]
test ppl:   9%|▉         | 21/236 [01:25<10:10,  2.84s/it]
test ppl:   9%|▉         | 22/236 [01:31<13:24,  3.76s/it]
test ppl:  10%|▉         | 23/236 [01:34<12:01,  3.39s/it]
test ppl:  10%|█         | 24/236 [01:36<11:15,  3.19s/it]
test ppl:  11%|█         | 25/236 [01:42<14:05,  4.01s/it]
test ppl:  11%|█         | 26/236 [01:48<16:01,  4.58s/it]
test ppl:  11%|█▏        | 27/236 [01:52<14:49,  4.26s/it]
test ppl:  12%|█▏        | 28/236 [01:53<11:36,  3.35s/it]
test ppl:  12%|█▏        | 29/236 [01:55<10:10,  2.95s/it]
test ppl:  13%|█▎        | 30/236 [01:57<08:41,  2.53s/it]
test ppl:  13%|█▎        | 31/236 [01:59<08:06,  2.37s/it]
test ppl:  14%|█▎        | 32/236 [02:01<08:21,  2.46s/it]
test ppl:  14%|█▍        | 33/236 [02:07<11:48,  3.49s/it]
test ppl:  14%|█▍        | 34/236 [02:13<14:13,  4.22s/it]
test ppl:  15%|█▍        | 35/236 [02:19<15:50,  4.73s/it]
test ppl:  15%|█▌        | 36/236 [02:25<16:55,  5.08s/it]
test ppl:  16%|█▌        | 37/236 [02:31<17:41,  5.33s/it]
test ppl:  16%|█▌        | 38/236 [02:33<14:22,  4.36s/it]
test ppl:  17%|█▋        | 39/236 [02:34<11:27,  3.49s/it]
test ppl:  17%|█▋        | 40/236 [02:36<09:19,  2.85s/it]
test ppl:  17%|█▋        | 41/236 [02:38<08:19,  2.56s/it]
test ppl:  18%|█▊        | 42/236 [02:44<11:35,  3.59s/it]
test ppl:  18%|█▊        | 43/236 [02:50<13:47,  4.29s/it]
test ppl:  19%|█▊        | 44/236 [02:52<11:34,  3.62s/it]
test ppl:  19%|█▉        | 45/236 [02:54<09:56,  3.12s/it]
test ppl:  19%|█▉        | 46/236 [03:00<12:35,  3.97s/it]
test ppl:  20%|█▉        | 47/236 [03:01<10:13,  3.24s/it]
test ppl:  20%|██        | 48/236 [03:07<12:38,  4.03s/it]
test ppl:  21%|██        | 49/236 [03:10<11:22,  3.65s/it]
test ppl:  21%|██        | 50/236 [03:16<13:28,  4.35s/it]
test ppl:  22%|██▏       | 51/236 [03:22<14:52,  4.82s/it]
test ppl:  22%|██▏       | 52/236 [03:28<15:47,  5.15s/it]
test ppl:  22%|██▏       | 53/236 [03:32<14:48,  4.86s/it]
test ppl:  23%|██▎       | 54/236 [03:33<11:42,  3.86s/it]
test ppl:  23%|██▎       | 55/236 [03:39<13:17,  4.41s/it]
test ppl:  24%|██▎       | 56/236 [03:42<12:20,  4.12s/it]
test ppl:  24%|██▍       | 57/236 [03:45<10:40,  3.58s/it]
test ppl:  25%|██▍       | 58/236 [03:47<09:29,  3.20s/it]
test ppl:  25%|██▌       | 59/236 [03:53<11:50,  4.02s/it]
test ppl:  25%|██▌       | 60/236 [03:56<11:08,  3.80s/it]
test ppl:  26%|██▌       | 61/236 [04:02<12:55,  4.43s/it]
test ppl:  26%|██▋       | 62/236 [04:08<14:08,  4.88s/it]
test ppl:  27%|██▋       | 63/236 [04:11<11:59,  4.16s/it]
test ppl:  27%|██▋       | 64/236 [04:12<09:42,  3.39s/it]
test ppl:  28%|██▊       | 65/236 [04:13<07:54,  2.77s/it]
test ppl:  28%|██▊       | 66/236 [04:16<08:04,  2.85s/it]
test ppl:  28%|██▊       | 67/236 [04:22<10:37,  3.77s/it]
test ppl:  29%|██▉       | 68/236 [04:28<12:22,  4.42s/it]
test ppl:  29%|██▉       | 69/236 [04:34<13:33,  4.87s/it]
test ppl:  30%|██▉       | 70/236 [04:40<14:21,  5.19s/it]
test ppl:  30%|███       | 71/236 [04:44<12:52,  4.68s/it]
test ppl:  31%|███       | 72/236 [04:48<12:05,  4.43s/it]
test ppl:  31%|███       | 73/236 [04:53<13:14,  4.87s/it]
test ppl:  31%|███▏      | 74/236 [04:55<10:26,  3.87s/it]
test ppl:  32%|███▏      | 75/236 [05:01<12:08,  4.52s/it]
test ppl:  32%|███▏      | 76/236 [05:07<12:54,  4.84s/it]
test ppl:  33%|███▎      | 77/236 [05:10<12:03,  4.55s/it]
test ppl:  33%|███▎      | 78/236 [05:13<10:12,  3.87s/it]
test ppl:  33%|███▎      | 79/236 [05:17<10:11,  3.90s/it]
test ppl:  34%|███▍      | 80/236 [05:18<08:20,  3.21s/it]
test ppl:  34%|███▍      | 81/236 [05:24<10:20,  4.00s/it]
test ppl:  35%|███▍      | 82/236 [05:30<11:45,  4.58s/it]
test ppl:  35%|███▌      | 83/236 [05:36<12:41,  4.98s/it]
test ppl:  36%|███▌      | 84/236 [05:38<10:06,  3.99s/it]
test ppl:  36%|███▌      | 85/236 [05:42<10:13,  4.06s/it]
test ppl:  36%|███▋      | 86/236 [05:44<08:45,  3.50s/it]
test ppl:  37%|███▋      | 87/236 [05:46<07:39,  3.08s/it]
test ppl:  37%|███▋      | 88/236 [05:52<09:40,  3.92s/it]
test ppl:  38%|███▊      | 89/236 [05:59<11:45,  4.80s/it]
test ppl:  38%|███▊      | 90/236 [06:06<13:30,  5.55s/it]
test ppl:  39%|███▊      | 91/236 [06:12<13:49,  5.72s/it]
test ppl:  39%|███▉      | 92/236 [06:16<12:06,  5.05s/it]
test ppl:  39%|███▉      | 93/236 [06:23<13:37,  5.72s/it]
test ppl:  40%|███▉      | 94/236 [06:30<14:33,  6.15s/it]
test ppl:  40%|████      | 95/236 [06:34<12:24,  5.28s/it]
test ppl:  41%|████      | 96/236 [06:37<11:09,  4.78s/it]
test ppl:  41%|████      | 97/236 [06:44<12:48,  5.53s/it]
test ppl:  42%|████▏     | 98/236 [06:52<13:57,  6.07s/it]
test ppl:  42%|████▏     | 99/236 [06:59<14:41,  6.43s/it]
test ppl:  42%|████▏     | 100/236 [07:01<11:18,  4.99s/it]
test ppl:  43%|████▎     | 101/236 [07:08<12:46,  5.68s/it]
test ppl:  43%|████▎     | 102/236 [07:13<12:14,  5.48s/it]
test ppl:  44%|████▎     | 103/236 [07:15<09:40,  4.37s/it]
test ppl:  44%|████▍     | 104/236 [07:20<10:11,  4.63s/it]
test ppl:  44%|████▍     | 105/236 [07:25<10:17,  4.72s/it]
test ppl:  45%|████▍     | 106/236 [07:32<11:31,  5.32s/it]
test ppl:  45%|████▌     | 107/236 [07:39<12:44,  5.93s/it]
test ppl:  46%|████▌     | 108/236 [07:43<11:33,  5.42s/it]
test ppl:  46%|████▌     | 109/236 [07:50<12:14,  5.78s/it]
test ppl:  47%|████▋     | 110/236 [07:53<10:19,  4.92s/it]
test ppl:  47%|████▋     | 111/236 [07:58<10:17,  4.94s/it]
test ppl:  47%|████▋     | 112/236 [08:05<11:41,  5.66s/it]
test ppl:  48%|████▊     | 113/236 [08:07<09:27,  4.62s/it]
test ppl:  48%|████▊     | 114/236 [08:12<09:24,  4.63s/it]
test ppl:  49%|████▊     | 115/236 [08:19<10:58,  5.44s/it]
test ppl:  49%|████▉     | 116/236 [08:27<12:01,  6.01s/it]
test ppl:  50%|████▉     | 117/236 [08:29<09:42,  4.90s/it]
test ppl:  50%|█████     | 118/236 [08:36<11:04,  5.63s/it]
test ppl:  50%|█████     | 119/236 [08:40<09:57,  5.11s/it]
test ppl:  51%|█████     | 120/236 [08:42<07:51,  4.07s/it]
test ppl:  51%|█████▏    | 121/236 [08:49<09:39,  5.04s/it]
test ppl:  52%|█████▏    | 122/236 [08:56<10:51,  5.72s/it]
test ppl:  52%|█████▏    | 123/236 [09:04<11:40,  6.20s/it]
test ppl:  53%|█████▎    | 124/236 [09:06<09:35,  5.14s/it]
test ppl:  53%|█████▎    | 125/236 [09:14<10:43,  5.80s/it]
test ppl:  53%|█████▎    | 126/236 [09:18<09:58,  5.44s/it]
test ppl:  54%|█████▍    | 127/236 [09:26<10:52,  5.99s/it]
test ppl:  54%|█████▍    | 128/236 [09:28<08:47,  4.89s/it]
test ppl:  55%|█████▍    | 129/236 [09:31<07:59,  4.48s/it]
test ppl:  55%|█████▌    | 130/236 [09:35<07:21,  4.16s/it]
test ppl:  56%|█████▌    | 131/236 [09:42<08:55,  5.10s/it]
test ppl:  56%|█████▌    | 132/236 [09:49<09:59,  5.77s/it]
test ppl:  56%|█████▋    | 133/236 [09:54<09:25,  5.49s/it]
test ppl:  57%|█████▋    | 134/236 [09:59<08:57,  5.27s/it]
test ppl:  57%|█████▋    | 135/236 [10:06<09:54,  5.89s/it]
test ppl:  58%|█████▊    | 136/236 [10:08<07:41,  4.61s/it]
test ppl:  58%|█████▊    | 137/236 [10:15<08:57,  5.43s/it]
test ppl:  58%|█████▊    | 138/236 [10:20<08:25,  5.16s/it]
test ppl:  59%|█████▉    | 139/236 [10:22<06:54,  4.27s/it]
test ppl:  59%|█████▉    | 140/236 [10:24<05:47,  3.62s/it]
test ppl:  60%|█████▉    | 141/236 [10:29<06:17,  3.97s/it]
test ppl:  60%|██████    | 142/236 [10:32<05:35,  3.57s/it]
test ppl:  61%|██████    | 143/236 [10:35<05:23,  3.48s/it]
test ppl:  61%|██████    | 144/236 [10:38<05:16,  3.44s/it]
test ppl:  61%|██████▏   | 145/236 [10:44<06:06,  4.03s/it]
test ppl:  62%|██████▏   | 146/236 [10:50<07:18,  4.87s/it]
test ppl:  62%|██████▏   | 147/236 [10:58<08:18,  5.60s/it]
test ppl:  63%|██████▎   | 148/236 [11:05<09:01,  6.15s/it]
test ppl:  63%|██████▎   | 149/236 [11:12<09:25,  6.50s/it]
test ppl:  64%|██████▎   | 150/236 [11:20<09:40,  6.75s/it]
test ppl:  64%|██████▍   | 151/236 [11:27<09:47,  6.91s/it]
test ppl:  64%|██████▍   | 152/236 [11:34<09:50,  7.03s/it]
test ppl:  65%|██████▍   | 153/236 [11:40<09:06,  6.58s/it]
test ppl:  65%|██████▌   | 154/236 [11:42<07:01,  5.14s/it]
test ppl:  66%|██████▌   | 155/236 [11:45<06:11,  4.58s/it]
test ppl:  66%|██████▌   | 156/236 [11:48<05:27,  4.09s/it]
test ppl:  67%|██████▋   | 157/236 [11:50<04:27,  3.39s/it]
test ppl:  67%|██████▋   | 158/236 [11:57<05:55,  4.56s/it]
test ppl:  67%|██████▋   | 159/236 [12:04<06:54,  5.38s/it]
test ppl:  68%|██████▊   | 160/236 [12:07<05:42,  4.50s/it]
test ppl:  68%|██████▊   | 161/236 [12:08<04:34,  3.66s/it]
test ppl:  69%|██████▊   | 162/236 [12:12<04:35,  3.72s/it]
test ppl:  69%|██████▉   | 163/236 [12:14<03:53,  3.19s/it]
test ppl:  69%|██████▉   | 164/236 [12:20<04:47,  4.00s/it]
test ppl:  70%|██████▉   | 165/236 [12:24<04:37,  3.91s/it]
test ppl:  70%|███████   | 166/236 [12:26<03:50,  3.29s/it]
test ppl:  71%|███████   | 167/236 [12:27<03:16,  2.85s/it]
test ppl:  71%|███████   | 168/236 [12:35<04:44,  4.19s/it]
test ppl:  72%|███████▏  | 169/236 [12:40<05:04,  4.55s/it]
test ppl:  72%|███████▏  | 170/236 [12:48<05:56,  5.40s/it]
test ppl:  72%|███████▏  | 171/236 [12:49<04:37,  4.27s/it]
test ppl:  73%|███████▎  | 172/236 [12:57<05:32,  5.19s/it]
test ppl:  73%|███████▎  | 173/236 [13:00<04:48,  4.58s/it]
test ppl:  74%|███████▎  | 174/236 [13:07<05:35,  5.40s/it]
test ppl:  74%|███████▍  | 175/236 [13:09<04:20,  4.28s/it]
test ppl:  75%|███████▍  | 176/236 [13:16<05:10,  5.18s/it]
test ppl:  75%|███████▌  | 177/236 [13:23<05:43,  5.82s/it]
test ppl:  75%|███████▌  | 178/236 [13:31<06:04,  6.28s/it]
test ppl:  76%|███████▌  | 179/236 [13:38<06:15,  6.59s/it]
test ppl:  76%|███████▋  | 180/236 [13:43<05:47,  6.20s/it]
test ppl:  77%|███████▋  | 181/236 [13:50<05:43,  6.24s/it]
test ppl:  77%|███████▋  | 182/236 [13:52<04:33,  5.07s/it]
test ppl:  78%|███████▊  | 183/236 [13:54<03:39,  4.14s/it]
test ppl:  78%|███████▊  | 184/236 [13:56<02:57,  3.42s/it]
test ppl:  78%|███████▊  | 185/236 [14:02<03:38,  4.29s/it]
test ppl:  79%|███████▉  | 186/236 [14:04<02:59,  3.58s/it]
test ppl:  79%|███████▉  | 187/236 [14:06<02:29,  3.05s/it]
test ppl:  80%|███████▉  | 188/236 [14:12<03:09,  3.94s/it]
test ppl:  80%|████████  | 189/236 [14:18<03:34,  4.56s/it]
test ppl:  81%|████████  | 190/236 [14:24<03:46,  4.93s/it]
test ppl:  81%|████████  | 191/236 [14:28<03:38,  4.87s/it]
test ppl:  81%|████████▏ | 192/236 [14:31<03:13,  4.39s/it]
test ppl:  82%|████████▏ | 193/236 [14:39<03:46,  5.28s/it]
test ppl:  82%|████████▏ | 194/236 [14:42<03:16,  4.67s/it]
test ppl:  83%|████████▎ | 195/236 [14:45<02:49,  4.12s/it]
test ppl:  83%|████████▎ | 196/236 [14:47<02:25,  3.65s/it]
test ppl:  83%|████████▎ | 197/236 [14:50<02:10,  3.34s/it]
test ppl:  84%|████████▍ | 198/236 [14:57<02:52,  4.54s/it]
test ppl:  84%|████████▍ | 199/236 [15:01<02:34,  4.19s/it]
test ppl:  85%|████████▍ | 200/236 [15:08<03:04,  5.12s/it]
test ppl:  85%|████████▌ | 201/236 [15:11<02:38,  4.54s/it]
test ppl:  86%|████████▌ | 202/236 [15:19<03:01,  5.35s/it]
test ppl:  86%|████████▌ | 203/236 [15:26<03:16,  5.94s/it]
test ppl:  86%|████████▋ | 204/236 [15:28<02:33,  4.80s/it]
test ppl:  87%|████████▋ | 205/236 [15:35<02:52,  5.57s/it]
test ppl:  87%|████████▋ | 206/236 [15:39<02:33,  5.12s/it]
test ppl:  88%|████████▊ | 207/236 [15:47<02:47,  5.77s/it]
test ppl:  88%|████████▊ | 208/236 [15:50<02:21,  5.06s/it]
test ppl:  89%|████████▊ | 209/236 [15:58<02:35,  5.76s/it]
test ppl:  89%|████████▉ | 210/236 [16:00<02:07,  4.90s/it]
test ppl:  89%|████████▉ | 211/236 [16:06<02:09,  5.19s/it]
test ppl:  90%|████████▉ | 212/236 [16:13<02:12,  5.52s/it]
test ppl:  90%|█████████ | 213/236 [16:20<02:19,  6.05s/it]
test ppl:  91%|█████████ | 214/236 [16:21<01:43,  4.72s/it]
test ppl:  91%|█████████ | 215/236 [16:29<01:55,  5.50s/it]
test ppl:  92%|█████████▏| 216/236 [16:31<01:29,  4.46s/it]
test ppl:  92%|█████████▏| 217/236 [16:38<01:41,  5.34s/it]
test ppl:  92%|█████████▏| 218/236 [16:46<01:47,  5.95s/it]
test ppl:  93%|█████████▎| 219/236 [16:53<01:48,  6.36s/it]
test ppl:  93%|█████████▎| 220/236 [17:00<01:46,  6.64s/it]
test ppl:  94%|█████████▎| 221/236 [17:02<01:19,  5.32s/it]
test ppl:  94%|█████████▍| 222/236 [17:10<01:22,  5.92s/it]
test ppl:  94%|█████████▍| 223/236 [17:17<01:22,  6.34s/it]
test ppl:  95%|█████████▍| 224/236 [17:20<01:02,  5.24s/it]
test ppl:  95%|█████████▌| 225/236 [17:27<01:04,  5.85s/it]
test ppl:  96%|█████████▌| 226/236 [17:30<00:50,  5.08s/it]
test ppl:  96%|█████████▌| 227/236 [17:34<00:42,  4.74s/it]
test ppl:  97%|█████████▋| 228/236 [17:37<00:32,  4.03s/it]
test ppl:  97%|█████████▋| 229/236 [17:44<00:35,  5.01s/it]
test ppl:  97%|█████████▋| 230/236 [17:48<00:28,  4.78s/it]
test ppl:  98%|█████████▊| 231/236 [17:52<00:22,  4.59s/it]
test ppl:  98%|█████████▊| 232/236 [17:55<00:15,  3.89s/it]
test ppl:  99%|█████████▊| 233/236 [17:58<00:11,  3.79s/it]
test ppl:  99%|█████████▉| 234/236 [18:00<00:06,  3.07s/it]
test ppl: 100%|█████████▉| 235/236 [18:07<00:04,  4.34s/it]
test ppl: 100%|██████████| 236/236 [18:08<00:00,  3.28s/it]
test ppl: 100%|██████████| 236/236 [18:08<00:00,  4.61s/it]
10/12/2024 20:04:02 - INFO - __main__ -    em: 0.1998
10/12/2024 20:04:02 - INFO - __main__ -   Finish and take 19m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.6 100:  em: 0.1998

--------------------------------------------------------------------------------
Running experiment with knn_temp=60, lmbda=0.2, k=16
2024-10-12 21:05:06.041612: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 21:05:06.061280: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 21:05:06.083151: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 21:05:06.089857: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 21:05:06.105880: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 21:05:07.101196: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 21:05:08 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.2, knn_temp=60, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 21:05:08 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:40:04,  2.20it/s]
Adding feature api:   4%|▍         | 7193/187062 [00:00<00:10, 17172.29it/s]
Adding feature api:   8%|▊         | 15441/187062 [00:00<00:05, 33777.14it/s]
Adding feature api:  13%|█▎        | 23782/187062 [00:00<00:03, 47002.00it/s]
Adding feature api:  17%|█▋        | 32073/187062 [00:00<00:02, 56901.71it/s]
Adding feature api:  22%|██▏       | 40408/187062 [00:00<00:02, 64373.30it/s]
Adding feature api:  26%|██▌       | 48730/187062 [00:01<00:01, 69792.51it/s]
Adding feature api:  31%|███       | 57093/187062 [00:01<00:01, 73821.35it/s]
Adding feature api:  35%|███▍      | 65436/187062 [00:01<00:01, 76643.44it/s]
Adding feature api:  39%|███▉      | 73844/187062 [00:01<00:01, 78840.44it/s]
Adding feature api:  44%|████▍     | 82228/187062 [00:01<00:01, 80323.14it/s]
Adding feature api:  48%|████▊     | 90583/187062 [00:01<00:01, 81283.12it/s]
Adding feature api:  53%|█████▎    | 98990/187062 [00:01<00:01, 82114.08it/s]
Adding feature api:  57%|█████▋    | 107403/187062 [00:01<00:00, 82714.65it/s]
Adding feature api:  62%|██████▏   | 115761/187062 [00:01<00:00, 81648.50it/s]
Adding feature api:  66%|██████▋   | 124103/187062 [00:01<00:00, 82171.39it/s]
Adding feature api:  71%|███████   | 132437/187062 [00:02<00:00, 82517.74it/s]
Adding feature api:  75%|███████▌  | 140756/187062 [00:02<00:00, 82714.79it/s]
Adding feature api:  80%|███████▉  | 149090/187062 [00:02<00:00, 82899.40it/s]
Adding feature api:  84%|████████▍ | 157444/187062 [00:02<00:00, 83088.39it/s]
Adding feature api:  89%|████████▊ | 165829/187062 [00:02<00:00, 83313.52it/s]
Adding feature api:  93%|█████████▎| 174200/187062 [00:02<00:00, 83431.70it/s]
Adding feature api:  98%|█████████▊| 182549/187062 [00:02<00:00, 61030.85it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 63989.36it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:46:05,  2.19it/s]
Adding feature datatype:   4%|▎         | 7011/187062 [00:00<00:10, 16683.80it/s]
Adding feature datatype:   8%|▊         | 14986/187062 [00:00<00:05, 32684.23it/s]
Adding feature datatype:  12%|█▏        | 23041/187062 [00:00<00:03, 45416.25it/s]
Adding feature datatype:  17%|█▋        | 31059/187062 [00:00<00:02, 54988.87it/s]
Adding feature datatype:  21%|██        | 39120/187062 [00:00<00:02, 62221.34it/s]
Adding feature datatype:  25%|██▌       | 47161/187062 [00:01<00:02, 67447.56it/s]
Adding feature datatype:  30%|██▉       | 55187/187062 [00:01<00:01, 71174.41it/s]
Adding feature datatype:  34%|███▍      | 63283/187062 [00:01<00:01, 74046.37it/s]
Adding feature datatype:  38%|███▊      | 71398/187062 [00:01<00:01, 76145.29it/s]
Adding feature datatype:  42%|████▏     | 79462/187062 [00:01<00:01, 77476.95it/s]
Adding feature datatype:  47%|████▋     | 87502/187062 [00:01<00:01, 78344.20it/s]
Adding feature datatype:  51%|█████     | 95573/187062 [00:01<00:01, 79048.42it/s]
Adding feature datatype:  55%|█████▌    | 103677/187062 [00:01<00:01, 79641.41it/s]
Adding feature datatype:  60%|█████▉    | 111738/187062 [00:01<00:00, 79929.20it/s]
Adding feature datatype:  64%|██████▍   | 119790/187062 [00:01<00:00, 79924.12it/s]
Adding feature datatype:  68%|██████▊   | 127867/187062 [00:02<00:00, 80174.55it/s]
Adding feature datatype:  73%|███████▎  | 135921/187062 [00:02<00:00, 80282.84it/s]
Adding feature datatype:  77%|███████▋  | 143970/187062 [00:02<00:00, 80304.43it/s]
Adding feature datatype:  81%|████████▏ | 152015/187062 [00:02<00:00, 80292.66it/s]
Adding feature datatype:  86%|████████▌ | 160073/187062 [00:02<00:00, 80375.78it/s]
Adding feature datatype:  90%|████████▉ | 168149/187062 [00:02<00:00, 80488.19it/s]
Adding feature datatype:  94%|█████████▍| 176260/187062 [00:02<00:00, 80672.37it/s]
Adding feature datatype:  99%|█████████▊| 184331/187062 [00:02<00:00, 54919.22it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 62392.82it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:51:54,  2.18it/s]
Adding feature literal:   4%|▎         | 6975/187062 [00:00<00:10, 16546.38it/s]
Adding feature literal:   8%|▊         | 14886/187062 [00:00<00:05, 32382.25it/s]
Adding feature literal:  12%|█▏        | 22851/187062 [00:00<00:03, 44934.32it/s]
Adding feature literal:  16%|█▋        | 30846/187062 [00:00<00:02, 54564.42it/s]
Adding feature literal:  21%|██        | 38861/187062 [00:00<00:02, 61779.14it/s]
Adding feature literal:  25%|██▌       | 46995/187062 [00:01<00:02, 67395.92it/s]
Adding feature literal:  29%|██▉       | 55090/187062 [00:01<00:01, 71338.75it/s]
Adding feature literal:  34%|███▍      | 63155/187062 [00:01<00:01, 74071.81it/s]
Adding feature literal:  38%|███▊      | 71042/187062 [00:01<00:01, 75264.54it/s]
Adding feature literal:  42%|████▏     | 78905/187062 [00:01<00:01, 71764.09it/s]
Adding feature literal:  46%|████▌     | 86348/187062 [00:01<00:01, 69647.16it/s]
Adding feature literal:  50%|█████     | 94427/187062 [00:01<00:01, 72777.14it/s]
Adding feature literal:  55%|█████▍    | 102505/187062 [00:01<00:01, 75068.09it/s]
Adding feature literal:  59%|█████▉    | 110614/187062 [00:01<00:00, 76814.15it/s]
Adding feature literal:  63%|██████▎   | 118736/187062 [00:01<00:00, 78103.38it/s]
Adding feature literal:  68%|██████▊   | 126836/187062 [00:02<00:00, 78956.92it/s]
Adding feature literal:  72%|███████▏  | 134921/187062 [00:02<00:00, 79517.09it/s]
Adding feature literal:  76%|███████▋  | 142988/187062 [00:02<00:00, 79857.46it/s]
Adding feature literal:  81%|████████  | 151094/187062 [00:02<00:00, 80215.13it/s]
Adding feature literal:  85%|████████▌ | 159230/187062 [00:02<00:00, 80555.25it/s]
Adding feature literal:  89%|████████▉ | 167299/187062 [00:02<00:00, 80581.68it/s]
Adding feature literal:  94%|█████████▎| 175366/187062 [00:02<00:00, 80014.52it/s]
Adding feature literal:  98%|█████████▊| 183375/187062 [00:02<00:00, 57002.99it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 61431.03it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:40:47,  2.19it/s]
Adding feature operator:   4%|▍         | 7030/187062 [00:00<00:10, 16776.61it/s]
Adding feature operator:   8%|▊         | 15039/187062 [00:00<00:05, 32873.18it/s]
Adding feature operator:  12%|█▏        | 23143/187062 [00:00<00:03, 45705.63it/s]
Adding feature operator:  17%|█▋        | 31269/187062 [00:00<00:02, 55505.36it/s]
Adding feature operator:  21%|██        | 39126/187062 [00:00<00:02, 62021.73it/s]
Adding feature operator:  25%|██▌       | 47248/187062 [00:01<00:02, 67541.52it/s]
Adding feature operator:  30%|██▉       | 55399/187062 [00:01<00:01, 71606.43it/s]
Adding feature operator:  34%|███▍      | 63609/187062 [00:01<00:01, 74688.64it/s]
Adding feature operator:  38%|███▊      | 71782/187062 [00:01<00:01, 76768.62it/s]
Adding feature operator:  43%|████▎     | 79968/187062 [00:01<00:01, 78279.48it/s]
Adding feature operator:  47%|████▋     | 88153/187062 [00:01<00:01, 79339.35it/s]
Adding feature operator:  51%|█████▏    | 96285/187062 [00:01<00:01, 79927.63it/s]
Adding feature operator:  56%|█████▌    | 104405/187062 [00:01<00:01, 80305.92it/s]
Adding feature operator:  60%|██████    | 112536/187062 [00:01<00:00, 80603.93it/s]
Adding feature operator:  65%|██████▍   | 120656/187062 [00:01<00:00, 80776.05it/s]
Adding feature operator:  69%|██████▉   | 128775/187062 [00:02<00:00, 80841.65it/s]
Adding feature operator:  73%|███████▎  | 136888/187062 [00:02<00:00, 80797.00it/s]
Adding feature operator:  78%|███████▊  | 144988/187062 [00:02<00:00, 80150.67it/s]
Adding feature operator:  82%|████████▏ | 153167/187062 [00:02<00:00, 80636.85it/s]
Adding feature operator:  86%|████████▌ | 161249/187062 [00:02<00:00, 80688.20it/s]
Adding feature operator:  91%|█████████ | 169404/187062 [00:02<00:00, 80943.07it/s]
Adding feature operator:  95%|█████████▍| 177585/187062 [00:02<00:00, 81199.06it/s]
Adding feature operator:  99%|█████████▉| 185709/187062 [00:02<00:00, 53318.12it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 62834.00it/s]
[2024-10-12 21:05:52,178] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 21:05:53 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 21:05:53 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 41/6548 [00:00<00:16, 391.06 examples/s]
Map:   1%|▏         | 90/6548 [00:00<00:26, 246.40 examples/s]
Map:   2%|▏         | 127/6548 [00:00<00:22, 282.96 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:19, 332.49 examples/s]
Map:   3%|▎         | 223/6548 [00:00<00:17, 368.19 examples/s]
Map:   4%|▍         | 283/6548 [00:00<00:17, 366.67 examples/s]
Map:   5%|▍         | 327/6548 [00:01<00:19, 319.32 examples/s]
Map:   6%|▌         | 364/6548 [00:01<00:18, 328.41 examples/s]
Map:   6%|▋         | 418/6548 [00:01<00:16, 378.80 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:17, 351.27 examples/s]
Map:   8%|▊         | 511/6548 [00:01<00:16, 358.00 examples/s]
Map:   9%|▊         | 565/6548 [00:01<00:14, 399.93 examples/s]
Map:   9%|▉         | 618/6548 [00:01<00:15, 378.11 examples/s]
Map:  10%|█         | 660/6548 [00:01<00:17, 337.18 examples/s]
Map:  11%|█         | 701/6548 [00:02<00:16, 351.89 examples/s]
Map:  11%|█▏        | 739/6548 [00:02<00:16, 356.64 examples/s]
Map:  12%|█▏        | 793/6548 [00:02<00:14, 401.63 examples/s]
Map:  13%|█▎        | 854/6548 [00:02<00:14, 394.38 examples/s]
Map:  14%|█▍        | 909/6548 [00:02<00:14, 378.49 examples/s]
Map:  14%|█▍        | 949/6548 [00:02<00:14, 382.03 examples/s]
Map:  15%|█▌        | 995/6548 [00:02<00:16, 338.94 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:23, 230.81 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:21, 257.15 examples/s]
Map:  17%|█▋        | 1123/6548 [00:03<00:18, 297.26 examples/s]
Map:  18%|█▊        | 1163/6548 [00:03<00:16, 318.64 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 339.35 examples/s]
Map:  19%|█▉        | 1262/6548 [00:03<00:15, 344.65 examples/s]
Map:  20%|█▉        | 1301/6548 [00:03<00:14, 350.44 examples/s]
Map:  21%|██        | 1355/6548 [00:04<00:15, 329.29 examples/s]
Map:  21%|██▏       | 1401/6548 [00:04<00:16, 319.49 examples/s]
Map:  22%|██▏       | 1436/6548 [00:04<00:17, 295.06 examples/s]
Map:  22%|██▏       | 1469/6548 [00:04<00:16, 300.74 examples/s]
Map:  23%|██▎       | 1521/6548 [00:04<00:15, 314.58 examples/s]
Map:  24%|██▍       | 1568/6548 [00:04<00:16, 307.30 examples/s]
Map:  25%|██▍       | 1610/6548 [00:04<00:17, 284.12 examples/s]
Map:  25%|██▌       | 1643/6548 [00:05<00:16, 292.43 examples/s]
Map:  26%|██▌       | 1675/6548 [00:05<00:18, 258.14 examples/s]
Map:  26%|██▌       | 1716/6548 [00:05<00:16, 287.74 examples/s]
Map:  27%|██▋       | 1752/6548 [00:05<00:15, 301.92 examples/s]
Map:  27%|██▋       | 1791/6548 [00:05<00:14, 319.79 examples/s]
Map:  28%|██▊       | 1829/6548 [00:05<00:14, 326.36 examples/s]
Map:  29%|██▊       | 1878/6548 [00:05<00:15, 309.51 examples/s]
Map:  29%|██▉       | 1913/6548 [00:05<00:14, 317.83 examples/s]
Map:  30%|██▉       | 1958/6548 [00:06<00:13, 339.19 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:20, 223.58 examples/s]
Map:  31%|███       | 2029/6548 [00:06<00:19, 232.01 examples/s]
Map:  32%|███▏      | 2063/6548 [00:06<00:17, 251.29 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 267.87 examples/s]
Map:  33%|███▎      | 2136/6548 [00:06<00:15, 276.62 examples/s]
Map:  33%|███▎      | 2172/6548 [00:06<00:16, 258.65 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 274.52 examples/s]
Map:  34%|███▍      | 2253/6548 [00:07<00:16, 258.99 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:15, 267.26 examples/s]
Map:  36%|███▌      | 2331/6548 [00:07<00:13, 305.97 examples/s]
Map:  36%|███▋      | 2384/6548 [00:07<00:13, 319.09 examples/s]
Map:  37%|███▋      | 2422/6548 [00:07<00:12, 332.45 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:12, 318.02 examples/s]
Map:  38%|███▊      | 2496/6548 [00:07<00:12, 322.76 examples/s]
Map:  39%|███▊      | 2531/6548 [00:08<00:12, 323.47 examples/s]
Map:  40%|███▉      | 2588/6548 [00:08<00:10, 386.76 examples/s]
Map:  40%|████      | 2647/6548 [00:08<00:10, 386.55 examples/s]
Map:  41%|████      | 2699/6548 [00:08<00:10, 365.84 examples/s]
Map:  42%|████▏     | 2738/6548 [00:08<00:10, 354.43 examples/s]
Map:  42%|████▏     | 2776/6548 [00:08<00:10, 359.42 examples/s]
Map:  43%|████▎     | 2828/6548 [00:08<00:12, 299.52 examples/s]
Map:  44%|████▍     | 2875/6548 [00:09<00:12, 301.17 examples/s]
Map:  45%|████▍     | 2923/6548 [00:09<00:13, 274.90 examples/s]
Map:  45%|████▌     | 2960/6548 [00:09<00:12, 289.43 examples/s]
Map:  46%|████▌     | 2991/6548 [00:09<00:14, 252.96 examples/s]
Map:  46%|████▌     | 3024/6548 [00:09<00:21, 161.44 examples/s]
Map:  47%|████▋     | 3057/6548 [00:10<00:18, 184.14 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 204.37 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 247.14 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:13, 252.65 examples/s]
Map:  49%|████▉     | 3202/6548 [00:10<00:12, 261.83 examples/s]
Map:  50%|████▉     | 3245/6548 [00:10<00:12, 256.91 examples/s]
Map:  50%|█████     | 3280/6548 [00:10<00:11, 273.23 examples/s]
Map:  51%|█████     | 3322/6548 [00:10<00:10, 304.27 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:11<00:10, 303.29 examples/s]
Map:  52%|█████▏    | 3420/6548 [00:11<00:10, 301.95 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:10, 287.51 examples/s]
Map:  53%|█████▎    | 3486/6548 [00:11<00:10, 288.93 examples/s]
Map:  54%|█████▍    | 3533/6548 [00:11<00:09, 330.81 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:11<00:08, 355.80 examples/s]
Map:  55%|█████▌    | 3622/6548 [00:11<00:07, 380.18 examples/s]
Map:  56%|█████▌    | 3683/6548 [00:11<00:07, 386.65 examples/s]
Map:  57%|█████▋    | 3727/6548 [00:12<00:07, 398.57 examples/s]
Map:  58%|█████▊    | 3776/6548 [00:12<00:07, 371.77 examples/s]
Map:  58%|█████▊    | 3816/6548 [00:12<00:07, 376.63 examples/s]
Map:  59%|█████▉    | 3862/6548 [00:12<00:07, 339.35 examples/s]
Map:  60%|█████▉    | 3898/6548 [00:12<00:07, 341.66 examples/s]
Map:  60%|██████    | 3947/6548 [00:12<00:07, 331.04 examples/s]
Map:  61%|██████    | 3994/6548 [00:12<00:07, 363.10 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:09, 261.72 examples/s]
Map:  63%|██████▎   | 4096/6548 [00:13<00:08, 289.13 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:08, 301.43 examples/s]
Map:  64%|██████▍   | 4194/6548 [00:13<00:07, 310.69 examples/s]
Map:  65%|██████▍   | 4230/6548 [00:13<00:07, 303.21 examples/s]
Map:  65%|██████▌   | 4272/6548 [00:13<00:06, 328.14 examples/s]
Map:  66%|██████▌   | 4308/6548 [00:13<00:06, 333.48 examples/s]
Map:  66%|██████▋   | 4346/6548 [00:14<00:06, 334.57 examples/s]
Map:  67%|██████▋   | 4394/6548 [00:14<00:06, 325.80 examples/s]
Map:  68%|██████▊   | 4435/6548 [00:14<00:06, 343.96 examples/s]
Map:  68%|██████▊   | 4483/6548 [00:14<00:06, 322.97 examples/s]
Map:  69%|██████▉   | 4530/6548 [00:14<00:06, 309.12 examples/s]
Map:  70%|██████▉   | 4572/6548 [00:14<00:05, 332.07 examples/s]
Map:  70%|███████   | 4610/6548 [00:14<00:05, 331.75 examples/s]
Map:  71%|███████   | 4658/6548 [00:14<00:05, 368.44 examples/s]
Map:  72%|███████▏  | 4706/6548 [00:15<00:05, 349.66 examples/s]
Map:  73%|███████▎  | 4750/6548 [00:15<00:04, 362.01 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 413.13 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 400.03 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 365.22 examples/s]
Map:  76%|███████▌  | 4958/6548 [00:15<00:03, 402.92 examples/s]
Map:  76%|███████▋  | 5004/6548 [00:16<00:06, 234.39 examples/s]
Map:  77%|███████▋  | 5043/6548 [00:16<00:05, 259.81 examples/s]
Map:  78%|███████▊  | 5084/6548 [00:16<00:05, 255.30 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 263.13 examples/s]
Map:  79%|███████▊  | 5155/6548 [00:16<00:05, 258.89 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:05, 258.05 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:16<00:04, 278.10 examples/s]
Map:  80%|████████  | 5256/6548 [00:17<00:04, 286.36 examples/s]
Map:  81%|████████  | 5305/6548 [00:17<00:03, 337.54 examples/s]
Map:  82%|████████▏ | 5346/6548 [00:17<00:04, 289.27 examples/s]
Map:  82%|████████▏ | 5383/6548 [00:17<00:03, 307.58 examples/s]
Map:  83%|████████▎ | 5429/6548 [00:17<00:03, 290.39 examples/s]
Map:  84%|████████▎ | 5472/6548 [00:17<00:03, 316.73 examples/s]
Map:  84%|████████▍ | 5520/6548 [00:17<00:03, 303.05 examples/s]
Map:  85%|████████▍ | 5562/6548 [00:17<00:03, 323.73 examples/s]
Map:  86%|████████▌ | 5610/6548 [00:18<00:03, 309.10 examples/s]
Map:  86%|████████▌ | 5647/6548 [00:18<00:02, 318.64 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 306.52 examples/s]
Map:  87%|████████▋ | 5720/6548 [00:18<00:02, 326.01 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 344.93 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 349.70 examples/s]
Map:  89%|████████▉ | 5843/6548 [00:18<00:02, 345.09 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:18<00:01, 348.16 examples/s]
Map:  90%|█████████ | 5923/6548 [00:19<00:01, 357.86 examples/s]
Map:  91%|█████████ | 5967/6548 [00:19<00:01, 329.57 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 238.77 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 269.07 examples/s]
Map:  94%|█████████▎| 6124/6548 [00:19<00:01, 267.94 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:19<00:01, 285.13 examples/s]
Map:  95%|█████████▍| 6207/6548 [00:20<00:01, 308.68 examples/s]
Map:  95%|█████████▌| 6249/6548 [00:20<00:00, 330.13 examples/s]
Map:  96%|█████████▋| 6305/6548 [00:20<00:00, 342.43 examples/s]
Map:  97%|█████████▋| 6367/6548 [00:20<00:00, 357.51 examples/s]
Map:  98%|█████████▊| 6410/6548 [00:20<00:00, 371.46 examples/s]
Map:  99%|█████████▊| 6459/6548 [00:20<00:00, 393.46 examples/s]
Map:  99%|█████████▉| 6515/6548 [00:20<00:00, 381.40 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 310.76 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   3%|▎         | 30/903 [00:00<00:03, 276.52 examples/s]
Map:   7%|▋         | 62/903 [00:00<00:02, 291.28 examples/s]
Map:  11%|█         | 96/903 [00:00<00:02, 309.52 examples/s]
Map:  15%|█▍        | 133/903 [00:00<00:02, 327.41 examples/s]
Map:  20%|██        | 184/903 [00:00<00:01, 382.72 examples/s]
Map:  25%|██▌       | 230/903 [00:00<00:01, 387.00 examples/s]
Map:  30%|██▉       | 270/903 [00:00<00:01, 390.22 examples/s]
Map:  34%|███▍      | 310/903 [00:00<00:01, 380.59 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 317.93 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 308.25 examples/s]
Map:  51%|█████     | 460/903 [00:01<00:01, 308.07 examples/s]
Map:  57%|█████▋    | 516/903 [00:01<00:01, 323.75 examples/s]
Map:  62%|██████▏   | 561/903 [00:01<00:00, 345.57 examples/s]
Map:  68%|██████▊   | 612/903 [00:01<00:00, 383.85 examples/s]
Map:  74%|███████▎  | 665/903 [00:01<00:00, 363.39 examples/s]
Map:  78%|███████▊  | 708/903 [00:02<00:00, 372.94 examples/s]
Map:  85%|████████▍ | 765/903 [00:02<00:00, 418.32 examples/s]
Map:  91%|█████████ | 820/903 [00:02<00:00, 393.40 examples/s]
Map:  95%|█████████▌| 862/903 [00:02<00:00, 389.54 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 236.44 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 326.38 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 298.37 examples/s]
Map:   4%|▍         | 82/1882 [00:00<00:04, 372.96 examples/s]
Map:   7%|▋         | 125/1882 [00:00<00:05, 315.16 examples/s]
Map:   9%|▉         | 169/1882 [00:00<00:04, 352.22 examples/s]
Map:  12%|█▏        | 229/1882 [00:00<00:04, 359.60 examples/s]
Map:  14%|█▍        | 271/1882 [00:00<00:04, 373.11 examples/s]
Map:  16%|█▋        | 310/1882 [00:00<00:04, 365.69 examples/s]
Map:  19%|█▊        | 350/1882 [00:00<00:04, 370.62 examples/s]
Map:  21%|██        | 393/1882 [00:01<00:04, 325.64 examples/s]
Map:  23%|██▎       | 439/1882 [00:01<00:04, 316.76 examples/s]
Map:  25%|██▌       | 474/1882 [00:01<00:04, 323.88 examples/s]
Map:  27%|██▋       | 508/1882 [00:01<00:04, 321.37 examples/s]
Map:  29%|██▉       | 545/1882 [00:01<00:04, 332.49 examples/s]
Map:  31%|███▏      | 590/1882 [00:01<00:03, 360.92 examples/s]
Map:  34%|███▍      | 646/1882 [00:01<00:03, 411.95 examples/s]
Map:  37%|███▋      | 704/1882 [00:01<00:02, 393.04 examples/s]
Map:  41%|████      | 768/1882 [00:02<00:02, 399.95 examples/s]
Map:  44%|████▍     | 829/1882 [00:02<00:02, 355.98 examples/s]
Map:  47%|████▋     | 879/1882 [00:02<00:02, 344.93 examples/s]
Map:  49%|████▉     | 919/1882 [00:02<00:02, 356.41 examples/s]
Map:  51%|█████▏    | 967/1882 [00:02<00:02, 383.88 examples/s]
Map:  54%|█████▍    | 1017/1882 [00:03<00:03, 250.04 examples/s]
Map:  56%|█████▌    | 1053/1882 [00:03<00:03, 269.03 examples/s]
Map:  58%|█████▊    | 1094/1882 [00:03<00:02, 268.26 examples/s]
Map:  60%|█████▉    | 1129/1882 [00:03<00:02, 282.08 examples/s]
Map:  62%|██████▏   | 1164/1882 [00:03<00:02, 293.22 examples/s]
Map:  64%|██████▍   | 1203/1882 [00:03<00:02, 267.60 examples/s]
Map:  66%|██████▌   | 1244/1882 [00:03<00:02, 297.14 examples/s]
Map:  68%|██████▊   | 1282/1882 [00:03<00:01, 315.96 examples/s]
Map:  71%|███████   | 1334/1882 [00:04<00:01, 358.02 examples/s]
Map:  73%|███████▎  | 1381/1882 [00:04<00:01, 338.16 examples/s]
Map:  76%|███████▌  | 1425/1882 [00:04<00:01, 313.08 examples/s]
Map:  78%|███████▊  | 1462/1882 [00:04<00:01, 325.45 examples/s]
Map:  80%|████████  | 1506/1882 [00:04<00:01, 277.95 examples/s]
Map:  82%|████████▏ | 1537/1882 [00:04<00:01, 284.00 examples/s]
Map:  83%|████████▎ | 1569/1882 [00:04<00:01, 291.09 examples/s]
Map:  86%|████████▌ | 1618/1882 [00:04<00:00, 339.86 examples/s]
Map:  89%|████████▊ | 1666/1882 [00:05<00:00, 324.06 examples/s]
Map:  91%|█████████ | 1717/1882 [00:05<00:00, 321.54 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 283.02 examples/s]
Map:  96%|█████████▌| 1799/1882 [00:05<00:00, 286.71 examples/s]
Map:  98%|█████████▊| 1843/1882 [00:05<00:00, 317.30 examples/s]
Map: 100%|██████████| 1882/1882 [00:05<00:00, 230.80 examples/s]
Map: 100%|██████████| 1882/1882 [00:05<00:00, 313.69 examples/s]
10/12/2024 21:06:55 - INFO - __main__ -     ***** Testing *****
10/12/2024 21:06:55 - INFO - __main__ -     Batch size = 8
10/12/2024 21:06:55 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 21:06:55 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 21:06:55 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 21:06:56 - INFO - knnlm -   Reading datastore took 0.9762022495269775 s
10/12/2024 21:06:57 - INFO - knnlm -   Moving index to GPU took 0.9898014068603516 s
10/12/2024 21:06:57 - INFO - __main__ -   ******************************break-into
10/12/2024 21:06:57 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 21:06:57 - INFO - __main__ -     Num examples = 236
10/12/2024 21:06:57 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<31:26,  8.03s/it]
test ppl:   1%|          | 2/236 [00:10<17:27,  4.48s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:09,  3.13s/it]
test ppl:   2%|▏         | 4/236 [00:13<09:53,  2.56s/it]
test ppl:   2%|▏         | 5/236 [00:19<14:34,  3.79s/it]
test ppl:   3%|▎         | 6/236 [00:21<12:36,  3.29s/it]
test ppl:   3%|▎         | 7/236 [00:24<11:38,  3.05s/it]
test ppl:   3%|▎         | 8/236 [00:28<13:09,  3.46s/it]
test ppl:   4%|▍         | 9/236 [00:34<15:59,  4.23s/it]
test ppl:   4%|▍         | 10/236 [00:37<14:26,  3.84s/it]
test ppl:   5%|▍         | 11/236 [00:39<12:42,  3.39s/it]
test ppl:   5%|▌         | 12/236 [00:45<15:30,  4.15s/it]
test ppl:   6%|▌         | 13/236 [00:51<17:25,  4.69s/it]
test ppl:   6%|▌         | 14/236 [00:57<18:44,  5.06s/it]
test ppl:   6%|▋         | 15/236 [01:00<16:05,  4.37s/it]
test ppl:   7%|▋         | 16/236 [01:02<13:15,  3.62s/it]
test ppl:   7%|▋         | 17/236 [01:07<15:43,  4.31s/it]
test ppl:   8%|▊         | 18/236 [01:09<12:48,  3.53s/it]
test ppl:   8%|▊         | 19/236 [01:14<13:46,  3.81s/it]
test ppl:   8%|▊         | 20/236 [01:15<11:31,  3.20s/it]
test ppl:   9%|▉         | 21/236 [01:18<10:30,  2.93s/it]
test ppl:   9%|▉         | 22/236 [01:24<13:40,  3.83s/it]
test ppl:  10%|▉         | 23/236 [01:26<12:13,  3.44s/it]
test ppl:  10%|█         | 24/236 [01:29<11:02,  3.13s/it]
test ppl:  11%|█         | 25/236 [01:30<09:38,  2.74s/it]
test ppl:  11%|█         | 26/236 [01:36<12:57,  3.70s/it]
test ppl:  11%|█▏        | 27/236 [01:41<13:24,  3.85s/it]
test ppl:  12%|█▏        | 28/236 [01:42<10:42,  3.09s/it]
test ppl:  12%|█▏        | 29/236 [01:44<09:52,  2.86s/it]
test ppl:  13%|█▎        | 30/236 [01:46<08:27,  2.46s/it]
test ppl:  13%|█▎        | 31/236 [01:48<07:57,  2.33s/it]
test ppl:  14%|█▎        | 32/236 [01:51<08:29,  2.50s/it]
test ppl:  14%|█▍        | 33/236 [01:57<11:55,  3.53s/it]
test ppl:  14%|█▍        | 34/236 [02:01<12:23,  3.68s/it]
test ppl:  15%|█▍        | 35/236 [02:03<11:12,  3.35s/it]
test ppl:  15%|█▌        | 36/236 [02:09<13:44,  4.12s/it]
test ppl:  16%|█▌        | 37/236 [02:15<15:27,  4.66s/it]
test ppl:  16%|█▌        | 38/236 [02:17<12:49,  3.89s/it]
test ppl:  17%|█▋        | 39/236 [02:19<10:25,  3.18s/it]
test ppl:  17%|█▋        | 40/236 [02:21<09:55,  3.04s/it]
test ppl:  17%|█▋        | 41/236 [02:24<09:23,  2.89s/it]
test ppl:  18%|█▊        | 42/236 [02:30<12:18,  3.81s/it]
test ppl:  18%|█▊        | 43/236 [02:36<14:17,  4.44s/it]
test ppl:  19%|█▊        | 44/236 [02:38<12:10,  3.81s/it]
test ppl:  19%|█▉        | 45/236 [02:40<10:22,  3.26s/it]
test ppl:  19%|█▉        | 46/236 [02:46<12:52,  4.06s/it]
test ppl:  20%|█▉        | 47/236 [02:52<14:35,  4.63s/it]
test ppl:  20%|██        | 48/236 [02:58<15:40,  5.00s/it]
test ppl:  21%|██        | 49/236 [03:04<16:25,  5.27s/it]
test ppl:  21%|██        | 50/236 [03:10<16:59,  5.48s/it]
test ppl:  22%|██▏       | 51/236 [03:16<17:19,  5.62s/it]
test ppl:  22%|██▏       | 52/236 [03:22<17:30,  5.71s/it]
test ppl:  22%|██▏       | 53/236 [03:26<16:13,  5.32s/it]
test ppl:  23%|██▎       | 54/236 [03:28<12:41,  4.19s/it]
test ppl:  23%|██▎       | 55/236 [03:33<13:56,  4.62s/it]
test ppl:  24%|██▎       | 56/236 [03:37<12:46,  4.26s/it]
test ppl:  24%|██▍       | 57/236 [03:39<11:12,  3.76s/it]
test ppl:  25%|██▍       | 58/236 [03:41<09:11,  3.10s/it]
test ppl:  25%|██▌       | 59/236 [03:47<11:36,  3.94s/it]
test ppl:  25%|██▌       | 60/236 [03:50<10:55,  3.73s/it]
test ppl:  26%|██▌       | 61/236 [03:56<12:46,  4.38s/it]
test ppl:  26%|██▋       | 62/236 [04:00<12:29,  4.31s/it]
test ppl:  27%|██▋       | 63/236 [04:02<10:50,  3.76s/it]
test ppl:  27%|██▋       | 64/236 [04:04<08:51,  3.09s/it]
test ppl:  28%|██▊       | 65/236 [04:05<07:17,  2.56s/it]
test ppl:  28%|██▊       | 66/236 [04:08<07:36,  2.68s/it]
test ppl:  28%|██▊       | 67/236 [04:12<08:41,  3.09s/it]
test ppl:  29%|██▉       | 68/236 [04:18<11:00,  3.93s/it]
test ppl:  29%|██▉       | 69/236 [04:23<11:29,  4.13s/it]
test ppl:  30%|██▉       | 70/236 [04:24<09:19,  3.37s/it]
test ppl:  30%|███       | 71/236 [04:28<09:27,  3.44s/it]
test ppl:  31%|███       | 72/236 [04:32<09:44,  3.56s/it]
test ppl:  31%|███       | 73/236 [04:36<09:55,  3.66s/it]
test ppl:  31%|███▏      | 74/236 [04:37<08:08,  3.01s/it]
test ppl:  32%|███▏      | 75/236 [04:43<10:28,  3.91s/it]
test ppl:  32%|███▏      | 76/236 [04:48<10:51,  4.07s/it]
test ppl:  33%|███▎      | 77/236 [04:50<09:22,  3.54s/it]
test ppl:  33%|███▎      | 78/236 [04:52<08:02,  3.05s/it]
test ppl:  33%|███▎      | 79/236 [04:57<09:31,  3.64s/it]
test ppl:  34%|███▍      | 80/236 [04:59<08:08,  3.13s/it]
test ppl:  34%|███▍      | 81/236 [05:05<10:13,  3.96s/it]
test ppl:  35%|███▍      | 82/236 [05:11<11:40,  4.55s/it]
test ppl:  35%|███▌      | 83/236 [05:13<09:38,  3.78s/it]
test ppl:  36%|███▌      | 84/236 [05:14<08:08,  3.22s/it]
test ppl:  36%|███▌      | 85/236 [05:19<08:47,  3.49s/it]
test ppl:  36%|███▋      | 86/236 [05:21<07:45,  3.11s/it]
test ppl:  37%|███▋      | 87/236 [05:23<06:58,  2.81s/it]
test ppl:  37%|███▋      | 88/236 [05:29<09:12,  3.73s/it]
test ppl:  38%|███▊      | 89/236 [05:35<10:44,  4.38s/it]
test ppl:  38%|███▊      | 90/236 [05:41<11:45,  4.83s/it]
test ppl:  39%|███▊      | 91/236 [05:46<12:25,  5.14s/it]
test ppl:  39%|███▉      | 92/236 [05:49<10:39,  4.44s/it]
test ppl:  39%|███▉      | 93/236 [05:55<11:36,  4.87s/it]
test ppl:  40%|███▉      | 94/236 [06:01<12:15,  5.18s/it]
test ppl:  40%|████      | 95/236 [06:03<10:05,  4.30s/it]
test ppl:  41%|████      | 96/236 [06:06<09:05,  3.90s/it]
test ppl:  41%|████      | 97/236 [06:12<10:24,  4.50s/it]
test ppl:  42%|████▏     | 98/236 [06:18<11:18,  4.92s/it]
test ppl:  42%|████▏     | 99/236 [06:24<11:53,  5.21s/it]
test ppl:  42%|████▏     | 100/236 [06:25<09:10,  4.05s/it]
test ppl:  43%|████▎     | 101/236 [06:31<10:21,  4.60s/it]
test ppl:  43%|████▎     | 102/236 [06:35<09:37,  4.31s/it]
test ppl:  44%|████▎     | 103/236 [06:37<08:06,  3.66s/it]
test ppl:  44%|████▍     | 104/236 [06:41<08:27,  3.84s/it]
test ppl:  44%|████▍     | 105/236 [06:45<08:27,  3.87s/it]
test ppl:  45%|████▍     | 106/236 [06:51<09:24,  4.34s/it]
test ppl:  45%|████▌     | 107/236 [06:53<07:51,  3.66s/it]
test ppl:  46%|████▌     | 108/236 [06:58<09:08,  4.28s/it]
test ppl:  46%|████▌     | 109/236 [07:03<09:19,  4.41s/it]
test ppl:  47%|████▋     | 110/236 [07:05<07:37,  3.63s/it]
test ppl:  47%|████▋     | 111/236 [07:09<07:46,  3.73s/it]
test ppl:  47%|████▋     | 112/236 [07:13<08:01,  3.88s/it]
test ppl:  48%|████▊     | 113/236 [07:15<06:39,  3.25s/it]
test ppl:  48%|████▊     | 114/236 [07:18<06:40,  3.28s/it]
test ppl:  49%|████▊     | 115/236 [07:24<08:12,  4.07s/it]
test ppl:  49%|████▉     | 116/236 [07:30<09:03,  4.53s/it]
test ppl:  50%|████▉     | 117/236 [07:32<07:23,  3.73s/it]
test ppl:  50%|█████     | 118/236 [07:36<07:44,  3.93s/it]
test ppl:  50%|█████     | 119/236 [07:39<07:19,  3.75s/it]
test ppl:  51%|█████     | 120/236 [07:41<05:51,  3.03s/it]
test ppl:  51%|█████▏    | 121/236 [07:47<07:27,  3.89s/it]
test ppl:  52%|█████▏    | 122/236 [07:51<07:55,  4.17s/it]
test ppl:  52%|█████▏    | 123/236 [07:54<06:43,  3.57s/it]
test ppl:  53%|█████▎    | 124/236 [07:56<06:13,  3.34s/it]
test ppl:  53%|█████▎    | 125/236 [07:59<05:43,  3.09s/it]
test ppl:  53%|█████▎    | 126/236 [08:04<06:43,  3.66s/it]
test ppl:  54%|█████▍    | 127/236 [08:06<05:41,  3.13s/it]
test ppl:  54%|█████▍    | 128/236 [08:08<05:10,  2.88s/it]
test ppl:  55%|█████▍    | 129/236 [08:11<05:11,  2.91s/it]
test ppl:  55%|█████▌    | 130/236 [08:14<05:12,  2.95s/it]
test ppl:  56%|█████▌    | 131/236 [08:20<06:43,  3.84s/it]
test ppl:  56%|█████▌    | 132/236 [08:22<05:57,  3.44s/it]
test ppl:  56%|█████▋    | 133/236 [08:26<06:09,  3.59s/it]
test ppl:  57%|█████▋    | 134/236 [08:32<07:08,  4.20s/it]
test ppl:  57%|█████▋    | 135/236 [08:38<07:55,  4.70s/it]
test ppl:  58%|█████▊    | 136/236 [08:39<06:07,  3.67s/it]
test ppl:  58%|█████▊    | 137/236 [08:45<07:11,  4.36s/it]
test ppl:  58%|█████▊    | 138/236 [08:48<06:34,  4.02s/it]
test ppl:  59%|█████▉    | 139/236 [08:51<05:48,  3.59s/it]
test ppl:  59%|█████▉    | 140/236 [08:53<04:51,  3.04s/it]
test ppl:  60%|█████▉    | 141/236 [08:58<05:48,  3.67s/it]
test ppl:  60%|██████    | 142/236 [09:00<05:09,  3.29s/it]
test ppl:  61%|██████    | 143/236 [09:06<06:19,  4.08s/it]
test ppl:  61%|██████    | 144/236 [09:09<05:38,  3.68s/it]
test ppl:  61%|██████▏   | 145/236 [09:15<06:26,  4.24s/it]
test ppl:  62%|██████▏   | 146/236 [09:19<06:29,  4.33s/it]
test ppl:  62%|██████▏   | 147/236 [09:25<07:08,  4.81s/it]
test ppl:  63%|██████▎   | 148/236 [09:31<07:35,  5.18s/it]
test ppl:  63%|██████▎   | 149/236 [09:34<06:43,  4.64s/it]
test ppl:  64%|██████▎   | 150/236 [09:38<06:22,  4.45s/it]
test ppl:  64%|██████▍   | 151/236 [09:44<06:55,  4.89s/it]
test ppl:  64%|██████▍   | 152/236 [09:50<07:15,  5.19s/it]
test ppl:  65%|██████▍   | 153/236 [09:56<07:28,  5.40s/it]
test ppl:  65%|██████▌   | 154/236 [09:59<06:12,  4.54s/it]
test ppl:  66%|██████▌   | 155/236 [10:01<05:23,  3.99s/it]
test ppl:  66%|██████▌   | 156/236 [10:04<04:35,  3.45s/it]
test ppl:  67%|██████▋   | 157/236 [10:06<04:03,  3.08s/it]
test ppl:  67%|██████▋   | 158/236 [10:12<05:06,  3.93s/it]
test ppl:  67%|██████▋   | 159/236 [10:16<05:00,  3.90s/it]
test ppl:  68%|██████▊   | 160/236 [10:17<03:54,  3.09s/it]
test ppl:  68%|██████▊   | 161/236 [10:18<03:13,  2.58s/it]
test ppl:  69%|██████▊   | 162/236 [10:21<03:23,  2.75s/it]
test ppl:  69%|██████▉   | 163/236 [10:24<03:16,  2.69s/it]
test ppl:  69%|██████▉   | 164/236 [10:27<03:34,  2.98s/it]
test ppl:  70%|██████▉   | 165/236 [10:32<03:59,  3.37s/it]
test ppl:  70%|███████   | 166/236 [10:33<03:16,  2.81s/it]
test ppl:  71%|███████   | 167/236 [10:35<02:46,  2.41s/it]
test ppl:  71%|███████   | 168/236 [10:39<03:23,  2.99s/it]
test ppl:  72%|███████▏  | 169/236 [10:45<04:10,  3.73s/it]
test ppl:  72%|███████▏  | 170/236 [10:50<04:50,  4.40s/it]
test ppl:  72%|███████▏  | 171/236 [10:52<03:46,  3.48s/it]
test ppl:  73%|███████▎  | 172/236 [10:58<04:29,  4.21s/it]
test ppl:  73%|███████▎  | 173/236 [11:01<04:12,  4.00s/it]
test ppl:  74%|███████▎  | 174/236 [11:05<04:06,  3.98s/it]
test ppl:  74%|███████▍  | 175/236 [11:07<03:23,  3.34s/it]
test ppl:  75%|███████▍  | 176/236 [11:12<03:48,  3.81s/it]
test ppl:  75%|███████▌  | 177/236 [11:18<04:22,  4.45s/it]
test ppl:  75%|███████▌  | 178/236 [11:24<04:44,  4.90s/it]
test ppl:  76%|███████▌  | 179/236 [11:30<04:56,  5.21s/it]
test ppl:  76%|███████▋  | 180/236 [11:34<04:41,  5.04s/it]
test ppl:  77%|███████▋  | 181/236 [11:40<04:51,  5.30s/it]
test ppl:  77%|███████▋  | 182/236 [11:42<03:51,  4.28s/it]
test ppl:  78%|███████▊  | 183/236 [11:44<03:15,  3.68s/it]
test ppl:  78%|███████▊  | 184/236 [11:46<02:36,  3.01s/it]
test ppl:  78%|███████▊  | 185/236 [11:50<02:55,  3.43s/it]
test ppl:  79%|███████▉  | 186/236 [11:56<03:28,  4.18s/it]
test ppl:  79%|███████▉  | 187/236 [12:02<03:51,  4.72s/it]
test ppl:  80%|███████▉  | 188/236 [12:08<04:04,  5.09s/it]
test ppl:  80%|████████  | 189/236 [12:14<04:10,  5.34s/it]
test ppl:  81%|████████  | 190/236 [12:18<03:42,  4.85s/it]
test ppl:  81%|████████  | 191/236 [12:22<03:31,  4.71s/it]
test ppl:  81%|████████▏ | 192/236 [12:25<02:59,  4.09s/it]
test ppl:  82%|████████▏ | 193/236 [12:31<03:19,  4.64s/it]
test ppl:  82%|████████▏ | 194/236 [12:33<02:49,  4.04s/it]
test ppl:  83%|████████▎ | 195/236 [12:37<02:33,  3.75s/it]
test ppl:  83%|████████▎ | 196/236 [12:39<02:09,  3.24s/it]
test ppl:  83%|████████▎ | 197/236 [12:41<01:53,  2.91s/it]
test ppl:  84%|████████▍ | 198/236 [12:47<02:24,  3.80s/it]
test ppl:  84%|████████▍ | 199/236 [12:49<02:08,  3.48s/it]
test ppl:  85%|████████▍ | 200/236 [12:55<02:31,  4.20s/it]
test ppl:  85%|████████▌ | 201/236 [12:57<02:04,  3.55s/it]
test ppl:  86%|████████▌ | 202/236 [13:02<02:11,  3.88s/it]
test ppl:  86%|████████▌ | 203/236 [13:08<02:28,  4.50s/it]
test ppl:  86%|████████▋ | 204/236 [13:09<01:54,  3.59s/it]
test ppl:  87%|████████▋ | 205/236 [13:15<02:13,  4.30s/it]
test ppl:  87%|████████▋ | 206/236 [13:19<02:00,  4.01s/it]
test ppl:  88%|████████▊ | 207/236 [13:24<02:12,  4.58s/it]
test ppl:  88%|████████▊ | 208/236 [13:28<01:56,  4.15s/it]
test ppl:  89%|████████▊ | 209/236 [13:34<02:07,  4.70s/it]
test ppl:  89%|████████▉ | 210/236 [13:36<01:44,  4.00s/it]
test ppl:  89%|████████▉ | 211/236 [13:41<01:46,  4.24s/it]
test ppl:  90%|████████▉ | 212/236 [13:46<01:48,  4.53s/it]
test ppl:  90%|█████████ | 213/236 [13:52<01:53,  4.94s/it]
test ppl:  91%|█████████ | 214/236 [13:54<01:26,  3.95s/it]
test ppl:  91%|█████████ | 215/236 [13:59<01:35,  4.54s/it]
test ppl:  92%|█████████▏| 216/236 [14:02<01:19,  3.95s/it]
test ppl:  92%|█████████▏| 217/236 [14:08<01:26,  4.57s/it]
test ppl:  92%|█████████▏| 218/236 [14:10<01:08,  3.78s/it]
test ppl:  93%|█████████▎| 219/236 [14:16<01:15,  4.43s/it]
test ppl:  93%|█████████▎| 220/236 [14:22<01:18,  4.88s/it]
test ppl:  94%|█████████▎| 221/236 [14:25<01:05,  4.35s/it]
test ppl:  94%|█████████▍| 222/236 [14:31<01:07,  4.83s/it]
test ppl:  94%|█████████▍| 223/236 [14:37<01:07,  5.16s/it]
test ppl:  95%|█████████▍| 224/236 [14:38<00:48,  4.00s/it]
test ppl:  95%|█████████▌| 225/236 [14:44<00:50,  4.57s/it]
test ppl:  96%|█████████▌| 226/236 [14:48<00:42,  4.27s/it]
test ppl:  96%|█████████▌| 227/236 [14:50<00:33,  3.71s/it]
test ppl:  97%|█████████▋| 228/236 [14:52<00:25,  3.20s/it]
test ppl:  97%|█████████▋| 229/236 [14:58<00:28,  4.01s/it]
test ppl:  97%|█████████▋| 230/236 [15:01<00:23,  3.86s/it]
test ppl:  98%|█████████▊| 231/236 [15:05<00:18,  3.71s/it]
test ppl:  98%|█████████▊| 232/236 [15:07<00:12,  3.13s/it]
test ppl:  99%|█████████▊| 233/236 [15:09<00:08,  2.84s/it]
test ppl:  99%|█████████▉| 234/236 [15:10<00:04,  2.35s/it]
test ppl: 100%|█████████▉| 235/236 [15:16<00:03,  3.42s/it]
test ppl: 100%|██████████| 236/236 [15:16<00:00,  2.59s/it]
test ppl: 100%|██████████| 236/236 [15:16<00:00,  3.89s/it]
10/12/2024 21:22:14 - INFO - __main__ -    em: 0.2099
10/12/2024 21:22:14 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.2 60:  em: 0.2099

--------------------------------------------------------------------------------
Running experiment with knn_temp=60, lmbda=0.2, k=32
2024-10-12 21:22:21.978713: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 21:22:21.998161: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 21:22:22.019941: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 21:22:22.026575: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 21:22:22.042454: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 21:22:23.033914: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 21:22:24 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.2, knn_temp=60, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 21:22:24 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:50:05,  2.18it/s]
Adding feature api:   3%|▎         | 6255/187062 [00:00<00:12, 14852.98it/s]
Adding feature api:   7%|▋         | 13232/187062 [00:00<00:06, 28763.27it/s]
Adding feature api:  11%|█         | 20421/187062 [00:00<00:04, 40221.88it/s]
Adding feature api:  15%|█▍        | 27648/187062 [00:00<00:03, 49038.01it/s]
Adding feature api:  19%|█▊        | 34889/187062 [00:00<00:02, 55631.52it/s]
Adding feature api:  22%|██▏       | 41980/187062 [00:01<00:02, 60018.83it/s]
Adding feature api:  26%|██▋       | 49233/187062 [00:01<00:02, 63657.43it/s]
Adding feature api:  30%|███       | 56467/187062 [00:01<00:01, 66205.21it/s]
Adding feature api:  34%|███▍      | 63768/187062 [00:01<00:01, 68214.93it/s]
Adding feature api:  38%|███▊      | 71063/187062 [00:01<00:01, 69617.31it/s]
Adding feature api:  42%|████▏     | 78241/187062 [00:01<00:01, 69888.74it/s]
Adding feature api:  46%|████▌     | 85480/187062 [00:01<00:01, 70631.93it/s]
Adding feature api:  50%|████▉     | 92743/187062 [00:01<00:01, 71225.54it/s]
Adding feature api:  53%|█████▎    | 99941/187062 [00:01<00:01, 71381.21it/s]
Adding feature api:  57%|█████▋    | 107132/187062 [00:01<00:01, 71118.40it/s]
Adding feature api:  61%|██████    | 114398/187062 [00:02<00:01, 71575.49it/s]
Adding feature api:  65%|██████▌   | 121619/187062 [00:02<00:00, 71761.99it/s]
Adding feature api:  69%|██████▉   | 128864/187062 [00:02<00:00, 71965.51it/s]
Adding feature api:  73%|███████▎  | 136074/187062 [00:02<00:00, 71442.17it/s]
Adding feature api:  77%|███████▋  | 143277/187062 [00:02<00:00, 71615.86it/s]
Adding feature api:  80%|████████  | 150522/187062 [00:02<00:00, 71864.20it/s]
Adding feature api:  84%|████████▍ | 157819/187062 [00:02<00:00, 72193.96it/s]
Adding feature api:  88%|████████▊ | 165043/187062 [00:02<00:00, 71606.69it/s]
Adding feature api:  92%|█████████▏| 172305/187062 [00:02<00:00, 71906.51it/s]
Adding feature api:  96%|█████████▌| 179499/187062 [00:03<00:00, 63659.36it/s]
Adding feature api:  99%|█████████▉| 186039/187062 [00:03<00:00, 46051.01it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 56843.24it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:57:30,  2.17it/s]
Adding feature datatype:   3%|▎         | 6099/187062 [00:00<00:12, 14425.50it/s]
Adding feature datatype:   7%|▋         | 13039/187062 [00:00<00:06, 28309.80it/s]
Adding feature datatype:  11%|█         | 19750/187062 [00:00<00:04, 38596.36it/s]
Adding feature datatype:  14%|█▍        | 26766/187062 [00:00<00:03, 47266.27it/s]
Adding feature datatype:  18%|█▊        | 33841/187062 [00:00<00:02, 53882.74it/s]
Adding feature datatype:  22%|██▏       | 40894/187062 [00:01<00:02, 58660.48it/s]
Adding feature datatype:  26%|██▌       | 47942/187062 [00:01<00:02, 62095.16it/s]
Adding feature datatype:  29%|██▉       | 54990/187062 [00:01<00:02, 64554.21it/s]
Adding feature datatype:  33%|███▎      | 61866/187062 [00:01<00:01, 65417.98it/s]
Adding feature datatype:  37%|███▋      | 68914/187062 [00:01<00:01, 66913.38it/s]
Adding feature datatype:  41%|████      | 75989/187062 [00:01<00:01, 68050.55it/s]
Adding feature datatype:  44%|████▍     | 83015/187062 [00:01<00:01, 68706.55it/s]
Adding feature datatype:  48%|████▊     | 90053/187062 [00:01<00:01, 69204.64it/s]
Adding feature datatype:  52%|█████▏    | 97047/187062 [00:01<00:01, 68831.56it/s]
Adding feature datatype:  56%|█████▌    | 104085/187062 [00:01<00:01, 69284.39it/s]
Adding feature datatype:  59%|█████▉    | 111110/187062 [00:02<00:01, 69570.01it/s]
Adding feature datatype:  63%|██████▎   | 118138/187062 [00:02<00:00, 69780.82it/s]
Adding feature datatype:  67%|██████▋   | 125135/187062 [00:02<00:00, 69824.73it/s]
Adding feature datatype:  71%|███████   | 132210/187062 [00:02<00:00, 70098.81it/s]
Adding feature datatype:  74%|███████▍  | 139229/187062 [00:02<00:00, 69418.20it/s]
Adding feature datatype:  78%|███████▊  | 146266/187062 [00:02<00:00, 69697.95it/s]
Adding feature datatype:  82%|████████▏ | 153344/187062 [00:02<00:00, 70019.36it/s]
Adding feature datatype:  86%|████████▌ | 160397/187062 [00:02<00:00, 70171.30it/s]
Adding feature datatype:  89%|████████▉ | 167418/187062 [00:02<00:00, 69538.21it/s]
Adding feature datatype:  93%|█████████▎| 174465/187062 [00:02<00:00, 69814.71it/s]
Adding feature datatype:  97%|█████████▋| 181449/187062 [00:03<00:00, 55027.00it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 55579.77it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:49:55,  2.18it/s]
Adding feature literal:   3%|▎         | 6074/187062 [00:00<00:12, 14424.71it/s]
Adding feature literal:   7%|▋         | 13067/187062 [00:00<00:06, 28484.81it/s]
Adding feature literal:  11%|█         | 20063/187062 [00:00<00:04, 39505.50it/s]
Adding feature literal:  15%|█▍        | 27136/187062 [00:00<00:03, 48096.11it/s]
Adding feature literal:  18%|█▊        | 34187/187062 [00:00<00:02, 54418.72it/s]
Adding feature literal:  22%|██▏       | 41220/187062 [00:01<00:02, 58989.31it/s]
Adding feature literal:  26%|██▌       | 48338/187062 [00:01<00:02, 62534.96it/s]
Adding feature literal:  30%|██▉       | 55443/187062 [00:01<00:02, 65033.73it/s]
Adding feature literal:  33%|███▎      | 62535/187062 [00:01<00:01, 66772.22it/s]
Adding feature literal:  37%|███▋      | 69561/187062 [00:01<00:01, 67804.94it/s]
Adding feature literal:  41%|████      | 76653/187062 [00:01<00:01, 68730.92it/s]
Adding feature literal:  45%|████▍     | 83729/187062 [00:01<00:01, 69335.49it/s]
Adding feature literal:  49%|████▊     | 90828/187062 [00:01<00:01, 69827.70it/s]
Adding feature literal:  52%|█████▏    | 97904/187062 [00:01<00:01, 70105.98it/s]
Adding feature literal:  56%|█████▌    | 104993/187062 [00:01<00:01, 70339.52it/s]
Adding feature literal:  60%|█████▉    | 112082/187062 [00:02<00:01, 70501.30it/s]
Adding feature literal:  64%|██████▎   | 119207/187062 [00:02<00:00, 70722.38it/s]
Adding feature literal:  68%|██████▊   | 126297/187062 [00:02<00:00, 70758.91it/s]
Adding feature literal:  71%|███████▏  | 133386/187062 [00:02<00:00, 70603.98it/s]
Adding feature literal:  75%|███████▌  | 140494/187062 [00:02<00:00, 70745.61it/s]
Adding feature literal:  79%|███████▉  | 147575/187062 [00:02<00:00, 70299.43it/s]
Adding feature literal:  83%|████████▎ | 154610/187062 [00:02<00:00, 70295.54it/s]
Adding feature literal:  86%|████████▋ | 161661/187062 [00:02<00:00, 70357.87it/s]
Adding feature literal:  90%|█████████ | 168700/187062 [00:02<00:00, 70338.06it/s]
Adding feature literal:  94%|█████████▍| 175738/187062 [00:02<00:00, 70349.63it/s]
Adding feature literal:  98%|█████████▊| 182775/187062 [00:03<00:00, 50486.99it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 56026.64it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:50:10,  2.18it/s]
Adding feature operator:   3%|▎         | 6056/187062 [00:00<00:12, 14380.18it/s]
Adding feature operator:   7%|▋         | 13017/187062 [00:00<00:06, 28369.02it/s]
Adding feature operator:  11%|█         | 19998/187062 [00:00<00:04, 39378.47it/s]
Adding feature operator:  14%|█▍        | 27037/187062 [00:00<00:03, 47909.45it/s]
Adding feature operator:  18%|█▊        | 34063/187062 [00:00<00:02, 54214.21it/s]
Adding feature operator:  22%|██▏       | 41086/187062 [00:01<00:02, 58814.05it/s]
Adding feature operator:  26%|██▌       | 48106/187062 [00:01<00:02, 62125.48it/s]
Adding feature operator:  30%|██▉       | 55192/187062 [00:01<00:02, 64688.23it/s]
Adding feature operator:  33%|███▎      | 62275/187062 [00:01<00:01, 66501.57it/s]
Adding feature operator:  37%|███▋      | 69316/187062 [00:01<00:01, 67659.33it/s]
Adding feature operator:  41%|████      | 76328/187062 [00:01<00:01, 68389.77it/s]
Adding feature operator:  45%|████▍     | 83396/187062 [00:01<00:01, 69071.68it/s]
Adding feature operator:  48%|████▊     | 90408/187062 [00:01<00:01, 68921.35it/s]
Adding feature operator:  52%|█████▏    | 97373/187062 [00:01<00:01, 67167.10it/s]
Adding feature operator:  56%|█████▌    | 104150/187062 [00:01<00:01, 65830.65it/s]
Adding feature operator:  59%|█████▉    | 110779/187062 [00:02<00:01, 64952.96it/s]
Adding feature operator:  63%|██████▎   | 117306/187062 [00:02<00:01, 64497.78it/s]
Adding feature operator:  66%|██████▌   | 123778/187062 [00:02<00:00, 64135.44it/s]
Adding feature operator:  70%|██████▉   | 130238/187062 [00:02<00:00, 64268.95it/s]
Adding feature operator:  73%|███████▎  | 137257/187062 [00:02<00:00, 66012.02it/s]
Adding feature operator:  77%|███████▋  | 144234/187062 [00:02<00:00, 67123.82it/s]
Adding feature operator:  81%|████████  | 151252/187062 [00:02<00:00, 68029.51it/s]
Adding feature operator:  85%|████████▍ | 158248/187062 [00:02<00:00, 68604.11it/s]
Adding feature operator:  88%|████████▊ | 165255/187062 [00:02<00:00, 69040.36it/s]
Adding feature operator:  92%|█████████▏| 172239/187062 [00:02<00:00, 69278.08it/s]
Adding feature operator:  96%|█████████▌| 179170/187062 [00:03<00:00, 62789.97it/s]
Adding feature operator:  99%|█████████▉| 185567/187062 [00:03<00:00, 45313.36it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 54755.43it/s]
[2024-10-12 21:23:10,275] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 21:23:11 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 21:23:11 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 41/6548 [00:00<00:16, 400.74 examples/s]
Map:   1%|▏         | 83/6548 [00:00<00:28, 224.83 examples/s]
Map:   2%|▏         | 125/6548 [00:00<00:23, 277.30 examples/s]
Map:   3%|▎         | 172/6548 [00:00<00:19, 332.59 examples/s]
Map:   3%|▎         | 211/6548 [00:00<00:18, 349.02 examples/s]
Map:   4%|▍         | 249/6548 [00:00<00:17, 356.14 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:17, 347.98 examples/s]
Map:   5%|▌         | 330/6548 [00:01<00:19, 315.48 examples/s]
Map:   6%|▌         | 385/6548 [00:01<00:18, 329.06 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:17, 358.17 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 325.39 examples/s]
Map:   8%|▊         | 534/6548 [00:01<00:17, 349.81 examples/s]
Map:   9%|▉         | 575/6548 [00:01<00:16, 362.99 examples/s]
Map:   9%|▉         | 615/6548 [00:01<00:16, 369.66 examples/s]
Map:  10%|█         | 662/6548 [00:01<00:17, 341.77 examples/s]
Map:  11%|█         | 708/6548 [00:02<00:15, 367.88 examples/s]
Map:  11%|█▏        | 753/6548 [00:02<00:14, 386.53 examples/s]
Map:  12%|█▏        | 806/6548 [00:02<00:13, 423.91 examples/s]
Map:  13%|█▎        | 862/6548 [00:02<00:14, 402.21 examples/s]
Map:  14%|█▍        | 916/6548 [00:02<00:14, 386.36 examples/s]
Map:  15%|█▍        | 957/6548 [00:02<00:14, 389.37 examples/s]
Map:  15%|█▌        | 1000/6548 [00:03<00:23, 239.11 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:21, 261.67 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:19, 285.30 examples/s]
Map:  17%|█▋        | 1123/6548 [00:03<00:16, 323.71 examples/s]
Map:  18%|█▊        | 1163/6548 [00:03<00:15, 341.32 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:14, 357.46 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:14, 366.10 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:13, 376.97 examples/s]
Map:  20%|██        | 1340/6548 [00:03<00:15, 341.08 examples/s]
Map:  21%|██        | 1379/6548 [00:04<00:16, 304.33 examples/s]
Map:  22%|██▏       | 1417/6548 [00:04<00:16, 319.03 examples/s]
Map:  22%|██▏       | 1461/6548 [00:04<00:17, 290.96 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:16, 300.24 examples/s]
Map:  24%|██▍       | 1556/6548 [00:04<00:17, 291.69 examples/s]
Map:  24%|██▍       | 1596/6548 [00:04<00:16, 303.88 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:16, 292.71 examples/s]
Map:  26%|██▌       | 1685/6548 [00:05<00:17, 283.02 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:15, 309.56 examples/s]
Map:  27%|██▋       | 1771/6548 [00:05<00:14, 339.25 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:13, 345.80 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 353.08 examples/s]
Map:  29%|██▉       | 1898/6548 [00:05<00:13, 332.38 examples/s]
Map:  30%|██▉       | 1954/6548 [00:05<00:13, 342.59 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:19, 228.29 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:18, 238.64 examples/s]
Map:  32%|███▏      | 2070/6548 [00:06<00:16, 268.15 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:15, 277.96 examples/s]
Map:  33%|███▎      | 2136/6548 [00:06<00:15, 286.12 examples/s]
Map:  33%|███▎      | 2180/6548 [00:06<00:16, 272.83 examples/s]
Map:  34%|███▍      | 2213/6548 [00:06<00:15, 280.01 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:15, 277.90 examples/s]
Map:  35%|███▌      | 2293/6548 [00:07<00:14, 290.08 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:13, 314.95 examples/s]
Map:  36%|███▋      | 2376/6548 [00:07<00:13, 315.75 examples/s]
Map:  37%|███▋      | 2411/6548 [00:07<00:12, 321.88 examples/s]
Map:  38%|███▊      | 2460/6548 [00:07<00:13, 313.07 examples/s]
Map:  38%|███▊      | 2496/6548 [00:07<00:12, 320.16 examples/s]
Map:  39%|███▊      | 2537/6548 [00:07<00:11, 338.33 examples/s]
Map:  40%|███▉      | 2591/6548 [00:08<00:10, 385.39 examples/s]
Map:  40%|████      | 2632/6548 [00:08<00:10, 388.15 examples/s]
Map:  41%|████      | 2682/6548 [00:08<00:10, 356.78 examples/s]
Map:  42%|████▏     | 2734/6548 [00:08<00:11, 344.03 examples/s]
Map:  42%|████▏     | 2773/6548 [00:08<00:10, 353.33 examples/s]
Map:  43%|████▎     | 2824/6548 [00:08<00:10, 346.05 examples/s]
Map:  44%|████▎     | 2860/6548 [00:08<00:12, 288.45 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 293.01 examples/s]
Map:  45%|████▌     | 2949/6548 [00:09<00:11, 301.36 examples/s]
Map:  46%|████▌     | 2982/6548 [00:09<00:11, 302.54 examples/s]
Map:  46%|████▌     | 3026/6548 [00:09<00:20, 167.95 examples/s]
Map:  47%|████▋     | 3061/6548 [00:09<00:18, 193.43 examples/s]
Map:  47%|████▋     | 3094/6548 [00:10<00:15, 216.11 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 250.35 examples/s]
Map:  49%|████▊     | 3183/6548 [00:10<00:14, 236.65 examples/s]
Map:  49%|████▉     | 3219/6548 [00:10<00:13, 243.70 examples/s]
Map:  50%|████▉     | 3255/6548 [00:10<00:12, 264.83 examples/s]
Map:  50%|█████     | 3286/6548 [00:10<00:11, 272.08 examples/s]
Map:  51%|█████     | 3331/6548 [00:10<00:10, 305.30 examples/s]
Map:  52%|█████▏    | 3380/6548 [00:11<00:10, 300.95 examples/s]
Map:  52%|█████▏    | 3421/6548 [00:11<00:11, 275.00 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 270.69 examples/s]
Map:  53%|█████▎    | 3495/6548 [00:11<00:11, 268.08 examples/s]
Map:  54%|█████▍    | 3544/6548 [00:11<00:09, 317.12 examples/s]
Map:  55%|█████▍    | 3591/6548 [00:11<00:08, 348.07 examples/s]
Map:  56%|█████▌    | 3636/6548 [00:11<00:07, 372.21 examples/s]
Map:  56%|█████▋    | 3696/6548 [00:11<00:07, 374.77 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:12<00:07, 380.75 examples/s]
Map:  58%|█████▊    | 3791/6548 [00:12<00:07, 364.79 examples/s]
Map:  59%|█████▊    | 3831/6548 [00:12<00:08, 323.69 examples/s]
Map:  59%|█████▉    | 3865/6548 [00:12<00:08, 311.72 examples/s]
Map:  60%|█████▉    | 3914/6548 [00:12<00:07, 332.03 examples/s]
Map:  60%|██████    | 3955/6548 [00:12<00:08, 310.37 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 231.39 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 286.36 examples/s]
Map:  63%|██████▎   | 4094/6548 [00:13<00:07, 309.32 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 320.50 examples/s]
Map:  64%|██████▍   | 4177/6548 [00:13<00:07, 304.28 examples/s]
Map:  64%|██████▍   | 4214/6548 [00:13<00:07, 312.25 examples/s]
Map:  65%|██████▌   | 4266/6548 [00:13<00:06, 359.62 examples/s]
Map:  66%|██████▌   | 4327/6548 [00:13<00:05, 373.77 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:14<00:06, 359.20 examples/s]
Map:  67%|██████▋   | 4405/6548 [00:14<00:05, 361.09 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:05, 386.25 examples/s]
Map:  69%|██████▊   | 4498/6548 [00:14<00:05, 342.48 examples/s]
Map:  69%|██████▉   | 4546/6548 [00:14<00:06, 326.55 examples/s]
Map:  70%|███████   | 4584/6548 [00:14<00:05, 328.05 examples/s]
Map:  71%|███████   | 4623/6548 [00:14<00:05, 341.25 examples/s]
Map:  71%|███████▏  | 4668/6548 [00:14<00:05, 357.67 examples/s]
Map:  72%|███████▏  | 4724/6548 [00:15<00:05, 361.26 examples/s]
Map:  73%|███████▎  | 4780/6548 [00:15<00:04, 363.20 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 369.81 examples/s]
Map:  74%|███████▍  | 4878/6548 [00:15<00:04, 350.88 examples/s]
Map:  75%|███████▌  | 4933/6548 [00:15<00:04, 351.80 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:04, 373.73 examples/s]
Map:  77%|███████▋  | 5041/6548 [00:16<00:06, 240.12 examples/s]
Map:  78%|███████▊  | 5076/6548 [00:16<00:05, 254.75 examples/s]
Map:  78%|███████▊  | 5120/6548 [00:16<00:05, 262.64 examples/s]
Map:  79%|███████▊  | 5155/6548 [00:16<00:05, 276.54 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 277.82 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:16<00:04, 292.81 examples/s]
Map:  80%|████████  | 5256/6548 [00:16<00:04, 296.57 examples/s]
Map:  81%|████████  | 5304/6548 [00:16<00:03, 341.42 examples/s]
Map:  82%|████████▏ | 5346/6548 [00:17<00:04, 296.12 examples/s]
Map:  82%|████████▏ | 5388/6548 [00:17<00:03, 322.51 examples/s]
Map:  83%|████████▎ | 5429/6548 [00:17<00:03, 303.21 examples/s]
Map:  83%|████████▎ | 5466/6548 [00:17<00:03, 313.17 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 323.51 examples/s]
Map:  85%|████████▍ | 5548/6548 [00:17<00:02, 348.87 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:17<00:03, 311.41 examples/s]
Map:  86%|████████▌ | 5639/6548 [00:18<00:02, 364.35 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 324.11 examples/s]
Map:  87%|████████▋ | 5721/6548 [00:18<00:02, 341.84 examples/s]
Map:  88%|████████▊ | 5762/6548 [00:18<00:02, 356.51 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 357.07 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:01, 360.67 examples/s]
Map:  90%|████████▉ | 5886/6548 [00:18<00:01, 366.58 examples/s]
Map:  90%|█████████ | 5924/6548 [00:18<00:01, 367.84 examples/s]
Map:  91%|█████████ | 5973/6548 [00:18<00:01, 344.97 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 241.30 examples/s]
Map:  93%|█████████▎| 6081/6548 [00:19<00:01, 270.38 examples/s]
Map:  93%|█████████▎| 6122/6548 [00:19<00:01, 265.55 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:19<00:01, 285.54 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:19<00:01, 305.92 examples/s]
Map:  96%|█████████▌| 6262/6548 [00:20<00:00, 317.63 examples/s]
Map:  96%|█████████▋| 6303/6548 [00:20<00:00, 338.15 examples/s]
Map:  97%|█████████▋| 6366/6548 [00:20<00:00, 358.81 examples/s]
Map:  98%|█████████▊| 6421/6548 [00:20<00:00, 352.80 examples/s]
Map:  99%|█████████▉| 6471/6548 [00:20<00:00, 382.58 examples/s]
Map:  99%|█████████▉| 6515/6548 [00:20<00:00, 377.98 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 313.57 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 324.31 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 344.86 examples/s]
Map:  13%|█▎        | 116/903 [00:00<00:02, 341.07 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 355.13 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 405.14 examples/s]
Map:  29%|██▉       | 263/903 [00:00<00:01, 376.32 examples/s]
Map:  35%|███▌      | 317/903 [00:00<00:01, 358.48 examples/s]
Map:  39%|███▉      | 355/903 [00:00<00:01, 362.97 examples/s]
Map:  43%|████▎     | 392/903 [00:01<00:01, 277.47 examples/s]
Map:  47%|████▋     | 428/903 [00:01<00:01, 293.39 examples/s]
Map:  52%|█████▏    | 470/903 [00:01<00:01, 277.29 examples/s]
Map:  56%|█████▋    | 510/903 [00:01<00:01, 272.85 examples/s]
Map:  62%|██████▏   | 557/903 [00:01<00:01, 314.21 examples/s]
Map:  66%|██████▌   | 596/903 [00:01<00:00, 330.90 examples/s]
Map:  70%|███████   | 634/903 [00:01<00:00, 338.28 examples/s]
Map:  75%|███████▍  | 674/903 [00:02<00:00, 353.68 examples/s]
Map:  82%|████████▏ | 736/903 [00:02<00:00, 367.28 examples/s]
Map:  88%|████████▊ | 793/903 [00:02<00:00, 365.97 examples/s]
Map:  92%|█████████▏| 831/903 [00:02<00:00, 366.49 examples/s]
Map:  97%|█████████▋| 878/903 [00:02<00:00, 370.23 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 309.04 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 39/1882 [00:00<00:05, 312.96 examples/s]
Map:   4%|▍         | 83/1882 [00:00<00:04, 380.10 examples/s]
Map:   7%|▋         | 130/1882 [00:00<00:05, 333.82 examples/s]
Map:   9%|▉         | 175/1882 [00:00<00:04, 370.07 examples/s]
Map:  12%|█▏        | 233/1882 [00:00<00:04, 374.44 examples/s]
Map:  15%|█▍        | 277/1882 [00:00<00:04, 386.09 examples/s]
Map:  18%|█▊        | 334/1882 [00:00<00:04, 365.57 examples/s]
Map:  20%|█▉        | 376/1882 [00:01<00:04, 327.73 examples/s]
Map:  22%|██▏       | 422/1882 [00:01<00:04, 312.69 examples/s]
Map:  24%|██▍       | 455/1882 [00:01<00:04, 314.33 examples/s]
Map:  27%|██▋       | 500/1882 [00:01<00:04, 338.54 examples/s]
Map:  29%|██▉       | 552/1882 [00:01<00:04, 316.31 examples/s]
Map:  32%|███▏      | 603/1882 [00:01<00:03, 352.07 examples/s]
Map:  35%|███▍      | 653/1882 [00:01<00:03, 377.78 examples/s]
Map:  37%|███▋      | 696/1882 [00:01<00:03, 386.34 examples/s]
Map:  40%|████      | 760/1882 [00:02<00:02, 396.37 examples/s]
Map:  43%|████▎     | 809/1882 [00:02<00:03, 354.52 examples/s]
Map:  45%|████▌     | 851/1882 [00:02<00:02, 368.29 examples/s]
Map:  48%|████▊     | 906/1882 [00:02<00:02, 363.61 examples/s]
Map:  50%|█████     | 948/1882 [00:02<00:02, 376.76 examples/s]
Map:  53%|█████▎    | 997/1882 [00:02<00:02, 391.98 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 247.21 examples/s]
Map:  57%|█████▋    | 1082/1882 [00:03<00:03, 256.33 examples/s]
Map:  59%|█████▉    | 1115/1882 [00:03<00:02, 269.91 examples/s]
Map:  62%|██████▏   | 1164/1882 [00:03<00:02, 281.72 examples/s]
Map:  64%|██████▍   | 1213/1882 [00:03<00:02, 278.29 examples/s]
Map:  67%|██████▋   | 1255/1882 [00:03<00:02, 304.94 examples/s]
Map:  69%|██████▊   | 1290/1882 [00:03<00:01, 313.51 examples/s]
Map:  71%|███████   | 1335/1882 [00:04<00:01, 343.76 examples/s]
Map:  73%|███████▎  | 1381/1882 [00:04<00:01, 327.43 examples/s]
Map:  76%|███████▌  | 1426/1882 [00:04<00:01, 297.50 examples/s]
Map:  78%|███████▊  | 1467/1882 [00:04<00:01, 322.44 examples/s]
Map:  80%|███████▉  | 1504/1882 [00:04<00:01, 273.50 examples/s]
Map:  82%|████████▏ | 1535/1882 [00:04<00:01, 277.28 examples/s]
Map:  84%|████████▎ | 1575/1882 [00:04<00:01, 303.09 examples/s]
Map:  86%|████████▌ | 1619/1882 [00:04<00:00, 334.06 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 334.21 examples/s]
Map:  90%|█████████ | 1695/1882 [00:05<00:00, 333.92 examples/s]
Map:  92%|█████████▏| 1731/1882 [00:05<00:00, 335.82 examples/s]
Map:  94%|█████████▍| 1772/1882 [00:05<00:00, 262.75 examples/s]
Map:  96%|█████████▌| 1807/1882 [00:05<00:00, 279.13 examples/s]
Map:  98%|█████████▊| 1852/1882 [00:05<00:00, 317.69 examples/s]
Map: 100%|██████████| 1882/1882 [00:05<00:00, 313.68 examples/s]
10/12/2024 21:24:13 - INFO - __main__ -     ***** Testing *****
10/12/2024 21:24:13 - INFO - __main__ -     Batch size = 8
10/12/2024 21:24:13 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 21:24:14 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 21:24:14 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 21:24:15 - INFO - knnlm -   Reading datastore took 0.9583818912506104 s
10/12/2024 21:24:16 - INFO - knnlm -   Moving index to GPU took 0.9040789604187012 s
10/12/2024 21:24:16 - INFO - __main__ -   ******************************break-into
10/12/2024 21:24:16 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 21:24:16 - INFO - __main__ -     Num examples = 236
10/12/2024 21:24:16 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:24,  7.51s/it]
test ppl:   1%|          | 2/236 [00:09<16:34,  4.25s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:39,  3.00s/it]
test ppl:   2%|▏         | 4/236 [00:12<09:32,  2.47s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:20,  3.72s/it]
test ppl:   3%|▎         | 6/236 [00:20<12:27,  3.25s/it]
test ppl:   3%|▎         | 7/236 [00:23<11:32,  3.02s/it]
test ppl:   3%|▎         | 8/236 [00:27<13:03,  3.44s/it]
test ppl:   4%|▍         | 9/236 [00:29<11:27,  3.03s/it]
test ppl:   4%|▍         | 10/236 [00:33<11:27,  3.04s/it]
test ppl:   5%|▍         | 11/236 [00:35<10:38,  2.84s/it]
test ppl:   5%|▌         | 12/236 [00:41<14:06,  3.78s/it]
test ppl:   6%|▌         | 13/236 [00:47<16:29,  4.44s/it]
test ppl:   6%|▌         | 14/236 [00:53<18:05,  4.89s/it]
test ppl:   6%|▋         | 15/236 [00:55<15:16,  4.15s/it]
test ppl:   7%|▋         | 16/236 [00:57<12:42,  3.46s/it]
test ppl:   7%|▋         | 17/236 [01:03<15:20,  4.20s/it]
test ppl:   8%|▊         | 18/236 [01:05<12:33,  3.45s/it]
test ppl:   8%|▊         | 19/236 [01:09<13:36,  3.76s/it]
test ppl:   8%|▊         | 20/236 [01:11<11:24,  3.17s/it]
test ppl:   9%|▉         | 21/236 [01:13<10:25,  2.91s/it]
test ppl:   9%|▉         | 22/236 [01:19<13:37,  3.82s/it]
test ppl:  10%|▉         | 23/236 [01:22<12:11,  3.43s/it]
test ppl:  10%|█         | 24/236 [01:24<11:01,  3.12s/it]
test ppl:  11%|█         | 25/236 [01:26<09:38,  2.74s/it]
test ppl:  11%|█         | 26/236 [01:32<12:58,  3.71s/it]
test ppl:  11%|█▏        | 27/236 [01:36<13:25,  3.86s/it]
test ppl:  12%|█▏        | 28/236 [01:38<10:50,  3.13s/it]
test ppl:  12%|█▏        | 29/236 [01:40<09:58,  2.89s/it]
test ppl:  13%|█▎        | 30/236 [01:41<08:31,  2.48s/it]
test ppl:  13%|█▎        | 31/236 [01:43<08:00,  2.34s/it]
test ppl:  14%|█▎        | 32/236 [01:46<08:30,  2.50s/it]
test ppl:  14%|█▍        | 33/236 [01:52<11:58,  3.54s/it]
test ppl:  14%|█▍        | 34/236 [01:56<12:24,  3.69s/it]
test ppl:  15%|█▍        | 35/236 [01:59<11:12,  3.35s/it]
test ppl:  15%|█▌        | 36/236 [02:05<13:44,  4.12s/it]
test ppl:  16%|█▌        | 37/236 [02:11<15:28,  4.67s/it]
test ppl:  16%|█▌        | 38/236 [02:13<12:50,  3.89s/it]
test ppl:  17%|█▋        | 39/236 [02:14<10:26,  3.18s/it]
test ppl:  17%|█▋        | 40/236 [02:17<09:55,  3.04s/it]
test ppl:  17%|█▋        | 41/236 [02:20<09:23,  2.89s/it]
test ppl:  18%|█▊        | 42/236 [02:26<12:20,  3.82s/it]
test ppl:  18%|█▊        | 43/236 [02:31<14:17,  4.44s/it]
test ppl:  19%|█▊        | 44/236 [02:34<12:11,  3.81s/it]
test ppl:  19%|█▉        | 45/236 [02:36<10:23,  3.26s/it]
test ppl:  19%|█▉        | 46/236 [02:42<12:53,  4.07s/it]
test ppl:  20%|█▉        | 47/236 [02:48<14:37,  4.64s/it]
test ppl:  20%|██        | 48/236 [02:54<15:45,  5.03s/it]
test ppl:  21%|██        | 49/236 [02:57<14:04,  4.52s/it]
test ppl:  21%|██        | 50/236 [03:03<15:20,  4.95s/it]
test ppl:  22%|██▏       | 51/236 [03:09<16:11,  5.25s/it]
test ppl:  22%|██▏       | 52/236 [03:15<16:44,  5.46s/it]
test ppl:  22%|██▏       | 53/236 [03:20<16:40,  5.46s/it]
test ppl:  23%|██▎       | 54/236 [03:22<13:01,  4.29s/it]
test ppl:  23%|██▎       | 55/236 [03:28<14:12,  4.71s/it]
test ppl:  24%|██▎       | 56/236 [03:31<12:59,  4.33s/it]
test ppl:  24%|██▍       | 57/236 [03:34<11:20,  3.80s/it]
test ppl:  25%|██▍       | 58/236 [03:35<09:18,  3.14s/it]
test ppl:  25%|██▌       | 59/236 [03:41<11:42,  3.97s/it]
test ppl:  25%|██▌       | 60/236 [03:44<10:59,  3.75s/it]
test ppl:  26%|██▌       | 61/236 [03:50<12:50,  4.40s/it]
test ppl:  26%|██▋       | 62/236 [03:54<12:33,  4.33s/it]
test ppl:  27%|██▋       | 63/236 [03:57<10:53,  3.78s/it]
test ppl:  27%|██▋       | 64/236 [03:58<08:54,  3.11s/it]
test ppl:  28%|██▊       | 65/236 [04:00<07:20,  2.57s/it]
test ppl:  28%|██▊       | 66/236 [04:03<07:38,  2.70s/it]
test ppl:  28%|██▊       | 67/236 [04:07<08:43,  3.10s/it]
test ppl:  29%|██▉       | 68/236 [04:13<11:02,  3.94s/it]
test ppl:  29%|██▉       | 69/236 [04:19<12:38,  4.54s/it]
test ppl:  30%|██▉       | 70/236 [04:20<10:07,  3.66s/it]
test ppl:  30%|███       | 71/236 [04:24<10:01,  3.65s/it]
test ppl:  31%|███       | 72/236 [04:28<10:07,  3.71s/it]
test ppl:  31%|███       | 73/236 [04:32<10:12,  3.76s/it]
test ppl:  31%|███▏      | 74/236 [04:33<08:19,  3.09s/it]
test ppl:  32%|███▏      | 75/236 [04:39<10:33,  3.94s/it]
test ppl:  32%|███▏      | 76/236 [04:43<10:55,  4.10s/it]
test ppl:  33%|███▎      | 77/236 [04:46<09:25,  3.56s/it]
test ppl:  33%|███▎      | 78/236 [04:48<08:05,  3.07s/it]
test ppl:  33%|███▎      | 79/236 [04:53<09:34,  3.66s/it]
test ppl:  34%|███▍      | 80/236 [04:55<08:10,  3.15s/it]
test ppl:  34%|███▍      | 81/236 [05:01<10:16,  3.98s/it]
test ppl:  35%|███▍      | 82/236 [05:07<11:44,  4.57s/it]
test ppl:  35%|███▌      | 83/236 [05:09<09:42,  3.81s/it]
test ppl:  36%|███▌      | 84/236 [05:10<08:11,  3.24s/it]
test ppl:  36%|███▌      | 85/236 [05:15<08:50,  3.51s/it]
test ppl:  36%|███▋      | 86/236 [05:17<07:36,  3.04s/it]
test ppl:  37%|███▋      | 87/236 [05:19<06:51,  2.76s/it]
test ppl:  37%|███▋      | 88/236 [05:25<09:08,  3.71s/it]
test ppl:  38%|███▊      | 89/236 [05:30<10:42,  4.37s/it]
test ppl:  38%|███▊      | 90/236 [05:36<11:45,  4.83s/it]
test ppl:  39%|███▊      | 91/236 [05:41<11:43,  4.85s/it]
test ppl:  39%|███▉      | 92/236 [05:44<10:10,  4.24s/it]
test ppl:  39%|███▉      | 93/236 [05:50<11:17,  4.74s/it]
test ppl:  40%|███▉      | 94/236 [05:56<12:03,  5.09s/it]
test ppl:  40%|████      | 95/236 [06:00<11:33,  4.92s/it]
test ppl:  41%|████      | 96/236 [06:03<10:07,  4.34s/it]
test ppl:  41%|████      | 97/236 [06:09<11:07,  4.81s/it]
test ppl:  42%|████▏     | 98/236 [06:15<11:49,  5.14s/it]
test ppl:  42%|████▏     | 99/236 [06:21<12:16,  5.37s/it]
test ppl:  42%|████▏     | 100/236 [06:23<09:25,  4.16s/it]
test ppl:  43%|████▎     | 101/236 [06:28<10:32,  4.69s/it]
test ppl:  43%|████▎     | 102/236 [06:32<09:46,  4.38s/it]
test ppl:  44%|████▎     | 103/236 [06:34<08:12,  3.71s/it]
test ppl:  44%|████▍     | 104/236 [06:39<08:32,  3.88s/it]
test ppl:  44%|████▍     | 105/236 [06:42<08:31,  3.90s/it]
test ppl:  45%|████▍     | 106/236 [06:48<09:27,  4.37s/it]
test ppl:  45%|████▌     | 107/236 [06:50<07:54,  3.68s/it]
test ppl:  46%|████▌     | 108/236 [06:56<09:10,  4.30s/it]
test ppl:  46%|████▌     | 109/236 [07:00<09:22,  4.43s/it]
test ppl:  47%|████▋     | 110/236 [07:02<07:40,  3.65s/it]
test ppl:  47%|████▋     | 111/236 [07:06<07:48,  3.75s/it]
test ppl:  47%|████▋     | 112/236 [07:09<07:09,  3.47s/it]
test ppl:  48%|████▊     | 113/236 [07:11<06:04,  2.96s/it]
test ppl:  48%|████▊     | 114/236 [07:14<06:15,  3.07s/it]
test ppl:  49%|████▊     | 115/236 [07:20<07:55,  3.93s/it]
test ppl:  49%|████▉     | 116/236 [07:26<08:51,  4.43s/it]
test ppl:  50%|████▉     | 117/236 [07:28<07:15,  3.66s/it]
test ppl:  50%|█████     | 118/236 [07:32<07:30,  3.82s/it]
test ppl:  50%|█████     | 119/236 [07:35<07:09,  3.67s/it]
test ppl:  51%|█████     | 120/236 [07:36<05:44,  2.97s/it]
test ppl:  51%|█████▏    | 121/236 [07:42<07:22,  3.85s/it]
test ppl:  52%|█████▏    | 122/236 [07:47<07:52,  4.14s/it]
test ppl:  52%|█████▏    | 123/236 [07:49<06:41,  3.55s/it]
test ppl:  53%|█████▎    | 124/236 [07:52<06:11,  3.32s/it]
test ppl:  53%|█████▎    | 125/236 [07:55<05:41,  3.08s/it]
test ppl:  53%|█████▎    | 126/236 [07:58<05:59,  3.27s/it]
test ppl:  54%|█████▍    | 127/236 [08:00<05:11,  2.85s/it]
test ppl:  54%|█████▍    | 128/236 [08:03<04:49,  2.68s/it]
test ppl:  55%|█████▍    | 129/236 [08:06<05:01,  2.81s/it]
test ppl:  55%|█████▌    | 130/236 [08:10<05:50,  3.30s/it]
test ppl:  56%|█████▌    | 131/236 [08:16<07:09,  4.09s/it]
test ppl:  56%|█████▌    | 132/236 [08:18<06:15,  3.61s/it]
test ppl:  56%|█████▋    | 133/236 [08:22<06:22,  3.71s/it]
test ppl:  57%|█████▋    | 134/236 [08:28<07:16,  4.28s/it]
test ppl:  57%|█████▋    | 135/236 [08:34<08:00,  4.76s/it]
test ppl:  58%|█████▊    | 136/236 [08:35<06:09,  3.70s/it]
test ppl:  58%|█████▊    | 137/236 [08:41<07:12,  4.37s/it]
test ppl:  58%|█████▊    | 138/236 [08:44<06:34,  4.03s/it]
test ppl:  59%|█████▉    | 139/236 [08:47<05:48,  3.59s/it]
test ppl:  59%|█████▉    | 140/236 [08:49<04:51,  3.04s/it]
test ppl:  60%|█████▉    | 141/236 [08:52<04:44,  2.99s/it]
test ppl:  60%|██████    | 142/236 [08:54<04:17,  2.74s/it]
test ppl:  61%|██████    | 143/236 [09:00<05:43,  3.70s/it]
test ppl:  61%|██████    | 144/236 [09:02<05:14,  3.41s/it]
test ppl:  61%|██████▏   | 145/236 [09:08<06:08,  4.05s/it]
test ppl:  62%|██████▏   | 146/236 [09:12<06:19,  4.22s/it]
test ppl:  62%|██████▏   | 147/236 [09:18<07:01,  4.73s/it]
test ppl:  63%|██████▎   | 148/236 [09:24<07:30,  5.12s/it]
test ppl:  63%|██████▎   | 149/236 [09:28<06:40,  4.60s/it]
test ppl:  64%|██████▎   | 150/236 [09:32<06:21,  4.44s/it]
test ppl:  64%|██████▍   | 151/236 [09:38<06:54,  4.88s/it]
test ppl:  64%|██████▍   | 152/236 [09:44<07:15,  5.19s/it]
test ppl:  65%|██████▍   | 153/236 [09:50<07:28,  5.40s/it]
test ppl:  65%|██████▌   | 154/236 [09:53<06:23,  4.67s/it]
test ppl:  66%|██████▌   | 155/236 [09:56<05:43,  4.23s/it]
test ppl:  66%|██████▌   | 156/236 [09:58<04:59,  3.74s/it]
test ppl:  67%|██████▋   | 157/236 [10:01<04:29,  3.41s/it]
test ppl:  67%|██████▋   | 158/236 [10:08<05:50,  4.49s/it]
test ppl:  67%|██████▋   | 159/236 [10:15<06:44,  5.25s/it]
test ppl:  68%|██████▊   | 160/236 [10:16<05:11,  4.09s/it]
test ppl:  68%|██████▊   | 161/236 [10:18<04:11,  3.36s/it]
test ppl:  69%|██████▊   | 162/236 [10:22<04:20,  3.52s/it]
test ppl:  69%|██████▉   | 163/236 [10:25<04:08,  3.41s/it]
test ppl:  69%|██████▉   | 164/236 [10:29<04:13,  3.52s/it]
test ppl:  70%|██████▉   | 165/236 [10:32<04:00,  3.39s/it]
test ppl:  70%|███████   | 166/236 [10:36<04:06,  3.52s/it]
test ppl:  71%|███████   | 167/236 [10:38<03:27,  3.01s/it]
test ppl:  71%|███████   | 168/236 [10:45<04:52,  4.30s/it]
test ppl:  72%|███████▏  | 169/236 [10:52<05:37,  5.04s/it]
test ppl:  72%|███████▏  | 170/236 [10:59<06:18,  5.74s/it]
test ppl:  72%|███████▏  | 171/236 [11:01<04:53,  4.51s/it]
test ppl:  73%|███████▎  | 172/236 [11:04<04:16,  4.01s/it]
test ppl:  73%|███████▎  | 173/236 [11:08<04:18,  4.11s/it]
test ppl:  74%|███████▎  | 174/236 [11:15<05:15,  5.09s/it]
test ppl:  74%|███████▍  | 175/236 [11:18<04:18,  4.24s/it]
test ppl:  75%|███████▍  | 176/236 [11:24<04:47,  4.79s/it]
test ppl:  75%|███████▌  | 177/236 [11:31<05:28,  5.56s/it]
test ppl:  75%|███████▌  | 178/236 [11:38<05:54,  6.11s/it]
test ppl:  76%|███████▌  | 179/236 [11:46<06:09,  6.48s/it]
test ppl:  76%|███████▋  | 180/236 [11:51<05:50,  6.25s/it]
test ppl:  77%|███████▋  | 181/236 [11:59<06:01,  6.57s/it]
test ppl:  77%|███████▋  | 182/236 [12:01<04:46,  5.30s/it]
test ppl:  78%|███████▊  | 183/236 [12:04<04:01,  4.56s/it]
test ppl:  78%|███████▊  | 184/236 [12:06<03:13,  3.72s/it]
test ppl:  78%|███████▊  | 185/236 [12:11<03:36,  4.24s/it]
test ppl:  79%|███████▉  | 186/236 [12:18<04:18,  5.17s/it]
test ppl:  79%|███████▉  | 187/236 [12:26<04:46,  5.84s/it]
test ppl:  80%|███████▉  | 188/236 [12:33<05:01,  6.29s/it]
test ppl:  80%|████████  | 189/236 [12:41<05:10,  6.60s/it]
test ppl:  81%|████████  | 190/236 [12:45<04:35,  5.99s/it]
test ppl:  81%|████████  | 191/236 [12:51<04:21,  5.81s/it]
test ppl:  81%|████████▏ | 192/236 [12:54<03:42,  5.05s/it]
test ppl:  82%|████████▏ | 193/236 [13:01<04:06,  5.74s/it]
test ppl:  82%|████████▏ | 194/236 [13:04<03:29,  4.99s/it]
test ppl:  83%|████████▎ | 195/236 [13:08<03:10,  4.64s/it]
test ppl:  83%|████████▎ | 196/236 [13:11<02:39,  3.99s/it]
test ppl:  83%|████████▎ | 197/236 [13:14<02:26,  3.75s/it]
test ppl:  84%|████████▍ | 198/236 [13:21<03:03,  4.83s/it]
test ppl:  84%|████████▍ | 199/236 [13:25<02:42,  4.39s/it]
test ppl:  85%|████████▍ | 200/236 [13:32<03:09,  5.27s/it]
test ppl:  85%|████████▌ | 201/236 [13:34<02:35,  4.44s/it]
test ppl:  86%|████████▌ | 202/236 [13:40<02:44,  4.83s/it]
test ppl:  86%|████████▌ | 203/236 [13:47<02:59,  5.45s/it]
test ppl:  86%|████████▋ | 204/236 [13:49<02:19,  4.36s/it]
test ppl:  87%|████████▋ | 205/236 [13:56<02:43,  5.27s/it]
test ppl:  87%|████████▋ | 206/236 [14:00<02:27,  4.92s/it]
test ppl:  88%|████████▊ | 207/236 [14:08<02:43,  5.64s/it]
test ppl:  88%|████████▊ | 208/236 [14:12<02:23,  5.12s/it]
test ppl:  89%|████████▊ | 209/236 [14:18<02:26,  5.43s/it]
test ppl:  89%|████████▉ | 210/236 [14:20<01:57,  4.50s/it]
test ppl:  89%|████████▉ | 211/236 [14:25<01:54,  4.59s/it]
test ppl:  90%|████████▉ | 212/236 [14:30<01:51,  4.66s/it]
test ppl:  90%|█████████ | 213/236 [14:36<01:55,  5.03s/it]
test ppl:  91%|█████████ | 214/236 [14:37<01:28,  4.01s/it]
test ppl:  91%|█████████ | 215/236 [14:43<01:36,  4.58s/it]
test ppl:  92%|█████████▏| 216/236 [14:46<01:19,  3.98s/it]
test ppl:  92%|█████████▏| 217/236 [14:52<01:27,  4.59s/it]
test ppl:  92%|█████████▏| 218/236 [14:54<01:08,  3.80s/it]
test ppl:  93%|█████████▎| 219/236 [15:00<01:15,  4.44s/it]
test ppl:  93%|█████████▎| 220/236 [15:05<01:18,  4.88s/it]
test ppl:  94%|█████████▎| 221/236 [15:09<01:05,  4.35s/it]
test ppl:  94%|█████████▍| 222/236 [15:15<01:07,  4.83s/it]
test ppl:  94%|█████████▍| 223/236 [15:20<01:07,  5.16s/it]
test ppl:  95%|█████████▍| 224/236 [15:22<00:48,  4.00s/it]
test ppl:  95%|█████████▌| 225/236 [15:28<00:50,  4.57s/it]
test ppl:  96%|█████████▌| 226/236 [15:31<00:42,  4.30s/it]
test ppl:  96%|█████████▌| 227/236 [15:34<00:33,  3.71s/it]
test ppl:  97%|█████████▋| 228/236 [15:36<00:25,  3.21s/it]
test ppl:  97%|█████████▋| 229/236 [15:42<00:28,  4.02s/it]
test ppl:  97%|█████████▋| 230/236 [15:45<00:23,  3.87s/it]
test ppl:  98%|█████████▊| 231/236 [15:49<00:18,  3.72s/it]
test ppl:  98%|█████████▊| 232/236 [15:50<00:12,  3.13s/it]
test ppl:  99%|█████████▊| 233/236 [15:52<00:08,  2.84s/it]
test ppl:  99%|█████████▉| 234/236 [15:54<00:04,  2.35s/it]
test ppl: 100%|█████████▉| 235/236 [16:00<00:03,  3.42s/it]
test ppl: 100%|██████████| 236/236 [16:00<00:00,  2.59s/it]
test ppl: 100%|██████████| 236/236 [16:00<00:00,  4.07s/it]
10/12/2024 21:40:17 - INFO - __main__ -    em: 0.2099
10/12/2024 21:40:17 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.2 60:  em: 0.2099

--------------------------------------------------------------------------------
Running experiment with knn_temp=60, lmbda=0.2, k=64
2024-10-12 21:40:24.042983: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 21:40:24.062487: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 21:40:24.084329: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 21:40:24.090954: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 21:40:24.106970: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 21:40:25.097103: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 21:40:26 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.2, knn_temp=60, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 21:40:26 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:34:54,  2.20it/s]
Adding feature api:   4%|▍         | 7079/187062 [00:00<00:10, 16947.32it/s]
Adding feature api:   8%|▊         | 15507/187062 [00:00<00:05, 34107.02it/s]
Adding feature api:  13%|█▎        | 23979/187062 [00:00<00:03, 47614.39it/s]
Adding feature api:  17%|█▋        | 32401/187062 [00:00<00:02, 57718.10it/s]
Adding feature api:  22%|██▏       | 40628/187062 [00:00<00:02, 64659.65it/s]
Adding feature api:  26%|██▋       | 49175/187062 [00:01<00:01, 70645.02it/s]
Adding feature api:  31%|███       | 57670/187062 [00:01<00:01, 74811.08it/s]
Adding feature api:  35%|███▌      | 66161/187062 [00:01<00:01, 77777.85it/s]
Adding feature api:  40%|███▉      | 74606/187062 [00:01<00:01, 79749.36it/s]
Adding feature api:  44%|████▍     | 82933/187062 [00:01<00:01, 80364.03it/s]
Adding feature api:  49%|████▉     | 91447/187062 [00:01<00:01, 81779.62it/s]
Adding feature api:  53%|█████▎    | 99975/187062 [00:01<00:01, 82818.45it/s]
Adding feature api:  58%|█████▊    | 108500/187062 [00:01<00:00, 83541.40it/s]
Adding feature api:  63%|██████▎   | 116941/187062 [00:01<00:00, 83063.79it/s]
Adding feature api:  67%|██████▋   | 125432/187062 [00:01<00:00, 83609.59it/s]
Adding feature api:  72%|███████▏  | 133956/187062 [00:02<00:00, 84094.79it/s]
Adding feature api:  76%|███████▌  | 142467/187062 [00:02<00:00, 84395.46it/s]
Adding feature api:  81%|████████  | 150929/187062 [00:02<00:00, 83949.28it/s]
Adding feature api:  85%|████████▌ | 159458/187062 [00:02<00:00, 84346.06it/s]
Adding feature api:  90%|████████▉ | 167929/187062 [00:02<00:00, 84453.93it/s]
Adding feature api:  94%|█████████▍| 176452/187062 [00:02<00:00, 84682.90it/s]
Adding feature api:  99%|█████████▉| 184926/187062 [00:02<00:00, 55751.41it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64518.13it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:12:34,  2.24it/s]
Adding feature datatype:   4%|▎         | 6761/187062 [00:00<00:11, 16382.30it/s]
Adding feature datatype:   8%|▊         | 14838/187062 [00:00<00:05, 32938.61it/s]
Adding feature datatype:  12%|█▏        | 22970/187062 [00:00<00:03, 45934.96it/s]
Adding feature datatype:  17%|█▋        | 31075/187062 [00:00<00:02, 55672.10it/s]
Adding feature datatype:  21%|██        | 39191/187062 [00:00<00:02, 62902.24it/s]
Adding feature datatype:  25%|██▌       | 47301/187062 [00:01<00:02, 68149.63it/s]
Adding feature datatype:  29%|██▉       | 55043/187062 [00:01<00:01, 70852.46it/s]
Adding feature datatype:  34%|███▍      | 63135/187062 [00:01<00:01, 73813.07it/s]
Adding feature datatype:  38%|███▊      | 71245/187062 [00:01<00:01, 75967.09it/s]
Adding feature datatype:  42%|████▏     | 79392/187062 [00:01<00:01, 77600.85it/s]
Adding feature datatype:  47%|████▋     | 87557/187062 [00:01<00:01, 78805.42it/s]
Adding feature datatype:  51%|█████     | 95602/187062 [00:01<00:01, 78683.48it/s]
Adding feature datatype:  55%|█████▌    | 103718/187062 [00:01<00:01, 79419.18it/s]
Adding feature datatype:  60%|█████▉    | 111882/187062 [00:01<00:00, 80079.03it/s]
Adding feature datatype:  64%|██████▍   | 120034/187062 [00:01<00:00, 80507.29it/s]
Adding feature datatype:  69%|██████▊   | 128226/187062 [00:02<00:00, 80929.08it/s]
Adding feature datatype:  73%|███████▎  | 136351/187062 [00:02<00:00, 81024.54it/s]
Adding feature datatype:  77%|███████▋  | 144474/187062 [00:02<00:00, 80250.14it/s]
Adding feature datatype:  82%|████████▏ | 152621/187062 [00:02<00:00, 80611.95it/s]
Adding feature datatype:  86%|████████▌ | 160814/187062 [00:02<00:00, 81001.80it/s]
Adding feature datatype:  90%|█████████ | 168961/187062 [00:02<00:00, 81138.29it/s]
Adding feature datatype:  95%|█████████▍| 177114/187062 [00:02<00:00, 81254.27it/s]
Adding feature datatype:  99%|█████████▉| 185244/187062 [00:02<00:00, 53160.73it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 62647.10it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:10:51,  2.24it/s]
Adding feature literal:   4%|▍         | 7074/187062 [00:00<00:10, 17156.97it/s]
Adding feature literal:   8%|▊         | 15139/187062 [00:00<00:05, 33494.93it/s]
Adding feature literal:  12%|█▏        | 23289/187062 [00:00<00:03, 46397.97it/s]
Adding feature literal:  17%|█▋        | 31412/187062 [00:00<00:02, 56061.73it/s]
Adding feature literal:  21%|██        | 39614/187062 [00:00<00:02, 63429.24it/s]
Adding feature literal:  26%|██▌       | 47757/187062 [00:01<00:02, 68621.66it/s]
Adding feature literal:  30%|██▉       | 55922/187062 [00:01<00:01, 72421.39it/s]
Adding feature literal:  34%|███▍      | 63995/187062 [00:01<00:01, 74863.99it/s]
Adding feature literal:  39%|███▊      | 72182/187062 [00:01<00:01, 76934.40it/s]
Adding feature literal:  43%|████▎     | 80241/187062 [00:01<00:01, 78018.39it/s]
Adding feature literal:  47%|████▋     | 88406/187062 [00:01<00:01, 79099.01it/s]
Adding feature literal:  52%|█████▏    | 96567/187062 [00:01<00:01, 79847.92it/s]
Adding feature literal:  56%|█████▌    | 104753/187062 [00:01<00:01, 80447.73it/s]
Adding feature literal:  60%|██████    | 112909/187062 [00:01<00:00, 80777.37it/s]
Adding feature literal:  65%|██████▍   | 121044/187062 [00:01<00:00, 80945.54it/s]
Adding feature literal:  69%|██████▉   | 129245/187062 [00:02<00:00, 81261.91it/s]
Adding feature literal:  73%|███████▎  | 137459/187062 [00:02<00:00, 81523.38it/s]
Adding feature literal:  78%|███████▊  | 145672/187062 [00:02<00:00, 81702.83it/s]
Adding feature literal:  82%|████████▏ | 153857/187062 [00:02<00:00, 81683.10it/s]
Adding feature literal:  87%|████████▋ | 162035/187062 [00:02<00:00, 81688.58it/s]
Adding feature literal:  91%|█████████ | 170254/187062 [00:02<00:00, 81836.69it/s]
Adding feature literal:  95%|█████████▌| 178443/187062 [00:02<00:00, 77346.01it/s]
Adding feature literal: 100%|█████████▉| 186232/187062 [00:02<00:00, 51989.35it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63123.20it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:16:08,  2.23it/s]
Adding feature operator:   4%|▍         | 7032/187062 [00:00<00:10, 17006.02it/s]
Adding feature operator:   8%|▊         | 15124/187062 [00:00<00:05, 33417.05it/s]
Adding feature operator:  12%|█▏        | 23260/187062 [00:00<00:03, 46283.42it/s]
Adding feature operator:  17%|█▋        | 31438/187062 [00:00<00:02, 56120.10it/s]
Adding feature operator:  21%|██        | 39589/187062 [00:00<00:02, 63320.20it/s]
Adding feature operator:  25%|██▌       | 47625/187062 [00:01<00:02, 68230.75it/s]
Adding feature operator:  30%|██▉       | 55788/187062 [00:01<00:01, 72138.27it/s]
Adding feature operator:  34%|███▍      | 63962/187062 [00:01<00:01, 74961.85it/s]
Adding feature operator:  39%|███▊      | 72113/187062 [00:01<00:01, 76898.02it/s]
Adding feature operator:  43%|████▎     | 80315/187062 [00:01<00:01, 78417.53it/s]
Adding feature operator:  47%|████▋     | 88570/187062 [00:01<00:01, 79646.78it/s]
Adding feature operator:  52%|█████▏    | 96756/187062 [00:01<00:01, 80305.76it/s]
Adding feature operator:  56%|█████▌    | 104929/187062 [00:01<00:01, 80730.98it/s]
Adding feature operator:  60%|██████    | 113087/187062 [00:01<00:00, 80984.07it/s]
Adding feature operator:  65%|██████▍   | 121289/187062 [00:01<00:00, 81292.09it/s]
Adding feature operator:  69%|██████▉   | 129459/187062 [00:02<00:00, 81379.69it/s]
Adding feature operator:  74%|███████▎  | 137646/187062 [00:02<00:00, 81525.71it/s]
Adding feature operator:  78%|███████▊  | 145902/187062 [00:02<00:00, 81835.19it/s]
Adding feature operator:  82%|████████▏ | 154100/187062 [00:02<00:00, 81828.21it/s]
Adding feature operator:  87%|████████▋ | 162299/187062 [00:02<00:00, 81875.91it/s]
Adding feature operator:  91%|█████████ | 170494/187062 [00:02<00:00, 81893.23it/s]
Adding feature operator:  96%|█████████▌| 178689/187062 [00:02<00:00, 76580.58it/s]
Adding feature operator: 100%|█████████▉| 186421/187062 [00:02<00:00, 51943.28it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63208.90it/s]
[2024-10-12 21:41:10,279] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 21:41:11 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 21:41:11 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 413.29 examples/s]
Map:   2%|▏         | 108/6548 [00:00<00:25, 248.94 examples/s]
Map:   2%|▏         | 152/6548 [00:00<00:21, 298.67 examples/s]
Map:   3%|▎         | 212/6548 [00:00<00:18, 334.48 examples/s]
Map:   4%|▍         | 268/6548 [00:00<00:18, 336.56 examples/s]
Map:   5%|▍         | 304/6548 [00:00<00:18, 335.91 examples/s]
Map:   5%|▌         | 351/6548 [00:01<00:18, 327.41 examples/s]
Map:   6%|▌         | 400/6548 [00:01<00:16, 365.38 examples/s]
Map:   7%|▋         | 454/6548 [00:01<00:17, 352.79 examples/s]
Map:   8%|▊         | 511/6548 [00:01<00:17, 351.61 examples/s]
Map:   9%|▊         | 564/6548 [00:01<00:15, 389.59 examples/s]
Map:   9%|▉         | 606/6548 [00:01<00:15, 393.61 examples/s]
Map:  10%|█         | 660/6548 [00:01<00:17, 332.45 examples/s]
Map:  11%|█         | 706/6548 [00:02<00:16, 357.74 examples/s]
Map:  11%|█▏        | 748/6548 [00:02<00:15, 369.45 examples/s]
Map:  12%|█▏        | 800/6548 [00:02<00:14, 405.75 examples/s]
Map:  13%|█▎        | 862/6548 [00:02<00:14, 405.80 examples/s]
Map:  14%|█▍        | 916/6548 [00:02<00:14, 388.58 examples/s]
Map:  15%|█▍        | 970/6548 [00:02<00:15, 369.42 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:23, 239.92 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:20, 263.90 examples/s]
Map:  17%|█▋        | 1100/6548 [00:03<00:18, 297.62 examples/s]
Map:  18%|█▊        | 1150/6548 [00:03<00:15, 338.02 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 349.87 examples/s]
Map:  19%|█▉        | 1250/6548 [00:03<00:14, 359.61 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:14, 370.21 examples/s]
Map:  21%|██        | 1355/6548 [00:04<00:16, 314.63 examples/s]
Map:  21%|██▏       | 1401/6548 [00:04<00:16, 309.96 examples/s]
Map:  22%|██▏       | 1436/6548 [00:04<00:17, 289.61 examples/s]
Map:  23%|██▎       | 1474/6548 [00:04<00:18, 275.51 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:17, 289.34 examples/s]
Map:  24%|██▎       | 1542/6548 [00:04<00:17, 286.67 examples/s]
Map:  24%|██▍       | 1577/6548 [00:04<00:16, 301.36 examples/s]
Map:  25%|██▍       | 1612/6548 [00:04<00:18, 266.78 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:17, 274.25 examples/s]
Map:  26%|██▌       | 1687/6548 [00:05<00:17, 273.47 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:16, 299.88 examples/s]
Map:  27%|██▋       | 1770/6548 [00:05<00:14, 330.85 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:13, 338.57 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 351.21 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 348.38 examples/s]
Map:  30%|██▉       | 1947/6548 [00:05<00:12, 360.82 examples/s]
Map:  30%|███       | 1991/6548 [00:06<00:12, 376.04 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:19, 226.13 examples/s]
Map:  32%|███▏      | 2071/6548 [00:06<00:17, 257.82 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 268.60 examples/s]
Map:  33%|███▎      | 2142/6548 [00:06<00:17, 257.64 examples/s]
Map:  33%|███▎      | 2181/6548 [00:06<00:15, 283.85 examples/s]
Map:  34%|███▍      | 2213/6548 [00:06<00:14, 290.98 examples/s]
Map:  34%|███▍      | 2253/6548 [00:07<00:15, 271.42 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:15, 275.75 examples/s]
Map:  36%|███▌      | 2331/6548 [00:07<00:13, 312.91 examples/s]
Map:  36%|███▋      | 2381/6548 [00:07<00:13, 319.06 examples/s]
Map:  37%|███▋      | 2420/6548 [00:07<00:12, 335.83 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:12, 322.64 examples/s]
Map:  38%|███▊      | 2496/6548 [00:07<00:12, 327.77 examples/s]
Map:  39%|███▉      | 2556/6548 [00:08<00:11, 346.37 examples/s]
Map:  40%|███▉      | 2600/6548 [00:08<00:10, 366.59 examples/s]
Map:  40%|████      | 2640/6548 [00:08<00:10, 374.16 examples/s]
Map:  41%|████      | 2694/6548 [00:08<00:10, 351.74 examples/s]
Map:  42%|████▏     | 2745/6548 [00:08<00:11, 345.24 examples/s]
Map:  43%|████▎     | 2795/6548 [00:08<00:11, 339.15 examples/s]
Map:  43%|████▎     | 2841/6548 [00:08<00:13, 275.03 examples/s]
Map:  44%|████▍     | 2879/6548 [00:09<00:12, 292.08 examples/s]
Map:  45%|████▍     | 2926/6548 [00:09<00:12, 282.85 examples/s]
Map:  45%|████▌     | 2963/6548 [00:09<00:12, 296.35 examples/s]
Map:  46%|████▌     | 2997/6548 [00:09<00:15, 236.23 examples/s]
Map:  46%|████▌     | 3026/6548 [00:09<00:21, 164.58 examples/s]
Map:  47%|████▋     | 3058/6548 [00:10<00:18, 187.15 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 211.27 examples/s]
Map:  48%|████▊     | 3133/6548 [00:10<00:13, 249.48 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:13, 246.62 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 243.78 examples/s]
Map:  49%|████▉     | 3238/6548 [00:10<00:12, 264.79 examples/s]
Map:  50%|████▉     | 3269/6548 [00:10<00:12, 270.89 examples/s]
Map:  50%|█████     | 3298/6548 [00:10<00:11, 275.53 examples/s]
Map:  51%|█████     | 3335/6548 [00:10<00:10, 299.83 examples/s]
Map:  52%|█████▏    | 3382/6548 [00:11<00:10, 301.57 examples/s]
Map:  52%|█████▏    | 3420/6548 [00:11<00:11, 281.28 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 269.05 examples/s]
Map:  53%|█████▎    | 3495/6548 [00:11<00:11, 267.60 examples/s]
Map:  54%|█████▍    | 3545/6548 [00:11<00:09, 317.23 examples/s]
Map:  55%|█████▍    | 3591/6548 [00:11<00:08, 350.84 examples/s]
Map:  56%|█████▌    | 3636/6548 [00:11<00:07, 375.27 examples/s]
Map:  56%|█████▋    | 3688/6548 [00:12<00:07, 362.37 examples/s]
Map:  57%|█████▋    | 3733/6548 [00:12<00:07, 381.84 examples/s]
Map:  58%|█████▊    | 3786/6548 [00:12<00:07, 366.23 examples/s]
Map:  59%|█████▊    | 3839/6548 [00:12<00:08, 330.84 examples/s]
Map:  59%|█████▉    | 3889/6548 [00:12<00:08, 331.15 examples/s]
Map:  60%|█████▉    | 3924/6548 [00:12<00:08, 316.88 examples/s]
Map:  60%|██████    | 3957/6548 [00:12<00:08, 318.66 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 231.08 examples/s]
Map:  62%|██████▏   | 4055/6548 [00:13<00:08, 290.88 examples/s]
Map:  63%|██████▎   | 4097/6548 [00:13<00:07, 316.12 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 327.16 examples/s]
Map:  64%|██████▍   | 4195/6548 [00:13<00:07, 329.64 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:06, 333.65 examples/s]
Map:  65%|██████▌   | 4282/6548 [00:13<00:06, 359.53 examples/s]
Map:  66%|██████▌   | 4324/6548 [00:13<00:06, 369.10 examples/s]
Map:  67%|██████▋   | 4378/6548 [00:14<00:05, 364.98 examples/s]
Map:  68%|██████▊   | 4420/6548 [00:14<00:05, 362.07 examples/s]
Map:  68%|██████▊   | 4459/6548 [00:14<00:05, 366.32 examples/s]
Map:  69%|██████▉   | 4502/6548 [00:14<00:06, 296.87 examples/s]
Map:  69%|██████▉   | 4547/6548 [00:14<00:06, 296.59 examples/s]
Map:  70%|███████   | 4584/6548 [00:14<00:06, 306.14 examples/s]
Map:  71%|███████   | 4633/6548 [00:14<00:05, 343.30 examples/s]
Map:  72%|███████▏  | 4682/6548 [00:15<00:05, 335.96 examples/s]
Map:  72%|███████▏  | 4730/6548 [00:15<00:05, 357.38 examples/s]
Map:  73%|███████▎  | 4771/6548 [00:15<00:04, 367.43 examples/s]
Map:  74%|███████▎  | 4823/6548 [00:15<00:04, 406.16 examples/s]
Map:  74%|███████▍  | 4874/6548 [00:15<00:04, 338.55 examples/s]
Map:  75%|███████▌  | 4913/6548 [00:15<00:04, 348.96 examples/s]
Map:  76%|███████▌  | 4970/6548 [00:15<00:03, 400.59 examples/s]
Map:  77%|███████▋  | 5013/6548 [00:16<00:06, 237.32 examples/s]
Map:  77%|███████▋  | 5056/6548 [00:16<00:05, 262.76 examples/s]
Map:  78%|███████▊  | 5103/6548 [00:16<00:05, 274.19 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 282.69 examples/s]
Map:  79%|███████▉  | 5205/6548 [00:16<00:04, 284.82 examples/s]
Map:  80%|████████  | 5256/6548 [00:16<00:04, 282.43 examples/s]
Map:  81%|████████  | 5303/6548 [00:17<00:03, 318.70 examples/s]
Map:  82%|████████▏ | 5346/6548 [00:17<00:04, 286.02 examples/s]
Map:  82%|████████▏ | 5385/6548 [00:17<00:03, 305.59 examples/s]
Map:  83%|████████▎ | 5424/6548 [00:17<00:04, 279.88 examples/s]
Map:  83%|████████▎ | 5461/6548 [00:17<00:03, 295.49 examples/s]
Map:  84%|████████▍ | 5502/6548 [00:17<00:03, 320.91 examples/s]
Map:  85%|████████▍ | 5540/6548 [00:17<00:03, 335.19 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:18<00:03, 306.84 examples/s]
Map:  86%|████████▌ | 5639/6548 [00:18<00:02, 359.14 examples/s]
Map:  87%|████████▋ | 5680/6548 [00:18<00:02, 318.89 examples/s]
Map:  88%|████████▊ | 5733/6548 [00:18<00:02, 327.24 examples/s]
Map:  88%|████████▊ | 5772/6548 [00:18<00:02, 340.40 examples/s]
Map:  89%|████████▉ | 5825/6548 [00:18<00:02, 339.66 examples/s]
Map:  90%|████████▉ | 5864/6548 [00:18<00:01, 349.13 examples/s]
Map:  90%|█████████ | 5901/6548 [00:18<00:01, 353.31 examples/s]
Map:  91%|█████████ | 5938/6548 [00:19<00:01, 355.09 examples/s]
Map:  91%|█████████▏| 5987/6548 [00:19<00:01, 337.44 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 229.60 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 265.35 examples/s]
Map:  93%|█████████▎| 6120/6548 [00:19<00:01, 255.25 examples/s]
Map:  94%|█████████▍| 6154/6548 [00:19<00:01, 269.78 examples/s]
Map:  94%|█████████▍| 6187/6548 [00:20<00:01, 281.00 examples/s]
Map:  95%|█████████▌| 6228/6548 [00:20<00:01, 310.96 examples/s]
Map:  96%|█████████▌| 6265/6548 [00:20<00:00, 324.91 examples/s]
Map:  96%|█████████▋| 6305/6548 [00:20<00:00, 343.76 examples/s]
Map:  97%|█████████▋| 6365/6548 [00:20<00:00, 361.92 examples/s]
Map:  98%|█████████▊| 6418/6548 [00:20<00:00, 351.51 examples/s]
Map:  99%|█████████▊| 6465/6548 [00:20<00:00, 375.77 examples/s]
Map:  99%|█████████▉| 6515/6548 [00:20<00:00, 359.82 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 310.62 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   3%|▎         | 29/903 [00:00<00:03, 270.45 examples/s]
Map:   7%|▋         | 62/903 [00:00<00:02, 290.65 examples/s]
Map:  11%|█         | 96/903 [00:00<00:02, 304.10 examples/s]
Map:  15%|█▍        | 133/903 [00:00<00:02, 323.17 examples/s]
Map:  20%|██        | 184/903 [00:00<00:01, 377.45 examples/s]
Map:  27%|██▋       | 240/903 [00:00<00:01, 368.71 examples/s]
Map:  31%|███▏      | 284/903 [00:00<00:01, 365.41 examples/s]
Map:  37%|███▋      | 336/903 [00:00<00:01, 355.09 examples/s]
Map:  43%|████▎     | 390/903 [00:01<00:01, 294.81 examples/s]
Map:  48%|████▊     | 433/903 [00:01<00:01, 322.02 examples/s]
Map:  53%|█████▎    | 478/903 [00:01<00:01, 309.26 examples/s]
Map:  57%|█████▋    | 514/903 [00:01<00:01, 319.94 examples/s]
Map:  62%|██████▏   | 560/903 [00:01<00:00, 349.89 examples/s]
Map:  68%|██████▊   | 610/903 [00:01<00:00, 381.18 examples/s]
Map:  73%|███████▎  | 659/903 [00:01<00:00, 359.93 examples/s]
Map:  77%|███████▋  | 698/903 [00:02<00:00, 365.86 examples/s]
Map:  82%|████████▏ | 740/903 [00:02<00:00, 377.28 examples/s]
Map:  87%|████████▋ | 782/903 [00:02<00:00, 375.34 examples/s]
Map:  91%|█████████▏| 825/903 [00:02<00:00, 385.22 examples/s]
Map:  97%|█████████▋| 877/903 [00:02<00:00, 350.42 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 316.13 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 31/1882 [00:00<00:07, 242.00 examples/s]
Map:   4%|▍         | 76/1882 [00:00<00:05, 350.13 examples/s]
Map:   7%|▋         | 124/1882 [00:00<00:05, 324.86 examples/s]
Map:   9%|▉         | 166/1882 [00:00<00:04, 354.70 examples/s]
Map:  11%|█         | 203/1882 [00:00<00:05, 335.65 examples/s]
Map:  13%|█▎        | 252/1882 [00:00<00:04, 381.19 examples/s]
Map:  16%|█▌        | 301/1882 [00:00<00:04, 354.91 examples/s]
Map:  18%|█▊        | 343/1882 [00:00<00:04, 371.39 examples/s]
Map:  21%|██        | 394/1882 [00:01<00:04, 316.66 examples/s]
Map:  23%|██▎       | 442/1882 [00:01<00:04, 310.41 examples/s]
Map:  25%|██▌       | 475/1882 [00:01<00:04, 311.84 examples/s]
Map:  28%|██▊       | 526/1882 [00:01<00:04, 307.26 examples/s]
Map:  30%|███       | 569/1882 [00:01<00:03, 331.11 examples/s]
Map:  33%|███▎      | 613/1882 [00:01<00:03, 355.07 examples/s]
Map:  35%|███▍      | 657/1882 [00:01<00:03, 376.13 examples/s]
Map:  37%|███▋      | 704/1882 [00:02<00:03, 389.28 examples/s]
Map:  40%|███▉      | 744/1882 [00:02<00:02, 390.06 examples/s]
Map:  42%|████▏     | 791/1882 [00:02<00:03, 357.08 examples/s]
Map:  45%|████▌     | 848/1882 [00:02<00:02, 359.72 examples/s]
Map:  47%|████▋     | 891/1882 [00:02<00:02, 372.06 examples/s]
Map:  49%|████▉     | 930/1882 [00:02<00:02, 370.28 examples/s]
Map:  52%|█████▏    | 980/1882 [00:02<00:02, 403.59 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 254.61 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 267.79 examples/s]
Map:  59%|█████▉    | 1107/1882 [00:03<00:02, 280.14 examples/s]
Map:  61%|██████▏   | 1156/1882 [00:03<00:02, 291.00 examples/s]
Map:  63%|██████▎   | 1192/1882 [00:03<00:02, 274.23 examples/s]
Map:  66%|██████▌   | 1235/1882 [00:03<00:02, 306.65 examples/s]
Map:  68%|██████▊   | 1287/1882 [00:03<00:01, 315.80 examples/s]
Map:  71%|███████   | 1334/1882 [00:04<00:01, 348.77 examples/s]
Map:  73%|███████▎  | 1381/1882 [00:04<00:01, 330.99 examples/s]
Map:  75%|███████▌  | 1419/1882 [00:04<00:01, 296.49 examples/s]
Map:  78%|███████▊  | 1465/1882 [00:04<00:01, 296.48 examples/s]
Map:  80%|███████▉  | 1502/1882 [00:04<00:01, 266.49 examples/s]
Map:  82%|████████▏ | 1540/1882 [00:04<00:01, 258.85 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:04<00:01, 289.68 examples/s]
Map:  86%|████████▋ | 1626/1882 [00:05<00:00, 320.06 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 323.83 examples/s]
Map:  90%|█████████ | 1698/1882 [00:05<00:00, 328.91 examples/s]
Map:  92%|█████████▏| 1734/1882 [00:05<00:00, 285.45 examples/s]
Map:  95%|█████████▍| 1780/1882 [00:05<00:00, 288.61 examples/s]
Map:  97%|█████████▋| 1822/1882 [00:05<00:00, 317.44 examples/s]
Map:  99%|█████████▉| 1860/1882 [00:05<00:00, 332.79 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 311.26 examples/s]
10/12/2024 21:42:13 - INFO - __main__ -     ***** Testing *****
10/12/2024 21:42:13 - INFO - __main__ -     Batch size = 8
10/12/2024 21:42:13 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 21:42:14 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 21:42:14 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 21:42:15 - INFO - knnlm -   Reading datastore took 0.9736063480377197 s
10/12/2024 21:42:16 - INFO - knnlm -   Moving index to GPU took 0.9038245677947998 s
10/12/2024 21:42:16 - INFO - __main__ -   ******************************break-into
10/12/2024 21:42:16 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 21:42:16 - INFO - __main__ -     Num examples = 236
10/12/2024 21:42:16 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:32,  7.80s/it]
test ppl:   1%|          | 2/236 [00:09<16:59,  4.36s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:52,  3.06s/it]
test ppl:   2%|▏         | 4/236 [00:12<09:40,  2.50s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:16,  3.71s/it]
test ppl:   3%|▎         | 6/236 [00:21<12:23,  3.23s/it]
test ppl:   3%|▎         | 7/236 [00:23<11:27,  3.00s/it]
test ppl:   3%|▎         | 8/236 [00:27<12:57,  3.41s/it]
test ppl:   4%|▍         | 9/236 [00:33<15:49,  4.18s/it]
test ppl:   4%|▍         | 10/236 [00:36<14:24,  3.83s/it]
test ppl:   5%|▍         | 11/236 [00:39<12:40,  3.38s/it]
test ppl:   5%|▌         | 12/236 [00:45<15:26,  4.14s/it]
test ppl:   6%|▌         | 13/236 [00:49<16:08,  4.34s/it]
test ppl:   6%|▌         | 14/236 [00:55<17:50,  4.82s/it]
test ppl:   6%|▋         | 15/236 [00:58<15:01,  4.08s/it]
test ppl:   7%|▋         | 16/236 [00:59<12:30,  3.41s/it]
test ppl:   7%|▋         | 17/236 [01:05<15:09,  4.15s/it]
test ppl:   8%|▊         | 18/236 [01:07<12:24,  3.41s/it]
test ppl:   8%|▊         | 19/236 [01:11<13:27,  3.72s/it]
test ppl:   8%|▊         | 20/236 [01:13<11:17,  3.14s/it]
test ppl:   9%|▉         | 21/236 [01:16<10:18,  2.88s/it]
test ppl:   9%|▉         | 22/236 [01:21<13:28,  3.78s/it]
test ppl:  10%|▉         | 23/236 [01:24<12:04,  3.40s/it]
test ppl:  10%|█         | 24/236 [01:26<10:55,  3.09s/it]
test ppl:  11%|█         | 25/236 [01:28<09:32,  2.71s/it]
test ppl:  11%|█         | 26/236 [01:34<12:50,  3.67s/it]
test ppl:  11%|█▏        | 27/236 [01:38<13:19,  3.82s/it]
test ppl:  12%|█▏        | 28/236 [01:39<10:32,  3.04s/it]
test ppl:  12%|█▏        | 29/236 [01:42<09:45,  2.83s/it]
test ppl:  13%|█▎        | 30/236 [01:43<08:22,  2.44s/it]
test ppl:  13%|█▎        | 31/236 [01:46<08:47,  2.57s/it]
test ppl:  14%|█▎        | 32/236 [01:49<09:03,  2.67s/it]
test ppl:  14%|█▍        | 33/236 [01:55<12:18,  3.64s/it]
test ppl:  14%|█▍        | 34/236 [01:59<12:37,  3.75s/it]
test ppl:  15%|█▍        | 35/236 [02:02<11:21,  3.39s/it]
test ppl:  15%|█▌        | 36/236 [02:07<13:46,  4.13s/it]
test ppl:  16%|█▌        | 37/236 [02:13<15:29,  4.67s/it]
test ppl:  16%|█▌        | 38/236 [02:15<12:50,  3.89s/it]
test ppl:  17%|█▋        | 39/236 [02:17<10:25,  3.18s/it]
test ppl:  17%|█▋        | 40/236 [02:20<09:54,  3.03s/it]
test ppl:  17%|█▋        | 41/236 [02:22<09:21,  2.88s/it]
test ppl:  18%|█▊        | 42/236 [02:28<12:17,  3.80s/it]
test ppl:  18%|█▊        | 43/236 [02:34<14:13,  4.42s/it]
test ppl:  19%|█▊        | 44/236 [02:36<11:48,  3.69s/it]
test ppl:  19%|█▉        | 45/236 [02:38<10:06,  3.18s/it]
test ppl:  19%|█▉        | 46/236 [02:43<11:56,  3.77s/it]
test ppl:  20%|█▉        | 47/236 [02:49<13:54,  4.42s/it]
test ppl:  20%|██        | 48/236 [02:55<15:14,  4.86s/it]
test ppl:  21%|██        | 49/236 [02:58<13:43,  4.40s/it]
test ppl:  21%|██        | 50/236 [03:04<15:06,  4.87s/it]
test ppl:  22%|██▏       | 51/236 [03:10<16:00,  5.19s/it]
test ppl:  22%|██▏       | 52/236 [03:16<16:35,  5.41s/it]
test ppl:  22%|██▏       | 53/236 [03:22<16:33,  5.43s/it]
test ppl:  23%|██▎       | 54/236 [03:23<12:56,  4.27s/it]
test ppl:  23%|██▎       | 55/236 [03:29<14:09,  4.69s/it]
test ppl:  24%|██▎       | 56/236 [03:32<12:56,  4.31s/it]
test ppl:  24%|██▍       | 57/236 [03:35<11:18,  3.79s/it]
test ppl:  25%|██▍       | 58/236 [03:37<09:49,  3.31s/it]
test ppl:  25%|██▌       | 59/236 [03:43<12:05,  4.10s/it]
test ppl:  25%|██▌       | 60/236 [03:46<11:15,  3.84s/it]
test ppl:  26%|██▌       | 61/236 [03:52<12:58,  4.45s/it]
test ppl:  26%|██▋       | 62/236 [03:56<12:38,  4.36s/it]
test ppl:  27%|██▋       | 63/236 [03:59<10:56,  3.79s/it]
test ppl:  27%|██▋       | 64/236 [04:00<08:55,  3.11s/it]
test ppl:  28%|██▊       | 65/236 [04:01<07:20,  2.58s/it]
test ppl:  28%|██▊       | 66/236 [04:04<07:38,  2.70s/it]
test ppl:  28%|██▊       | 67/236 [04:08<08:42,  3.09s/it]
test ppl:  29%|██▉       | 68/236 [04:14<11:01,  3.94s/it]
test ppl:  29%|██▉       | 69/236 [04:20<12:36,  4.53s/it]
test ppl:  30%|██▉       | 70/236 [04:22<10:05,  3.65s/it]
test ppl:  30%|███       | 71/236 [04:26<10:20,  3.76s/it]
test ppl:  31%|███       | 72/236 [04:30<10:20,  3.78s/it]
test ppl:  31%|███       | 73/236 [04:34<10:21,  3.81s/it]
test ppl:  31%|███▏      | 74/236 [04:35<08:25,  3.12s/it]
test ppl:  32%|███▏      | 75/236 [04:41<10:37,  3.96s/it]
test ppl:  32%|███▏      | 76/236 [04:45<10:37,  3.98s/it]
test ppl:  33%|███▎      | 77/236 [04:47<09:12,  3.48s/it]
test ppl:  33%|███▎      | 78/236 [04:49<07:55,  3.01s/it]
test ppl:  33%|███▎      | 79/236 [04:54<09:28,  3.62s/it]
test ppl:  34%|███▍      | 80/236 [04:56<08:06,  3.12s/it]
test ppl:  34%|███▍      | 81/236 [05:02<10:12,  3.95s/it]
test ppl:  35%|███▍      | 82/236 [05:08<11:40,  4.55s/it]
test ppl:  35%|███▌      | 83/236 [05:10<09:39,  3.79s/it]
test ppl:  36%|███▌      | 84/236 [05:12<08:09,  3.22s/it]
test ppl:  36%|███▌      | 85/236 [05:18<09:57,  3.96s/it]
test ppl:  36%|███▋      | 86/236 [05:20<08:34,  3.43s/it]
test ppl:  37%|███▋      | 87/236 [05:22<07:31,  3.03s/it]
test ppl:  37%|███▋      | 88/236 [05:28<09:34,  3.88s/it]
test ppl:  38%|███▊      | 89/236 [05:34<10:59,  4.48s/it]
test ppl:  38%|███▊      | 90/236 [05:40<11:57,  4.91s/it]
test ppl:  39%|███▊      | 91/236 [05:46<12:33,  5.20s/it]
test ppl:  39%|███▉      | 92/236 [05:48<10:45,  4.49s/it]
test ppl:  39%|███▉      | 93/236 [05:54<11:41,  4.90s/it]
test ppl:  40%|███▉      | 94/236 [06:00<12:18,  5.20s/it]
test ppl:  40%|████      | 95/236 [06:04<10:55,  4.65s/it]
test ppl:  41%|████      | 96/236 [06:07<09:41,  4.15s/it]
test ppl:  41%|████      | 97/236 [06:12<10:49,  4.67s/it]
test ppl:  42%|████▏     | 98/236 [06:18<11:35,  5.04s/it]
test ppl:  42%|████▏     | 99/236 [06:24<12:05,  5.30s/it]
test ppl:  42%|████▏     | 100/236 [06:26<09:18,  4.11s/it]
test ppl:  43%|████▎     | 101/236 [06:31<10:26,  4.64s/it]
test ppl:  43%|████▎     | 102/236 [06:35<09:41,  4.34s/it]
test ppl:  44%|████▎     | 103/236 [06:37<08:09,  3.68s/it]
test ppl:  44%|████▍     | 104/236 [06:41<08:29,  3.86s/it]
test ppl:  44%|████▍     | 105/236 [06:45<08:28,  3.88s/it]
test ppl:  45%|████▍     | 106/236 [06:51<09:24,  4.34s/it]
test ppl:  45%|████▌     | 107/236 [06:53<07:51,  3.66s/it]
test ppl:  46%|████▌     | 108/236 [06:59<09:07,  4.27s/it]
test ppl:  46%|████▌     | 109/236 [07:03<09:18,  4.40s/it]
test ppl:  47%|████▋     | 110/236 [07:05<07:36,  3.62s/it]
test ppl:  47%|████▋     | 111/236 [07:09<07:27,  3.58s/it]
test ppl:  47%|████▋     | 112/236 [07:11<06:54,  3.34s/it]
test ppl:  48%|████▊     | 113/236 [07:13<05:53,  2.87s/it]
test ppl:  48%|████▊     | 114/236 [07:16<06:09,  3.03s/it]
test ppl:  49%|████▊     | 115/236 [07:22<07:50,  3.88s/it]
test ppl:  49%|████▉     | 116/236 [07:28<08:46,  4.39s/it]
test ppl:  50%|████▉     | 117/236 [07:30<07:11,  3.63s/it]
test ppl:  50%|█████     | 118/236 [07:34<07:35,  3.86s/it]
test ppl:  50%|█████     | 119/236 [07:38<07:12,  3.69s/it]
test ppl:  51%|█████     | 120/236 [07:39<05:46,  2.99s/it]
test ppl:  51%|█████▏    | 121/236 [07:45<07:23,  3.85s/it]
test ppl:  52%|█████▏    | 122/236 [07:50<07:51,  4.14s/it]
test ppl:  52%|█████▏    | 123/236 [07:52<06:40,  3.55s/it]
test ppl:  53%|█████▎    | 124/236 [07:54<06:11,  3.32s/it]
test ppl:  53%|█████▎    | 125/236 [07:58<06:22,  3.45s/it]
test ppl:  53%|█████▎    | 126/236 [08:02<06:27,  3.53s/it]
test ppl:  54%|█████▍    | 127/236 [08:04<05:30,  3.03s/it]
test ppl:  54%|█████▍    | 128/236 [08:06<05:03,  2.81s/it]
test ppl:  55%|█████▍    | 129/236 [08:09<05:05,  2.86s/it]
test ppl:  55%|█████▌    | 130/236 [08:13<05:52,  3.33s/it]
test ppl:  56%|█████▌    | 131/236 [08:19<07:11,  4.11s/it]
test ppl:  56%|█████▌    | 132/236 [08:22<06:16,  3.62s/it]
test ppl:  56%|█████▋    | 133/236 [08:26<06:22,  3.71s/it]
test ppl:  57%|█████▋    | 134/236 [08:31<07:16,  4.28s/it]
test ppl:  57%|█████▋    | 135/236 [08:36<07:30,  4.46s/it]
test ppl:  58%|█████▊    | 136/236 [08:38<05:48,  3.49s/it]
test ppl:  58%|█████▊    | 137/236 [08:43<06:58,  4.22s/it]
test ppl:  58%|█████▊    | 138/236 [08:47<06:24,  3.92s/it]
test ppl:  59%|█████▉    | 139/236 [08:49<05:41,  3.52s/it]
test ppl:  59%|█████▉    | 140/236 [08:51<04:57,  3.10s/it]
test ppl:  60%|█████▉    | 141/236 [08:54<04:48,  3.03s/it]
test ppl:  60%|██████    | 142/236 [08:56<04:19,  2.76s/it]
test ppl:  61%|██████    | 143/236 [09:02<05:44,  3.70s/it]
test ppl:  61%|██████    | 144/236 [09:05<05:14,  3.42s/it]
test ppl:  61%|██████▏   | 145/236 [09:11<06:08,  4.05s/it]
test ppl:  62%|██████▏   | 146/236 [09:15<06:16,  4.19s/it]
test ppl:  62%|██████▏   | 147/236 [09:21<06:58,  4.70s/it]
test ppl:  63%|██████▎   | 148/236 [09:27<07:27,  5.09s/it]
test ppl:  63%|██████▎   | 149/236 [09:30<06:38,  4.58s/it]
test ppl:  64%|██████▎   | 150/236 [09:34<06:20,  4.43s/it]
test ppl:  64%|██████▍   | 151/236 [09:40<06:53,  4.86s/it]
test ppl:  64%|██████▍   | 152/236 [09:46<07:14,  5.17s/it]
test ppl:  65%|██████▍   | 153/236 [09:52<07:26,  5.38s/it]
test ppl:  65%|██████▌   | 154/236 [09:55<06:14,  4.57s/it]
test ppl:  66%|██████▌   | 155/236 [09:57<05:22,  3.98s/it]
test ppl:  66%|██████▌   | 156/236 [10:00<04:35,  3.44s/it]
test ppl:  67%|██████▋   | 157/236 [10:02<04:02,  3.07s/it]
test ppl:  67%|██████▋   | 158/236 [10:08<05:05,  3.92s/it]
test ppl:  67%|██████▋   | 159/236 [10:14<05:47,  4.51s/it]
test ppl:  68%|██████▊   | 160/236 [10:15<04:26,  3.51s/it]
test ppl:  68%|██████▊   | 161/236 [10:16<03:35,  2.87s/it]
test ppl:  69%|██████▊   | 162/236 [10:19<03:33,  2.88s/it]
test ppl:  69%|██████▉   | 163/236 [10:22<03:22,  2.78s/it]
test ppl:  69%|██████▉   | 164/236 [10:25<03:38,  3.04s/it]
test ppl:  70%|██████▉   | 165/236 [10:30<04:09,  3.51s/it]
test ppl:  70%|███████   | 166/236 [10:33<04:02,  3.46s/it]
test ppl:  71%|███████   | 167/236 [10:35<03:17,  2.87s/it]
test ppl:  71%|███████   | 168/236 [10:39<03:44,  3.30s/it]
test ppl:  72%|███████▏  | 169/236 [10:44<04:23,  3.94s/it]
test ppl:  72%|███████▏  | 170/236 [10:50<04:59,  4.54s/it]
test ppl:  72%|███████▏  | 171/236 [10:52<03:52,  3.58s/it]
test ppl:  73%|███████▎  | 172/236 [10:54<03:24,  3.20s/it]
test ppl:  73%|███████▎  | 173/236 [10:57<03:27,  3.29s/it]
test ppl:  74%|███████▎  | 174/236 [11:03<04:13,  4.08s/it]
test ppl:  74%|███████▍  | 175/236 [11:05<03:28,  3.41s/it]
test ppl:  75%|███████▍  | 176/236 [11:10<03:51,  3.86s/it]
test ppl:  75%|███████▌  | 177/236 [11:16<04:23,  4.47s/it]
test ppl:  75%|███████▌  | 178/236 [11:22<04:45,  4.92s/it]
test ppl:  76%|███████▌  | 179/236 [11:28<04:57,  5.22s/it]
test ppl:  76%|███████▋  | 180/236 [11:33<04:41,  5.03s/it]
test ppl:  77%|███████▋  | 181/236 [11:38<04:50,  5.29s/it]
test ppl:  77%|███████▋  | 182/236 [11:40<03:50,  4.27s/it]
test ppl:  78%|███████▊  | 183/236 [11:43<03:14,  3.68s/it]
test ppl:  78%|███████▊  | 184/236 [11:44<02:36,  3.01s/it]
test ppl:  78%|███████▊  | 185/236 [11:48<02:54,  3.43s/it]
test ppl:  79%|███████▉  | 186/236 [11:54<03:28,  4.17s/it]
test ppl:  79%|███████▉  | 187/236 [12:00<03:50,  4.71s/it]
test ppl:  80%|███████▉  | 188/236 [12:06<04:03,  5.07s/it]
test ppl:  80%|████████  | 189/236 [12:12<04:09,  5.32s/it]
test ppl:  81%|████████  | 190/236 [12:16<03:46,  4.93s/it]
test ppl:  81%|████████  | 191/236 [12:21<03:34,  4.76s/it]
test ppl:  81%|████████▏ | 192/236 [12:23<03:01,  4.12s/it]
test ppl:  82%|████████▏ | 193/236 [12:29<03:20,  4.66s/it]
test ppl:  82%|████████▏ | 194/236 [12:32<02:50,  4.05s/it]
test ppl:  83%|████████▎ | 195/236 [12:35<02:34,  3.76s/it]
test ppl:  83%|████████▎ | 196/236 [12:37<02:09,  3.24s/it]
test ppl:  83%|████████▎ | 197/236 [12:39<01:59,  3.05s/it]
test ppl:  84%|████████▍ | 198/236 [12:45<02:28,  3.90s/it]
test ppl:  84%|████████▍ | 199/236 [12:48<02:10,  3.54s/it]
test ppl:  85%|████████▍ | 200/236 [12:54<02:32,  4.24s/it]
test ppl:  85%|████████▌ | 201/236 [12:56<02:05,  3.58s/it]
test ppl:  86%|████████▌ | 202/236 [13:01<02:12,  3.89s/it]
test ppl:  86%|████████▌ | 203/236 [13:06<02:28,  4.50s/it]
test ppl:  86%|████████▋ | 204/236 [13:08<01:54,  3.59s/it]
test ppl:  87%|████████▋ | 205/236 [13:14<02:13,  4.29s/it]
test ppl:  87%|████████▋ | 206/236 [13:17<01:59,  4.00s/it]
test ppl:  88%|████████▊ | 207/236 [13:23<02:12,  4.57s/it]
test ppl:  88%|████████▊ | 208/236 [13:26<01:56,  4.15s/it]
test ppl:  89%|████████▊ | 209/236 [13:32<02:07,  4.71s/it]
test ppl:  89%|████████▉ | 210/236 [13:35<01:44,  4.00s/it]
test ppl:  89%|████████▉ | 211/236 [13:39<01:46,  4.24s/it]
test ppl:  90%|████████▉ | 212/236 [13:44<01:45,  4.39s/it]
test ppl:  90%|█████████ | 213/236 [13:50<01:51,  4.83s/it]
test ppl:  91%|█████████ | 214/236 [13:52<01:25,  3.88s/it]
test ppl:  91%|█████████ | 215/236 [13:58<01:34,  4.48s/it]
test ppl:  92%|█████████▏| 216/236 [14:00<01:18,  3.90s/it]
test ppl:  92%|█████████▏| 217/236 [14:06<01:26,  4.53s/it]
test ppl:  92%|█████████▏| 218/236 [14:08<01:07,  3.76s/it]
test ppl:  93%|█████████▎| 219/236 [14:14<01:14,  4.41s/it]
test ppl:  93%|█████████▎| 220/236 [14:20<01:17,  4.86s/it]
test ppl:  94%|█████████▎| 221/236 [14:23<01:05,  4.34s/it]
test ppl:  94%|█████████▍| 222/236 [14:29<01:07,  4.81s/it]
test ppl:  94%|█████████▍| 223/236 [14:35<01:06,  5.14s/it]
test ppl:  95%|█████████▍| 224/236 [14:36<00:47,  3.99s/it]
test ppl:  95%|█████████▌| 225/236 [14:42<00:50,  4.56s/it]
test ppl:  96%|█████████▌| 226/236 [14:46<00:42,  4.28s/it]
test ppl:  96%|█████████▌| 227/236 [14:48<00:33,  3.70s/it]
test ppl:  97%|█████████▋| 228/236 [14:50<00:25,  3.20s/it]
test ppl:  97%|█████████▋| 229/236 [14:56<00:28,  4.00s/it]
test ppl:  97%|█████████▋| 230/236 [14:59<00:23,  3.86s/it]
test ppl:  98%|█████████▊| 231/236 [15:03<00:18,  3.71s/it]
test ppl:  98%|█████████▊| 232/236 [15:05<00:12,  3.12s/it]
test ppl:  99%|█████████▊| 233/236 [15:09<00:10,  3.41s/it]
test ppl:  99%|█████████▉| 234/236 [15:10<00:05,  2.75s/it]
test ppl: 100%|█████████▉| 235/236 [15:16<00:03,  3.69s/it]
test ppl: 100%|██████████| 236/236 [15:16<00:00,  2.78s/it]
test ppl: 100%|██████████| 236/236 [15:16<00:00,  3.88s/it]
10/12/2024 21:57:33 - INFO - __main__ -    em: 0.2099
10/12/2024 21:57:33 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
64 0.2 60:  em: 0.2099

--------------------------------------------------------------------------------
Running experiment with knn_temp=60, lmbda=0.4, k=16
2024-10-12 21:57:40.120388: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 21:57:40.140039: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 21:57:40.162021: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 21:57:40.168679: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 21:57:40.184776: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 21:57:41.174991: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 21:57:42 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.4, knn_temp=60, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 21:57:42 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:36:43,  2.20it/s]
Adding feature api:   4%|▍         | 7167/187062 [00:00<00:10, 17141.24it/s]
Adding feature api:   8%|▊         | 15564/187062 [00:00<00:05, 34159.31it/s]
Adding feature api:  13%|█▎        | 24030/187062 [00:00<00:03, 47629.95it/s]
Adding feature api:  17%|█▋        | 32478/187062 [00:00<00:02, 57797.07it/s]
Adding feature api:  22%|██▏       | 40681/187062 [00:00<00:02, 64647.49it/s]
Adding feature api:  26%|██▋       | 49154/187062 [00:01<00:01, 70424.23it/s]
Adding feature api:  31%|███       | 57662/187062 [00:01<00:01, 74691.94it/s]
Adding feature api:  35%|███▌      | 66169/187062 [00:01<00:01, 77738.58it/s]
Adding feature api:  40%|███▉      | 74461/187062 [00:01<00:01, 79269.94it/s]
Adding feature api:  44%|████▍     | 82952/187062 [00:01<00:01, 80944.16it/s]
Adding feature api:  49%|████▉     | 91468/187062 [00:01<00:01, 82197.48it/s]
Adding feature api:  53%|█████▎    | 99984/187062 [00:01<00:01, 83080.89it/s]
Adding feature api:  58%|█████▊    | 108557/187062 [00:01<00:00, 83870.20it/s]
Adding feature api:  63%|██████▎   | 117031/187062 [00:01<00:00, 83580.11it/s]
Adding feature api:  67%|██████▋   | 125546/187062 [00:01<00:00, 84046.15it/s]
Adding feature api:  72%|███████▏  | 134035/187062 [00:02<00:00, 84297.36it/s]
Adding feature api:  76%|███████▌  | 142538/187062 [00:02<00:00, 84514.13it/s]
Adding feature api:  81%|████████  | 151011/187062 [00:02<00:00, 83825.18it/s]
Adding feature api:  85%|████████▌ | 159523/187062 [00:02<00:00, 84207.15it/s]
Adding feature api:  90%|████████▉ | 168077/187062 [00:02<00:00, 84601.40it/s]
Adding feature api:  94%|█████████▍| 176591/187062 [00:02<00:00, 84760.44it/s]
Adding feature api:  99%|█████████▉| 185073/187062 [00:02<00:00, 56150.25it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64717.59it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:29:32,  2.21it/s]
Adding feature datatype:   4%|▍         | 7158/187062 [00:00<00:10, 17186.01it/s]
Adding feature datatype:   8%|▊         | 14941/187062 [00:00<00:05, 32674.32it/s]
Adding feature datatype:  12%|█▏        | 23150/187062 [00:00<00:03, 45883.91it/s]
Adding feature datatype:  17%|█▋        | 31331/187062 [00:00<00:02, 55810.03it/s]
Adding feature datatype:  21%|██        | 39567/187062 [00:00<00:02, 63322.25it/s]
Adding feature datatype:  26%|██▌       | 47792/187062 [00:01<00:02, 68771.40it/s]
Adding feature datatype:  30%|██▉       | 55937/187062 [00:01<00:01, 72465.55it/s]
Adding feature datatype:  34%|███▍      | 63853/187062 [00:01<00:01, 74287.68it/s]
Adding feature datatype:  39%|███▊      | 72157/187062 [00:01<00:01, 76869.56it/s]
Adding feature datatype:  43%|████▎     | 80348/187062 [00:01<00:01, 78362.30it/s]
Adding feature datatype:  47%|████▋     | 88624/187062 [00:01<00:01, 79669.51it/s]
Adding feature datatype:  52%|█████▏    | 96854/187062 [00:01<00:01, 80453.81it/s]
Adding feature datatype:  56%|█████▌    | 105139/187062 [00:01<00:01, 81168.15it/s]
Adding feature datatype:  61%|██████    | 113340/187062 [00:01<00:00, 80461.32it/s]
Adding feature datatype:  65%|██████▌   | 121659/187062 [00:01<00:00, 81269.74it/s]
Adding feature datatype:  69%|██████▉   | 129895/187062 [00:02<00:00, 81593.92it/s]
Adding feature datatype:  74%|███████▍  | 138092/187062 [00:02<00:00, 81703.65it/s]
Adding feature datatype:  78%|███████▊  | 146345/187062 [00:02<00:00, 81947.60it/s]
Adding feature datatype:  83%|████████▎ | 154555/187062 [00:02<00:00, 80868.77it/s]
Adding feature datatype:  87%|████████▋ | 162727/187062 [00:02<00:00, 81117.70it/s]
Adding feature datatype:  91%|█████████▏| 170969/187062 [00:02<00:00, 81502.91it/s]
Adding feature datatype:  96%|█████████▌| 179127/187062 [00:02<00:00, 74343.46it/s]
Adding feature datatype: 100%|█████████▉| 186686/187062 [00:02<00:00, 51932.84it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63128.21it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:15:28,  2.23it/s]
Adding feature literal:   4%|▍         | 7080/187062 [00:00<00:10, 17128.66it/s]
Adding feature literal:   8%|▊         | 15171/187062 [00:00<00:05, 33510.62it/s]
Adding feature literal:  12%|█▏        | 23345/187062 [00:00<00:03, 46456.73it/s]
Adding feature literal:  17%|█▋        | 31565/187062 [00:00<00:02, 56363.15it/s]
Adding feature literal:  21%|██        | 39750/187062 [00:00<00:02, 63591.54it/s]
Adding feature literal:  26%|██▌       | 47913/187062 [00:01<00:02, 68791.46it/s]
Adding feature literal:  30%|██▉       | 56103/187062 [00:01<00:01, 72613.61it/s]
Adding feature literal:  34%|███▍      | 64287/187062 [00:01<00:01, 75325.82it/s]
Adding feature literal:  39%|███▊      | 72482/187062 [00:01<00:01, 77283.70it/s]
Adding feature literal:  43%|████▎     | 80545/187062 [00:01<00:01, 74660.21it/s]
Adding feature literal:  47%|████▋     | 88262/187062 [00:01<00:01, 70834.08it/s]
Adding feature literal:  52%|█████▏    | 96408/187062 [00:01<00:01, 73795.99it/s]
Adding feature literal:  56%|█████▌    | 104599/187062 [00:01<00:01, 76107.43it/s]
Adding feature literal:  60%|██████    | 112762/187062 [00:01<00:00, 77703.02it/s]
Adding feature literal:  65%|██████▍   | 120991/187062 [00:01<00:00, 79042.68it/s]
Adding feature literal:  69%|██████▉   | 129152/187062 [00:02<00:00, 79797.41it/s]
Adding feature literal:  73%|███████▎  | 137370/187062 [00:02<00:00, 80501.40it/s]
Adding feature literal:  78%|███████▊  | 145559/187062 [00:02<00:00, 80910.87it/s]
Adding feature literal:  82%|████████▏ | 153729/187062 [00:02<00:00, 81145.64it/s]
Adding feature literal:  87%|████████▋ | 161914/187062 [00:02<00:00, 81352.97it/s]
Adding feature literal:  91%|█████████ | 170128/187062 [00:02<00:00, 81585.06it/s]
Adding feature literal:  95%|█████████▌| 178296/187062 [00:02<00:00, 78328.92it/s]
Adding feature literal: 100%|█████████▉| 186163/187062 [00:02<00:00, 52665.49it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 62414.87it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:20:19,  2.23it/s]
Adding feature operator:   4%|▍         | 7152/187062 [00:00<00:10, 17257.12it/s]
Adding feature operator:   8%|▊         | 15348/187062 [00:00<00:05, 33842.70it/s]
Adding feature operator:  13%|█▎        | 23609/187062 [00:00<00:03, 46913.44it/s]
Adding feature operator:  17%|█▋        | 31874/187062 [00:00<00:02, 56808.14it/s]
Adding feature operator:  21%|██▏       | 40091/187062 [00:00<00:02, 63995.36it/s]
Adding feature operator:  26%|██▌       | 48316/187062 [00:01<00:02, 69254.83it/s]
Adding feature operator:  30%|███       | 56385/187062 [00:01<00:01, 72586.84it/s]
Adding feature operator:  35%|███▍      | 64668/187062 [00:01<00:01, 75596.74it/s]
Adding feature operator:  39%|███▉      | 72931/187062 [00:01<00:01, 77675.57it/s]
Adding feature operator:  43%|████▎     | 81234/187062 [00:01<00:01, 79263.79it/s]
Adding feature operator:  48%|████▊     | 89500/187062 [00:01<00:01, 80272.64it/s]
Adding feature operator:  52%|█████▏    | 97756/187062 [00:01<00:01, 80954.56it/s]
Adding feature operator:  57%|█████▋    | 106010/187062 [00:01<00:00, 81426.38it/s]
Adding feature operator:  61%|██████    | 114344/187062 [00:01<00:00, 81996.71it/s]
Adding feature operator:  66%|██████▌   | 122639/187062 [00:01<00:00, 82279.53it/s]
Adding feature operator:  70%|██████▉   | 130909/187062 [00:02<00:00, 82322.38it/s]
Adding feature operator:  74%|███████▍  | 139170/187062 [00:02<00:00, 82388.79it/s]
Adding feature operator:  79%|███████▉  | 147429/187062 [00:02<00:00, 82259.59it/s]
Adding feature operator:  83%|████████▎ | 155695/187062 [00:02<00:00, 82377.79it/s]
Adding feature operator:  88%|████████▊ | 163991/187062 [00:02<00:00, 82549.64it/s]
Adding feature operator:  92%|█████████▏| 172278/187062 [00:02<00:00, 82642.76it/s]
Adding feature operator:  97%|█████████▋| 180548/187062 [00:02<00:00, 69167.31it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63741.36it/s]
[2024-10-12 21:58:26,415] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 21:58:27 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 21:58:27 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 38/6548 [00:00<00:17, 368.84 examples/s]
Map:   1%|          | 76/6548 [00:00<00:36, 179.74 examples/s]
Map:   2%|▏         | 115/6548 [00:00<00:26, 239.36 examples/s]
Map:   2%|▏         | 158/6548 [00:00<00:21, 293.49 examples/s]
Map:   3%|▎         | 197/6548 [00:00<00:20, 313.77 examples/s]
Map:   4%|▍         | 246/6548 [00:00<00:17, 364.18 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:19, 323.61 examples/s]
Map:   5%|▌         | 334/6548 [00:01<00:19, 311.97 examples/s]
Map:   6%|▌         | 373/6548 [00:01<00:18, 326.03 examples/s]
Map:   6%|▋         | 424/6548 [00:01<00:16, 372.19 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:17, 344.62 examples/s]
Map:   8%|▊         | 511/6548 [00:01<00:17, 353.04 examples/s]
Map:   9%|▊         | 563/6548 [00:01<00:15, 393.29 examples/s]
Map:   9%|▉         | 605/6548 [00:01<00:14, 398.30 examples/s]
Map:  10%|█         | 666/6548 [00:02<00:17, 341.67 examples/s]
Map:  11%|█         | 710/6548 [00:02<00:16, 362.25 examples/s]
Map:  12%|█▏        | 756/6548 [00:02<00:15, 384.43 examples/s]
Map:  12%|█▏        | 809/6548 [00:02<00:13, 419.97 examples/s]
Map:  13%|█▎        | 854/6548 [00:02<00:14, 403.76 examples/s]
Map:  14%|█▍        | 909/6548 [00:02<00:14, 382.65 examples/s]
Map:  15%|█▍        | 969/6548 [00:02<00:14, 384.51 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:23, 232.20 examples/s]
Map:  16%|█▌        | 1054/6548 [00:03<00:21, 255.12 examples/s]
Map:  17%|█▋        | 1098/6548 [00:03<00:18, 287.89 examples/s]
Map:  17%|█▋        | 1145/6548 [00:03<00:16, 325.59 examples/s]
Map:  18%|█▊        | 1184/6548 [00:03<00:15, 339.58 examples/s]
Map:  19%|█▊        | 1223/6548 [00:03<00:15, 348.60 examples/s]
Map:  19%|█▉        | 1262/6548 [00:03<00:14, 357.85 examples/s]
Map:  20%|█▉        | 1301/6548 [00:03<00:14, 365.66 examples/s]
Map:  21%|██        | 1355/6548 [00:04<00:15, 337.19 examples/s]
Map:  21%|██▏       | 1402/6548 [00:04<00:15, 324.75 examples/s]
Map:  22%|██▏       | 1459/6548 [00:04<00:16, 311.75 examples/s]
Map:  23%|██▎       | 1498/6548 [00:04<00:17, 294.30 examples/s]
Map:  23%|██▎       | 1533/6548 [00:04<00:16, 299.29 examples/s]
Map:  24%|██▍       | 1576/6548 [00:04<00:17, 292.05 examples/s]
Map:  25%|██▍       | 1611/6548 [00:05<00:18, 268.18 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:17, 274.66 examples/s]
Map:  26%|██▌       | 1677/6548 [00:05<00:19, 248.71 examples/s]
Map:  26%|██▌       | 1717/6548 [00:05<00:17, 280.86 examples/s]
Map:  27%|██▋       | 1766/6548 [00:05<00:14, 325.80 examples/s]
Map:  28%|██▊       | 1807/6548 [00:05<00:13, 340.83 examples/s]
Map:  28%|██▊       | 1849/6548 [00:05<00:13, 359.01 examples/s]
Map:  29%|██▉       | 1892/6548 [00:05<00:14, 324.34 examples/s]
Map:  30%|██▉       | 1935/6548 [00:06<00:15, 306.93 examples/s]
Map:  30%|███       | 1969/6548 [00:06<00:14, 312.06 examples/s]
Map:  31%|███       | 2010/6548 [00:06<00:21, 210.18 examples/s]
Map:  31%|███       | 2042/6548 [00:06<00:19, 228.35 examples/s]
Map:  32%|███▏      | 2082/6548 [00:06<00:16, 263.26 examples/s]
Map:  32%|███▏      | 2124/6548 [00:06<00:15, 280.63 examples/s]
Map:  33%|███▎      | 2160/6548 [00:07<00:18, 240.96 examples/s]
Map:  34%|███▍      | 2211/6548 [00:07<00:14, 297.28 examples/s]
Map:  34%|███▍      | 2255/6548 [00:07<00:16, 258.34 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:16, 265.18 examples/s]
Map:  36%|███▌      | 2331/6548 [00:07<00:13, 302.72 examples/s]
Map:  36%|███▌      | 2369/6548 [00:07<00:14, 279.26 examples/s]
Map:  37%|███▋      | 2406/6548 [00:07<00:13, 298.44 examples/s]
Map:  37%|███▋      | 2454/6548 [00:07<00:13, 294.36 examples/s]
Map:  38%|███▊      | 2495/6548 [00:08<00:13, 309.22 examples/s]
Map:  39%|███▉      | 2538/6548 [00:08<00:12, 332.81 examples/s]
Map:  40%|███▉      | 2592/6548 [00:08<00:10, 381.49 examples/s]
Map:  40%|████      | 2634/6548 [00:08<00:10, 387.86 examples/s]
Map:  41%|████      | 2682/6548 [00:08<00:10, 358.34 examples/s]
Map:  42%|████▏     | 2742/6548 [00:08<00:10, 367.00 examples/s]
Map:  43%|████▎     | 2790/6548 [00:08<00:10, 348.21 examples/s]
Map:  43%|████▎     | 2828/6548 [00:09<00:13, 285.09 examples/s]
Map:  44%|████▎     | 2862/6548 [00:09<00:12, 293.70 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 299.48 examples/s]
Map:  45%|████▌     | 2952/6548 [00:09<00:11, 312.65 examples/s]
Map:  46%|████▌     | 2988/6548 [00:09<00:11, 312.25 examples/s]
Map:  46%|████▌     | 3026/6548 [00:10<00:20, 176.08 examples/s]
Map:  47%|████▋     | 3062/6548 [00:10<00:17, 203.24 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:15, 217.00 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 258.19 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:12, 261.00 examples/s]
Map:  49%|████▉     | 3201/6548 [00:10<00:12, 265.28 examples/s]
Map:  50%|████▉     | 3244/6548 [00:10<00:12, 264.09 examples/s]
Map:  50%|█████     | 3276/6548 [00:10<00:12, 270.29 examples/s]
Map:  51%|█████     | 3311/6548 [00:10<00:11, 288.83 examples/s]
Map:  51%|█████     | 3348/6548 [00:11<00:10, 308.13 examples/s]
Map:  52%|█████▏    | 3389/6548 [00:11<00:11, 279.92 examples/s]
Map:  52%|█████▏    | 3423/6548 [00:11<00:10, 293.46 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 280.20 examples/s]
Map:  53%|█████▎    | 3484/6548 [00:11<00:10, 284.84 examples/s]
Map:  54%|█████▍    | 3529/6548 [00:11<00:09, 326.17 examples/s]
Map:  55%|█████▍    | 3576/6548 [00:11<00:08, 360.13 examples/s]
Map:  55%|█████▌    | 3619/6548 [00:11<00:07, 371.24 examples/s]
Map:  56%|█████▌    | 3659/6548 [00:11<00:07, 377.46 examples/s]
Map:  57%|█████▋    | 3704/6548 [00:12<00:07, 394.72 examples/s]
Map:  57%|█████▋    | 3744/6548 [00:12<00:07, 391.98 examples/s]
Map:  58%|█████▊    | 3786/6548 [00:12<00:06, 397.73 examples/s]
Map:  59%|█████▊    | 3831/6548 [00:12<00:08, 337.28 examples/s]
Map:  59%|█████▉    | 3887/6548 [00:12<00:07, 340.99 examples/s]
Map:  60%|██████    | 3939/6548 [00:12<00:08, 324.55 examples/s]
Map:  61%|██████    | 3987/6548 [00:12<00:07, 358.21 examples/s]
Map:  62%|██████▏   | 4030/6548 [00:13<00:09, 254.84 examples/s]
Map:  62%|██████▏   | 4079/6548 [00:13<00:08, 298.72 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 322.03 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:08, 276.13 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:13<00:07, 296.07 examples/s]
Map:  65%|██████▍   | 4252/6548 [00:13<00:07, 321.59 examples/s]
Map:  66%|██████▌   | 4292/6548 [00:13<00:06, 338.17 examples/s]
Map:  66%|██████▌   | 4334/6548 [00:14<00:06, 356.67 examples/s]
Map:  67%|██████▋   | 4388/6548 [00:14<00:06, 345.33 examples/s]
Map:  68%|██████▊   | 4427/6548 [00:14<00:05, 355.36 examples/s]
Map:  68%|██████▊   | 4469/6548 [00:14<00:06, 327.82 examples/s]
Map:  69%|██████▉   | 4507/6548 [00:14<00:06, 293.64 examples/s]
Map:  69%|██████▉   | 4545/6548 [00:14<00:06, 308.12 examples/s]
Map:  70%|██████▉   | 4579/6548 [00:14<00:06, 313.20 examples/s]
Map:  71%|███████   | 4617/6548 [00:14<00:05, 328.51 examples/s]
Map:  71%|███████   | 4655/6548 [00:15<00:05, 341.81 examples/s]
Map:  72%|███████▏  | 4712/6548 [00:15<00:05, 348.84 examples/s]
Map:  73%|███████▎  | 4775/6548 [00:15<00:05, 352.97 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 370.17 examples/s]
Map:  75%|███████▍  | 4880/6548 [00:15<00:04, 354.79 examples/s]
Map:  75%|███████▌  | 4932/6548 [00:15<00:04, 373.98 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:04, 391.25 examples/s]
Map:  77%|███████▋  | 5038/6548 [00:16<00:06, 241.29 examples/s]
Map:  78%|███████▊  | 5081/6548 [00:16<00:05, 246.15 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 257.97 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:05, 273.99 examples/s]
Map:  79%|███████▉  | 5203/6548 [00:16<00:04, 278.46 examples/s]
Map:  80%|███████▉  | 5238/6548 [00:17<00:04, 291.14 examples/s]
Map:  81%|████████  | 5277/6548 [00:17<00:04, 295.13 examples/s]
Map:  81%|████████  | 5319/6548 [00:17<00:03, 322.49 examples/s]
Map:  82%|████████▏ | 5364/6548 [00:17<00:04, 292.45 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 289.14 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 321.55 examples/s]
Map:  84%|████████▍ | 5503/6548 [00:17<00:03, 321.92 examples/s]
Map:  85%|████████▍ | 5543/6548 [00:17<00:02, 338.79 examples/s]
Map:  85%|████████▌ | 5584/6548 [00:18<00:03, 308.59 examples/s]
Map:  86%|████████▌ | 5617/6548 [00:18<00:02, 311.74 examples/s]
Map:  86%|████████▋ | 5651/6548 [00:18<00:02, 316.84 examples/s]
Map:  87%|████████▋ | 5703/6548 [00:18<00:02, 325.78 examples/s]
Map:  88%|████████▊ | 5743/6548 [00:18<00:02, 342.39 examples/s]
Map:  88%|████████▊ | 5781/6548 [00:18<00:02, 342.96 examples/s]
Map:  89%|████████▉ | 5825/6548 [00:18<00:02, 345.51 examples/s]
Map:  90%|████████▉ | 5866/6548 [00:18<00:01, 355.66 examples/s]
Map:  90%|█████████ | 5908/6548 [00:19<00:01, 368.68 examples/s]
Map:  91%|█████████ | 5960/6548 [00:19<00:01, 360.04 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 228.12 examples/s]
Map:  92%|█████████▏| 6041/6548 [00:19<00:01, 261.27 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 290.61 examples/s]
Map:  94%|█████████▎| 6124/6548 [00:19<00:01, 284.06 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:19<00:01, 300.43 examples/s]
Map:  95%|█████████▍| 6207/6548 [00:20<00:01, 322.74 examples/s]
Map:  95%|█████████▌| 6249/6548 [00:20<00:00, 342.42 examples/s]
Map:  96%|█████████▋| 6305/6548 [00:20<00:00, 351.47 examples/s]
Map:  97%|█████████▋| 6367/6548 [00:20<00:00, 357.11 examples/s]
Map:  98%|█████████▊| 6410/6548 [00:20<00:00, 372.31 examples/s]
Map:  99%|█████████▊| 6458/6548 [00:20<00:00, 394.81 examples/s]
Map:  99%|█████████▉| 6515/6548 [00:20<00:00, 384.42 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 310.71 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 326.75 examples/s]
Map:   8%|▊         | 73/903 [00:00<00:02, 347.98 examples/s]
Map:  13%|█▎        | 120/903 [00:00<00:02, 325.58 examples/s]
Map:  18%|█▊        | 163/903 [00:00<00:02, 358.23 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 383.11 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 387.75 examples/s]
Map:  34%|███▍      | 310/903 [00:00<00:01, 385.13 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 331.70 examples/s]
Map:  44%|████▎     | 393/903 [00:01<00:01, 296.90 examples/s]
Map:  48%|████▊     | 435/903 [00:01<00:01, 324.09 examples/s]
Map:  53%|█████▎    | 475/903 [00:01<00:01, 300.44 examples/s]
Map:  59%|█████▊    | 530/903 [00:01<00:01, 320.17 examples/s]
Map:  63%|██████▎   | 566/903 [00:01<00:01, 329.02 examples/s]
Map:  68%|██████▊   | 614/903 [00:01<00:00, 355.85 examples/s]
Map:  72%|███████▏  | 652/903 [00:01<00:00, 360.77 examples/s]
Map:  76%|███████▋  | 690/903 [00:02<00:00, 364.09 examples/s]
Map:  82%|████████▏ | 736/903 [00:02<00:00, 376.02 examples/s]
Map:  86%|████████▌ | 778/903 [00:02<00:00, 378.87 examples/s]
Map:  91%|█████████ | 821/903 [00:02<00:00, 390.64 examples/s]
Map:  95%|█████████▌| 862/903 [00:02<00:00, 380.24 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 214.32 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 318.27 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 35/1882 [00:00<00:06, 268.50 examples/s]
Map:   4%|▍         | 74/1882 [00:00<00:05, 327.56 examples/s]
Map:   6%|▌         | 110/1882 [00:00<00:05, 327.44 examples/s]
Map:   8%|▊         | 147/1882 [00:00<00:05, 338.40 examples/s]
Map:  10%|▉         | 188/1882 [00:00<00:04, 353.21 examples/s]
Map:  13%|█▎        | 250/1882 [00:00<00:04, 369.72 examples/s]
Map:  15%|█▌        | 288/1882 [00:00<00:04, 368.80 examples/s]
Map:  18%|█▊        | 330/1882 [00:00<00:04, 377.24 examples/s]
Map:  20%|█▉        | 372/1882 [00:01<00:04, 337.01 examples/s]
Map:  22%|██▏       | 407/1882 [00:01<00:05, 292.41 examples/s]
Map:  24%|██▎       | 445/1882 [00:01<00:04, 311.89 examples/s]
Map:  26%|██▌       | 482/1882 [00:01<00:04, 324.06 examples/s]
Map:  28%|██▊       | 534/1882 [00:01<00:04, 325.19 examples/s]
Map:  31%|███       | 576/1882 [00:01<00:03, 343.97 examples/s]
Map:  34%|███▎      | 634/1882 [00:01<00:03, 401.08 examples/s]
Map:  36%|███▋      | 686/1882 [00:01<00:03, 365.73 examples/s]
Map:  39%|███▊      | 726/1882 [00:02<00:03, 373.03 examples/s]
Map:  41%|████      | 769/1882 [00:02<00:02, 385.20 examples/s]
Map:  44%|████▍     | 825/1882 [00:02<00:02, 358.28 examples/s]
Map:  46%|████▌     | 864/1882 [00:02<00:02, 364.14 examples/s]
Map:  48%|████▊     | 904/1882 [00:02<00:02, 370.69 examples/s]
Map:  50%|█████     | 947/1882 [00:02<00:02, 385.15 examples/s]
Map:  53%|█████▎    | 991/1882 [00:02<00:02, 393.66 examples/s]
Map:  55%|█████▌    | 1039/1882 [00:03<00:03, 249.04 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 255.61 examples/s]
Map:  59%|█████▉    | 1117/1882 [00:03<00:02, 264.25 examples/s]
Map:  62%|██████▏   | 1163/1882 [00:03<00:02, 274.98 examples/s]
Map:  64%|██████▍   | 1212/1882 [00:03<00:02, 271.97 examples/s]
Map:  67%|██████▋   | 1254/1882 [00:03<00:02, 300.31 examples/s]
Map:  69%|██████▉   | 1295/1882 [00:03<00:01, 320.25 examples/s]
Map:  71%|███████   | 1337/1882 [00:04<00:01, 341.43 examples/s]
Map:  74%|███████▎  | 1384/1882 [00:04<00:01, 328.89 examples/s]
Map:  76%|███████▌  | 1426/1882 [00:04<00:01, 297.01 examples/s]
Map:  78%|███████▊  | 1469/1882 [00:04<00:01, 325.62 examples/s]
Map:  81%|████████  | 1519/1882 [00:04<00:01, 285.05 examples/s]
Map:  83%|████████▎ | 1566/1882 [00:04<00:01, 291.70 examples/s]
Map:  86%|████████▌ | 1615/1882 [00:04<00:00, 333.31 examples/s]
Map:  88%|████████▊ | 1664/1882 [00:05<00:00, 329.11 examples/s]
Map:  91%|█████████ | 1710/1882 [00:05<00:00, 317.38 examples/s]
Map:  93%|█████████▎| 1748/1882 [00:05<00:00, 277.52 examples/s]
Map:  94%|█████████▍| 1778/1882 [00:05<00:00, 280.71 examples/s]
Map:  97%|█████████▋| 1820/1882 [00:05<00:00, 307.91 examples/s]
Map:  99%|█████████▉| 1859/1882 [00:05<00:00, 325.65 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 313.31 examples/s]
10/12/2024 21:59:30 - INFO - __main__ -     ***** Testing *****
10/12/2024 21:59:30 - INFO - __main__ -     Batch size = 8
10/12/2024 21:59:30 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 21:59:30 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 21:59:30 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 21:59:31 - INFO - knnlm -   Reading datastore took 0.8947422504425049 s
10/12/2024 21:59:32 - INFO - knnlm -   Moving index to GPU took 0.9940059185028076 s
10/12/2024 21:59:32 - INFO - __main__ -   ******************************break-into
10/12/2024 21:59:32 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 21:59:32 - INFO - __main__ -     Num examples = 236
10/12/2024 21:59:32 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<29:32,  7.54s/it]
test ppl:   1%|          | 2/236 [00:09<16:31,  4.24s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:37,  2.99s/it]
test ppl:   2%|▏         | 4/236 [00:12<09:37,  2.49s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:20,  3.73s/it]
test ppl:   3%|▎         | 6/236 [00:24<17:10,  4.48s/it]
test ppl:   3%|▎         | 7/236 [00:26<13:52,  3.64s/it]
test ppl:   3%|▎         | 8/236 [00:30<14:38,  3.85s/it]
test ppl:   4%|▍         | 9/236 [00:32<12:32,  3.31s/it]
test ppl:   4%|▍         | 10/236 [00:35<11:32,  3.07s/it]
test ppl:   5%|▍         | 11/236 [00:37<10:42,  2.86s/it]
test ppl:   5%|▌         | 12/236 [00:43<14:09,  3.79s/it]
test ppl:   6%|▌         | 13/236 [00:49<16:30,  4.44s/it]
test ppl:   6%|▌         | 14/236 [00:52<14:05,  3.81s/it]
test ppl:   6%|▋         | 15/236 [00:53<11:14,  3.05s/it]
test ppl:   7%|▋         | 16/236 [00:55<09:52,  2.70s/it]
test ppl:   7%|▋         | 17/236 [01:01<13:22,  3.66s/it]
test ppl:   8%|▊         | 18/236 [01:02<11:10,  3.07s/it]
test ppl:   8%|▊         | 19/236 [01:07<12:38,  3.50s/it]
test ppl:   8%|▊         | 20/236 [01:09<10:44,  2.98s/it]
test ppl:   9%|▉         | 21/236 [01:12<11:06,  3.10s/it]
test ppl:   9%|▉         | 22/236 [01:18<14:05,  3.95s/it]
test ppl:  10%|▉         | 23/236 [01:20<12:31,  3.53s/it]
test ppl:  10%|█         | 24/236 [01:23<11:14,  3.18s/it]
test ppl:  11%|█         | 25/236 [01:25<09:41,  2.76s/it]
test ppl:  11%|█         | 26/236 [01:31<13:00,  3.72s/it]
test ppl:  11%|█▏        | 27/236 [01:34<12:41,  3.64s/it]
test ppl:  12%|█▏        | 28/236 [01:35<10:05,  2.91s/it]
test ppl:  12%|█▏        | 29/236 [01:38<09:28,  2.74s/it]
test ppl:  13%|█▎        | 30/236 [01:39<08:10,  2.38s/it]
test ppl:  13%|█▎        | 31/236 [01:41<07:45,  2.27s/it]
test ppl:  14%|█▎        | 32/236 [01:44<08:08,  2.40s/it]
test ppl:  14%|█▍        | 33/236 [01:50<11:43,  3.46s/it]
test ppl:  14%|█▍        | 34/236 [01:54<12:15,  3.64s/it]
test ppl:  15%|█▍        | 35/236 [01:56<11:06,  3.31s/it]
test ppl:  15%|█▌        | 36/236 [02:02<13:39,  4.10s/it]
test ppl:  16%|█▌        | 37/236 [02:08<15:26,  4.66s/it]
test ppl:  16%|█▌        | 38/236 [02:10<12:50,  3.89s/it]
test ppl:  17%|█▋        | 39/236 [02:12<10:43,  3.27s/it]
test ppl:  17%|█▋        | 40/236 [02:15<10:02,  3.07s/it]
test ppl:  17%|█▋        | 41/236 [02:17<08:49,  2.72s/it]
test ppl:  18%|█▊        | 42/236 [02:23<11:56,  3.69s/it]
test ppl:  18%|█▊        | 43/236 [02:29<14:02,  4.36s/it]
test ppl:  19%|█▊        | 44/236 [02:31<12:11,  3.81s/it]
test ppl:  19%|█▉        | 45/236 [02:33<10:23,  3.26s/it]
test ppl:  19%|█▉        | 46/236 [02:39<12:55,  4.08s/it]
test ppl:  20%|█▉        | 47/236 [02:41<10:27,  3.32s/it]
test ppl:  20%|██        | 48/236 [02:46<12:50,  4.10s/it]
test ppl:  21%|██        | 49/236 [02:52<14:29,  4.65s/it]
test ppl:  21%|██        | 50/236 [02:58<15:41,  5.06s/it]
test ppl:  22%|██▏       | 51/236 [03:03<15:05,  4.90s/it]
test ppl:  22%|██▏       | 52/236 [03:09<15:59,  5.21s/it]
test ppl:  22%|██▏       | 53/236 [03:14<15:34,  5.11s/it]
test ppl:  23%|██▎       | 54/236 [03:15<12:15,  4.04s/it]
test ppl:  23%|██▎       | 55/236 [03:21<13:45,  4.56s/it]
test ppl:  24%|██▎       | 56/236 [03:25<12:40,  4.22s/it]
test ppl:  24%|██▍       | 57/236 [03:27<10:54,  3.65s/it]
test ppl:  25%|██▍       | 58/236 [03:29<09:32,  3.22s/it]
test ppl:  25%|██▌       | 59/236 [03:35<11:54,  4.04s/it]
test ppl:  25%|██▌       | 60/236 [03:38<11:05,  3.78s/it]
test ppl:  26%|██▌       | 61/236 [03:44<12:57,  4.44s/it]
test ppl:  26%|██▋       | 62/236 [03:48<12:39,  4.36s/it]
test ppl:  27%|██▋       | 63/236 [03:51<10:57,  3.80s/it]
test ppl:  27%|██▋       | 64/236 [03:53<09:18,  3.25s/it]
test ppl:  28%|██▊       | 65/236 [03:54<07:36,  2.67s/it]
test ppl:  28%|██▊       | 66/236 [03:57<07:52,  2.78s/it]
test ppl:  28%|██▊       | 67/236 [04:03<10:30,  3.73s/it]
test ppl:  29%|██▉       | 68/236 [04:09<12:18,  4.40s/it]
test ppl:  29%|██▉       | 69/236 [04:15<13:31,  4.86s/it]
test ppl:  30%|██▉       | 70/236 [04:16<10:29,  3.79s/it]
test ppl:  30%|███       | 71/236 [04:20<10:04,  3.66s/it]
test ppl:  31%|███       | 72/236 [04:24<10:10,  3.72s/it]
test ppl:  31%|███       | 73/236 [04:27<10:06,  3.72s/it]
test ppl:  31%|███▏      | 74/236 [04:29<08:16,  3.07s/it]
test ppl:  32%|███▏      | 75/236 [04:35<10:32,  3.93s/it]
test ppl:  32%|███▏      | 76/236 [04:38<09:42,  3.64s/it]
test ppl:  33%|███▎      | 77/236 [04:40<08:35,  3.24s/it]
test ppl:  33%|███▎      | 78/236 [04:42<07:10,  2.73s/it]
test ppl:  33%|███▎      | 79/236 [04:46<08:06,  3.10s/it]
test ppl:  34%|███▍      | 80/236 [04:47<07:05,  2.73s/it]
test ppl:  34%|███▍      | 81/236 [04:53<09:32,  3.69s/it]
test ppl:  35%|███▍      | 82/236 [04:59<11:07,  4.34s/it]
test ppl:  35%|███▌      | 83/236 [05:05<12:17,  4.82s/it]
test ppl:  36%|███▌      | 84/236 [05:08<10:23,  4.10s/it]
test ppl:  36%|███▌      | 85/236 [05:12<10:23,  4.13s/it]
test ppl:  36%|███▋      | 86/236 [05:14<08:41,  3.47s/it]
test ppl:  37%|███▋      | 87/236 [05:16<08:03,  3.24s/it]
test ppl:  37%|███▋      | 88/236 [05:22<09:58,  4.05s/it]
test ppl:  38%|███▊      | 89/236 [05:28<11:18,  4.62s/it]
test ppl:  38%|███▊      | 90/236 [05:34<12:11,  5.01s/it]
test ppl:  39%|███▊      | 91/236 [05:39<12:08,  5.02s/it]
test ppl:  39%|███▉      | 92/236 [05:42<10:29,  4.37s/it]
test ppl:  39%|███▉      | 93/236 [05:48<11:30,  4.83s/it]
test ppl:  40%|███▉      | 94/236 [05:54<12:13,  5.16s/it]
test ppl:  40%|████      | 95/236 [05:56<09:51,  4.20s/it]
test ppl:  41%|████      | 96/236 [05:59<08:56,  3.83s/it]
test ppl:  41%|████      | 97/236 [06:05<10:19,  4.46s/it]
test ppl:  42%|████▏     | 98/236 [06:11<11:16,  4.90s/it]
test ppl:  42%|████▏     | 99/236 [06:17<11:53,  5.21s/it]
test ppl:  42%|████▏     | 100/236 [06:18<09:10,  4.05s/it]
test ppl:  43%|████▎     | 101/236 [06:24<10:22,  4.61s/it]
test ppl:  43%|████▎     | 102/236 [06:28<10:01,  4.49s/it]
test ppl:  44%|████▎     | 103/236 [06:30<07:55,  3.57s/it]
test ppl:  44%|████▍     | 104/236 [06:34<08:20,  3.79s/it]
test ppl:  44%|████▍     | 105/236 [06:38<08:42,  3.99s/it]
test ppl:  45%|████▍     | 106/236 [06:44<09:35,  4.43s/it]
test ppl:  45%|████▌     | 107/236 [06:46<07:54,  3.68s/it]
test ppl:  46%|████▌     | 108/236 [06:51<09:10,  4.30s/it]
test ppl:  46%|████▌     | 109/236 [06:56<09:22,  4.43s/it]
test ppl:  47%|████▋     | 110/236 [06:58<07:31,  3.58s/it]
test ppl:  47%|████▋     | 111/236 [07:02<07:44,  3.71s/it]
test ppl:  47%|████▋     | 112/236 [07:05<07:30,  3.63s/it]
test ppl:  48%|████▊     | 113/236 [07:07<06:18,  3.08s/it]
test ppl:  48%|████▊     | 114/236 [07:10<06:27,  3.18s/it]
test ppl:  49%|████▊     | 115/236 [07:16<08:04,  4.00s/it]
test ppl:  49%|████▉     | 116/236 [07:22<09:09,  4.58s/it]
test ppl:  50%|████▉     | 117/236 [07:24<07:28,  3.77s/it]
test ppl:  50%|█████     | 118/236 [07:30<08:41,  4.42s/it]
test ppl:  50%|█████     | 119/236 [07:33<07:37,  3.91s/it]
test ppl:  51%|█████     | 120/236 [07:34<06:11,  3.20s/it]
test ppl:  51%|█████▏    | 121/236 [07:40<07:42,  4.02s/it]
test ppl:  52%|█████▏    | 122/236 [07:45<08:06,  4.26s/it]
test ppl:  52%|█████▏    | 123/236 [07:47<06:51,  3.64s/it]
test ppl:  53%|█████▎    | 124/236 [07:50<06:06,  3.27s/it]
test ppl:  53%|█████▎    | 125/236 [07:52<05:38,  3.05s/it]
test ppl:  53%|█████▎    | 126/236 [07:57<06:38,  3.62s/it]
test ppl:  54%|█████▍    | 127/236 [07:59<05:45,  3.17s/it]
test ppl:  54%|█████▍    | 128/236 [08:02<05:13,  2.91s/it]
test ppl:  55%|█████▍    | 129/236 [08:05<05:12,  2.92s/it]
test ppl:  55%|█████▌    | 130/236 [08:07<05:02,  2.85s/it]
test ppl:  56%|█████▌    | 131/236 [08:13<06:37,  3.79s/it]
test ppl:  56%|█████▌    | 132/236 [08:16<05:53,  3.40s/it]
test ppl:  56%|█████▋    | 133/236 [08:20<06:07,  3.56s/it]
test ppl:  57%|█████▋    | 134/236 [08:24<06:14,  3.67s/it]
test ppl:  57%|█████▋    | 135/236 [08:30<07:19,  4.36s/it]
test ppl:  58%|█████▊    | 136/236 [08:31<05:42,  3.43s/it]
test ppl:  58%|█████▊    | 137/236 [08:37<06:54,  4.18s/it]
test ppl:  58%|█████▊    | 138/236 [08:40<06:22,  3.90s/it]
test ppl:  59%|█████▉    | 139/236 [08:46<07:18,  4.52s/it]
test ppl:  59%|█████▉    | 140/236 [08:48<05:53,  3.68s/it]
test ppl:  60%|█████▉    | 141/236 [08:51<05:28,  3.45s/it]
test ppl:  60%|██████    | 142/236 [08:53<04:47,  3.06s/it]
test ppl:  61%|██████    | 143/236 [08:59<06:05,  3.93s/it]
test ppl:  61%|██████    | 144/236 [09:01<05:28,  3.57s/it]
test ppl:  61%|██████▏   | 145/236 [09:07<06:19,  4.17s/it]
test ppl:  62%|██████▏   | 146/236 [09:12<06:27,  4.30s/it]
test ppl:  62%|██████▏   | 147/236 [09:18<07:06,  4.80s/it]
test ppl:  63%|██████▎   | 148/236 [09:24<07:35,  5.17s/it]
test ppl:  63%|██████▎   | 149/236 [09:30<07:50,  5.41s/it]
test ppl:  64%|██████▎   | 150/236 [09:36<07:59,  5.57s/it]
test ppl:  64%|██████▍   | 151/236 [09:41<08:02,  5.68s/it]
test ppl:  64%|██████▍   | 152/236 [09:47<08:03,  5.75s/it]
test ppl:  65%|██████▍   | 153/236 [09:53<08:01,  5.80s/it]
test ppl:  65%|██████▌   | 154/236 [09:56<06:35,  4.83s/it]
test ppl:  66%|██████▌   | 155/236 [09:59<05:39,  4.19s/it]
test ppl:  66%|██████▌   | 156/236 [10:01<04:47,  3.59s/it]
test ppl:  67%|██████▋   | 157/236 [10:03<04:11,  3.19s/it]
test ppl:  67%|██████▋   | 158/236 [10:09<05:12,  4.01s/it]
test ppl:  67%|██████▋   | 159/236 [10:10<04:02,  3.15s/it]
test ppl:  68%|██████▊   | 160/236 [10:11<03:14,  2.56s/it]
test ppl:  68%|██████▊   | 161/236 [10:13<02:45,  2.21s/it]
test ppl:  69%|██████▊   | 162/236 [10:15<02:41,  2.19s/it]
test ppl:  69%|██████▉   | 163/236 [10:17<02:47,  2.30s/it]
test ppl:  69%|██████▉   | 164/236 [10:20<02:50,  2.37s/it]
test ppl:  70%|██████▉   | 165/236 [10:23<03:12,  2.72s/it]
test ppl:  70%|███████   | 166/236 [10:25<02:49,  2.42s/it]
test ppl:  71%|███████   | 167/236 [10:27<02:27,  2.14s/it]
test ppl:  71%|███████   | 168/236 [10:31<03:08,  2.77s/it]
test ppl:  72%|███████▏  | 169/236 [10:37<04:09,  3.72s/it]
test ppl:  72%|███████▏  | 170/236 [10:43<04:50,  4.41s/it]
test ppl:  72%|███████▏  | 171/236 [10:44<03:46,  3.49s/it]
test ppl:  73%|███████▎  | 172/236 [10:50<04:30,  4.23s/it]
test ppl:  73%|███████▎  | 173/236 [10:54<04:20,  4.13s/it]
test ppl:  74%|███████▎  | 174/236 [11:00<04:50,  4.68s/it]
test ppl:  74%|███████▍  | 175/236 [11:02<03:55,  3.86s/it]
test ppl:  75%|███████▍  | 176/236 [11:08<04:28,  4.48s/it]
test ppl:  75%|███████▌  | 177/236 [11:14<04:50,  4.92s/it]
test ppl:  75%|███████▌  | 178/236 [11:20<05:04,  5.25s/it]
test ppl:  76%|███████▌  | 179/236 [11:26<05:11,  5.46s/it]
test ppl:  76%|███████▋  | 180/236 [11:32<05:13,  5.60s/it]
test ppl:  77%|███████▋  | 181/236 [11:38<05:13,  5.70s/it]
test ppl:  77%|███████▋  | 182/236 [11:40<04:06,  4.56s/it]
test ppl:  78%|███████▊  | 183/236 [11:42<03:26,  3.89s/it]
test ppl:  78%|███████▊  | 184/236 [11:43<02:44,  3.16s/it]
test ppl:  78%|███████▊  | 185/236 [11:47<02:51,  3.36s/it]
test ppl:  79%|███████▉  | 186/236 [11:49<02:29,  3.00s/it]
test ppl:  79%|███████▉  | 187/236 [11:55<03:11,  3.90s/it]
test ppl:  80%|███████▉  | 188/236 [12:01<03:36,  4.52s/it]
test ppl:  80%|████████  | 189/236 [12:07<03:52,  4.95s/it]
test ppl:  81%|████████  | 190/236 [12:11<03:30,  4.58s/it]
test ppl:  81%|████████  | 191/236 [12:15<03:15,  4.35s/it]
test ppl:  81%|████████▏ | 192/236 [12:17<02:49,  3.84s/it]
test ppl:  82%|████████▏ | 193/236 [12:23<03:12,  4.48s/it]
test ppl:  82%|████████▏ | 194/236 [12:26<02:44,  3.93s/it]
test ppl:  83%|████████▎ | 195/236 [12:29<02:30,  3.67s/it]
test ppl:  83%|████████▎ | 196/236 [12:31<02:07,  3.18s/it]
test ppl:  83%|████████▎ | 197/236 [12:33<01:52,  2.88s/it]
test ppl:  84%|████████▍ | 198/236 [12:35<01:39,  2.61s/it]
test ppl:  84%|████████▍ | 199/236 [12:38<01:37,  2.64s/it]
test ppl:  85%|████████▍ | 200/236 [12:44<02:10,  3.63s/it]
test ppl:  85%|████████▌ | 201/236 [12:46<01:56,  3.32s/it]
test ppl:  86%|████████▌ | 202/236 [12:51<02:06,  3.72s/it]
test ppl:  86%|████████▌ | 203/236 [12:57<02:25,  4.39s/it]
test ppl:  86%|████████▋ | 204/236 [12:59<01:54,  3.58s/it]
test ppl:  87%|████████▋ | 205/236 [13:05<02:13,  4.30s/it]
test ppl:  87%|████████▋ | 206/236 [13:08<02:00,  4.01s/it]
test ppl:  88%|████████▊ | 207/236 [13:14<02:13,  4.59s/it]
test ppl:  88%|████████▊ | 208/236 [13:17<01:57,  4.18s/it]
test ppl:  89%|████████▊ | 209/236 [13:23<02:07,  4.74s/it]
test ppl:  89%|████████▉ | 210/236 [13:26<01:44,  4.03s/it]
test ppl:  89%|████████▉ | 211/236 [13:30<01:40,  4.02s/it]
test ppl:  90%|████████▉ | 212/236 [13:36<01:50,  4.59s/it]
test ppl:  90%|█████████ | 213/236 [13:42<01:54,  4.99s/it]
test ppl:  91%|█████████ | 214/236 [13:43<01:27,  3.99s/it]
test ppl:  91%|█████████ | 215/236 [13:49<01:36,  4.58s/it]
test ppl:  92%|█████████▏| 216/236 [13:51<01:14,  3.71s/it]
test ppl:  92%|█████████▏| 217/236 [13:57<01:23,  4.41s/it]
test ppl:  92%|█████████▏| 218/236 [13:59<01:05,  3.66s/it]
test ppl:  93%|█████████▎| 219/236 [14:05<01:14,  4.36s/it]
test ppl:  93%|█████████▎| 220/236 [14:11<01:17,  4.83s/it]
test ppl:  94%|█████████▎| 221/236 [14:12<00:58,  3.91s/it]
test ppl:  94%|█████████▍| 222/236 [14:18<01:03,  4.53s/it]
test ppl:  94%|█████████▍| 223/236 [14:24<01:04,  4.95s/it]
test ppl:  95%|█████████▍| 224/236 [14:27<00:49,  4.11s/it]
test ppl:  95%|█████████▌| 225/236 [14:34<00:55,  5.00s/it]
test ppl:  96%|█████████▌| 226/236 [14:37<00:44,  4.47s/it]
test ppl:  96%|█████████▌| 227/236 [14:40<00:37,  4.12s/it]
test ppl:  97%|█████████▋| 228/236 [14:43<00:28,  3.61s/it]
test ppl:  97%|█████████▋| 229/236 [14:50<00:32,  4.64s/it]
test ppl:  97%|█████████▋| 230/236 [14:54<00:27,  4.50s/it]
test ppl:  98%|█████████▊| 231/236 [14:58<00:21,  4.37s/it]
test ppl:  98%|█████████▊| 232/236 [15:00<00:14,  3.69s/it]
test ppl:  99%|█████████▊| 233/236 [15:03<00:10,  3.36s/it]
test ppl:  99%|█████████▉| 234/236 [15:04<00:05,  2.79s/it]
test ppl: 100%|█████████▉| 235/236 [15:11<00:04,  4.08s/it]
test ppl: 100%|██████████| 236/236 [15:12<00:00,  3.09s/it]
test ppl: 100%|██████████| 236/236 [15:12<00:00,  3.87s/it]
10/12/2024 22:14:45 - INFO - __main__ -    em: 0.2088
10/12/2024 22:14:45 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
16 0.4 60:  em: 0.2088

--------------------------------------------------------------------------------
Running experiment with knn_temp=60, lmbda=0.4, k=32
2024-10-12 22:14:52.143150: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 22:14:52.162780: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 22:14:52.184760: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 22:14:52.191474: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 22:14:52.207406: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 22:14:53.199329: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 22:14:54 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.4, knn_temp=60, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 22:14:54 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:39:13,  2.20it/s]
Adding feature api:   4%|▍         | 7090/187062 [00:00<00:10, 16934.18it/s]
Adding feature api:   8%|▊         | 15588/187062 [00:00<00:05, 34245.52it/s]
Adding feature api:  13%|█▎        | 24114/187062 [00:00<00:03, 47843.21it/s]
Adding feature api:  17%|█▋        | 32694/187062 [00:00<00:02, 58309.69it/s]
Adding feature api:  22%|██▏       | 41244/187062 [00:00<00:02, 65993.82it/s]
Adding feature api:  27%|██▋       | 49800/187062 [00:01<00:01, 71619.95it/s]
Adding feature api:  31%|███       | 58371/187062 [00:01<00:01, 75721.49it/s]
Adding feature api:  36%|███▌      | 66943/187062 [00:01<00:01, 78658.14it/s]
Adding feature api:  40%|████      | 75527/187062 [00:01<00:01, 80779.43it/s]
Adding feature api:  45%|████▍     | 84026/187062 [00:01<00:01, 82026.53it/s]
Adding feature api:  49%|████▉     | 92574/187062 [00:01<00:01, 83052.86it/s]
Adding feature api:  54%|█████▍    | 101130/187062 [00:01<00:01, 83800.18it/s]
Adding feature api:  59%|█████▊    | 109668/187062 [00:01<00:00, 84271.73it/s]
Adding feature api:  63%|██████▎   | 118183/187062 [00:01<00:00, 83734.28it/s]
Adding feature api:  68%|██████▊   | 126762/187062 [00:01<00:00, 84344.29it/s]
Adding feature api:  72%|███████▏  | 135314/187062 [00:02<00:00, 84691.69it/s]
Adding feature api:  77%|███████▋  | 143887/187062 [00:02<00:00, 84998.52it/s]
Adding feature api:  81%|████████▏ | 152439/187062 [00:02<00:00, 85151.31it/s]
Adding feature api:  86%|████████▌ | 161005/187062 [00:02<00:00, 85302.34it/s]
Adding feature api:  91%|█████████ | 169573/187062 [00:02<00:00, 85415.01it/s]
Adding feature api:  95%|█████████▌| 178123/187062 [00:02<00:00, 82955.84it/s]
Adding feature api: 100%|█████████▉| 186440/187062 [00:02<00:00, 53659.80it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 65081.78it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:47:28,  2.18it/s]
Adding feature datatype:   4%|▍         | 7162/187062 [00:00<00:10, 17030.68it/s]
Adding feature datatype:   8%|▊         | 15307/187062 [00:00<00:05, 33364.93it/s]
Adding feature datatype:  13%|█▎        | 23458/187062 [00:00<00:03, 46165.76it/s]
Adding feature datatype:  17%|█▋        | 31615/187062 [00:00<00:02, 55911.77it/s]
Adding feature datatype:  21%|██▏       | 39794/187062 [00:00<00:02, 63215.69it/s]
Adding feature datatype:  26%|██▌       | 48028/187062 [00:01<00:02, 68708.61it/s]
Adding feature datatype:  30%|███       | 56273/187062 [00:01<00:01, 72705.16it/s]
Adding feature datatype:  34%|███▍      | 64452/187062 [00:01<00:01, 75370.68it/s]
Adding feature datatype:  39%|███▉      | 72670/187062 [00:01<00:01, 77382.48it/s]
Adding feature datatype:  43%|████▎     | 80959/187062 [00:01<00:01, 79015.24it/s]
Adding feature datatype:  48%|████▊     | 89170/187062 [00:01<00:01, 79933.88it/s]
Adding feature datatype:  52%|█████▏    | 97336/187062 [00:01<00:01, 80297.07it/s]
Adding feature datatype:  56%|█████▋    | 105535/187062 [00:01<00:01, 80800.32it/s]
Adding feature datatype:  61%|██████    | 113760/187062 [00:01<00:00, 81232.51it/s]
Adding feature datatype:  65%|██████▌   | 121996/187062 [00:01<00:00, 81566.92it/s]
Adding feature datatype:  70%|██████▉   | 130220/187062 [00:02<00:00, 81767.58it/s]
Adding feature datatype:  74%|███████▍  | 138445/187062 [00:02<00:00, 81909.46it/s]
Adding feature datatype:  78%|███████▊  | 146657/187062 [00:02<00:00, 81955.90it/s]
Adding feature datatype:  83%|████████▎ | 154867/187062 [00:02<00:00, 81882.31it/s]
Adding feature datatype:  87%|████████▋ | 163078/187062 [00:02<00:00, 81947.61it/s]
Adding feature datatype:  92%|█████████▏| 171280/187062 [00:02<00:00, 81949.01it/s]
Adding feature datatype:  96%|█████████▌| 179480/187062 [00:02<00:00, 72816.48it/s]
Adding feature datatype: 100%|█████████▉| 186954/187062 [00:02<00:00, 51412.37it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63196.71it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:53:33,  2.17it/s]
Adding feature literal:   4%|▍         | 7155/187062 [00:00<00:10, 16959.10it/s]
Adding feature literal:   8%|▊         | 15334/187062 [00:00<00:05, 33358.16it/s]
Adding feature literal:  13%|█▎        | 23625/187062 [00:00<00:03, 46510.21it/s]
Adding feature literal:  17%|█▋        | 31873/187062 [00:00<00:02, 56397.76it/s]
Adding feature literal:  21%|██▏       | 40094/187062 [00:00<00:02, 63675.89it/s]
Adding feature literal:  26%|██▌       | 48403/187062 [00:01<00:02, 69250.08it/s]
Adding feature literal:  30%|███       | 56666/187062 [00:01<00:01, 73141.37it/s]
Adding feature literal:  35%|███▍      | 64912/187062 [00:01<00:01, 75874.11it/s]
Adding feature literal:  39%|███▉      | 73199/187062 [00:01<00:01, 77939.43it/s]
Adding feature literal:  44%|████▎     | 81474/187062 [00:01<00:01, 79365.33it/s]
Adding feature literal:  48%|████▊     | 89658/187062 [00:01<00:01, 79363.97it/s]
Adding feature literal:  52%|█████▏    | 97918/187062 [00:01<00:01, 80321.44it/s]
Adding feature literal:  57%|█████▋    | 106183/187062 [00:01<00:00, 81012.15it/s]
Adding feature literal:  61%|██████    | 114447/187062 [00:01<00:00, 81496.94it/s]
Adding feature literal:  66%|██████▌   | 122717/187062 [00:01<00:00, 81855.36it/s]
Adding feature literal:  70%|███████   | 130995/187062 [00:02<00:00, 82130.11it/s]
Adding feature literal:  74%|███████▍  | 139254/187062 [00:02<00:00, 82264.82it/s]
Adding feature literal:  79%|███████▉  | 147531/187062 [00:02<00:00, 82413.83it/s]
Adding feature literal:  83%|████████▎ | 155860/187062 [00:02<00:00, 82673.83it/s]
Adding feature literal:  88%|████████▊ | 164200/187062 [00:02<00:00, 82890.30it/s]
Adding feature literal:  92%|█████████▏| 172497/187062 [00:02<00:00, 82856.41it/s]
Adding feature literal:  97%|█████████▋| 180788/187062 [00:02<00:00, 68318.21it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63453.91it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:42:59,  2.19it/s]
Adding feature operator:   4%|▍         | 7225/187062 [00:00<00:10, 17221.70it/s]
Adding feature operator:   8%|▊         | 15521/187062 [00:00<00:05, 33920.23it/s]
Adding feature operator:  13%|█▎        | 23728/187062 [00:00<00:03, 46739.25it/s]
Adding feature operator:  17%|█▋        | 32054/187062 [00:00<00:02, 56800.83it/s]
Adding feature operator:  22%|██▏       | 40319/187062 [00:00<00:02, 64100.01it/s]
Adding feature operator:  26%|██▌       | 48657/187062 [00:01<00:01, 69641.66it/s]
Adding feature operator:  30%|███       | 56965/187062 [00:01<00:01, 73553.00it/s]
Adding feature operator:  35%|███▍      | 65253/187062 [00:01<00:01, 76289.46it/s]
Adding feature operator:  39%|███▉      | 73372/187062 [00:01<00:01, 77694.16it/s]
Adding feature operator:  44%|████▎     | 81718/187062 [00:01<00:01, 79403.53it/s]
Adding feature operator:  48%|████▊     | 90002/187062 [00:01<00:01, 80425.77it/s]
Adding feature operator:  53%|█████▎    | 98286/187062 [00:01<00:01, 81144.94it/s]
Adding feature operator:  57%|█████▋    | 106541/187062 [00:01<00:00, 81562.29it/s]
Adding feature operator:  61%|██████▏   | 114832/187062 [00:01<00:00, 81963.28it/s]
Adding feature operator:  66%|██████▌   | 123097/187062 [00:01<00:00, 82168.34it/s]
Adding feature operator:  70%|███████   | 131398/187062 [00:02<00:00, 82418.06it/s]
Adding feature operator:  75%|███████▍  | 139765/187062 [00:02<00:00, 82791.54it/s]
Adding feature operator:  79%|███████▉  | 148065/187062 [00:02<00:00, 82822.50it/s]
Adding feature operator:  84%|████████▎ | 156373/187062 [00:02<00:00, 82897.17it/s]
Adding feature operator:  88%|████████▊ | 164707/187062 [00:02<00:00, 83027.95it/s]
Adding feature operator:  92%|█████████▏| 173017/187062 [00:02<00:00, 82961.56it/s]
Adding feature operator:  97%|█████████▋| 181319/187062 [00:02<00:00, 65725.47it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63747.32it/s]
[2024-10-12 22:15:37,953] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 22:15:39 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 22:15:39 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:16, 391.28 examples/s]
Map:   1%|▏         | 83/6548 [00:00<00:32, 200.26 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:24, 258.99 examples/s]
Map:   3%|▎         | 172/6548 [00:00<00:20, 313.35 examples/s]
Map:   3%|▎         | 228/6548 [00:00<00:19, 331.40 examples/s]
Map:   4%|▍         | 281/6548 [00:00<00:19, 328.66 examples/s]
Map:   5%|▍         | 325/6548 [00:01<00:20, 298.47 examples/s]
Map:   6%|▌         | 363/6548 [00:01<00:19, 312.11 examples/s]
Map:   6%|▋         | 416/6548 [00:01<00:16, 363.28 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:17, 342.49 examples/s]
Map:   8%|▊         | 511/6548 [00:01<00:17, 350.43 examples/s]
Map:   9%|▊         | 565/6548 [00:01<00:15, 393.14 examples/s]
Map:   9%|▉         | 618/6548 [00:01<00:15, 375.33 examples/s]
Map:  10%|█         | 666/6548 [00:02<00:17, 344.07 examples/s]
Map:  11%|█         | 710/6548 [00:02<00:16, 361.79 examples/s]
Map:  12%|█▏        | 756/6548 [00:02<00:15, 384.78 examples/s]
Map:  12%|█▏        | 809/6548 [00:02<00:13, 420.60 examples/s]
Map:  13%|█▎        | 854/6548 [00:02<00:14, 404.20 examples/s]
Map:  14%|█▍        | 908/6548 [00:02<00:14, 386.24 examples/s]
Map:  15%|█▍        | 967/6548 [00:02<00:14, 385.88 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:23, 231.31 examples/s]
Map:  16%|█▌        | 1054/6548 [00:03<00:21, 254.45 examples/s]
Map:  17%|█▋        | 1098/6548 [00:03<00:19, 285.87 examples/s]
Map:  17%|█▋        | 1144/6548 [00:03<00:16, 321.51 examples/s]
Map:  18%|█▊        | 1202/6548 [00:03<00:15, 340.21 examples/s]
Map:  19%|█▉        | 1258/6548 [00:03<00:15, 342.27 examples/s]
Map:  20%|█▉        | 1301/6548 [00:03<00:14, 355.88 examples/s]
Map:  21%|██        | 1349/6548 [00:04<00:15, 328.06 examples/s]
Map:  21%|██        | 1385/6548 [00:04<00:17, 295.00 examples/s]
Map:  22%|██▏       | 1427/6548 [00:04<00:16, 319.24 examples/s]
Map:  22%|██▏       | 1461/6548 [00:04<00:18, 279.81 examples/s]
Map:  23%|██▎       | 1494/6548 [00:04<00:17, 287.99 examples/s]
Map:  23%|██▎       | 1531/6548 [00:04<00:16, 306.58 examples/s]
Map:  24%|██▍       | 1577/6548 [00:04<00:16, 294.79 examples/s]
Map:  25%|██▍       | 1612/6548 [00:05<00:19, 258.23 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:18, 269.26 examples/s]
Map:  26%|██▌       | 1685/6548 [00:05<00:18, 258.83 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:16, 291.46 examples/s]
Map:  27%|██▋       | 1770/6548 [00:05<00:14, 324.19 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 334.05 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:14, 334.42 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:14, 327.22 examples/s]
Map:  30%|██▉       | 1960/6548 [00:06<00:13, 330.92 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:19, 230.91 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:18, 241.72 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:16, 271.60 examples/s]
Map:  32%|███▏      | 2107/6548 [00:06<00:15, 285.62 examples/s]
Map:  33%|███▎      | 2142/6548 [00:06<00:17, 250.82 examples/s]
Map:  33%|███▎      | 2170/6548 [00:07<00:17, 254.43 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 272.15 examples/s]
Map:  34%|███▍      | 2255/6548 [00:07<00:16, 265.41 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:15, 270.57 examples/s]
Map:  36%|███▌      | 2332/6548 [00:07<00:13, 311.22 examples/s]
Map:  36%|███▋      | 2385/6548 [00:07<00:12, 321.50 examples/s]
Map:  37%|███▋      | 2425/6548 [00:07<00:12, 339.37 examples/s]
Map:  38%|███▊      | 2477/6548 [00:08<00:12, 319.49 examples/s]
Map:  38%|███▊      | 2517/6548 [00:08<00:12, 323.34 examples/s]
Map:  39%|███▉      | 2554/6548 [00:08<00:11, 333.60 examples/s]
Map:  40%|███▉      | 2599/6548 [00:08<00:10, 361.50 examples/s]
Map:  40%|████      | 2640/6548 [00:08<00:10, 370.15 examples/s]
Map:  41%|████      | 2688/6548 [00:08<00:11, 338.05 examples/s]
Map:  42%|████▏     | 2738/6548 [00:08<00:11, 332.08 examples/s]
Map:  42%|████▏     | 2775/6548 [00:08<00:11, 340.04 examples/s]
Map:  43%|████▎     | 2823/6548 [00:09<00:11, 330.48 examples/s]
Map:  44%|████▍     | 2870/6548 [00:09<00:13, 269.01 examples/s]
Map:  44%|████▍     | 2902/6548 [00:09<00:13, 275.54 examples/s]
Map:  45%|████▌     | 2950/6548 [00:09<00:12, 286.12 examples/s]
Map:  46%|████▌     | 2991/6548 [00:09<00:14, 240.61 examples/s]
Map:  46%|████▌     | 3026/6548 [00:10<00:21, 161.03 examples/s]
Map:  47%|████▋     | 3061/6548 [00:10<00:18, 187.39 examples/s]
Map:  47%|████▋     | 3094/6548 [00:10<00:16, 211.03 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 247.46 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:13, 252.00 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 242.21 examples/s]
Map:  49%|████▉     | 3238/6548 [00:10<00:12, 262.46 examples/s]
Map:  50%|████▉     | 3272/6548 [00:10<00:11, 275.35 examples/s]
Map:  50%|█████     | 3305/6548 [00:11<00:11, 285.93 examples/s]
Map:  51%|█████     | 3344/6548 [00:11<00:10, 299.94 examples/s]
Map:  52%|█████▏    | 3388/6548 [00:11<00:11, 287.11 examples/s]
Map:  52%|█████▏    | 3420/6548 [00:11<00:10, 288.20 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 274.24 examples/s]
Map:  53%|█████▎    | 3484/6548 [00:11<00:10, 280.30 examples/s]
Map:  54%|█████▍    | 3524/6548 [00:11<00:09, 309.43 examples/s]
Map:  54%|█████▍    | 3566/6548 [00:11<00:08, 334.10 examples/s]
Map:  55%|█████▌    | 3614/6548 [00:12<00:07, 370.80 examples/s]
Map:  56%|█████▌    | 3670/6548 [00:12<00:07, 369.54 examples/s]
Map:  57%|█████▋    | 3715/6548 [00:12<00:07, 385.70 examples/s]
Map:  58%|█████▊    | 3770/6548 [00:12<00:07, 357.48 examples/s]
Map:  58%|█████▊    | 3811/6548 [00:12<00:07, 367.17 examples/s]
Map:  59%|█████▉    | 3864/6548 [00:12<00:08, 310.70 examples/s]
Map:  60%|█████▉    | 3912/6548 [00:12<00:07, 346.60 examples/s]
Map:  60%|██████    | 3956/6548 [00:13<00:07, 324.29 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 238.29 examples/s]
Map:  62%|██████▏   | 4055/6548 [00:13<00:08, 293.72 examples/s]
Map:  63%|██████▎   | 4097/6548 [00:13<00:07, 317.49 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 327.80 examples/s]
Map:  64%|██████▍   | 4187/6548 [00:13<00:07, 314.18 examples/s]
Map:  65%|██████▍   | 4237/6548 [00:14<00:07, 318.07 examples/s]
Map:  65%|██████▌   | 4287/6548 [00:14<00:06, 357.56 examples/s]
Map:  66%|██████▌   | 4329/6548 [00:14<00:05, 371.30 examples/s]
Map:  67%|██████▋   | 4378/6548 [00:14<00:06, 341.80 examples/s]
Map:  67%|██████▋   | 4417/6548 [00:14<00:06, 352.29 examples/s]
Map:  68%|██████▊   | 4459/6548 [00:14<00:05, 363.81 examples/s]
Map:  69%|██████▊   | 4499/6548 [00:14<00:06, 326.48 examples/s]
Map:  69%|██████▉   | 4548/6548 [00:14<00:06, 324.96 examples/s]
Map:  70%|███████   | 4584/6548 [00:14<00:06, 325.66 examples/s]
Map:  71%|███████   | 4626/6548 [00:15<00:05, 345.02 examples/s]
Map:  71%|███████▏  | 4668/6548 [00:15<00:05, 361.05 examples/s]
Map:  72%|███████▏  | 4723/6548 [00:15<00:05, 357.15 examples/s]
Map:  73%|███████▎  | 4762/6548 [00:15<00:04, 361.22 examples/s]
Map:  74%|███████▎  | 4816/6548 [00:15<00:04, 406.93 examples/s]
Map:  75%|███████▍  | 4881/6548 [00:15<00:04, 368.22 examples/s]
Map:  75%|███████▌  | 4925/6548 [00:15<00:04, 367.19 examples/s]
Map:  76%|███████▌  | 4974/6548 [00:15<00:03, 394.86 examples/s]
Map:  77%|███████▋  | 5041/6548 [00:16<00:06, 244.44 examples/s]
Map:  78%|███████▊  | 5076/6548 [00:16<00:05, 258.43 examples/s]
Map:  78%|███████▊  | 5122/6548 [00:16<00:05, 268.21 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:05, 278.12 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 277.58 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:17<00:04, 293.43 examples/s]
Map:  80%|████████  | 5257/6548 [00:17<00:04, 300.99 examples/s]
Map:  81%|████████  | 5313/6548 [00:17<00:03, 364.16 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 311.19 examples/s]
Map:  83%|████████▎ | 5405/6548 [00:17<00:03, 293.59 examples/s]
Map:  83%|████████▎ | 5444/6548 [00:17<00:03, 307.84 examples/s]
Map:  84%|████████▍ | 5485/6548 [00:17<00:03, 327.34 examples/s]
Map:  84%|████████▍ | 5521/6548 [00:17<00:03, 326.61 examples/s]
Map:  85%|████████▍ | 5562/6548 [00:18<00:02, 343.64 examples/s]
Map:  86%|████████▌ | 5603/6548 [00:18<00:03, 314.67 examples/s]
Map:  86%|████████▌ | 5647/6548 [00:18<00:02, 328.24 examples/s]
Map:  87%|████████▋ | 5697/6548 [00:18<00:02, 318.42 examples/s]
Map:  88%|████████▊ | 5740/6548 [00:18<00:02, 340.66 examples/s]
Map:  89%|████████▊ | 5796/6548 [00:18<00:02, 341.93 examples/s]
Map:  89%|████████▉ | 5845/6548 [00:18<00:02, 331.88 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:19<00:01, 341.52 examples/s]
Map:  90%|█████████ | 5923/6548 [00:19<00:01, 353.53 examples/s]
Map:  91%|█████████ | 5966/6548 [00:19<00:01, 328.09 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 209.64 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:02, 243.69 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 276.90 examples/s]
Map:  94%|█████████▎| 6123/6548 [00:19<00:01, 272.47 examples/s]
Map:  94%|█████████▍| 6164/6548 [00:20<00:01, 291.67 examples/s]
Map:  95%|█████████▍| 6216/6548 [00:20<00:01, 302.67 examples/s]
Map:  95%|█████████▌| 6249/6548 [00:20<00:00, 306.43 examples/s]
Map:  96%|█████████▋| 6303/6548 [00:20<00:00, 322.80 examples/s]
Map:  97%|█████████▋| 6365/6548 [00:20<00:00, 335.11 examples/s]
Map:  98%|█████████▊| 6418/6548 [00:20<00:00, 334.53 examples/s]
Map:  99%|█████████▉| 6468/6548 [00:20<00:00, 370.09 examples/s]
Map: 100%|█████████▉| 6525/6548 [00:21<00:00, 369.39 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 307.77 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▎         | 32/903 [00:00<00:03, 279.54 examples/s]
Map:   7%|▋         | 63/903 [00:00<00:02, 292.50 examples/s]
Map:  11%|█         | 98/903 [00:00<00:02, 298.10 examples/s]
Map:  15%|█▌        | 138/903 [00:00<00:02, 328.35 examples/s]
Map:  21%|██        | 186/903 [00:00<00:01, 374.86 examples/s]
Map:  25%|██▌       | 230/903 [00:00<00:01, 376.31 examples/s]
Map:  30%|██▉       | 270/903 [00:00<00:01, 382.12 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 380.84 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 332.62 examples/s]
Map:  45%|████▌     | 410/903 [00:01<00:01, 298.27 examples/s]
Map:  51%|█████     | 460/903 [00:01<00:01, 301.60 examples/s]
Map:  54%|█████▍    | 492/903 [00:01<00:01, 304.53 examples/s]
Map:  60%|█████▉    | 539/903 [00:01<00:01, 340.38 examples/s]
Map:  65%|██████▌   | 588/903 [00:01<00:00, 371.07 examples/s]
Map:  70%|███████   | 633/903 [00:01<00:00, 377.88 examples/s]
Map:  75%|███████▍  | 673/903 [00:01<00:00, 380.11 examples/s]
Map:  79%|███████▉  | 716/903 [00:02<00:00, 384.73 examples/s]
Map:  85%|████████▍ | 766/903 [00:02<00:00, 402.83 examples/s]
Map:  90%|█████████ | 817/903 [00:02<00:00, 376.49 examples/s]
Map:  95%|█████████▌| 862/903 [00:02<00:00, 379.25 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 236.25 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 324.28 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 298.68 examples/s]
Map:   4%|▍         | 82/1882 [00:00<00:04, 369.95 examples/s]
Map:   7%|▋         | 135/1882 [00:00<00:05, 342.53 examples/s]
Map:  10%|▉         | 180/1882 [00:00<00:04, 373.91 examples/s]
Map:  13%|█▎        | 239/1882 [00:00<00:04, 379.29 examples/s]
Map:  15%|█▍        | 280/1882 [00:00<00:04, 381.75 examples/s]
Map:  18%|█▊        | 334/1882 [00:00<00:04, 365.53 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:04, 320.32 examples/s]
Map:  22%|██▏       | 414/1882 [00:01<00:04, 297.39 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 305.08 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 340.38 examples/s]
Map:  28%|██▊       | 536/1882 [00:01<00:04, 316.75 examples/s]
Map:  31%|███       | 577/1882 [00:01<00:03, 338.02 examples/s]
Map:  34%|███▎      | 635/1882 [00:01<00:03, 398.03 examples/s]
Map:  36%|███▌      | 678/1882 [00:01<00:03, 395.06 examples/s]
Map:  39%|███▉      | 734/1882 [00:02<00:02, 383.86 examples/s]
Map:  42%|████▏     | 793/1882 [00:02<00:02, 367.38 examples/s]
Map:  45%|████▌     | 850/1882 [00:02<00:02, 370.19 examples/s]
Map:  48%|████▊     | 906/1882 [00:02<00:02, 366.56 examples/s]
Map:  50%|█████     | 948/1882 [00:02<00:02, 377.12 examples/s]
Map:  53%|█████▎    | 991/1882 [00:02<00:02, 374.40 examples/s]
Map:  55%|█████▌    | 1039/1882 [00:03<00:03, 245.59 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 258.67 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 270.83 examples/s]
Map:  61%|██████    | 1139/1882 [00:03<00:02, 280.09 examples/s]
Map:  62%|██████▏   | 1175/1882 [00:03<00:02, 296.91 examples/s]
Map:  65%|██████▍   | 1220/1882 [00:03<00:02, 262.08 examples/s]
Map:  67%|██████▋   | 1253/1882 [00:03<00:02, 276.02 examples/s]
Map:  69%|██████▊   | 1292/1882 [00:03<00:01, 302.06 examples/s]
Map:  71%|███████   | 1327/1882 [00:04<00:01, 312.35 examples/s]
Map:  73%|███████▎  | 1376/1882 [00:04<00:01, 311.27 examples/s]
Map:  75%|███████▌  | 1413/1882 [00:04<00:01, 320.16 examples/s]
Map:  77%|███████▋  | 1448/1882 [00:04<00:01, 282.05 examples/s]
Map:  79%|███████▉  | 1493/1882 [00:04<00:01, 275.72 examples/s]
Map:  81%|████████  | 1524/1882 [00:04<00:01, 274.45 examples/s]
Map:  83%|████████▎ | 1557/1882 [00:04<00:01, 286.60 examples/s]
Map:  85%|████████▌ | 1607/1882 [00:04<00:00, 336.94 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 334.47 examples/s]
Map:  91%|█████████ | 1713/1882 [00:05<00:00, 335.93 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 286.82 examples/s]
Map:  95%|█████████▍| 1785/1882 [00:05<00:00, 287.94 examples/s]
Map:  97%|█████████▋| 1830/1882 [00:05<00:00, 323.32 examples/s]
Map: 100%|█████████▉| 1874/1882 [00:05<00:00, 350.23 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 311.74 examples/s]
10/12/2024 22:16:41 - INFO - __main__ -     ***** Testing *****
10/12/2024 22:16:41 - INFO - __main__ -     Batch size = 8
10/12/2024 22:16:41 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 22:16:42 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 22:16:42 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 22:16:43 - INFO - knnlm -   Reading datastore took 0.9646661281585693 s
10/12/2024 22:16:43 - INFO - knnlm -   Moving index to GPU took 0.9036471843719482 s
10/12/2024 22:16:43 - INFO - __main__ -   ******************************break-into
10/12/2024 22:16:43 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 22:16:43 - INFO - __main__ -     Num examples = 236
10/12/2024 22:16:43 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<34:16,  8.75s/it]
test ppl:   1%|          | 2/236 [00:11<19:24,  4.98s/it]
test ppl:   1%|▏         | 3/236 [00:12<13:46,  3.55s/it]
test ppl:   2%|▏         | 4/236 [00:20<19:22,  5.01s/it]
test ppl:   2%|▏         | 5/236 [00:27<22:27,  5.84s/it]
test ppl:   3%|▎         | 6/236 [00:34<24:15,  6.33s/it]
test ppl:   3%|▎         | 7/236 [00:37<19:13,  5.04s/it]
test ppl:   3%|▎         | 8/236 [00:43<20:22,  5.36s/it]
test ppl:   4%|▍         | 9/236 [00:45<17:08,  4.53s/it]
test ppl:   4%|▍         | 10/236 [00:52<19:25,  5.16s/it]
test ppl:   5%|▍         | 11/236 [00:54<16:08,  4.30s/it]
test ppl:   5%|▌         | 12/236 [00:59<16:37,  4.45s/it]
test ppl:   6%|▌         | 13/236 [01:05<18:18,  4.93s/it]
test ppl:   6%|▌         | 14/236 [01:07<15:20,  4.14s/it]
test ppl:   6%|▋         | 15/236 [01:09<12:12,  3.32s/it]
test ppl:   7%|▋         | 16/236 [01:11<10:32,  2.88s/it]
test ppl:   7%|▋         | 17/236 [01:17<13:48,  3.78s/it]
test ppl:   8%|▊         | 18/236 [01:18<11:27,  3.15s/it]
test ppl:   8%|▊         | 19/236 [01:23<12:49,  3.55s/it]
test ppl:   8%|▊         | 20/236 [01:25<10:51,  3.02s/it]
test ppl:   9%|▉         | 21/236 [01:30<13:52,  3.87s/it]
test ppl:   9%|▉         | 22/236 [01:36<15:58,  4.48s/it]
test ppl:  10%|▉         | 23/236 [01:39<13:48,  3.89s/it]
test ppl:  10%|█         | 24/236 [01:41<12:06,  3.43s/it]
test ppl:  11%|█         | 25/236 [01:47<14:38,  4.16s/it]
test ppl:  11%|█         | 26/236 [01:53<16:23,  4.68s/it]
test ppl:  11%|█▏        | 27/236 [01:56<15:01,  4.31s/it]
test ppl:  12%|█▏        | 28/236 [01:58<11:43,  3.38s/it]
test ppl:  12%|█▏        | 29/236 [02:00<10:34,  3.07s/it]
test ppl:  13%|█▎        | 30/236 [02:01<08:56,  2.60s/it]
test ppl:  13%|█▎        | 31/236 [02:03<08:16,  2.42s/it]
test ppl:  14%|█▎        | 32/236 [02:06<08:28,  2.49s/it]
test ppl:  14%|█▍        | 33/236 [02:09<08:23,  2.48s/it]
test ppl:  14%|█▍        | 34/236 [02:13<09:53,  2.94s/it]
test ppl:  15%|█▍        | 35/236 [02:15<09:26,  2.82s/it]
test ppl:  15%|█▌        | 36/236 [02:21<12:26,  3.73s/it]
test ppl:  16%|█▌        | 37/236 [02:27<14:32,  4.39s/it]
test ppl:  16%|█▌        | 38/236 [02:29<12:10,  3.69s/it]
test ppl:  17%|█▋        | 39/236 [02:31<10:14,  3.12s/it]
test ppl:  17%|█▋        | 40/236 [02:33<09:45,  2.99s/it]
test ppl:  17%|█▋        | 41/236 [02:35<08:36,  2.65s/it]
test ppl:  18%|█▊        | 42/236 [02:41<11:44,  3.63s/it]
test ppl:  18%|█▊        | 43/236 [02:47<13:49,  4.30s/it]
test ppl:  19%|█▊        | 44/236 [02:49<11:53,  3.72s/it]
test ppl:  19%|█▉        | 45/236 [02:51<10:09,  3.19s/it]
test ppl:  19%|█▉        | 46/236 [02:57<12:42,  4.01s/it]
test ppl:  20%|█▉        | 47/236 [02:59<10:17,  3.26s/it]
test ppl:  20%|██        | 48/236 [03:05<12:39,  4.04s/it]
test ppl:  21%|██        | 49/236 [03:09<12:52,  4.13s/it]
test ppl:  21%|██        | 50/236 [03:15<14:29,  4.68s/it]
test ppl:  22%|██▏       | 51/236 [03:19<14:12,  4.61s/it]
test ppl:  22%|██▏       | 52/236 [03:25<15:17,  4.99s/it]
test ppl:  22%|██▏       | 53/236 [03:30<15:03,  4.93s/it]
test ppl:  23%|██▎       | 54/236 [03:32<11:52,  3.92s/it]
test ppl:  23%|██▎       | 55/236 [03:37<13:28,  4.47s/it]
test ppl:  24%|██▎       | 56/236 [03:41<12:26,  4.15s/it]
test ppl:  24%|██▍       | 57/236 [03:43<10:44,  3.60s/it]
test ppl:  25%|██▍       | 58/236 [03:45<09:25,  3.18s/it]
test ppl:  25%|██▌       | 59/236 [03:51<11:46,  3.99s/it]
test ppl:  25%|██▌       | 60/236 [03:54<10:50,  3.69s/it]
test ppl:  26%|██▌       | 61/236 [04:00<12:41,  4.35s/it]
test ppl:  26%|██▋       | 62/236 [04:06<13:58,  4.82s/it]
test ppl:  27%|██▋       | 63/236 [04:09<11:53,  4.12s/it]
test ppl:  27%|██▋       | 64/236 [04:11<10:05,  3.52s/it]
test ppl:  28%|██▊       | 65/236 [04:12<08:11,  2.87s/it]
test ppl:  28%|██▊       | 66/236 [04:15<08:17,  2.93s/it]
test ppl:  28%|██▊       | 67/236 [04:21<10:47,  3.83s/it]
test ppl:  29%|██▉       | 68/236 [04:27<12:29,  4.46s/it]
test ppl:  29%|██▉       | 69/236 [04:33<13:37,  4.89s/it]
test ppl:  30%|██▉       | 70/236 [04:34<10:51,  3.93s/it]
test ppl:  30%|███       | 71/236 [04:38<10:32,  3.83s/it]
test ppl:  31%|███       | 72/236 [04:42<10:29,  3.84s/it]
test ppl:  31%|███       | 73/236 [04:48<11:50,  4.36s/it]
test ppl:  31%|███▏      | 74/236 [04:49<09:29,  3.51s/it]
test ppl:  32%|███▏      | 75/236 [04:55<11:22,  4.24s/it]
test ppl:  32%|███▏      | 76/236 [04:59<10:44,  4.03s/it]
test ppl:  33%|███▎      | 77/236 [05:01<09:21,  3.53s/it]
test ppl:  33%|███▎      | 78/236 [05:02<07:44,  2.94s/it]
test ppl:  33%|███▎      | 79/236 [05:06<08:29,  3.25s/it]
test ppl:  34%|███▍      | 80/236 [05:08<07:21,  2.83s/it]
test ppl:  34%|███▍      | 81/236 [05:14<09:54,  3.84s/it]
test ppl:  35%|███▍      | 82/236 [05:20<11:22,  4.43s/it]
test ppl:  35%|███▌      | 83/236 [05:23<09:38,  3.78s/it]
test ppl:  36%|███▌      | 84/236 [05:25<08:15,  3.26s/it]
test ppl:  36%|███▌      | 85/236 [05:29<08:56,  3.55s/it]
test ppl:  36%|███▋      | 86/236 [05:31<07:42,  3.08s/it]
test ppl:  37%|███▋      | 87/236 [05:33<06:55,  2.79s/it]
test ppl:  37%|███▋      | 88/236 [05:39<09:18,  3.77s/it]
test ppl:  38%|███▊      | 89/236 [05:45<10:48,  4.41s/it]
test ppl:  38%|███▊      | 90/236 [05:51<11:58,  4.92s/it]
test ppl:  39%|███▊      | 91/236 [05:57<12:21,  5.11s/it]
test ppl:  39%|███▉      | 92/236 [06:00<11:13,  4.67s/it]
test ppl:  39%|███▉      | 93/236 [06:08<13:35,  5.70s/it]
test ppl:  40%|███▉      | 94/236 [06:16<15:14,  6.44s/it]
test ppl:  40%|████      | 95/236 [06:21<13:33,  5.77s/it]
test ppl:  41%|████      | 96/236 [06:25<12:06,  5.19s/it]
test ppl:  41%|████      | 97/236 [06:33<14:21,  6.20s/it]
test ppl:  42%|████▏     | 98/236 [06:42<16:00,  6.96s/it]
test ppl:  42%|████▏     | 99/236 [06:51<17:06,  7.49s/it]
test ppl:  42%|████▏     | 100/236 [06:52<13:12,  5.82s/it]
test ppl:  43%|████▎     | 101/236 [07:00<14:08,  6.28s/it]
test ppl:  43%|████▎     | 102/236 [07:05<13:19,  5.97s/it]
test ppl:  44%|████▎     | 103/236 [07:07<10:29,  4.73s/it]
test ppl:  44%|████▍     | 104/236 [07:13<11:09,  5.07s/it]
test ppl:  44%|████▍     | 105/236 [07:19<11:41,  5.35s/it]
test ppl:  45%|████▍     | 106/236 [07:26<12:43,  5.87s/it]
test ppl:  45%|████▌     | 107/236 [07:29<10:32,  4.90s/it]
test ppl:  46%|████▌     | 108/236 [07:36<12:18,  5.77s/it]
test ppl:  46%|████▌     | 109/236 [07:42<11:53,  5.62s/it]
test ppl:  47%|████▋     | 110/236 [07:45<10:11,  4.85s/it]
test ppl:  47%|████▋     | 111/236 [07:50<10:24,  5.00s/it]
test ppl:  47%|████▋     | 112/236 [07:55<10:28,  5.07s/it]
test ppl:  48%|████▊     | 113/236 [07:58<09:01,  4.40s/it]
test ppl:  48%|████▊     | 114/236 [08:03<09:33,  4.70s/it]
test ppl:  49%|████▊     | 115/236 [08:13<12:27,  6.18s/it]
test ppl:  49%|████▉     | 116/236 [08:21<13:31,  6.77s/it]
test ppl:  50%|████▉     | 117/236 [08:24<10:51,  5.47s/it]
test ppl:  50%|█████     | 118/236 [08:29<10:57,  5.58s/it]
test ppl:  50%|█████     | 119/236 [08:36<11:12,  5.75s/it]
test ppl:  51%|█████     | 120/236 [08:37<08:47,  4.55s/it]
test ppl:  51%|█████▏    | 121/236 [08:45<10:30,  5.48s/it]
test ppl:  52%|█████▏    | 122/236 [08:51<10:50,  5.71s/it]
test ppl:  52%|█████▏    | 123/236 [08:54<09:06,  4.83s/it]
test ppl:  53%|█████▎    | 124/236 [08:58<08:18,  4.45s/it]
test ppl:  53%|█████▎    | 125/236 [09:05<10:00,  5.41s/it]
test ppl:  53%|█████▎    | 126/236 [09:10<09:36,  5.24s/it]
test ppl:  54%|█████▍    | 127/236 [09:13<08:09,  4.49s/it]
test ppl:  54%|█████▍    | 128/236 [09:16<07:14,  4.02s/it]
test ppl:  55%|█████▍    | 129/236 [09:20<07:05,  3.98s/it]
test ppl:  55%|█████▌    | 130/236 [09:23<06:45,  3.83s/it]
test ppl:  56%|█████▌    | 131/236 [09:31<08:44,  4.99s/it]
test ppl:  56%|█████▌    | 132/236 [09:34<07:44,  4.47s/it]
test ppl:  56%|█████▋    | 133/236 [09:39<07:59,  4.65s/it]
test ppl:  57%|█████▋    | 134/236 [09:44<08:07,  4.78s/it]
test ppl:  57%|█████▋    | 135/236 [09:52<09:29,  5.64s/it]
test ppl:  58%|█████▊    | 136/236 [09:54<07:23,  4.43s/it]
test ppl:  58%|█████▊    | 137/236 [10:01<08:55,  5.41s/it]
test ppl:  58%|█████▊    | 138/236 [10:05<08:13,  5.03s/it]
test ppl:  59%|█████▉    | 139/236 [10:09<07:20,  4.54s/it]
test ppl:  59%|█████▉    | 140/236 [10:11<06:07,  3.83s/it]
test ppl:  60%|█████▉    | 141/236 [10:15<06:01,  3.81s/it]
test ppl:  60%|██████    | 142/236 [10:17<05:28,  3.49s/it]
test ppl:  61%|██████    | 143/236 [10:24<07:00,  4.52s/it]
test ppl:  61%|██████    | 144/236 [10:28<06:29,  4.23s/it]
test ppl:  61%|██████▏   | 145/236 [10:35<07:52,  5.19s/it]
test ppl:  62%|██████▏   | 146/236 [10:41<08:05,  5.40s/it]
test ppl:  62%|██████▏   | 147/236 [10:49<09:02,  6.09s/it]
test ppl:  63%|██████▎   | 148/236 [10:57<09:41,  6.61s/it]
test ppl:  63%|██████▎   | 149/236 [11:01<08:37,  5.95s/it]
test ppl:  64%|██████▎   | 150/236 [11:09<09:16,  6.47s/it]
test ppl:  64%|██████▍   | 151/236 [11:17<09:40,  6.83s/it]
test ppl:  64%|██████▍   | 152/236 [11:24<09:53,  7.06s/it]
test ppl:  65%|██████▍   | 153/236 [11:32<10:02,  7.26s/it]
test ppl:  65%|██████▌   | 154/236 [11:35<08:17,  6.06s/it]
test ppl:  66%|██████▌   | 155/236 [11:39<07:06,  5.26s/it]
test ppl:  66%|██████▌   | 156/236 [11:42<06:08,  4.60s/it]
test ppl:  67%|██████▋   | 157/236 [11:44<05:22,  4.08s/it]
test ppl:  67%|██████▋   | 158/236 [11:52<06:41,  5.15s/it]
test ppl:  67%|██████▋   | 159/236 [12:00<07:35,  5.91s/it]
test ppl:  68%|██████▊   | 160/236 [12:01<05:49,  4.60s/it]
test ppl:  68%|██████▊   | 161/236 [12:03<04:41,  3.75s/it]
test ppl:  69%|██████▊   | 162/236 [12:07<04:46,  3.87s/it]
test ppl:  69%|██████▉   | 163/236 [12:11<04:30,  3.70s/it]
test ppl:  69%|██████▉   | 164/236 [12:14<04:31,  3.77s/it]
test ppl:  70%|██████▉   | 165/236 [12:21<05:18,  4.49s/it]
test ppl:  70%|███████   | 166/236 [12:23<04:32,  3.90s/it]
test ppl:  71%|███████   | 167/236 [12:25<03:48,  3.31s/it]
test ppl:  71%|███████   | 168/236 [12:31<04:29,  3.96s/it]
test ppl:  72%|███████▏  | 169/236 [12:38<05:39,  5.06s/it]
test ppl:  72%|███████▏  | 170/236 [12:46<06:30,  5.91s/it]
test ppl:  72%|███████▏  | 171/236 [12:48<05:03,  4.66s/it]
test ppl:  73%|███████▎  | 172/236 [12:56<05:57,  5.59s/it]
test ppl:  73%|███████▎  | 173/236 [13:00<05:26,  5.18s/it]
test ppl:  74%|███████▎  | 174/236 [13:08<06:09,  5.95s/it]
test ppl:  74%|███████▍  | 175/236 [13:10<05:00,  4.93s/it]
test ppl:  75%|███████▍  | 176/236 [13:18<05:44,  5.75s/it]
test ppl:  75%|███████▌  | 177/236 [13:26<06:16,  6.38s/it]
test ppl:  75%|███████▌  | 178/236 [13:33<06:33,  6.79s/it]
test ppl:  76%|███████▌  | 179/236 [13:43<07:12,  7.60s/it]
test ppl:  76%|███████▋  | 180/236 [13:53<07:39,  8.21s/it]
test ppl:  77%|███████▋  | 181/236 [14:02<07:54,  8.63s/it]
test ppl:  77%|███████▋  | 182/236 [14:05<06:15,  6.95s/it]
test ppl:  78%|███████▊  | 183/236 [14:08<05:05,  5.76s/it]
test ppl:  78%|███████▊  | 184/236 [14:11<04:06,  4.74s/it]
test ppl:  78%|███████▊  | 185/236 [14:16<04:09,  4.89s/it]
test ppl:  79%|███████▉  | 186/236 [14:18<03:30,  4.21s/it]
test ppl:  79%|███████▉  | 187/236 [14:27<04:26,  5.45s/it]
test ppl:  80%|███████▉  | 188/236 [14:35<05:03,  6.33s/it]
test ppl:  80%|████████  | 189/236 [14:43<05:16,  6.74s/it]
test ppl:  81%|████████  | 190/236 [14:48<04:44,  6.18s/it]
test ppl:  81%|████████  | 191/236 [14:53<04:21,  5.82s/it]
test ppl:  81%|████████▏ | 192/236 [14:56<03:44,  5.11s/it]
test ppl:  82%|████████▏ | 193/236 [15:04<04:16,  5.96s/it]
test ppl:  82%|████████▏ | 194/236 [15:07<03:38,  5.20s/it]
test ppl:  83%|████████▎ | 195/236 [15:11<03:18,  4.85s/it]
test ppl:  83%|████████▎ | 196/236 [15:14<02:48,  4.21s/it]
test ppl:  83%|████████▎ | 197/236 [15:17<02:27,  3.78s/it]
test ppl:  84%|████████▍ | 198/236 [15:25<03:09,  4.98s/it]
test ppl:  84%|████████▍ | 199/236 [15:28<02:48,  4.55s/it]
test ppl:  85%|████████▍ | 200/236 [15:36<03:18,  5.52s/it]
test ppl:  85%|████████▌ | 201/236 [15:39<02:43,  4.67s/it]
test ppl:  86%|████████▌ | 202/236 [15:45<02:52,  5.08s/it]
test ppl:  86%|████████▌ | 203/236 [15:53<03:14,  5.90s/it]
test ppl:  86%|████████▋ | 204/236 [15:55<02:32,  4.76s/it]
test ppl:  87%|████████▋ | 205/236 [16:03<02:57,  5.72s/it]
test ppl:  87%|████████▋ | 206/236 [16:07<02:41,  5.38s/it]
test ppl:  88%|████████▊ | 207/236 [16:15<02:56,  6.08s/it]
test ppl:  88%|████████▊ | 208/236 [16:19<02:34,  5.52s/it]
test ppl:  89%|████████▊ | 209/236 [16:27<02:47,  6.19s/it]
test ppl:  89%|████████▉ | 210/236 [16:30<02:16,  5.27s/it]
test ppl:  89%|████████▉ | 211/236 [16:35<02:09,  5.19s/it]
test ppl:  90%|████████▉ | 212/236 [16:43<02:22,  5.93s/it]
test ppl:  90%|█████████ | 213/236 [16:51<02:31,  6.61s/it]
test ppl:  91%|█████████ | 214/236 [16:53<01:55,  5.27s/it]
test ppl:  91%|█████████ | 215/236 [17:01<02:06,  6.01s/it]
test ppl:  92%|█████████▏| 216/236 [17:04<01:43,  5.20s/it]
test ppl:  92%|█████████▏| 217/236 [17:12<01:54,  6.01s/it]
test ppl:  92%|█████████▏| 218/236 [17:15<01:33,  5.18s/it]
test ppl:  93%|█████████▎| 219/236 [17:23<01:41,  5.96s/it]
test ppl:  93%|█████████▎| 220/236 [17:31<01:43,  6.49s/it]
test ppl:  94%|█████████▎| 221/236 [17:34<01:24,  5.62s/it]
test ppl:  94%|█████████▍| 222/236 [17:42<01:27,  6.26s/it]
test ppl:  94%|█████████▍| 223/236 [17:50<01:27,  6.71s/it]
test ppl:  95%|█████████▍| 224/236 [17:52<01:03,  5.31s/it]
test ppl:  95%|█████████▌| 225/236 [18:00<01:06,  6.03s/it]
test ppl:  96%|█████████▌| 226/236 [18:04<00:56,  5.66s/it]
test ppl:  96%|█████████▌| 227/236 [18:08<00:45,  5.08s/it]
test ppl:  97%|█████████▋| 228/236 [18:11<00:34,  4.31s/it]
test ppl:  97%|█████████▋| 229/236 [18:18<00:37,  5.31s/it]
test ppl:  97%|█████████▋| 230/236 [18:23<00:30,  5.08s/it]
test ppl:  98%|█████████▊| 231/236 [18:27<00:24,  4.88s/it]
test ppl:  98%|█████████▊| 232/236 [18:30<00:16,  4.10s/it]
test ppl:  99%|█████████▊| 233/236 [18:32<00:11,  3.71s/it]
test ppl:  99%|█████████▉| 234/236 [18:35<00:06,  3.36s/it]
test ppl: 100%|█████████▉| 235/236 [18:43<00:04,  4.66s/it]
test ppl: 100%|██████████| 236/236 [18:43<00:00,  3.52s/it]
test ppl: 100%|██████████| 236/236 [18:43<00:00,  4.76s/it]
10/12/2024 22:35:27 - INFO - __main__ -    em: 0.2083
10/12/2024 22:35:27 - INFO - __main__ -   Finish and take 20m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/eval_results.json
32 0.4 60:  em: 0.2083

--------------------------------------------------------------------------------
Running experiment with knn_temp=60, lmbda=0.4, k=64
2024-10-12 22:35:35.720943: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 22:35:35.741124: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 22:35:35.763574: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 22:35:35.770318: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 22:35:35.786502: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 22:35:36.889576: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 22:35:38 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.4, knn_temp=60, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 22:35:38 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<29:48:09,  1.74it/s]
Adding feature api:   3%|▎         | 4762/187062 [00:00<00:19, 9494.84it/s]
Adding feature api:   6%|▌         | 10846/187062 [00:00<00:08, 20877.56it/s]
Adding feature api:   9%|▉         | 16973/187062 [00:00<00:05, 30592.77it/s]
Adding feature api:  12%|█▏        | 23159/187062 [00:00<00:04, 38587.69it/s]
Adding feature api:  16%|█▌        | 29310/187062 [00:01<00:03, 44720.86it/s]
Adding feature api:  19%|█▉        | 35463/187062 [00:01<00:03, 49368.86it/s]
Adding feature api:  22%|██▏       | 41661/187062 [00:01<00:02, 52938.62it/s]
Adding feature api:  26%|██▌       | 47861/187062 [00:01<00:02, 55546.93it/s]
Adding feature api:  29%|██▉       | 54033/187062 [00:01<00:02, 57344.37it/s]
Adding feature api:  32%|███▏      | 60219/187062 [00:01<00:02, 58670.28it/s]
Adding feature api:  35%|███▌      | 66327/187062 [00:01<00:02, 59125.43it/s]
Adding feature api:  39%|███▉      | 72526/187062 [00:01<00:01, 59971.87it/s]
Adding feature api:  42%|████▏     | 78696/187062 [00:01<00:01, 60484.02it/s]
Adding feature api:  45%|████▌     | 84862/187062 [00:01<00:01, 60831.58it/s]
Adding feature api:  49%|████▊     | 91026/187062 [00:02<00:01, 61072.20it/s]
Adding feature api:  52%|█████▏    | 97210/187062 [00:02<00:01, 61300.16it/s]
Adding feature api:  55%|█████▌    | 103432/187062 [00:02<00:01, 61574.15it/s]
Adding feature api:  59%|█████▊    | 109610/187062 [00:02<00:01, 61632.21it/s]
Adding feature api:  62%|██████▏   | 115797/187062 [00:02<00:01, 61699.96it/s]
Adding feature api:  65%|██████▌   | 121993/187062 [00:02<00:01, 61776.16it/s]
Adding feature api:  69%|██████▊   | 128178/187062 [00:02<00:00, 61741.47it/s]
Adding feature api:  72%|███████▏  | 134368/187062 [00:02<00:00, 61786.08it/s]
Adding feature api:  75%|███████▌  | 140552/187062 [00:02<00:00, 61801.25it/s]
Adding feature api:  78%|███████▊  | 146735/187062 [00:02<00:00, 61324.94it/s]
Adding feature api:  82%|████████▏ | 152915/187062 [00:03<00:00, 61465.06it/s]
Adding feature api:  85%|████████▌ | 159087/187062 [00:03<00:00, 61538.13it/s]
Adding feature api:  88%|████████▊ | 165299/187062 [00:03<00:00, 61710.00it/s]
Adding feature api:  92%|█████████▏| 171476/187062 [00:03<00:00, 61726.04it/s]
Adding feature api:  95%|█████████▍| 177650/187062 [00:03<00:00, 61682.35it/s]
Adding feature api:  98%|█████████▊| 183819/187062 [00:03<00:00, 39229.31it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 48085.90it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:51:03,  2.18it/s]
Adding feature datatype:   4%|▎         | 6978/187062 [00:00<00:10, 16561.69it/s]
Adding feature datatype:   8%|▊         | 14948/187062 [00:00<00:05, 32548.15it/s]
Adding feature datatype:  12%|█▏        | 22925/187062 [00:00<00:03, 45090.19it/s]
Adding feature datatype:  17%|█▋        | 30939/187062 [00:00<00:02, 54731.25it/s]
Adding feature datatype:  21%|██        | 38989/187062 [00:00<00:02, 61999.21it/s]
Adding feature datatype:  25%|██▌       | 47018/187062 [00:01<00:02, 67250.97it/s]
Adding feature datatype:  29%|██▉       | 54897/187062 [00:01<00:01, 70605.11it/s]
Adding feature datatype:  34%|███▎      | 62908/187062 [00:01<00:01, 73393.84it/s]
Adding feature datatype:  38%|███▊      | 70927/187062 [00:01<00:01, 75400.26it/s]
Adding feature datatype:  42%|████▏     | 78993/187062 [00:01<00:01, 76959.73it/s]
Adding feature datatype:  46%|████▋     | 86963/187062 [00:01<00:01, 77774.15it/s]
Adding feature datatype:  51%|█████     | 94984/187062 [00:01<00:01, 78498.19it/s]
Adding feature datatype:  55%|█████▌    | 102987/187062 [00:01<00:01, 78953.80it/s]
Adding feature datatype:  59%|█████▉    | 111022/187062 [00:01<00:00, 79369.38it/s]
Adding feature datatype:  64%|██████▎   | 119073/187062 [00:01<00:00, 79707.48it/s]
Adding feature datatype:  68%|██████▊   | 127110/187062 [00:02<00:00, 79902.92it/s]
Adding feature datatype:  72%|███████▏  | 135170/187062 [00:02<00:00, 80109.52it/s]
Adding feature datatype:  77%|███████▋  | 143245/187062 [00:02<00:00, 80299.26it/s]
Adding feature datatype:  81%|████████  | 151300/187062 [00:02<00:00, 80371.76it/s]
Adding feature datatype:  85%|████████▌ | 159348/187062 [00:02<00:00, 80061.08it/s]
Adding feature datatype:  89%|████████▉ | 167407/187062 [00:02<00:00, 80216.00it/s]
Adding feature datatype:  94%|█████████▍| 175434/187062 [00:02<00:00, 80097.01it/s]
Adding feature datatype:  98%|█████████▊| 183448/187062 [00:02<00:00, 56798.61it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 62214.03it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<29:49:08,  1.74it/s]
Adding feature literal:   3%|▎         | 5168/187062 [00:00<00:17, 10300.01it/s]
Adding feature literal:   6%|▌         | 11193/187062 [00:00<00:08, 21369.94it/s]
Adding feature literal:   9%|▉         | 17092/187062 [00:00<00:05, 30415.78it/s]
Adding feature literal:  12%|█▏        | 23121/187062 [00:00<00:04, 38053.19it/s]
Adding feature literal:  16%|█▌        | 29215/187062 [00:01<00:03, 44174.49it/s]
Adding feature literal:  19%|█▉        | 35326/187062 [00:01<00:03, 48855.34it/s]
Adding feature literal:  22%|██▏       | 41422/187062 [00:01<00:02, 52281.60it/s]
Adding feature literal:  25%|██▌       | 47515/187062 [00:01<00:02, 54770.20it/s]
Adding feature literal:  29%|██▊       | 53630/187062 [00:01<00:02, 56627.57it/s]
Adding feature literal:  32%|███▏      | 59704/187062 [00:01<00:02, 57835.72it/s]
Adding feature literal:  35%|███▌      | 65811/187062 [00:01<00:02, 58789.61it/s]
Adding feature literal:  38%|███▊      | 71931/187062 [00:01<00:01, 59504.69it/s]
Adding feature literal:  42%|████▏     | 78033/187062 [00:01<00:01, 59949.86it/s]
Adding feature literal:  45%|████▍     | 84141/187062 [00:01<00:01, 60285.17it/s]
Adding feature literal:  48%|████▊     | 90228/187062 [00:02<00:01, 60388.48it/s]
Adding feature literal:  51%|█████▏    | 96308/187062 [00:02<00:01, 60090.06it/s]
Adding feature literal:  55%|█████▍    | 102416/187062 [00:02<00:01, 60383.85it/s]
Adding feature literal:  58%|█████▊    | 108542/187062 [00:02<00:01, 60643.44it/s]
Adding feature literal:  61%|██████▏   | 114646/187062 [00:02<00:01, 60760.92it/s]
Adding feature literal:  65%|██████▍   | 120747/187062 [00:02<00:01, 60833.22it/s]
Adding feature literal:  68%|██████▊   | 126841/187062 [00:02<00:00, 60863.74it/s]
Adding feature literal:  71%|███████   | 132957/187062 [00:02<00:00, 60949.65it/s]
Adding feature literal:  74%|███████▍  | 139056/187062 [00:02<00:00, 60920.97it/s]
Adding feature literal:  78%|███████▊  | 145163/187062 [00:02<00:00, 60963.42it/s]
Adding feature literal:  81%|████████  | 151273/187062 [00:03<00:00, 61001.68it/s]
Adding feature literal:  84%|████████▍ | 157375/187062 [00:03<00:00, 60937.23it/s]
Adding feature literal:  87%|████████▋ | 163473/187062 [00:03<00:00, 60948.71it/s]
Adding feature literal:  91%|█████████ | 169572/187062 [00:03<00:00, 60958.58it/s]
Adding feature literal:  94%|█████████▍| 175669/187062 [00:03<00:00, 60506.81it/s]
Adding feature literal:  97%|█████████▋| 181721/187062 [00:03<00:00, 44119.40it/s]
Adding feature literal: 100%|█████████▉| 186766/187062 [00:03<00:00, 36537.45it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 47696.04it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<30:09:38,  1.72it/s]
Adding feature operator:   3%|▎         | 5191/187062 [00:00<00:17, 10251.85it/s]
Adding feature operator:   6%|▌         | 11250/187062 [00:00<00:08, 21328.41it/s]
Adding feature operator:   9%|▉         | 17324/187062 [00:00<00:05, 30753.43it/s]
Adding feature operator:  13%|█▎        | 23431/187062 [00:00<00:04, 38471.84it/s]
Adding feature operator:  16%|█▌        | 29522/187062 [00:01<00:03, 44456.03it/s]
Adding feature operator:  19%|█▉        | 35650/187062 [00:01<00:03, 49097.08it/s]
Adding feature operator:  22%|██▏       | 41783/187062 [00:01<00:02, 52553.03it/s]
Adding feature operator:  26%|██▌       | 47917/187062 [00:01<00:02, 55078.32it/s]
Adding feature operator:  29%|██▉       | 54028/187062 [00:01<00:02, 56834.33it/s]
Adding feature operator:  32%|███▏      | 60139/187062 [00:01<00:02, 58088.41it/s]
Adding feature operator:  35%|███▌      | 66190/187062 [00:01<00:02, 58090.66it/s]
Adding feature operator:  39%|███▊      | 72302/187062 [00:01<00:01, 58979.47it/s]
Adding feature operator:  42%|████▏     | 78425/187062 [00:01<00:01, 59643.97it/s]
Adding feature operator:  45%|████▌     | 84544/187062 [00:01<00:01, 60100.98it/s]
Adding feature operator:  48%|████▊     | 90639/187062 [00:02<00:01, 60344.34it/s]
Adding feature operator:  52%|█████▏    | 96762/187062 [00:02<00:01, 60608.33it/s]
Adding feature operator:  55%|█████▍    | 102882/187062 [00:02<00:01, 60784.66it/s]
Adding feature operator:  58%|█████▊    | 109023/187062 [00:02<00:01, 60970.06it/s]
Adding feature operator:  62%|██████▏   | 115150/187062 [00:02<00:01, 61058.82it/s]
Adding feature operator:  65%|██████▍   | 121278/187062 [00:02<00:01, 61123.06it/s]
Adding feature operator:  68%|██████▊   | 127398/187062 [00:02<00:00, 61084.11it/s]
Adding feature operator:  71%|███████▏  | 133519/187062 [00:02<00:00, 61120.05it/s]
Adding feature operator:  75%|███████▍  | 139641/187062 [00:02<00:00, 61147.76it/s]
Adding feature operator:  78%|███████▊  | 145761/187062 [00:02<00:00, 61159.68it/s]
Adding feature operator:  81%|████████  | 151879/187062 [00:03<00:00, 60252.96it/s]
Adding feature operator:  84%|████████▍ | 158000/187062 [00:03<00:00, 60535.65it/s]
Adding feature operator:  88%|████████▊ | 164098/187062 [00:03<00:00, 60666.19it/s]
Adding feature operator:  91%|█████████ | 170209/187062 [00:03<00:00, 60797.46it/s]
Adding feature operator:  94%|█████████▍| 176307/187062 [00:03<00:00, 60848.78it/s]
Adding feature operator:  98%|█████████▊| 182394/187062 [00:03<00:00, 42403.95it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 47707.12it/s]
[2024-10-12 22:36:41,861] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 22:36:43 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 22:36:43 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   0%|          | 32/6548 [00:00<00:21, 307.05 examples/s]
Map:   1%|          | 80/6548 [00:00<00:39, 164.15 examples/s]
Map:   2%|▏         | 114/6548 [00:00<00:31, 206.55 examples/s]
Map:   2%|▏         | 148/6548 [00:00<00:26, 237.31 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:26, 244.00 examples/s]
Map:   3%|▎         | 214/6548 [00:00<00:22, 275.55 examples/s]
Map:   4%|▍         | 247/6548 [00:00<00:22, 283.97 examples/s]
Map:   4%|▍         | 280/6548 [00:01<00:22, 278.86 examples/s]
Map:   5%|▍         | 323/6548 [00:01<00:26, 233.16 examples/s]
Map:   6%|▌         | 362/6548 [00:01<00:26, 233.62 examples/s]
Map:   6%|▌         | 395/6548 [00:01<00:24, 253.08 examples/s]
Map:   7%|▋         | 431/6548 [00:01<00:22, 274.30 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:25, 236.76 examples/s]
Map:   8%|▊         | 517/6548 [00:02<00:23, 252.03 examples/s]
Map:   8%|▊         | 555/6548 [00:02<00:21, 278.07 examples/s]
Map:   9%|▉         | 602/6548 [00:02<00:20, 287.73 examples/s]
Map:  10%|▉         | 642/6548 [00:02<00:24, 243.48 examples/s]
Map:  10%|█         | 677/6548 [00:02<00:22, 260.37 examples/s]
Map:  11%|█         | 710/6548 [00:02<00:21, 270.82 examples/s]
Map:  11%|█▏        | 743/6548 [00:02<00:20, 282.19 examples/s]
Map:  12%|█▏        | 785/6548 [00:03<00:18, 311.41 examples/s]
Map:  13%|█▎        | 821/6548 [00:03<00:17, 322.03 examples/s]
Map:  13%|█▎        | 866/6548 [00:03<00:18, 305.82 examples/s]
Map:  14%|█▍        | 908/6548 [00:03<00:19, 290.66 examples/s]
Map:  15%|█▍        | 956/6548 [00:03<00:19, 287.14 examples/s]
Map:  15%|█▌        | 993/6548 [00:03<00:21, 262.82 examples/s]
Map:  16%|█▌        | 1027/6548 [00:04<00:36, 150.38 examples/s]
Map:  16%|█▌        | 1050/6548 [00:04<00:34, 161.12 examples/s]
Map:  16%|█▋        | 1073/6548 [00:04<00:31, 172.31 examples/s]
Map:  17%|█▋        | 1096/6548 [00:04<00:29, 182.15 examples/s]
Map:  17%|█▋        | 1121/6548 [00:04<00:27, 195.93 examples/s]
Map:  18%|█▊        | 1146/6548 [00:04<00:26, 205.62 examples/s]
Map:  18%|█▊        | 1169/6548 [00:04<00:26, 203.41 examples/s]
Map:  18%|█▊        | 1202/6548 [00:05<00:26, 205.29 examples/s]
Map:  19%|█▉        | 1233/6548 [00:05<00:26, 200.90 examples/s]
Map:  19%|█▉        | 1256/6548 [00:05<00:25, 205.87 examples/s]
Map:  20%|█▉        | 1285/6548 [00:05<00:23, 224.54 examples/s]
Map:  20%|██        | 1322/6548 [00:05<00:23, 224.47 examples/s]
Map:  21%|██        | 1350/6548 [00:05<00:23, 225.21 examples/s]
Map:  21%|██        | 1379/6548 [00:05<00:25, 205.80 examples/s]
Map:  21%|██▏       | 1407/6548 [00:06<00:23, 217.46 examples/s]
Map:  22%|██▏       | 1436/6548 [00:06<00:25, 203.21 examples/s]
Map:  22%|██▏       | 1461/6548 [00:06<00:24, 203.96 examples/s]
Map:  23%|██▎       | 1489/6548 [00:06<00:24, 205.62 examples/s]
Map:  23%|██▎       | 1523/6548 [00:06<00:21, 232.26 examples/s]
Map:  24%|██▍       | 1556/6548 [00:06<00:23, 211.78 examples/s]
Map:  24%|██▍       | 1589/6548 [00:06<00:20, 236.76 examples/s]
Map:  25%|██▍       | 1621/6548 [00:07<00:24, 198.44 examples/s]
Map:  25%|██▌       | 1647/6548 [00:07<00:24, 198.80 examples/s]
Map:  26%|██▌       | 1684/6548 [00:07<00:23, 205.64 examples/s]
Map:  26%|██▌       | 1714/6548 [00:07<00:21, 222.28 examples/s]
Map:  27%|██▋       | 1742/6548 [00:07<00:20, 233.75 examples/s]
Map:  27%|██▋       | 1781/6548 [00:07<00:18, 264.28 examples/s]
Map:  28%|██▊       | 1811/6548 [00:07<00:18, 259.10 examples/s]
Map:  28%|██▊       | 1845/6548 [00:07<00:17, 276.42 examples/s]
Map:  29%|██▊       | 1877/6548 [00:08<00:18, 249.00 examples/s]
Map:  29%|██▉       | 1906/6548 [00:08<00:18, 255.24 examples/s]
Map:  30%|██▉       | 1935/6548 [00:08<00:17, 260.59 examples/s]
Map:  30%|███       | 1966/6548 [00:08<00:16, 272.81 examples/s]
Map:  30%|███       | 1997/6548 [00:08<00:16, 280.35 examples/s]
Map:  31%|███       | 2033/6548 [00:09<00:33, 132.80 examples/s]
Map:  32%|███▏      | 2063/6548 [00:09<00:28, 156.52 examples/s]
Map:  32%|███▏      | 2098/6548 [00:09<00:23, 185.50 examples/s]
Map:  32%|███▏      | 2127/6548 [00:09<00:24, 180.92 examples/s]
Map:  33%|███▎      | 2156/6548 [00:09<00:24, 176.68 examples/s]
Map:  33%|███▎      | 2189/6548 [00:09<00:21, 206.20 examples/s]
Map:  34%|███▍      | 2229/6548 [00:09<00:20, 207.45 examples/s]
Map:  35%|███▍      | 2266/6548 [00:10<00:19, 214.45 examples/s]
Map:  35%|███▌      | 2300/6548 [00:10<00:20, 211.92 examples/s]
Map:  36%|███▌      | 2335/6548 [00:10<00:18, 233.61 examples/s]
Map:  36%|███▌      | 2369/6548 [00:10<00:18, 224.94 examples/s]
Map:  37%|███▋      | 2406/6548 [00:10<00:16, 250.10 examples/s]
Map:  37%|███▋      | 2437/6548 [00:10<00:15, 260.43 examples/s]
Map:  38%|███▊      | 2467/6548 [00:10<00:17, 235.23 examples/s]
Map:  38%|███▊      | 2495/6548 [00:10<00:17, 237.25 examples/s]
Map:  39%|███▉      | 2539/6548 [00:11<00:15, 253.71 examples/s]
Map:  39%|███▉      | 2580/6548 [00:11<00:13, 288.57 examples/s]
Map:  40%|████      | 2627/6548 [00:11<00:13, 294.02 examples/s]
Map:  41%|████      | 2658/6548 [00:11<00:14, 264.79 examples/s]
Map:  41%|████      | 2686/6548 [00:11<00:14, 268.12 examples/s]
Map:  41%|████▏     | 2716/6548 [00:11<00:14, 259.07 examples/s]
Map:  42%|████▏     | 2748/6548 [00:11<00:14, 271.12 examples/s]
Map:  42%|████▏     | 2776/6548 [00:11<00:14, 267.58 examples/s]
Map:  43%|████▎     | 2811/6548 [00:12<00:15, 248.18 examples/s]
Map:  43%|████▎     | 2840/6548 [00:12<00:18, 200.83 examples/s]
Map:  44%|████▍     | 2866/6548 [00:12<00:17, 212.17 examples/s]
Map:  44%|████▍     | 2897/6548 [00:12<00:15, 231.29 examples/s]
Map:  45%|████▍     | 2939/6548 [00:12<00:16, 214.41 examples/s]
Map:  45%|████▌     | 2968/6548 [00:12<00:15, 224.39 examples/s]
Map:  46%|████▌     | 2994/6548 [00:13<00:21, 162.95 examples/s]
Map:  46%|████▌     | 3019/6548 [00:13<00:37, 95.14 examples/s] 
Map:  47%|████▋     | 3047/6548 [00:13<00:29, 117.99 examples/s]
Map:  47%|████▋     | 3069/6548 [00:13<00:26, 131.97 examples/s]
Map:  47%|████▋     | 3091/6548 [00:14<00:24, 142.81 examples/s]
Map:  48%|████▊     | 3123/6548 [00:14<00:19, 175.20 examples/s]
Map:  48%|████▊     | 3149/6548 [00:14<00:20, 164.25 examples/s]
Map:  49%|████▊     | 3182/6548 [00:14<00:17, 190.27 examples/s]
Map:  49%|████▉     | 3213/6548 [00:14<00:18, 176.18 examples/s]
Map:  49%|████▉     | 3240/6548 [00:14<00:17, 190.47 examples/s]
Map:  50%|████▉     | 3266/6548 [00:14<00:16, 204.57 examples/s]
Map:  50%|█████     | 3295/6548 [00:15<00:17, 190.03 examples/s]
Map:  51%|█████     | 3332/6548 [00:15<00:14, 229.53 examples/s]
Map:  51%|█████▏    | 3358/6548 [00:15<00:13, 234.30 examples/s]
Map:  52%|█████▏    | 3389/6548 [00:15<00:14, 211.47 examples/s]
Map:  52%|█████▏    | 3412/6548 [00:15<00:14, 214.71 examples/s]
Map:  53%|█████▎    | 3438/6548 [00:15<00:13, 224.51 examples/s]
Map:  53%|█████▎    | 3470/6548 [00:15<00:15, 198.03 examples/s]
Map:  53%|█████▎    | 3500/6548 [00:15<00:13, 220.43 examples/s]
Map:  54%|█████▍    | 3537/6548 [00:16<00:11, 255.24 examples/s]
Map:  55%|█████▍    | 3571/6548 [00:16<00:10, 274.51 examples/s]
Map:  55%|█████▌    | 3606/6548 [00:16<00:10, 291.34 examples/s]
Map:  56%|█████▌    | 3639/6548 [00:16<00:10, 289.65 examples/s]
Map:  56%|█████▌    | 3670/6548 [00:16<00:09, 294.35 examples/s]
Map:  57%|█████▋    | 3716/6548 [00:16<00:08, 336.53 examples/s]
Map:  57%|█████▋    | 3752/6548 [00:16<00:08, 316.93 examples/s]
Map:  58%|█████▊    | 3789/6548 [00:16<00:08, 327.71 examples/s]
Map:  59%|█████▊    | 3835/6548 [00:17<00:08, 303.14 examples/s]
Map:  59%|█████▉    | 3883/6548 [00:17<00:09, 275.46 examples/s]
Map:  60%|█████▉    | 3917/6548 [00:17<00:09, 284.87 examples/s]
Map:  60%|██████    | 3955/6548 [00:17<00:09, 273.23 examples/s]
Map:  61%|██████    | 3995/6548 [00:17<00:08, 295.46 examples/s]
Map:  62%|██████▏   | 4044/6548 [00:18<00:14, 176.45 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:18<00:12, 199.05 examples/s]
Map:  63%|██████▎   | 4108/6548 [00:18<00:11, 215.86 examples/s]
Map:  63%|██████▎   | 4145/6548 [00:18<00:11, 208.88 examples/s]
Map:  64%|██████▍   | 4185/6548 [00:18<00:10, 215.30 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:18<00:10, 215.20 examples/s]
Map:  65%|██████▍   | 4241/6548 [00:18<00:09, 234.17 examples/s]
Map:  65%|██████▌   | 4274/6548 [00:18<00:08, 254.14 examples/s]
Map:  66%|██████▌   | 4321/6548 [00:19<00:08, 266.28 examples/s]
Map:  67%|██████▋   | 4362/6548 [00:19<00:08, 256.13 examples/s]
Map:  67%|██████▋   | 4401/6548 [00:19<00:08, 251.02 examples/s]
Map:  68%|██████▊   | 4435/6548 [00:19<00:07, 269.22 examples/s]
Map:  68%|██████▊   | 4465/6548 [00:19<00:08, 244.22 examples/s]
Map:  69%|██████▊   | 4495/6548 [00:19<00:08, 245.76 examples/s]
Map:  69%|██████▉   | 4530/6548 [00:20<00:08, 230.13 examples/s]
Map:  70%|██████▉   | 4568/6548 [00:20<00:07, 249.49 examples/s]
Map:  70%|███████   | 4603/6548 [00:20<00:08, 240.36 examples/s]
Map:  71%|███████   | 4638/6548 [00:20<00:07, 263.40 examples/s]
Map:  71%|███████▏  | 4668/6548 [00:20<00:07, 268.06 examples/s]
Map:  72%|███████▏  | 4710/6548 [00:20<00:06, 269.78 examples/s]
Map:  72%|███████▏  | 4745/6548 [00:20<00:06, 265.31 examples/s]
Map:  73%|███████▎  | 4793/6548 [00:20<00:05, 315.66 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:21<00:05, 294.76 examples/s]
Map:  74%|███████▍  | 4874/6548 [00:21<00:06, 272.70 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:21<00:06, 268.72 examples/s]
Map:  75%|███████▌  | 4943/6548 [00:21<00:05, 296.86 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:21<00:05, 303.16 examples/s]
Map:  77%|███████▋  | 5026/6548 [00:22<00:09, 155.24 examples/s]
Map:  77%|███████▋  | 5055/6548 [00:22<00:08, 171.84 examples/s]
Map:  78%|███████▊  | 5086/6548 [00:22<00:08, 178.51 examples/s]
Map:  78%|███████▊  | 5111/6548 [00:22<00:07, 190.30 examples/s]
Map:  79%|███████▊  | 5142/6548 [00:22<00:07, 191.75 examples/s]
Map:  79%|███████▉  | 5174/6548 [00:22<00:06, 211.72 examples/s]
Map:  79%|███████▉  | 5202/6548 [00:22<00:06, 220.45 examples/s]
Map:  80%|███████▉  | 5231/6548 [00:23<00:05, 235.43 examples/s]
Map:  81%|████████  | 5283/6548 [00:23<00:04, 260.88 examples/s]
Map:  81%|████████  | 5320/6548 [00:23<00:04, 280.97 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:23<00:04, 268.50 examples/s]
Map:  82%|████████▏ | 5392/6548 [00:23<00:04, 268.05 examples/s]
Map:  83%|████████▎ | 5422/6548 [00:23<00:04, 266.77 examples/s]
Map:  83%|████████▎ | 5461/6548 [00:23<00:03, 292.94 examples/s]
Map:  84%|████████▍ | 5495/6548 [00:23<00:03, 303.99 examples/s]
Map:  85%|████████▍ | 5542/6548 [00:24<00:03, 297.84 examples/s]
Map:  85%|████████▌ | 5577/6548 [00:24<00:03, 267.16 examples/s]
Map:  86%|████████▌ | 5632/6548 [00:24<00:03, 290.42 examples/s]
Map:  86%|████████▋ | 5664/6548 [00:24<00:03, 273.22 examples/s]
Map:  87%|████████▋ | 5692/6548 [00:24<00:03, 261.20 examples/s]
Map:  88%|████████▊ | 5731/6548 [00:24<00:02, 280.31 examples/s]
Map:  88%|████████▊ | 5772/6548 [00:24<00:02, 309.12 examples/s]
Map:  89%|████████▊ | 5808/6548 [00:24<00:02, 316.93 examples/s]
Map:  89%|████████▉ | 5843/6548 [00:25<00:02, 321.54 examples/s]
Map:  90%|████████▉ | 5879/6548 [00:25<00:02, 328.37 examples/s]
Map:  90%|█████████ | 5922/6548 [00:25<00:02, 308.11 examples/s]
Map:  91%|█████████ | 5964/6548 [00:25<00:01, 293.16 examples/s]
Map:  92%|█████████▏| 5998/6548 [00:25<00:01, 301.31 examples/s]
Map:  92%|█████████▏| 6039/6548 [00:25<00:02, 204.77 examples/s]
Map:  93%|█████████▎| 6073/6548 [00:26<00:02, 215.24 examples/s]
Map:  93%|█████████▎| 6108/6548 [00:26<00:02, 210.08 examples/s]
Map:  94%|█████████▍| 6141/6548 [00:26<00:01, 228.18 examples/s]
Map:  94%|█████████▍| 6174/6548 [00:26<00:01, 245.34 examples/s]
Map:  95%|█████████▍| 6211/6548 [00:26<00:01, 273.05 examples/s]
Map:  96%|█████████▌| 6256/6548 [00:26<00:01, 279.88 examples/s]
Map:  96%|█████████▌| 6292/6548 [00:26<00:00, 296.90 examples/s]
Map:  97%|█████████▋| 6331/6548 [00:26<00:00, 306.60 examples/s]
Map:  97%|█████████▋| 6367/6548 [00:27<00:00, 297.68 examples/s]
Map:  98%|█████████▊| 6409/6548 [00:27<00:00, 327.07 examples/s]
Map:  99%|█████████▊| 6454/6548 [00:27<00:00, 357.53 examples/s]
Map:  99%|█████████▉| 6495/6548 [00:27<00:00, 360.44 examples/s]
Map: 100%|█████████▉| 6547/6548 [00:27<00:00, 352.99 examples/s]
Map: 100%|██████████| 6548/6548 [00:27<00:00, 236.52 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 328.73 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 349.85 examples/s]
Map:  13%|█▎        | 116/903 [00:00<00:02, 346.84 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 361.79 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 410.60 examples/s]
Map:  29%|██▊       | 258/903 [00:00<00:01, 368.82 examples/s]
Map:  34%|███▍      | 306/903 [00:00<00:01, 342.48 examples/s]
Map:  39%|███▉      | 350/903 [00:01<00:01, 324.14 examples/s]
Map:  43%|████▎     | 386/903 [00:01<00:01, 259.95 examples/s]
Map:  47%|████▋     | 423/903 [00:01<00:01, 248.07 examples/s]
Map:  50%|████▉     | 450/903 [00:01<00:01, 232.12 examples/s]
Map:  53%|█████▎    | 478/903 [00:01<00:01, 239.59 examples/s]
Map:  58%|█████▊    | 521/903 [00:01<00:01, 249.15 examples/s]
Map:  61%|██████▏   | 554/903 [00:01<00:01, 265.67 examples/s]
Map:  65%|██████▌   | 588/903 [00:02<00:01, 281.59 examples/s]
Map:  70%|██████▉   | 632/903 [00:02<00:00, 283.00 examples/s]
Map:  73%|███████▎  | 661/903 [00:02<00:00, 282.57 examples/s]
Map:  77%|███████▋  | 692/903 [00:02<00:00, 288.64 examples/s]
Map:  80%|████████  | 724/903 [00:02<00:00, 290.54 examples/s]
Map:  85%|████████▍ | 766/903 [00:02<00:00, 299.62 examples/s]
Map:  89%|████████▉ | 807/903 [00:02<00:00, 285.23 examples/s]
Map:  93%|█████████▎| 844/903 [00:02<00:00, 293.96 examples/s]
Map:  97%|█████████▋| 875/903 [00:03<00:00, 283.83 examples/s]
Map: 100%|██████████| 903/903 [00:03<00:00, 266.26 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 34/1882 [00:00<00:06, 264.40 examples/s]
Map:   4%|▎         | 67/1882 [00:00<00:06, 283.76 examples/s]
Map:   6%|▌         | 110/1882 [00:00<00:06, 271.04 examples/s]
Map:   7%|▋         | 140/1882 [00:00<00:06, 259.37 examples/s]
Map:  10%|▉         | 179/1882 [00:00<00:05, 296.21 examples/s]
Map:  11%|█         | 211/1882 [00:00<00:05, 302.77 examples/s]
Map:  14%|█▎        | 257/1882 [00:00<00:04, 346.36 examples/s]
Map:  16%|█▌        | 301/1882 [00:01<00:05, 306.94 examples/s]
Map:  18%|█▊        | 338/1882 [00:01<00:04, 320.80 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:05, 266.80 examples/s]
Map:  22%|██▏       | 405/1882 [00:01<00:06, 240.80 examples/s]
Map:  23%|██▎       | 433/1882 [00:01<00:05, 242.89 examples/s]
Map:  24%|██▍       | 461/1882 [00:01<00:05, 237.27 examples/s]
Map:  27%|██▋       | 500/1882 [00:01<00:05, 272.73 examples/s]
Map:  28%|██▊       | 532/1882 [00:01<00:05, 267.22 examples/s]
Map:  30%|██▉       | 563/1882 [00:02<00:04, 277.63 examples/s]
Map:  32%|███▏      | 598/1882 [00:02<00:04, 292.52 examples/s]
Map:  34%|███▍      | 643/1882 [00:02<00:03, 330.53 examples/s]
Map:  36%|███▋      | 683/1882 [00:02<00:04, 294.81 examples/s]
Map:  39%|███▉      | 730/1882 [00:02<00:03, 297.93 examples/s]
Map:  41%|████      | 764/1882 [00:02<00:03, 301.22 examples/s]
Map:  43%|████▎     | 807/1882 [00:02<00:03, 269.86 examples/s]
Map:  45%|████▌     | 848/1882 [00:02<00:03, 289.76 examples/s]
Map:  47%|████▋     | 891/1882 [00:03<00:03, 318.03 examples/s]
Map:  50%|████▉     | 932/1882 [00:03<00:03, 300.33 examples/s]
Map:  52%|█████▏    | 972/1882 [00:03<00:02, 321.83 examples/s]
Map:  54%|█████▍    | 1014/1882 [00:03<00:04, 189.44 examples/s]
Map:  56%|█████▌    | 1053/1882 [00:03<00:03, 207.84 examples/s]
Map:  58%|█████▊    | 1084/1882 [00:04<00:03, 222.63 examples/s]
Map:  59%|█████▉    | 1116/1882 [00:04<00:03, 213.85 examples/s]
Map:  61%|██████    | 1149/1882 [00:04<00:03, 233.72 examples/s]
Map:  63%|██████▎   | 1180/1882 [00:04<00:02, 248.07 examples/s]
Map:  65%|██████▌   | 1224/1882 [00:04<00:02, 256.08 examples/s]
Map:  67%|██████▋   | 1256/1882 [00:04<00:02, 255.53 examples/s]
Map:  69%|██████▉   | 1303/1882 [00:04<00:01, 304.01 examples/s]
Map:  71%|███████   | 1337/1882 [00:04<00:01, 309.36 examples/s]
Map:  73%|███████▎  | 1374/1882 [00:05<00:01, 281.98 examples/s]
Map:  75%|███████▍  | 1405/1882 [00:05<00:01, 281.93 examples/s]
Map:  77%|███████▋  | 1445/1882 [00:05<00:01, 234.73 examples/s]
Map:  78%|███████▊  | 1475/1882 [00:05<00:01, 220.42 examples/s]
Map:  80%|████████  | 1507/1882 [00:05<00:01, 210.78 examples/s]
Map:  81%|████████▏ | 1533/1882 [00:05<00:01, 219.70 examples/s]
Map:  84%|████████▍ | 1582/1882 [00:05<00:01, 247.12 examples/s]
Map:  86%|████████▌ | 1622/1882 [00:06<00:00, 276.62 examples/s]
Map:  88%|████████▊ | 1651/1882 [00:06<00:00, 261.05 examples/s]
Map:  90%|████████▉ | 1692/1882 [00:06<00:00, 279.71 examples/s]
Map:  92%|█████████▏| 1723/1882 [00:06<00:00, 281.80 examples/s]
Map:  93%|█████████▎| 1757/1882 [00:06<00:00, 234.83 examples/s]
Map:  95%|█████████▍| 1784/1882 [00:06<00:00, 238.07 examples/s]
Map:  96%|█████████▋| 1816/1882 [00:06<00:00, 256.94 examples/s]
Map:  99%|█████████▊| 1856/1882 [00:06<00:00, 291.52 examples/s]
Map: 100%|██████████| 1882/1882 [00:07<00:00, 259.28 examples/s]
10/12/2024 22:38:08 - INFO - __main__ -     ***** Testing *****
10/12/2024 22:38:08 - INFO - __main__ -     Batch size = 8
10/12/2024 22:38:08 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 22:38:09 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 22:38:09 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 22:38:11 - INFO - knnlm -   Reading datastore took 1.4445366859436035 s
10/12/2024 22:38:15 - INFO - knnlm -   Moving index to GPU took 3.616356372833252 s
10/12/2024 22:38:15 - INFO - __main__ -   ******************************break-into
10/12/2024 22:38:15 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 22:38:15 - INFO - __main__ -     Num examples = 236
10/12/2024 22:38:15 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:10<40:07, 10.25s/it]
test ppl:   1%|          | 2/236 [00:12<22:23,  5.74s/it]
test ppl:   1%|▏         | 3/236 [00:14<15:44,  4.05s/it]
test ppl:   2%|▏         | 4/236 [00:22<21:36,  5.59s/it]
test ppl:   2%|▏         | 5/236 [00:30<24:56,  6.48s/it]
test ppl:   3%|▎         | 6/236 [00:38<26:53,  7.01s/it]
test ppl:   3%|▎         | 7/236 [00:41<21:17,  5.58s/it]
test ppl:   3%|▎         | 8/236 [00:49<23:28,  6.18s/it]
test ppl:   4%|▍         | 9/236 [00:57<25:48,  6.82s/it]
test ppl:   4%|▍         | 10/236 [01:05<26:48,  7.12s/it]
test ppl:   5%|▍         | 11/236 [01:08<22:55,  6.11s/it]
test ppl:   5%|▌         | 12/236 [01:17<25:16,  6.77s/it]
test ppl:   6%|▌         | 13/236 [01:24<26:08,  7.03s/it]
test ppl:   6%|▌         | 14/236 [01:27<21:37,  5.84s/it]
test ppl:   6%|▋         | 15/236 [01:30<18:17,  4.97s/it]
test ppl:   7%|▋         | 16/236 [01:33<15:27,  4.22s/it]
test ppl:   7%|▋         | 17/236 [01:42<20:59,  5.75s/it]
test ppl:   8%|▊         | 18/236 [01:44<17:02,  4.69s/it]
test ppl:   8%|▊         | 19/236 [01:50<18:18,  5.06s/it]
test ppl:   8%|▊         | 20/236 [01:53<15:16,  4.24s/it]
test ppl:   9%|▉         | 21/236 [01:56<14:01,  3.91s/it]
test ppl:   9%|▉         | 22/236 [02:03<18:03,  5.06s/it]
test ppl:  10%|▉         | 23/236 [02:07<16:08,  4.55s/it]
test ppl:  10%|█         | 24/236 [02:10<14:33,  4.12s/it]
test ppl:  11%|█         | 25/236 [02:18<18:19,  5.21s/it]
test ppl:  11%|█         | 26/236 [02:25<20:51,  5.96s/it]
test ppl:  11%|█▏        | 27/236 [02:31<20:40,  5.93s/it]
test ppl:  12%|█▏        | 28/236 [02:33<16:04,  4.64s/it]
test ppl:  12%|█▏        | 29/236 [02:36<14:27,  4.19s/it]
test ppl:  13%|█▎        | 30/236 [02:38<12:11,  3.55s/it]
test ppl:  13%|█▎        | 31/236 [02:41<11:32,  3.38s/it]
test ppl:  14%|█▎        | 32/236 [02:45<11:34,  3.41s/it]
test ppl:  14%|█▍        | 33/236 [02:48<11:58,  3.54s/it]
test ppl:  14%|█▍        | 34/236 [02:54<14:14,  4.23s/it]
test ppl:  15%|█▍        | 35/236 [02:59<14:56,  4.46s/it]
test ppl:  15%|█▌        | 36/236 [03:08<19:01,  5.71s/it]
test ppl:  16%|█▌        | 37/236 [03:16<21:46,  6.57s/it]
test ppl:  16%|█▌        | 38/236 [03:19<18:07,  5.49s/it]
test ppl:  17%|█▋        | 39/236 [03:21<14:33,  4.44s/it]
test ppl:  17%|█▋        | 40/236 [03:24<13:07,  4.02s/it]
test ppl:  17%|█▋        | 41/236 [03:27<11:33,  3.56s/it]
test ppl:  18%|█▊        | 42/236 [03:35<15:51,  4.91s/it]
test ppl:  18%|█▊        | 43/236 [03:44<19:26,  6.04s/it]
test ppl:  19%|█▊        | 44/236 [03:46<16:10,  5.06s/it]
test ppl:  19%|█▉        | 45/236 [03:50<14:17,  4.49s/it]
test ppl:  19%|█▉        | 46/236 [03:58<17:33,  5.54s/it]
test ppl:  20%|█▉        | 47/236 [04:00<14:32,  4.61s/it]
test ppl:  20%|██        | 48/236 [04:09<18:16,  5.83s/it]
test ppl:  21%|██        | 49/236 [04:14<17:55,  5.75s/it]
test ppl:  21%|██        | 50/236 [04:22<19:40,  6.35s/it]
test ppl:  22%|██▏       | 51/236 [04:28<19:37,  6.36s/it]
test ppl:  22%|██▏       | 52/236 [04:34<19:01,  6.21s/it]
test ppl:  22%|██▏       | 53/236 [04:39<17:38,  5.78s/it]
test ppl:  23%|██▎       | 54/236 [04:41<13:40,  4.51s/it]
test ppl:  23%|██▎       | 55/236 [04:46<14:39,  4.86s/it]
test ppl:  24%|██▎       | 56/236 [04:50<13:16,  4.42s/it]
test ppl:  24%|██▍       | 57/236 [04:52<11:17,  3.79s/it]
test ppl:  25%|██▍       | 58/236 [04:54<09:47,  3.30s/it]
test ppl:  25%|██▌       | 59/236 [05:00<11:59,  4.07s/it]
test ppl:  25%|██▌       | 60/236 [05:03<10:59,  3.75s/it]
test ppl:  26%|██▌       | 61/236 [05:09<12:45,  4.38s/it]
test ppl:  26%|██▋       | 62/236 [05:13<12:27,  4.30s/it]
test ppl:  27%|██▋       | 63/236 [05:15<10:48,  3.75s/it]
test ppl:  27%|██▋       | 64/236 [05:17<09:09,  3.20s/it]
test ppl:  28%|██▊       | 65/236 [05:19<07:32,  2.65s/it]
test ppl:  28%|██▊       | 66/236 [05:22<07:48,  2.76s/it]
test ppl:  28%|██▊       | 67/236 [05:28<10:27,  3.71s/it]
test ppl:  29%|██▉       | 68/236 [05:33<12:11,  4.35s/it]
test ppl:  29%|██▉       | 69/236 [05:39<13:23,  4.81s/it]
test ppl:  30%|██▉       | 70/236 [05:41<10:39,  3.85s/it]
test ppl:  30%|███       | 71/236 [05:45<10:21,  3.77s/it]
test ppl:  31%|███       | 72/236 [05:48<10:19,  3.78s/it]
test ppl:  31%|███       | 73/236 [05:52<10:24,  3.83s/it]
test ppl:  31%|███▏      | 74/236 [05:54<08:28,  3.14s/it]
test ppl:  32%|███▏      | 75/236 [06:00<10:36,  3.95s/it]
test ppl:  32%|███▏      | 76/236 [06:03<10:11,  3.82s/it]
test ppl:  33%|███▎      | 77/236 [06:05<08:53,  3.35s/it]
test ppl:  33%|███▎      | 78/236 [06:07<07:41,  2.92s/it]
test ppl:  33%|███▎      | 79/236 [06:11<08:24,  3.21s/it]
test ppl:  34%|███▍      | 80/236 [06:13<07:19,  2.82s/it]
test ppl:  34%|███▍      | 81/236 [06:19<09:36,  3.72s/it]
test ppl:  35%|███▍      | 82/236 [06:25<11:12,  4.37s/it]
test ppl:  35%|███▌      | 83/236 [06:27<09:19,  3.66s/it]
test ppl:  36%|███▌      | 84/236 [06:29<07:54,  3.12s/it]
test ppl:  36%|███▌      | 85/236 [06:33<08:35,  3.42s/it]
test ppl:  36%|███▋      | 86/236 [06:35<07:24,  2.97s/it]
test ppl:  37%|███▋      | 87/236 [06:37<06:42,  2.70s/it]
test ppl:  37%|███▋      | 88/236 [06:43<08:59,  3.64s/it]
test ppl:  38%|███▊      | 89/236 [06:48<10:31,  4.30s/it]
test ppl:  38%|███▊      | 90/236 [06:54<11:34,  4.76s/it]
test ppl:  39%|███▊      | 91/236 [06:59<11:36,  4.80s/it]
test ppl:  39%|███▉      | 92/236 [07:02<10:04,  4.20s/it]
test ppl:  39%|███▉      | 93/236 [07:08<11:10,  4.69s/it]
test ppl:  40%|███▉      | 94/236 [07:14<11:54,  5.03s/it]
test ppl:  40%|████      | 95/236 [07:17<10:16,  4.37s/it]
test ppl:  41%|████      | 96/236 [07:19<09:10,  3.94s/it]
test ppl:  41%|████      | 97/236 [07:25<10:26,  4.50s/it]
test ppl:  42%|████▏     | 98/236 [07:31<11:17,  4.91s/it]
test ppl:  42%|████▏     | 99/236 [07:37<11:50,  5.19s/it]
test ppl:  42%|████▏     | 100/236 [07:38<09:07,  4.03s/it]
test ppl:  43%|████▎     | 101/236 [07:44<10:05,  4.49s/it]
test ppl:  43%|████▎     | 102/236 [07:47<09:25,  4.22s/it]
test ppl:  44%|████▎     | 103/236 [07:49<07:42,  3.47s/it]
test ppl:  44%|████▍     | 104/236 [07:53<08:08,  3.70s/it]
test ppl:  44%|████▍     | 105/236 [07:57<08:15,  3.78s/it]
test ppl:  45%|████▍     | 106/236 [08:03<09:13,  4.26s/it]
test ppl:  45%|████▌     | 107/236 [08:05<07:55,  3.69s/it]
test ppl:  46%|████▌     | 108/236 [08:11<09:09,  4.29s/it]
test ppl:  46%|████▌     | 109/236 [08:15<08:53,  4.20s/it]
test ppl:  47%|████▋     | 110/236 [08:17<07:18,  3.48s/it]
test ppl:  47%|████▋     | 111/236 [08:21<07:32,  3.62s/it]
test ppl:  47%|████▋     | 112/236 [08:24<07:19,  3.55s/it]
test ppl:  48%|████▊     | 113/236 [08:26<06:10,  3.01s/it]
test ppl:  48%|████▊     | 114/236 [08:30<07:07,  3.51s/it]
test ppl:  49%|████▊     | 115/236 [08:36<08:28,  4.20s/it]
test ppl:  49%|████▉     | 116/236 [08:42<09:23,  4.69s/it]
test ppl:  50%|████▉     | 117/236 [08:44<07:36,  3.83s/it]
test ppl:  50%|█████     | 118/236 [08:48<07:46,  3.95s/it]
test ppl:  50%|█████     | 119/236 [08:53<08:08,  4.17s/it]
test ppl:  51%|█████     | 120/236 [08:54<06:24,  3.32s/it]
test ppl:  51%|█████▏    | 121/236 [09:00<07:47,  4.07s/it]
test ppl:  52%|█████▏    | 122/236 [09:05<08:07,  4.27s/it]
test ppl:  52%|█████▏    | 123/236 [09:07<06:50,  3.63s/it]
test ppl:  53%|█████▎    | 124/236 [09:10<06:17,  3.37s/it]
test ppl:  53%|█████▎    | 125/236 [09:15<07:35,  4.10s/it]
test ppl:  53%|█████▎    | 126/236 [09:19<07:17,  3.97s/it]
test ppl:  54%|█████▍    | 127/236 [09:21<06:11,  3.40s/it]
test ppl:  54%|█████▍    | 128/236 [09:23<05:30,  3.06s/it]
test ppl:  55%|█████▍    | 129/236 [09:26<05:21,  3.00s/it]
test ppl:  55%|█████▌    | 130/236 [09:29<05:22,  3.04s/it]
test ppl:  56%|█████▌    | 131/236 [09:35<06:47,  3.88s/it]
test ppl:  56%|█████▌    | 132/236 [09:38<05:59,  3.45s/it]
test ppl:  56%|█████▋    | 133/236 [09:41<06:08,  3.58s/it]
test ppl:  57%|█████▋    | 134/236 [09:47<07:05,  4.17s/it]
test ppl:  57%|█████▋    | 135/236 [09:51<07:07,  4.24s/it]
test ppl:  58%|█████▊    | 136/236 [09:53<05:33,  3.34s/it]
test ppl:  58%|█████▊    | 137/236 [09:59<06:45,  4.10s/it]
test ppl:  58%|█████▊    | 138/236 [10:02<06:14,  3.82s/it]
test ppl:  59%|█████▉    | 139/236 [10:04<05:34,  3.45s/it]
test ppl:  59%|█████▉    | 140/236 [10:06<04:40,  2.92s/it]
test ppl:  60%|█████▉    | 141/236 [10:09<04:36,  2.91s/it]
test ppl:  60%|██████    | 142/236 [10:11<04:10,  2.66s/it]
test ppl:  61%|██████    | 143/236 [10:17<05:36,  3.62s/it]
test ppl:  61%|██████    | 144/236 [10:20<05:07,  3.35s/it]
test ppl:  61%|██████▏   | 145/236 [10:25<06:08,  4.05s/it]
test ppl:  62%|██████▏   | 146/236 [10:30<06:16,  4.18s/it]
test ppl:  62%|██████▏   | 147/236 [10:36<06:57,  4.69s/it]
test ppl:  63%|██████▎   | 148/236 [10:42<07:25,  5.06s/it]
test ppl:  63%|██████▎   | 149/236 [10:45<06:35,  4.55s/it]
test ppl:  64%|██████▎   | 150/236 [10:51<07:05,  4.94s/it]
test ppl:  64%|██████▍   | 151/236 [10:57<07:23,  5.22s/it]
test ppl:  64%|██████▍   | 152/236 [11:02<07:33,  5.40s/it]
test ppl:  65%|██████▍   | 153/236 [11:08<07:30,  5.42s/it]
test ppl:  65%|██████▌   | 154/236 [11:10<06:12,  4.55s/it]
test ppl:  66%|██████▌   | 155/236 [11:13<05:20,  3.96s/it]
test ppl:  66%|██████▌   | 156/236 [11:15<04:33,  3.42s/it]
test ppl:  67%|██████▋   | 157/236 [11:17<04:01,  3.06s/it]
test ppl:  67%|██████▋   | 158/236 [11:23<05:03,  3.89s/it]
test ppl:  67%|██████▋   | 159/236 [11:29<05:44,  4.47s/it]
test ppl:  68%|██████▊   | 160/236 [11:30<04:24,  3.48s/it]
test ppl:  68%|██████▊   | 161/236 [11:32<03:33,  2.85s/it]
test ppl:  69%|██████▊   | 162/236 [11:35<03:36,  2.92s/it]
test ppl:  69%|██████▉   | 163/236 [11:37<03:24,  2.81s/it]
test ppl:  69%|██████▉   | 164/236 [11:43<04:28,  3.73s/it]
test ppl:  70%|██████▉   | 165/236 [11:47<04:32,  3.84s/it]
test ppl:  70%|███████   | 166/236 [11:49<03:48,  3.26s/it]
test ppl:  71%|███████   | 167/236 [11:51<03:07,  2.72s/it]
test ppl:  71%|███████   | 168/236 [11:55<03:34,  3.15s/it]
test ppl:  72%|███████▏  | 169/236 [12:00<04:16,  3.82s/it]
test ppl:  72%|███████▏  | 170/236 [12:06<04:53,  4.44s/it]
test ppl:  72%|███████▏  | 171/236 [12:07<03:48,  3.51s/it]
test ppl:  73%|███████▎  | 172/236 [12:13<04:29,  4.21s/it]
test ppl:  73%|███████▎  | 173/236 [12:19<04:56,  4.70s/it]
test ppl:  74%|███████▎  | 174/236 [12:25<05:13,  5.05s/it]
test ppl:  74%|███████▍  | 175/236 [12:27<04:09,  4.08s/it]
test ppl:  75%|███████▍  | 176/236 [12:32<04:24,  4.42s/it]
test ppl:  75%|███████▌  | 177/236 [12:38<04:46,  4.85s/it]
test ppl:  75%|███████▌  | 178/236 [12:44<04:59,  5.17s/it]
test ppl:  76%|███████▌  | 179/236 [12:50<05:06,  5.38s/it]
test ppl:  76%|███████▋  | 180/236 [12:55<05:08,  5.51s/it]
test ppl:  77%|███████▋  | 181/236 [13:01<05:08,  5.61s/it]
test ppl:  77%|███████▋  | 182/236 [13:03<04:02,  4.49s/it]
test ppl:  78%|███████▊  | 183/236 [13:05<03:23,  3.83s/it]
test ppl:  78%|███████▊  | 184/236 [13:07<02:40,  3.09s/it]
test ppl:  78%|███████▊  | 185/236 [13:10<02:47,  3.29s/it]
test ppl:  79%|███████▉  | 186/236 [13:12<02:25,  2.90s/it]
test ppl:  79%|███████▉  | 187/236 [13:18<03:06,  3.81s/it]
test ppl:  80%|███████▉  | 188/236 [13:24<03:32,  4.43s/it]
test ppl:  80%|████████  | 189/236 [13:30<03:48,  4.86s/it]
test ppl:  81%|████████  | 190/236 [13:34<03:34,  4.66s/it]
test ppl:  81%|████████  | 191/236 [13:39<03:25,  4.56s/it]
test ppl:  81%|████████▏ | 192/236 [13:41<02:55,  3.98s/it]
test ppl:  82%|████████▏ | 193/236 [13:47<03:15,  4.54s/it]
test ppl:  82%|████████▏ | 194/236 [13:50<02:46,  3.96s/it]
test ppl:  83%|████████▎ | 195/236 [13:53<02:31,  3.69s/it]
test ppl:  83%|████████▎ | 196/236 [13:55<02:07,  3.18s/it]
test ppl:  83%|████████▎ | 197/236 [13:57<01:51,  2.86s/it]
test ppl:  84%|████████▍ | 198/236 [14:03<02:22,  3.76s/it]
test ppl:  84%|████████▍ | 199/236 [14:05<02:07,  3.44s/it]
test ppl:  85%|████████▍ | 200/236 [14:11<02:29,  4.16s/it]
test ppl:  85%|████████▌ | 201/236 [14:13<02:03,  3.52s/it]
test ppl:  86%|████████▌ | 202/236 [14:19<02:23,  4.22s/it]
test ppl:  86%|████████▌ | 203/236 [14:25<02:35,  4.72s/it]
test ppl:  86%|████████▋ | 204/236 [14:27<01:59,  3.74s/it]
test ppl:  87%|████████▋ | 205/236 [14:32<02:15,  4.39s/it]
test ppl:  87%|████████▋ | 206/236 [14:36<02:01,  4.06s/it]
test ppl:  88%|████████▊ | 207/236 [14:42<02:13,  4.60s/it]
test ppl:  88%|████████▊ | 208/236 [14:45<01:59,  4.27s/it]
test ppl:  89%|████████▊ | 209/236 [14:51<02:08,  4.76s/it]
test ppl:  89%|████████▉ | 210/236 [14:53<01:44,  4.03s/it]
test ppl:  89%|████████▉ | 211/236 [14:58<01:46,  4.25s/it]
test ppl:  90%|████████▉ | 212/236 [15:04<01:53,  4.73s/it]
test ppl:  90%|█████████ | 213/236 [15:10<01:56,  5.06s/it]
test ppl:  91%|█████████ | 214/236 [15:11<01:26,  3.94s/it]
test ppl:  91%|█████████ | 215/236 [15:17<01:34,  4.52s/it]
test ppl:  92%|█████████▏| 216/236 [15:19<01:13,  3.66s/it]
test ppl:  92%|█████████▏| 217/236 [15:24<01:22,  4.34s/it]
test ppl:  92%|█████████▏| 218/236 [15:26<01:05,  3.62s/it]
test ppl:  93%|█████████▎| 219/236 [15:32<01:12,  4.29s/it]
test ppl:  93%|█████████▎| 220/236 [15:38<01:16,  4.76s/it]
test ppl:  94%|█████████▎| 221/236 [15:41<01:03,  4.26s/it]
test ppl:  94%|█████████▍| 222/236 [15:47<01:06,  4.74s/it]
test ppl:  94%|█████████▍| 223/236 [15:53<01:05,  5.07s/it]
test ppl:  95%|█████████▍| 224/236 [15:54<00:48,  4.02s/it]
test ppl:  95%|█████████▌| 225/236 [16:00<00:50,  4.56s/it]
test ppl:  96%|█████████▌| 226/236 [16:04<00:42,  4.28s/it]
test ppl:  96%|█████████▌| 227/236 [16:07<00:34,  3.85s/it]
test ppl:  97%|█████████▋| 228/236 [16:09<00:26,  3.27s/it]
test ppl:  97%|█████████▋| 229/236 [16:15<00:28,  4.04s/it]
test ppl:  97%|█████████▋| 230/236 [16:18<00:23,  3.86s/it]
test ppl:  98%|█████████▊| 231/236 [16:21<00:18,  3.71s/it]
test ppl:  98%|█████████▊| 232/236 [16:23<00:12,  3.18s/it]
test ppl:  99%|█████████▊| 233/236 [16:25<00:08,  2.86s/it]
test ppl:  99%|█████████▉| 234/236 [16:27<00:04,  2.37s/it]
test ppl: 100%|█████████▉| 235/236 [16:32<00:03,  3.41s/it]
test ppl: 100%|██████████| 236/236 [16:33<00:00,  2.58s/it]
test ppl: 100%|██████████| 236/236 [16:33<00:00,  4.21s/it]
10/12/2024 22:54:48 - INFO - __main__ -    em: 0.2083
10/12/2024 22:54:48 - INFO - __main__ -   Finish and take 19m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/64_0.4_60_eval_results.json
64 0.4 60:  em: 0.2083

--------------------------------------------------------------------------------
Running experiment with knn_temp=60, lmbda=0.6, k=16
2024-10-12 22:54:56.871270: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 22:54:56.891842: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 22:54:56.915160: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 22:54:56.922240: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 22:54:56.938654: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 22:54:58.107564: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 22:54:59 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.6, knn_temp=60, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 22:54:59 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:41:34,  2.19it/s]
Adding feature api:   4%|▍         | 7489/187062 [00:00<00:10, 17864.88it/s]
Adding feature api:   9%|▊         | 16030/187062 [00:00<00:04, 35032.03it/s]
Adding feature api:  13%|█▎        | 24570/187062 [00:00<00:03, 48447.98it/s]
Adding feature api:  18%|█▊        | 33172/187062 [00:00<00:02, 58803.28it/s]
Adding feature api:  22%|██▏       | 41726/187062 [00:00<00:02, 66356.57it/s]
Adding feature api:  27%|██▋       | 50362/187062 [00:01<00:01, 72107.53it/s]
Adding feature api:  32%|███▏      | 58991/187062 [00:01<00:01, 76234.29it/s]
Adding feature api:  36%|███▌      | 67435/187062 [00:01<00:01, 78642.25it/s]
Adding feature api:  41%|████      | 76042/187062 [00:01<00:01, 80835.14it/s]
Adding feature api:  45%|████▌     | 84657/187062 [00:01<00:01, 82410.96it/s]
Adding feature api:  50%|████▉     | 93269/187062 [00:01<00:01, 83513.28it/s]
Adding feature api:  54%|█████▍    | 101919/187062 [00:01<00:01, 84402.08it/s]
Adding feature api:  59%|█████▉    | 110559/187062 [00:01<00:00, 84996.16it/s]
Adding feature api:  64%|██████▎   | 119148/187062 [00:01<00:00, 85222.61it/s]
Adding feature api:  68%|██████▊   | 127777/187062 [00:01<00:00, 85539.97it/s]
Adding feature api:  73%|███████▎  | 136375/187062 [00:02<00:00, 85604.86it/s]
Adding feature api:  78%|███████▊  | 144985/187062 [00:02<00:00, 85750.13it/s]
Adding feature api:  82%|████████▏ | 153584/187062 [00:02<00:00, 85821.23it/s]
Adding feature api:  87%|████████▋ | 162182/187062 [00:02<00:00, 85790.80it/s]
Adding feature api:  91%|█████████▏| 170772/187062 [00:02<00:00, 85818.52it/s]
Adding feature api:  96%|█████████▌| 179362/187062 [00:02<00:00, 75986.68it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 65422.89it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:13:04,  2.24it/s]
Adding feature datatype:   4%|▍         | 7275/187062 [00:00<00:10, 17623.46it/s]
Adding feature datatype:   8%|▊         | 15437/187062 [00:00<00:05, 34076.65it/s]
Adding feature datatype:  13%|█▎        | 23684/187062 [00:00<00:03, 47075.16it/s]
Adding feature datatype:  17%|█▋        | 31847/187062 [00:00<00:02, 56656.09it/s]
Adding feature datatype:  21%|██▏       | 40091/187062 [00:00<00:02, 63970.28it/s]
Adding feature datatype:  26%|██▌       | 48372/187062 [00:01<00:01, 69402.76it/s]
Adding feature datatype:  30%|███       | 56641/187062 [00:01<00:01, 73278.85it/s]
Adding feature datatype:  35%|███▍      | 64912/187062 [00:01<00:01, 76052.18it/s]
Adding feature datatype:  39%|███▉      | 73194/187062 [00:01<00:01, 78053.78it/s]
Adding feature datatype:  44%|████▎     | 81443/187062 [00:01<00:01, 79370.70it/s]
Adding feature datatype:  48%|████▊     | 89723/187062 [00:01<00:01, 80389.22it/s]
Adding feature datatype:  52%|█████▏    | 97998/187062 [00:01<00:01, 81091.51it/s]
Adding feature datatype:  57%|█████▋    | 106232/187062 [00:01<00:00, 81463.32it/s]
Adding feature datatype:  61%|██████    | 114524/187062 [00:01<00:00, 81897.80it/s]
Adding feature datatype:  66%|██████▌   | 122843/187062 [00:01<00:00, 82283.01it/s]
Adding feature datatype:  70%|███████   | 131150/187062 [00:02<00:00, 82517.79it/s]
Adding feature datatype:  75%|███████▍  | 139431/187062 [00:02<00:00, 82266.70it/s]
Adding feature datatype:  79%|███████▉  | 147736/187062 [00:02<00:00, 82498.31it/s]
Adding feature datatype:  83%|████████▎ | 156012/187062 [00:02<00:00, 82574.47it/s]
Adding feature datatype:  88%|████████▊ | 164294/187062 [00:02<00:00, 82646.14it/s]
Adding feature datatype:  92%|█████████▏| 172607/187062 [00:02<00:00, 82788.18it/s]
Adding feature datatype:  97%|█████████▋| 180891/187062 [00:02<00:00, 67674.41it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63895.16it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:12:14,  2.24it/s]
Adding feature literal:   4%|▍         | 7274/187062 [00:00<00:10, 17628.76it/s]
Adding feature literal:   8%|▊         | 15552/187062 [00:00<00:05, 34201.26it/s]
Adding feature literal:  13%|█▎        | 23898/187062 [00:00<00:03, 47383.55it/s]
Adding feature literal:  17%|█▋        | 32243/187062 [00:00<00:02, 57358.27it/s]
Adding feature literal:  22%|██▏       | 40625/187062 [00:00<00:02, 64849.99it/s]
Adding feature literal:  26%|██▌       | 49005/187062 [00:01<00:01, 70306.36it/s]
Adding feature literal:  31%|███       | 57350/187062 [00:01<00:01, 74136.38it/s]
Adding feature literal:  35%|███▌      | 65741/187062 [00:01<00:01, 77006.65it/s]
Adding feature literal:  40%|███▉      | 73972/187062 [00:01<00:01, 78574.54it/s]
Adding feature literal:  44%|████▍     | 82386/187062 [00:01<00:01, 80226.74it/s]
Adding feature literal:  49%|████▊     | 90755/187062 [00:01<00:01, 81255.73it/s]
Adding feature literal:  53%|█████▎    | 99143/187062 [00:01<00:01, 82036.13it/s]
Adding feature literal:  57%|█████▋    | 107544/187062 [00:01<00:00, 82624.03it/s]
Adding feature literal:  62%|██████▏   | 115935/187062 [00:01<00:00, 83008.30it/s]
Adding feature literal:  66%|██████▋   | 124302/187062 [00:01<00:00, 83206.02it/s]
Adding feature literal:  71%|███████   | 132664/187062 [00:02<00:00, 82966.11it/s]
Adding feature literal:  75%|███████▌  | 141057/187062 [00:02<00:00, 83253.46it/s]
Adding feature literal:  80%|███████▉  | 149427/187062 [00:02<00:00, 83386.19it/s]
Adding feature literal:  84%|████████▍ | 157781/187062 [00:02<00:00, 83430.12it/s]
Adding feature literal:  89%|████████▉ | 166217/187062 [00:02<00:00, 83706.63it/s]
Adding feature literal:  93%|█████████▎| 174634/187062 [00:02<00:00, 83843.32it/s]
Adding feature literal:  98%|█████████▊| 183024/187062 [00:02<00:00, 60094.97it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 64462.90it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:19:28,  2.23it/s]
Adding feature operator:   4%|▍         | 7333/187062 [00:00<00:10, 17701.93it/s]
Adding feature operator:   8%|▊         | 15716/187062 [00:00<00:04, 34658.70it/s]
Adding feature operator:  13%|█▎        | 24075/187062 [00:00<00:03, 47776.45it/s]
Adding feature operator:  17%|█▋        | 32507/187062 [00:00<00:02, 57895.51it/s]
Adding feature operator:  22%|██▏       | 40936/187062 [00:00<00:02, 65376.66it/s]
Adding feature operator:  26%|██▋       | 49394/187062 [00:01<00:01, 70909.17it/s]
Adding feature operator:  31%|███       | 57798/187062 [00:01<00:01, 74737.85it/s]
Adding feature operator:  35%|███▌      | 66218/187062 [00:01<00:01, 77517.94it/s]
Adding feature operator:  40%|███▉      | 74637/187062 [00:01<00:01, 79490.17it/s]
Adding feature operator:  44%|████▍     | 83057/187062 [00:01<00:01, 80888.10it/s]
Adding feature operator:  49%|████▉     | 91471/187062 [00:01<00:01, 81856.07it/s]
Adding feature operator:  53%|█████▎    | 99829/187062 [00:01<00:01, 81864.80it/s]
Adding feature operator:  58%|█████▊    | 108249/187062 [00:01<00:00, 82558.72it/s]
Adding feature operator:  62%|██████▏   | 116719/187062 [00:01<00:00, 83194.40it/s]
Adding feature operator:  67%|██████▋   | 125143/187062 [00:01<00:00, 83504.35it/s]
Adding feature operator:  71%|███████▏  | 133599/187062 [00:02<00:00, 83818.90it/s]
Adding feature operator:  76%|███████▌  | 142038/187062 [00:02<00:00, 83988.19it/s]
Adding feature operator:  80%|████████  | 150478/187062 [00:02<00:00, 84110.57it/s]
Adding feature operator:  85%|████████▍ | 158904/187062 [00:02<00:00, 84127.37it/s]
Adding feature operator:  89%|████████▉ | 167366/187062 [00:02<00:00, 84273.00it/s]
Adding feature operator:  94%|█████████▍| 175815/187062 [00:02<00:00, 84335.85it/s]
Adding feature operator:  98%|█████████▊| 184254/187062 [00:02<00:00, 57763.62it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 64760.70it/s]
[2024-10-12 22:55:50,890] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 22:55:52 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 22:55:52 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 41/6548 [00:00<00:16, 390.04 examples/s]
Map:   1%|▏         | 84/6548 [00:00<00:30, 211.47 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:24, 261.16 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 315.75 examples/s]
Map:   3%|▎         | 225/6548 [00:00<00:17, 360.90 examples/s]
Map:   4%|▍         | 282/6548 [00:00<00:17, 353.09 examples/s]
Map:   5%|▌         | 331/6548 [00:01<00:20, 306.12 examples/s]
Map:   6%|▌         | 388/6548 [00:01<00:19, 323.98 examples/s]
Map:   7%|▋         | 434/6548 [00:01<00:17, 351.56 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:17, 340.28 examples/s]
Map:   8%|▊         | 512/6548 [00:01<00:17, 351.51 examples/s]
Map:   9%|▊         | 563/6548 [00:01<00:15, 389.52 examples/s]
Map:   9%|▉         | 606/6548 [00:01<00:14, 396.38 examples/s]
Map:  10%|█         | 666/6548 [00:01<00:17, 340.53 examples/s]
Map:  11%|█         | 711/6548 [00:02<00:16, 361.64 examples/s]
Map:  12%|█▏        | 758/6548 [00:02<00:15, 383.90 examples/s]
Map:  12%|█▏        | 813/6548 [00:02<00:13, 417.04 examples/s]
Map:  13%|█▎        | 874/6548 [00:02<00:14, 391.22 examples/s]
Map:  14%|█▍        | 927/6548 [00:02<00:15, 373.75 examples/s]
Map:  15%|█▍        | 970/6548 [00:02<00:15, 366.72 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:24, 229.09 examples/s]
Map:  16%|█▌        | 1054/6548 [00:03<00:21, 254.37 examples/s]
Map:  17%|█▋        | 1098/6548 [00:03<00:18, 287.79 examples/s]
Map:  17%|█▋        | 1145/6548 [00:03<00:16, 326.19 examples/s]
Map:  18%|█▊        | 1184/6548 [00:03<00:15, 339.48 examples/s]
Map:  19%|█▊        | 1223/6548 [00:03<00:15, 349.64 examples/s]
Map:  19%|█▉        | 1262/6548 [00:03<00:14, 358.10 examples/s]
Map:  20%|█▉        | 1302/6548 [00:03<00:14, 367.27 examples/s]
Map:  21%|██        | 1355/6548 [00:04<00:15, 333.81 examples/s]
Map:  21%|██▏       | 1401/6548 [00:04<00:16, 321.67 examples/s]
Map:  22%|██▏       | 1436/6548 [00:04<00:17, 298.95 examples/s]
Map:  23%|██▎       | 1480/6548 [00:04<00:16, 303.58 examples/s]
Map:  23%|██▎       | 1515/6548 [00:04<00:16, 311.87 examples/s]
Map:  24%|██▍       | 1560/6548 [00:04<00:16, 294.30 examples/s]
Map:  24%|██▍       | 1596/6548 [00:04<00:16, 303.44 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:17, 283.76 examples/s]
Map:  26%|██▌       | 1695/6548 [00:05<00:16, 293.31 examples/s]
Map:  26%|██▋       | 1735/6548 [00:05<00:15, 315.23 examples/s]
Map:  27%|██▋       | 1780/6548 [00:05<00:13, 345.78 examples/s]
Map:  28%|██▊       | 1843/6548 [00:05<00:12, 366.01 examples/s]
Map:  29%|██▉       | 1890/6548 [00:05<00:13, 341.51 examples/s]
Map:  30%|██▉       | 1933/6548 [00:05<00:12, 359.30 examples/s]
Map:  30%|███       | 1974/6548 [00:05<00:12, 370.28 examples/s]
Map:  31%|███       | 2018/6548 [00:06<00:18, 242.75 examples/s]
Map:  31%|███▏      | 2049/6548 [00:06<00:17, 252.09 examples/s]
Map:  32%|███▏      | 2092/6548 [00:06<00:15, 285.50 examples/s]
Map:  33%|███▎      | 2131/6548 [00:06<00:16, 275.98 examples/s]
Map:  33%|███▎      | 2182/6548 [00:06<00:15, 285.02 examples/s]
Map:  34%|███▍      | 2213/6548 [00:06<00:14, 289.39 examples/s]
Map:  34%|███▍      | 2255/6548 [00:07<00:15, 277.06 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:15, 280.06 examples/s]
Map:  36%|███▌      | 2332/6548 [00:07<00:13, 318.30 examples/s]
Map:  36%|███▋      | 2385/6548 [00:07<00:12, 325.26 examples/s]
Map:  37%|███▋      | 2425/6548 [00:07<00:12, 342.19 examples/s]
Map:  38%|███▊      | 2477/6548 [00:07<00:12, 322.00 examples/s]
Map:  38%|███▊      | 2517/6548 [00:07<00:11, 336.81 examples/s]
Map:  39%|███▉      | 2562/6548 [00:07<00:11, 360.24 examples/s]
Map:  40%|███▉      | 2608/6548 [00:08<00:10, 381.85 examples/s]
Map:  41%|████      | 2654/6548 [00:08<00:09, 399.94 examples/s]
Map:  41%|████▏     | 2704/6548 [00:08<00:10, 367.71 examples/s]
Map:  42%|████▏     | 2762/6548 [00:08<00:10, 371.96 examples/s]
Map:  43%|████▎     | 2808/6548 [00:08<00:10, 343.49 examples/s]
Map:  44%|████▎     | 2858/6548 [00:08<00:12, 288.72 examples/s]
Map:  44%|████▍     | 2896/6548 [00:08<00:11, 304.76 examples/s]
Map:  45%|████▌     | 2951/6548 [00:09<00:11, 304.60 examples/s]
Map:  46%|████▌     | 2991/6548 [00:09<00:13, 258.71 examples/s]
Map:  46%|████▌     | 3026/6548 [00:09<00:20, 172.65 examples/s]
Map:  47%|████▋     | 3058/6548 [00:09<00:18, 192.09 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 208.80 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 248.67 examples/s]
Map:  48%|████▊     | 3168/6548 [00:10<00:14, 241.40 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 240.63 examples/s]
Map:  49%|████▉     | 3238/6548 [00:10<00:12, 261.72 examples/s]
Map:  50%|████▉     | 3271/6548 [00:10<00:12, 270.54 examples/s]
Map:  50%|█████     | 3302/6548 [00:10<00:11, 279.04 examples/s]
Map:  51%|█████     | 3342/6548 [00:10<00:10, 306.90 examples/s]
Map:  52%|█████▏    | 3388/6548 [00:11<00:10, 290.22 examples/s]
Map:  52%|█████▏    | 3420/6548 [00:11<00:10, 285.32 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 270.41 examples/s]
Map:  53%|█████▎    | 3491/6548 [00:11<00:12, 254.39 examples/s]
Map:  54%|█████▍    | 3541/6548 [00:11<00:09, 310.33 examples/s]
Map:  55%|█████▍    | 3585/6548 [00:11<00:08, 341.16 examples/s]
Map:  55%|█████▌    | 3628/6548 [00:11<00:08, 359.27 examples/s]
Map:  56%|█████▌    | 3667/6548 [00:11<00:08, 355.96 examples/s]
Map:  57%|█████▋    | 3711/6548 [00:11<00:07, 377.40 examples/s]
Map:  57%|█████▋    | 3752/6548 [00:12<00:07, 367.94 examples/s]
Map:  58%|█████▊    | 3798/6548 [00:12<00:07, 391.89 examples/s]
Map:  59%|█████▊    | 3846/6548 [00:12<00:08, 323.05 examples/s]
Map:  60%|█████▉    | 3898/6548 [00:12<00:08, 328.59 examples/s]
Map:  60%|██████    | 3947/6548 [00:12<00:08, 324.75 examples/s]
Map:  61%|██████    | 3995/6548 [00:12<00:07, 347.72 examples/s]
Map:  62%|██████▏   | 4049/6548 [00:13<00:09, 254.03 examples/s]
Map:  62%|██████▏   | 4091/6548 [00:13<00:08, 280.96 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 304.49 examples/s]
Map:  64%|██████▍   | 4179/6548 [00:13<00:08, 291.71 examples/s]
Map:  64%|██████▍   | 4215/6548 [00:13<00:07, 305.39 examples/s]
Map:  65%|██████▌   | 4266/6548 [00:13<00:06, 352.17 examples/s]
Map:  66%|██████▌   | 4326/6548 [00:13<00:06, 366.68 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:13<00:06, 353.96 examples/s]
Map:  67%|██████▋   | 4407/6548 [00:14<00:05, 360.18 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:05, 385.57 examples/s]
Map:  69%|██████▊   | 4498/6548 [00:14<00:06, 333.91 examples/s]
Map:  69%|██████▉   | 4537/6548 [00:14<00:06, 306.85 examples/s]
Map:  70%|██████▉   | 4578/6548 [00:14<00:05, 329.59 examples/s]
Map:  70%|███████   | 4614/6548 [00:14<00:05, 335.29 examples/s]
Map:  71%|███████   | 4662/6548 [00:14<00:05, 371.85 examples/s]
Map:  72%|███████▏  | 4716/6548 [00:14<00:05, 358.60 examples/s]
Map:  73%|███████▎  | 4784/6548 [00:15<00:04, 388.00 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 390.60 examples/s]
Map:  75%|███████▍  | 4888/6548 [00:15<00:04, 387.21 examples/s]
Map:  76%|███████▌  | 4953/6548 [00:15<00:04, 393.60 examples/s]
Map:  76%|███████▋  | 4994/6548 [00:15<00:04, 348.23 examples/s]
Map:  77%|███████▋  | 5031/6548 [00:16<00:06, 231.26 examples/s]
Map:  77%|███████▋  | 5061/6548 [00:16<00:06, 240.03 examples/s]
Map:  78%|███████▊  | 5096/6548 [00:16<00:05, 259.23 examples/s]
Map:  78%|███████▊  | 5126/6548 [00:16<00:05, 265.20 examples/s]
Map:  79%|███████▉  | 5159/6548 [00:16<00:04, 279.34 examples/s]
Map:  80%|███████▉  | 5207/6548 [00:16<00:04, 290.09 examples/s]
Map:  80%|████████  | 5245/6548 [00:16<00:04, 308.72 examples/s]
Map:  81%|████████  | 5286/6548 [00:16<00:03, 330.10 examples/s]
Map:  81%|████████▏ | 5322/6548 [00:16<00:03, 337.29 examples/s]
Map:  82%|████████▏ | 5359/6548 [00:17<00:04, 294.81 examples/s]
Map:  82%|████████▏ | 5392/6548 [00:17<00:04, 282.81 examples/s]
Map:  83%|████████▎ | 5429/6548 [00:17<00:03, 299.71 examples/s]
Map:  84%|████████▎ | 5473/6548 [00:17<00:03, 331.34 examples/s]
Map:  84%|████████▍ | 5509/6548 [00:17<00:03, 334.75 examples/s]
Map:  85%|████████▍ | 5553/6548 [00:17<00:02, 362.25 examples/s]
Map:  85%|████████▌ | 5594/6548 [00:17<00:02, 326.25 examples/s]
Map:  86%|████████▌ | 5641/6548 [00:17<00:02, 362.62 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 308.45 examples/s]
Map:  87%|████████▋ | 5720/6548 [00:18<00:02, 327.21 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 346.57 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 351.79 examples/s]
Map:  89%|████████▉ | 5845/6548 [00:18<00:02, 346.80 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:18<00:01, 340.86 examples/s]
Map:  90%|█████████ | 5921/6548 [00:18<00:01, 344.77 examples/s]
Map:  91%|█████████ | 5964/6548 [00:18<00:01, 319.63 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 212.22 examples/s]
Map:  92%|█████████▏| 6041/6548 [00:19<00:02, 249.15 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 281.48 examples/s]
Map:  94%|█████████▎| 6124/6548 [00:19<00:01, 277.47 examples/s]
Map:  94%|█████████▍| 6163/6548 [00:19<00:01, 291.99 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:19<00:01, 310.14 examples/s]
Map:  96%|█████████▌| 6261/6548 [00:20<00:00, 320.68 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 334.44 examples/s]
Map:  97%|█████████▋| 6366/6548 [00:20<00:00, 358.12 examples/s]
Map:  98%|█████████▊| 6416/6548 [00:20<00:00, 345.70 examples/s]
Map:  99%|█████████▊| 6464/6548 [00:20<00:00, 373.12 examples/s]
Map:  99%|█████████▉| 6515/6548 [00:20<00:00, 355.86 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 313.39 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 329.00 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 354.18 examples/s]
Map:  13%|█▎        | 116/903 [00:00<00:02, 350.36 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 363.98 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 398.07 examples/s]
Map:  28%|██▊       | 253/903 [00:00<00:01, 405.40 examples/s]
Map:  35%|███▍      | 312/903 [00:00<00:01, 397.14 examples/s]
Map:  40%|███▉      | 357/903 [00:00<00:01, 341.42 examples/s]
Map:  46%|████▌     | 413/903 [00:01<00:01, 317.99 examples/s]
Map:  51%|█████     | 460/903 [00:01<00:01, 313.74 examples/s]
Map:  57%|█████▋    | 516/903 [00:01<00:01, 327.63 examples/s]
Map:  62%|██████▏   | 561/903 [00:01<00:00, 349.08 examples/s]
Map:  68%|██████▊   | 613/903 [00:01<00:00, 374.19 examples/s]
Map:  75%|███████▍  | 673/903 [00:01<00:00, 378.29 examples/s]
Map:  79%|███████▉  | 716/903 [00:01<00:00, 382.24 examples/s]
Map:  85%|████████▍ | 766/903 [00:02<00:00, 403.25 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 391.25 examples/s]
Map:  96%|█████████▋| 871/903 [00:02<00:00, 403.74 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 333.88 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 298.99 examples/s]
Map:   4%|▍         | 82/1882 [00:00<00:04, 371.24 examples/s]
Map:   7%|▋         | 126/1882 [00:00<00:05, 317.81 examples/s]
Map:   9%|▉         | 171/1882 [00:00<00:04, 350.03 examples/s]
Map:  12%|█▏        | 222/1882 [00:00<00:04, 343.89 examples/s]
Map:  14%|█▍        | 267/1882 [00:00<00:04, 365.74 examples/s]
Map:  18%|█▊        | 330/1882 [00:00<00:04, 383.25 examples/s]
Map:  20%|█▉        | 371/1882 [00:01<00:04, 343.15 examples/s]
Map:  22%|██▏       | 415/1882 [00:01<00:05, 292.02 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 299.15 examples/s]
Map:  26%|██▌       | 489/1882 [00:01<00:04, 320.71 examples/s]
Map:  28%|██▊       | 534/1882 [00:01<00:04, 309.90 examples/s]
Map:  31%|███       | 576/1882 [00:01<00:03, 331.82 examples/s]
Map:  34%|███▍      | 636/1882 [00:01<00:03, 395.55 examples/s]
Map:  36%|███▌      | 678/1882 [00:01<00:03, 391.94 examples/s]
Map:  39%|███▉      | 734/1882 [00:02<00:02, 382.97 examples/s]
Map:  42%|████▏     | 793/1882 [00:02<00:02, 370.55 examples/s]
Map:  44%|████▍     | 832/1882 [00:02<00:02, 372.92 examples/s]
Map:  46%|████▋     | 874/1882 [00:02<00:02, 369.80 examples/s]
Map:  49%|████▊     | 917/1882 [00:02<00:02, 382.20 examples/s]
Map:  51%|█████▏    | 966/1882 [00:02<00:02, 409.29 examples/s]
Map:  54%|█████▍    | 1016/1882 [00:03<00:03, 252.90 examples/s]
Map:  56%|█████▌    | 1054/1882 [00:03<00:03, 273.97 examples/s]
Map:  58%|█████▊    | 1091/1882 [00:03<00:02, 292.04 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 299.07 examples/s]
Map:  63%|██████▎   | 1177/1882 [00:03<00:02, 287.65 examples/s]
Map:  64%|██████▍   | 1213/1882 [00:03<00:02, 298.05 examples/s]
Map:  67%|██████▋   | 1255/1882 [00:03<00:01, 323.61 examples/s]
Map:  69%|██████▉   | 1296/1882 [00:03<00:01, 344.57 examples/s]
Map:  71%|███████   | 1340/1882 [00:03<00:01, 366.75 examples/s]
Map:  73%|███████▎  | 1381/1882 [00:04<00:01, 327.80 examples/s]
Map:  75%|███████▌  | 1417/1882 [00:04<00:01, 284.81 examples/s]
Map:  78%|███████▊  | 1465/1882 [00:04<00:01, 286.51 examples/s]
Map:  80%|███████▉  | 1503/1882 [00:04<00:01, 255.12 examples/s]
Map:  82%|████████▏ | 1534/1882 [00:04<00:01, 265.86 examples/s]
Map:  83%|████████▎ | 1568/1882 [00:04<00:01, 281.87 examples/s]
Map:  86%|████████▌ | 1617/1882 [00:04<00:00, 331.82 examples/s]
Map:  88%|████████▊ | 1665/1882 [00:05<00:00, 325.16 examples/s]
Map:  91%|█████████ | 1716/1882 [00:05<00:00, 328.61 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 283.14 examples/s]
Map:  96%|█████████▌| 1799/1882 [00:05<00:00, 286.40 examples/s]
Map:  98%|█████████▊| 1844/1882 [00:05<00:00, 318.92 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 230.68 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 313.06 examples/s]
10/12/2024 22:56:54 - INFO - __main__ -     ***** Testing *****
10/12/2024 22:56:54 - INFO - __main__ -     Batch size = 8
10/12/2024 22:56:54 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 22:56:55 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 22:56:55 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 22:56:56 - INFO - knnlm -   Reading datastore took 0.9382588863372803 s
10/12/2024 22:56:57 - INFO - knnlm -   Moving index to GPU took 0.986142635345459 s
10/12/2024 22:56:57 - INFO - __main__ -   ******************************break-into
10/12/2024 22:56:57 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 22:56:57 - INFO - __main__ -     Num examples = 236
10/12/2024 22:56:57 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:02,  7.67s/it]
test ppl:   1%|          | 2/236 [00:09<16:22,  4.20s/it]
test ppl:   1%|▏         | 3/236 [00:10<11:36,  2.99s/it]
test ppl:   2%|▏         | 4/236 [00:12<09:32,  2.47s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:06,  3.67s/it]
test ppl:   3%|▎         | 6/236 [00:24<16:50,  4.39s/it]
test ppl:   3%|▎         | 7/236 [00:26<14:26,  3.78s/it]
test ppl:   3%|▎         | 8/236 [00:31<14:57,  3.94s/it]
test ppl:   4%|▍         | 9/236 [00:34<14:48,  3.91s/it]
test ppl:   4%|▍         | 10/236 [00:38<14:40,  3.90s/it]
test ppl:   5%|▍         | 11/236 [00:42<14:41,  3.92s/it]
test ppl:   5%|▌         | 12/236 [00:48<16:45,  4.49s/it]
test ppl:   6%|▌         | 13/236 [00:54<18:09,  4.89s/it]
test ppl:   6%|▌         | 14/236 [01:00<19:07,  5.17s/it]
test ppl:   6%|▋         | 15/236 [01:02<16:18,  4.43s/it]
test ppl:   7%|▋         | 16/236 [01:04<13:22,  3.65s/it]
test ppl:   7%|▋         | 17/236 [01:10<15:41,  4.30s/it]
test ppl:   8%|▊         | 18/236 [01:12<12:44,  3.51s/it]
test ppl:   8%|▊         | 19/236 [01:17<15:10,  4.20s/it]
test ppl:   8%|▊         | 20/236 [01:20<13:19,  3.70s/it]
test ppl:   9%|▉         | 21/236 [01:22<11:53,  3.32s/it]
test ppl:   9%|▉         | 22/236 [01:28<14:29,  4.06s/it]
test ppl:  10%|▉         | 23/236 [01:32<13:51,  3.90s/it]
test ppl:  10%|█         | 24/236 [01:34<11:58,  3.39s/it]
test ppl:  11%|█         | 25/236 [01:36<10:12,  2.90s/it]
test ppl:  11%|█         | 26/236 [01:42<13:14,  3.78s/it]
test ppl:  11%|█▏        | 27/236 [01:45<12:49,  3.68s/it]
test ppl:  12%|█▏        | 28/236 [01:46<10:26,  3.01s/it]
test ppl:  12%|█▏        | 29/236 [01:49<09:38,  2.79s/it]
test ppl:  13%|█▎        | 30/236 [01:50<08:17,  2.41s/it]
test ppl:  13%|█▎        | 31/236 [01:52<07:48,  2.28s/it]
test ppl:  14%|█▎        | 32/236 [01:55<08:09,  2.40s/it]
test ppl:  14%|█▍        | 33/236 [01:57<08:08,  2.41s/it]
test ppl:  14%|█▍        | 34/236 [02:01<09:49,  2.92s/it]
test ppl:  15%|█▍        | 35/236 [02:04<09:20,  2.79s/it]
test ppl:  15%|█▌        | 36/236 [02:10<12:17,  3.69s/it]
test ppl:  16%|█▌        | 37/236 [02:16<14:22,  4.34s/it]
test ppl:  16%|█▌        | 38/236 [02:18<12:03,  3.65s/it]
test ppl:  17%|█▋        | 39/236 [02:19<10:04,  3.07s/it]
test ppl:  17%|█▋        | 40/236 [02:21<08:34,  2.63s/it]
test ppl:  17%|█▋        | 41/236 [02:23<07:45,  2.39s/it]
test ppl:  18%|█▊        | 42/236 [02:29<11:03,  3.42s/it]
test ppl:  18%|█▊        | 43/236 [02:34<13:16,  4.13s/it]
test ppl:  19%|█▊        | 44/236 [02:37<11:27,  3.58s/it]
test ppl:  19%|█▉        | 45/236 [02:38<09:42,  3.05s/it]
test ppl:  19%|█▉        | 46/236 [02:44<12:18,  3.89s/it]
test ppl:  20%|█▉        | 47/236 [02:46<10:00,  3.18s/it]
test ppl:  20%|██        | 48/236 [02:52<12:25,  3.97s/it]
test ppl:  21%|██        | 49/236 [02:55<12:08,  3.90s/it]
test ppl:  21%|██        | 50/236 [03:01<13:54,  4.49s/it]
test ppl:  22%|██▏       | 51/236 [03:07<15:04,  4.89s/it]
test ppl:  22%|██▏       | 52/236 [03:13<15:50,  5.17s/it]
test ppl:  22%|██▏       | 53/236 [03:16<13:46,  4.52s/it]
test ppl:  23%|██▎       | 54/236 [03:17<10:58,  3.62s/it]
test ppl:  23%|██▎       | 55/236 [03:23<12:45,  4.23s/it]
test ppl:  24%|██▎       | 56/236 [03:29<14:08,  4.71s/it]
test ppl:  24%|██▍       | 57/236 [03:35<15:02,  5.04s/it]
test ppl:  25%|██▍       | 58/236 [03:37<12:28,  4.21s/it]
test ppl:  25%|██▌       | 59/236 [03:43<13:50,  4.69s/it]
test ppl:  25%|██▌       | 60/236 [03:46<12:21,  4.21s/it]
test ppl:  26%|██▌       | 61/236 [03:52<13:41,  4.69s/it]
test ppl:  26%|██▋       | 62/236 [03:56<13:00,  4.49s/it]
test ppl:  27%|██▋       | 63/236 [03:58<11:09,  3.87s/it]
test ppl:  27%|██▋       | 64/236 [04:00<09:05,  3.17s/it]
test ppl:  28%|██▊       | 65/236 [04:01<07:26,  2.61s/it]
test ppl:  28%|██▊       | 66/236 [04:04<07:42,  2.72s/it]
test ppl:  28%|██▊       | 67/236 [04:10<10:16,  3.65s/it]
test ppl:  29%|██▉       | 68/236 [04:15<11:33,  4.13s/it]
test ppl:  29%|██▉       | 69/236 [04:20<12:28,  4.48s/it]
test ppl:  30%|██▉       | 70/236 [04:22<09:44,  3.52s/it]
test ppl:  30%|███       | 71/236 [04:25<09:52,  3.59s/it]
test ppl:  31%|███       | 72/236 [04:31<11:11,  4.09s/it]
test ppl:  31%|███       | 73/236 [04:33<10:02,  3.70s/it]
test ppl:  31%|███▏      | 74/236 [04:35<08:11,  3.04s/it]
test ppl:  32%|███▏      | 75/236 [04:41<10:22,  3.86s/it]
test ppl:  32%|███▏      | 76/236 [04:47<11:51,  4.44s/it]
test ppl:  33%|███▎      | 77/236 [04:49<10:01,  3.78s/it]
test ppl:  33%|███▎      | 78/236 [04:50<08:20,  3.17s/it]
test ppl:  33%|███▎      | 79/236 [04:54<08:49,  3.37s/it]
test ppl:  34%|███▍      | 80/236 [04:57<08:02,  3.09s/it]
test ppl:  34%|███▍      | 81/236 [05:03<10:05,  3.90s/it]
test ppl:  35%|███▍      | 82/236 [05:08<11:30,  4.48s/it]
test ppl:  35%|███▌      | 83/236 [05:11<09:54,  3.89s/it]
test ppl:  36%|███▌      | 84/236 [05:13<08:41,  3.43s/it]
test ppl:  36%|███▌      | 85/236 [05:17<09:09,  3.64s/it]
test ppl:  36%|███▋      | 86/236 [05:19<07:39,  3.06s/it]
test ppl:  37%|███▋      | 87/236 [05:22<07:16,  2.93s/it]
test ppl:  37%|███▋      | 88/236 [05:28<09:19,  3.78s/it]
test ppl:  38%|███▊      | 89/236 [05:29<07:56,  3.24s/it]
test ppl:  38%|███▊      | 90/236 [05:35<09:44,  4.00s/it]
test ppl:  39%|███▊      | 91/236 [05:40<10:20,  4.28s/it]
test ppl:  39%|███▉      | 92/236 [05:43<09:11,  3.83s/it]
test ppl:  39%|███▉      | 93/236 [05:49<10:31,  4.42s/it]
test ppl:  40%|███▉      | 94/236 [05:55<11:25,  4.83s/it]
test ppl:  40%|████      | 95/236 [05:57<09:38,  4.10s/it]
test ppl:  41%|████      | 96/236 [06:01<09:17,  3.98s/it]
test ppl:  41%|████      | 97/236 [06:06<10:28,  4.52s/it]
test ppl:  42%|████▏     | 98/236 [06:12<11:17,  4.91s/it]
test ppl:  42%|████▏     | 99/236 [06:18<11:48,  5.17s/it]
test ppl:  42%|████▏     | 100/236 [06:19<09:02,  3.99s/it]
test ppl:  43%|████▎     | 101/236 [06:25<10:10,  4.52s/it]
test ppl:  43%|████▎     | 102/236 [06:29<09:40,  4.33s/it]
test ppl:  44%|████▎     | 103/236 [06:30<07:39,  3.46s/it]
test ppl:  44%|████▍     | 104/236 [06:34<08:03,  3.67s/it]
test ppl:  44%|████▍     | 105/236 [06:38<08:09,  3.74s/it]
test ppl:  45%|████▍     | 106/236 [06:44<09:07,  4.21s/it]
test ppl:  45%|████▌     | 107/236 [06:46<07:43,  3.59s/it]
test ppl:  46%|████▌     | 108/236 [06:51<08:21,  3.92s/it]
test ppl:  46%|████▌     | 109/236 [06:57<09:41,  4.58s/it]
test ppl:  47%|████▋     | 110/236 [06:58<07:43,  3.68s/it]
test ppl:  47%|████▋     | 111/236 [07:04<08:59,  4.32s/it]
test ppl:  47%|████▋     | 112/236 [07:10<09:49,  4.75s/it]
test ppl:  48%|████▊     | 113/236 [07:12<07:53,  3.85s/it]
test ppl:  48%|████▊     | 114/236 [07:15<07:25,  3.65s/it]
test ppl:  49%|████▊     | 115/236 [07:21<08:39,  4.29s/it]
test ppl:  49%|████▉     | 116/236 [07:26<09:29,  4.74s/it]
test ppl:  50%|████▉     | 117/236 [07:28<07:40,  3.87s/it]
test ppl:  50%|█████     | 118/236 [07:33<08:19,  4.23s/it]
test ppl:  50%|█████     | 119/236 [07:35<06:57,  3.57s/it]
test ppl:  51%|█████     | 120/236 [07:37<05:39,  2.93s/it]
test ppl:  51%|█████▏    | 121/236 [07:39<05:27,  2.85s/it]
test ppl:  52%|█████▏    | 122/236 [07:45<07:05,  3.73s/it]
test ppl:  52%|█████▏    | 123/236 [07:47<06:06,  3.24s/it]
test ppl:  53%|█████▎    | 124/236 [07:50<05:59,  3.21s/it]
test ppl:  53%|█████▎    | 125/236 [07:56<07:22,  3.99s/it]
test ppl:  53%|█████▎    | 126/236 [08:01<07:42,  4.20s/it]
test ppl:  54%|█████▍    | 127/236 [08:03<06:28,  3.56s/it]
test ppl:  54%|█████▍    | 128/236 [08:05<05:29,  3.05s/it]
test ppl:  55%|█████▍    | 129/236 [08:07<05:11,  2.91s/it]
test ppl:  55%|█████▌    | 130/236 [08:10<05:12,  2.95s/it]
test ppl:  56%|█████▌    | 131/236 [08:16<06:39,  3.80s/it]
test ppl:  56%|█████▌    | 132/236 [08:19<05:53,  3.39s/it]
test ppl:  56%|█████▋    | 133/236 [08:23<06:09,  3.59s/it]
test ppl:  57%|█████▋    | 134/236 [08:26<05:58,  3.52s/it]
test ppl:  57%|█████▋    | 135/236 [08:32<07:10,  4.26s/it]
test ppl:  58%|█████▊    | 136/236 [08:33<05:35,  3.36s/it]
test ppl:  58%|█████▊    | 137/236 [08:39<06:49,  4.13s/it]
test ppl:  58%|█████▊    | 138/236 [08:43<06:20,  3.89s/it]
test ppl:  59%|█████▉    | 139/236 [08:44<05:15,  3.25s/it]
test ppl:  59%|█████▉    | 140/236 [08:46<04:34,  2.86s/it]
test ppl:  60%|█████▉    | 141/236 [08:50<05:07,  3.24s/it]
test ppl:  60%|██████    | 142/236 [08:56<06:17,  4.01s/it]
test ppl:  61%|██████    | 143/236 [09:02<07:04,  4.56s/it]
test ppl:  61%|██████    | 144/236 [09:05<06:13,  4.06s/it]
test ppl:  61%|██████▏   | 145/236 [09:13<07:52,  5.19s/it]
test ppl:  62%|██████▏   | 146/236 [09:18<07:44,  5.17s/it]
test ppl:  62%|██████▏   | 147/236 [09:24<07:57,  5.37s/it]
test ppl:  63%|██████▎   | 148/236 [09:30<08:07,  5.54s/it]
test ppl:  63%|██████▎   | 149/236 [09:35<08:09,  5.62s/it]
test ppl:  64%|██████▎   | 150/236 [09:41<08:13,  5.73s/it]
test ppl:  64%|██████▍   | 151/236 [09:47<08:09,  5.76s/it]
test ppl:  64%|██████▍   | 152/236 [09:53<08:04,  5.77s/it]
test ppl:  65%|██████▍   | 153/236 [09:57<07:17,  5.28s/it]
test ppl:  65%|██████▌   | 154/236 [10:00<06:06,  4.47s/it]
test ppl:  66%|██████▌   | 155/236 [10:03<05:25,  4.02s/it]
test ppl:  66%|██████▌   | 156/236 [10:05<04:41,  3.51s/it]
test ppl:  67%|██████▋   | 157/236 [10:07<04:06,  3.12s/it]
test ppl:  67%|██████▋   | 158/236 [10:13<05:06,  3.93s/it]
test ppl:  67%|██████▋   | 159/236 [10:15<04:06,  3.20s/it]
test ppl:  68%|██████▊   | 160/236 [10:16<03:16,  2.58s/it]
test ppl:  68%|██████▊   | 161/236 [10:17<02:41,  2.16s/it]
test ppl:  69%|██████▊   | 162/236 [10:20<03:00,  2.44s/it]
test ppl:  69%|██████▉   | 163/236 [10:23<02:59,  2.46s/it]
test ppl:  69%|██████▉   | 164/236 [10:26<03:10,  2.65s/it]
test ppl:  70%|██████▉   | 165/236 [10:29<03:23,  2.87s/it]
test ppl:  70%|███████   | 166/236 [10:31<02:56,  2.52s/it]
test ppl:  71%|███████   | 167/236 [10:33<02:39,  2.31s/it]
test ppl:  71%|███████   | 168/236 [10:35<02:34,  2.28s/it]
test ppl:  72%|███████▏  | 169/236 [10:40<03:28,  3.11s/it]
test ppl:  72%|███████▏  | 170/236 [10:46<04:19,  3.93s/it]
test ppl:  72%|███████▏  | 171/236 [10:47<03:27,  3.19s/it]
test ppl:  73%|███████▎  | 172/236 [10:53<04:14,  3.98s/it]
test ppl:  73%|███████▎  | 173/236 [10:56<03:56,  3.76s/it]
test ppl:  74%|███████▎  | 174/236 [11:02<04:31,  4.38s/it]
test ppl:  74%|███████▍  | 175/236 [11:04<03:40,  3.62s/it]
test ppl:  75%|███████▍  | 176/236 [11:10<04:16,  4.27s/it]
test ppl:  75%|███████▌  | 177/236 [11:15<04:39,  4.74s/it]
test ppl:  75%|███████▌  | 178/236 [11:21<04:54,  5.07s/it]
test ppl:  76%|███████▌  | 179/236 [11:27<05:01,  5.30s/it]
test ppl:  76%|███████▋  | 180/236 [11:33<05:05,  5.45s/it]
test ppl:  77%|███████▋  | 181/236 [11:39<05:05,  5.56s/it]
test ppl:  77%|███████▋  | 182/236 [11:41<04:00,  4.46s/it]
test ppl:  78%|███████▊  | 183/236 [11:42<03:10,  3.59s/it]
test ppl:  78%|███████▊  | 184/236 [11:44<02:36,  3.00s/it]
test ppl:  78%|███████▊  | 185/236 [11:48<02:57,  3.48s/it]
test ppl:  79%|███████▉  | 186/236 [11:50<02:31,  3.03s/it]
test ppl:  79%|███████▉  | 187/236 [11:52<02:07,  2.60s/it]
test ppl:  80%|███████▉  | 188/236 [11:58<02:51,  3.57s/it]
test ppl:  80%|████████  | 189/236 [12:04<03:19,  4.25s/it]
test ppl:  81%|████████  | 190/236 [12:08<03:14,  4.24s/it]
test ppl:  81%|████████  | 191/236 [12:12<03:04,  4.09s/it]
test ppl:  81%|████████▏ | 192/236 [12:14<02:40,  3.64s/it]
test ppl:  82%|████████▏ | 193/236 [12:16<02:13,  3.11s/it]
test ppl:  82%|████████▏ | 194/236 [12:19<02:04,  2.96s/it]
test ppl:  83%|████████▎ | 195/236 [12:22<02:02,  2.98s/it]
test ppl:  83%|████████▎ | 196/236 [12:24<01:47,  2.69s/it]
test ppl:  83%|████████▎ | 197/236 [12:26<01:38,  2.52s/it]
test ppl:  84%|████████▍ | 198/236 [12:32<02:13,  3.51s/it]
test ppl:  84%|████████▍ | 199/236 [12:34<02:01,  3.29s/it]
test ppl:  85%|████████▍ | 200/236 [12:40<02:25,  4.05s/it]
test ppl:  85%|████████▌ | 201/236 [12:43<02:06,  3.61s/it]
test ppl:  86%|████████▌ | 202/236 [12:49<02:24,  4.26s/it]
test ppl:  86%|████████▌ | 203/236 [12:54<02:36,  4.73s/it]
test ppl:  86%|████████▋ | 204/236 [12:56<02:05,  3.93s/it]
test ppl:  87%|████████▋ | 205/236 [13:02<02:19,  4.51s/it]
test ppl:  87%|████████▋ | 206/236 [13:06<02:04,  4.14s/it]
test ppl:  88%|████████▊ | 207/236 [13:11<02:14,  4.65s/it]
test ppl:  88%|████████▊ | 208/236 [13:14<01:53,  4.06s/it]
test ppl:  89%|████████▊ | 209/236 [13:20<02:04,  4.61s/it]
test ppl:  89%|████████▉ | 210/236 [13:22<01:42,  3.93s/it]
test ppl:  89%|████████▉ | 211/236 [13:26<01:36,  3.85s/it]
test ppl:  90%|████████▉ | 212/236 [13:31<01:39,  4.17s/it]
test ppl:  90%|█████████ | 213/236 [13:37<01:47,  4.66s/it]
test ppl:  91%|█████████ | 214/236 [13:38<01:22,  3.75s/it]
test ppl:  91%|█████████ | 215/236 [13:44<01:31,  4.38s/it]
test ppl:  92%|█████████▏| 216/236 [13:46<01:11,  3.56s/it]
test ppl:  92%|█████████▏| 217/236 [13:52<01:21,  4.27s/it]
test ppl:  92%|█████████▏| 218/236 [13:55<01:08,  3.80s/it]
test ppl:  93%|█████████▎| 219/236 [14:00<01:15,  4.42s/it]
test ppl:  93%|█████████▎| 220/236 [14:05<01:13,  4.59s/it]
test ppl:  94%|█████████▎| 221/236 [14:07<00:55,  3.73s/it]
test ppl:  94%|█████████▍| 222/236 [14:13<01:00,  4.36s/it]
test ppl:  94%|█████████▍| 223/236 [14:19<01:02,  4.80s/it]
test ppl:  95%|█████████▍| 224/236 [14:20<00:44,  3.70s/it]
test ppl:  95%|█████████▌| 225/236 [14:24<00:42,  3.85s/it]
test ppl:  96%|█████████▌| 226/236 [14:26<00:33,  3.38s/it]
test ppl:  96%|█████████▌| 227/236 [14:29<00:28,  3.18s/it]
test ppl:  97%|█████████▋| 228/236 [14:31<00:21,  2.73s/it]
test ppl:  97%|█████████▋| 229/236 [14:37<00:25,  3.65s/it]
test ppl:  97%|█████████▋| 230/236 [14:41<00:22,  3.81s/it]
test ppl:  98%|█████████▊| 231/236 [14:44<00:18,  3.70s/it]
test ppl:  98%|█████████▊| 232/236 [14:46<00:12,  3.14s/it]
test ppl:  99%|█████████▊| 233/236 [14:49<00:09,  3.05s/it]
test ppl:  99%|█████████▉| 234/236 [14:50<00:05,  2.59s/it]
test ppl: 100%|█████████▉| 235/236 [14:56<00:03,  3.56s/it]
test ppl: 100%|██████████| 236/236 [14:57<00:00,  2.68s/it]
test ppl: 100%|██████████| 236/236 [14:57<00:00,  3.80s/it]
10/12/2024 23:11:54 - INFO - __main__ -    em: 0.1966
10/12/2024 23:11:54 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/16_0.6_60_eval_results.json
16 0.6 60:  em: 0.1966

--------------------------------------------------------------------------------
Running experiment with knn_temp=60, lmbda=0.6, k=32
2024-10-12 23:12:01.820973: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 23:12:01.840614: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 23:12:01.862576: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 23:12:01.869302: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 23:12:01.885364: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 23:12:02.874175: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 23:12:04 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.6, knn_temp=60, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 23:12:04 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:50:24,  2.18it/s]
Adding feature api:   3%|▎         | 6447/187062 [00:00<00:11, 15306.33it/s]
Adding feature api:   7%|▋         | 13623/187062 [00:00<00:05, 29604.33it/s]
Adding feature api:  11%|█         | 21043/187062 [00:00<00:04, 41452.54it/s]
Adding feature api:  15%|█▌        | 28520/187062 [00:00<00:03, 50617.68it/s]
Adding feature api:  19%|█▉        | 36012/187062 [00:00<00:02, 57473.24it/s]
Adding feature api:  23%|██▎       | 43308/187062 [00:01<00:02, 61920.94it/s]
Adding feature api:  27%|██▋       | 50804/187062 [00:01<00:02, 65713.53it/s]
Adding feature api:  31%|███       | 58354/187062 [00:01<00:01, 68584.46it/s]
Adding feature api:  35%|███▌      | 65857/187062 [00:01<00:01, 70487.32it/s]
Adding feature api:  39%|███▉      | 73383/187062 [00:01<00:01, 71901.60it/s]
Adding feature api:  43%|████▎     | 80797/187062 [00:01<00:01, 72350.00it/s]
Adding feature api:  47%|████▋     | 88293/187062 [00:01<00:01, 73124.22it/s]
Adding feature api:  51%|█████     | 95814/187062 [00:01<00:01, 73743.91it/s]
Adding feature api:  55%|█████▌    | 103302/187062 [00:01<00:01, 74081.82it/s]
Adding feature api:  59%|█████▉    | 110765/187062 [00:01<00:01, 73884.54it/s]
Adding feature api:  63%|██████▎   | 118322/187062 [00:02<00:00, 74385.29it/s]
Adding feature api:  67%|██████▋   | 125871/187062 [00:02<00:00, 74714.71it/s]
Adding feature api:  71%|███████▏  | 133407/187062 [00:02<00:00, 74906.27it/s]
Adding feature api:  75%|███████▌  | 140912/187062 [00:02<00:00, 74468.44it/s]
Adding feature api:  79%|███████▉  | 148391/187062 [00:02<00:00, 74563.20it/s]
Adding feature api:  83%|████████▎ | 155898/187062 [00:02<00:00, 74712.68it/s]
Adding feature api:  87%|████████▋ | 163418/187062 [00:02<00:00, 74857.41it/s]
Adding feature api:  91%|█████████▏| 170908/187062 [00:02<00:00, 74090.79it/s]
Adding feature api:  95%|█████████▌| 178322/187062 [00:02<00:00, 71054.14it/s]
Adding feature api:  99%|█████████▉| 185455/187062 [00:03<00:00, 48154.77it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 58391.02it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:36:24,  2.20it/s]
Adding feature datatype:   3%|▎         | 6026/187062 [00:00<00:12, 14414.52it/s]
Adding feature datatype:   7%|▋         | 13208/187062 [00:00<00:05, 29034.46it/s]
Adding feature datatype:  11%|█         | 20463/187062 [00:00<00:04, 40641.85it/s]
Adding feature datatype:  15%|█▍        | 27754/187062 [00:00<00:03, 49544.85it/s]
Adding feature datatype:  19%|█▊        | 34746/187062 [00:00<00:02, 55304.25it/s]
Adding feature datatype:  22%|██▏       | 42049/187062 [00:01<00:02, 60402.44it/s]
Adding feature datatype:  26%|██▋       | 49334/187062 [00:01<00:02, 64027.47it/s]
Adding feature datatype:  30%|███       | 56621/187062 [00:01<00:01, 66623.19it/s]
Adding feature datatype:  34%|███▍      | 63709/187062 [00:01<00:01, 67682.51it/s]
Adding feature datatype:  38%|███▊      | 70991/187062 [00:01<00:01, 69202.33it/s]
Adding feature datatype:  42%|████▏     | 78241/187062 [00:01<00:01, 70179.69it/s]
Adding feature datatype:  46%|████▌     | 85507/187062 [00:01<00:01, 70915.79it/s]
Adding feature datatype:  50%|████▉     | 92795/187062 [00:01<00:01, 71500.30it/s]
Adding feature datatype:  53%|█████▎    | 100020/187062 [00:01<00:01, 71178.66it/s]
Adding feature datatype:  57%|█████▋    | 107351/187062 [00:01<00:01, 71812.65it/s]
Adding feature datatype:  61%|██████▏   | 114623/187062 [00:02<00:01, 72081.50it/s]
Adding feature datatype:  65%|██████▌   | 121930/187062 [00:02<00:00, 72374.97it/s]
Adding feature datatype:  69%|██████▉   | 129186/187062 [00:02<00:00, 71844.78it/s]
Adding feature datatype:  73%|███████▎  | 136521/187062 [00:02<00:00, 72292.11it/s]
Adding feature datatype:  77%|███████▋  | 143868/187062 [00:02<00:00, 72640.85it/s]
Adding feature datatype:  81%|████████  | 151178/187062 [00:02<00:00, 72777.53it/s]
Adding feature datatype:  85%|████████▍ | 158476/187062 [00:02<00:00, 72836.42it/s]
Adding feature datatype:  89%|████████▊ | 165788/187062 [00:02<00:00, 72918.18it/s]
Adding feature datatype:  93%|█████████▎| 173097/187062 [00:02<00:00, 72969.00it/s]
Adding feature datatype:  96%|█████████▋| 180396/187062 [00:03<00:00, 61199.55it/s]
Adding feature datatype: 100%|█████████▉| 186839/187062 [00:03<00:00, 45638.22it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 57220.91it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:21:50,  2.22it/s]
Adding feature literal:   3%|▎         | 6270/187062 [00:00<00:11, 15116.55it/s]
Adding feature literal:   7%|▋         | 13483/187062 [00:00<00:05, 29722.73it/s]
Adding feature literal:  11%|█         | 20236/187062 [00:00<00:04, 39851.50it/s]
Adding feature literal:  14%|█▍        | 26730/187062 [00:00<00:03, 46794.57it/s]
Adding feature literal:  18%|█▊        | 34005/187062 [00:00<00:02, 54147.21it/s]
Adding feature literal:  22%|██▏       | 41283/187062 [00:01<00:02, 59515.25it/s]
Adding feature literal:  26%|██▌       | 48566/187062 [00:01<00:02, 63395.57it/s]
Adding feature literal:  30%|██▉       | 55867/187062 [00:01<00:01, 66222.21it/s]
Adding feature literal:  34%|███▍      | 63216/187062 [00:01<00:01, 68370.49it/s]
Adding feature literal:  38%|███▊      | 70490/187062 [00:01<00:01, 69668.00it/s]
Adding feature literal:  42%|████▏     | 77788/187062 [00:01<00:01, 70651.86it/s]
Adding feature literal:  46%|████▌     | 85124/187062 [00:01<00:01, 71457.88it/s]
Adding feature literal:  49%|████▉     | 92400/187062 [00:01<00:01, 71844.89it/s]
Adding feature literal:  53%|█████▎    | 99691/187062 [00:01<00:01, 72161.76it/s]
Adding feature literal:  57%|█████▋    | 106959/187062 [00:01<00:01, 72034.00it/s]
Adding feature literal:  61%|██████    | 114246/187062 [00:02<00:01, 72283.16it/s]
Adding feature literal:  65%|██████▍   | 121557/187062 [00:02<00:00, 72528.42it/s]
Adding feature literal:  69%|██████▉   | 128840/187062 [00:02<00:00, 72617.03it/s]
Adding feature literal:  73%|███████▎  | 136133/187062 [00:02<00:00, 72710.03it/s]
Adding feature literal:  77%|███████▋  | 143413/187062 [00:02<00:00, 72503.47it/s]
Adding feature literal:  81%|████████  | 150696/187062 [00:02<00:00, 72598.52it/s]
Adding feature literal:  84%|████████▍ | 158008/187062 [00:02<00:00, 72753.83it/s]
Adding feature literal:  88%|████████▊ | 165298/187062 [00:02<00:00, 72794.36it/s]
Adding feature literal:  92%|█████████▏| 172622/187062 [00:02<00:00, 72925.33it/s]
Adding feature literal:  96%|█████████▌| 179917/187062 [00:03<00:00, 62709.26it/s]
Adding feature literal: 100%|█████████▉| 186441/187062 [00:03<00:00, 45859.16it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 57205.80it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:22:33,  2.22it/s]
Adding feature operator:   3%|▎         | 6280/187062 [00:00<00:11, 15134.55it/s]
Adding feature operator:   7%|▋         | 13475/187062 [00:00<00:05, 29685.18it/s]
Adding feature operator:  11%|█         | 20788/187062 [00:00<00:04, 41321.53it/s]
Adding feature operator:  15%|█▍        | 28054/187062 [00:00<00:03, 49993.30it/s]
Adding feature operator:  19%|█▉        | 35379/187062 [00:00<00:02, 56582.31it/s]
Adding feature operator:  23%|██▎       | 42595/187062 [00:01<00:02, 61068.72it/s]
Adding feature operator:  27%|██▋       | 49910/187062 [00:01<00:02, 64590.96it/s]
Adding feature operator:  31%|███       | 57239/187062 [00:01<00:01, 67146.90it/s]
Adding feature operator:  35%|███▍      | 64554/187062 [00:01<00:01, 68919.98it/s]
Adding feature operator:  38%|███▊      | 71860/187062 [00:01<00:01, 70146.65it/s]
Adding feature operator:  42%|████▏     | 79165/187062 [00:01<00:01, 71008.50it/s]
Adding feature operator:  46%|████▋     | 86529/187062 [00:01<00:01, 71792.93it/s]
Adding feature operator:  50%|█████     | 93831/187062 [00:01<00:01, 72156.82it/s]
Adding feature operator:  54%|█████▍    | 101152/187062 [00:01<00:01, 72470.21it/s]
Adding feature operator:  58%|█████▊    | 108457/187062 [00:01<00:01, 72641.74it/s]
Adding feature operator:  62%|██████▏   | 115804/187062 [00:02<00:00, 72886.60it/s]
Adding feature operator:  66%|██████▌   | 123119/187062 [00:02<00:00, 72928.52it/s]
Adding feature operator:  70%|██████▉   | 130430/187062 [00:02<00:00, 72942.54it/s]
Adding feature operator:  74%|███████▎  | 137737/187062 [00:02<00:00, 71934.94it/s]
Adding feature operator:  78%|███████▊  | 145063/187062 [00:02<00:00, 72325.36it/s]
Adding feature operator:  81%|████████▏ | 152354/187062 [00:02<00:00, 72497.43it/s]
Adding feature operator:  85%|████████▌ | 159665/187062 [00:02<00:00, 72678.89it/s]
Adding feature operator:  89%|████████▉ | 166956/187062 [00:02<00:00, 72745.34it/s]
Adding feature operator:  93%|█████████▎| 174257/187062 [00:02<00:00, 72821.64it/s]
Adding feature operator:  97%|█████████▋| 181542/187062 [00:03<00:00, 56317.45it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 57592.47it/s]
[2024-10-12 23:12:49,537] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 23:12:50 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 23:12:50 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:16, 387.25 examples/s]
Map:   1%|▏         | 83/6548 [00:00<00:32, 201.60 examples/s]
Map:   2%|▏         | 125/6548 [00:00<00:25, 253.43 examples/s]
Map:   2%|▏         | 163/6548 [00:00<00:22, 288.07 examples/s]
Map:   3%|▎         | 216/6548 [00:00<00:20, 308.33 examples/s]
Map:   4%|▍         | 251/6548 [00:00<00:19, 315.84 examples/s]
Map:   4%|▍         | 289/6548 [00:00<00:18, 331.95 examples/s]
Map:   5%|▌         | 331/6548 [00:01<00:20, 306.99 examples/s]
Map:   6%|▌         | 368/6548 [00:01<00:19, 321.85 examples/s]
Map:   6%|▋         | 421/6548 [00:01<00:16, 373.92 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:17, 341.75 examples/s]
Map:   8%|▊         | 534/6548 [00:01<00:16, 363.96 examples/s]
Map:   9%|▉         | 575/6548 [00:01<00:16, 372.01 examples/s]
Map:   9%|▉         | 622/6548 [00:01<00:17, 343.65 examples/s]
Map:  10%|█         | 668/6548 [00:02<00:18, 326.55 examples/s]
Map:  11%|█         | 713/6548 [00:02<00:16, 350.94 examples/s]
Map:  12%|█▏        | 758/6548 [00:02<00:15, 373.82 examples/s]
Map:  12%|█▏        | 813/6548 [00:02<00:13, 411.57 examples/s]
Map:  13%|█▎        | 876/6548 [00:02<00:14, 393.66 examples/s]
Map:  14%|█▍        | 932/6548 [00:02<00:15, 370.82 examples/s]
Map:  15%|█▍        | 971/6548 [00:02<00:15, 368.84 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:24, 227.09 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 252.70 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:18, 287.56 examples/s]
Map:  18%|█▊        | 1147/6548 [00:03<00:16, 328.37 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 344.89 examples/s]
Map:  19%|█▉        | 1267/6548 [00:03<00:14, 357.37 examples/s]
Map:  20%|█▉        | 1306/6548 [00:03<00:14, 355.60 examples/s]
Map:  21%|██        | 1355/6548 [00:04<00:15, 335.99 examples/s]
Map:  21%|██▏       | 1401/6548 [00:04<00:15, 322.74 examples/s]
Map:  22%|██▏       | 1436/6548 [00:04<00:17, 300.67 examples/s]
Map:  23%|██▎       | 1480/6548 [00:04<00:16, 305.32 examples/s]
Map:  23%|██▎       | 1512/6548 [00:04<00:16, 307.37 examples/s]
Map:  24%|██▎       | 1553/6548 [00:04<00:17, 292.61 examples/s]
Map:  24%|██▍       | 1591/6548 [00:04<00:15, 310.53 examples/s]
Map:  25%|██▌       | 1640/6548 [00:05<00:17, 277.87 examples/s]
Map:  26%|██▌       | 1676/6548 [00:05<00:18, 258.78 examples/s]
Map:  26%|██▌       | 1717/6548 [00:05<00:16, 285.54 examples/s]
Map:  27%|██▋       | 1761/6548 [00:05<00:14, 321.00 examples/s]
Map:  28%|██▊       | 1802/6548 [00:05<00:13, 342.12 examples/s]
Map:  28%|██▊       | 1842/6548 [00:05<00:13, 354.33 examples/s]
Map:  29%|██▉       | 1884/6548 [00:05<00:14, 319.70 examples/s]
Map:  29%|██▉       | 1919/6548 [00:05<00:14, 318.08 examples/s]
Map:  30%|██▉       | 1960/6548 [00:06<00:13, 337.48 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:20, 223.24 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:19, 236.29 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:16, 268.86 examples/s]
Map:  32%|███▏      | 2105/6548 [00:06<00:15, 280.83 examples/s]
Map:  33%|███▎      | 2142/6548 [00:06<00:17, 256.01 examples/s]
Map:  33%|███▎      | 2181/6548 [00:07<00:15, 279.76 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 287.91 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:14, 288.70 examples/s]
Map:  35%|███▌      | 2292/6548 [00:07<00:14, 296.25 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:13, 321.30 examples/s]
Map:  36%|███▋      | 2376/6548 [00:07<00:12, 321.35 examples/s]
Map:  37%|███▋      | 2418/6548 [00:07<00:12, 343.74 examples/s]
Map:  37%|███▋      | 2454/6548 [00:07<00:12, 318.15 examples/s]
Map:  38%|███▊      | 2504/6548 [00:08<00:12, 319.14 examples/s]
Map:  39%|███▉      | 2544/6548 [00:08<00:11, 337.73 examples/s]
Map:  40%|███▉      | 2594/6548 [00:08<00:10, 375.82 examples/s]
Map:  40%|████      | 2638/6548 [00:08<00:10, 389.15 examples/s]
Map:  41%|████      | 2694/6548 [00:08<00:11, 349.43 examples/s]
Map:  42%|████▏     | 2748/6548 [00:08<00:10, 351.63 examples/s]
Map:  43%|████▎     | 2789/6548 [00:08<00:10, 350.81 examples/s]
Map:  43%|████▎     | 2828/6548 [00:08<00:12, 291.85 examples/s]
Map:  44%|████▎     | 2860/6548 [00:09<00:12, 295.90 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 300.24 examples/s]
Map:  45%|████▍     | 2946/6548 [00:09<00:12, 299.47 examples/s]
Map:  46%|████▌     | 2991/6548 [00:09<00:14, 253.90 examples/s]
Map:  46%|████▌     | 3022/6548 [00:09<00:21, 167.01 examples/s]
Map:  47%|████▋     | 3058/6548 [00:10<00:17, 193.97 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:15, 217.58 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 259.42 examples/s]
Map:  49%|████▊     | 3183/6548 [00:10<00:13, 243.32 examples/s]
Map:  49%|████▉     | 3218/6548 [00:10<00:13, 238.28 examples/s]
Map:  50%|████▉     | 3252/6548 [00:10<00:12, 257.81 examples/s]
Map:  50%|█████     | 3286/6548 [00:10<00:12, 269.48 examples/s]
Map:  51%|█████     | 3330/6548 [00:11<00:10, 307.23 examples/s]
Map:  52%|█████▏    | 3380/6548 [00:11<00:11, 269.67 examples/s]
Map:  52%|█████▏    | 3424/6548 [00:11<00:11, 275.35 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 266.58 examples/s]
Map:  53%|█████▎    | 3493/6548 [00:11<00:12, 251.75 examples/s]
Map:  54%|█████▍    | 3543/6548 [00:11<00:09, 301.13 examples/s]
Map:  55%|█████▍    | 3589/6548 [00:11<00:08, 337.21 examples/s]
Map:  55%|█████▌    | 3632/6548 [00:11<00:08, 357.24 examples/s]
Map:  56%|█████▋    | 3693/6548 [00:12<00:07, 371.12 examples/s]
Map:  57%|█████▋    | 3738/6548 [00:12<00:07, 390.14 examples/s]
Map:  58%|█████▊    | 3799/6548 [00:12<00:07, 378.81 examples/s]
Map:  59%|█████▊    | 3845/6548 [00:12<00:08, 318.73 examples/s]
Map:  59%|█████▉    | 3882/6548 [00:12<00:08, 319.10 examples/s]
Map:  60%|█████▉    | 3916/6548 [00:12<00:08, 317.40 examples/s]
Map:  61%|██████    | 3973/6548 [00:13<00:07, 324.18 examples/s]
Map:  62%|██████▏   | 4030/6548 [00:13<00:10, 249.81 examples/s]
Map:  62%|██████▏   | 4079/6548 [00:13<00:08, 291.21 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 314.54 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:08, 293.88 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:13<00:07, 308.42 examples/s]
Map:  65%|██████▍   | 4252/6548 [00:13<00:06, 331.50 examples/s]
Map:  66%|██████▌   | 4292/6548 [00:14<00:06, 347.00 examples/s]
Map:  66%|██████▋   | 4342/6548 [00:14<00:05, 377.28 examples/s]
Map:  67%|██████▋   | 4398/6548 [00:14<00:05, 371.68 examples/s]
Map:  68%|██████▊   | 4440/6548 [00:14<00:05, 382.30 examples/s]
Map:  69%|██████▊   | 4489/6548 [00:14<00:05, 355.03 examples/s]
Map:  69%|██████▉   | 4531/6548 [00:14<00:06, 326.21 examples/s]
Map:  70%|██████▉   | 4573/6548 [00:14<00:05, 344.08 examples/s]
Map:  71%|███████   | 4624/6548 [00:15<00:05, 334.09 examples/s]
Map:  71%|███████▏  | 4668/6548 [00:15<00:05, 353.59 examples/s]
Map:  72%|███████▏  | 4730/6548 [00:15<00:05, 356.55 examples/s]
Map:  73%|███████▎  | 4779/6548 [00:15<00:04, 384.68 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 386.80 examples/s]
Map:  75%|███████▍  | 4886/6548 [00:15<00:04, 380.13 examples/s]
Map:  75%|███████▌  | 4932/6548 [00:15<00:04, 387.35 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:03, 398.15 examples/s]
Map:  77%|███████▋  | 5037/6548 [00:16<00:06, 244.24 examples/s]
Map:  78%|███████▊  | 5081/6548 [00:16<00:05, 252.11 examples/s]
Map:  78%|███████▊  | 5116/6548 [00:16<00:05, 269.14 examples/s]
Map:  79%|███████▉  | 5159/6548 [00:16<00:05, 268.75 examples/s]
Map:  80%|███████▉  | 5207/6548 [00:16<00:04, 280.83 examples/s]
Map:  80%|████████  | 5244/6548 [00:16<00:04, 298.22 examples/s]
Map:  81%|████████  | 5286/6548 [00:17<00:03, 320.67 examples/s]
Map:  81%|████████▏ | 5322/6548 [00:17<00:03, 328.49 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 303.41 examples/s]
Map:  83%|████████▎ | 5405/6548 [00:17<00:04, 285.65 examples/s]
Map:  83%|████████▎ | 5449/6548 [00:17<00:03, 320.33 examples/s]
Map:  84%|████████▍ | 5500/6548 [00:17<00:03, 321.46 examples/s]
Map:  85%|████████▍ | 5537/6548 [00:17<00:03, 331.13 examples/s]
Map:  85%|████████▌ | 5572/6548 [00:18<00:03, 318.88 examples/s]
Map:  86%|████████▌ | 5632/6548 [00:18<00:02, 334.48 examples/s]
Map:  87%|████████▋ | 5676/6548 [00:18<00:02, 309.08 examples/s]
Map:  87%|████████▋ | 5710/6548 [00:18<00:02, 308.64 examples/s]
Map:  88%|████████▊ | 5755/6548 [00:18<00:02, 340.04 examples/s]
Map:  88%|████████▊ | 5794/6548 [00:18<00:02, 348.44 examples/s]
Map:  89%|████████▉ | 5845/6548 [00:18<00:02, 338.31 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:18<00:01, 346.41 examples/s]
Map:  90%|█████████ | 5921/6548 [00:19<00:01, 351.01 examples/s]
Map:  91%|█████████ | 5964/6548 [00:19<00:01, 322.45 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 216.02 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:02, 249.82 examples/s]
Map:  93%|█████████▎| 6073/6548 [00:19<00:01, 264.14 examples/s]
Map:  93%|█████████▎| 6117/6548 [00:19<00:01, 260.52 examples/s]
Map:  94%|█████████▍| 6155/6548 [00:19<00:01, 285.38 examples/s]
Map:  95%|█████████▍| 6209/6548 [00:20<00:01, 307.22 examples/s]
Map:  96%|█████████▌| 6260/6548 [00:20<00:00, 313.73 examples/s]
Map:  96%|█████████▌| 6301/6548 [00:20<00:00, 333.15 examples/s]
Map:  97%|█████████▋| 6342/6548 [00:20<00:00, 309.98 examples/s]
Map:  98%|█████████▊| 6386/6548 [00:20<00:00, 335.55 examples/s]
Map:  98%|█████████▊| 6426/6548 [00:20<00:00, 349.92 examples/s]
Map:  99%|█████████▉| 6475/6548 [00:20<00:00, 384.17 examples/s]
Map: 100%|█████████▉| 6529/6548 [00:21<00:00, 363.49 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 309.04 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▎         | 33/903 [00:00<00:02, 307.33 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 340.02 examples/s]
Map:  13%|█▎        | 119/903 [00:00<00:02, 327.92 examples/s]
Map:  18%|█▊        | 163/903 [00:00<00:02, 363.87 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 389.99 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 394.46 examples/s]
Map:  34%|███▍      | 310/903 [00:00<00:01, 378.37 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 316.89 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 289.80 examples/s]
Map:  50%|████▉     | 450/903 [00:01<00:01, 276.26 examples/s]
Map:  54%|█████▍    | 486/903 [00:01<00:01, 280.39 examples/s]
Map:  59%|█████▉    | 534/903 [00:01<00:01, 323.10 examples/s]
Map:  63%|██████▎   | 572/903 [00:01<00:00, 335.06 examples/s]
Map:  68%|██████▊   | 614/903 [00:01<00:00, 341.87 examples/s]
Map:  72%|███████▏  | 652/903 [00:01<00:00, 350.44 examples/s]
Map:  77%|███████▋  | 696/903 [00:02<00:00, 366.76 examples/s]
Map:  82%|████████▏ | 741/903 [00:02<00:00, 388.92 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 385.29 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 385.04 examples/s]
Map:  97%|█████████▋| 875/903 [00:02<00:00, 359.66 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 314.31 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 291.29 examples/s]
Map:   4%|▍         | 81/1882 [00:00<00:05, 357.30 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 345.75 examples/s]
Map:   9%|▊         | 161/1882 [00:00<00:04, 367.85 examples/s]
Map:  11%|█         | 199/1882 [00:00<00:04, 368.95 examples/s]
Map:  13%|█▎        | 239/1882 [00:00<00:04, 375.33 examples/s]
Map:  15%|█▍        | 280/1882 [00:00<00:04, 379.05 examples/s]
Map:  18%|█▊        | 334/1882 [00:00<00:04, 361.27 examples/s]
Map:  20%|█▉        | 376/1882 [00:01<00:04, 319.87 examples/s]
Map:  22%|██▏       | 422/1882 [00:01<00:04, 307.37 examples/s]
Map:  24%|██▍       | 454/1882 [00:01<00:04, 308.93 examples/s]
Map:  27%|██▋       | 500/1882 [00:01<00:04, 336.62 examples/s]
Map:  29%|██▉       | 549/1882 [00:01<00:04, 319.65 examples/s]
Map:  32%|███▏      | 595/1882 [00:01<00:03, 351.55 examples/s]
Map:  35%|███▍      | 651/1882 [00:01<00:03, 400.51 examples/s]
Map:  38%|███▊      | 706/1882 [00:01<00:03, 382.40 examples/s]
Map:  40%|███▉      | 746/1882 [00:02<00:02, 385.84 examples/s]
Map:  42%|████▏     | 797/1882 [00:02<00:02, 364.17 examples/s]
Map:  45%|████▌     | 853/1882 [00:02<00:02, 360.22 examples/s]
Map:  48%|████▊     | 896/1882 [00:02<00:02, 376.42 examples/s]
Map:  50%|████▉     | 937/1882 [00:02<00:02, 382.60 examples/s]
Map:  52%|█████▏    | 983/1882 [00:02<00:02, 398.50 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 248.76 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 262.26 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 274.19 examples/s]
Map:  61%|██████    | 1147/1882 [00:03<00:02, 269.08 examples/s]
Map:  63%|██████▎   | 1189/1882 [00:03<00:02, 266.88 examples/s]
Map:  65%|██████▌   | 1229/1882 [00:03<00:02, 294.22 examples/s]
Map:  68%|██████▊   | 1274/1882 [00:03<00:02, 294.88 examples/s]
Map:  70%|██████▉   | 1317/1882 [00:03<00:01, 323.97 examples/s]
Map:  72%|███████▏  | 1363/1882 [00:04<00:01, 311.10 examples/s]
Map:  75%|███████▌  | 1412/1882 [00:04<00:01, 309.31 examples/s]
Map:  78%|███████▊  | 1469/1882 [00:04<00:01, 287.55 examples/s]
Map:  80%|███████▉  | 1503/1882 [00:04<00:01, 260.22 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 260.12 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:04<00:01, 285.92 examples/s]
Map:  86%|████████▋ | 1625/1882 [00:05<00:00, 315.20 examples/s]
Map:  89%|████████▊ | 1667/1882 [00:05<00:00, 289.12 examples/s]
Map:  91%|█████████ | 1713/1882 [00:05<00:00, 325.67 examples/s]
Map:  93%|█████████▎| 1749/1882 [00:05<00:00, 281.40 examples/s]
Map:  95%|█████████▍| 1787/1882 [00:05<00:00, 266.74 examples/s]
Map:  97%|█████████▋| 1832/1882 [00:05<00:00, 305.63 examples/s]
Map: 100%|█████████▉| 1875/1882 [00:05<00:00, 335.26 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 307.84 examples/s]
10/12/2024 23:13:53 - INFO - __main__ -     ***** Testing *****
10/12/2024 23:13:53 - INFO - __main__ -     Batch size = 8
10/12/2024 23:13:53 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 23:13:54 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 23:13:54 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 23:13:55 - INFO - knnlm -   Reading datastore took 0.900299072265625 s
10/12/2024 23:13:56 - INFO - knnlm -   Moving index to GPU took 0.91440749168396 s
10/12/2024 23:13:56 - INFO - __main__ -   ******************************break-into
10/12/2024 23:13:56 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 23:13:56 - INFO - __main__ -     Num examples = 236
10/12/2024 23:13:56 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<31:24,  8.02s/it]
test ppl:   1%|          | 2/236 [00:09<16:59,  4.36s/it]
test ppl:   1%|▏         | 3/236 [00:12<13:46,  3.55s/it]
test ppl:   2%|▏         | 4/236 [00:14<10:54,  2.82s/it]
test ppl:   2%|▏         | 5/236 [00:19<15:06,  3.92s/it]
test ppl:   3%|▎         | 6/236 [00:25<17:38,  4.60s/it]
test ppl:   3%|▎         | 7/236 [00:27<14:13,  3.73s/it]
test ppl:   3%|▎         | 8/236 [00:33<16:02,  4.22s/it]
test ppl:   4%|▍         | 9/236 [00:35<13:29,  3.56s/it]
test ppl:   4%|▍         | 10/236 [00:38<13:26,  3.57s/it]
test ppl:   5%|▍         | 11/236 [00:40<11:38,  3.10s/it]
test ppl:   5%|▌         | 12/236 [00:46<14:46,  3.96s/it]
test ppl:   6%|▌         | 13/236 [00:50<14:48,  3.99s/it]
test ppl:   6%|▌         | 14/236 [00:56<16:55,  4.57s/it]
test ppl:   6%|▋         | 15/236 [00:58<13:12,  3.58s/it]
test ppl:   7%|▋         | 16/236 [00:59<11:08,  3.04s/it]
test ppl:   7%|▋         | 17/236 [01:05<14:14,  3.90s/it]
test ppl:   8%|▊         | 18/236 [01:08<12:36,  3.47s/it]
test ppl:   8%|▊         | 19/236 [01:14<15:11,  4.20s/it]
test ppl:   8%|▊         | 20/236 [01:16<13:22,  3.71s/it]
test ppl:   9%|▉         | 21/236 [01:19<12:29,  3.49s/it]
test ppl:   9%|▉         | 22/236 [01:25<15:02,  4.22s/it]
test ppl:  10%|▉         | 23/236 [01:28<13:11,  3.72s/it]
test ppl:  10%|█         | 24/236 [01:30<11:32,  3.27s/it]
test ppl:  11%|█         | 25/236 [01:36<14:17,  4.06s/it]
test ppl:  11%|█         | 26/236 [01:42<16:10,  4.62s/it]
test ppl:  11%|█▏        | 27/236 [01:45<14:53,  4.27s/it]
test ppl:  12%|█▏        | 28/236 [01:46<11:37,  3.35s/it]
test ppl:  12%|█▏        | 29/236 [01:49<10:30,  3.04s/it]
test ppl:  13%|█▎        | 30/236 [01:50<08:55,  2.60s/it]
test ppl:  13%|█▎        | 31/236 [01:52<08:16,  2.42s/it]
test ppl:  14%|█▎        | 32/236 [01:56<09:19,  2.74s/it]
test ppl:  14%|█▍        | 33/236 [01:58<09:00,  2.66s/it]
test ppl:  14%|█▍        | 34/236 [02:02<10:21,  3.07s/it]
test ppl:  15%|█▍        | 35/236 [02:05<09:46,  2.92s/it]
test ppl:  15%|█▌        | 36/236 [02:11<12:44,  3.82s/it]
test ppl:  16%|█▌        | 37/236 [02:17<14:47,  4.46s/it]
test ppl:  16%|█▌        | 38/236 [02:19<12:21,  3.75s/it]
test ppl:  17%|█▋        | 39/236 [02:20<10:20,  3.15s/it]
test ppl:  17%|█▋        | 40/236 [02:22<08:32,  2.62s/it]
test ppl:  17%|█▋        | 41/236 [02:24<07:46,  2.39s/it]
test ppl:  18%|█▊        | 42/236 [02:30<11:11,  3.46s/it]
test ppl:  18%|█▊        | 43/236 [02:36<13:31,  4.20s/it]
test ppl:  19%|█▊        | 44/236 [02:38<11:41,  3.65s/it]
test ppl:  19%|█▉        | 45/236 [02:40<09:54,  3.11s/it]
test ppl:  19%|█▉        | 46/236 [02:46<12:34,  3.97s/it]
test ppl:  20%|█▉        | 47/236 [02:47<10:12,  3.24s/it]
test ppl:  20%|██        | 48/236 [02:54<12:58,  4.14s/it]
test ppl:  21%|██        | 49/236 [02:57<12:15,  3.93s/it]
test ppl:  21%|██        | 50/236 [03:03<14:08,  4.56s/it]
test ppl:  22%|██▏       | 51/236 [03:09<15:22,  4.98s/it]
test ppl:  22%|██▏       | 52/236 [03:15<16:09,  5.27s/it]
test ppl:  22%|██▏       | 53/236 [03:21<16:41,  5.47s/it]
test ppl:  23%|██▎       | 54/236 [03:22<13:02,  4.30s/it]
test ppl:  23%|██▎       | 55/236 [03:28<14:14,  4.72s/it]
test ppl:  24%|██▎       | 56/236 [03:32<13:00,  4.33s/it]
test ppl:  24%|██▍       | 57/236 [03:34<11:08,  3.74s/it]
test ppl:  25%|██▍       | 58/236 [03:36<09:49,  3.31s/it]
test ppl:  25%|██▌       | 59/236 [03:42<12:05,  4.10s/it]
test ppl:  25%|██▌       | 60/236 [03:45<11:03,  3.77s/it]
test ppl:  26%|██▌       | 61/236 [03:51<12:53,  4.42s/it]
test ppl:  26%|██▋       | 62/236 [03:57<14:07,  4.87s/it]
test ppl:  27%|██▋       | 63/236 [04:00<11:58,  4.16s/it]
test ppl:  27%|██▋       | 64/236 [04:01<09:40,  3.38s/it]
test ppl:  28%|██▊       | 65/236 [04:02<07:52,  2.77s/it]
test ppl:  28%|██▊       | 66/236 [04:06<08:04,  2.85s/it]
test ppl:  28%|██▊       | 67/236 [04:11<10:37,  3.77s/it]
test ppl:  29%|██▉       | 68/236 [04:17<12:23,  4.42s/it]
test ppl:  29%|██▉       | 69/236 [04:23<13:34,  4.88s/it]
test ppl:  30%|██▉       | 70/236 [04:29<14:20,  5.18s/it]
test ppl:  30%|███       | 71/236 [04:33<13:15,  4.82s/it]
test ppl:  31%|███       | 72/236 [04:36<11:24,  4.18s/it]
test ppl:  31%|███       | 73/236 [04:42<12:45,  4.70s/it]
test ppl:  31%|███▏      | 74/236 [04:43<10:06,  3.74s/it]
test ppl:  32%|███▏      | 75/236 [04:49<11:47,  4.39s/it]
test ppl:  32%|███▏      | 76/236 [04:52<10:34,  3.97s/it]
test ppl:  33%|███▎      | 77/236 [04:54<09:10,  3.46s/it]
test ppl:  33%|███▎      | 78/236 [04:56<07:46,  2.95s/it]
test ppl:  33%|███▎      | 79/236 [05:00<08:30,  3.25s/it]
test ppl:  34%|███▍      | 80/236 [05:02<07:10,  2.76s/it]
test ppl:  34%|███▍      | 81/236 [05:08<09:35,  3.71s/it]
test ppl:  35%|███▍      | 82/236 [05:14<11:15,  4.39s/it]
test ppl:  35%|███▌      | 83/236 [05:17<10:17,  4.04s/it]
test ppl:  36%|███▌      | 84/236 [05:19<08:47,  3.47s/it]
test ppl:  36%|███▌      | 85/236 [05:23<09:20,  3.71s/it]
test ppl:  36%|███▋      | 86/236 [05:25<07:43,  3.09s/it]
test ppl:  37%|███▋      | 87/236 [05:27<06:56,  2.79s/it]
test ppl:  37%|███▋      | 88/236 [05:33<09:11,  3.73s/it]
test ppl:  38%|███▊      | 89/236 [05:35<07:50,  3.20s/it]
test ppl:  38%|███▊      | 90/236 [05:41<09:46,  4.02s/it]
test ppl:  39%|███▊      | 91/236 [05:46<10:23,  4.30s/it]
test ppl:  39%|███▉      | 92/236 [05:49<09:15,  3.86s/it]
test ppl:  39%|███▉      | 93/236 [05:55<10:40,  4.48s/it]
test ppl:  40%|███▉      | 94/236 [06:00<11:32,  4.87s/it]
test ppl:  40%|████      | 95/236 [06:03<09:52,  4.20s/it]
test ppl:  41%|████      | 96/236 [06:06<08:55,  3.82s/it]
test ppl:  41%|████      | 97/236 [06:12<10:18,  4.45s/it]
test ppl:  42%|████▏     | 98/236 [06:18<11:15,  4.89s/it]
test ppl:  42%|████▏     | 99/236 [06:24<11:53,  5.21s/it]
test ppl:  42%|████▏     | 100/236 [06:25<09:06,  4.02s/it]
test ppl:  43%|████▎     | 101/236 [06:31<10:19,  4.59s/it]
test ppl:  43%|████▎     | 102/236 [06:35<09:50,  4.40s/it]
test ppl:  44%|████▎     | 103/236 [06:36<07:47,  3.51s/it]
test ppl:  44%|████▍     | 104/236 [06:41<08:13,  3.74s/it]
test ppl:  44%|████▍     | 105/236 [06:45<08:18,  3.81s/it]
test ppl:  45%|████▍     | 106/236 [06:50<09:18,  4.29s/it]
test ppl:  45%|████▌     | 107/236 [06:52<07:57,  3.70s/it]
test ppl:  46%|████▌     | 108/236 [06:56<07:46,  3.64s/it]
test ppl:  46%|████▌     | 109/236 [07:01<08:46,  4.14s/it]
test ppl:  47%|████▋     | 110/236 [07:03<07:05,  3.38s/it]
test ppl:  47%|████▋     | 111/236 [07:07<07:41,  3.69s/it]
test ppl:  47%|████▋     | 112/236 [07:12<08:26,  4.08s/it]
test ppl:  48%|████▊     | 113/236 [07:14<06:57,  3.39s/it]
test ppl:  48%|████▊     | 114/236 [07:18<07:06,  3.49s/it]
test ppl:  49%|████▊     | 115/236 [07:24<08:30,  4.22s/it]
test ppl:  49%|████▉     | 116/236 [07:29<09:26,  4.72s/it]
test ppl:  50%|████▉     | 117/236 [07:31<07:42,  3.89s/it]
test ppl:  50%|█████     | 118/236 [07:37<08:24,  4.28s/it]
test ppl:  50%|█████     | 119/236 [07:39<07:05,  3.64s/it]
test ppl:  51%|█████     | 120/236 [07:40<05:47,  3.00s/it]
test ppl:  51%|█████▏    | 121/236 [07:43<05:31,  2.89s/it]
test ppl:  52%|█████▏    | 122/236 [07:49<07:11,  3.78s/it]
test ppl:  52%|█████▏    | 123/236 [07:51<06:11,  3.29s/it]
test ppl:  53%|█████▎    | 124/236 [07:53<05:42,  3.06s/it]
test ppl:  53%|█████▎    | 125/236 [07:59<07:13,  3.91s/it]
test ppl:  53%|█████▎    | 126/236 [08:04<07:39,  4.17s/it]
test ppl:  54%|█████▍    | 127/236 [08:06<06:20,  3.49s/it]
test ppl:  54%|█████▍    | 128/236 [08:08<05:24,  3.01s/it]
test ppl:  55%|█████▍    | 129/236 [08:11<05:16,  2.96s/it]
test ppl:  55%|█████▌    | 130/236 [08:14<05:18,  3.01s/it]
test ppl:  56%|█████▌    | 131/236 [08:21<07:23,  4.23s/it]
test ppl:  56%|█████▌    | 132/236 [08:28<08:47,  5.07s/it]
test ppl:  56%|█████▋    | 133/236 [08:33<08:29,  4.95s/it]
test ppl:  57%|█████▋    | 134/236 [08:37<07:58,  4.69s/it]
test ppl:  57%|█████▋    | 135/236 [08:44<09:05,  5.40s/it]
test ppl:  58%|█████▊    | 136/236 [08:45<07:05,  4.25s/it]
test ppl:  58%|█████▊    | 137/236 [08:52<08:24,  5.10s/it]
test ppl:  58%|█████▊    | 138/236 [08:57<07:58,  4.88s/it]
test ppl:  59%|█████▉    | 139/236 [09:00<07:07,  4.41s/it]
test ppl:  59%|█████▉    | 140/236 [09:02<05:54,  3.70s/it]
test ppl:  60%|█████▉    | 141/236 [09:07<06:17,  3.97s/it]
test ppl:  60%|██████    | 142/236 [09:09<05:33,  3.55s/it]
test ppl:  61%|██████    | 143/236 [09:14<06:09,  3.97s/it]
test ppl:  61%|██████    | 144/236 [09:17<05:45,  3.76s/it]
test ppl:  61%|██████▏   | 145/236 [09:22<06:14,  4.11s/it]
test ppl:  62%|██████▏   | 146/236 [09:28<07:03,  4.71s/it]
test ppl:  62%|██████▏   | 147/236 [09:36<08:02,  5.42s/it]
test ppl:  63%|██████▎   | 148/236 [09:43<08:43,  5.94s/it]
test ppl:  63%|██████▎   | 149/236 [09:50<09:06,  6.28s/it]
test ppl:  64%|██████▎   | 150/236 [09:57<09:21,  6.53s/it]
test ppl:  64%|██████▍   | 151/236 [10:04<09:34,  6.76s/it]
test ppl:  64%|██████▍   | 152/236 [10:11<09:40,  6.92s/it]
test ppl:  65%|██████▍   | 153/236 [10:19<09:43,  7.03s/it]
test ppl:  65%|██████▌   | 154/236 [10:21<07:27,  5.45s/it]
test ppl:  66%|██████▌   | 155/236 [10:24<06:28,  4.80s/it]
test ppl:  66%|██████▌   | 156/236 [10:27<05:39,  4.24s/it]
test ppl:  67%|██████▋   | 157/236 [10:30<04:59,  3.79s/it]
test ppl:  67%|██████▋   | 158/236 [10:37<06:17,  4.84s/it]
test ppl:  67%|██████▋   | 159/236 [10:44<07:09,  5.58s/it]
test ppl:  68%|██████▊   | 160/236 [10:46<05:29,  4.33s/it]
test ppl:  68%|██████▊   | 161/236 [10:47<04:24,  3.52s/it]
test ppl:  69%|██████▊   | 162/236 [10:51<04:28,  3.63s/it]
test ppl:  69%|██████▉   | 163/236 [10:54<04:14,  3.49s/it]
test ppl:  69%|██████▉   | 164/236 [10:59<04:43,  3.93s/it]
test ppl:  70%|██████▉   | 165/236 [11:04<05:03,  4.27s/it]
test ppl:  70%|███████   | 166/236 [11:06<04:08,  3.54s/it]
test ppl:  71%|███████   | 167/236 [11:08<03:28,  3.03s/it]
test ppl:  71%|███████   | 168/236 [11:15<04:54,  4.33s/it]
test ppl:  72%|███████▏  | 169/236 [11:21<05:10,  4.64s/it]
test ppl:  72%|███████▏  | 170/236 [11:28<05:59,  5.45s/it]
test ppl:  72%|███████▏  | 171/236 [11:30<04:40,  4.31s/it]
test ppl:  73%|███████▎  | 172/236 [11:37<05:29,  5.15s/it]
test ppl:  73%|███████▎  | 173/236 [11:41<05:08,  4.89s/it]
test ppl:  74%|███████▎  | 174/236 [11:48<05:43,  5.54s/it]
test ppl:  74%|███████▍  | 175/236 [11:55<06:05,  6.00s/it]
test ppl:  75%|███████▍  | 176/236 [12:02<06:18,  6.30s/it]
test ppl:  75%|███████▌  | 177/236 [12:09<06:25,  6.53s/it]
test ppl:  75%|███████▌  | 178/236 [12:15<06:11,  6.41s/it]
test ppl:  76%|███████▌  | 179/236 [12:22<06:07,  6.44s/it]
test ppl:  76%|███████▋  | 180/236 [12:28<05:53,  6.32s/it]
test ppl:  77%|███████▋  | 181/236 [12:34<05:42,  6.22s/it]
test ppl:  77%|███████▋  | 182/236 [12:36<04:32,  5.04s/it]
test ppl:  78%|███████▊  | 183/236 [12:38<03:37,  4.10s/it]
test ppl:  78%|███████▊  | 184/236 [12:40<02:54,  3.35s/it]
test ppl:  78%|███████▊  | 185/236 [12:44<03:08,  3.70s/it]
test ppl:  79%|███████▉  | 186/236 [12:47<02:44,  3.28s/it]
test ppl:  79%|███████▉  | 187/236 [12:49<02:21,  2.89s/it]
test ppl:  80%|███████▉  | 188/236 [12:56<03:18,  4.14s/it]
test ppl:  80%|████████  | 189/236 [13:03<03:55,  5.01s/it]
test ppl:  81%|████████  | 190/236 [13:08<03:51,  5.04s/it]
test ppl:  81%|████████  | 191/236 [13:12<03:39,  4.88s/it]
test ppl:  81%|████████▏ | 192/236 [13:16<03:14,  4.43s/it]
test ppl:  82%|████████▏ | 193/236 [13:23<03:44,  5.21s/it]
test ppl:  82%|████████▏ | 194/236 [13:26<03:12,  4.59s/it]
test ppl:  83%|████████▎ | 195/236 [13:29<02:56,  4.31s/it]
test ppl:  83%|████████▎ | 196/236 [13:32<02:29,  3.74s/it]
test ppl:  83%|████████▎ | 197/236 [13:39<03:04,  4.73s/it]
test ppl:  84%|████████▍ | 198/236 [13:46<03:25,  5.42s/it]
test ppl:  84%|████████▍ | 199/236 [13:49<02:57,  4.80s/it]
test ppl:  85%|████████▍ | 200/236 [13:56<03:16,  5.47s/it]
test ppl:  85%|████████▌ | 201/236 [13:59<02:46,  4.76s/it]
test ppl:  86%|████████▌ | 202/236 [14:05<02:53,  5.10s/it]
test ppl:  86%|████████▌ | 203/236 [14:11<02:56,  5.34s/it]
test ppl:  86%|████████▋ | 204/236 [14:13<02:16,  4.26s/it]
test ppl:  87%|████████▋ | 205/236 [14:19<02:27,  4.77s/it]
test ppl:  87%|████████▋ | 206/236 [14:22<02:09,  4.32s/it]
test ppl:  88%|████████▊ | 207/236 [14:28<02:18,  4.78s/it]
test ppl:  88%|████████▊ | 208/236 [14:31<01:56,  4.18s/it]
test ppl:  89%|████████▊ | 209/236 [14:37<02:07,  4.71s/it]
test ppl:  89%|████████▉ | 210/236 [14:39<01:44,  4.01s/it]
test ppl:  89%|████████▉ | 211/236 [14:44<01:45,  4.23s/it]
test ppl:  90%|████████▉ | 212/236 [14:50<01:53,  4.72s/it]
test ppl:  90%|█████████ | 213/236 [14:56<01:56,  5.06s/it]
test ppl:  91%|█████████ | 214/236 [14:57<01:26,  3.94s/it]
test ppl:  91%|█████████ | 215/236 [15:03<01:35,  4.53s/it]
test ppl:  92%|█████████▏| 216/236 [15:04<01:13,  3.67s/it]
test ppl:  92%|█████████▏| 217/236 [15:10<01:20,  4.26s/it]
test ppl:  92%|█████████▏| 218/236 [15:12<01:04,  3.56s/it]
test ppl:  93%|█████████▎| 219/236 [15:18<01:12,  4.27s/it]
test ppl:  93%|█████████▎| 220/236 [15:24<01:16,  4.76s/it]
test ppl:  94%|█████████▎| 221/236 [15:26<00:57,  3.85s/it]
test ppl:  94%|█████████▍| 222/236 [15:31<01:02,  4.47s/it]
test ppl:  94%|█████████▍| 223/236 [15:37<01:03,  4.89s/it]
test ppl:  95%|█████████▍| 224/236 [15:40<00:50,  4.19s/it]
test ppl:  95%|█████████▌| 225/236 [15:44<00:46,  4.20s/it]
test ppl:  96%|█████████▌| 226/236 [15:46<00:35,  3.59s/it]
test ppl:  96%|█████████▌| 227/236 [15:49<00:30,  3.34s/it]
test ppl:  97%|█████████▋| 228/236 [15:51<00:22,  2.84s/it]
test ppl:  97%|█████████▋| 229/236 [15:57<00:26,  3.75s/it]
test ppl:  97%|█████████▋| 230/236 [16:01<00:23,  3.89s/it]
test ppl:  98%|█████████▊| 231/236 [16:04<00:18,  3.76s/it]
test ppl:  98%|█████████▊| 232/236 [16:06<00:12,  3.19s/it]
test ppl:  99%|█████████▊| 233/236 [16:09<00:09,  3.10s/it]
test ppl:  99%|█████████▉| 234/236 [16:10<00:05,  2.53s/it]
test ppl: 100%|█████████▉| 235/236 [16:16<00:03,  3.54s/it]
test ppl: 100%|██████████| 236/236 [16:17<00:00,  2.67s/it]
test ppl: 100%|██████████| 236/236 [16:17<00:00,  4.14s/it]
10/12/2024 23:30:13 - INFO - __main__ -    em: 0.2030
10/12/2024 23:30:13 - INFO - __main__ -   Finish and take 18m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/32_0.6_60_eval_results.json
32 0.6 60:  em: 0.2030

--------------------------------------------------------------------------------
Running experiment with knn_temp=60, lmbda=0.6, k=64
2024-10-12 23:30:20.310813: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 23:30:20.330105: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 23:30:20.351783: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 23:30:20.358345: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 23:30:20.374171: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 23:30:21.367812: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 23:30:22 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.6, knn_temp=60, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 23:30:22 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:52:09,  2.18it/s]
Adding feature api:   3%|▎         | 6265/187062 [00:00<00:12, 14860.57it/s]
Adding feature api:   7%|▋         | 13494/187062 [00:00<00:05, 29395.80it/s]
Adding feature api:  11%|█         | 20545/187062 [00:00<00:04, 40312.68it/s]
Adding feature api:  15%|█▍        | 27778/187062 [00:00<00:03, 49116.37it/s]
Adding feature api:  19%|█▉        | 35077/187062 [00:00<00:02, 55849.32it/s]
Adding feature api:  23%|██▎       | 42337/187062 [00:01<00:02, 60658.47it/s]
Adding feature api:  26%|██▋       | 49430/187062 [00:01<00:02, 63643.99it/s]
Adding feature api:  30%|███       | 56697/187062 [00:01<00:01, 66292.47it/s]
Adding feature api:  34%|███▍      | 63934/187062 [00:01<00:01, 68085.36it/s]
Adding feature api:  38%|███▊      | 71203/187062 [00:01<00:01, 69449.42it/s]
Adding feature api:  42%|████▏     | 78364/187062 [00:01<00:01, 69993.23it/s]
Adding feature api:  46%|████▌     | 85691/187062 [00:01<00:01, 70969.63it/s]
Adding feature api:  50%|████▉     | 93028/187062 [00:01<00:01, 71683.64it/s]
Adding feature api:  54%|█████▎    | 100310/187062 [00:01<00:01, 72021.76it/s]
Adding feature api:  58%|█████▊    | 107639/187062 [00:01<00:01, 72399.82it/s]
Adding feature api:  61%|██████▏   | 114917/187062 [00:02<00:01, 72056.61it/s]
Adding feature api:  65%|██████▌   | 122207/187062 [00:02<00:00, 72306.56it/s]
Adding feature api:  69%|██████▉   | 129457/187062 [00:02<00:00, 72140.34it/s]
Adding feature api:  73%|███████▎  | 136757/187062 [00:02<00:00, 72395.04it/s]
Adding feature api:  77%|███████▋  | 144006/187062 [00:02<00:00, 72153.13it/s]
Adding feature api:  81%|████████  | 151291/187062 [00:02<00:00, 72360.39it/s]
Adding feature api:  85%|████████▍ | 158611/187062 [00:02<00:00, 72610.01it/s]
Adding feature api:  89%|████████▊ | 165939/187062 [00:02<00:00, 72808.60it/s]
Adding feature api:  93%|█████████▎| 173223/187062 [00:02<00:00, 72172.24it/s]
Adding feature api:  96%|█████████▋| 180444/187062 [00:03<00:00, 60718.35it/s]
Adding feature api: 100%|█████████▉| 186824/187062 [00:03<00:00, 45532.29it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 57163.90it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:36:29,  2.20it/s]
Adding feature datatype:   3%|▎         | 5888/187062 [00:00<00:12, 14083.53it/s]
Adding feature datatype:   7%|▋         | 12868/187062 [00:00<00:06, 28273.14it/s]
Adding feature datatype:  11%|█         | 19933/187062 [00:00<00:04, 39577.03it/s]
Adding feature datatype:  14%|█▍        | 27001/187062 [00:00<00:03, 48158.43it/s]
Adding feature datatype:  18%|█▊        | 33817/187062 [00:00<00:02, 53812.32it/s]
Adding feature datatype:  22%|██▏       | 40975/187062 [00:01<00:02, 58922.75it/s]
Adding feature datatype:  26%|██▌       | 47983/187062 [00:01<00:02, 62170.63it/s]
Adding feature datatype:  29%|██▉       | 55084/187062 [00:01<00:02, 64767.45it/s]
Adding feature datatype:  33%|███▎      | 62042/187062 [00:01<00:01, 65964.94it/s]
Adding feature datatype:  37%|███▋      | 69153/187062 [00:01<00:01, 67485.38it/s]
Adding feature datatype:  41%|████      | 76304/187062 [00:01<00:01, 68681.17it/s]
Adding feature datatype:  45%|████▍     | 83456/187062 [00:01<00:01, 69524.71it/s]
Adding feature datatype:  48%|████▊     | 90600/187062 [00:01<00:01, 70096.35it/s]
Adding feature datatype:  52%|█████▏    | 97683/187062 [00:01<00:01, 69691.53it/s]
Adding feature datatype:  56%|█████▌    | 104810/187062 [00:01<00:01, 70160.08it/s]
Adding feature datatype:  60%|█████▉    | 111938/187062 [00:02<00:01, 70493.49it/s]
Adding feature datatype:  64%|██████▎   | 119046/187062 [00:02<00:00, 70666.57it/s]
Adding feature datatype:  67%|██████▋   | 126131/187062 [00:02<00:00, 69941.29it/s]
Adding feature datatype:  71%|███████   | 133278/187062 [00:02<00:00, 70394.64it/s]
Adding feature datatype:  75%|███████▌  | 140346/187062 [00:02<00:00, 70478.68it/s]
Adding feature datatype:  79%|███████▉  | 147483/187062 [00:02<00:00, 70743.14it/s]
Adding feature datatype:  83%|████████▎ | 154563/187062 [00:02<00:00, 70493.79it/s]
Adding feature datatype:  86%|████████▋ | 161737/187062 [00:02<00:00, 70865.14it/s]
Adding feature datatype:  90%|█████████ | 168885/187062 [00:02<00:00, 71048.26it/s]
Adding feature datatype:  94%|█████████▍| 176002/187062 [00:02<00:00, 71083.39it/s]
Adding feature datatype:  98%|█████████▊| 183112/187062 [00:03<00:00, 49979.36it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 56105.88it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:24:49,  2.22it/s]
Adding feature literal:   3%|▎         | 6087/187062 [00:00<00:12, 14651.40it/s]
Adding feature literal:   7%|▋         | 13038/187062 [00:00<00:06, 28688.15it/s]
Adding feature literal:  11%|█         | 20080/187062 [00:00<00:04, 39858.09it/s]
Adding feature literal:  15%|█▍        | 27127/187062 [00:00<00:03, 48324.59it/s]
Adding feature literal:  18%|█▊        | 34219/187062 [00:00<00:02, 54722.05it/s]
Adding feature literal:  22%|██▏       | 41275/187062 [00:01<00:02, 59283.93it/s]
Adding feature literal:  26%|██▌       | 48339/187062 [00:01<00:02, 62593.88it/s]
Adding feature literal:  30%|██▉       | 55454/187062 [00:01<00:02, 65107.23it/s]
Adding feature literal:  33%|███▎      | 62598/187062 [00:01<00:01, 66977.97it/s]
Adding feature literal:  37%|███▋      | 69729/187062 [00:01<00:01, 68263.27it/s]
Adding feature literal:  41%|████      | 76857/187062 [00:01<00:01, 69160.09it/s]
Adding feature literal:  45%|████▍     | 83960/187062 [00:01<00:01, 69717.04it/s]
Adding feature literal:  49%|████▊     | 91068/187062 [00:01<00:01, 70122.44it/s]
Adding feature literal:  53%|█████▎    | 98211/187062 [00:01<00:01, 70510.85it/s]
Adding feature literal:  56%|█████▋    | 105353/187062 [00:01<00:01, 70780.51it/s]
Adding feature literal:  60%|██████    | 112467/187062 [00:02<00:01, 70611.77it/s]
Adding feature literal:  64%|██████▍   | 119598/187062 [00:02<00:00, 70819.80it/s]
Adding feature literal:  68%|██████▊   | 126726/187062 [00:02<00:00, 70955.96it/s]
Adding feature literal:  72%|███████▏  | 133850/187062 [00:02<00:00, 71040.48it/s]
Adding feature literal:  75%|███████▌  | 140963/187062 [00:02<00:00, 71015.53it/s]
Adding feature literal:  79%|███████▉  | 148117/187062 [00:02<00:00, 71171.50it/s]
Adding feature literal:  83%|████████▎ | 155248/187062 [00:02<00:00, 71210.84it/s]
Adding feature literal:  87%|████████▋ | 162373/187062 [00:02<00:00, 71211.76it/s]
Adding feature literal:  91%|█████████ | 169515/187062 [00:02<00:00, 71272.33it/s]
Adding feature literal:  94%|█████████▍| 176654/187062 [00:02<00:00, 71306.62it/s]
Adding feature literal:  98%|█████████▊| 183786/187062 [00:03<00:00, 48795.63it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 56439.58it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:25:51,  2.22it/s]
Adding feature operator:   3%|▎         | 6132/187062 [00:00<00:12, 14751.68it/s]
Adding feature operator:   7%|▋         | 13102/187062 [00:00<00:06, 28806.09it/s]
Adding feature operator:  11%|█         | 20158/187062 [00:00<00:04, 39979.63it/s]
Adding feature operator:  15%|█▍        | 27240/187062 [00:00<00:03, 48508.64it/s]
Adding feature operator:  18%|█▊        | 34324/187062 [00:00<00:02, 54830.91it/s]
Adding feature operator:  22%|██▏       | 41400/187062 [00:01<00:02, 59417.23it/s]
Adding feature operator:  26%|██▌       | 48489/187062 [00:01<00:02, 62758.64it/s]
Adding feature operator:  30%|██▉       | 55569/187062 [00:01<00:02, 65122.04it/s]
Adding feature operator:  34%|███▎      | 62710/187062 [00:01<00:01, 66979.88it/s]
Adding feature operator:  37%|███▋      | 69864/187062 [00:01<00:01, 68331.69it/s]
Adding feature operator:  41%|████      | 77004/187062 [00:01<00:01, 69242.62it/s]
Adding feature operator:  45%|████▍     | 84110/187062 [00:01<00:01, 69784.71it/s]
Adding feature operator:  49%|████▉     | 91209/187062 [00:01<00:01, 70143.71it/s]
Adding feature operator:  53%|█████▎    | 98318/187062 [00:01<00:01, 70424.26it/s]
Adding feature operator:  56%|█████▋    | 105411/187062 [00:01<00:01, 70522.67it/s]
Adding feature operator:  60%|██████    | 112499/187062 [00:02<00:01, 70418.18it/s]
Adding feature operator:  64%|██████▍   | 119630/187062 [00:02<00:00, 70681.88it/s]
Adding feature operator:  68%|██████▊   | 126760/187062 [00:02<00:00, 70864.93it/s]
Adding feature operator:  72%|███████▏  | 133896/187062 [00:02<00:00, 71012.77it/s]
Adding feature operator:  75%|███████▌  | 141017/187062 [00:02<00:00, 71071.48it/s]
Adding feature operator:  79%|███████▉  | 148159/187062 [00:02<00:00, 71175.56it/s]
Adding feature operator:  83%|████████▎ | 155312/187062 [00:02<00:00, 71279.41it/s]
Adding feature operator:  87%|████████▋ | 162443/187062 [00:02<00:00, 71211.52it/s]
Adding feature operator:  91%|█████████ | 169567/187062 [00:02<00:00, 71182.39it/s]
Adding feature operator:  94%|█████████▍| 176693/187062 [00:02<00:00, 71202.61it/s]
Adding feature operator:  98%|█████████▊| 183815/187062 [00:03<00:00, 48766.64it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 56457.23it/s]
[2024-10-12 23:31:08,258] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 23:31:09 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 23:31:09 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:17, 377.95 examples/s]
Map:   1%|▏         | 90/6548 [00:00<00:28, 230.38 examples/s]
Map:   2%|▏         | 127/6548 [00:00<00:23, 271.58 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:19, 324.32 examples/s]
Map:   3%|▎         | 225/6548 [00:00<00:17, 367.15 examples/s]
Map:   4%|▍         | 286/6548 [00:00<00:17, 365.36 examples/s]
Map:   5%|▍         | 325/6548 [00:01<00:19, 316.62 examples/s]
Map:   6%|▌         | 379/6548 [00:01<00:19, 323.67 examples/s]
Map:   7%|▋         | 429/6548 [00:01<00:16, 363.50 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 328.00 examples/s]
Map:   8%|▊         | 512/6548 [00:01<00:17, 343.74 examples/s]
Map:   9%|▊         | 566/6548 [00:01<00:15, 389.74 examples/s]
Map:   9%|▉         | 620/6548 [00:01<00:16, 364.02 examples/s]
Map:  10%|█         | 666/6548 [00:01<00:17, 341.36 examples/s]
Map:  11%|█         | 711/6548 [00:02<00:16, 363.30 examples/s]
Map:  12%|█▏        | 758/6548 [00:02<00:14, 386.07 examples/s]
Map:  12%|█▏        | 813/6548 [00:02<00:13, 418.76 examples/s]
Map:  13%|█▎        | 875/6548 [00:02<00:13, 406.52 examples/s]
Map:  14%|█▍        | 932/6548 [00:02<00:14, 379.99 examples/s]
Map:  15%|█▌        | 987/6548 [00:02<00:14, 373.96 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:22, 250.03 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:20, 271.40 examples/s]
Map:  17%|█▋        | 1123/6548 [00:03<00:17, 306.38 examples/s]
Map:  18%|█▊        | 1164/6548 [00:03<00:16, 324.62 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 344.01 examples/s]
Map:  19%|█▉        | 1249/6548 [00:03<00:15, 353.16 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:14, 367.68 examples/s]
Map:  20%|██        | 1342/6548 [00:03<00:15, 338.92 examples/s]
Map:  21%|██        | 1385/6548 [00:04<00:16, 318.35 examples/s]
Map:  22%|██▏       | 1427/6548 [00:04<00:15, 340.08 examples/s]
Map:  22%|██▏       | 1463/6548 [00:04<00:17, 282.80 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:17, 286.19 examples/s]
Map:  24%|██▍       | 1556/6548 [00:04<00:17, 281.17 examples/s]
Map:  24%|██▍       | 1596/6548 [00:04<00:16, 294.34 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:17, 285.53 examples/s]
Map:  26%|██▌       | 1694/6548 [00:05<00:16, 295.16 examples/s]
Map:  26%|██▋       | 1731/6548 [00:05<00:15, 309.09 examples/s]
Map:  27%|██▋       | 1775/6548 [00:05<00:14, 339.36 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 336.10 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 346.27 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 334.39 examples/s]
Map:  30%|██▉       | 1947/6548 [00:05<00:13, 349.28 examples/s]
Map:  30%|███       | 1988/6548 [00:05<00:12, 362.27 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:20, 225.15 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:17, 256.20 examples/s]
Map:  32%|███▏      | 2124/6548 [00:06<00:16, 265.77 examples/s]
Map:  33%|███▎      | 2179/6548 [00:06<00:16, 260.71 examples/s]
Map:  34%|███▍      | 2213/6548 [00:06<00:16, 267.66 examples/s]
Map:  34%|███▍      | 2247/6548 [00:07<00:16, 254.58 examples/s]
Map:  35%|███▌      | 2294/6548 [00:07<00:15, 267.90 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:14, 296.80 examples/s]
Map:  36%|███▋      | 2377/6548 [00:07<00:13, 306.06 examples/s]
Map:  37%|███▋      | 2419/6548 [00:07<00:12, 331.53 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:12, 322.39 examples/s]
Map:  38%|███▊      | 2497/6548 [00:07<00:12, 328.36 examples/s]
Map:  39%|███▉      | 2538/6548 [00:07<00:11, 347.48 examples/s]
Map:  40%|███▉      | 2592/6548 [00:08<00:09, 396.09 examples/s]
Map:  40%|████      | 2634/6548 [00:08<00:09, 400.55 examples/s]
Map:  41%|████      | 2683/6548 [00:08<00:10, 369.18 examples/s]
Map:  42%|████▏     | 2742/6548 [00:08<00:10, 375.37 examples/s]
Map:  43%|████▎     | 2800/6548 [00:08<00:09, 375.07 examples/s]
Map:  43%|████▎     | 2841/6548 [00:08<00:12, 291.09 examples/s]
Map:  44%|████▍     | 2879/6548 [00:08<00:12, 305.53 examples/s]
Map:  45%|████▍     | 2926/6548 [00:09<00:12, 292.64 examples/s]
Map:  45%|████▌     | 2967/6548 [00:09<00:11, 317.06 examples/s]
Map:  46%|████▌     | 3009/6548 [00:09<00:19, 178.89 examples/s]
Map:  46%|████▋     | 3043/6548 [00:09<00:17, 202.03 examples/s]
Map:  47%|████▋     | 3073/6548 [00:09<00:15, 217.50 examples/s]
Map:  48%|████▊     | 3112/6548 [00:10<00:13, 247.99 examples/s]
Map:  48%|████▊     | 3149/6548 [00:10<00:14, 241.21 examples/s]
Map:  49%|████▊     | 3183/6548 [00:10<00:12, 258.98 examples/s]
Map:  49%|████▉     | 3219/6548 [00:10<00:12, 259.62 examples/s]
Map:  50%|████▉     | 3255/6548 [00:10<00:11, 278.70 examples/s]
Map:  50%|█████     | 3286/6548 [00:10<00:11, 282.69 examples/s]
Map:  51%|█████     | 3331/6548 [00:10<00:10, 313.71 examples/s]
Map:  52%|█████▏    | 3378/6548 [00:10<00:10, 310.45 examples/s]
Map:  52%|█████▏    | 3420/6548 [00:11<00:11, 283.47 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 270.96 examples/s]
Map:  53%|█████▎    | 3495/6548 [00:11<00:11, 261.97 examples/s]
Map:  54%|█████▍    | 3545/6548 [00:11<00:09, 312.25 examples/s]
Map:  55%|█████▍    | 3591/6548 [00:11<00:08, 346.16 examples/s]
Map:  56%|█████▌    | 3636/6548 [00:11<00:07, 371.49 examples/s]
Map:  56%|█████▋    | 3695/6548 [00:11<00:07, 376.97 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:11<00:07, 380.88 examples/s]
Map:  58%|█████▊    | 3800/6548 [00:12<00:07, 386.30 examples/s]
Map:  59%|█████▊    | 3841/6548 [00:12<00:08, 328.00 examples/s]
Map:  59%|█████▉    | 3878/6548 [00:12<00:08, 324.14 examples/s]
Map:  60%|█████▉    | 3915/6548 [00:12<00:07, 331.99 examples/s]
Map:  61%|██████    | 3967/6548 [00:12<00:07, 334.61 examples/s]
Map:  62%|██████▏   | 4029/6548 [00:13<00:09, 253.46 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 292.64 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 314.15 examples/s]
Map:  64%|██████▎   | 4166/6548 [00:13<00:07, 300.53 examples/s]
Map:  64%|██████▍   | 4203/6548 [00:13<00:07, 308.83 examples/s]
Map:  65%|██████▍   | 4237/6548 [00:13<00:07, 314.66 examples/s]
Map:  65%|██████▌   | 4286/6548 [00:13<00:06, 356.61 examples/s]
Map:  66%|██████▌   | 4327/6548 [00:13<00:06, 368.47 examples/s]
Map:  67%|██████▋   | 4383/6548 [00:14<00:06, 351.85 examples/s]
Map:  68%|██████▊   | 4427/6548 [00:14<00:05, 368.96 examples/s]
Map:  68%|██████▊   | 4469/6548 [00:14<00:06, 336.56 examples/s]
Map:  69%|██████▉   | 4506/6548 [00:14<00:06, 302.07 examples/s]
Map:  69%|██████▉   | 4545/6548 [00:14<00:06, 311.30 examples/s]
Map:  70%|██████▉   | 4578/6548 [00:14<00:06, 314.61 examples/s]
Map:  71%|███████   | 4628/6548 [00:14<00:06, 317.80 examples/s]
Map:  71%|███████▏  | 4670/6548 [00:14<00:05, 338.49 examples/s]
Map:  72%|███████▏  | 4712/6548 [00:15<00:05, 352.77 examples/s]
Map:  73%|███████▎  | 4750/6548 [00:15<00:05, 355.94 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 409.80 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 396.91 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 358.72 examples/s]
Map:  76%|███████▌  | 4952/6548 [00:15<00:04, 388.04 examples/s]
Map:  76%|███████▋  | 4994/6548 [00:15<00:04, 338.28 examples/s]
Map:  77%|███████▋  | 5038/6548 [00:16<00:06, 231.47 examples/s]
Map:  78%|███████▊  | 5079/6548 [00:16<00:06, 240.62 examples/s]
Map:  78%|███████▊  | 5112/6548 [00:16<00:05, 255.87 examples/s]
Map:  79%|███████▉  | 5159/6548 [00:16<00:05, 268.91 examples/s]
Map:  80%|███████▉  | 5207/6548 [00:16<00:04, 281.54 examples/s]
Map:  80%|████████  | 5246/6548 [00:16<00:04, 302.03 examples/s]
Map:  81%|████████  | 5286/6548 [00:16<00:03, 323.06 examples/s]
Map:  81%|████████▏ | 5322/6548 [00:16<00:03, 330.77 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 305.42 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 294.93 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 326.17 examples/s]
Map:  84%|████████▍ | 5488/6548 [00:17<00:03, 329.97 examples/s]
Map:  85%|████████▍ | 5548/6548 [00:17<00:02, 349.32 examples/s]
Map:  86%|████████▌ | 5602/6548 [00:17<00:03, 312.26 examples/s]
Map:  86%|████████▌ | 5646/6548 [00:17<00:02, 338.09 examples/s]
Map:  87%|████████▋ | 5687/6548 [00:18<00:02, 313.96 examples/s]
Map:  88%|████████▊ | 5730/6548 [00:18<00:02, 331.39 examples/s]
Map:  88%|████████▊ | 5768/6548 [00:18<00:02, 336.78 examples/s]
Map:  89%|████████▊ | 5805/6548 [00:18<00:02, 342.05 examples/s]
Map:  89%|████████▉ | 5845/6548 [00:18<00:02, 342.57 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:18<00:01, 350.34 examples/s]
Map:  90%|█████████ | 5923/6548 [00:18<00:01, 359.73 examples/s]
Map:  91%|█████████ | 5966/6548 [00:18<00:01, 330.98 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 218.33 examples/s]
Map:  92%|█████████▏| 6041/6548 [00:19<00:01, 254.69 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 285.55 examples/s]
Map:  93%|█████████▎| 6121/6548 [00:19<00:01, 271.42 examples/s]
Map:  94%|█████████▍| 6169/6548 [00:19<00:01, 284.87 examples/s]
Map:  95%|█████████▍| 6206/6548 [00:19<00:01, 300.63 examples/s]
Map:  95%|█████████▌| 6249/6548 [00:19<00:00, 326.57 examples/s]
Map:  96%|█████████▋| 6305/6548 [00:20<00:00, 340.40 examples/s]
Map:  97%|█████████▋| 6366/6548 [00:20<00:00, 360.11 examples/s]
Map:  98%|█████████▊| 6419/6548 [00:20<00:00, 350.02 examples/s]
Map:  99%|█████████▊| 6465/6548 [00:20<00:00, 370.67 examples/s]
Map:  99%|█████████▉| 6511/6548 [00:20<00:00, 347.66 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 277.88 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 312.91 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   3%|▎         | 31/903 [00:00<00:03, 280.57 examples/s]
Map:   8%|▊         | 68/903 [00:00<00:02, 329.49 examples/s]
Map:  13%|█▎        | 115/903 [00:00<00:02, 303.60 examples/s]
Map:  17%|█▋        | 153/903 [00:00<00:02, 327.50 examples/s]
Map:  22%|██▏       | 202/903 [00:00<00:01, 378.16 examples/s]
Map:  29%|██▊       | 259/903 [00:00<00:01, 370.69 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 360.68 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 322.88 examples/s]
Map:  44%|████▎     | 393/903 [00:01<00:01, 285.25 examples/s]
Map:  48%|████▊     | 436/903 [00:01<00:01, 293.94 examples/s]
Map:  53%|█████▎    | 475/903 [00:01<00:01, 310.64 examples/s]
Map:  59%|█████▊    | 530/903 [00:01<00:01, 327.58 examples/s]
Map:  63%|██████▎   | 566/903 [00:01<00:01, 334.34 examples/s]
Map:  68%|██████▊   | 613/903 [00:01<00:00, 356.94 examples/s]
Map:  72%|███████▏  | 650/903 [00:01<00:00, 356.11 examples/s]
Map:  77%|███████▋  | 696/903 [00:02<00:00, 374.39 examples/s]
Map:  82%|████████▏ | 742/903 [00:02<00:00, 395.41 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 390.06 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 391.02 examples/s]
Map:  97%|█████████▋| 872/903 [00:02<00:00, 408.61 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 319.58 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 273.65 examples/s]
Map:   4%|▍         | 82/1882 [00:00<00:05, 355.95 examples/s]
Map:   7%|▋         | 129/1882 [00:00<00:05, 320.06 examples/s]
Map:   9%|▉         | 172/1882 [00:00<00:04, 353.81 examples/s]
Map:  12%|█▏        | 222/1882 [00:00<00:04, 332.95 examples/s]
Map:  14%|█▍        | 267/1882 [00:00<00:04, 357.13 examples/s]
Map:  18%|█▊        | 330/1882 [00:00<00:04, 375.81 examples/s]
Map:  20%|██        | 379/1882 [00:01<00:04, 317.28 examples/s]
Map:  22%|██▏       | 414/1882 [00:01<00:05, 289.95 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 298.85 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 334.47 examples/s]
Map:  29%|██▉       | 544/1882 [00:01<00:04, 325.54 examples/s]
Map:  31%|███▏      | 590/1882 [00:01<00:03, 353.42 examples/s]
Map:  34%|███▍      | 646/1882 [00:01<00:03, 401.69 examples/s]
Map:  37%|███▋      | 704/1882 [00:02<00:03, 385.00 examples/s]
Map:  41%|████      | 768/1882 [00:02<00:02, 392.56 examples/s]
Map:  44%|████▍     | 826/1882 [00:02<00:03, 350.12 examples/s]
Map:  46%|████▌     | 863/1882 [00:02<00:02, 350.76 examples/s]
Map:  48%|████▊     | 904/1882 [00:02<00:02, 360.62 examples/s]
Map:  50%|█████     | 947/1882 [00:02<00:02, 374.77 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 386.06 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 247.87 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 261.86 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 274.65 examples/s]
Map:  61%|██████    | 1148/1882 [00:03<00:02, 270.65 examples/s]
Map:  63%|██████▎   | 1179/1882 [00:03<00:02, 274.28 examples/s]
Map:  65%|██████▍   | 1222/1882 [00:03<00:02, 273.63 examples/s]
Map:  67%|██████▋   | 1258/1882 [00:03<00:02, 283.72 examples/s]
Map:  69%|██████▉   | 1303/1882 [00:04<00:01, 320.12 examples/s]
Map:  71%|███████▏  | 1345/1882 [00:04<00:01, 343.14 examples/s]
Map:  74%|███████▎  | 1385/1882 [00:04<00:01, 309.70 examples/s]
Map:  75%|███████▌  | 1419/1882 [00:04<00:01, 279.88 examples/s]
Map:  77%|███████▋  | 1457/1882 [00:04<00:01, 298.77 examples/s]
Map:  79%|███████▉  | 1493/1882 [00:04<00:01, 265.19 examples/s]
Map:  82%|████████▏ | 1535/1882 [00:04<00:01, 260.78 examples/s]
Map:  84%|████████▎ | 1575/1882 [00:04<00:01, 288.21 examples/s]
Map:  86%|████████▌ | 1619/1882 [00:05<00:00, 320.32 examples/s]
Map:  88%|████████▊ | 1655/1882 [00:05<00:00, 315.00 examples/s]
Map:  90%|████████▉ | 1692/1882 [00:05<00:00, 311.55 examples/s]
Map:  92%|█████████▏| 1726/1882 [00:05<00:00, 316.39 examples/s]
Map:  94%|█████████▎| 1763/1882 [00:05<00:00, 272.60 examples/s]
Map:  95%|█████████▌| 1794/1882 [00:05<00:00, 280.03 examples/s]
Map:  98%|█████████▊| 1841/1882 [00:05<00:00, 322.22 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 225.55 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 307.09 examples/s]
10/12/2024 23:32:11 - INFO - __main__ -     ***** Testing *****
10/12/2024 23:32:11 - INFO - __main__ -     Batch size = 8
10/12/2024 23:32:11 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 23:32:12 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 23:32:12 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 23:32:13 - INFO - knnlm -   Reading datastore took 0.9183268547058105 s
10/12/2024 23:32:14 - INFO - knnlm -   Moving index to GPU took 0.9119555950164795 s
10/12/2024 23:32:14 - INFO - __main__ -   ******************************break-into
10/12/2024 23:32:14 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 23:32:14 - INFO - __main__ -     Num examples = 236
10/12/2024 23:32:14 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:45,  7.85s/it]
test ppl:   1%|          | 2/236 [00:09<16:59,  4.36s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:51,  3.05s/it]
test ppl:   2%|▏         | 4/236 [00:17<16:06,  4.17s/it]
test ppl:   2%|▏         | 5/236 [00:23<18:26,  4.79s/it]
test ppl:   3%|▎         | 6/236 [00:28<19:47,  5.16s/it]
test ppl:   3%|▎         | 7/236 [00:30<15:37,  4.09s/it]
test ppl:   3%|▎         | 8/236 [00:36<16:54,  4.45s/it]
test ppl:   4%|▍         | 9/236 [00:41<18:33,  4.91s/it]
test ppl:   4%|▍         | 10/236 [00:44<15:45,  4.19s/it]
test ppl:   5%|▍         | 11/236 [00:46<13:14,  3.53s/it]
test ppl:   5%|▌         | 12/236 [00:52<15:52,  4.25s/it]
test ppl:   6%|▌         | 13/236 [00:58<17:39,  4.75s/it]
test ppl:   6%|▌         | 14/236 [01:04<18:52,  5.10s/it]
test ppl:   6%|▋         | 15/236 [01:05<14:33,  3.95s/it]
test ppl:   7%|▋         | 16/236 [01:07<12:10,  3.32s/it]
test ppl:   7%|▋         | 17/236 [01:11<12:59,  3.56s/it]
test ppl:   8%|▊         | 18/236 [01:14<12:23,  3.41s/it]
test ppl:   8%|▊         | 19/236 [01:20<15:01,  4.15s/it]
test ppl:   8%|▊         | 20/236 [01:22<12:23,  3.44s/it]
test ppl:   9%|▉         | 21/236 [01:24<10:35,  2.95s/it]
test ppl:   9%|▉         | 22/236 [01:29<13:40,  3.83s/it]
test ppl:  10%|▉         | 23/236 [01:32<12:11,  3.44s/it]
test ppl:  10%|█         | 24/236 [01:34<10:50,  3.07s/it]
test ppl:  11%|█         | 25/236 [01:40<13:47,  3.92s/it]
test ppl:  11%|█         | 26/236 [01:46<15:47,  4.51s/it]
test ppl:  11%|█▏        | 27/236 [01:49<14:35,  4.19s/it]
test ppl:  12%|█▏        | 28/236 [01:51<11:25,  3.29s/it]
test ppl:  12%|█▏        | 29/236 [01:53<10:03,  2.91s/it]
test ppl:  13%|█▎        | 30/236 [01:54<08:36,  2.50s/it]
test ppl:  13%|█▎        | 31/236 [01:56<08:02,  2.35s/it]
test ppl:  14%|█▎        | 32/236 [01:59<08:18,  2.44s/it]
test ppl:  14%|█▍        | 33/236 [02:05<11:47,  3.49s/it]
test ppl:  14%|█▍        | 34/236 [02:09<12:16,  3.64s/it]
test ppl:  15%|█▍        | 35/236 [02:15<14:27,  4.32s/it]
test ppl:  15%|█▌        | 36/236 [02:21<15:56,  4.78s/it]
test ppl:  16%|█▌        | 37/236 [02:26<16:59,  5.12s/it]
test ppl:  16%|█▌        | 38/236 [02:29<13:53,  4.21s/it]
test ppl:  17%|█▋        | 39/236 [02:30<11:26,  3.49s/it]
test ppl:  17%|█▋        | 40/236 [02:32<09:17,  2.85s/it]
test ppl:  17%|█▋        | 41/236 [02:34<08:18,  2.55s/it]
test ppl:  18%|█▊        | 42/236 [02:39<11:32,  3.57s/it]
test ppl:  18%|█▊        | 43/236 [02:45<13:42,  4.26s/it]
test ppl:  19%|█▊        | 44/236 [02:48<12:09,  3.80s/it]
test ppl:  19%|█▉        | 45/236 [02:50<10:20,  3.25s/it]
test ppl:  19%|█▉        | 46/236 [02:56<12:51,  4.06s/it]
test ppl:  20%|█▉        | 47/236 [02:58<10:24,  3.30s/it]
test ppl:  20%|██        | 48/236 [03:03<12:46,  4.08s/it]
test ppl:  21%|██        | 49/236 [03:08<12:42,  4.08s/it]
test ppl:  21%|██        | 50/236 [03:14<14:42,  4.74s/it]
test ppl:  22%|██▏       | 51/236 [03:20<15:41,  5.09s/it]
test ppl:  22%|██▏       | 52/236 [03:26<16:20,  5.33s/it]
test ppl:  22%|██▏       | 53/236 [03:30<15:09,  4.97s/it]
test ppl:  23%|██▎       | 54/236 [03:31<11:57,  3.94s/it]
test ppl:  23%|██▎       | 55/236 [03:37<13:27,  4.46s/it]
test ppl:  24%|██▎       | 56/236 [03:40<12:29,  4.16s/it]
test ppl:  24%|██▍       | 57/236 [03:43<11:14,  3.77s/it]
test ppl:  25%|██▍       | 58/236 [03:46<10:19,  3.48s/it]
test ppl:  25%|██▌       | 59/236 [03:53<13:37,  4.62s/it]
test ppl:  25%|██▌       | 60/236 [03:57<13:01,  4.44s/it]
test ppl:  26%|██▌       | 61/236 [04:05<15:26,  5.29s/it]
test ppl:  26%|██▋       | 62/236 [04:12<17:04,  5.89s/it]
test ppl:  27%|██▋       | 63/236 [04:15<14:30,  5.03s/it]
test ppl:  27%|██▋       | 64/236 [04:17<11:43,  4.09s/it]
test ppl:  28%|██▊       | 65/236 [04:18<09:32,  3.35s/it]
test ppl:  28%|██▊       | 66/236 [04:22<09:48,  3.46s/it]
test ppl:  28%|██▊       | 67/236 [04:29<12:58,  4.61s/it]
test ppl:  29%|██▉       | 68/236 [04:37<15:15,  5.45s/it]
test ppl:  29%|██▉       | 69/236 [04:46<18:03,  6.49s/it]
test ppl:  30%|██▉       | 70/236 [04:55<19:55,  7.20s/it]
test ppl:  30%|███       | 71/236 [05:00<18:10,  6.61s/it]
test ppl:  31%|███       | 72/236 [05:06<17:20,  6.34s/it]
test ppl:  31%|███       | 73/236 [05:15<19:18,  7.11s/it]
test ppl:  31%|███▏      | 74/236 [05:17<15:16,  5.65s/it]
test ppl:  32%|███▏      | 75/236 [05:26<17:46,  6.63s/it]
test ppl:  32%|███▏      | 76/236 [05:35<19:29,  7.31s/it]
test ppl:  33%|███▎      | 77/236 [05:40<18:10,  6.86s/it]
test ppl:  33%|███▎      | 78/236 [05:43<14:25,  5.48s/it]
test ppl:  33%|███▎      | 79/236 [05:49<14:42,  5.62s/it]
test ppl:  34%|███▍      | 80/236 [05:51<12:05,  4.65s/it]
test ppl:  34%|███▍      | 81/236 [06:00<15:17,  5.92s/it]
test ppl:  35%|███▍      | 82/236 [06:09<17:30,  6.82s/it]
test ppl:  35%|███▌      | 83/236 [06:18<19:00,  7.45s/it]
test ppl:  36%|███▌      | 84/236 [06:20<15:08,  5.97s/it]
test ppl:  36%|███▌      | 85/236 [06:27<15:20,  6.10s/it]
test ppl:  36%|███▋      | 86/236 [06:30<13:08,  5.26s/it]
test ppl:  37%|███▋      | 87/236 [06:33<11:29,  4.63s/it]
test ppl:  37%|███▋      | 88/236 [06:40<13:28,  5.46s/it]
test ppl:  38%|███▊      | 89/236 [06:48<14:38,  5.98s/it]
test ppl:  38%|███▊      | 90/236 [06:55<15:16,  6.28s/it]
test ppl:  39%|███▊      | 91/236 [07:00<14:10,  5.87s/it]
test ppl:  39%|███▉      | 92/236 [07:02<11:52,  4.95s/it]
test ppl:  39%|███▉      | 93/236 [07:08<12:27,  5.22s/it]
test ppl:  40%|███▉      | 94/236 [07:14<12:45,  5.39s/it]
test ppl:  40%|████      | 95/236 [07:17<10:43,  4.57s/it]
test ppl:  41%|████      | 96/236 [07:20<09:29,  4.07s/it]
test ppl:  41%|████      | 97/236 [07:25<10:40,  4.61s/it]
test ppl:  42%|████▏     | 98/236 [07:31<11:28,  4.99s/it]
test ppl:  42%|████▏     | 99/236 [07:37<12:00,  5.26s/it]
test ppl:  42%|████▏     | 100/236 [07:38<09:11,  4.05s/it]
test ppl:  43%|████▎     | 101/236 [07:44<10:20,  4.60s/it]
test ppl:  43%|████▎     | 102/236 [07:48<09:49,  4.40s/it]
test ppl:  44%|████▎     | 103/236 [07:50<07:46,  3.51s/it]
test ppl:  44%|████▍     | 104/236 [07:54<08:11,  3.72s/it]
test ppl:  44%|████▍     | 105/236 [07:58<08:16,  3.79s/it]
test ppl:  45%|████▍     | 106/236 [08:03<09:15,  4.28s/it]
test ppl:  45%|████▌     | 107/236 [08:05<07:50,  3.65s/it]
test ppl:  46%|████▌     | 108/236 [08:09<07:41,  3.60s/it]
test ppl:  46%|████▌     | 109/236 [08:14<08:41,  4.11s/it]
test ppl:  47%|████▋     | 110/236 [08:16<07:01,  3.35s/it]
test ppl:  47%|████▋     | 111/236 [08:20<07:24,  3.56s/it]
test ppl:  47%|████▋     | 112/236 [08:26<08:47,  4.25s/it]
test ppl:  48%|████▊     | 113/236 [08:27<07:11,  3.50s/it]
test ppl:  48%|████▊     | 114/236 [08:31<07:16,  3.58s/it]
test ppl:  49%|████▊     | 115/236 [08:37<08:36,  4.27s/it]
test ppl:  49%|████▉     | 116/236 [08:43<09:30,  4.76s/it]
test ppl:  50%|████▉     | 117/236 [08:45<07:42,  3.88s/it]
test ppl:  50%|█████     | 118/236 [08:50<08:22,  4.26s/it]
test ppl:  50%|█████     | 119/236 [08:52<07:04,  3.63s/it]
test ppl:  51%|█████     | 120/236 [08:54<05:46,  2.99s/it]
test ppl:  51%|█████▏    | 121/236 [08:59<07:22,  3.85s/it]
test ppl:  52%|█████▏    | 122/236 [09:05<08:27,  4.45s/it]
test ppl:  52%|█████▏    | 123/236 [09:11<09:11,  4.88s/it]
test ppl:  53%|█████▎    | 124/236 [09:13<07:35,  4.07s/it]
test ppl:  53%|█████▎    | 125/236 [09:19<08:31,  4.60s/it]
test ppl:  53%|█████▎    | 126/236 [09:23<07:56,  4.33s/it]
test ppl:  54%|█████▍    | 127/236 [09:29<08:42,  4.80s/it]
test ppl:  54%|█████▍    | 128/236 [09:31<07:03,  3.92s/it]
test ppl:  55%|█████▍    | 129/236 [09:34<06:25,  3.60s/it]
test ppl:  55%|█████▌    | 130/236 [09:36<05:55,  3.35s/it]
test ppl:  56%|█████▌    | 131/236 [09:42<07:11,  4.11s/it]
test ppl:  56%|█████▌    | 132/236 [09:48<08:02,  4.64s/it]
test ppl:  56%|█████▋    | 133/236 [09:52<07:35,  4.42s/it]
test ppl:  57%|█████▋    | 134/236 [09:56<07:13,  4.25s/it]
test ppl:  57%|█████▋    | 135/236 [10:02<07:58,  4.74s/it]
test ppl:  58%|█████▊    | 136/236 [10:03<06:11,  3.71s/it]
test ppl:  58%|█████▊    | 137/236 [10:09<07:12,  4.37s/it]
test ppl:  58%|█████▊    | 138/236 [10:13<06:47,  4.16s/it]
test ppl:  59%|█████▉    | 139/236 [10:14<05:34,  3.45s/it]
test ppl:  59%|█████▉    | 140/236 [10:16<04:40,  2.92s/it]
test ppl:  60%|█████▉    | 141/236 [10:20<05:04,  3.20s/it]
test ppl:  60%|██████    | 142/236 [10:22<04:30,  2.88s/it]
test ppl:  61%|██████    | 143/236 [10:28<05:52,  3.79s/it]
test ppl:  61%|██████    | 144/236 [10:31<05:18,  3.47s/it]
test ppl:  61%|██████▏   | 145/236 [10:35<05:39,  3.74s/it]
test ppl:  62%|██████▏   | 146/236 [10:41<06:23,  4.26s/it]
test ppl:  62%|██████▏   | 147/236 [10:46<07:02,  4.75s/it]
test ppl:  63%|██████▎   | 148/236 [10:52<07:30,  5.12s/it]
test ppl:  63%|██████▎   | 149/236 [10:58<07:45,  5.35s/it]
test ppl:  64%|██████▎   | 150/236 [11:04<07:54,  5.51s/it]
test ppl:  64%|██████▍   | 151/236 [11:10<07:57,  5.62s/it]
test ppl:  64%|██████▍   | 152/236 [11:16<07:58,  5.69s/it]
test ppl:  65%|██████▍   | 153/236 [11:20<07:21,  5.32s/it]
test ppl:  65%|██████▌   | 154/236 [11:22<05:41,  4.17s/it]
test ppl:  66%|██████▌   | 155/236 [11:24<04:59,  3.70s/it]
test ppl:  66%|██████▌   | 156/236 [11:27<04:23,  3.30s/it]
test ppl:  67%|██████▋   | 157/236 [11:28<03:36,  2.74s/it]
test ppl:  67%|██████▋   | 158/236 [11:34<04:47,  3.69s/it]
test ppl:  67%|██████▋   | 159/236 [11:40<05:34,  4.35s/it]
test ppl:  68%|██████▊   | 160/236 [11:42<04:36,  3.64s/it]
test ppl:  68%|██████▊   | 161/236 [11:43<03:42,  2.96s/it]
test ppl:  69%|██████▊   | 162/236 [11:46<03:20,  2.71s/it]
test ppl:  69%|██████▉   | 163/236 [11:47<02:53,  2.37s/it]
test ppl:  69%|██████▉   | 164/236 [11:52<03:35,  2.99s/it]
test ppl:  70%|██████▉   | 165/236 [11:55<03:33,  3.00s/it]
test ppl:  70%|███████   | 166/236 [11:56<02:58,  2.55s/it]
test ppl:  71%|███████   | 167/236 [11:58<02:33,  2.23s/it]
test ppl:  71%|███████   | 168/236 [12:02<03:13,  2.85s/it]
test ppl:  72%|███████▏  | 169/236 [12:06<03:41,  3.30s/it]
test ppl:  72%|███████▏  | 170/236 [12:12<04:30,  4.10s/it]
test ppl:  72%|███████▏  | 171/236 [12:14<03:32,  3.27s/it]
test ppl:  73%|███████▎  | 172/236 [12:19<04:19,  4.06s/it]
test ppl:  73%|███████▎  | 173/236 [12:23<04:04,  3.88s/it]
test ppl:  74%|███████▎  | 174/236 [12:29<04:38,  4.50s/it]
test ppl:  74%|███████▍  | 175/236 [12:31<03:46,  3.71s/it]
test ppl:  75%|███████▍  | 176/236 [12:37<04:21,  4.36s/it]
test ppl:  75%|███████▌  | 177/236 [12:42<04:44,  4.82s/it]
test ppl:  75%|███████▌  | 178/236 [12:48<04:58,  5.15s/it]
test ppl:  76%|███████▌  | 179/236 [12:54<05:06,  5.38s/it]
test ppl:  76%|███████▋  | 180/236 [13:00<05:07,  5.49s/it]
test ppl:  77%|███████▋  | 181/236 [13:05<04:55,  5.37s/it]
test ppl:  77%|███████▋  | 182/236 [13:07<03:53,  4.33s/it]
test ppl:  78%|███████▊  | 183/236 [13:09<03:05,  3.51s/it]
test ppl:  78%|███████▊  | 184/236 [13:11<02:38,  3.04s/it]
test ppl:  78%|███████▊  | 185/236 [13:16<03:07,  3.68s/it]
test ppl:  79%|███████▉  | 186/236 [13:18<02:37,  3.14s/it]
test ppl:  79%|███████▉  | 187/236 [13:24<03:15,  3.99s/it]
test ppl:  80%|███████▉  | 188/236 [13:30<03:39,  4.57s/it]
test ppl:  80%|████████  | 189/236 [13:35<03:53,  4.96s/it]
test ppl:  81%|████████  | 190/236 [13:40<03:50,  5.00s/it]
test ppl:  81%|████████  | 191/236 [13:44<03:28,  4.64s/it]
test ppl:  81%|████████▏ | 192/236 [13:47<02:57,  4.04s/it]
test ppl:  82%|████████▏ | 193/236 [13:49<02:23,  3.34s/it]
test ppl:  82%|████████▏ | 194/236 [13:51<02:11,  3.12s/it]
test ppl:  83%|████████▎ | 195/236 [13:54<02:07,  3.10s/it]
test ppl:  83%|████████▎ | 196/236 [13:56<01:51,  2.78s/it]
test ppl:  83%|████████▎ | 197/236 [13:58<01:40,  2.59s/it]
test ppl:  84%|████████▍ | 198/236 [14:04<02:15,  3.57s/it]
test ppl:  84%|████████▍ | 199/236 [14:07<02:07,  3.44s/it]
test ppl:  85%|████████▍ | 200/236 [14:13<02:29,  4.17s/it]
test ppl:  85%|████████▌ | 201/236 [14:16<02:09,  3.69s/it]
test ppl:  86%|████████▌ | 202/236 [14:22<02:27,  4.33s/it]
test ppl:  86%|████████▌ | 203/236 [14:28<02:38,  4.80s/it]
test ppl:  86%|████████▋ | 204/236 [14:29<02:04,  3.88s/it]
test ppl:  87%|████████▋ | 205/236 [14:35<02:20,  4.52s/it]
test ppl:  87%|████████▋ | 206/236 [14:39<02:04,  4.14s/it]
test ppl:  88%|████████▊ | 207/236 [14:45<02:15,  4.66s/it]
test ppl:  88%|████████▊ | 208/236 [14:47<01:54,  4.09s/it]
test ppl:  89%|████████▊ | 209/236 [14:53<02:05,  4.65s/it]
test ppl:  89%|████████▉ | 210/236 [14:56<01:43,  3.96s/it]
test ppl:  89%|████████▉ | 211/236 [15:00<01:44,  4.19s/it]
test ppl:  90%|████████▉ | 212/236 [15:05<01:43,  4.32s/it]
test ppl:  90%|█████████ | 213/236 [15:11<01:50,  4.79s/it]
test ppl:  91%|█████████ | 214/236 [15:12<01:22,  3.75s/it]
test ppl:  91%|█████████ | 215/236 [15:18<01:32,  4.39s/it]
test ppl:  92%|█████████▏| 216/236 [15:20<01:11,  3.57s/it]
test ppl:  92%|█████████▏| 217/236 [15:26<01:21,  4.29s/it]
test ppl:  92%|█████████▏| 218/236 [15:32<01:25,  4.77s/it]
test ppl:  93%|█████████▎| 219/236 [15:37<01:26,  5.12s/it]
test ppl:  93%|█████████▎| 220/236 [15:43<01:25,  5.35s/it]
test ppl:  94%|█████████▎| 221/236 [15:45<01:02,  4.17s/it]
test ppl:  94%|█████████▍| 222/236 [15:51<01:05,  4.69s/it]
test ppl:  94%|█████████▍| 223/236 [15:57<01:05,  5.05s/it]
test ppl:  95%|█████████▍| 224/236 [15:59<00:50,  4.18s/it]
test ppl:  95%|█████████▌| 225/236 [16:03<00:46,  4.19s/it]
test ppl:  96%|█████████▌| 226/236 [16:06<00:37,  3.73s/it]
test ppl:  96%|█████████▌| 227/236 [16:08<00:30,  3.44s/it]
test ppl:  97%|█████████▋| 228/236 [16:10<00:24,  3.03s/it]
test ppl:  97%|█████████▋| 229/236 [16:16<00:27,  3.88s/it]
test ppl:  97%|█████████▋| 230/236 [16:20<00:22,  3.75s/it]
test ppl:  98%|█████████▊| 231/236 [16:23<00:18,  3.63s/it]
test ppl:  98%|█████████▊| 232/236 [16:25<00:12,  3.09s/it]
test ppl:  99%|█████████▊| 233/236 [16:28<00:09,  3.03s/it]
test ppl:  99%|█████████▉| 234/236 [16:29<00:04,  2.48s/it]
test ppl: 100%|█████████▉| 235/236 [16:35<00:03,  3.51s/it]
test ppl: 100%|██████████| 236/236 [16:36<00:00,  2.65s/it]
test ppl: 100%|██████████| 236/236 [16:36<00:00,  4.22s/it]
10/12/2024 23:48:50 - INFO - __main__ -    em: 0.2051
10/12/2024 23:48:50 - INFO - __main__ -   Finish and take 18m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/64_0.6_60_eval_results.json
64 0.6 60:  em: 0.2051

--------------------------------------------------------------------------------
Running experiment with knn_temp=80, lmbda=0.2, k=16
2024-10-12 23:48:57.552734: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-12 23:48:57.572184: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-12 23:48:57.593784: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-12 23:48:57.600360: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-12 23:48:57.616243: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-12 23:48:58.609319: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/12/2024 23:48:59 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.2, knn_temp=80, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/12/2024 23:49:00 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:54:56,  2.17it/s]
Adding feature api:   3%|▎         | 6297/187062 [00:00<00:12, 14914.29it/s]
Adding feature api:   7%|▋         | 13602/187062 [00:00<00:05, 29611.59it/s]
Adding feature api:  11%|█         | 20981/187062 [00:00<00:04, 41332.67it/s]
Adding feature api:  15%|█▌        | 28260/187062 [00:00<00:03, 49977.89it/s]
Adding feature api:  19%|█▉        | 35718/187062 [00:00<00:02, 56912.91it/s]
Adding feature api:  23%|██▎       | 43229/187062 [00:01<00:02, 62136.62it/s]
Adding feature api:  27%|██▋       | 50713/187062 [00:01<00:02, 65828.95it/s]
Adding feature api:  31%|███       | 58212/187062 [00:01<00:01, 68516.65it/s]
Adding feature api:  35%|███▌      | 65705/187062 [00:01<00:01, 70410.70it/s]
Adding feature api:  39%|███▉      | 73063/187062 [00:01<00:01, 71219.06it/s]
Adding feature api:  43%|████▎     | 80530/187062 [00:01<00:01, 72243.36it/s]
Adding feature api:  47%|████▋     | 88048/187062 [00:01<00:01, 73116.84it/s]
Adding feature api:  51%|█████     | 95504/187062 [00:01<00:01, 73546.97it/s]
Adding feature api:  55%|█████▌    | 103018/187062 [00:01<00:01, 74021.01it/s]
Adding feature api:  59%|█████▉    | 110475/187062 [00:01<00:01, 73896.72it/s]
Adding feature api:  63%|██████▎   | 117919/187062 [00:02<00:00, 74056.13it/s]
Adding feature api:  67%|██████▋   | 125492/187062 [00:02<00:00, 74556.22it/s]
Adding feature api:  71%|███████   | 133007/187062 [00:02<00:00, 74732.56it/s]
Adding feature api:  75%|███████▌  | 140494/187062 [00:02<00:00, 74765.96it/s]
Adding feature api:  79%|███████▉  | 147980/187062 [00:02<00:00, 74779.09it/s]
Adding feature api:  83%|████████▎ | 155465/187062 [00:02<00:00, 74270.32it/s]
Adding feature api:  87%|████████▋ | 162940/187062 [00:02<00:00, 74412.70it/s]
Adding feature api:  91%|█████████ | 170442/187062 [00:02<00:00, 74591.27it/s]
Adding feature api:  95%|█████████▌| 177904/187062 [00:02<00:00, 73575.71it/s]
Adding feature api:  99%|█████████▉| 185267/187062 [00:03<00:00, 48199.07it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 58347.88it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:32:57,  2.21it/s]
Adding feature datatype:   3%|▎         | 6113/187062 [00:00<00:12, 14649.53it/s]
Adding feature datatype:   7%|▋         | 13129/187062 [00:00<00:06, 28806.29it/s]
Adding feature datatype:  11%|█         | 20000/187062 [00:00<00:04, 39461.86it/s]
Adding feature datatype:  15%|█▍        | 27139/187062 [00:00<00:03, 48277.87it/s]
Adding feature datatype:  18%|█▊        | 34232/187062 [00:00<00:02, 54684.26it/s]
Adding feature datatype:  22%|██▏       | 41420/187062 [00:01<00:02, 59631.13it/s]
Adding feature datatype:  26%|██▌       | 48598/187062 [00:01<00:02, 63170.00it/s]
Adding feature datatype:  30%|██▉       | 55743/187062 [00:01<00:02, 65602.66it/s]
Adding feature datatype:  34%|███▎      | 62721/187062 [00:01<00:01, 66553.98it/s]
Adding feature datatype:  37%|███▋      | 69891/187062 [00:01<00:01, 68076.18it/s]
Adding feature datatype:  41%|████      | 77050/187062 [00:01<00:01, 69119.24it/s]
Adding feature datatype:  45%|████▌     | 84216/187062 [00:01<00:01, 69874.88it/s]
Adding feature datatype:  49%|████▉     | 91384/187062 [00:01<00:01, 70412.22it/s]
Adding feature datatype:  53%|█████▎    | 98543/187062 [00:01<00:01, 70762.12it/s]
Adding feature datatype:  56%|█████▋    | 105671/187062 [00:01<00:01, 70245.12it/s]
Adding feature datatype:  60%|██████    | 112824/187062 [00:02<00:01, 70626.68it/s]
Adding feature datatype:  64%|██████▍   | 119984/187062 [00:02<00:00, 70915.04it/s]
Adding feature datatype:  68%|██████▊   | 127161/187062 [00:02<00:00, 71169.64it/s]
Adding feature datatype:  72%|███████▏  | 134354/187062 [00:02<00:00, 71395.18it/s]
Adding feature datatype:  76%|███████▌  | 141503/187062 [00:02<00:00, 70803.41it/s]
Adding feature datatype:  79%|███████▉  | 148662/187062 [00:02<00:00, 71035.12it/s]
Adding feature datatype:  83%|████████▎ | 155841/187062 [00:02<00:00, 71257.06it/s]
Adding feature datatype:  87%|████████▋ | 162971/187062 [00:02<00:00, 71163.93it/s]
Adding feature datatype:  91%|█████████ | 170150/187062 [00:02<00:00, 71350.17it/s]
Adding feature datatype:  95%|█████████▍| 177335/187062 [00:02<00:00, 71497.61it/s]
Adding feature datatype:  99%|█████████▊| 184487/187062 [00:03<00:00, 47789.42it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 56490.20it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:23:23,  2.22it/s]
Adding feature literal:   3%|▎         | 5823/187062 [00:00<00:12, 14026.57it/s]
Adding feature literal:   7%|▋         | 12656/187062 [00:00<00:06, 27929.31it/s]
Adding feature literal:  10%|█         | 19024/187062 [00:00<00:04, 37503.03it/s]
Adding feature literal:  14%|█▎        | 25469/187062 [00:00<00:03, 44958.91it/s]
Adding feature literal:  17%|█▋        | 32593/187062 [00:00<00:02, 52402.95it/s]
Adding feature literal:  21%|██▏       | 39792/187062 [00:01<00:02, 58045.05it/s]
Adding feature literal:  25%|██▍       | 46660/187062 [00:01<00:02, 61143.04it/s]
Adding feature literal:  29%|██▉       | 53802/187062 [00:01<00:02, 64163.41it/s]
Adding feature literal:  33%|███▎      | 60980/187062 [00:01<00:01, 66414.02it/s]
Adding feature literal:  36%|███▋      | 68163/187062 [00:01<00:01, 68019.81it/s]
Adding feature literal:  40%|████      | 75332/187062 [00:01<00:01, 69112.10it/s]
Adding feature literal:  44%|████▍     | 82389/187062 [00:01<00:01, 69036.37it/s]
Adding feature literal:  48%|████▊     | 89534/187062 [00:01<00:01, 69752.39it/s]
Adding feature literal:  52%|█████▏    | 96722/187062 [00:01<00:01, 70385.79it/s]
Adding feature literal:  56%|█████▌    | 103854/187062 [00:01<00:01, 70662.02it/s]
Adding feature literal:  59%|█████▉    | 111033/187062 [00:02<00:01, 70997.59it/s]
Adding feature literal:  63%|██████▎   | 118203/187062 [00:02<00:00, 71204.48it/s]
Adding feature literal:  67%|██████▋   | 125446/187062 [00:02<00:00, 71569.96it/s]
Adding feature literal:  71%|███████   | 132616/187062 [00:02<00:00, 70755.66it/s]
Adding feature literal:  75%|███████▍  | 139795/187062 [00:02<00:00, 71061.39it/s]
Adding feature literal:  79%|███████▊  | 146980/187062 [00:02<00:00, 71293.33it/s]
Adding feature literal:  82%|████████▏ | 154166/187062 [00:02<00:00, 71461.21it/s]
Adding feature literal:  86%|████████▌ | 161320/187062 [00:02<00:00, 71483.57it/s]
Adding feature literal:  90%|█████████ | 168496/187062 [00:02<00:00, 71565.26it/s]
Adding feature literal:  94%|█████████▍| 175655/187062 [00:02<00:00, 71369.33it/s]
Adding feature literal:  98%|█████████▊| 182794/187062 [00:03<00:00, 51307.36it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 56152.48it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:24:52,  2.22it/s]
Adding feature operator:   3%|▎         | 6144/187062 [00:00<00:12, 14788.40it/s]
Adding feature operator:   7%|▋         | 13203/187062 [00:00<00:05, 29066.58it/s]
Adding feature operator:  11%|█         | 20321/187062 [00:00<00:04, 40338.34it/s]
Adding feature operator:  15%|█▍        | 27472/187062 [00:00<00:03, 48960.25it/s]
Adding feature operator:  19%|█▊        | 34630/187062 [00:00<00:02, 55366.15it/s]
Adding feature operator:  22%|██▏       | 41835/187062 [00:01<00:02, 60162.88it/s]
Adding feature operator:  26%|██▌       | 49036/187062 [00:01<00:02, 63615.63it/s]
Adding feature operator:  30%|███       | 56245/187062 [00:01<00:01, 66104.65it/s]
Adding feature operator:  34%|███▍      | 63448/187062 [00:01<00:01, 67856.35it/s]
Adding feature operator:  38%|███▊      | 70664/187062 [00:01<00:01, 69132.89it/s]
Adding feature operator:  42%|████▏     | 77896/187062 [00:01<00:01, 70081.32it/s]
Adding feature operator:  45%|████▌     | 85071/187062 [00:01<00:01, 70578.99it/s]
Adding feature operator:  49%|████▉     | 92289/187062 [00:01<00:01, 71057.15it/s]
Adding feature operator:  53%|█████▎    | 99500/187062 [00:01<00:01, 71370.22it/s]
Adding feature operator:  57%|█████▋    | 106762/187062 [00:01<00:01, 71743.00it/s]
Adding feature operator:  61%|██████    | 113973/187062 [00:02<00:01, 71827.84it/s]
Adding feature operator:  65%|██████▍   | 121181/187062 [00:02<00:00, 71722.64it/s]
Adding feature operator:  69%|██████▊   | 128421/187062 [00:02<00:00, 71922.99it/s]
Adding feature operator:  73%|███████▎  | 135626/187062 [00:02<00:00, 71960.02it/s]
Adding feature operator:  76%|███████▋  | 142831/187062 [00:02<00:00, 71907.13it/s]
Adding feature operator:  80%|████████  | 150028/187062 [00:02<00:00, 71814.08it/s]
Adding feature operator:  84%|████████▍ | 157216/187062 [00:02<00:00, 71831.32it/s]
Adding feature operator:  88%|████████▊ | 164403/187062 [00:02<00:00, 71838.93it/s]
Adding feature operator:  92%|█████████▏| 171589/187062 [00:02<00:00, 71798.12it/s]
Adding feature operator:  96%|█████████▌| 178771/187062 [00:02<00:00, 66668.41it/s]
Adding feature operator:  99%|█████████▉| 185512/187062 [00:03<00:00, 46705.05it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 56990.84it/s]
[2024-10-12 23:49:45,278] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/12/2024 23:49:46 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/12/2024 23:49:46 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:16, 388.38 examples/s]
Map:   1%|▏         | 83/6548 [00:00<00:32, 199.31 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:24, 261.44 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 314.62 examples/s]
Map:   3%|▎         | 225/6548 [00:00<00:17, 359.35 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:17, 361.02 examples/s]
Map:   5%|▌         | 346/6548 [00:01<00:19, 313.80 examples/s]
Map:   6%|▌         | 395/6548 [00:01<00:19, 317.04 examples/s]
Map:   7%|▋         | 435/6548 [00:01<00:18, 329.50 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 322.93 examples/s]
Map:   8%|▊         | 511/6548 [00:01<00:17, 338.19 examples/s]
Map:   9%|▊         | 563/6548 [00:01<00:15, 381.91 examples/s]
Map:   9%|▉         | 606/6548 [00:01<00:15, 391.77 examples/s]
Map:  10%|█         | 666/6548 [00:02<00:17, 341.83 examples/s]
Map:  11%|█         | 711/6548 [00:02<00:16, 364.80 examples/s]
Map:  12%|█▏        | 756/6548 [00:02<00:15, 384.12 examples/s]
Map:  12%|█▏        | 810/6548 [00:02<00:13, 422.67 examples/s]
Map:  13%|█▎        | 876/6548 [00:02<00:13, 410.79 examples/s]
Map:  14%|█▍        | 932/6548 [00:02<00:14, 383.68 examples/s]
Map:  15%|█▍        | 972/6548 [00:02<00:14, 384.75 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:23, 234.11 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 259.77 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:18, 294.33 examples/s]
Map:  18%|█▊        | 1146/6548 [00:03<00:16, 331.47 examples/s]
Map:  18%|█▊        | 1207/6548 [00:03<00:15, 349.91 examples/s]
Map:  19%|█▉        | 1267/6548 [00:03<00:14, 355.46 examples/s]
Map:  20%|██        | 1322/6548 [00:03<00:14, 351.01 examples/s]
Map:  21%|██        | 1362/6548 [00:04<00:16, 323.85 examples/s]
Map:  21%|██▏       | 1407/6548 [00:04<00:16, 310.49 examples/s]
Map:  22%|██▏       | 1459/6548 [00:04<00:16, 303.47 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:17, 281.94 examples/s]
Map:  24%|██▎       | 1549/6548 [00:04<00:18, 274.12 examples/s]
Map:  24%|██▍       | 1579/6548 [00:04<00:17, 276.68 examples/s]
Map:  25%|██▍       | 1609/6548 [00:05<00:18, 274.20 examples/s]
Map:  25%|██▌       | 1639/6548 [00:05<00:17, 278.59 examples/s]
Map:  26%|██▌       | 1679/6548 [00:05<00:18, 269.36 examples/s]
Map:  26%|██▋       | 1721/6548 [00:05<00:15, 302.72 examples/s]
Map:  27%|██▋       | 1767/6548 [00:05<00:14, 332.74 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:13, 346.27 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 356.68 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 353.15 examples/s]
Map:  30%|██▉       | 1960/6548 [00:06<00:13, 345.37 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:19, 235.48 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:18, 245.49 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:16, 275.61 examples/s]
Map:  32%|███▏      | 2107/6548 [00:06<00:15, 289.83 examples/s]
Map:  33%|███▎      | 2143/6548 [00:06<00:17, 256.28 examples/s]
Map:  33%|███▎      | 2181/6548 [00:06<00:15, 279.87 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 288.15 examples/s]
Map:  34%|███▍      | 2247/6548 [00:07<00:16, 265.50 examples/s]
Map:  35%|███▌      | 2294/6548 [00:07<00:15, 276.91 examples/s]
Map:  36%|███▌      | 2335/6548 [00:07<00:13, 305.16 examples/s]
Map:  36%|███▋      | 2376/6548 [00:07<00:13, 301.22 examples/s]
Map:  37%|███▋      | 2418/6548 [00:07<00:12, 327.61 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:12, 320.10 examples/s]
Map:  38%|███▊      | 2496/6548 [00:07<00:12, 319.97 examples/s]
Map:  39%|███▉      | 2557/6548 [00:08<00:11, 338.18 examples/s]
Map:  40%|███▉      | 2602/6548 [00:08<00:10, 362.18 examples/s]
Map:  40%|████      | 2643/6548 [00:08<00:10, 373.68 examples/s]
Map:  41%|████      | 2698/6548 [00:08<00:10, 360.07 examples/s]
Map:  42%|████▏     | 2737/6548 [00:08<00:10, 352.64 examples/s]
Map:  42%|████▏     | 2775/6548 [00:08<00:10, 357.62 examples/s]
Map:  43%|████▎     | 2824/6548 [00:08<00:10, 344.56 examples/s]
Map:  44%|████▎     | 2862/6548 [00:09<00:12, 291.43 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 297.67 examples/s]
Map:  45%|████▌     | 2950/6548 [00:09<00:11, 305.73 examples/s]
Map:  46%|████▌     | 2984/6548 [00:09<00:11, 309.85 examples/s]
Map:  46%|████▌     | 3027/6548 [00:09<00:19, 176.12 examples/s]
Map:  47%|████▋     | 3058/6548 [00:10<00:17, 195.18 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:15, 218.59 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 259.94 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:12, 261.94 examples/s]
Map:  49%|████▉     | 3204/6548 [00:10<00:14, 237.40 examples/s]
Map:  50%|████▉     | 3245/6548 [00:10<00:13, 246.98 examples/s]
Map:  50%|█████     | 3280/6548 [00:10<00:12, 265.93 examples/s]
Map:  51%|█████     | 3322/6548 [00:10<00:10, 297.53 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:11<00:10, 298.20 examples/s]
Map:  52%|█████▏    | 3404/6548 [00:11<00:11, 276.46 examples/s]
Map:  53%|█████▎    | 3439/6548 [00:11<00:10, 289.66 examples/s]
Map:  53%|█████▎    | 3479/6548 [00:11<00:11, 260.51 examples/s]
Map:  54%|█████▍    | 3524/6548 [00:11<00:10, 301.45 examples/s]
Map:  54%|█████▍    | 3566/6548 [00:11<00:09, 325.53 examples/s]
Map:  55%|█████▌    | 3614/6548 [00:11<00:08, 360.41 examples/s]
Map:  56%|█████▌    | 3669/6548 [00:11<00:07, 359.90 examples/s]
Map:  57%|█████▋    | 3713/6548 [00:12<00:07, 378.75 examples/s]
Map:  58%|█████▊    | 3774/6548 [00:12<00:07, 373.21 examples/s]
Map:  58%|█████▊    | 3820/6548 [00:12<00:08, 338.23 examples/s]
Map:  59%|█████▉    | 3865/6548 [00:12<00:08, 316.27 examples/s]
Map:  60%|█████▉    | 3914/6548 [00:12<00:07, 332.45 examples/s]
Map:  61%|██████    | 3973/6548 [00:12<00:07, 336.58 examples/s]
Map:  62%|██████▏   | 4030/6548 [00:13<00:09, 257.65 examples/s]
Map:  62%|██████▏   | 4078/6548 [00:13<00:08, 295.09 examples/s]
Map:  63%|██████▎   | 4121/6548 [00:13<00:07, 316.44 examples/s]
Map:  64%|██████▎   | 4168/6548 [00:13<00:07, 297.87 examples/s]
Map:  64%|██████▍   | 4210/6548 [00:13<00:07, 312.68 examples/s]
Map:  65%|██████▍   | 4255/6548 [00:13<00:06, 341.15 examples/s]
Map:  66%|██████▌   | 4294/6548 [00:13<00:06, 352.27 examples/s]
Map:  66%|██████▋   | 4342/6548 [00:14<00:05, 376.37 examples/s]
Map:  67%|██████▋   | 4397/6548 [00:14<00:05, 370.88 examples/s]
Map:  68%|██████▊   | 4438/6548 [00:14<00:05, 378.00 examples/s]
Map:  69%|██████▊   | 4486/6548 [00:14<00:05, 352.49 examples/s]
Map:  69%|██████▉   | 4528/6548 [00:14<00:06, 320.42 examples/s]
Map:  70%|██████▉   | 4562/6548 [00:14<00:06, 322.28 examples/s]
Map:  71%|███████   | 4619/6548 [00:14<00:05, 337.97 examples/s]
Map:  71%|███████▏  | 4666/6548 [00:14<00:05, 367.61 examples/s]
Map:  72%|███████▏  | 4726/6548 [00:15<00:04, 371.91 examples/s]
Map:  73%|███████▎  | 4768/6548 [00:15<00:04, 380.07 examples/s]
Map:  74%|███████▎  | 4820/6548 [00:15<00:04, 414.27 examples/s]
Map:  75%|███████▍  | 4879/6548 [00:15<00:04, 358.28 examples/s]
Map:  75%|███████▌  | 4927/6548 [00:15<00:04, 366.42 examples/s]
Map:  76%|███████▌  | 4977/6548 [00:15<00:03, 395.48 examples/s]
Map:  77%|███████▋  | 5040/6548 [00:16<00:06, 242.16 examples/s]
Map:  78%|███████▊  | 5081/6548 [00:16<00:06, 243.88 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 255.59 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:05, 273.42 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 278.59 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:16<00:04, 294.12 examples/s]
Map:  81%|████████  | 5286/6548 [00:16<00:03, 331.63 examples/s]
Map:  81%|████████▏ | 5323/6548 [00:17<00:03, 339.48 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 311.65 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 303.54 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 332.58 examples/s]
Map:  84%|████████▍ | 5492/6548 [00:17<00:03, 344.58 examples/s]
Map:  84%|████████▍ | 5528/6548 [00:17<00:02, 343.91 examples/s]
Map:  85%|████████▌ | 5567/6548 [00:17<00:02, 353.88 examples/s]
Map:  86%|████████▌ | 5610/6548 [00:17<00:02, 316.05 examples/s]
Map:  86%|████████▌ | 5647/6548 [00:18<00:02, 326.52 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 319.98 examples/s]
Map:  87%|████████▋ | 5722/6548 [00:18<00:02, 334.43 examples/s]
Map:  88%|████████▊ | 5765/6548 [00:18<00:02, 357.51 examples/s]
Map:  89%|████████▉ | 5819/6548 [00:18<00:02, 354.51 examples/s]
Map:  90%|████████▉ | 5869/6548 [00:18<00:02, 339.48 examples/s]
Map:  90%|█████████ | 5912/6548 [00:18<00:01, 355.06 examples/s]
Map:  91%|█████████ | 5964/6548 [00:18<00:01, 329.46 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 226.28 examples/s]
Map:  92%|█████████▏| 6041/6548 [00:19<00:01, 258.81 examples/s]
Map:  93%|█████████▎| 6081/6548 [00:19<00:01, 286.20 examples/s]
Map:  94%|█████████▎| 6123/6548 [00:19<00:01, 279.26 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:19<00:01, 297.24 examples/s]
Map:  95%|█████████▍| 6206/6548 [00:19<00:01, 317.93 examples/s]
Map:  95%|█████████▌| 6247/6548 [00:20<00:00, 336.79 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 339.56 examples/s]
Map:  97%|█████████▋| 6338/6548 [00:20<00:00, 343.22 examples/s]
Map:  97%|█████████▋| 6380/6548 [00:20<00:00, 346.82 examples/s]
Map:  98%|█████████▊| 6421/6548 [00:20<00:00, 359.74 examples/s]
Map:  99%|█████████▉| 6471/6548 [00:20<00:00, 392.16 examples/s]
Map: 100%|█████████▉| 6529/6548 [00:20<00:00, 375.10 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 312.98 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 324.27 examples/s]
Map:   8%|▊         | 73/903 [00:00<00:02, 348.71 examples/s]
Map:  13%|█▎        | 118/903 [00:00<00:02, 313.16 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 333.57 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 389.23 examples/s]
Map:  29%|██▉       | 260/903 [00:00<00:01, 358.36 examples/s]
Map:  33%|███▎      | 302/903 [00:00<00:01, 358.53 examples/s]
Map:  39%|███▊      | 348/903 [00:01<00:01, 336.76 examples/s]
Map:  43%|████▎     | 386/903 [00:01<00:01, 286.91 examples/s]
Map:  46%|████▋     | 418/903 [00:01<00:01, 289.07 examples/s]
Map:  50%|█████     | 456/903 [00:01<00:01, 293.29 examples/s]
Map:  56%|█████▌    | 502/903 [00:01<00:01, 293.97 examples/s]
Map:  61%|██████    | 550/903 [00:01<00:01, 333.65 examples/s]
Map:  66%|██████▌   | 597/903 [00:01<00:00, 365.54 examples/s]
Map:  70%|███████   | 636/903 [00:01<00:00, 367.14 examples/s]
Map:  75%|███████▍  | 677/903 [00:01<00:00, 374.93 examples/s]
Map:  82%|████████▏ | 740/903 [00:02<00:00, 386.83 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 384.60 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 387.80 examples/s]
Map:  96%|█████████▌| 867/903 [00:02<00:00, 391.21 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 314.39 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 296.58 examples/s]
Map:   4%|▍         | 82/1882 [00:00<00:04, 368.41 examples/s]
Map:   7%|▋         | 129/1882 [00:00<00:05, 320.38 examples/s]
Map:   9%|▉         | 172/1882 [00:00<00:04, 353.48 examples/s]
Map:  12%|█▏        | 228/1882 [00:00<00:04, 346.37 examples/s]
Map:  14%|█▍        | 270/1882 [00:00<00:04, 365.05 examples/s]
Map:  17%|█▋        | 325/1882 [00:00<00:04, 359.76 examples/s]
Map:  19%|█▉        | 364/1882 [00:01<00:04, 322.75 examples/s]
Map:  22%|██▏       | 414/1882 [00:01<00:05, 285.31 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 295.17 examples/s]
Map:  26%|██▌       | 491/1882 [00:01<00:04, 325.90 examples/s]
Map:  29%|██▊       | 538/1882 [00:01<00:04, 305.34 examples/s]
Map:  31%|███       | 580/1882 [00:01<00:03, 330.63 examples/s]
Map:  34%|███▍      | 638/1882 [00:01<00:03, 389.05 examples/s]
Map:  37%|███▋      | 696/1882 [00:02<00:03, 379.50 examples/s]
Map:  40%|████      | 759/1882 [00:02<00:02, 390.15 examples/s]
Map:  43%|████▎     | 800/1882 [00:02<00:03, 333.62 examples/s]
Map:  45%|████▍     | 841/1882 [00:02<00:02, 348.59 examples/s]
Map:  47%|████▋     | 878/1882 [00:02<00:02, 352.76 examples/s]
Map:  49%|████▉     | 920/1882 [00:02<00:02, 368.09 examples/s]
Map:  51%|█████▏    | 968/1882 [00:02<00:02, 395.79 examples/s]
Map:  54%|█████▍    | 1016/1882 [00:03<00:03, 237.13 examples/s]
Map:  56%|█████▌    | 1053/1882 [00:03<00:03, 260.34 examples/s]
Map:  58%|█████▊    | 1091/1882 [00:03<00:02, 279.02 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 287.92 examples/s]
Map:  62%|██████▏   | 1173/1882 [00:03<00:02, 291.30 examples/s]
Map:  64%|██████▍   | 1213/1882 [00:03<00:02, 279.16 examples/s]
Map:  66%|██████▋   | 1250/1882 [00:03<00:02, 296.38 examples/s]
Map:  69%|██████▊   | 1290/1882 [00:03<00:01, 320.35 examples/s]
Map:  71%|███████   | 1335/1882 [00:04<00:01, 351.02 examples/s]
Map:  73%|███████▎  | 1382/1882 [00:04<00:01, 336.03 examples/s]
Map:  75%|███████▌  | 1419/1882 [00:04<00:01, 298.42 examples/s]
Map:  78%|███████▊  | 1465/1882 [00:04<00:01, 297.57 examples/s]
Map:  80%|███████▉  | 1503/1882 [00:04<00:01, 260.71 examples/s]
Map:  81%|████████▏ | 1533/1882 [00:04<00:01, 268.60 examples/s]
Map:  83%|████████▎ | 1568/1882 [00:04<00:01, 286.43 examples/s]
Map:  86%|████████▌ | 1618/1882 [00:05<00:00, 338.62 examples/s]
Map:  88%|████████▊ | 1655/1882 [00:05<00:00, 299.01 examples/s]
Map:  90%|█████████ | 1703/1882 [00:05<00:00, 300.89 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 265.97 examples/s]
Map:  95%|█████████▍| 1785/1882 [00:05<00:00, 272.21 examples/s]
Map:  97%|█████████▋| 1830/1882 [00:05<00:00, 310.70 examples/s]
Map: 100%|█████████▉| 1875/1882 [00:05<00:00, 342.03 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 305.89 examples/s]
10/12/2024 23:50:49 - INFO - __main__ -     ***** Testing *****
10/12/2024 23:50:49 - INFO - __main__ -     Batch size = 8
10/12/2024 23:50:49 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/12/2024 23:50:49 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/12/2024 23:50:49 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/12/2024 23:50:50 - INFO - knnlm -   Reading datastore took 0.9219164848327637 s
10/12/2024 23:50:51 - INFO - knnlm -   Moving index to GPU took 0.9141216278076172 s
10/12/2024 23:50:51 - INFO - __main__ -   ******************************break-into
10/12/2024 23:50:51 - INFO - __main__ -     ***** Running acc evaluation *****
10/12/2024 23:50:51 - INFO - __main__ -     Num examples = 236
10/12/2024 23:50:51 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<31:11,  7.97s/it]
test ppl:   1%|          | 2/236 [00:09<17:14,  4.42s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:58,  3.08s/it]
test ppl:   2%|▏         | 4/236 [00:13<09:42,  2.51s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:15,  3.70s/it]
test ppl:   3%|▎         | 6/236 [00:21<12:22,  3.23s/it]
test ppl:   3%|▎         | 7/236 [00:23<11:26,  3.00s/it]
test ppl:   3%|▎         | 8/236 [00:27<12:55,  3.40s/it]
test ppl:   4%|▍         | 9/236 [00:33<15:44,  4.16s/it]
test ppl:   4%|▍         | 10/236 [00:36<14:13,  3.78s/it]
test ppl:   5%|▍         | 11/236 [00:39<12:31,  3.34s/it]
test ppl:   5%|▌         | 12/236 [00:44<15:17,  4.10s/it]
test ppl:   6%|▌         | 13/236 [00:50<17:10,  4.62s/it]
test ppl:   6%|▌         | 14/236 [00:52<14:30,  3.92s/it]
test ppl:   6%|▋         | 15/236 [00:55<13:06,  3.56s/it]
test ppl:   7%|▋         | 16/236 [00:57<11:10,  3.05s/it]
test ppl:   7%|▋         | 17/236 [01:03<14:10,  3.89s/it]
test ppl:   8%|▊         | 18/236 [01:05<11:42,  3.22s/it]
test ppl:   8%|▊         | 19/236 [01:09<12:57,  3.58s/it]
test ppl:   8%|▊         | 20/236 [01:11<10:56,  3.04s/it]
test ppl:   9%|▉         | 21/236 [01:13<10:04,  2.81s/it]
test ppl:   9%|▉         | 22/236 [01:19<13:17,  3.73s/it]
test ppl:  10%|▉         | 23/236 [01:21<11:55,  3.36s/it]
test ppl:  10%|█         | 24/236 [01:24<10:48,  3.06s/it]
test ppl:  11%|█         | 25/236 [01:26<09:27,  2.69s/it]
test ppl:  11%|█         | 26/236 [01:31<12:44,  3.64s/it]
test ppl:  11%|█▏        | 27/236 [01:36<13:11,  3.79s/it]
test ppl:  12%|█▏        | 28/236 [01:37<10:33,  3.04s/it]
test ppl:  12%|█▏        | 29/236 [01:39<09:45,  2.83s/it]
test ppl:  13%|█▎        | 30/236 [01:41<08:21,  2.43s/it]
test ppl:  13%|█▎        | 31/236 [01:43<08:18,  2.43s/it]
test ppl:  14%|█▎        | 32/236 [01:47<09:28,  2.79s/it]
test ppl:  14%|█▍        | 33/236 [01:54<14:14,  4.21s/it]
test ppl:  14%|█▍        | 34/236 [01:59<14:59,  4.45s/it]
test ppl:  15%|█▍        | 35/236 [02:02<13:34,  4.05s/it]
test ppl:  15%|█▌        | 36/236 [02:10<16:51,  5.06s/it]
test ppl:  16%|█▌        | 37/236 [02:17<18:58,  5.72s/it]
test ppl:  16%|█▌        | 38/236 [02:20<15:43,  4.77s/it]
test ppl:  17%|█▋        | 39/236 [02:22<12:45,  3.89s/it]
test ppl:  17%|█▋        | 40/236 [02:25<12:08,  3.72s/it]
test ppl:  17%|█▋        | 41/236 [02:28<11:28,  3.53s/it]
test ppl:  18%|█▊        | 42/236 [02:35<15:06,  4.67s/it]
test ppl:  18%|█▊        | 43/236 [02:43<17:31,  5.45s/it]
test ppl:  19%|█▊        | 44/236 [02:45<14:56,  4.67s/it]
test ppl:  19%|█▉        | 45/236 [02:48<12:43,  4.00s/it]
test ppl:  19%|█▉        | 46/236 [02:55<15:49,  5.00s/it]
test ppl:  20%|█▉        | 47/236 [03:02<17:57,  5.70s/it]
test ppl:  20%|██        | 48/236 [03:10<19:19,  6.17s/it]
test ppl:  21%|██        | 49/236 [03:17<20:15,  6.50s/it]
test ppl:  21%|██        | 50/236 [03:24<20:55,  6.75s/it]
test ppl:  22%|██▏       | 51/236 [03:32<21:19,  6.91s/it]
test ppl:  22%|██▏       | 52/236 [03:39<21:32,  7.03s/it]
test ppl:  22%|██▏       | 53/236 [03:44<19:57,  6.55s/it]
test ppl:  23%|██▎       | 54/236 [03:46<15:36,  5.15s/it]
test ppl:  23%|██▎       | 55/236 [03:53<17:11,  5.70s/it]
test ppl:  24%|██▎       | 56/236 [03:57<15:44,  5.25s/it]
test ppl:  24%|██▍       | 57/236 [04:01<13:48,  4.63s/it]
test ppl:  25%|██▍       | 58/236 [04:02<11:14,  3.79s/it]
test ppl:  25%|██▌       | 59/236 [04:08<13:06,  4.44s/it]
test ppl:  25%|██▌       | 60/236 [04:12<12:00,  4.09s/it]
test ppl:  26%|██▌       | 61/236 [04:18<13:36,  4.66s/it]
test ppl:  26%|██▋       | 62/236 [04:22<13:08,  4.53s/it]
test ppl:  27%|██▋       | 63/236 [04:25<12:10,  4.22s/it]
test ppl:  27%|██▋       | 64/236 [04:27<09:46,  3.41s/it]
test ppl:  28%|██▊       | 65/236 [04:28<07:56,  2.79s/it]
test ppl:  28%|██▊       | 66/236 [04:31<08:03,  2.84s/it]
test ppl:  28%|██▊       | 67/236 [04:35<08:59,  3.19s/it]
test ppl:  29%|██▉       | 68/236 [04:41<11:12,  4.00s/it]
test ppl:  29%|██▉       | 69/236 [04:46<11:37,  4.18s/it]
test ppl:  30%|██▉       | 70/236 [04:47<09:25,  3.41s/it]
test ppl:  30%|███       | 71/236 [04:51<09:32,  3.47s/it]
test ppl:  31%|███       | 72/236 [04:55<09:46,  3.58s/it]
test ppl:  31%|███       | 73/236 [04:59<09:57,  3.67s/it]
test ppl:  31%|███▏      | 74/236 [05:00<08:09,  3.02s/it]
test ppl:  32%|███▏      | 75/236 [05:06<10:24,  3.88s/it]
test ppl:  32%|███▏      | 76/236 [05:10<10:48,  4.05s/it]
test ppl:  33%|███▎      | 77/236 [05:13<09:19,  3.52s/it]
test ppl:  33%|███▎      | 78/236 [05:15<07:59,  3.04s/it]
test ppl:  33%|███▎      | 79/236 [05:20<09:29,  3.63s/it]
test ppl:  34%|███▍      | 80/236 [05:22<08:06,  3.12s/it]
test ppl:  34%|███▍      | 81/236 [05:27<10:10,  3.94s/it]
test ppl:  35%|███▍      | 82/236 [05:33<11:36,  4.53s/it]
test ppl:  35%|███▌      | 83/236 [05:35<09:37,  3.77s/it]
test ppl:  36%|███▌      | 84/236 [05:37<08:07,  3.21s/it]
test ppl:  36%|███▌      | 85/236 [05:41<08:45,  3.48s/it]
test ppl:  36%|███▋      | 86/236 [05:44<07:43,  3.09s/it]
test ppl:  37%|███▋      | 87/236 [05:46<07:22,  2.97s/it]
test ppl:  37%|███▋      | 88/236 [05:52<09:26,  3.83s/it]
test ppl:  38%|███▊      | 89/236 [05:55<08:39,  3.54s/it]
test ppl:  38%|███▊      | 90/236 [06:01<10:18,  4.24s/it]
test ppl:  39%|███▊      | 91/236 [06:07<11:24,  4.72s/it]
test ppl:  39%|███▉      | 92/236 [06:09<09:56,  4.14s/it]
test ppl:  39%|███▉      | 93/236 [06:15<11:05,  4.65s/it]
test ppl:  40%|███▉      | 94/236 [06:21<11:52,  5.02s/it]
test ppl:  40%|████      | 95/236 [06:23<09:48,  4.18s/it]
test ppl:  41%|████      | 96/236 [06:26<08:53,  3.81s/it]
test ppl:  41%|████      | 97/236 [06:32<10:15,  4.43s/it]
test ppl:  42%|████▏     | 98/236 [06:38<11:11,  4.86s/it]
test ppl:  42%|████▏     | 99/236 [06:44<11:47,  5.16s/it]
test ppl:  42%|████▏     | 100/236 [06:45<09:05,  4.01s/it]
test ppl:  43%|████▎     | 101/236 [06:51<10:17,  4.57s/it]
test ppl:  43%|████▎     | 102/236 [06:55<09:34,  4.29s/it]
test ppl:  44%|████▎     | 103/236 [06:57<08:03,  3.64s/it]
test ppl:  44%|████▍     | 104/236 [07:01<08:24,  3.82s/it]
test ppl:  44%|████▍     | 105/236 [07:05<08:24,  3.85s/it]
test ppl:  45%|████▍     | 106/236 [07:10<09:20,  4.31s/it]
test ppl:  45%|████▌     | 107/236 [07:13<07:48,  3.63s/it]
test ppl:  46%|████▌     | 108/236 [07:18<09:04,  4.25s/it]
test ppl:  46%|████▌     | 109/236 [07:23<09:16,  4.38s/it]
test ppl:  47%|████▋     | 110/236 [07:25<07:34,  3.61s/it]
test ppl:  47%|████▋     | 111/236 [07:29<07:42,  3.70s/it]
test ppl:  47%|████▋     | 112/236 [07:33<07:58,  3.86s/it]
test ppl:  48%|████▊     | 113/236 [07:35<06:36,  3.23s/it]
test ppl:  48%|████▊     | 114/236 [07:38<06:36,  3.25s/it]
test ppl:  49%|████▊     | 115/236 [07:44<08:08,  4.04s/it]
test ppl:  49%|████▉     | 116/236 [07:49<08:58,  4.49s/it]
test ppl:  50%|████▉     | 117/236 [07:51<07:19,  3.69s/it]
test ppl:  50%|█████     | 118/236 [07:55<07:31,  3.83s/it]
test ppl:  50%|█████     | 119/236 [07:59<07:09,  3.67s/it]
test ppl:  51%|█████     | 120/236 [08:00<05:44,  2.97s/it]
test ppl:  51%|█████▏    | 121/236 [08:06<07:21,  3.84s/it]
test ppl:  52%|█████▏    | 122/236 [08:11<07:49,  4.12s/it]
test ppl:  52%|█████▏    | 123/236 [08:13<06:38,  3.53s/it]
test ppl:  53%|█████▎    | 124/236 [08:15<06:09,  3.30s/it]
test ppl:  53%|█████▎    | 125/236 [08:18<05:39,  3.06s/it]
test ppl:  53%|█████▎    | 126/236 [08:22<05:57,  3.25s/it]
test ppl:  54%|█████▍    | 127/236 [08:24<05:09,  2.83s/it]
test ppl:  54%|█████▍    | 128/236 [08:26<04:47,  2.66s/it]
test ppl:  55%|█████▍    | 129/236 [08:30<05:32,  3.10s/it]
test ppl:  55%|█████▌    | 130/236 [08:33<05:26,  3.08s/it]
test ppl:  56%|█████▌    | 131/236 [08:39<06:51,  3.92s/it]
test ppl:  56%|█████▌    | 132/236 [08:41<06:02,  3.48s/it]
test ppl:  56%|█████▋    | 133/236 [08:45<06:11,  3.61s/it]
test ppl:  57%|█████▋    | 134/236 [08:51<07:08,  4.20s/it]
test ppl:  57%|█████▋    | 135/236 [08:57<07:53,  4.69s/it]
test ppl:  58%|█████▊    | 136/236 [08:58<06:06,  3.66s/it]
test ppl:  58%|█████▊    | 137/236 [09:04<07:09,  4.33s/it]
test ppl:  58%|█████▊    | 138/236 [09:07<06:31,  4.00s/it]
test ppl:  59%|█████▉    | 139/236 [09:10<05:46,  3.57s/it]
test ppl:  59%|█████▉    | 140/236 [09:11<04:49,  3.01s/it]
test ppl:  60%|█████▉    | 141/236 [09:16<05:45,  3.64s/it]
test ppl:  60%|██████    | 142/236 [09:18<04:59,  3.19s/it]
test ppl:  61%|██████    | 143/236 [09:24<06:12,  4.00s/it]
test ppl:  61%|██████    | 144/236 [09:27<05:33,  3.62s/it]
test ppl:  61%|██████▏   | 145/236 [09:33<06:20,  4.18s/it]
test ppl:  62%|██████▏   | 146/236 [09:37<06:24,  4.28s/it]
test ppl:  62%|██████▏   | 147/236 [09:43<07:03,  4.76s/it]
test ppl:  63%|██████▎   | 148/236 [09:49<07:31,  5.13s/it]
test ppl:  63%|██████▎   | 149/236 [09:52<06:40,  4.60s/it]
test ppl:  64%|██████▎   | 150/236 [09:56<06:19,  4.41s/it]
test ppl:  64%|██████▍   | 151/236 [10:02<06:52,  4.85s/it]
test ppl:  64%|██████▍   | 152/236 [10:08<07:12,  5.15s/it]
test ppl:  65%|██████▍   | 153/236 [10:14<07:24,  5.36s/it]
test ppl:  65%|██████▌   | 154/236 [10:16<06:09,  4.50s/it]
test ppl:  66%|██████▌   | 155/236 [10:19<05:20,  3.96s/it]
test ppl:  66%|██████▌   | 156/236 [10:21<04:33,  3.42s/it]
test ppl:  67%|██████▋   | 157/236 [10:23<04:01,  3.06s/it]
test ppl:  67%|██████▋   | 158/236 [10:29<05:04,  3.90s/it]
test ppl:  67%|██████▋   | 159/236 [10:33<04:58,  3.87s/it]
test ppl:  68%|██████▊   | 160/236 [10:34<03:52,  3.06s/it]
test ppl:  68%|██████▊   | 161/236 [10:36<03:11,  2.56s/it]
test ppl:  69%|██████▊   | 162/236 [10:39<03:22,  2.73s/it]
test ppl:  69%|██████▉   | 163/236 [10:41<03:15,  2.67s/it]
test ppl:  69%|██████▉   | 164/236 [10:45<03:33,  2.96s/it]
test ppl:  70%|██████▉   | 165/236 [10:49<03:55,  3.32s/it]
test ppl:  70%|███████   | 166/236 [10:53<03:52,  3.32s/it]
test ppl:  71%|███████   | 167/236 [10:54<03:11,  2.77s/it]
test ppl:  71%|███████   | 168/236 [10:58<03:39,  3.23s/it]
test ppl:  72%|███████▏  | 169/236 [11:04<04:20,  3.89s/it]
test ppl:  72%|███████▏  | 170/236 [11:10<04:56,  4.50s/it]
test ppl:  72%|███████▏  | 171/236 [11:11<03:50,  3.55s/it]
test ppl:  73%|███████▎  | 172/236 [11:17<04:32,  4.25s/it]
test ppl:  73%|███████▎  | 173/236 [11:20<04:13,  4.03s/it]
test ppl:  74%|███████▎  | 174/236 [11:24<04:07,  3.99s/it]
test ppl:  74%|███████▍  | 175/236 [11:26<03:24,  3.35s/it]
test ppl:  75%|███████▍  | 176/236 [11:31<03:48,  3.80s/it]
test ppl:  75%|███████▌  | 177/236 [11:37<04:21,  4.43s/it]
test ppl:  75%|███████▌  | 178/236 [11:43<04:42,  4.87s/it]
test ppl:  76%|███████▌  | 179/236 [11:49<04:55,  5.18s/it]
test ppl:  76%|███████▋  | 180/236 [11:53<04:39,  5.00s/it]
test ppl:  77%|███████▋  | 181/236 [11:59<04:49,  5.25s/it]
test ppl:  77%|███████▋  | 182/236 [12:01<03:49,  4.25s/it]
test ppl:  78%|███████▊  | 183/236 [12:03<03:13,  3.66s/it]
test ppl:  78%|███████▊  | 184/236 [12:05<02:35,  2.99s/it]
test ppl:  78%|███████▊  | 185/236 [12:09<02:53,  3.41s/it]
test ppl:  79%|███████▉  | 186/236 [12:15<03:27,  4.15s/it]
test ppl:  79%|███████▉  | 187/236 [12:21<03:49,  4.69s/it]
test ppl:  80%|███████▉  | 188/236 [12:27<04:02,  5.05s/it]
test ppl:  80%|████████  | 189/236 [12:33<04:09,  5.30s/it]
test ppl:  81%|████████  | 190/236 [12:36<03:41,  4.81s/it]
test ppl:  81%|████████  | 191/236 [12:41<03:30,  4.68s/it]
test ppl:  81%|████████▏ | 192/236 [12:43<02:58,  4.06s/it]
test ppl:  82%|████████▏ | 193/236 [12:49<03:18,  4.62s/it]
test ppl:  82%|████████▏ | 194/236 [12:52<02:48,  4.02s/it]
test ppl:  83%|████████▎ | 195/236 [12:55<02:33,  3.74s/it]
test ppl:  83%|████████▎ | 196/236 [12:57<02:08,  3.22s/it]
test ppl:  83%|████████▎ | 197/236 [12:59<01:52,  2.89s/it]
test ppl:  84%|████████▍ | 198/236 [13:05<02:23,  3.79s/it]
test ppl:  84%|████████▍ | 199/236 [13:08<02:08,  3.46s/it]
test ppl:  85%|████████▍ | 200/236 [13:14<02:30,  4.18s/it]
test ppl:  85%|████████▌ | 201/236 [13:16<02:03,  3.54s/it]
test ppl:  86%|████████▌ | 202/236 [13:20<02:11,  3.86s/it]
test ppl:  86%|████████▌ | 203/236 [13:26<02:27,  4.47s/it]
test ppl:  86%|████████▋ | 204/236 [13:28<01:54,  3.57s/it]
test ppl:  87%|████████▋ | 205/236 [13:34<02:12,  4.28s/it]
test ppl:  87%|████████▋ | 206/236 [13:37<01:59,  3.98s/it]
test ppl:  88%|████████▊ | 207/236 [13:43<02:11,  4.55s/it]
test ppl:  88%|████████▊ | 208/236 [13:46<01:55,  4.13s/it]
test ppl:  89%|████████▊ | 209/236 [13:52<02:06,  4.67s/it]
test ppl:  89%|████████▉ | 210/236 [13:54<01:43,  3.97s/it]
test ppl:  89%|████████▉ | 211/236 [13:59<01:45,  4.22s/it]
test ppl:  90%|████████▉ | 212/236 [14:04<01:48,  4.51s/it]
test ppl:  90%|█████████ | 213/236 [14:10<01:53,  4.91s/it]
test ppl:  91%|█████████ | 214/236 [14:12<01:26,  3.94s/it]
test ppl:  91%|█████████ | 215/236 [14:18<01:34,  4.52s/it]
test ppl:  92%|█████████▏| 216/236 [14:20<01:18,  3.93s/it]
test ppl:  92%|█████████▏| 217/236 [14:26<01:26,  4.55s/it]
test ppl:  92%|█████████▏| 218/236 [14:28<01:07,  3.77s/it]
test ppl:  93%|█████████▎| 219/236 [14:34<01:14,  4.41s/it]
test ppl:  93%|█████████▎| 220/236 [14:40<01:17,  4.85s/it]
test ppl:  94%|█████████▎| 221/236 [14:43<01:04,  4.33s/it]
test ppl:  94%|█████████▍| 222/236 [14:49<01:07,  4.80s/it]
test ppl:  94%|█████████▍| 223/236 [14:55<01:06,  5.13s/it]
test ppl:  95%|█████████▍| 224/236 [14:56<00:47,  3.98s/it]
test ppl:  95%|█████████▌| 225/236 [15:02<00:49,  4.54s/it]
test ppl:  96%|█████████▌| 226/236 [15:05<00:42,  4.24s/it]
test ppl:  96%|█████████▌| 227/236 [15:08<00:33,  3.68s/it]
test ppl:  97%|█████████▋| 228/236 [15:10<00:25,  3.18s/it]
test ppl:  97%|█████████▋| 229/236 [15:16<00:27,  3.99s/it]
test ppl:  97%|█████████▋| 230/236 [15:19<00:23,  3.85s/it]
test ppl:  98%|█████████▊| 231/236 [15:22<00:18,  3.70s/it]
test ppl:  98%|█████████▊| 232/236 [15:24<00:12,  3.11s/it]
test ppl:  99%|█████████▊| 233/236 [15:26<00:08,  2.82s/it]
test ppl:  99%|█████████▉| 234/236 [15:28<00:04,  2.34s/it]
test ppl: 100%|█████████▉| 235/236 [15:33<00:03,  3.40s/it]
test ppl: 100%|██████████| 236/236 [15:34<00:00,  2.58s/it]
test ppl: 100%|██████████| 236/236 [15:34<00:00,  3.96s/it]
10/13/2024 00:06:26 - INFO - __main__ -    em: 0.2099
10/13/2024 00:06:26 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/16_0.2_80_eval_results.json
16 0.2 80:  em: 0.2099

--------------------------------------------------------------------------------
Running experiment with knn_temp=80, lmbda=0.2, k=32
2024-10-13 00:06:33.203538: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-13 00:06:33.222962: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-13 00:06:33.244697: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-13 00:06:33.251297: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-13 00:06:33.267282: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-13 00:06:34.259389: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/13/2024 00:06:35 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.2, knn_temp=80, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/13/2024 00:06:35 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:58:01,  2.17it/s]
Adding feature api:   3%|▎         | 6413/187062 [00:00<00:11, 15164.24it/s]
Adding feature api:   7%|▋         | 13816/187062 [00:00<00:05, 30028.28it/s]
Adding feature api:  11%|█▏        | 21286/187062 [00:00<00:03, 41870.00it/s]
Adding feature api:  15%|█▌        | 28813/187062 [00:00<00:03, 51043.85it/s]
Adding feature api:  19%|█▉        | 36315/187062 [00:00<00:02, 57799.40it/s]
Adding feature api:  23%|██▎       | 43843/187062 [00:01<00:02, 62815.21it/s]
Adding feature api:  27%|██▋       | 51379/187062 [00:01<00:02, 66460.77it/s]
Adding feature api:  32%|███▏      | 58957/187062 [00:01<00:01, 69195.21it/s]
Adding feature api:  36%|███▌      | 66508/187062 [00:01<00:01, 71059.94it/s]
Adding feature api:  40%|███▉      | 74055/187062 [00:01<00:01, 72365.97it/s]
Adding feature api:  44%|████▎     | 81518/187062 [00:01<00:01, 72476.92it/s]
Adding feature api:  48%|████▊     | 89026/187062 [00:01<00:01, 73247.48it/s]
Adding feature api:  52%|█████▏    | 96550/187062 [00:01<00:01, 73838.02it/s]
Adding feature api:  56%|█████▌    | 104097/187062 [00:01<00:01, 74323.71it/s]
Adding feature api:  60%|█████▉    | 111727/187062 [00:01<00:01, 74911.30it/s]
Adding feature api:  64%|██████▍   | 119266/187062 [00:02<00:00, 75053.27it/s]
Adding feature api:  68%|██████▊   | 126815/187062 [00:02<00:00, 75180.79it/s]
Adding feature api:  72%|███████▏  | 134390/187062 [00:02<00:00, 75349.89it/s]
Adding feature api:  76%|███████▌  | 141953/187062 [00:02<00:00, 75431.06it/s]
Adding feature api:  80%|███████▉  | 149517/187062 [00:02<00:00, 75490.81it/s]
Adding feature api:  84%|████████▍ | 157073/187062 [00:02<00:00, 75418.73it/s]
Adding feature api:  88%|████████▊ | 164646/187062 [00:02<00:00, 75509.38it/s]
Adding feature api:  92%|█████████▏| 172207/187062 [00:02<00:00, 75538.59it/s]
Adding feature api:  96%|█████████▌| 179764/187062 [00:02<00:00, 65042.71it/s]
Adding feature api: 100%|█████████▉| 186527/187062 [00:03<00:00, 47048.56it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:03<00:00, 58755.01it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:45:05,  2.19it/s]
Adding feature datatype:   3%|▎         | 6299/187062 [00:00<00:12, 14997.75it/s]
Adding feature datatype:   7%|▋         | 13462/187062 [00:00<00:05, 29371.73it/s]
Adding feature datatype:  11%|█         | 20763/187062 [00:00<00:04, 40979.70it/s]
Adding feature datatype:  15%|█▌        | 28064/187062 [00:00<00:03, 49799.66it/s]
Adding feature datatype:  19%|█▉        | 35439/187062 [00:00<00:02, 56559.91it/s]
Adding feature datatype:  23%|██▎       | 42815/187062 [00:01<00:02, 61502.35it/s]
Adding feature datatype:  27%|██▋       | 50149/187062 [00:01<00:02, 64946.85it/s]
Adding feature datatype:  31%|███       | 57431/187062 [00:01<00:01, 67257.18it/s]
Adding feature datatype:  35%|███▍      | 64710/187062 [00:01<00:01, 68890.05it/s]
Adding feature datatype:  38%|███▊      | 72001/187062 [00:01<00:01, 70082.02it/s]
Adding feature datatype:  42%|████▏     | 79370/187062 [00:01<00:01, 71154.05it/s]
Adding feature datatype:  46%|████▋     | 86699/187062 [00:01<00:01, 71789.90it/s]
Adding feature datatype:  50%|█████     | 94011/187062 [00:01<00:01, 72184.15it/s]
Adding feature datatype:  54%|█████▍    | 101359/187062 [00:01<00:01, 72571.14it/s]
Adding feature datatype:  58%|█████▊    | 108740/187062 [00:01<00:01, 72940.69it/s]
Adding feature datatype:  62%|██████▏   | 116101/187062 [00:02<00:00, 73138.79it/s]
Adding feature datatype:  66%|██████▌   | 123456/187062 [00:02<00:00, 73260.02it/s]
Adding feature datatype:  70%|██████▉   | 130801/187062 [00:02<00:00, 72893.45it/s]
Adding feature datatype:  74%|███████▍  | 138181/187062 [00:02<00:00, 73160.72it/s]
Adding feature datatype:  78%|███████▊  | 145571/187062 [00:02<00:00, 73378.88it/s]
Adding feature datatype:  82%|████████▏ | 152942/187062 [00:02<00:00, 73476.65it/s]
Adding feature datatype:  86%|████████▌ | 160295/187062 [00:02<00:00, 73405.79it/s]
Adding feature datatype:  90%|████████▉ | 167646/187062 [00:02<00:00, 73435.13it/s]
Adding feature datatype:  94%|█████████▎| 174992/187062 [00:02<00:00, 73417.06it/s]
Adding feature datatype:  97%|█████████▋| 182336/187062 [00:03<00:00, 54180.82it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:03<00:00, 57747.41it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:23:27,  2.22it/s]
Adding feature literal:   3%|▎         | 6042/187062 [00:00<00:12, 14553.95it/s]
Adding feature literal:   7%|▋         | 13259/187062 [00:00<00:05, 29303.81it/s]
Adding feature literal:  11%|█         | 20504/187062 [00:00<00:04, 40856.47it/s]
Adding feature literal:  15%|█▍        | 27791/187062 [00:00<00:03, 49712.43it/s]
Adding feature literal:  19%|█▊        | 35064/187062 [00:00<00:02, 56231.73it/s]
Adding feature literal:  23%|██▎       | 42171/187062 [00:01<00:02, 60503.57it/s]
Adding feature literal:  26%|██▌       | 49037/187062 [00:01<00:02, 61982.85it/s]
Adding feature literal:  30%|███       | 56184/187062 [00:01<00:02, 64743.53it/s]
Adding feature literal:  34%|███▍      | 63456/187062 [00:01<00:01, 67084.10it/s]
Adding feature literal:  38%|███▊      | 70779/187062 [00:01<00:01, 68898.71it/s]
Adding feature literal:  42%|████▏     | 78071/187062 [00:01<00:01, 70089.77it/s]
Adding feature literal:  46%|████▌     | 85345/187062 [00:01<00:01, 70875.68it/s]
Adding feature literal:  50%|████▉     | 92647/187062 [00:01<00:01, 71513.61it/s]
Adding feature literal:  53%|█████▎    | 99873/187062 [00:01<00:01, 71454.57it/s]
Adding feature literal:  57%|█████▋    | 107155/187062 [00:01<00:01, 71861.02it/s]
Adding feature literal:  61%|██████    | 114483/187062 [00:02<00:01, 72282.10it/s]
Adding feature literal:  65%|██████▌   | 121809/187062 [00:02<00:00, 72572.85it/s]
Adding feature literal:  69%|██████▉   | 129196/187062 [00:02<00:00, 72958.53it/s]
Adding feature literal:  73%|███████▎  | 136508/187062 [00:02<00:00, 73005.15it/s]
Adding feature literal:  77%|███████▋  | 143843/187062 [00:02<00:00, 73107.17it/s]
Adding feature literal:  81%|████████  | 151161/187062 [00:02<00:00, 73019.53it/s]
Adding feature literal:  85%|████████▍ | 158513/187062 [00:02<00:00, 73167.16it/s]
Adding feature literal:  89%|████████▊ | 165833/187062 [00:02<00:00, 73131.20it/s]
Adding feature literal:  93%|█████████▎| 173159/187062 [00:02<00:00, 73166.94it/s]
Adding feature literal:  96%|█████████▋| 180478/187062 [00:03<00:00, 61257.02it/s]
Adding feature literal: 100%|█████████▉| 186933/187062 [00:03<00:00, 45636.21it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 57307.15it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:27:48,  2.21it/s]
Adding feature operator:   3%|▎         | 6280/187062 [00:00<00:11, 15091.85it/s]
Adding feature operator:   7%|▋         | 13530/187062 [00:00<00:05, 29763.84it/s]
Adding feature operator:  11%|█         | 20820/187062 [00:00<00:04, 41300.70it/s]
Adding feature operator:  15%|█▌        | 28134/187062 [00:00<00:03, 50101.56it/s]
Adding feature operator:  19%|█▉        | 35534/187062 [00:00<00:02, 56866.23it/s]
Adding feature operator:  23%|██▎       | 42866/187062 [00:01<00:02, 61602.91it/s]
Adding feature operator:  27%|██▋       | 50240/187062 [00:01<00:02, 65138.66it/s]
Adding feature operator:  31%|███       | 57371/187062 [00:01<00:01, 66949.94it/s]
Adding feature operator:  35%|███▍      | 64729/187062 [00:01<00:01, 68907.91it/s]
Adding feature operator:  39%|███▊      | 72083/187062 [00:01<00:01, 70281.83it/s]
Adding feature operator:  42%|████▏     | 79385/187062 [00:01<00:01, 71096.21it/s]
Adding feature operator:  46%|████▋     | 86770/187062 [00:01<00:01, 71916.43it/s]
Adding feature operator:  50%|█████     | 94143/187062 [00:01<00:01, 72457.18it/s]
Adding feature operator:  54%|█████▍    | 101486/187062 [00:01<00:01, 72747.29it/s]
Adding feature operator:  58%|█████▊    | 108814/187062 [00:01<00:01, 72904.87it/s]
Adding feature operator:  62%|██████▏   | 116142/187062 [00:02<00:00, 72991.79it/s]
Adding feature operator:  66%|██████▌   | 123467/187062 [00:02<00:00, 73009.31it/s]
Adding feature operator:  70%|██████▉   | 130845/187062 [00:02<00:00, 73238.50it/s]
Adding feature operator:  74%|███████▍  | 138182/187062 [00:02<00:00, 73212.49it/s]
Adding feature operator:  78%|███████▊  | 145549/187062 [00:02<00:00, 73348.80it/s]
Adding feature operator:  82%|████████▏ | 152891/187062 [00:02<00:00, 72658.83it/s]
Adding feature operator:  86%|████████▌ | 160233/187062 [00:02<00:00, 72883.59it/s]
Adding feature operator:  90%|████████▉ | 167526/187062 [00:02<00:00, 72633.48it/s]
Adding feature operator:  93%|█████████▎| 174811/187062 [00:02<00:00, 72697.12it/s]
Adding feature operator:  97%|█████████▋| 182083/187062 [00:03<00:00, 54502.08it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:03<00:00, 57763.29it/s]
[2024-10-13 00:07:20,409] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/13/2024 00:07:21 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/13/2024 00:07:21 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 417.24 examples/s]
Map:   2%|▏         | 108/6548 [00:00<00:24, 258.42 examples/s]
Map:   2%|▏         | 148/6548 [00:00<00:21, 295.07 examples/s]
Map:   3%|▎         | 185/6548 [00:00<00:20, 313.93 examples/s]
Map:   4%|▎         | 233/6548 [00:00<00:17, 358.36 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:18, 345.52 examples/s]
Map:   5%|▍         | 325/6548 [00:01<00:21, 295.88 examples/s]
Map:   6%|▌         | 363/6548 [00:01<00:19, 310.10 examples/s]
Map:   6%|▋         | 415/6548 [00:01<00:16, 361.85 examples/s]
Map:   7%|▋         | 464/6548 [00:01<00:17, 343.76 examples/s]
Map:   8%|▊         | 501/6548 [00:01<00:19, 308.16 examples/s]
Map:   8%|▊         | 555/6548 [00:01<00:16, 361.53 examples/s]
Map:   9%|▉         | 598/6548 [00:01<00:15, 372.52 examples/s]
Map:  10%|▉         | 638/6548 [00:01<00:18, 325.58 examples/s]
Map:  10%|█         | 684/6548 [00:02<00:16, 355.08 examples/s]
Map:  11%|█         | 724/6548 [00:02<00:16, 360.39 examples/s]
Map:  12%|█▏        | 775/6548 [00:02<00:14, 398.83 examples/s]
Map:  13%|█▎        | 823/6548 [00:02<00:13, 418.94 examples/s]
Map:  13%|█▎        | 882/6548 [00:02<00:13, 408.01 examples/s]
Map:  14%|█▍        | 932/6548 [00:02<00:14, 376.08 examples/s]
Map:  15%|█▍        | 971/6548 [00:02<00:14, 377.10 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:23, 232.83 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 258.79 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:18, 293.70 examples/s]
Map:  17%|█▋        | 1145/6548 [00:03<00:16, 329.56 examples/s]
Map:  18%|█▊        | 1184/6548 [00:03<00:15, 342.06 examples/s]
Map:  19%|█▉        | 1240/6548 [00:03<00:15, 344.51 examples/s]
Map:  20%|█▉        | 1286/6548 [00:03<00:14, 371.23 examples/s]
Map:  20%|██        | 1334/6548 [00:04<00:17, 299.99 examples/s]
Map:  21%|██        | 1369/6548 [00:04<00:17, 300.01 examples/s]
Map:  22%|██▏       | 1420/6548 [00:04<00:16, 307.50 examples/s]
Map:  22%|██▏       | 1461/6548 [00:04<00:18, 281.44 examples/s]
Map:  23%|██▎       | 1491/6548 [00:04<00:17, 283.85 examples/s]
Map:  23%|██▎       | 1525/6548 [00:04<00:17, 287.47 examples/s]
Map:  24%|██▍       | 1561/6548 [00:04<00:18, 270.02 examples/s]
Map:  24%|██▍       | 1595/6548 [00:04<00:17, 284.14 examples/s]
Map:  25%|██▍       | 1629/6548 [00:05<00:18, 262.15 examples/s]
Map:  25%|██▌       | 1669/6548 [00:05<00:18, 259.72 examples/s]
Map:  26%|██▌       | 1708/6548 [00:05<00:16, 288.59 examples/s]
Map:  27%|██▋       | 1749/6548 [00:05<00:15, 316.20 examples/s]
Map:  27%|██▋       | 1791/6548 [00:05<00:13, 341.72 examples/s]
Map:  28%|██▊       | 1829/6548 [00:05<00:13, 338.20 examples/s]
Map:  29%|██▊       | 1869/6548 [00:05<00:15, 306.94 examples/s]
Map:  29%|██▉       | 1909/6548 [00:05<00:14, 326.52 examples/s]
Map:  30%|██▉       | 1954/6548 [00:06<00:12, 356.38 examples/s]
Map:  30%|███       | 1996/6548 [00:06<00:12, 367.95 examples/s]
Map:  31%|███       | 2039/6548 [00:06<00:21, 211.68 examples/s]
Map:  32%|███▏      | 2081/6548 [00:06<00:18, 245.34 examples/s]
Map:  32%|███▏      | 2124/6548 [00:06<00:16, 266.31 examples/s]
Map:  33%|███▎      | 2159/6548 [00:06<00:17, 249.92 examples/s]
Map:  34%|███▎      | 2208/6548 [00:07<00:14, 299.66 examples/s]
Map:  34%|███▍      | 2254/6548 [00:07<00:16, 267.52 examples/s]
Map:  35%|███▍      | 2286/6548 [00:07<00:15, 272.94 examples/s]
Map:  36%|███▌      | 2331/6548 [00:07<00:13, 307.46 examples/s]
Map:  36%|███▋      | 2382/6548 [00:07<00:13, 314.47 examples/s]
Map:  37%|███▋      | 2422/6548 [00:07<00:12, 331.42 examples/s]
Map:  38%|███▊      | 2475/6548 [00:07<00:12, 314.40 examples/s]
Map:  38%|███▊      | 2514/6548 [00:08<00:12, 319.44 examples/s]
Map:  39%|███▉      | 2554/6548 [00:08<00:11, 337.26 examples/s]
Map:  40%|███▉      | 2599/6548 [00:08<00:10, 363.80 examples/s]
Map:  40%|████      | 2641/6548 [00:08<00:10, 376.69 examples/s]
Map:  41%|████      | 2699/6548 [00:08<00:10, 367.61 examples/s]
Map:  42%|████▏     | 2737/6548 [00:08<00:10, 357.35 examples/s]
Map:  42%|████▏     | 2775/6548 [00:08<00:10, 361.61 examples/s]
Map:  43%|████▎     | 2826/6548 [00:08<00:10, 346.38 examples/s]
Map:  44%|████▍     | 2872/6548 [00:09<00:12, 282.78 examples/s]
Map:  44%|████▍     | 2903/6548 [00:09<00:12, 286.83 examples/s]
Map:  45%|████▍     | 2934/6548 [00:09<00:12, 289.96 examples/s]
Map:  45%|████▌     | 2974/6548 [00:09<00:11, 304.04 examples/s]
Map:  46%|████▌     | 3012/6548 [00:09<00:21, 167.99 examples/s]
Map:  46%|████▋     | 3044/6548 [00:10<00:18, 191.33 examples/s]
Map:  47%|████▋     | 3076/6548 [00:10<00:16, 213.40 examples/s]
Map:  48%|████▊     | 3113/6548 [00:10<00:14, 243.00 examples/s]
Map:  48%|████▊     | 3148/6548 [00:10<00:12, 265.92 examples/s]
Map:  49%|████▊     | 3186/6548 [00:10<00:12, 260.05 examples/s]
Map:  49%|████▉     | 3219/6548 [00:10<00:12, 260.13 examples/s]
Map:  50%|████▉     | 3255/6548 [00:10<00:11, 279.78 examples/s]
Map:  50%|█████     | 3286/6548 [00:10<00:11, 284.12 examples/s]
Map:  51%|█████     | 3331/6548 [00:10<00:10, 318.47 examples/s]
Map:  52%|█████▏    | 3380/6548 [00:11<00:10, 312.04 examples/s]
Map:  52%|█████▏    | 3424/6548 [00:11<00:10, 296.98 examples/s]
Map:  53%|█████▎    | 3462/6548 [00:11<00:11, 269.04 examples/s]
Map:  53%|█████▎    | 3497/6548 [00:11<00:10, 285.09 examples/s]
Map:  54%|█████▍    | 3546/6548 [00:11<00:09, 330.50 examples/s]
Map:  55%|█████▍    | 3594/6548 [00:11<00:08, 366.39 examples/s]
Map:  56%|█████▌    | 3639/6548 [00:11<00:07, 380.71 examples/s]
Map:  57%|█████▋    | 3700/6548 [00:12<00:07, 384.55 examples/s]
Map:  57%|█████▋    | 3741/6548 [00:12<00:07, 388.56 examples/s]
Map:  58%|█████▊    | 3789/6548 [00:12<00:07, 352.73 examples/s]
Map:  59%|█████▊    | 3838/6548 [00:12<00:08, 331.74 examples/s]
Map:  59%|█████▉    | 3876/6548 [00:12<00:08, 303.02 examples/s]
Map:  60%|█████▉    | 3914/6548 [00:12<00:08, 317.51 examples/s]
Map:  61%|██████    | 3964/6548 [00:12<00:08, 316.85 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 225.34 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 283.00 examples/s]
Map:  63%|██████▎   | 4095/6548 [00:13<00:07, 307.51 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 318.87 examples/s]
Map:  64%|██████▍   | 4177/6548 [00:13<00:07, 304.57 examples/s]
Map:  64%|██████▍   | 4212/6548 [00:13<00:07, 303.59 examples/s]
Map:  65%|██████▌   | 4266/6548 [00:13<00:06, 351.91 examples/s]
Map:  66%|██████▌   | 4327/6548 [00:14<00:06, 367.23 examples/s]
Map:  67%|██████▋   | 4367/6548 [00:14<00:06, 358.88 examples/s]
Map:  68%|██████▊   | 4431/6548 [00:14<00:05, 373.42 examples/s]
Map:  68%|██████▊   | 4483/6548 [00:14<00:06, 341.65 examples/s]
Map:  69%|██████▉   | 4528/6548 [00:14<00:06, 327.55 examples/s]
Map:  70%|██████▉   | 4568/6548 [00:14<00:06, 329.29 examples/s]
Map:  70%|███████   | 4610/6548 [00:14<00:05, 328.74 examples/s]
Map:  71%|███████   | 4657/6548 [00:14<00:05, 361.37 examples/s]
Map:  72%|███████▏  | 4712/6548 [00:15<00:05, 350.90 examples/s]
Map:  73%|███████▎  | 4777/6548 [00:15<00:04, 372.06 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 382.00 examples/s]
Map:  75%|███████▍  | 4881/6548 [00:15<00:04, 355.16 examples/s]
Map:  75%|███████▌  | 4933/6548 [00:15<00:04, 374.38 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:03, 394.35 examples/s]
Map:  77%|███████▋  | 5039/6548 [00:16<00:05, 253.92 examples/s]
Map:  78%|███████▊  | 5084/6548 [00:16<00:05, 262.17 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 270.45 examples/s]
Map:  79%|███████▊  | 5155/6548 [00:16<00:04, 284.01 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 283.10 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:16<00:04, 295.46 examples/s]
Map:  80%|████████  | 5256/6548 [00:16<00:04, 298.71 examples/s]
Map:  81%|████████  | 5312/6548 [00:17<00:03, 364.57 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 309.99 examples/s]
Map:  83%|████████▎ | 5407/6548 [00:17<00:03, 295.50 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 327.83 examples/s]
Map:  84%|████████▍ | 5492/6548 [00:17<00:03, 341.59 examples/s]
Map:  84%|████████▍ | 5529/6548 [00:17<00:02, 342.94 examples/s]
Map:  85%|████████▌ | 5570/6548 [00:17<00:02, 356.57 examples/s]
Map:  86%|████████▌ | 5621/6548 [00:17<00:02, 346.77 examples/s]
Map:  87%|████████▋ | 5674/6548 [00:18<00:02, 342.22 examples/s]
Map:  87%|████████▋ | 5710/6548 [00:18<00:02, 335.90 examples/s]
Map:  88%|████████▊ | 5755/6548 [00:18<00:02, 362.22 examples/s]
Map:  88%|████████▊ | 5794/6548 [00:18<00:02, 365.66 examples/s]
Map:  89%|████████▉ | 5848/6548 [00:18<00:01, 361.94 examples/s]
Map:  90%|████████▉ | 5886/6548 [00:18<00:01, 359.37 examples/s]
Map:  90%|█████████ | 5923/6548 [00:18<00:01, 358.18 examples/s]
Map:  91%|█████████ | 5967/6548 [00:18<00:01, 333.22 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 241.58 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 272.43 examples/s]
Map:  94%|█████████▎| 6130/6548 [00:19<00:01, 257.99 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:19<00:01, 273.06 examples/s]
Map:  95%|█████████▍| 6207/6548 [00:19<00:01, 298.59 examples/s]
Map:  95%|█████████▌| 6249/6548 [00:20<00:00, 321.63 examples/s]
Map:  96%|█████████▋| 6304/6548 [00:20<00:00, 335.25 examples/s]
Map:  97%|█████████▋| 6341/6548 [00:20<00:00, 340.26 examples/s]
Map:  98%|█████████▊| 6387/6548 [00:20<00:00, 364.50 examples/s]
Map:  98%|█████████▊| 6428/6548 [00:20<00:00, 373.14 examples/s]
Map:  99%|█████████▉| 6477/6548 [00:20<00:00, 401.06 examples/s]
Map: 100%|█████████▉| 6538/6548 [00:20<00:00, 395.71 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 313.47 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 326.31 examples/s]
Map:   8%|▊         | 70/903 [00:00<00:02, 315.19 examples/s]
Map:  13%|█▎        | 118/903 [00:00<00:02, 303.73 examples/s]
Map:  18%|█▊        | 163/903 [00:00<00:02, 345.13 examples/s]
Map:  23%|██▎       | 211/903 [00:00<00:01, 377.72 examples/s]
Map:  28%|██▊       | 253/903 [00:00<00:01, 389.27 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 384.17 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 338.63 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 314.43 examples/s]
Map:  50%|████▉     | 451/903 [00:01<00:01, 294.93 examples/s]
Map:  54%|█████▍    | 486/903 [00:01<00:01, 295.24 examples/s]
Map:  59%|█████▉    | 536/903 [00:01<00:01, 336.66 examples/s]
Map:  64%|██████▍   | 578/903 [00:01<00:00, 356.01 examples/s]
Map:  69%|██████▊   | 619/903 [00:01<00:00, 362.98 examples/s]
Map:  73%|███████▎  | 663/903 [00:01<00:00, 382.57 examples/s]
Map:  78%|███████▊  | 704/903 [00:02<00:00, 389.19 examples/s]
Map:  83%|████████▎ | 749/903 [00:02<00:00, 401.65 examples/s]
Map:  89%|████████▉ | 805/903 [00:02<00:00, 386.90 examples/s]
Map:  95%|█████████▍| 854/903 [00:02<00:00, 407.26 examples/s]
Map:  99%|█████████▉| 898/903 [00:02<00:00, 350.72 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 326.65 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 306.90 examples/s]
Map:   4%|▍         | 79/1882 [00:00<00:05, 359.44 examples/s]
Map:   7%|▋         | 126/1882 [00:00<00:05, 326.08 examples/s]
Map:   9%|▉         | 166/1882 [00:00<00:04, 347.52 examples/s]
Map:  11%|█         | 203/1882 [00:00<00:05, 329.37 examples/s]
Map:  13%|█▎        | 240/1882 [00:00<00:04, 338.68 examples/s]
Map:  15%|█▍        | 280/1882 [00:00<00:04, 348.23 examples/s]
Map:  18%|█▊        | 331/1882 [00:00<00:04, 341.20 examples/s]
Map:  19%|█▉        | 366/1882 [00:01<00:05, 300.59 examples/s]
Map:  21%|██        | 398/1882 [00:01<00:05, 266.85 examples/s]
Map:  23%|██▎       | 433/1882 [00:01<00:05, 280.71 examples/s]
Map:  26%|██▌       | 489/1882 [00:01<00:04, 304.27 examples/s]
Map:  28%|██▊       | 524/1882 [00:01<00:04, 299.29 examples/s]
Map:  30%|███       | 565/1882 [00:01<00:04, 324.42 examples/s]
Map:  32%|███▏      | 611/1882 [00:01<00:03, 352.34 examples/s]
Map:  35%|███▍      | 657/1882 [00:01<00:03, 374.51 examples/s]
Map:  37%|███▋      | 704/1882 [00:02<00:03, 387.66 examples/s]
Map:  40%|███▉      | 744/1882 [00:02<00:02, 389.06 examples/s]
Map:  42%|████▏     | 796/1882 [00:02<00:02, 366.94 examples/s]
Map:  45%|████▌     | 853/1882 [00:02<00:02, 356.78 examples/s]
Map:  47%|████▋     | 893/1882 [00:02<00:02, 364.76 examples/s]
Map:  49%|████▉     | 931/1882 [00:02<00:02, 361.44 examples/s]
Map:  52%|█████▏    | 981/1882 [00:02<00:02, 397.29 examples/s]
Map:  55%|█████▌    | 1039/1882 [00:03<00:03, 250.64 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 262.91 examples/s]
Map:  59%|█████▉    | 1106/1882 [00:03<00:02, 275.56 examples/s]
Map:  61%|██████    | 1139/1882 [00:03<00:02, 283.68 examples/s]
Map:  62%|██████▏   | 1173/1882 [00:03<00:02, 294.33 examples/s]
Map:  64%|██████▍   | 1213/1882 [00:03<00:02, 280.55 examples/s]
Map:  66%|██████▋   | 1249/1882 [00:03<00:02, 296.60 examples/s]
Map:  69%|██████▉   | 1307/1882 [00:04<00:01, 315.99 examples/s]
Map:  72%|███████▏  | 1348/1882 [00:04<00:01, 334.88 examples/s]
Map:  74%|███████▍  | 1398/1882 [00:04<00:01, 332.66 examples/s]
Map:  77%|███████▋  | 1448/1882 [00:04<00:01, 290.93 examples/s]
Map:  79%|███████▉  | 1491/1882 [00:04<00:01, 283.72 examples/s]
Map:  82%|████████▏ | 1535/1882 [00:04<00:01, 272.16 examples/s]
Map:  84%|████████▎ | 1575/1882 [00:04<00:01, 295.38 examples/s]
Map:  86%|████████▌ | 1619/1882 [00:05<00:00, 324.46 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 327.59 examples/s]
Map:  91%|█████████ | 1713/1882 [00:05<00:00, 334.67 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 288.14 examples/s]
Map:  96%|█████████▌| 1799/1882 [00:05<00:00, 290.87 examples/s]
Map:  98%|█████████▊| 1844/1882 [00:05<00:00, 322.32 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 233.11 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 307.71 examples/s]
10/13/2024 00:08:23 - INFO - __main__ -     ***** Testing *****
10/13/2024 00:08:23 - INFO - __main__ -     Batch size = 8
10/13/2024 00:08:23 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/13/2024 00:08:23 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/13/2024 00:08:23 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/13/2024 00:08:24 - INFO - knnlm -   Reading datastore took 0.9719138145446777 s
10/13/2024 00:08:25 - INFO - knnlm -   Moving index to GPU took 0.9859371185302734 s
10/13/2024 00:08:25 - INFO - __main__ -   ******************************break-into
10/13/2024 00:08:25 - INFO - __main__ -     ***** Running acc evaluation *****
10/13/2024 00:08:25 - INFO - __main__ -     Num examples = 236
10/13/2024 00:08:25 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:05,  7.68s/it]
test ppl:   1%|          | 2/236 [00:09<17:28,  4.48s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:11,  3.14s/it]
test ppl:   2%|▏         | 4/236 [00:13<10:02,  2.60s/it]
test ppl:   2%|▏         | 5/236 [00:19<14:36,  3.79s/it]
test ppl:   3%|▎         | 6/236 [00:21<13:12,  3.45s/it]
test ppl:   3%|▎         | 7/236 [00:24<11:59,  3.14s/it]
test ppl:   3%|▎         | 8/236 [00:28<13:16,  3.49s/it]
test ppl:   4%|▍         | 9/236 [00:30<11:32,  3.05s/it]
test ppl:   4%|▍         | 10/236 [00:33<11:25,  3.03s/it]
test ppl:   5%|▍         | 11/236 [00:36<10:33,  2.82s/it]
test ppl:   5%|▌         | 12/236 [00:41<13:56,  3.73s/it]
test ppl:   6%|▌         | 13/236 [00:46<15:02,  4.05s/it]
test ppl:   6%|▌         | 14/236 [00:52<17:01,  4.60s/it]
test ppl:   6%|▋         | 15/236 [00:54<14:31,  3.94s/it]
test ppl:   7%|▋         | 16/236 [00:56<12:09,  3.32s/it]
test ppl:   7%|▋         | 17/236 [01:02<14:50,  4.07s/it]
test ppl:   8%|▊         | 18/236 [01:04<12:09,  3.35s/it]
test ppl:   8%|▊         | 19/236 [01:08<13:13,  3.66s/it]
test ppl:   8%|▊         | 20/236 [01:10<11:06,  3.09s/it]
test ppl:   9%|▉         | 21/236 [01:12<10:10,  2.84s/it]
test ppl:   9%|▉         | 22/236 [01:18<13:18,  3.73s/it]
test ppl:  10%|▉         | 23/236 [01:21<11:55,  3.36s/it]
test ppl:  10%|█         | 24/236 [01:23<10:47,  3.05s/it]
test ppl:  11%|█         | 25/236 [01:25<09:26,  2.68s/it]
test ppl:  11%|█         | 26/236 [01:31<12:41,  3.63s/it]
test ppl:  11%|█▏        | 27/236 [01:35<13:09,  3.78s/it]
test ppl:  12%|█▏        | 28/236 [01:36<10:24,  3.00s/it]
test ppl:  12%|█▏        | 29/236 [01:38<09:37,  2.79s/it]
test ppl:  13%|█▎        | 30/236 [01:40<08:15,  2.41s/it]
test ppl:  13%|█▎        | 31/236 [01:42<07:47,  2.28s/it]
test ppl:  14%|█▎        | 32/236 [01:44<08:18,  2.45s/it]
test ppl:  14%|█▍        | 33/236 [01:50<11:42,  3.46s/it]
test ppl:  14%|█▍        | 34/236 [01:54<12:09,  3.61s/it]
test ppl:  15%|█▍        | 35/236 [01:57<10:59,  3.28s/it]
test ppl:  15%|█▌        | 36/236 [02:03<13:28,  4.04s/it]
test ppl:  16%|█▌        | 37/236 [02:08<15:09,  4.57s/it]
test ppl:  16%|█▌        | 38/236 [02:10<12:35,  3.82s/it]
test ppl:  17%|█▋        | 39/236 [02:12<10:14,  3.12s/it]
test ppl:  17%|█▋        | 40/236 [02:15<09:44,  2.98s/it]
test ppl:  17%|█▋        | 41/236 [02:17<09:12,  2.83s/it]
test ppl:  18%|█▊        | 42/236 [02:23<12:05,  3.74s/it]
test ppl:  18%|█▊        | 43/236 [02:29<14:00,  4.36s/it]
test ppl:  19%|█▊        | 44/236 [02:31<11:57,  3.73s/it]
test ppl:  19%|█▉        | 45/236 [02:33<10:11,  3.20s/it]
test ppl:  19%|█▉        | 46/236 [02:39<12:38,  3.99s/it]
test ppl:  20%|█▉        | 47/236 [02:45<14:21,  4.56s/it]
test ppl:  20%|██        | 48/236 [02:50<15:25,  4.92s/it]
test ppl:  21%|██        | 49/236 [02:54<13:46,  4.42s/it]
test ppl:  21%|██        | 50/236 [03:00<15:03,  4.86s/it]
test ppl:  22%|██▏       | 51/236 [03:05<15:52,  5.15s/it]
test ppl:  22%|██▏       | 52/236 [03:11<16:24,  5.35s/it]
test ppl:  22%|██▏       | 53/236 [03:17<16:19,  5.35s/it]
test ppl:  23%|██▎       | 54/236 [03:18<12:44,  4.20s/it]
test ppl:  23%|██▎       | 55/236 [03:24<13:54,  4.61s/it]
test ppl:  24%|██▎       | 56/236 [03:27<12:42,  4.24s/it]
test ppl:  24%|██▍       | 57/236 [03:30<11:06,  3.72s/it]
test ppl:  25%|██▍       | 58/236 [03:31<09:06,  3.07s/it]
test ppl:  25%|██▌       | 59/236 [03:37<11:28,  3.89s/it]
test ppl:  25%|██▌       | 60/236 [03:40<10:46,  3.68s/it]
test ppl:  26%|██▌       | 61/236 [03:46<12:34,  4.31s/it]
test ppl:  26%|██▋       | 62/236 [03:50<12:18,  4.24s/it]
test ppl:  27%|██▋       | 63/236 [03:52<10:39,  3.70s/it]
test ppl:  27%|██▋       | 64/236 [03:54<08:43,  3.04s/it]
test ppl:  28%|██▊       | 65/236 [03:55<07:10,  2.52s/it]
test ppl:  28%|██▊       | 66/236 [03:58<07:28,  2.64s/it]
test ppl:  28%|██▊       | 67/236 [04:04<10:06,  3.59s/it]
test ppl:  29%|██▉       | 68/236 [04:10<11:54,  4.26s/it]
test ppl:  29%|██▉       | 69/236 [04:16<13:08,  4.72s/it]
test ppl:  30%|██▉       | 70/236 [04:17<10:27,  3.78s/it]
test ppl:  30%|███       | 71/236 [04:21<10:32,  3.83s/it]
test ppl:  31%|███       | 72/236 [04:25<10:25,  3.81s/it]
test ppl:  31%|███       | 73/236 [04:29<10:21,  3.81s/it]
test ppl:  31%|███▏      | 74/236 [04:30<08:24,  3.11s/it]
test ppl:  32%|███▏      | 75/236 [04:36<10:30,  3.92s/it]
test ppl:  32%|███▏      | 76/236 [04:39<10:02,  3.77s/it]
test ppl:  33%|███▎      | 77/236 [04:42<08:46,  3.31s/it]
test ppl:  33%|███▎      | 78/236 [04:43<07:35,  2.88s/it]
test ppl:  33%|███▎      | 79/236 [04:48<09:08,  3.50s/it]
test ppl:  34%|███▍      | 80/236 [04:50<07:50,  3.02s/it]
test ppl:  34%|███▍      | 81/236 [04:56<09:56,  3.85s/it]
test ppl:  35%|███▍      | 82/236 [05:02<11:23,  4.44s/it]
test ppl:  35%|███▌      | 83/236 [05:04<09:26,  3.70s/it]
test ppl:  36%|███▌      | 84/236 [05:06<07:58,  3.15s/it]
test ppl:  36%|███▌      | 85/236 [05:10<08:37,  3.43s/it]
test ppl:  36%|███▋      | 86/236 [05:12<07:25,  2.97s/it]
test ppl:  37%|███▋      | 87/236 [05:14<06:41,  2.70s/it]
test ppl:  37%|███▋      | 88/236 [05:20<08:56,  3.62s/it]
test ppl:  38%|███▊      | 89/236 [05:25<10:29,  4.28s/it]
test ppl:  38%|███▊      | 90/236 [05:31<11:31,  4.73s/it]
test ppl:  39%|███▊      | 91/236 [05:36<11:28,  4.75s/it]
test ppl:  39%|███▉      | 92/236 [05:39<09:58,  4.15s/it]
test ppl:  39%|███▉      | 93/236 [05:45<11:03,  4.64s/it]
test ppl:  40%|███▉      | 94/236 [05:50<11:47,  4.98s/it]
test ppl:  40%|████      | 95/236 [05:55<11:19,  4.82s/it]
test ppl:  41%|████      | 96/236 [05:58<09:54,  4.25s/it]
test ppl:  41%|████      | 97/236 [06:03<10:54,  4.71s/it]
test ppl:  42%|████▏     | 98/236 [06:09<11:35,  5.04s/it]
test ppl:  42%|████▏     | 99/236 [06:15<12:01,  5.26s/it]
test ppl:  42%|████▏     | 100/236 [06:16<09:14,  4.08s/it]
test ppl:  43%|████▎     | 101/236 [06:22<10:20,  4.59s/it]
test ppl:  43%|████▎     | 102/236 [06:26<09:35,  4.29s/it]
test ppl:  44%|████▎     | 103/236 [06:28<08:02,  3.63s/it]
test ppl:  44%|████▍     | 104/236 [06:32<08:22,  3.80s/it]
test ppl:  44%|████▍     | 105/236 [06:36<08:20,  3.82s/it]
test ppl:  45%|████▍     | 106/236 [06:41<09:15,  4.28s/it]
test ppl:  45%|████▌     | 107/236 [06:43<07:44,  3.60s/it]
test ppl:  46%|████▌     | 108/236 [06:49<08:59,  4.21s/it]
test ppl:  46%|████▌     | 109/236 [06:53<09:10,  4.33s/it]
test ppl:  47%|████▋     | 110/236 [06:55<07:29,  3.57s/it]
test ppl:  47%|████▋     | 111/236 [06:59<07:38,  3.66s/it]
test ppl:  47%|████▋     | 112/236 [07:02<06:59,  3.39s/it]
test ppl:  48%|████▊     | 113/236 [07:04<05:55,  2.89s/it]
test ppl:  48%|████▊     | 114/236 [07:07<06:06,  3.01s/it]
test ppl:  49%|████▊     | 115/236 [07:13<07:44,  3.84s/it]
test ppl:  49%|████▉     | 116/236 [07:18<08:40,  4.34s/it]
test ppl:  50%|████▉     | 117/236 [07:20<07:06,  3.58s/it]
test ppl:  50%|█████     | 118/236 [07:24<07:21,  3.74s/it]
test ppl:  50%|█████     | 119/236 [07:27<07:01,  3.60s/it]
test ppl:  51%|█████     | 120/236 [07:29<05:38,  2.92s/it]
test ppl:  51%|█████▏    | 121/236 [07:35<07:14,  3.78s/it]
test ppl:  52%|█████▏    | 122/236 [07:39<07:43,  4.06s/it]
test ppl:  52%|█████▏    | 123/236 [07:41<06:33,  3.49s/it]
test ppl:  53%|█████▎    | 124/236 [07:44<06:05,  3.26s/it]
test ppl:  53%|█████▎    | 125/236 [07:47<05:35,  3.02s/it]
test ppl:  53%|█████▎    | 126/236 [07:50<05:53,  3.21s/it]
test ppl:  54%|█████▍    | 127/236 [07:52<05:05,  2.80s/it]
test ppl:  54%|█████▍    | 128/236 [07:54<04:43,  2.63s/it]
test ppl:  55%|█████▍    | 129/236 [07:58<05:28,  3.07s/it]
test ppl:  55%|█████▌    | 130/236 [08:03<06:05,  3.45s/it]
test ppl:  56%|█████▌    | 131/236 [08:09<07:16,  4.16s/it]
test ppl:  56%|█████▌    | 132/236 [08:11<06:19,  3.65s/it]
test ppl:  56%|█████▋    | 133/236 [08:15<06:22,  3.71s/it]
test ppl:  57%|█████▋    | 134/236 [08:20<07:13,  4.25s/it]
test ppl:  57%|█████▋    | 135/236 [08:26<07:55,  4.71s/it]
test ppl:  58%|█████▊    | 136/236 [08:27<06:05,  3.66s/it]
test ppl:  58%|█████▊    | 137/236 [08:33<07:06,  4.31s/it]
test ppl:  58%|█████▊    | 138/236 [08:36<06:28,  3.97s/it]
test ppl:  59%|█████▉    | 139/236 [08:39<05:43,  3.54s/it]
test ppl:  59%|█████▉    | 140/236 [08:41<04:46,  2.98s/it]
test ppl:  60%|█████▉    | 141/236 [08:43<04:39,  2.94s/it]
test ppl:  60%|██████    | 142/236 [08:46<04:13,  2.69s/it]
test ppl:  61%|██████    | 143/236 [08:51<05:37,  3.63s/it]
test ppl:  61%|██████    | 144/236 [08:54<05:08,  3.35s/it]
test ppl:  61%|██████▏   | 145/236 [09:00<06:01,  3.98s/it]
test ppl:  62%|██████▏   | 146/236 [09:04<06:11,  4.12s/it]
test ppl:  62%|██████▏   | 147/236 [09:10<06:52,  4.64s/it]
test ppl:  63%|██████▎   | 148/236 [09:16<07:22,  5.03s/it]
test ppl:  63%|██████▎   | 149/236 [09:19<06:33,  4.52s/it]
test ppl:  64%|██████▎   | 150/236 [09:23<06:14,  4.36s/it]
test ppl:  64%|██████▍   | 151/236 [09:29<06:47,  4.79s/it]
test ppl:  64%|██████▍   | 152/236 [09:35<07:08,  5.10s/it]
test ppl:  65%|██████▍   | 153/236 [09:40<07:20,  5.31s/it]
test ppl:  65%|██████▌   | 154/236 [09:43<06:06,  4.46s/it]
test ppl:  66%|██████▌   | 155/236 [09:46<05:15,  3.90s/it]
test ppl:  66%|██████▌   | 156/236 [09:48<04:30,  3.38s/it]
test ppl:  67%|██████▋   | 157/236 [09:50<03:58,  3.02s/it]
test ppl:  67%|██████▋   | 158/236 [09:56<05:00,  3.86s/it]
test ppl:  67%|██████▋   | 159/236 [10:02<05:41,  4.44s/it]
test ppl:  68%|██████▊   | 160/236 [10:03<04:22,  3.46s/it]
test ppl:  68%|██████▊   | 161/236 [10:04<03:32,  2.83s/it]
test ppl:  69%|██████▊   | 162/236 [10:07<03:35,  2.91s/it]
test ppl:  69%|██████▉   | 163/236 [10:10<03:23,  2.79s/it]
test ppl:  69%|██████▉   | 164/236 [10:13<03:38,  3.03s/it]
test ppl:  70%|██████▉   | 165/236 [10:18<04:16,  3.62s/it]
test ppl:  70%|███████   | 166/236 [10:21<04:06,  3.52s/it]
test ppl:  71%|███████   | 167/236 [10:23<03:20,  2.90s/it]
test ppl:  71%|███████   | 168/236 [10:27<03:45,  3.31s/it]
test ppl:  72%|███████▏  | 169/236 [10:33<04:22,  3.92s/it]
test ppl:  72%|███████▏  | 170/236 [10:38<04:57,  4.50s/it]
test ppl:  72%|███████▏  | 171/236 [10:40<03:50,  3.55s/it]
test ppl:  73%|███████▎  | 172/236 [10:42<03:22,  3.16s/it]
test ppl:  73%|███████▎  | 173/236 [10:45<03:24,  3.25s/it]
test ppl:  74%|███████▎  | 174/236 [10:51<04:09,  4.02s/it]
test ppl:  74%|███████▍  | 175/236 [10:53<03:25,  3.36s/it]
test ppl:  75%|███████▍  | 176/236 [10:58<03:47,  3.80s/it]
test ppl:  75%|███████▌  | 177/236 [11:04<04:19,  4.40s/it]
test ppl:  75%|███████▌  | 178/236 [11:10<04:40,  4.84s/it]
test ppl:  76%|███████▌  | 179/236 [11:15<04:53,  5.14s/it]
test ppl:  76%|███████▋  | 180/236 [11:20<04:37,  4.96s/it]
test ppl:  77%|███████▋  | 181/236 [11:26<04:46,  5.21s/it]
test ppl:  77%|███████▋  | 182/236 [11:28<03:47,  4.21s/it]
test ppl:  78%|███████▊  | 183/236 [11:30<03:12,  3.62s/it]
test ppl:  78%|███████▊  | 184/236 [11:31<02:34,  2.97s/it]
test ppl:  78%|███████▊  | 185/236 [11:36<02:52,  3.38s/it]
test ppl:  79%|███████▉  | 186/236 [11:41<03:25,  4.11s/it]
test ppl:  79%|███████▉  | 187/236 [11:47<03:47,  4.64s/it]
test ppl:  80%|███████▉  | 188/236 [11:53<03:59,  5.00s/it]
test ppl:  80%|████████  | 189/236 [11:59<04:06,  5.24s/it]
test ppl:  81%|████████  | 190/236 [12:03<03:43,  4.86s/it]
test ppl:  81%|████████  | 191/236 [12:07<03:31,  4.69s/it]
test ppl:  81%|████████▏ | 192/236 [12:10<02:58,  4.06s/it]
test ppl:  82%|████████▏ | 193/236 [12:16<03:17,  4.59s/it]
test ppl:  82%|████████▏ | 194/236 [12:18<02:47,  3.99s/it]
test ppl:  83%|████████▎ | 195/236 [12:21<02:31,  3.70s/it]
test ppl:  83%|████████▎ | 196/236 [12:23<02:07,  3.19s/it]
test ppl:  83%|████████▎ | 197/236 [12:26<01:56,  2.99s/it]
test ppl:  84%|████████▍ | 198/236 [12:32<02:26,  3.87s/it]
test ppl:  84%|████████▍ | 199/236 [12:35<02:10,  3.54s/it]
test ppl:  85%|████████▍ | 200/236 [12:40<02:31,  4.22s/it]
test ppl:  85%|████████▌ | 201/236 [12:42<02:04,  3.55s/it]
test ppl:  86%|████████▌ | 202/236 [12:47<02:11,  3.85s/it]
test ppl:  86%|████████▌ | 203/236 [12:52<02:23,  4.33s/it]
test ppl:  86%|████████▋ | 204/236 [12:54<01:51,  3.47s/it]
test ppl:  87%|████████▋ | 205/236 [13:00<02:09,  4.19s/it]
test ppl:  87%|████████▋ | 206/236 [13:03<01:57,  3.91s/it]
test ppl:  88%|████████▊ | 207/236 [13:09<02:10,  4.48s/it]
test ppl:  88%|████████▊ | 208/236 [13:12<01:54,  4.07s/it]
test ppl:  89%|████████▊ | 209/236 [13:18<02:04,  4.62s/it]
test ppl:  89%|████████▉ | 210/236 [13:20<01:42,  3.93s/it]
test ppl:  89%|████████▉ | 211/236 [13:25<01:44,  4.17s/it]
test ppl:  90%|████████▉ | 212/236 [13:30<01:44,  4.34s/it]
test ppl:  90%|█████████ | 213/236 [13:35<01:49,  4.77s/it]
test ppl:  91%|█████████ | 214/236 [13:37<01:24,  3.83s/it]
test ppl:  91%|█████████ | 215/236 [13:43<01:32,  4.43s/it]
test ppl:  92%|█████████▏| 216/236 [13:45<01:17,  3.86s/it]
test ppl:  92%|█████████▏| 217/236 [13:51<01:24,  4.47s/it]
test ppl:  92%|█████████▏| 218/236 [13:53<01:06,  3.71s/it]
test ppl:  93%|█████████▎| 219/236 [13:59<01:13,  4.34s/it]
test ppl:  93%|█████████▎| 220/236 [14:05<01:16,  4.78s/it]
test ppl:  94%|█████████▎| 221/236 [14:08<01:04,  4.27s/it]
test ppl:  94%|█████████▍| 222/236 [14:14<01:06,  4.74s/it]
test ppl:  94%|█████████▍| 223/236 [14:19<01:05,  5.06s/it]
test ppl:  95%|█████████▍| 224/236 [14:21<00:47,  3.93s/it]
test ppl:  95%|█████████▌| 225/236 [14:27<00:49,  4.49s/it]
test ppl:  96%|█████████▌| 226/236 [14:30<00:42,  4.21s/it]
test ppl:  96%|█████████▌| 227/236 [14:32<00:32,  3.64s/it]
test ppl:  97%|█████████▋| 228/236 [14:34<00:25,  3.15s/it]
test ppl:  97%|█████████▋| 229/236 [14:40<00:27,  3.95s/it]
test ppl:  97%|█████████▋| 230/236 [14:44<00:22,  3.80s/it]
test ppl:  98%|█████████▊| 231/236 [14:47<00:18,  3.65s/it]
test ppl:  98%|█████████▊| 232/236 [14:49<00:12,  3.08s/it]
test ppl:  99%|█████████▊| 233/236 [14:51<00:08,  2.79s/it]
test ppl:  99%|█████████▉| 234/236 [14:52<00:04,  2.31s/it]
test ppl: 100%|█████████▉| 235/236 [14:58<00:03,  3.36s/it]
test ppl: 100%|██████████| 236/236 [14:59<00:00,  2.55s/it]
test ppl: 100%|██████████| 236/236 [14:59<00:00,  3.81s/it]
10/13/2024 00:23:25 - INFO - __main__ -    em: 0.2099
10/13/2024 00:23:25 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/32_0.2_80_eval_results.json
32 0.2 80:  em: 0.2099

--------------------------------------------------------------------------------
Running experiment with knn_temp=80, lmbda=0.2, k=64
2024-10-13 00:23:32.066171: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-13 00:23:32.085745: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-13 00:23:32.107509: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-13 00:23:32.114129: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-13 00:23:32.129980: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-13 00:23:33.124040: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/13/2024 00:23:34 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.2, knn_temp=80, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/13/2024 00:23:34 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:44:59,  2.19it/s]
Adding feature api:   4%|▍         | 7334/187062 [00:00<00:10, 17463.07it/s]
Adding feature api:   8%|▊         | 15667/187062 [00:00<00:05, 34181.46it/s]
Adding feature api:  13%|█▎        | 24076/187062 [00:00<00:03, 47460.99it/s]
Adding feature api:  17%|█▋        | 32532/187062 [00:00<00:02, 57677.90it/s]
Adding feature api:  22%|██▏       | 40976/187062 [00:00<00:02, 65232.15it/s]
Adding feature api:  26%|██▋       | 49392/187062 [00:01<00:01, 70671.22it/s]
Adding feature api:  31%|███       | 57825/187062 [00:01<00:01, 74644.87it/s]
Adding feature api:  35%|███▌      | 66189/187062 [00:01<00:01, 77284.57it/s]
Adding feature api:  40%|███▉      | 74629/187062 [00:01<00:01, 79385.29it/s]
Adding feature api:  44%|████▍     | 83072/187062 [00:01<00:01, 80879.83it/s]
Adding feature api:  49%|████▉     | 91410/187062 [00:01<00:01, 81309.30it/s]
Adding feature api:  53%|█████▎    | 99921/187062 [00:01<00:01, 82439.76it/s]
Adding feature api:  58%|█████▊    | 108337/187062 [00:01<00:00, 82949.70it/s]
Adding feature api:  62%|██████▏   | 116783/187062 [00:01<00:00, 83398.67it/s]
Adding feature api:  67%|██████▋   | 125270/187062 [00:01<00:00, 83837.44it/s]
Adding feature api:  71%|███████▏  | 133735/187062 [00:02<00:00, 84078.66it/s]
Adding feature api:  76%|███████▌  | 142223/187062 [00:02<00:00, 84315.74it/s]
Adding feature api:  81%|████████  | 150756/187062 [00:02<00:00, 84618.23it/s]
Adding feature api:  85%|████████▌ | 159233/187062 [00:02<00:00, 84529.21it/s]
Adding feature api:  90%|████████▉ | 167697/187062 [00:02<00:00, 84504.36it/s]
Adding feature api:  94%|█████████▍| 176155/187062 [00:02<00:00, 84442.50it/s]
Adding feature api:  99%|█████████▊| 184605/187062 [00:02<00:00, 56825.05it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64538.20it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:38:15,  2.20it/s]
Adding feature datatype:   4%|▍         | 7029/187062 [00:00<00:10, 16797.08it/s]
Adding feature datatype:   8%|▊         | 15121/187062 [00:00<00:05, 33115.70it/s]
Adding feature datatype:  12%|█▏        | 23193/187062 [00:00<00:03, 45807.41it/s]
Adding feature datatype:  17%|█▋        | 31377/187062 [00:00<00:02, 55739.06it/s]
Adding feature datatype:  21%|██        | 39466/187062 [00:00<00:02, 62846.12it/s]
Adding feature datatype:  25%|██▌       | 47634/187062 [00:01<00:02, 68262.31it/s]
Adding feature datatype:  30%|██▉       | 55773/187062 [00:01<00:01, 72083.21it/s]
Adding feature datatype:  34%|███▍      | 63914/187062 [00:01<00:01, 74821.59it/s]
Adding feature datatype:  38%|███▊      | 71927/187062 [00:01<00:01, 76387.58it/s]
Adding feature datatype:  43%|████▎     | 80070/187062 [00:01<00:01, 77882.41it/s]
Adding feature datatype:  47%|████▋     | 88177/187062 [00:01<00:01, 78830.83it/s]
Adding feature datatype:  52%|█████▏    | 96378/187062 [00:01<00:01, 79779.19it/s]
Adding feature datatype:  56%|█████▌    | 104521/187062 [00:01<00:01, 80271.25it/s]
Adding feature datatype:  60%|██████    | 112680/187062 [00:01<00:00, 80664.58it/s]
Adding feature datatype:  65%|██████▍   | 120805/187062 [00:01<00:00, 80681.10it/s]
Adding feature datatype:  69%|██████▉   | 128954/187062 [00:02<00:00, 80920.45it/s]
Adding feature datatype:  73%|███████▎  | 137113/187062 [00:02<00:00, 81118.41it/s]
Adding feature datatype:  78%|███████▊  | 145256/187062 [00:02<00:00, 81210.69it/s]
Adding feature datatype:  82%|████████▏ | 153392/187062 [00:02<00:00, 81084.42it/s]
Adding feature datatype:  86%|████████▋ | 161611/187062 [00:02<00:00, 81414.07it/s]
Adding feature datatype:  91%|█████████ | 169760/187062 [00:02<00:00, 81301.44it/s]
Adding feature datatype:  95%|█████████▌| 177896/187062 [00:02<00:00, 80320.49it/s]
Adding feature datatype:  99%|█████████▉| 185935/187062 [00:02<00:00, 52922.40it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 62955.36it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:12:55,  2.24it/s]
Adding feature literal:   4%|▍         | 7080/187062 [00:00<00:10, 17152.09it/s]
Adding feature literal:   8%|▊         | 15210/187062 [00:00<00:05, 33645.05it/s]
Adding feature literal:  12%|█▏        | 23367/187062 [00:00<00:03, 46518.88it/s]
Adding feature literal:  17%|█▋        | 31539/187062 [00:00<00:02, 56280.11it/s]
Adding feature literal:  21%|██        | 39720/187062 [00:00<00:02, 63523.61it/s]
Adding feature literal:  26%|██▌       | 47872/187062 [00:01<00:02, 68713.20it/s]
Adding feature literal:  30%|██▉       | 55866/187062 [00:01<00:01, 71987.31it/s]
Adding feature literal:  34%|███▍      | 64081/187062 [00:01<00:01, 74975.92it/s]
Adding feature literal:  39%|███▊      | 72349/187062 [00:01<00:01, 77253.57it/s]
Adding feature literal:  43%|████▎     | 80515/187062 [00:01<00:01, 78561.70it/s]
Adding feature literal:  47%|████▋     | 88745/187062 [00:01<00:01, 79675.21it/s]
Adding feature literal:  52%|█████▏    | 97055/187062 [00:01<00:01, 80697.07it/s]
Adding feature literal:  56%|█████▋    | 105258/187062 [00:01<00:01, 81094.03it/s]
Adding feature literal:  61%|██████    | 113461/187062 [00:01<00:00, 81373.02it/s]
Adding feature literal:  65%|██████▌   | 121708/187062 [00:01<00:00, 81700.20it/s]
Adding feature literal:  69%|██████▉   | 129922/187062 [00:02<00:00, 81830.25it/s]
Adding feature literal:  74%|███████▍  | 138155/187062 [00:02<00:00, 81977.56it/s]
Adding feature literal:  78%|███████▊  | 146373/187062 [00:02<00:00, 81982.31it/s]
Adding feature literal:  83%|████████▎ | 154586/187062 [00:02<00:00, 82013.24it/s]
Adding feature literal:  87%|████████▋ | 162809/187062 [00:02<00:00, 82076.31it/s]
Adding feature literal:  91%|█████████▏| 171024/187062 [00:02<00:00, 81393.79it/s]
Adding feature literal:  96%|█████████▌| 179170/187062 [00:02<00:00, 74242.14it/s]
Adding feature literal: 100%|█████████▉| 186718/187062 [00:02<00:00, 52300.66it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63483.69it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:14:43,  2.24it/s]
Adding feature operator:   4%|▍         | 7082/187062 [00:00<00:10, 17140.49it/s]
Adding feature operator:   8%|▊         | 15179/187062 [00:00<00:05, 33539.17it/s]
Adding feature operator:  12%|█▏        | 23314/187062 [00:00<00:03, 46375.34it/s]
Adding feature operator:  17%|█▋        | 31512/187062 [00:00<00:02, 56244.34it/s]
Adding feature operator:  21%|██        | 39435/187062 [00:00<00:02, 62764.13it/s]
Adding feature operator:  25%|██▌       | 47580/187062 [00:01<00:02, 68151.53it/s]
Adding feature operator:  30%|██▉       | 55704/187062 [00:01<00:01, 71969.15it/s]
Adding feature operator:  34%|███▍      | 63831/187062 [00:01<00:01, 74704.00it/s]
Adding feature operator:  38%|███▊      | 71978/187062 [00:01<00:01, 76705.02it/s]
Adding feature operator:  43%|████▎     | 80148/187062 [00:01<00:01, 78187.14it/s]
Adding feature operator:  47%|████▋     | 88262/187062 [00:01<00:01, 79065.63it/s]
Adding feature operator:  52%|█████▏    | 96453/187062 [00:01<00:01, 79912.63it/s]
Adding feature operator:  56%|█████▌    | 104599/187062 [00:01<00:01, 80373.24it/s]
Adding feature operator:  60%|██████    | 112745/187062 [00:01<00:00, 80697.08it/s]
Adding feature operator:  65%|██████▍   | 120875/187062 [00:01<00:00, 80877.22it/s]
Adding feature operator:  69%|██████▉   | 129003/187062 [00:02<00:00, 80984.86it/s]
Adding feature operator:  73%|███████▎  | 137130/187062 [00:02<00:00, 80992.27it/s]
Adding feature operator:  78%|███████▊  | 145249/187062 [00:02<00:00, 80406.03it/s]
Adding feature operator:  82%|████████▏ | 153377/187062 [00:02<00:00, 80665.67it/s]
Adding feature operator:  86%|████████▋ | 161579/187062 [00:02<00:00, 81067.36it/s]
Adding feature operator:  91%|█████████ | 169749/187062 [00:02<00:00, 81253.84it/s]
Adding feature operator:  95%|█████████▌| 177880/187062 [00:02<00:00, 80449.70it/s]
Adding feature operator:  99%|█████████▉| 185931/187062 [00:02<00:00, 53038.72it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63111.52it/s]
[2024-10-13 00:24:18,126] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/13/2024 00:24:19 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/13/2024 00:24:19 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 41/6548 [00:00<00:16, 388.91 examples/s]
Map:   1%|▏         | 82/6548 [00:00<00:32, 199.23 examples/s]
Map:   2%|▏         | 125/6548 [00:00<00:25, 254.12 examples/s]
Map:   3%|▎         | 165/6548 [00:00<00:21, 293.44 examples/s]
Map:   3%|▎         | 203/6548 [00:00<00:20, 316.51 examples/s]
Map:   4%|▍         | 248/6548 [00:00<00:18, 345.48 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:18, 339.70 examples/s]
Map:   5%|▍         | 326/6548 [00:01<00:21, 291.52 examples/s]
Map:   6%|▌         | 370/6548 [00:01<00:21, 289.83 examples/s]
Map:   6%|▋         | 422/6548 [00:01<00:17, 342.07 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:19, 314.86 examples/s]
Map:   8%|▊         | 534/6548 [00:01<00:17, 344.14 examples/s]
Map:   9%|▉         | 576/6548 [00:01<00:16, 360.33 examples/s]
Map:   9%|▉         | 622/6548 [00:01<00:17, 334.18 examples/s]
Map:  10%|█         | 665/6548 [00:02<00:18, 313.87 examples/s]
Map:  11%|█         | 707/6548 [00:02<00:17, 337.63 examples/s]
Map:  11%|█▏        | 746/6548 [00:02<00:16, 348.16 examples/s]
Map:  12%|█▏        | 797/6548 [00:02<00:14, 387.88 examples/s]
Map:  13%|█▎        | 854/6548 [00:02<00:14, 380.12 examples/s]
Map:  14%|█▍        | 906/6548 [00:02<00:15, 364.25 examples/s]
Map:  15%|█▍        | 969/6548 [00:02<00:14, 371.98 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:24, 228.96 examples/s]
Map:  16%|█▌        | 1054/6548 [00:03<00:21, 252.92 examples/s]
Map:  17%|█▋        | 1098/6548 [00:03<00:19, 285.73 examples/s]
Map:  18%|█▊        | 1146/6548 [00:03<00:16, 324.99 examples/s]
Map:  18%|█▊        | 1185/6548 [00:03<00:16, 334.42 examples/s]
Map:  19%|█▉        | 1228/6548 [00:03<00:15, 346.79 examples/s]
Map:  19%|█▉        | 1270/6548 [00:03<00:14, 363.60 examples/s]
Map:  20%|██        | 1324/6548 [00:04<00:15, 338.93 examples/s]
Map:  21%|██        | 1370/6548 [00:04<00:16, 317.06 examples/s]
Map:  22%|██▏       | 1416/6548 [00:04<00:16, 311.79 examples/s]
Map:  22%|██▏       | 1461/6548 [00:04<00:17, 283.70 examples/s]
Map:  23%|██▎       | 1493/6548 [00:04<00:17, 288.10 examples/s]
Map:  23%|██▎       | 1530/6548 [00:04<00:16, 304.91 examples/s]
Map:  24%|██▍       | 1574/6548 [00:05<00:17, 291.71 examples/s]
Map:  25%|██▍       | 1614/6548 [00:05<00:18, 273.60 examples/s]
Map:  25%|██▌       | 1646/6548 [00:05<00:17, 281.27 examples/s]
Map:  26%|██▌       | 1695/6548 [00:05<00:18, 261.45 examples/s]
Map:  26%|██▋       | 1728/6548 [00:05<00:17, 274.66 examples/s]
Map:  27%|██▋       | 1775/6548 [00:05<00:15, 317.30 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 322.41 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:14, 327.79 examples/s]
Map:  29%|██▉       | 1886/6548 [00:06<00:14, 328.85 examples/s]
Map:  29%|██▉       | 1920/6548 [00:06<00:14, 326.80 examples/s]
Map:  30%|██▉       | 1963/6548 [00:06<00:12, 353.57 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:20, 226.57 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:18, 240.46 examples/s]
Map:  32%|███▏      | 2072/6548 [00:06<00:16, 273.97 examples/s]
Map:  32%|███▏      | 2107/6548 [00:06<00:15, 288.56 examples/s]
Map:  33%|███▎      | 2152/6548 [00:07<00:16, 272.01 examples/s]
Map:  34%|███▎      | 2194/6548 [00:07<00:14, 304.46 examples/s]
Map:  34%|███▍      | 2229/6548 [00:07<00:15, 285.54 examples/s]
Map:  35%|███▍      | 2272/6548 [00:07<00:15, 277.62 examples/s]
Map:  35%|███▌      | 2311/6548 [00:07<00:14, 298.81 examples/s]
Map:  36%|███▌      | 2355/6548 [00:07<00:13, 306.18 examples/s]
Map:  37%|███▋      | 2396/6548 [00:07<00:12, 330.47 examples/s]
Map:  37%|███▋      | 2438/6548 [00:07<00:12, 320.47 examples/s]
Map:  38%|███▊      | 2489/6548 [00:08<00:12, 325.50 examples/s]
Map:  39%|███▉      | 2543/6548 [00:08<00:12, 322.15 examples/s]
Map:  40%|███▉      | 2594/6548 [00:08<00:11, 358.69 examples/s]
Map:  40%|████      | 2637/6548 [00:08<00:10, 372.26 examples/s]
Map:  41%|████      | 2682/6548 [00:08<00:11, 344.87 examples/s]
Map:  42%|████▏     | 2718/6548 [00:08<00:11, 341.31 examples/s]
Map:  42%|████▏     | 2760/6548 [00:08<00:10, 360.17 examples/s]
Map:  43%|████▎     | 2810/6548 [00:08<00:10, 345.77 examples/s]
Map:  44%|████▎     | 2862/6548 [00:09<00:12, 290.68 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 294.62 examples/s]
Map:  45%|████▍     | 2946/6548 [00:09<00:12, 287.04 examples/s]
Map:  46%|████▌     | 2988/6548 [00:09<00:12, 282.87 examples/s]
Map:  46%|████▌     | 3027/6548 [00:10<00:20, 169.42 examples/s]
Map:  47%|████▋     | 3058/6548 [00:10<00:18, 188.48 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 206.66 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:13, 247.76 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:13, 252.48 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 241.92 examples/s]
Map:  50%|████▉     | 3245/6548 [00:10<00:13, 246.13 examples/s]
Map:  50%|█████     | 3280/6548 [00:11<00:12, 265.81 examples/s]
Map:  51%|█████     | 3322/6548 [00:11<00:10, 297.30 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:11<00:10, 297.46 examples/s]
Map:  52%|█████▏    | 3420/6548 [00:11<00:11, 274.42 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 266.08 examples/s]
Map:  53%|█████▎    | 3486/6548 [00:11<00:11, 271.81 examples/s]
Map:  54%|█████▍    | 3532/6548 [00:11<00:09, 313.80 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:11<00:08, 340.92 examples/s]
Map:  55%|█████▌    | 3622/6548 [00:12<00:07, 365.87 examples/s]
Map:  56%|█████▌    | 3661/6548 [00:12<00:07, 368.40 examples/s]
Map:  57%|█████▋    | 3705/6548 [00:12<00:07, 386.80 examples/s]
Map:  57%|█████▋    | 3763/6548 [00:12<00:07, 382.67 examples/s]
Map:  58%|█████▊    | 3807/6548 [00:12<00:07, 388.95 examples/s]
Map:  59%|█████▉    | 3864/6548 [00:12<00:08, 320.20 examples/s]
Map:  60%|█████▉    | 3901/6548 [00:12<00:08, 330.25 examples/s]
Map:  60%|██████    | 3956/6548 [00:13<00:07, 325.39 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 240.57 examples/s]
Map:  62%|██████▏   | 4055/6548 [00:13<00:08, 295.50 examples/s]
Map:  63%|██████▎   | 4097/6548 [00:13<00:07, 319.17 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 329.95 examples/s]
Map:  64%|██████▍   | 4195/6548 [00:13<00:07, 331.03 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:06, 335.02 examples/s]
Map:  65%|██████▌   | 4282/6548 [00:14<00:06, 360.70 examples/s]
Map:  66%|██████▌   | 4325/6548 [00:14<00:05, 372.17 examples/s]
Map:  67%|██████▋   | 4366/6548 [00:14<00:06, 361.76 examples/s]
Map:  68%|██████▊   | 4431/6548 [00:14<00:05, 378.44 examples/s]
Map:  69%|██████▊   | 4486/6548 [00:14<00:05, 356.19 examples/s]
Map:  69%|██████▉   | 4528/6548 [00:14<00:06, 330.55 examples/s]
Map:  70%|██████▉   | 4570/6548 [00:14<00:06, 310.19 examples/s]
Map:  70%|███████   | 4610/6548 [00:15<00:06, 317.92 examples/s]
Map:  71%|███████   | 4659/6548 [00:15<00:05, 357.08 examples/s]
Map:  72%|███████▏  | 4706/6548 [00:15<00:05, 341.02 examples/s]
Map:  73%|███████▎  | 4751/6548 [00:15<00:05, 353.92 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 405.28 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 394.15 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 369.43 examples/s]
Map:  76%|███████▌  | 4953/6548 [00:15<00:04, 394.98 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:16<00:06, 240.55 examples/s]
Map:  77%|███████▋  | 5052/6548 [00:16<00:05, 262.85 examples/s]
Map:  78%|███████▊  | 5101/6548 [00:16<00:05, 271.84 examples/s]
Map:  78%|███████▊  | 5133/6548 [00:16<00:05, 267.24 examples/s]
Map:  79%|███████▉  | 5176/6548 [00:16<00:04, 296.83 examples/s]
Map:  80%|███████▉  | 5221/6548 [00:17<00:04, 286.24 examples/s]
Map:  80%|████████  | 5256/6548 [00:17<00:04, 292.62 examples/s]
Map:  81%|████████  | 5304/6548 [00:17<00:03, 333.86 examples/s]
Map:  82%|████████▏ | 5346/6548 [00:17<00:04, 291.35 examples/s]
Map:  82%|████████▏ | 5384/6548 [00:17<00:03, 310.55 examples/s]
Map:  83%|████████▎ | 5422/6548 [00:17<00:04, 271.52 examples/s]
Map:  83%|████████▎ | 5461/6548 [00:17<00:03, 291.99 examples/s]
Map:  84%|████████▍ | 5500/6548 [00:17<00:03, 313.62 examples/s]
Map:  85%|████████▍ | 5537/6548 [00:18<00:03, 327.53 examples/s]
Map:  85%|████████▌ | 5572/6548 [00:18<00:03, 318.32 examples/s]
Map:  86%|████████▌ | 5631/6548 [00:18<00:02, 336.73 examples/s]
Map:  87%|████████▋ | 5673/6548 [00:18<00:02, 315.77 examples/s]
Map:  87%|████████▋ | 5721/6548 [00:18<00:02, 311.73 examples/s]
Map:  88%|████████▊ | 5762/6548 [00:18<00:02, 332.06 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 338.76 examples/s]
Map:  89%|████████▉ | 5844/6548 [00:18<00:02, 338.64 examples/s]
Map:  90%|████████▉ | 5883/6548 [00:19<00:01, 345.08 examples/s]
Map:  90%|█████████ | 5923/6548 [00:19<00:01, 357.42 examples/s]
Map:  91%|█████████ | 5966/6548 [00:19<00:01, 330.84 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 206.96 examples/s]
Map:  92%|█████████▏| 6041/6548 [00:19<00:02, 243.70 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 275.66 examples/s]
Map:  93%|█████████▎| 6119/6548 [00:20<00:01, 261.21 examples/s]
Map:  94%|█████████▍| 6155/6548 [00:20<00:01, 282.05 examples/s]
Map:  95%|█████████▍| 6188/6548 [00:20<00:01, 289.37 examples/s]
Map:  95%|█████████▌| 6225/6548 [00:20<00:01, 307.57 examples/s]
Map:  96%|█████████▌| 6261/6548 [00:20<00:00, 320.04 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 337.05 examples/s]
Map:  97%|█████████▋| 6339/6548 [00:20<00:00, 344.29 examples/s]
Map:  97%|█████████▋| 6380/6548 [00:20<00:00, 347.56 examples/s]
Map:  98%|█████████▊| 6421/6548 [00:20<00:00, 360.22 examples/s]
Map:  99%|█████████▉| 6471/6548 [00:20<00:00, 394.59 examples/s]
Map:  99%|█████████▉| 6515/6548 [00:21<00:00, 387.05 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 307.54 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 318.97 examples/s]
Map:   8%|▊         | 73/903 [00:00<00:02, 343.90 examples/s]
Map:  14%|█▎        | 122/903 [00:00<00:02, 328.91 examples/s]
Map:  18%|█▊        | 167/903 [00:00<00:02, 365.84 examples/s]
Map:  23%|██▎       | 211/903 [00:00<00:01, 386.65 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 392.31 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 383.94 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 329.50 examples/s]
Map:  45%|████▌     | 409/903 [00:01<00:01, 290.72 examples/s]
Map:  50%|█████     | 455/903 [00:01<00:01, 292.25 examples/s]
Map:  54%|█████▍    | 487/903 [00:01<00:01, 292.97 examples/s]
Map:  59%|█████▉    | 536/903 [00:01<00:01, 331.44 examples/s]
Map:  64%|██████▍   | 577/903 [00:01<00:00, 349.02 examples/s]
Map:  68%|██████▊   | 618/903 [00:01<00:00, 362.32 examples/s]
Map:  73%|███████▎  | 658/903 [00:01<00:00, 369.52 examples/s]
Map:  78%|███████▊  | 702/903 [00:02<00:00, 384.05 examples/s]
Map:  83%|████████▎ | 746/903 [00:02<00:00, 396.41 examples/s]
Map:  88%|████████▊ | 796/903 [00:02<00:00, 364.95 examples/s]
Map:  95%|█████████▌| 859/903 [00:02<00:00, 380.03 examples/s]
Map:  99%|█████████▉| 898/903 [00:02<00:00, 320.12 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 317.52 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 295.66 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 355.69 examples/s]
Map:   7%|▋         | 127/1882 [00:00<00:05, 327.22 examples/s]
Map:   9%|▉         | 171/1882 [00:00<00:04, 360.17 examples/s]
Map:  12%|█▏        | 228/1882 [00:00<00:04, 363.57 examples/s]
Map:  14%|█▍        | 268/1882 [00:00<00:04, 372.27 examples/s]
Map:  17%|█▋        | 328/1882 [00:00<00:04, 379.08 examples/s]
Map:  20%|█▉        | 369/1882 [00:01<00:04, 336.76 examples/s]
Map:  22%|██▏       | 410/1882 [00:01<00:04, 305.96 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 306.33 examples/s]
Map:  26%|██▌       | 492/1882 [00:01<00:04, 336.96 examples/s]
Map:  29%|██▉       | 543/1882 [00:01<00:04, 325.92 examples/s]
Map:  31%|███       | 586/1882 [00:01<00:03, 349.70 examples/s]
Map:  34%|███▍      | 644/1882 [00:01<00:03, 399.56 examples/s]
Map:  37%|███▋      | 699/1882 [00:01<00:03, 381.95 examples/s]
Map:  41%|████      | 764/1882 [00:02<00:02, 390.87 examples/s]
Map:  43%|████▎     | 804/1882 [00:02<00:03, 341.69 examples/s]
Map:  45%|████▌     | 848/1882 [00:02<00:02, 355.88 examples/s]
Map:  48%|████▊     | 900/1882 [00:02<00:02, 346.58 examples/s]
Map:  50%|█████     | 946/1882 [00:02<00:02, 370.44 examples/s]
Map:  53%|█████▎    | 989/1882 [00:02<00:02, 378.53 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 241.59 examples/s]
Map:  58%|█████▊    | 1085/1882 [00:03<00:03, 256.38 examples/s]
Map:  59%|█████▉    | 1116/1882 [00:03<00:02, 264.40 examples/s]
Map:  62%|██████▏   | 1160/1882 [00:03<00:02, 268.84 examples/s]
Map:  64%|██████▍   | 1200/1882 [00:03<00:02, 249.64 examples/s]
Map:  66%|██████▌   | 1241/1882 [00:03<00:02, 280.45 examples/s]
Map:  68%|██████▊   | 1274/1882 [00:03<00:02, 290.44 examples/s]
Map:  70%|██████▉   | 1317/1882 [00:04<00:01, 322.96 examples/s]
Map:  72%|███████▏  | 1357/1882 [00:04<00:01, 341.72 examples/s]
Map:  75%|███████▍  | 1410/1882 [00:04<00:01, 336.27 examples/s]
Map:  77%|███████▋  | 1457/1882 [00:04<00:01, 310.14 examples/s]
Map:  79%|███████▉  | 1493/1882 [00:04<00:01, 276.31 examples/s]
Map:  81%|████████  | 1524/1882 [00:04<00:01, 276.77 examples/s]
Map:  83%|████████▎ | 1559/1882 [00:04<00:01, 292.02 examples/s]
Map:  85%|████████▌ | 1608/1882 [00:04<00:00, 339.57 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 341.99 examples/s]
Map:  91%|█████████ | 1716/1882 [00:05<00:00, 343.73 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 293.58 examples/s]
Map:  95%|█████████▍| 1785/1882 [00:05<00:00, 293.96 examples/s]
Map:  97%|█████████▋| 1830/1882 [00:05<00:00, 329.26 examples/s]
Map: 100%|█████████▉| 1875/1882 [00:05<00:00, 356.60 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 312.88 examples/s]
10/13/2024 00:25:21 - INFO - __main__ -     ***** Testing *****
10/13/2024 00:25:21 - INFO - __main__ -     Batch size = 8
10/13/2024 00:25:21 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/13/2024 00:25:22 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/13/2024 00:25:22 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/13/2024 00:25:23 - INFO - knnlm -   Reading datastore took 0.9774553775787354 s
10/13/2024 00:25:24 - INFO - knnlm -   Moving index to GPU took 1.0043749809265137 s
10/13/2024 00:25:24 - INFO - __main__ -   ******************************break-into
10/13/2024 00:25:24 - INFO - __main__ -     ***** Running acc evaluation *****
10/13/2024 00:25:24 - INFO - __main__ -     Num examples = 236
10/13/2024 00:25:24 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<32:49,  8.38s/it]
test ppl:   1%|          | 2/236 [00:10<17:55,  4.59s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:22,  3.19s/it]
test ppl:   2%|▏         | 4/236 [00:13<09:58,  2.58s/it]
test ppl:   2%|▏         | 5/236 [00:19<14:28,  3.76s/it]
test ppl:   3%|▎         | 6/236 [00:21<12:31,  3.27s/it]
test ppl:   3%|▎         | 7/236 [00:24<11:33,  3.03s/it]
test ppl:   3%|▎         | 8/236 [00:28<13:00,  3.43s/it]
test ppl:   4%|▍         | 9/236 [00:34<15:52,  4.20s/it]
test ppl:   4%|▍         | 10/236 [00:37<14:26,  3.84s/it]
test ppl:   5%|▍         | 11/236 [00:39<12:41,  3.38s/it]
test ppl:   5%|▌         | 12/236 [00:45<15:27,  4.14s/it]
test ppl:   6%|▌         | 13/236 [00:50<16:09,  4.35s/it]
test ppl:   6%|▌         | 14/236 [00:56<17:49,  4.82s/it]
test ppl:   6%|▋         | 15/236 [00:58<15:00,  4.07s/it]
test ppl:   7%|▋         | 16/236 [01:00<12:29,  3.41s/it]
test ppl:   7%|▋         | 17/236 [01:06<15:09,  4.15s/it]
test ppl:   8%|▊         | 18/236 [01:08<12:24,  3.41s/it]
test ppl:   8%|▊         | 19/236 [01:12<13:27,  3.72s/it]
test ppl:   8%|▊         | 20/236 [01:14<11:17,  3.14s/it]
test ppl:   9%|▉         | 21/236 [01:16<10:17,  2.87s/it]
test ppl:   9%|▉         | 22/236 [01:22<13:28,  3.78s/it]
test ppl:  10%|▉         | 23/236 [01:24<12:04,  3.40s/it]
test ppl:  10%|█         | 24/236 [01:27<10:55,  3.09s/it]
test ppl:  11%|█         | 25/236 [01:29<09:33,  2.72s/it]
test ppl:  11%|█         | 26/236 [01:35<12:51,  3.68s/it]
test ppl:  11%|█▏        | 27/236 [01:39<13:18,  3.82s/it]
test ppl:  12%|█▏        | 28/236 [01:40<10:31,  3.04s/it]
test ppl:  12%|█▏        | 29/236 [01:42<09:44,  2.82s/it]
test ppl:  13%|█▎        | 30/236 [01:44<08:21,  2.44s/it]
test ppl:  13%|█▎        | 31/236 [01:47<08:47,  2.58s/it]
test ppl:  14%|█▎        | 32/236 [01:50<09:03,  2.67s/it]
test ppl:  14%|█▍        | 33/236 [01:56<12:18,  3.64s/it]
test ppl:  14%|█▍        | 34/236 [02:00<12:37,  3.75s/it]
test ppl:  15%|█▍        | 35/236 [02:02<11:20,  3.38s/it]
test ppl:  15%|█▌        | 36/236 [02:08<13:46,  4.13s/it]
test ppl:  16%|█▌        | 37/236 [02:14<15:28,  4.67s/it]
test ppl:  16%|█▌        | 38/236 [02:16<12:49,  3.89s/it]
test ppl:  17%|█▋        | 39/236 [02:17<10:25,  3.18s/it]
test ppl:  17%|█▋        | 40/236 [02:20<09:54,  3.03s/it]
test ppl:  17%|█▋        | 41/236 [02:23<09:21,  2.88s/it]
test ppl:  18%|█▊        | 42/236 [02:29<12:15,  3.79s/it]
test ppl:  18%|█▊        | 43/236 [02:34<14:13,  4.42s/it]
test ppl:  19%|█▊        | 44/236 [02:36<11:46,  3.68s/it]
test ppl:  19%|█▉        | 45/236 [02:38<10:04,  3.16s/it]
test ppl:  19%|█▉        | 46/236 [02:44<11:55,  3.77s/it]
test ppl:  20%|█▉        | 47/236 [02:50<13:54,  4.42s/it]
test ppl:  20%|██        | 48/236 [02:55<15:12,  4.85s/it]
test ppl:  21%|██        | 49/236 [02:59<13:41,  4.39s/it]
test ppl:  21%|██        | 50/236 [03:05<15:03,  4.86s/it]
test ppl:  22%|██▏       | 51/236 [03:11<15:56,  5.17s/it]
test ppl:  22%|██▏       | 52/236 [03:16<16:31,  5.39s/it]
test ppl:  22%|██▏       | 53/236 [03:22<16:28,  5.40s/it]
test ppl:  23%|██▎       | 54/236 [03:23<12:52,  4.24s/it]
test ppl:  23%|██▎       | 55/236 [03:29<14:03,  4.66s/it]
test ppl:  24%|██▎       | 56/236 [03:32<12:51,  4.28s/it]
test ppl:  24%|██▍       | 57/236 [03:35<11:14,  3.77s/it]
test ppl:  25%|██▍       | 58/236 [03:37<09:46,  3.29s/it]
test ppl:  25%|██▌       | 59/236 [03:43<12:01,  4.07s/it]
test ppl:  25%|██▌       | 60/236 [03:46<11:11,  3.82s/it]
test ppl:  26%|██▌       | 61/236 [03:52<12:57,  4.44s/it]
test ppl:  26%|██▋       | 62/236 [03:56<12:36,  4.35s/it]
test ppl:  27%|██▋       | 63/236 [03:59<10:55,  3.79s/it]
test ppl:  27%|██▋       | 64/236 [04:00<08:54,  3.11s/it]
test ppl:  28%|██▊       | 65/236 [04:02<07:20,  2.57s/it]
test ppl:  28%|██▊       | 66/236 [04:05<07:38,  2.69s/it]
test ppl:  28%|██▊       | 67/236 [04:11<10:18,  3.66s/it]
test ppl:  29%|██▉       | 68/236 [04:16<12:08,  4.34s/it]
test ppl:  29%|██▉       | 69/236 [04:22<13:22,  4.80s/it]
test ppl:  30%|██▉       | 70/236 [04:24<10:38,  3.85s/it]
test ppl:  30%|███       | 71/236 [04:28<10:43,  3.90s/it]
test ppl:  31%|███       | 72/236 [04:32<10:36,  3.88s/it]
test ppl:  31%|███       | 73/236 [04:36<10:31,  3.88s/it]
test ppl:  31%|███▏      | 74/236 [04:37<08:33,  3.17s/it]
test ppl:  32%|███▏      | 75/236 [04:43<10:42,  3.99s/it]
test ppl:  32%|███▏      | 76/236 [04:47<10:41,  4.01s/it]
test ppl:  33%|███▎      | 77/236 [04:49<09:15,  3.49s/it]
test ppl:  33%|███▎      | 78/236 [04:51<07:56,  3.02s/it]
test ppl:  33%|███▎      | 79/236 [04:56<09:27,  3.62s/it]
test ppl:  34%|███▍      | 80/236 [04:58<08:05,  3.11s/it]
test ppl:  34%|███▍      | 81/236 [05:04<10:10,  3.94s/it]
test ppl:  35%|███▍      | 82/236 [05:10<11:37,  4.53s/it]
test ppl:  35%|███▌      | 83/236 [05:12<09:37,  3.77s/it]
test ppl:  36%|███▌      | 84/236 [05:14<08:08,  3.21s/it]
test ppl:  36%|███▌      | 85/236 [05:20<09:57,  3.96s/it]
test ppl:  36%|███▋      | 86/236 [05:22<08:33,  3.43s/it]
test ppl:  37%|███▋      | 87/236 [05:24<07:31,  3.03s/it]
test ppl:  37%|███▋      | 88/236 [05:30<09:34,  3.88s/it]
test ppl:  38%|███▊      | 89/236 [05:36<10:58,  4.48s/it]
test ppl:  38%|███▊      | 90/236 [05:42<11:55,  4.90s/it]
test ppl:  39%|███▊      | 91/236 [05:48<12:33,  5.19s/it]
test ppl:  39%|███▉      | 92/236 [05:50<10:45,  4.48s/it]
test ppl:  39%|███▉      | 93/236 [05:56<11:39,  4.89s/it]
test ppl:  40%|███▉      | 94/236 [06:02<12:17,  5.19s/it]
test ppl:  40%|████      | 95/236 [06:05<10:54,  4.64s/it]
test ppl:  41%|████      | 96/236 [06:08<09:39,  4.14s/it]
test ppl:  41%|████      | 97/236 [06:14<10:47,  4.66s/it]
test ppl:  42%|████▏     | 98/236 [06:20<11:34,  5.03s/it]
test ppl:  42%|████▏     | 99/236 [06:26<12:04,  5.29s/it]
test ppl:  42%|████▏     | 100/236 [06:27<09:17,  4.10s/it]
test ppl:  43%|████▎     | 101/236 [06:33<10:25,  4.63s/it]
test ppl:  43%|████▎     | 102/236 [06:37<09:39,  4.33s/it]
test ppl:  44%|████▎     | 103/236 [06:39<08:07,  3.67s/it]
test ppl:  44%|████▍     | 104/236 [06:43<08:27,  3.84s/it]
test ppl:  44%|████▍     | 105/236 [06:47<08:26,  3.87s/it]
test ppl:  45%|████▍     | 106/236 [06:53<09:23,  4.33s/it]
test ppl:  45%|████▌     | 107/236 [06:55<07:50,  3.65s/it]
test ppl:  46%|████▌     | 108/236 [06:58<07:37,  3.58s/it]
test ppl:  46%|████▌     | 109/236 [07:03<08:15,  3.91s/it]
test ppl:  47%|████▋     | 110/236 [07:05<06:52,  3.27s/it]
test ppl:  47%|████▋     | 111/236 [07:08<06:56,  3.33s/it]
test ppl:  47%|████▋     | 112/236 [07:11<06:32,  3.16s/it]
test ppl:  48%|████▊     | 113/236 [07:13<05:37,  2.74s/it]
test ppl:  48%|████▊     | 114/236 [07:16<05:57,  2.93s/it]
test ppl:  49%|████▊     | 115/236 [07:22<07:41,  3.81s/it]
test ppl:  49%|████▉     | 116/236 [07:27<08:41,  4.34s/it]
test ppl:  50%|████▉     | 117/236 [07:29<07:07,  3.60s/it]
test ppl:  50%|█████     | 118/236 [07:34<07:32,  3.83s/it]
test ppl:  50%|█████     | 119/236 [07:37<07:10,  3.68s/it]
test ppl:  51%|█████     | 120/236 [07:38<05:44,  2.97s/it]
test ppl:  51%|█████▏    | 121/236 [07:44<07:21,  3.84s/it]
test ppl:  52%|█████▏    | 122/236 [07:49<07:53,  4.15s/it]
test ppl:  52%|█████▏    | 123/236 [07:51<06:41,  3.55s/it]
test ppl:  53%|█████▎    | 124/236 [07:54<06:11,  3.31s/it]
test ppl:  53%|█████▎    | 125/236 [07:58<06:21,  3.44s/it]
test ppl:  53%|█████▎    | 126/236 [08:01<06:26,  3.51s/it]
test ppl:  54%|█████▍    | 127/236 [08:03<05:29,  3.02s/it]
test ppl:  54%|█████▍    | 128/236 [08:05<05:00,  2.79s/it]
test ppl:  55%|█████▍    | 129/236 [08:09<05:39,  3.18s/it]
test ppl:  55%|█████▌    | 130/236 [08:14<06:15,  3.54s/it]
test ppl:  56%|█████▌    | 131/236 [08:20<07:25,  4.24s/it]
test ppl:  56%|█████▌    | 132/236 [08:22<06:26,  3.71s/it]
test ppl:  56%|█████▋    | 133/236 [08:26<06:28,  3.77s/it]
test ppl:  57%|█████▋    | 134/236 [08:30<06:41,  3.93s/it]
test ppl:  57%|█████▋    | 135/236 [08:35<07:06,  4.22s/it]
test ppl:  58%|█████▊    | 136/236 [08:37<05:32,  3.32s/it]
test ppl:  58%|█████▊    | 137/236 [08:42<06:46,  4.10s/it]
test ppl:  58%|█████▊    | 138/236 [08:46<06:15,  3.83s/it]
test ppl:  59%|█████▉    | 139/236 [08:48<05:35,  3.45s/it]
test ppl:  59%|█████▉    | 140/236 [08:50<04:52,  3.05s/it]
test ppl:  60%|█████▉    | 141/236 [08:53<04:44,  3.00s/it]
test ppl:  60%|██████    | 142/236 [08:55<04:17,  2.74s/it]
test ppl:  61%|██████    | 143/236 [09:01<05:42,  3.68s/it]
test ppl:  61%|██████    | 144/236 [09:04<05:12,  3.40s/it]
test ppl:  61%|██████▏   | 145/236 [09:10<06:08,  4.05s/it]
test ppl:  62%|██████▏   | 146/236 [09:14<06:16,  4.19s/it]
test ppl:  62%|██████▏   | 147/236 [09:20<06:58,  4.70s/it]
test ppl:  63%|██████▎   | 148/236 [09:26<07:27,  5.09s/it]
test ppl:  63%|██████▎   | 149/236 [09:29<06:37,  4.57s/it]
test ppl:  64%|██████▎   | 150/236 [09:33<06:20,  4.42s/it]
test ppl:  64%|██████▍   | 151/236 [09:39<06:53,  4.86s/it]
test ppl:  64%|██████▍   | 152/236 [09:45<07:13,  5.16s/it]
test ppl:  65%|██████▍   | 153/236 [09:51<07:26,  5.37s/it]
test ppl:  65%|██████▌   | 154/236 [09:54<06:10,  4.52s/it]
test ppl:  66%|██████▌   | 155/236 [09:56<05:19,  3.94s/it]
test ppl:  66%|██████▌   | 156/236 [09:58<04:32,  3.41s/it]
test ppl:  67%|██████▋   | 157/236 [10:01<04:01,  3.05s/it]
test ppl:  67%|██████▋   | 158/236 [10:06<05:04,  3.90s/it]
test ppl:  67%|██████▋   | 159/236 [10:12<05:45,  4.49s/it]
test ppl:  68%|██████▊   | 160/236 [10:13<04:25,  3.50s/it]
test ppl:  68%|██████▊   | 161/236 [10:15<03:34,  2.86s/it]
test ppl:  69%|██████▊   | 162/236 [10:18<03:32,  2.87s/it]
test ppl:  69%|██████▉   | 163/236 [10:20<03:21,  2.77s/it]
test ppl:  69%|██████▉   | 164/236 [10:24<03:37,  3.03s/it]
test ppl:  70%|██████▉   | 165/236 [10:28<04:08,  3.50s/it]
test ppl:  70%|███████   | 166/236 [10:32<04:01,  3.44s/it]
test ppl:  71%|███████   | 167/236 [10:33<03:16,  2.85s/it]
test ppl:  71%|███████   | 168/236 [10:38<03:43,  3.29s/it]
test ppl:  72%|███████▏  | 169/236 [10:43<04:23,  3.93s/it]
test ppl:  72%|███████▏  | 170/236 [10:49<04:58,  4.53s/it]
test ppl:  72%|███████▏  | 171/236 [10:50<03:52,  3.57s/it]
test ppl:  73%|███████▎  | 172/236 [10:53<03:24,  3.19s/it]
test ppl:  73%|███████▎  | 173/236 [10:56<03:26,  3.28s/it]
test ppl:  74%|███████▎  | 174/236 [11:02<04:12,  4.07s/it]
test ppl:  74%|███████▍  | 175/236 [11:04<03:27,  3.40s/it]
test ppl:  75%|███████▍  | 176/236 [11:09<03:50,  3.84s/it]
test ppl:  75%|███████▌  | 177/236 [11:15<04:23,  4.46s/it]
test ppl:  75%|███████▌  | 178/236 [11:21<04:44,  4.90s/it]
test ppl:  76%|███████▌  | 179/236 [11:26<04:56,  5.20s/it]
test ppl:  76%|███████▋  | 180/236 [11:31<04:41,  5.02s/it]
test ppl:  77%|███████▋  | 181/236 [11:37<04:50,  5.28s/it]
test ppl:  77%|███████▋  | 182/236 [11:39<03:50,  4.26s/it]
test ppl:  78%|███████▊  | 183/236 [11:41<03:14,  3.68s/it]
test ppl:  78%|███████▊  | 184/236 [11:43<02:36,  3.01s/it]
test ppl:  78%|███████▊  | 185/236 [11:47<02:54,  3.42s/it]
test ppl:  79%|███████▉  | 186/236 [11:53<03:27,  4.16s/it]
test ppl:  79%|███████▉  | 187/236 [11:59<03:50,  4.70s/it]
test ppl:  80%|███████▉  | 188/236 [12:05<04:03,  5.07s/it]
test ppl:  80%|████████  | 189/236 [12:11<04:10,  5.32s/it]
test ppl:  81%|████████  | 190/236 [12:15<03:46,  4.93s/it]
test ppl:  81%|████████  | 191/236 [12:19<03:34,  4.76s/it]
test ppl:  81%|████████▏ | 192/236 [12:22<03:01,  4.12s/it]
test ppl:  82%|████████▏ | 193/236 [12:28<03:20,  4.66s/it]
test ppl:  82%|████████▏ | 194/236 [12:30<02:50,  4.05s/it]
test ppl:  83%|████████▎ | 195/236 [12:33<02:34,  3.76s/it]
test ppl:  83%|████████▎ | 196/236 [12:35<02:09,  3.23s/it]
test ppl:  83%|████████▎ | 197/236 [12:38<01:58,  3.04s/it]
test ppl:  84%|████████▍ | 198/236 [12:44<02:28,  3.90s/it]
test ppl:  84%|████████▍ | 199/236 [12:46<02:11,  3.54s/it]
test ppl:  85%|████████▍ | 200/236 [12:52<02:32,  4.25s/it]
test ppl:  85%|████████▌ | 201/236 [12:54<02:05,  3.59s/it]
test ppl:  86%|████████▌ | 202/236 [12:59<02:12,  3.90s/it]
test ppl:  86%|████████▌ | 203/236 [13:05<02:28,  4.50s/it]
test ppl:  86%|████████▋ | 204/236 [13:06<01:55,  3.59s/it]
test ppl:  87%|████████▋ | 205/236 [13:12<02:13,  4.30s/it]
test ppl:  87%|████████▋ | 206/236 [13:16<02:00,  4.03s/it]
test ppl:  88%|████████▊ | 207/236 [13:22<02:13,  4.59s/it]
test ppl:  88%|████████▊ | 208/236 [13:25<01:56,  4.16s/it]
test ppl:  89%|████████▊ | 209/236 [13:31<02:07,  4.71s/it]
test ppl:  89%|████████▉ | 210/236 [13:33<01:44,  4.00s/it]
test ppl:  89%|████████▉ | 211/236 [13:38<01:46,  4.25s/it]
test ppl:  90%|████████▉ | 212/236 [13:43<01:45,  4.40s/it]
test ppl:  90%|█████████ | 213/236 [13:49<01:51,  4.84s/it]
test ppl:  91%|█████████ | 214/236 [13:50<01:25,  3.89s/it]
test ppl:  91%|█████████ | 215/236 [13:56<01:34,  4.50s/it]
test ppl:  92%|█████████▏| 216/236 [13:59<01:18,  3.92s/it]
test ppl:  92%|█████████▏| 217/236 [14:05<01:26,  4.54s/it]
test ppl:  92%|█████████▏| 218/236 [14:07<01:07,  3.77s/it]
test ppl:  93%|█████████▎| 219/236 [14:13<01:15,  4.42s/it]
test ppl:  93%|█████████▎| 220/236 [14:19<01:17,  4.87s/it]
test ppl:  94%|█████████▎| 221/236 [14:22<01:05,  4.34s/it]
test ppl:  94%|█████████▍| 222/236 [14:28<01:07,  4.82s/it]
test ppl:  94%|█████████▍| 223/236 [14:34<01:07,  5.16s/it]
test ppl:  95%|█████████▍| 224/236 [14:35<00:48,  4.00s/it]
test ppl:  95%|█████████▌| 225/236 [14:41<00:50,  4.56s/it]
test ppl:  96%|█████████▌| 226/236 [14:44<00:42,  4.29s/it]
test ppl:  96%|█████████▌| 227/236 [14:47<00:33,  3.74s/it]
test ppl:  97%|█████████▋| 228/236 [14:49<00:25,  3.22s/it]
test ppl:  97%|█████████▋| 229/236 [14:55<00:28,  4.02s/it]
test ppl:  97%|█████████▋| 230/236 [14:58<00:23,  3.87s/it]
test ppl:  98%|█████████▊| 231/236 [15:02<00:18,  3.71s/it]
test ppl:  98%|█████████▊| 232/236 [15:03<00:12,  3.13s/it]
test ppl:  99%|█████████▊| 233/236 [15:07<00:10,  3.42s/it]
test ppl:  99%|█████████▉| 234/236 [15:09<00:05,  2.76s/it]
test ppl: 100%|█████████▉| 235/236 [15:15<00:03,  3.70s/it]
test ppl: 100%|██████████| 236/236 [15:15<00:00,  2.79s/it]
test ppl: 100%|██████████| 236/236 [15:15<00:00,  3.88s/it]
10/13/2024 00:40:39 - INFO - __main__ -    em: 0.2099
10/13/2024 00:40:39 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/64_0.2_80_eval_results.json
64 0.2 80:  em: 0.2099

--------------------------------------------------------------------------------
Running experiment with knn_temp=80, lmbda=0.4, k=16
2024-10-13 00:40:46.852958: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-13 00:40:46.873231: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-13 00:40:46.896459: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-13 00:40:46.903541: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-13 00:40:46.919889: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-13 00:40:47.914179: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/13/2024 00:40:49 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.4, knn_temp=80, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/13/2024 00:40:49 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:40:45,  2.19it/s]
Adding feature api:   4%|▍         | 7374/187062 [00:00<00:10, 17598.15it/s]
Adding feature api:   8%|▊         | 15641/187062 [00:00<00:05, 34142.03it/s]
Adding feature api:  13%|█▎        | 24164/187062 [00:00<00:03, 47752.88it/s]
Adding feature api:  17%|█▋        | 32728/187062 [00:00<00:02, 58195.90it/s]
Adding feature api:  22%|██▏       | 41331/187062 [00:00<00:02, 66058.36it/s]
Adding feature api:  27%|██▋       | 49866/187062 [00:01<00:01, 71605.23it/s]
Adding feature api:  31%|███       | 58196/187062 [00:01<00:01, 75008.15it/s]
Adding feature api:  36%|███▌      | 66755/187062 [00:01<00:01, 78114.79it/s]
Adding feature api:  40%|████      | 75320/187062 [00:01<00:01, 80339.25it/s]
Adding feature api:  45%|████▍     | 83852/187062 [00:01<00:01, 81816.90it/s]
Adding feature api:  49%|████▉     | 92286/187062 [00:01<00:01, 82348.62it/s]
Adding feature api:  54%|█████▍    | 100827/187062 [00:01<00:01, 83258.42it/s]
Adding feature api:  58%|█████▊    | 109278/187062 [00:01<00:00, 83629.10it/s]
Adding feature api:  63%|██████▎   | 117851/187062 [00:01<00:00, 84253.85it/s]
Adding feature api:  68%|██████▊   | 126338/187062 [00:01<00:00, 84107.67it/s]
Adding feature api:  72%|███████▏  | 134882/187062 [00:02<00:00, 84503.08it/s]
Adding feature api:  77%|███████▋  | 143478/187062 [00:02<00:00, 84936.93it/s]
Adding feature api:  81%|████████▏ | 152080/187062 [00:02<00:00, 85260.61it/s]
Adding feature api:  86%|████████▌ | 160622/187062 [00:02<00:00, 85184.70it/s]
Adding feature api:  90%|█████████ | 169152/187062 [00:02<00:00, 84529.52it/s]
Adding feature api:  95%|█████████▌| 177723/187062 [00:02<00:00, 84880.49it/s]
Adding feature api: 100%|█████████▉| 186218/187062 [00:02<00:00, 54113.24it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64992.38it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:41:00,  2.19it/s]
Adding feature datatype:   4%|▎         | 6801/187062 [00:00<00:11, 16228.55it/s]
Adding feature datatype:   8%|▊         | 14968/187062 [00:00<00:05, 32865.70it/s]
Adding feature datatype:  12%|█▏        | 23177/187062 [00:00<00:03, 45979.69it/s]
Adding feature datatype:  17%|█▋        | 31442/187062 [00:00<00:02, 56087.44it/s]
Adding feature datatype:  21%|██        | 39699/187062 [00:00<00:02, 63567.37it/s]
Adding feature datatype:  25%|██▌       | 47587/187062 [00:01<00:02, 67968.21it/s]
Adding feature datatype:  30%|██▉       | 55748/187062 [00:01<00:01, 71938.94it/s]
Adding feature datatype:  34%|███▍      | 63996/187062 [00:01<00:01, 75033.94it/s]
Adding feature datatype:  39%|███▊      | 72294/187062 [00:01<00:01, 77380.43it/s]
Adding feature datatype:  43%|████▎     | 80596/187062 [00:01<00:01, 79052.66it/s]
Adding feature datatype:  48%|████▊     | 88938/187062 [00:01<00:01, 80351.99it/s]
Adding feature datatype:  52%|█████▏    | 97146/187062 [00:01<00:01, 80154.45it/s]
Adding feature datatype:  56%|█████▋    | 105419/187062 [00:01<00:01, 80918.74it/s]
Adding feature datatype:  61%|██████    | 113659/187062 [00:01<00:00, 81357.14it/s]
Adding feature datatype:  65%|██████▌   | 121921/187062 [00:01<00:00, 81733.32it/s]
Adding feature datatype:  70%|██████▉   | 130137/187062 [00:02<00:00, 81055.99it/s]
Adding feature datatype:  74%|███████▍  | 138432/187062 [00:02<00:00, 81616.58it/s]
Adding feature datatype:  78%|███████▊  | 146750/187062 [00:02<00:00, 82081.40it/s]
Adding feature datatype:  83%|████████▎ | 155017/187062 [00:02<00:00, 82254.38it/s]
Adding feature datatype:  87%|████████▋ | 163254/187062 [00:02<00:00, 81209.94it/s]
Adding feature datatype:  92%|█████████▏| 171510/187062 [00:02<00:00, 81607.97it/s]
Adding feature datatype:  96%|█████████▌| 179679/187062 [00:02<00:00, 72430.27it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 63198.12it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:38:25,  2.20it/s]
Adding feature literal:   4%|▍         | 7156/187062 [00:00<00:10, 17099.28it/s]
Adding feature literal:   8%|▊         | 15212/187062 [00:00<00:05, 33249.29it/s]
Adding feature literal:  12%|█▏        | 23334/187062 [00:00<00:03, 46038.42it/s]
Adding feature literal:  17%|█▋        | 31482/187062 [00:00<00:02, 55812.10it/s]
Adding feature literal:  21%|██        | 39596/187062 [00:00<00:02, 62970.42it/s]
Adding feature literal:  26%|██▌       | 47718/187062 [00:01<00:02, 68217.31it/s]
Adding feature literal:  30%|██▉       | 55871/187062 [00:01<00:01, 72092.66it/s]
Adding feature literal:  34%|███▍      | 64065/187062 [00:01<00:01, 74984.44it/s]
Adding feature literal:  39%|███▊      | 72224/187062 [00:01<00:01, 76935.38it/s]
Adding feature literal:  43%|████▎     | 80351/187062 [00:01<00:01, 78220.46it/s]
Adding feature literal:  47%|████▋     | 88487/187062 [00:01<00:01, 79154.48it/s]
Adding feature literal:  52%|█████▏    | 96657/187062 [00:01<00:01, 79911.38it/s]
Adding feature literal:  56%|█████▌    | 104887/187062 [00:01<00:01, 80623.64it/s]
Adding feature literal:  60%|██████    | 113111/187062 [00:01<00:00, 81105.67it/s]
Adding feature literal:  65%|██████▍   | 121281/187062 [00:01<00:00, 81219.65it/s]
Adding feature literal:  69%|██████▉   | 129445/187062 [00:02<00:00, 81319.78it/s]
Adding feature literal:  74%|███████▎  | 137651/187062 [00:02<00:00, 81540.66it/s]
Adding feature literal:  78%|███████▊  | 145827/187062 [00:02<00:00, 81604.55it/s]
Adding feature literal:  82%|████████▏ | 154045/187062 [00:02<00:00, 81774.69it/s]
Adding feature literal:  87%|████████▋ | 162233/187062 [00:02<00:00, 81718.48it/s]
Adding feature literal:  91%|█████████ | 170412/187062 [00:02<00:00, 81605.67it/s]
Adding feature literal:  95%|█████████▌| 178578/187062 [00:02<00:00, 77140.10it/s]
Adding feature literal: 100%|█████████▉| 186346/187062 [00:02<00:00, 52490.59it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63144.88it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:51:15,  2.18it/s]
Adding feature operator:   4%|▍         | 7037/187062 [00:00<00:10, 16699.54it/s]
Adding feature operator:   8%|▊         | 15203/187062 [00:00<00:05, 33146.33it/s]
Adding feature operator:  12%|█▏        | 23379/187062 [00:00<00:03, 46058.16it/s]
Adding feature operator:  17%|█▋        | 31675/187062 [00:00<00:02, 56207.45it/s]
Adding feature operator:  21%|██▏       | 39966/187062 [00:00<00:02, 63739.15it/s]
Adding feature operator:  26%|██▌       | 48244/187062 [00:01<00:02, 69206.20it/s]
Adding feature operator:  30%|███       | 56514/187062 [00:01<00:01, 73129.33it/s]
Adding feature operator:  35%|███▍      | 64581/187062 [00:01<00:01, 75340.36it/s]
Adding feature operator:  39%|███▉      | 72774/187062 [00:01<00:01, 77284.71it/s]
Adding feature operator:  43%|████▎     | 81075/187062 [00:01<00:01, 78982.29it/s]
Adding feature operator:  48%|████▊     | 89343/187062 [00:01<00:01, 80080.10it/s]
Adding feature operator:  52%|█████▏    | 97629/187062 [00:01<00:01, 80907.79it/s]
Adding feature operator:  57%|█████▋    | 105943/187062 [00:01<00:00, 81573.77it/s]
Adding feature operator:  61%|██████    | 114228/187062 [00:01<00:00, 81953.79it/s]
Adding feature operator:  65%|██████▌   | 122484/187062 [00:01<00:00, 81964.12it/s]
Adding feature operator:  70%|██████▉   | 130748/187062 [00:02<00:00, 82164.18it/s]
Adding feature operator:  74%|███████▍  | 138994/187062 [00:02<00:00, 82200.79it/s]
Adding feature operator:  79%|███████▊  | 147235/187062 [00:02<00:00, 82153.60it/s]
Adding feature operator:  83%|████████▎ | 155465/187062 [00:02<00:00, 82180.56it/s]
Adding feature operator:  88%|████████▊ | 163760/187062 [00:02<00:00, 82408.91it/s]
Adding feature operator:  92%|█████████▏| 172009/187062 [00:02<00:00, 82415.09it/s]
Adding feature operator:  96%|█████████▋| 180256/187062 [00:02<00:00, 70228.35it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63461.03it/s]
[2024-10-13 00:41:32,971] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/13/2024 00:41:34 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/13/2024 00:41:34 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 410.83 examples/s]
Map:   2%|▏         | 103/6548 [00:00<00:26, 246.92 examples/s]
Map:   2%|▏         | 133/6548 [00:00<00:24, 260.15 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 304.36 examples/s]
Map:   3%|▎         | 219/6548 [00:00<00:19, 324.67 examples/s]
Map:   4%|▍         | 266/6548 [00:00<00:19, 317.63 examples/s]
Map:   5%|▍         | 302/6548 [00:00<00:19, 319.53 examples/s]
Map:   5%|▌         | 346/6548 [00:01<00:21, 290.65 examples/s]
Map:   6%|▌         | 380/6548 [00:01<00:20, 300.05 examples/s]
Map:   7%|▋         | 432/6548 [00:01<00:17, 343.44 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 332.91 examples/s]
Map:   8%|▊         | 509/6548 [00:01<00:17, 341.18 examples/s]
Map:   9%|▊         | 562/6548 [00:01<00:15, 384.06 examples/s]
Map:   9%|▉         | 606/6548 [00:01<00:15, 392.46 examples/s]
Map:  10%|█         | 660/6548 [00:02<00:20, 289.64 examples/s]
Map:  11%|█         | 706/6548 [00:02<00:18, 322.17 examples/s]
Map:  11%|█▏        | 748/6548 [00:02<00:16, 341.24 examples/s]
Map:  12%|█▏        | 801/6548 [00:02<00:14, 386.01 examples/s]
Map:  13%|█▎        | 862/6548 [00:02<00:14, 388.82 examples/s]
Map:  14%|█▍        | 915/6548 [00:02<00:14, 376.60 examples/s]
Map:  15%|█▍        | 955/6548 [00:02<00:14, 374.94 examples/s]
Map:  15%|█▌        | 998/6548 [00:02<00:16, 342.20 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:24, 227.80 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:21, 255.04 examples/s]
Map:  17%|█▋        | 1123/6548 [00:03<00:18, 295.93 examples/s]
Map:  18%|█▊        | 1162/6548 [00:03<00:17, 315.88 examples/s]
Map:  18%|█▊        | 1205/6548 [00:03<00:15, 339.38 examples/s]
Map:  19%|█▉        | 1262/6548 [00:03<00:15, 348.99 examples/s]
Map:  20%|█▉        | 1300/6548 [00:03<00:14, 355.46 examples/s]
Map:  20%|██        | 1342/6548 [00:04<00:15, 325.54 examples/s]
Map:  21%|██        | 1388/6548 [00:04<00:16, 310.14 examples/s]
Map:  22%|██▏       | 1430/6548 [00:04<00:15, 329.99 examples/s]
Map:  22%|██▏       | 1473/6548 [00:04<00:18, 275.75 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:17, 289.40 examples/s]
Map:  24%|██▎       | 1547/6548 [00:04<00:18, 273.86 examples/s]
Map:  24%|██▍       | 1578/6548 [00:05<00:17, 277.63 examples/s]
Map:  25%|██▍       | 1610/6548 [00:05<00:18, 269.14 examples/s]
Map:  25%|██▌       | 1640/6548 [00:05<00:18, 265.97 examples/s]
Map:  26%|██▌       | 1677/6548 [00:05<00:18, 257.42 examples/s]
Map:  26%|██▌       | 1715/6548 [00:05<00:16, 284.63 examples/s]
Map:  27%|██▋       | 1761/6548 [00:05<00:14, 324.47 examples/s]
Map:  28%|██▊       | 1803/6548 [00:05<00:13, 347.10 examples/s]
Map:  28%|██▊       | 1843/6548 [00:05<00:13, 358.01 examples/s]
Map:  29%|██▉       | 1886/6548 [00:05<00:14, 319.76 examples/s]
Map:  30%|██▉       | 1936/6548 [00:06<00:14, 316.66 examples/s]
Map:  30%|███       | 1983/6548 [00:06<00:13, 348.81 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:20, 219.79 examples/s]
Map:  32%|███▏      | 2070/6548 [00:06<00:18, 248.04 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 262.08 examples/s]
Map:  33%|███▎      | 2141/6548 [00:07<00:17, 250.27 examples/s]
Map:  33%|███▎      | 2172/6548 [00:07<00:16, 257.68 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 273.90 examples/s]
Map:  34%|███▍      | 2259/6548 [00:07<00:15, 274.33 examples/s]
Map:  35%|███▌      | 2310/6548 [00:07<00:14, 288.38 examples/s]
Map:  36%|███▌      | 2351/6548 [00:07<00:13, 314.12 examples/s]
Map:  36%|███▋      | 2384/6548 [00:07<00:13, 316.49 examples/s]
Map:  37%|███▋      | 2423/6548 [00:07<00:12, 334.08 examples/s]
Map:  38%|███▊      | 2459/6548 [00:08<00:12, 318.47 examples/s]
Map:  38%|███▊      | 2496/6548 [00:08<00:12, 324.64 examples/s]
Map:  39%|███▊      | 2537/6548 [00:08<00:11, 341.71 examples/s]
Map:  40%|███▉      | 2592/6548 [00:08<00:10, 392.25 examples/s]
Map:  40%|████      | 2634/6548 [00:08<00:09, 395.43 examples/s]
Map:  41%|████      | 2682/6548 [00:08<00:10, 361.00 examples/s]
Map:  42%|████▏     | 2741/6548 [00:08<00:10, 367.52 examples/s]
Map:  42%|████▏     | 2780/6548 [00:08<00:10, 367.04 examples/s]
Map:  43%|████▎     | 2828/6548 [00:09<00:12, 301.26 examples/s]
Map:  44%|████▍     | 2879/6548 [00:09<00:11, 310.66 examples/s]
Map:  45%|████▍     | 2922/6548 [00:09<00:12, 286.85 examples/s]
Map:  45%|████▌     | 2961/6548 [00:09<00:11, 300.16 examples/s]
Map:  46%|████▌     | 2995/6548 [00:09<00:15, 235.27 examples/s]
Map:  46%|████▌     | 3024/6548 [00:10<00:21, 163.31 examples/s]
Map:  47%|████▋     | 3055/6548 [00:10<00:18, 184.86 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 208.44 examples/s]
Map:  48%|████▊     | 3133/6548 [00:10<00:13, 245.59 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:13, 246.58 examples/s]
Map:  49%|████▉     | 3202/6548 [00:10<00:13, 250.19 examples/s]
Map:  50%|████▉     | 3245/6548 [00:10<00:13, 248.74 examples/s]
Map:  50%|█████     | 3280/6548 [00:11<00:12, 267.74 examples/s]
Map:  51%|█████     | 3322/6548 [00:11<00:10, 299.49 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:11<00:10, 299.13 examples/s]
Map:  52%|█████▏    | 3421/6548 [00:11<00:11, 276.81 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 263.55 examples/s]
Map:  53%|█████▎    | 3496/6548 [00:11<00:11, 267.08 examples/s]
Map:  54%|█████▍    | 3545/6548 [00:11<00:09, 314.53 examples/s]
Map:  55%|█████▍    | 3592/6548 [00:11<00:08, 349.10 examples/s]
Map:  56%|█████▌    | 3638/6548 [00:12<00:07, 375.33 examples/s]
Map:  56%|█████▋    | 3697/6548 [00:12<00:07, 376.75 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:12<00:07, 385.87 examples/s]
Map:  58%|█████▊    | 3794/6548 [00:12<00:07, 374.45 examples/s]
Map:  59%|█████▊    | 3839/6548 [00:12<00:08, 334.68 examples/s]
Map:  59%|█████▉    | 3882/6548 [00:12<00:08, 311.84 examples/s]
Map:  60%|█████▉    | 3918/6548 [00:12<00:08, 317.47 examples/s]
Map:  60%|██████    | 3953/6548 [00:13<00:08, 321.58 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 231.55 examples/s]
Map:  62%|██████▏   | 4055/6548 [00:13<00:08, 290.64 examples/s]
Map:  63%|██████▎   | 4097/6548 [00:13<00:07, 315.33 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 326.28 examples/s]
Map:  64%|██████▍   | 4194/6548 [00:13<00:07, 307.60 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:14<00:07, 317.22 examples/s]
Map:  65%|██████▌   | 4282/6548 [00:14<00:06, 346.57 examples/s]
Map:  66%|██████▌   | 4325/6548 [00:14<00:06, 360.38 examples/s]
Map:  67%|██████▋   | 4380/6548 [00:14<00:06, 344.40 examples/s]
Map:  68%|██████▊   | 4426/6548 [00:14<00:05, 363.07 examples/s]
Map:  68%|██████▊   | 4473/6548 [00:14<00:06, 343.20 examples/s]
Map:  69%|██████▉   | 4520/6548 [00:14<00:06, 328.39 examples/s]
Map:  70%|██████▉   | 4576/6548 [00:14<00:05, 338.87 examples/s]
Map:  71%|███████   | 4633/6548 [00:15<00:05, 347.77 examples/s]
Map:  71%|███████▏  | 4673/6548 [00:15<00:05, 356.46 examples/s]
Map:  72%|███████▏  | 4714/6548 [00:15<00:04, 367.86 examples/s]
Map:  73%|███████▎  | 4777/6548 [00:15<00:04, 379.85 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 389.07 examples/s]
Map:  75%|███████▍  | 4888/6548 [00:15<00:04, 382.95 examples/s]
Map:  75%|███████▌  | 4932/6548 [00:15<00:04, 390.49 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:03, 403.69 examples/s]
Map:  77%|███████▋  | 5038/6548 [00:16<00:05, 253.53 examples/s]
Map:  78%|███████▊  | 5081/6548 [00:16<00:05, 259.81 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 268.80 examples/s]
Map:  79%|███████▊  | 5155/6548 [00:16<00:04, 282.69 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 281.82 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:17<00:04, 296.19 examples/s]
Map:  80%|████████  | 5256/6548 [00:17<00:04, 299.86 examples/s]
Map:  81%|████████  | 5304/6548 [00:17<00:03, 345.38 examples/s]
Map:  82%|████████▏ | 5346/6548 [00:17<00:03, 308.22 examples/s]
Map:  82%|████████▏ | 5388/6548 [00:17<00:03, 330.86 examples/s]
Map:  83%|████████▎ | 5423/6548 [00:17<00:03, 285.41 examples/s]
Map:  83%|████████▎ | 5461/6548 [00:17<00:03, 303.38 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 323.61 examples/s]
Map:  85%|████████▍ | 5544/6548 [00:17<00:03, 334.64 examples/s]
Map:  85%|████████▌ | 5582/6548 [00:18<00:03, 289.74 examples/s]
Map:  86%|████████▌ | 5630/6548 [00:18<00:02, 331.57 examples/s]
Map:  87%|████████▋ | 5677/6548 [00:18<00:02, 320.85 examples/s]
Map:  88%|████████▊ | 5731/6548 [00:18<00:02, 325.63 examples/s]
Map:  88%|████████▊ | 5772/6548 [00:18<00:02, 341.26 examples/s]
Map:  89%|████████▉ | 5825/6548 [00:18<00:02, 337.07 examples/s]
Map:  90%|████████▉ | 5875/6548 [00:18<00:02, 333.40 examples/s]
Map:  90%|█████████ | 5913/6548 [00:19<00:01, 339.46 examples/s]
Map:  91%|█████████ | 5964/6548 [00:19<00:01, 322.67 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 211.66 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:02, 243.50 examples/s]
Map:  93%|█████████▎| 6075/6548 [00:19<00:01, 260.90 examples/s]
Map:  93%|█████████▎| 6106/6548 [00:19<00:01, 239.88 examples/s]
Map:  94%|█████████▍| 6140/6548 [00:20<00:01, 259.60 examples/s]
Map:  94%|█████████▍| 6180/6548 [00:20<00:01, 286.13 examples/s]
Map:  95%|█████████▌| 6224/6548 [00:20<00:01, 308.04 examples/s]
Map:  96%|█████████▌| 6261/6548 [00:20<00:00, 319.69 examples/s]
Map:  96%|█████████▌| 6302/6548 [00:20<00:00, 336.31 examples/s]
Map:  97%|█████████▋| 6337/6548 [00:20<00:00, 339.11 examples/s]
Map:  98%|█████████▊| 6386/6548 [00:20<00:00, 365.24 examples/s]
Map:  98%|█████████▊| 6427/6548 [00:20<00:00, 375.87 examples/s]
Map:  99%|█████████▉| 6476/6548 [00:20<00:00, 400.55 examples/s]
Map: 100%|█████████▉| 6537/6548 [00:21<00:00, 397.44 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 307.76 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 321.86 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 342.93 examples/s]
Map:  13%|█▎        | 116/903 [00:00<00:02, 338.83 examples/s]
Map:  17%|█▋        | 157/903 [00:00<00:02, 354.69 examples/s]
Map:  23%|██▎       | 209/903 [00:00<00:01, 404.54 examples/s]
Map:  29%|██▉       | 263/903 [00:00<00:01, 378.63 examples/s]
Map:  33%|███▎      | 302/903 [00:00<00:01, 372.94 examples/s]
Map:  39%|███▉      | 354/903 [00:00<00:01, 358.53 examples/s]
Map:  45%|████▌     | 409/903 [00:01<00:01, 287.51 examples/s]
Map:  50%|█████     | 455/903 [00:01<00:01, 290.43 examples/s]
Map:  56%|█████▌    | 502/903 [00:01<00:01, 291.68 examples/s]
Map:  61%|██████    | 548/903 [00:01<00:01, 325.86 examples/s]
Map:  66%|██████▌   | 593/903 [00:01<00:00, 351.38 examples/s]
Map:  70%|███████   | 635/903 [00:01<00:00, 358.66 examples/s]
Map:  75%|███████▍  | 675/903 [00:01<00:00, 367.20 examples/s]
Map:  79%|███████▉  | 716/903 [00:02<00:00, 373.30 examples/s]
Map:  85%|████████▍ | 766/903 [00:02<00:00, 397.65 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 387.19 examples/s]
Map:  97%|█████████▋| 872/903 [00:02<00:00, 402.89 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 319.06 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 295.53 examples/s]
Map:   4%|▍         | 81/1882 [00:00<00:04, 362.08 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 349.23 examples/s]
Map:   8%|▊         | 159/1882 [00:00<00:04, 363.72 examples/s]
Map:  11%|█         | 206/1882 [00:00<00:04, 338.51 examples/s]
Map:  13%|█▎        | 251/1882 [00:00<00:04, 367.34 examples/s]
Map:  16%|█▌        | 300/1882 [00:00<00:04, 342.75 examples/s]
Map:  18%|█▊        | 336/1882 [00:00<00:04, 340.24 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:05, 298.95 examples/s]
Map:  22%|██▏       | 414/1882 [00:01<00:05, 281.16 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 291.94 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 330.00 examples/s]
Map:  29%|██▉       | 543/1882 [00:01<00:04, 319.68 examples/s]
Map:  31%|███       | 587/1882 [00:01<00:03, 346.65 examples/s]
Map:  34%|███▍      | 644/1882 [00:01<00:03, 397.57 examples/s]
Map:  37%|███▋      | 704/1882 [00:02<00:03, 382.35 examples/s]
Map:  40%|███▉      | 744/1882 [00:02<00:02, 385.15 examples/s]
Map:  42%|████▏     | 795/1882 [00:02<00:02, 363.71 examples/s]
Map:  44%|████▍     | 833/1882 [00:02<00:02, 360.99 examples/s]
Map:  46%|████▋     | 873/1882 [00:02<00:02, 360.82 examples/s]
Map:  49%|████▊     | 917/1882 [00:02<00:02, 376.41 examples/s]
Map:  51%|█████▏    | 965/1882 [00:02<00:02, 402.16 examples/s]
Map:  54%|█████▍    | 1015/1882 [00:03<00:03, 245.42 examples/s]
Map:  56%|█████▌    | 1053/1882 [00:03<00:03, 267.33 examples/s]
Map:  58%|█████▊    | 1092/1882 [00:03<00:02, 263.50 examples/s]
Map:  61%|██████    | 1139/1882 [00:03<00:02, 271.74 examples/s]
Map:  62%|██████▏   | 1176/1882 [00:03<00:02, 290.96 examples/s]
Map:  64%|██████▍   | 1213/1882 [00:03<00:02, 274.70 examples/s]
Map:  67%|██████▋   | 1255/1882 [00:03<00:02, 303.69 examples/s]
Map:  68%|██████▊   | 1288/1882 [00:03<00:01, 307.84 examples/s]
Map:  71%|███████   | 1334/1882 [00:04<00:01, 344.56 examples/s]
Map:  73%|███████▎  | 1381/1882 [00:04<00:01, 328.35 examples/s]
Map:  75%|███████▌  | 1419/1882 [00:04<00:01, 293.11 examples/s]
Map:  78%|███████▊  | 1467/1882 [00:04<00:01, 299.79 examples/s]
Map:  80%|████████  | 1506/1882 [00:04<00:01, 260.75 examples/s]
Map:  82%|████████▏ | 1538/1882 [00:04<00:01, 267.36 examples/s]
Map:  84%|████████▍ | 1582/1882 [00:04<00:00, 303.31 examples/s]
Map:  86%|████████▌ | 1619/1882 [00:05<00:00, 315.16 examples/s]
Map:  88%|████████▊ | 1665/1882 [00:05<00:00, 310.96 examples/s]
Map:  90%|█████████ | 1701/1882 [00:05<00:00, 316.09 examples/s]
Map:  92%|█████████▏| 1734/1882 [00:05<00:00, 276.16 examples/s]
Map:  94%|█████████▍| 1775/1882 [00:05<00:00, 272.87 examples/s]
Map:  96%|█████████▌| 1811/1882 [00:05<00:00, 292.07 examples/s]
Map:  99%|█████████▊| 1856/1882 [00:05<00:00, 330.02 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 306.71 examples/s]
10/13/2024 00:42:36 - INFO - __main__ -     ***** Testing *****
10/13/2024 00:42:36 - INFO - __main__ -     Batch size = 8
10/13/2024 00:42:36 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/13/2024 00:42:37 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/13/2024 00:42:37 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/13/2024 00:42:38 - INFO - knnlm -   Reading datastore took 0.9502489566802979 s
10/13/2024 00:42:39 - INFO - knnlm -   Moving index to GPU took 0.9050769805908203 s
10/13/2024 00:42:39 - INFO - __main__ -   ******************************break-into
10/13/2024 00:42:39 - INFO - __main__ -     ***** Running acc evaluation *****
10/13/2024 00:42:39 - INFO - __main__ -     Num examples = 236
10/13/2024 00:42:39 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:53,  7.89s/it]
test ppl:   1%|          | 2/236 [00:09<17:08,  4.39s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:55,  3.07s/it]
test ppl:   2%|▏         | 4/236 [00:13<09:45,  2.52s/it]
test ppl:   2%|▏         | 5/236 [00:18<14:18,  3.72s/it]
test ppl:   3%|▎         | 6/236 [00:24<17:03,  4.45s/it]
test ppl:   3%|▎         | 7/236 [00:26<13:47,  3.61s/it]
test ppl:   3%|▎         | 8/236 [00:30<14:32,  3.82s/it]
test ppl:   4%|▍         | 9/236 [00:33<12:27,  3.29s/it]
test ppl:   4%|▍         | 10/236 [00:35<11:25,  3.04s/it]
test ppl:   5%|▍         | 11/236 [00:37<10:36,  2.83s/it]
test ppl:   5%|▌         | 12/236 [00:43<13:59,  3.75s/it]
test ppl:   6%|▌         | 13/236 [00:49<16:20,  4.40s/it]
test ppl:   6%|▌         | 14/236 [00:51<13:57,  3.77s/it]
test ppl:   6%|▋         | 15/236 [00:54<12:13,  3.32s/it]
test ppl:   7%|▋         | 16/236 [00:56<10:33,  2.88s/it]
test ppl:   7%|▋         | 17/236 [01:01<13:47,  3.78s/it]
test ppl:   8%|▊         | 18/236 [01:03<11:27,  3.15s/it]
test ppl:   8%|▊         | 19/236 [01:08<12:47,  3.54s/it]
test ppl:   8%|▊         | 20/236 [01:09<10:49,  3.01s/it]
test ppl:   9%|▉         | 21/236 [01:13<11:09,  3.11s/it]
test ppl:   9%|▉         | 22/236 [01:19<14:03,  3.94s/it]
test ppl:  10%|▉         | 23/236 [01:21<12:29,  3.52s/it]
test ppl:  10%|█         | 24/236 [01:23<11:11,  3.17s/it]
test ppl:  11%|█         | 25/236 [01:25<09:38,  2.74s/it]
test ppl:  11%|█         | 26/236 [01:31<12:54,  3.69s/it]
test ppl:  11%|█▏        | 27/236 [01:35<12:35,  3.61s/it]
test ppl:  12%|█▏        | 28/236 [01:36<10:01,  2.89s/it]
test ppl:  12%|█▏        | 29/236 [01:38<09:23,  2.72s/it]
test ppl:  13%|█▎        | 30/236 [01:40<08:06,  2.36s/it]
test ppl:  13%|█▎        | 31/236 [01:42<07:41,  2.25s/it]
test ppl:  14%|█▎        | 32/236 [01:44<08:03,  2.37s/it]
test ppl:  14%|█▍        | 33/236 [01:50<11:35,  3.43s/it]
test ppl:  14%|█▍        | 34/236 [01:54<12:07,  3.60s/it]
test ppl:  15%|█▍        | 35/236 [01:57<10:59,  3.28s/it]
test ppl:  15%|█▌        | 36/236 [02:03<13:32,  4.06s/it]
test ppl:  16%|█▌        | 37/236 [02:08<15:17,  4.61s/it]
test ppl:  16%|█▌        | 38/236 [02:10<12:42,  3.85s/it]
test ppl:  17%|█▋        | 39/236 [02:12<10:37,  3.24s/it]
test ppl:  17%|█▋        | 40/236 [02:15<10:03,  3.08s/it]
test ppl:  17%|█▋        | 41/236 [02:17<08:49,  2.72s/it]
test ppl:  18%|█▊        | 42/236 [02:23<11:53,  3.68s/it]
test ppl:  18%|█▊        | 43/236 [02:29<13:57,  4.34s/it]
test ppl:  19%|█▊        | 44/236 [02:31<12:06,  3.78s/it]
test ppl:  19%|█▉        | 45/236 [02:33<10:18,  3.24s/it]
test ppl:  19%|█▉        | 46/236 [02:39<12:48,  4.04s/it]
test ppl:  20%|█▉        | 47/236 [02:41<10:21,  3.29s/it]
test ppl:  20%|██        | 48/236 [02:46<12:42,  4.06s/it]
test ppl:  21%|██        | 49/236 [02:52<14:21,  4.61s/it]
test ppl:  21%|██        | 50/236 [02:58<15:31,  5.01s/it]
test ppl:  22%|██▏       | 51/236 [03:04<16:16,  5.28s/it]
test ppl:  22%|██▏       | 52/236 [03:10<16:45,  5.47s/it]
test ppl:  22%|██▏       | 53/236 [03:15<16:04,  5.27s/it]
test ppl:  23%|██▎       | 54/236 [03:16<12:35,  4.15s/it]
test ppl:  23%|██▎       | 55/236 [03:22<13:57,  4.63s/it]
test ppl:  24%|██▎       | 56/236 [03:26<12:46,  4.26s/it]
test ppl:  24%|██▍       | 57/236 [03:31<13:58,  4.68s/it]
test ppl:  25%|██▍       | 58/236 [03:33<11:39,  3.93s/it]
test ppl:  25%|██▌       | 59/236 [03:39<13:20,  4.52s/it]
test ppl:  25%|██▌       | 60/236 [03:42<12:03,  4.11s/it]
test ppl:  26%|██▌       | 61/236 [03:48<13:32,  4.64s/it]
test ppl:  26%|██▋       | 62/236 [03:52<13:01,  4.49s/it]
test ppl:  27%|██▋       | 63/236 [03:55<11:12,  3.89s/it]
test ppl:  27%|██▋       | 64/236 [03:57<09:30,  3.32s/it]
test ppl:  28%|██▊       | 65/236 [03:58<07:44,  2.72s/it]
test ppl:  28%|██▊       | 66/236 [04:01<07:57,  2.81s/it]
test ppl:  28%|██▊       | 67/236 [04:07<10:31,  3.74s/it]
test ppl:  29%|██▉       | 68/236 [04:13<12:16,  4.38s/it]
test ppl:  29%|██▉       | 69/236 [04:19<13:26,  4.83s/it]
test ppl:  30%|██▉       | 70/236 [04:20<10:25,  3.77s/it]
test ppl:  30%|███       | 71/236 [04:24<09:59,  3.64s/it]
test ppl:  31%|███       | 72/236 [04:27<10:05,  3.69s/it]
test ppl:  31%|███       | 73/236 [04:31<10:01,  3.69s/it]
test ppl:  31%|███▏      | 74/236 [04:33<08:12,  3.04s/it]
test ppl:  32%|███▏      | 75/236 [04:38<10:25,  3.88s/it]
test ppl:  32%|███▏      | 76/236 [04:42<10:03,  3.77s/it]
test ppl:  33%|███▎      | 77/236 [04:44<08:49,  3.33s/it]
test ppl:  33%|███▎      | 78/236 [04:46<07:19,  2.78s/it]
test ppl:  33%|███▎      | 79/236 [04:50<08:10,  3.12s/it]
test ppl:  34%|███▍      | 80/236 [04:52<07:07,  2.74s/it]
test ppl:  34%|███▍      | 81/236 [04:57<09:29,  3.68s/it]
test ppl:  35%|███▍      | 82/236 [05:03<11:03,  4.31s/it]
test ppl:  35%|███▌      | 83/236 [05:06<09:53,  3.88s/it]
test ppl:  36%|███▌      | 84/236 [05:08<08:43,  3.44s/it]
test ppl:  36%|███▌      | 85/236 [05:13<09:11,  3.65s/it]
test ppl:  36%|███▋      | 86/236 [05:15<07:50,  3.14s/it]
test ppl:  37%|███▋      | 87/236 [05:17<07:26,  3.00s/it]
test ppl:  37%|███▋      | 88/236 [05:23<09:31,  3.86s/it]
test ppl:  38%|███▊      | 89/236 [05:29<10:57,  4.47s/it]
test ppl:  38%|███▊      | 90/236 [05:35<11:54,  4.89s/it]
test ppl:  39%|███▊      | 91/236 [05:40<11:54,  4.93s/it]
test ppl:  39%|███▉      | 92/236 [05:43<10:18,  4.30s/it]
test ppl:  39%|███▉      | 93/236 [05:49<11:22,  4.77s/it]
test ppl:  40%|███▉      | 94/236 [05:54<12:05,  5.11s/it]
test ppl:  40%|████      | 95/236 [05:56<09:46,  4.16s/it]
test ppl:  41%|████      | 96/236 [05:59<08:50,  3.79s/it]
test ppl:  41%|████      | 97/236 [06:05<10:13,  4.42s/it]
test ppl:  42%|████▏     | 98/236 [06:11<11:10,  4.86s/it]
test ppl:  42%|████▏     | 99/236 [06:17<11:47,  5.17s/it]
test ppl:  42%|████▏     | 100/236 [06:18<09:06,  4.02s/it]
test ppl:  43%|████▎     | 101/236 [06:24<10:18,  4.58s/it]
test ppl:  43%|████▎     | 102/236 [06:28<09:57,  4.46s/it]
test ppl:  44%|████▎     | 103/236 [06:30<07:52,  3.55s/it]
test ppl:  44%|████▍     | 104/236 [06:34<08:17,  3.77s/it]
test ppl:  44%|████▍     | 105/236 [06:39<08:38,  3.96s/it]
test ppl:  45%|████▍     | 106/236 [06:44<09:31,  4.40s/it]
test ppl:  45%|████▌     | 107/236 [06:46<07:51,  3.66s/it]
test ppl:  46%|████▌     | 108/236 [06:52<09:07,  4.28s/it]
test ppl:  46%|████▌     | 109/236 [06:56<09:18,  4.40s/it]
test ppl:  47%|████▋     | 110/236 [06:58<07:27,  3.56s/it]
test ppl:  47%|████▋     | 111/236 [07:02<07:40,  3.68s/it]
test ppl:  47%|████▋     | 112/236 [07:05<07:26,  3.60s/it]
test ppl:  48%|████▊     | 113/236 [07:07<06:15,  3.06s/it]
test ppl:  48%|████▊     | 114/236 [07:10<06:24,  3.15s/it]
test ppl:  49%|████▊     | 115/236 [07:16<08:00,  3.97s/it]
test ppl:  49%|████▉     | 116/236 [07:22<09:05,  4.55s/it]
test ppl:  50%|████▉     | 117/236 [07:24<07:25,  3.74s/it]
test ppl:  50%|█████     | 118/236 [07:30<08:36,  4.38s/it]
test ppl:  50%|█████     | 119/236 [07:33<07:33,  3.88s/it]
test ppl:  51%|█████     | 120/236 [07:34<06:01,  3.11s/it]
test ppl:  51%|█████▏    | 121/236 [07:40<07:32,  3.94s/it]
test ppl:  52%|█████▏    | 122/236 [07:45<07:58,  4.20s/it]
test ppl:  52%|█████▏    | 123/236 [07:47<06:45,  3.59s/it]
test ppl:  53%|█████▎    | 124/236 [07:49<06:01,  3.23s/it]
test ppl:  53%|█████▎    | 125/236 [07:52<05:34,  3.01s/it]
test ppl:  53%|█████▎    | 126/236 [07:57<06:34,  3.59s/it]
test ppl:  54%|█████▍    | 127/236 [07:59<05:42,  3.14s/it]
test ppl:  54%|█████▍    | 128/236 [08:01<05:10,  2.88s/it]
test ppl:  55%|█████▍    | 129/236 [08:04<05:10,  2.90s/it]
test ppl:  55%|█████▌    | 130/236 [08:07<05:00,  2.83s/it]
test ppl:  56%|█████▌    | 131/236 [08:13<06:34,  3.75s/it]
test ppl:  56%|█████▌    | 132/236 [08:15<05:50,  3.37s/it]
test ppl:  56%|█████▋    | 133/236 [08:19<06:04,  3.54s/it]
test ppl:  57%|█████▋    | 134/236 [08:23<06:11,  3.64s/it]
test ppl:  57%|█████▋    | 135/236 [08:29<07:16,  4.32s/it]
test ppl:  58%|█████▊    | 136/236 [08:30<05:40,  3.40s/it]
test ppl:  58%|█████▊    | 137/236 [08:36<06:51,  4.15s/it]
test ppl:  58%|█████▊    | 138/236 [08:39<06:19,  3.87s/it]
test ppl:  59%|█████▉    | 139/236 [08:41<05:14,  3.25s/it]
test ppl:  59%|█████▉    | 140/236 [08:43<04:26,  2.77s/it]
test ppl:  60%|█████▉    | 141/236 [08:45<04:26,  2.81s/it]
test ppl:  60%|██████    | 142/236 [08:48<04:04,  2.60s/it]
test ppl:  61%|██████    | 143/236 [08:53<05:33,  3.59s/it]
test ppl:  61%|██████    | 144/236 [08:56<05:06,  3.33s/it]
test ppl:  61%|██████▏   | 145/236 [09:02<06:01,  3.98s/it]
test ppl:  62%|██████▏   | 146/236 [09:06<06:14,  4.16s/it]
test ppl:  62%|██████▏   | 147/236 [09:12<06:56,  4.68s/it]
test ppl:  63%|██████▎   | 148/236 [09:18<07:26,  5.08s/it]
test ppl:  63%|██████▎   | 149/236 [09:24<07:43,  5.33s/it]
test ppl:  64%|██████▎   | 150/236 [09:30<07:52,  5.50s/it]
test ppl:  64%|██████▍   | 151/236 [09:36<07:56,  5.61s/it]
test ppl:  64%|██████▍   | 152/236 [09:42<07:57,  5.69s/it]
test ppl:  65%|██████▍   | 153/236 [09:48<07:56,  5.74s/it]
test ppl:  65%|██████▌   | 154/236 [09:50<06:31,  4.78s/it]
test ppl:  66%|██████▌   | 155/236 [09:53<05:36,  4.15s/it]
test ppl:  66%|██████▌   | 156/236 [09:55<04:44,  3.56s/it]
test ppl:  67%|██████▋   | 157/236 [09:57<04:09,  3.15s/it]
test ppl:  67%|██████▋   | 158/236 [10:03<05:09,  3.97s/it]
test ppl:  67%|██████▋   | 159/236 [10:04<04:00,  3.12s/it]
test ppl:  68%|██████▊   | 160/236 [10:05<03:12,  2.53s/it]
test ppl:  68%|██████▊   | 161/236 [10:07<02:43,  2.18s/it]
test ppl:  69%|██████▊   | 162/236 [10:09<02:40,  2.17s/it]
test ppl:  69%|██████▉   | 163/236 [10:11<02:46,  2.28s/it]
test ppl:  69%|██████▉   | 164/236 [10:15<03:05,  2.57s/it]
test ppl:  70%|██████▉   | 165/236 [10:18<03:12,  2.71s/it]
test ppl:  70%|███████   | 166/236 [10:19<02:48,  2.41s/it]
test ppl:  71%|███████   | 167/236 [10:21<02:27,  2.13s/it]
test ppl:  71%|███████   | 168/236 [10:27<03:41,  3.26s/it]
test ppl:  72%|███████▏  | 169/236 [10:33<04:32,  4.06s/it]
test ppl:  72%|███████▏  | 170/236 [10:39<05:05,  4.62s/it]
test ppl:  72%|███████▏  | 171/236 [10:40<03:56,  3.64s/it]
test ppl:  73%|███████▎  | 172/236 [10:46<04:36,  4.32s/it]
test ppl:  73%|███████▎  | 173/236 [10:50<04:23,  4.19s/it]
test ppl:  74%|███████▎  | 174/236 [10:56<04:51,  4.71s/it]
test ppl:  74%|███████▍  | 175/236 [10:58<03:55,  3.87s/it]
test ppl:  75%|███████▍  | 176/236 [11:03<04:18,  4.30s/it]
test ppl:  75%|███████▌  | 177/236 [11:09<04:42,  4.78s/it]
test ppl:  75%|███████▌  | 178/236 [11:15<04:57,  5.13s/it]
test ppl:  76%|███████▌  | 179/236 [11:21<05:05,  5.36s/it]
test ppl:  76%|███████▋  | 180/236 [11:26<05:08,  5.52s/it]
test ppl:  77%|███████▋  | 181/236 [11:32<05:09,  5.62s/it]
test ppl:  77%|███████▋  | 182/236 [11:34<04:03,  4.51s/it]
test ppl:  78%|███████▊  | 183/236 [11:37<03:23,  3.85s/it]
test ppl:  78%|███████▊  | 184/236 [11:38<02:42,  3.13s/it]
test ppl:  78%|███████▊  | 185/236 [11:42<02:49,  3.33s/it]
test ppl:  79%|███████▉  | 186/236 [11:44<02:26,  2.93s/it]
test ppl:  79%|███████▉  | 187/236 [11:50<03:08,  3.85s/it]
test ppl:  80%|███████▉  | 188/236 [11:56<03:34,  4.47s/it]
test ppl:  80%|████████  | 189/236 [12:02<03:50,  4.90s/it]
test ppl:  81%|████████  | 190/236 [12:05<03:29,  4.54s/it]
test ppl:  81%|████████  | 191/236 [12:09<03:14,  4.32s/it]
test ppl:  81%|████████▏ | 192/236 [12:12<02:47,  3.81s/it]
test ppl:  82%|████████▏ | 193/236 [12:18<03:11,  4.44s/it]
test ppl:  82%|████████▏ | 194/236 [12:20<02:43,  3.90s/it]
test ppl:  83%|████████▎ | 195/236 [12:23<02:20,  3.42s/it]
test ppl:  83%|████████▎ | 196/236 [12:25<01:59,  3.00s/it]
test ppl:  83%|████████▎ | 197/236 [12:27<01:46,  2.73s/it]
test ppl:  84%|████████▍ | 198/236 [12:29<01:35,  2.51s/it]
test ppl:  84%|████████▍ | 199/236 [12:31<01:34,  2.56s/it]
test ppl:  85%|████████▍ | 200/236 [12:37<02:08,  3.56s/it]
test ppl:  85%|████████▌ | 201/236 [12:40<01:54,  3.26s/it]
test ppl:  86%|████████▌ | 202/236 [12:44<02:04,  3.67s/it]
test ppl:  86%|████████▌ | 203/236 [12:50<02:23,  4.33s/it]
test ppl:  86%|████████▋ | 204/236 [12:52<01:52,  3.53s/it]
test ppl:  87%|████████▋ | 205/236 [12:58<02:11,  4.24s/it]
test ppl:  87%|████████▋ | 206/236 [13:01<01:58,  3.96s/it]
test ppl:  88%|████████▊ | 207/236 [13:07<02:11,  4.54s/it]
test ppl:  88%|████████▊ | 208/236 [13:10<01:55,  4.14s/it]
test ppl:  89%|████████▊ | 209/236 [13:16<02:06,  4.68s/it]
test ppl:  89%|████████▉ | 210/236 [13:19<01:43,  3.98s/it]
test ppl:  89%|████████▉ | 211/236 [13:23<01:39,  3.97s/it]
test ppl:  90%|████████▉ | 212/236 [13:28<01:48,  4.54s/it]
test ppl:  90%|█████████ | 213/236 [13:34<01:53,  4.93s/it]
test ppl:  91%|█████████ | 214/236 [13:36<01:26,  3.94s/it]
test ppl:  91%|█████████ | 215/236 [13:42<01:35,  4.53s/it]
test ppl:  92%|█████████▏| 216/236 [13:43<01:13,  3.67s/it]
test ppl:  92%|█████████▏| 217/236 [13:49<01:22,  4.37s/it]
test ppl:  92%|█████████▏| 218/236 [13:52<01:08,  3.78s/it]
test ppl:  93%|█████████▎| 219/236 [13:58<01:15,  4.43s/it]
test ppl:  93%|█████████▎| 220/236 [14:04<01:17,  4.87s/it]
test ppl:  94%|█████████▎| 221/236 [14:07<01:05,  4.34s/it]
test ppl:  94%|█████████▍| 222/236 [14:13<01:07,  4.81s/it]
test ppl:  94%|█████████▍| 223/236 [14:19<01:06,  5.15s/it]
test ppl:  95%|█████████▍| 224/236 [14:20<00:49,  4.14s/it]
test ppl:  95%|█████████▌| 225/236 [14:26<00:51,  4.65s/it]
test ppl:  96%|█████████▌| 226/236 [14:29<00:40,  4.00s/it]
test ppl:  96%|█████████▌| 227/236 [14:32<00:32,  3.66s/it]
test ppl:  97%|█████████▋| 228/236 [14:34<00:25,  3.17s/it]
test ppl:  97%|█████████▋| 229/236 [14:40<00:27,  3.98s/it]
test ppl:  97%|█████████▋| 230/236 [14:43<00:22,  3.83s/it]
test ppl:  98%|█████████▊| 231/236 [14:46<00:18,  3.69s/it]
test ppl:  98%|█████████▊| 232/236 [14:48<00:12,  3.11s/it]
test ppl:  99%|█████████▊| 233/236 [14:50<00:08,  2.82s/it]
test ppl:  99%|█████████▉| 234/236 [14:52<00:04,  2.34s/it]
test ppl: 100%|█████████▉| 235/236 [14:57<00:03,  3.41s/it]
test ppl: 100%|██████████| 236/236 [14:58<00:00,  2.58s/it]
test ppl: 100%|██████████| 236/236 [14:58<00:00,  3.81s/it]
10/13/2024 00:57:37 - INFO - __main__ -    em: 0.2088
10/13/2024 00:57:37 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/16_0.4_80_eval_results.json
16 0.4 80:  em: 0.2088

--------------------------------------------------------------------------------
Running experiment with knn_temp=80, lmbda=0.4, k=32
2024-10-13 00:57:44.718035: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-13 00:57:44.737508: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-13 00:57:44.759193: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-13 00:57:44.765822: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-13 00:57:44.781661: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-13 00:57:45.775127: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/13/2024 00:57:47 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.4, knn_temp=80, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/13/2024 00:57:47 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:42:33,  2.19it/s]
Adding feature api:   4%|▍         | 7345/187062 [00:00<00:10, 17512.12it/s]
Adding feature api:   8%|▊         | 15794/187062 [00:00<00:04, 34528.78it/s]
Adding feature api:  13%|█▎        | 24298/187062 [00:00<00:03, 47978.79it/s]
Adding feature api:  18%|█▊        | 32796/187062 [00:00<00:02, 58174.10it/s]
Adding feature api:  22%|██▏       | 41300/187062 [00:00<00:02, 65761.46it/s]
Adding feature api:  27%|██▋       | 49879/187062 [00:01<00:01, 71517.56it/s]
Adding feature api:  31%|███▏      | 58492/187062 [00:01<00:01, 75771.35it/s]
Adding feature api:  36%|███▌      | 67022/187062 [00:01<00:01, 78568.23it/s]
Adding feature api:  40%|████      | 75569/187062 [00:01<00:01, 80604.97it/s]
Adding feature api:  45%|████▍     | 84097/187062 [00:01<00:01, 81991.96it/s]
Adding feature api:  50%|████▉     | 92610/187062 [00:01<00:01, 82925.29it/s]
Adding feature api:  54%|█████▍    | 101081/187062 [00:01<00:01, 83025.46it/s]
Adding feature api:  59%|█████▊    | 109658/187062 [00:01<00:00, 83839.92it/s]
Adding feature api:  63%|██████▎   | 118214/187062 [00:01<00:00, 84350.28it/s]
Adding feature api:  68%|██████▊   | 126711/187062 [00:01<00:00, 84244.42it/s]
Adding feature api:  72%|███████▏  | 135218/187062 [00:02<00:00, 84489.15it/s]
Adding feature api:  77%|███████▋  | 143758/187062 [00:02<00:00, 84757.92it/s]
Adding feature api:  81%|████████▏ | 152260/187062 [00:02<00:00, 84832.92it/s]
Adding feature api:  86%|████████▌ | 160766/187062 [00:02<00:00, 84898.29it/s]
Adding feature api:  90%|█████████ | 169288/187062 [00:02<00:00, 84992.21it/s]
Adding feature api:  95%|█████████▌| 177795/187062 [00:02<00:00, 84529.10it/s]
Adding feature api: 100%|█████████▉| 186254/187062 [00:02<00:00, 54197.19it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 65076.32it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:38:51,  2.20it/s]
Adding feature datatype:   4%|▍         | 7182/187062 [00:00<00:10, 17157.19it/s]
Adding feature datatype:   8%|▊         | 15471/187062 [00:00<00:05, 33881.66it/s]
Adding feature datatype:  13%|█▎        | 23766/187062 [00:00<00:03, 46962.09it/s]
Adding feature datatype:  17%|█▋        | 32022/187062 [00:00<00:02, 56778.75it/s]
Adding feature datatype:  22%|██▏       | 40296/187062 [00:00<00:02, 64115.54it/s]
Adding feature datatype:  26%|██▌       | 48650/187062 [00:01<00:01, 69700.32it/s]
Adding feature datatype:  30%|███       | 56942/187062 [00:01<00:01, 73549.26it/s]
Adding feature datatype:  35%|███▍      | 65281/187062 [00:01<00:01, 76438.13it/s]
Adding feature datatype:  39%|███▉      | 73603/187062 [00:01<00:01, 78440.29it/s]
Adding feature datatype:  44%|████▍     | 81878/187062 [00:01<00:01, 79718.81it/s]
Adding feature datatype:  48%|████▊     | 90146/187062 [00:01<00:01, 80599.51it/s]
Adding feature datatype:  53%|█████▎    | 98445/187062 [00:01<00:01, 81312.11it/s]
Adding feature datatype:  57%|█████▋    | 106774/187062 [00:01<00:00, 81901.29it/s]
Adding feature datatype:  62%|██████▏   | 115115/187062 [00:01<00:00, 82350.55it/s]
Adding feature datatype:  66%|██████▌   | 123436/187062 [00:01<00:00, 82606.95it/s]
Adding feature datatype:  70%|███████   | 131803/187062 [00:02<00:00, 82924.24it/s]
Adding feature datatype:  75%|███████▍  | 140164/187062 [00:02<00:00, 83129.28it/s]
Adding feature datatype:  79%|███████▉  | 148534/187062 [00:02<00:00, 83298.62it/s]
Adding feature datatype:  84%|████████▍ | 156879/187062 [00:02<00:00, 83190.00it/s]
Adding feature datatype:  88%|████████▊ | 165212/187062 [00:02<00:00, 83229.64it/s]
Adding feature datatype:  93%|█████████▎| 173564/187062 [00:02<00:00, 83315.54it/s]
Adding feature datatype:  97%|█████████▋| 181901/187062 [00:02<00:00, 63893.67it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 64007.61it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:44:48,  2.19it/s]
Adding feature literal:   4%|▍         | 7103/187062 [00:00<00:10, 16914.66it/s]
Adding feature literal:   8%|▊         | 15268/187062 [00:00<00:05, 33346.95it/s]
Adding feature literal:  13%|█▎        | 23530/187062 [00:00<00:03, 46459.09it/s]
Adding feature literal:  17%|█▋        | 31819/187062 [00:00<00:02, 56492.10it/s]
Adding feature literal:  21%|██▏       | 40123/187062 [00:00<00:02, 63987.41it/s]
Adding feature literal:  26%|██▌       | 48467/187062 [00:01<00:01, 69577.77it/s]
Adding feature literal:  30%|███       | 56824/187062 [00:01<00:01, 73650.21it/s]
Adding feature literal:  35%|███▍      | 65086/187062 [00:01<00:01, 76281.46it/s]
Adding feature literal:  39%|███▉      | 73394/187062 [00:01<00:01, 78290.08it/s]
Adding feature literal:  44%|████▎     | 81572/187062 [00:01<00:01, 79083.12it/s]
Adding feature literal:  48%|████▊     | 89912/187062 [00:01<00:01, 80365.34it/s]
Adding feature literal:  52%|█████▏    | 98195/187062 [00:01<00:01, 81098.07it/s]
Adding feature literal:  57%|█████▋    | 106532/187062 [00:01<00:00, 81774.16it/s]
Adding feature literal:  61%|██████▏   | 114897/187062 [00:01<00:00, 82333.14it/s]
Adding feature literal:  66%|██████▌   | 123243/187062 [00:01<00:00, 82667.19it/s]
Adding feature literal:  70%|███████   | 131559/187062 [00:02<00:00, 82811.68it/s]
Adding feature literal:  75%|███████▍  | 139880/187062 [00:02<00:00, 82929.64it/s]
Adding feature literal:  79%|███████▉  | 148194/187062 [00:02<00:00, 82957.20it/s]
Adding feature literal:  84%|████████▎ | 156505/187062 [00:02<00:00, 82957.44it/s]
Adding feature literal:  88%|████████▊ | 164824/187062 [00:02<00:00, 83024.90it/s]
Adding feature literal:  93%|█████████▎| 173134/187062 [00:02<00:00, 83006.03it/s]
Adding feature literal:  97%|█████████▋| 181440/187062 [00:02<00:00, 65903.24it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63838.20it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:33:19,  2.21it/s]
Adding feature operator:   4%|▍         | 7238/187062 [00:00<00:10, 17342.42it/s]
Adding feature operator:   8%|▊         | 15486/187062 [00:00<00:05, 33952.70it/s]
Adding feature operator:  13%|█▎        | 23786/187062 [00:00<00:03, 47048.41it/s]
Adding feature operator:  17%|█▋        | 32085/187062 [00:00<00:02, 56970.80it/s]
Adding feature operator:  22%|██▏       | 40362/187062 [00:00<00:02, 64267.57it/s]
Adding feature operator:  26%|██▌       | 48687/187062 [00:01<00:01, 69729.34it/s]
Adding feature operator:  30%|███       | 57044/187062 [00:01<00:01, 73760.08it/s]
Adding feature operator:  35%|███▍      | 65135/187062 [00:01<00:01, 75859.61it/s]
Adding feature operator:  39%|███▉      | 73452/187062 [00:01<00:01, 78020.41it/s]
Adding feature operator:  44%|████▎     | 81826/187062 [00:01<00:01, 79718.12it/s]
Adding feature operator:  48%|████▊     | 90192/187062 [00:01<00:01, 80889.37it/s]
Adding feature operator:  53%|█████▎    | 98560/187062 [00:01<00:01, 81721.17it/s]
Adding feature operator:  57%|█████▋    | 106978/187062 [00:01<00:00, 82453.13it/s]
Adding feature operator:  62%|██████▏   | 115319/187062 [00:01<00:00, 82737.14it/s]
Adding feature operator:  66%|██████▌   | 123653/187062 [00:01<00:00, 82836.08it/s]
Adding feature operator:  71%|███████   | 132068/187062 [00:02<00:00, 83226.67it/s]
Adding feature operator:  75%|███████▌  | 140421/187062 [00:02<00:00, 83268.56it/s]
Adding feature operator:  80%|███████▉  | 148769/187062 [00:02<00:00, 83287.96it/s]
Adding feature operator:  84%|████████▍ | 157199/187062 [00:02<00:00, 83589.17it/s]
Adding feature operator:  89%|████████▊ | 165616/187062 [00:02<00:00, 83761.12it/s]
Adding feature operator:  93%|█████████▎| 174000/187062 [00:02<00:00, 82873.87it/s]
Adding feature operator:  97%|█████████▋| 182295/187062 [00:02<00:00, 62304.33it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 64110.73it/s]
[2024-10-13 00:58:30,555] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/13/2024 00:58:31 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/13/2024 00:58:32 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 45/6548 [00:00<00:15, 427.72 examples/s]
Map:   2%|▏         | 102/6548 [00:00<00:27, 234.48 examples/s]
Map:   2%|▏         | 132/6548 [00:00<00:25, 251.57 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:21, 299.55 examples/s]
Map:   3%|▎         | 220/6548 [00:00<00:19, 332.30 examples/s]
Map:   4%|▍         | 268/6548 [00:00<00:19, 319.42 examples/s]
Map:   5%|▍         | 304/6548 [00:00<00:19, 323.60 examples/s]
Map:   5%|▌         | 348/6548 [00:01<00:20, 308.35 examples/s]
Map:   6%|▌         | 388/6548 [00:01<00:18, 326.83 examples/s]
Map:   7%|▋         | 433/6548 [00:01<00:17, 352.36 examples/s]
Map:   7%|▋         | 478/6548 [00:01<00:18, 330.86 examples/s]
Map:   8%|▊         | 521/6548 [00:01<00:17, 350.69 examples/s]
Map:   9%|▊         | 568/6548 [00:01<00:15, 380.51 examples/s]
Map:   9%|▉         | 622/6548 [00:01<00:16, 351.65 examples/s]
Map:  10%|█         | 675/6548 [00:02<00:16, 350.03 examples/s]
Map:  11%|█         | 716/6548 [00:02<00:16, 362.77 examples/s]
Map:  12%|█▏        | 764/6548 [00:02<00:14, 387.98 examples/s]
Map:  12%|█▏        | 814/6548 [00:02<00:13, 412.96 examples/s]
Map:  13%|█▎        | 874/6548 [00:02<00:14, 402.23 examples/s]
Map:  14%|█▍        | 920/6548 [00:02<00:15, 357.24 examples/s]
Map:  15%|█▍        | 969/6548 [00:02<00:14, 383.89 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:24, 222.06 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:22, 248.50 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:19, 283.32 examples/s]
Map:  18%|█▊        | 1146/6548 [00:03<00:16, 321.69 examples/s]
Map:  18%|█▊        | 1208/6548 [00:03<00:15, 339.13 examples/s]
Map:  19%|█▉        | 1267/6548 [00:03<00:14, 352.50 examples/s]
Map:  20%|█▉        | 1306/6548 [00:03<00:14, 351.42 examples/s]
Map:  21%|██        | 1355/6548 [00:04<00:15, 334.33 examples/s]
Map:  21%|██▏       | 1401/6548 [00:04<00:15, 322.73 examples/s]
Map:  22%|██▏       | 1436/6548 [00:04<00:17, 298.23 examples/s]
Map:  23%|██▎       | 1480/6548 [00:04<00:16, 302.10 examples/s]
Map:  23%|██▎       | 1525/6548 [00:04<00:17, 295.29 examples/s]
Map:  24%|██▍       | 1560/6548 [00:04<00:18, 269.64 examples/s]
Map:  24%|██▍       | 1595/6548 [00:04<00:17, 285.25 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:19, 255.57 examples/s]
Map:  26%|██▌       | 1685/6548 [00:05<00:19, 251.53 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:17, 282.04 examples/s]
Map:  27%|██▋       | 1770/6548 [00:05<00:15, 313.65 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 326.32 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 338.58 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:14, 329.88 examples/s]
Map:  30%|██▉       | 1947/6548 [00:06<00:13, 345.37 examples/s]
Map:  30%|███       | 1990/6548 [00:06<00:12, 362.89 examples/s]
Map:  31%|███       | 2028/6548 [00:06<00:20, 217.73 examples/s]
Map:  31%|███▏      | 2062/6548 [00:06<00:18, 239.29 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 262.41 examples/s]
Map:  33%|███▎      | 2141/6548 [00:06<00:17, 256.99 examples/s]
Map:  33%|███▎      | 2180/6548 [00:07<00:15, 278.75 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 283.07 examples/s]
Map:  34%|███▍      | 2251/6548 [00:07<00:16, 264.53 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:15, 273.23 examples/s]
Map:  36%|███▌      | 2331/6548 [00:07<00:13, 310.66 examples/s]
Map:  36%|███▋      | 2381/6548 [00:07<00:13, 317.16 examples/s]
Map:  37%|███▋      | 2420/6548 [00:07<00:12, 334.70 examples/s]
Map:  38%|███▊      | 2459/6548 [00:07<00:12, 321.13 examples/s]
Map:  38%|███▊      | 2494/6548 [00:08<00:12, 326.65 examples/s]
Map:  39%|███▉      | 2544/6548 [00:08<00:12, 325.53 examples/s]
Map:  40%|███▉      | 2594/6548 [00:08<00:10, 364.77 examples/s]
Map:  40%|████      | 2638/6548 [00:08<00:10, 381.39 examples/s]
Map:  41%|████      | 2694/6548 [00:08<00:11, 345.02 examples/s]
Map:  42%|████▏     | 2745/6548 [00:08<00:11, 337.76 examples/s]
Map:  43%|████▎     | 2795/6548 [00:08<00:11, 335.52 examples/s]
Map:  43%|████▎     | 2844/6548 [00:09<00:12, 286.00 examples/s]
Map:  44%|████▍     | 2880/6548 [00:09<00:12, 296.60 examples/s]
Map:  45%|████▍     | 2925/6548 [00:09<00:12, 286.67 examples/s]
Map:  45%|████▌     | 2967/6548 [00:09<00:11, 312.99 examples/s]
Map:  46%|████▌     | 3012/6548 [00:10<00:19, 178.75 examples/s]
Map:  46%|████▋     | 3044/6548 [00:10<00:17, 198.40 examples/s]
Map:  47%|████▋     | 3076/6548 [00:10<00:15, 218.70 examples/s]
Map:  48%|████▊     | 3118/6548 [00:10<00:13, 257.23 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:12, 266.97 examples/s]
Map:  49%|████▉     | 3216/6548 [00:10<00:13, 252.54 examples/s]
Map:  50%|████▉     | 3248/6548 [00:10<00:12, 265.18 examples/s]
Map:  50%|█████     | 3281/6548 [00:10<00:12, 271.85 examples/s]
Map:  51%|█████     | 3322/6548 [00:11<00:10, 301.40 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:11<00:10, 300.44 examples/s]
Map:  52%|█████▏    | 3404/6548 [00:11<00:11, 271.47 examples/s]
Map:  53%|█████▎    | 3445/6548 [00:11<00:10, 296.56 examples/s]
Map:  53%|█████▎    | 3486/6548 [00:11<00:11, 276.67 examples/s]
Map:  54%|█████▍    | 3533/6548 [00:11<00:09, 317.67 examples/s]
Map:  55%|█████▍    | 3577/6548 [00:11<00:08, 343.13 examples/s]
Map:  55%|█████▌    | 3622/6548 [00:11<00:07, 367.33 examples/s]
Map:  56%|█████▌    | 3683/6548 [00:12<00:07, 376.65 examples/s]
Map:  57%|█████▋    | 3727/6548 [00:12<00:07, 391.70 examples/s]
Map:  58%|█████▊    | 3777/6548 [00:12<00:07, 368.03 examples/s]
Map:  58%|█████▊    | 3817/6548 [00:12<00:07, 373.01 examples/s]
Map:  59%|█████▉    | 3859/6548 [00:12<00:08, 326.30 examples/s]
Map:  60%|█████▉    | 3898/6548 [00:12<00:07, 335.85 examples/s]
Map:  60%|██████    | 3947/6548 [00:12<00:07, 328.88 examples/s]
Map:  61%|██████    | 3994/6548 [00:12<00:07, 362.01 examples/s]
Map:  62%|██████▏   | 4055/6548 [00:13<00:09, 266.32 examples/s]
Map:  63%|██████▎   | 4096/6548 [00:13<00:08, 291.36 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 307.04 examples/s]
Map:  64%|██████▍   | 4194/6548 [00:13<00:07, 314.69 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:13<00:07, 322.57 examples/s]
Map:  65%|██████▌   | 4282/6548 [00:13<00:06, 348.70 examples/s]
Map:  66%|██████▌   | 4325/6548 [00:14<00:06, 363.18 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:14<00:06, 353.53 examples/s]
Map:  67%|██████▋   | 4406/6548 [00:14<00:05, 358.73 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:05, 383.41 examples/s]
Map:  69%|██████▊   | 4497/6548 [00:14<00:06, 335.84 examples/s]
Map:  69%|██████▉   | 4535/6548 [00:14<00:06, 304.89 examples/s]
Map:  70%|██████▉   | 4570/6548 [00:14<00:06, 313.81 examples/s]
Map:  70%|███████   | 4610/6548 [00:14<00:06, 322.71 examples/s]
Map:  71%|███████   | 4659/6548 [00:15<00:05, 364.32 examples/s]
Map:  72%|███████▏  | 4717/6548 [00:15<00:04, 368.65 examples/s]
Map:  73%|███████▎  | 4755/6548 [00:15<00:04, 370.25 examples/s]
Map:  73%|███████▎  | 4811/6548 [00:15<00:04, 418.83 examples/s]
Map:  74%|███████▍  | 4860/6548 [00:15<00:04, 375.72 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 382.84 examples/s]
Map:  76%|███████▌  | 4959/6548 [00:15<00:03, 423.24 examples/s]
Map:  77%|███████▋  | 5013/6548 [00:16<00:06, 252.01 examples/s]
Map:  77%|███████▋  | 5059/6548 [00:16<00:05, 278.34 examples/s]
Map:  78%|███████▊  | 5106/6548 [00:16<00:05, 286.96 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 293.63 examples/s]
Map:  79%|███████▉  | 5204/6548 [00:16<00:04, 294.19 examples/s]
Map:  80%|████████  | 5240/6548 [00:16<00:04, 304.48 examples/s]
Map:  81%|████████  | 5286/6548 [00:16<00:03, 327.94 examples/s]
Map:  81%|████████▏ | 5335/6548 [00:17<00:03, 319.09 examples/s]
Map:  82%|████████▏ | 5388/6548 [00:17<00:03, 319.21 examples/s]
Map:  83%|████████▎ | 5422/6548 [00:17<00:04, 279.39 examples/s]
Map:  83%|████████▎ | 5462/6548 [00:17<00:03, 304.62 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 323.35 examples/s]
Map:  85%|████████▍ | 5547/6548 [00:17<00:02, 339.56 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:17<00:03, 306.55 examples/s]
Map:  86%|████████▌ | 5639/6548 [00:18<00:02, 359.77 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 322.57 examples/s]
Map:  87%|████████▋ | 5720/6548 [00:18<00:02, 337.44 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 354.20 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 357.00 examples/s]
Map:  89%|████████▉ | 5847/6548 [00:18<00:01, 361.19 examples/s]
Map:  90%|█████████ | 5901/6548 [00:18<00:01, 353.45 examples/s]
Map:  91%|█████████ | 5938/6548 [00:18<00:01, 356.06 examples/s]
Map:  91%|█████████▏| 5987/6548 [00:19<00:01, 336.10 examples/s]
Map:  92%|█████████▏| 6026/6548 [00:19<00:02, 230.81 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 265.11 examples/s]
Map:  93%|█████████▎| 6120/6548 [00:19<00:01, 256.55 examples/s]
Map:  94%|█████████▍| 6154/6548 [00:19<00:01, 271.70 examples/s]
Map:  95%|█████████▍| 6190/6548 [00:19<00:01, 285.16 examples/s]
Map:  95%|█████████▌| 6234/6548 [00:20<00:00, 320.49 examples/s]
Map:  96%|█████████▌| 6270/6548 [00:20<00:00, 327.58 examples/s]
Map:  96%|█████████▋| 6310/6548 [00:20<00:00, 335.31 examples/s]
Map:  97%|█████████▋| 6348/6548 [00:20<00:00, 346.98 examples/s]
Map:  98%|█████████▊| 6389/6548 [00:20<00:00, 363.33 examples/s]
Map:  98%|█████████▊| 6430/6548 [00:20<00:00, 372.22 examples/s]
Map:  99%|█████████▉| 6478/6548 [00:20<00:00, 401.04 examples/s]
Map: 100%|█████████▉| 6531/6548 [00:20<00:00, 379.49 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 312.48 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▎         | 32/903 [00:00<00:03, 283.86 examples/s]
Map:   7%|▋         | 63/903 [00:00<00:02, 297.88 examples/s]
Map:  11%|█         | 98/903 [00:00<00:02, 290.82 examples/s]
Map:  15%|█▌        | 139/903 [00:00<00:02, 321.08 examples/s]
Map:  21%|██        | 187/903 [00:00<00:01, 374.00 examples/s]
Map:  25%|██▌       | 230/903 [00:00<00:01, 376.26 examples/s]
Map:  30%|███       | 271/903 [00:00<00:01, 383.42 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 381.90 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 330.11 examples/s]
Map:  45%|████▌     | 409/903 [00:01<00:01, 306.08 examples/s]
Map:  50%|█████     | 455/903 [00:01<00:01, 304.31 examples/s]
Map:  54%|█████▍    | 488/903 [00:01<00:01, 303.47 examples/s]
Map:  59%|█████▉    | 537/903 [00:01<00:01, 341.81 examples/s]
Map:  64%|██████▎   | 575/903 [00:01<00:00, 347.08 examples/s]
Map:  68%|██████▊   | 618/903 [00:01<00:00, 365.90 examples/s]
Map:  73%|███████▎  | 658/903 [00:01<00:00, 373.18 examples/s]
Map:  79%|███████▉  | 716/903 [00:02<00:00, 369.01 examples/s]
Map:  85%|████████▍ | 766/903 [00:02<00:00, 393.60 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 382.71 examples/s]
Map:  96%|█████████▌| 865/903 [00:02<00:00, 382.69 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 319.56 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 35/1882 [00:00<00:06, 271.55 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 347.41 examples/s]
Map:   7%|▋         | 124/1882 [00:00<00:05, 313.34 examples/s]
Map:   9%|▉         | 168/1882 [00:00<00:04, 353.69 examples/s]
Map:  12%|█▏        | 228/1882 [00:00<00:04, 354.94 examples/s]
Map:  14%|█▍        | 270/1882 [00:00<00:04, 371.57 examples/s]
Map:  16%|█▋        | 310/1882 [00:00<00:04, 365.75 examples/s]
Map:  19%|█▊        | 350/1882 [00:00<00:04, 370.95 examples/s]
Map:  21%|██        | 393/1882 [00:01<00:04, 325.51 examples/s]
Map:  23%|██▎       | 439/1882 [00:01<00:04, 316.76 examples/s]
Map:  26%|██▋       | 495/1882 [00:01<00:04, 326.43 examples/s]
Map:  29%|██▊       | 538/1882 [00:01<00:04, 300.11 examples/s]
Map:  31%|███       | 580/1882 [00:01<00:03, 325.99 examples/s]
Map:  33%|███▎      | 629/1882 [00:01<00:03, 363.56 examples/s]
Map:  36%|███▌      | 678/1882 [00:01<00:03, 378.15 examples/s]
Map:  39%|███▉      | 733/1882 [00:02<00:03, 372.43 examples/s]
Map:  41%|████      | 773/1882 [00:02<00:03, 359.22 examples/s]
Map:  44%|████▍     | 826/1882 [00:02<00:03, 349.43 examples/s]
Map:  46%|████▌     | 863/1882 [00:02<00:02, 350.74 examples/s]
Map:  48%|████▊     | 904/1882 [00:02<00:02, 360.84 examples/s]
Map:  50%|█████     | 947/1882 [00:02<00:02, 375.22 examples/s]
Map:  53%|█████▎    | 990/1882 [00:02<00:02, 385.74 examples/s]
Map:  55%|█████▌    | 1040/1882 [00:03<00:03, 237.81 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:03, 252.81 examples/s]
Map:  59%|█████▉    | 1112/1882 [00:03<00:02, 274.28 examples/s]
Map:  61%|██████▏   | 1155/1882 [00:03<00:02, 273.71 examples/s]
Map:  63%|██████▎   | 1192/1882 [00:03<00:02, 262.79 examples/s]
Map:  66%|██████▌   | 1235/1882 [00:03<00:02, 296.81 examples/s]
Map:  68%|██████▊   | 1288/1882 [00:03<00:01, 314.05 examples/s]
Map:  70%|███████   | 1322/1882 [00:04<00:01, 318.20 examples/s]
Map:  72%|███████▏  | 1360/1882 [00:04<00:01, 323.88 examples/s]
Map:  75%|███████▍  | 1410/1882 [00:04<00:01, 323.26 examples/s]
Map:  77%|███████▋  | 1452/1882 [00:04<00:01, 278.33 examples/s]
Map:  79%|███████▉  | 1490/1882 [00:04<00:01, 268.63 examples/s]
Map:  81%|████████  | 1525/1882 [00:04<00:01, 257.51 examples/s]
Map:  83%|████████▎ | 1558/1882 [00:04<00:01, 272.46 examples/s]
Map:  85%|████████▌ | 1608/1882 [00:05<00:00, 323.24 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 330.32 examples/s]
Map:  90%|█████████ | 1698/1882 [00:05<00:00, 332.87 examples/s]
Map:  92%|█████████▏| 1734/1882 [00:05<00:00, 290.82 examples/s]
Map:  94%|█████████▍| 1765/1882 [00:05<00:00, 285.10 examples/s]
Map:  96%|█████████▌| 1799/1882 [00:05<00:00, 291.66 examples/s]
Map:  98%|█████████▊| 1844/1882 [00:05<00:00, 327.25 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 227.71 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 308.36 examples/s]
10/13/2024 00:59:33 - INFO - __main__ -     ***** Testing *****
10/13/2024 00:59:33 - INFO - __main__ -     Batch size = 8
10/13/2024 00:59:33 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/13/2024 00:59:34 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/13/2024 00:59:34 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/13/2024 00:59:35 - INFO - knnlm -   Reading datastore took 0.9667932987213135 s
10/13/2024 00:59:36 - INFO - knnlm -   Moving index to GPU took 0.9184987545013428 s
10/13/2024 00:59:36 - INFO - __main__ -   ******************************break-into
10/13/2024 00:59:36 - INFO - __main__ -     ***** Running acc evaluation *****
10/13/2024 00:59:36 - INFO - __main__ -     Num examples = 236
10/13/2024 00:59:36 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<33:47,  8.63s/it]
test ppl:   1%|          | 2/236 [00:10<19:03,  4.89s/it]
test ppl:   1%|▏         | 3/236 [00:12<13:30,  3.48s/it]
test ppl:   2%|▏         | 4/236 [00:19<18:50,  4.87s/it]
test ppl:   2%|▏         | 5/236 [00:26<21:44,  5.65s/it]
test ppl:   3%|▎         | 6/236 [00:33<23:27,  6.12s/it]
test ppl:   3%|▎         | 7/236 [00:36<18:32,  4.86s/it]
test ppl:   3%|▎         | 8/236 [00:41<18:47,  4.95s/it]
test ppl:   4%|▍         | 9/236 [00:43<15:50,  4.19s/it]
test ppl:   4%|▍         | 10/236 [00:50<19:06,  5.07s/it]
test ppl:   5%|▍         | 11/236 [00:53<16:24,  4.38s/it]
test ppl:   5%|▌         | 12/236 [00:58<16:43,  4.48s/it]
test ppl:   6%|▌         | 13/236 [01:04<18:12,  4.90s/it]
test ppl:   6%|▌         | 14/236 [01:06<15:15,  4.12s/it]
test ppl:   6%|▋         | 15/236 [01:07<12:09,  3.30s/it]
test ppl:   7%|▋         | 16/236 [01:09<10:30,  2.87s/it]
test ppl:   7%|▋         | 17/236 [01:15<13:45,  3.77s/it]
test ppl:   8%|▊         | 18/236 [01:17<11:25,  3.15s/it]
test ppl:   8%|▊         | 19/236 [01:21<12:47,  3.54s/it]
test ppl:   8%|▊         | 20/236 [01:23<10:49,  3.01s/it]
test ppl:   9%|▉         | 21/236 [01:29<13:51,  3.87s/it]
test ppl:   9%|▉         | 22/236 [01:35<15:57,  4.47s/it]
test ppl:  10%|▉         | 23/236 [01:37<13:48,  3.89s/it]
test ppl:  10%|█         | 24/236 [01:40<12:06,  3.43s/it]
test ppl:  11%|█         | 25/236 [01:46<14:40,  4.17s/it]
test ppl:  11%|█         | 26/236 [01:51<16:26,  4.70s/it]
test ppl:  11%|█▏        | 27/236 [01:55<15:03,  4.32s/it]
test ppl:  12%|█▏        | 28/236 [01:56<11:45,  3.39s/it]
test ppl:  12%|█▏        | 29/236 [01:58<10:35,  3.07s/it]
test ppl:  13%|█▎        | 30/236 [02:00<08:56,  2.61s/it]
test ppl:  13%|█▎        | 31/236 [02:02<08:16,  2.42s/it]
test ppl:  14%|█▎        | 32/236 [02:05<08:43,  2.57s/it]
test ppl:  14%|█▍        | 33/236 [02:07<08:34,  2.53s/it]
test ppl:  14%|█▍        | 34/236 [02:11<10:00,  2.97s/it]
test ppl:  15%|█▍        | 35/236 [02:14<09:30,  2.84s/it]
test ppl:  15%|█▌        | 36/236 [02:20<12:29,  3.75s/it]
test ppl:  16%|█▌        | 37/236 [02:27<15:32,  4.69s/it]
test ppl:  16%|█▌        | 38/236 [02:29<13:15,  4.02s/it]
test ppl:  17%|█▋        | 39/236 [02:31<10:59,  3.35s/it]
test ppl:  17%|█▋        | 40/236 [02:34<10:48,  3.31s/it]
test ppl:  17%|█▋        | 41/236 [02:36<09:41,  2.98s/it]
test ppl:  18%|█▊        | 42/236 [02:43<13:34,  4.20s/it]
test ppl:  18%|█▊        | 43/236 [02:50<16:11,  5.04s/it]
test ppl:  19%|█▊        | 44/236 [02:53<13:57,  4.36s/it]
test ppl:  19%|█▉        | 45/236 [02:56<12:36,  3.96s/it]
test ppl:  19%|█▉        | 46/236 [03:03<15:28,  4.89s/it]
test ppl:  20%|█▉        | 47/236 [03:05<12:28,  3.96s/it]
test ppl:  20%|██        | 48/236 [03:12<15:14,  4.87s/it]
test ppl:  21%|██        | 49/236 [03:17<15:26,  4.95s/it]
test ppl:  21%|██        | 50/236 [03:24<17:19,  5.59s/it]
test ppl:  22%|██▏       | 51/236 [03:29<16:58,  5.51s/it]
test ppl:  22%|██▏       | 52/236 [03:36<18:16,  5.96s/it]
test ppl:  22%|██▏       | 53/236 [03:42<17:58,  5.89s/it]
test ppl:  23%|██▎       | 54/236 [03:44<14:10,  4.67s/it]
test ppl:  23%|██▎       | 55/236 [03:51<16:03,  5.32s/it]
test ppl:  24%|██▎       | 56/236 [03:55<14:49,  4.94s/it]
test ppl:  24%|██▍       | 57/236 [03:58<12:46,  4.28s/it]
test ppl:  25%|██▍       | 58/236 [04:00<11:12,  3.78s/it]
test ppl:  25%|██▌       | 59/236 [04:07<14:00,  4.75s/it]
test ppl:  25%|██▌       | 60/236 [04:11<12:54,  4.40s/it]
test ppl:  26%|██▌       | 61/236 [04:18<15:06,  5.18s/it]
test ppl:  26%|██▋       | 62/236 [04:25<16:36,  5.73s/it]
test ppl:  27%|██▋       | 63/236 [04:28<14:05,  4.89s/it]
test ppl:  27%|██▋       | 64/236 [04:30<11:22,  3.97s/it]
test ppl:  28%|██▊       | 65/236 [04:31<09:16,  3.25s/it]
test ppl:  28%|██▊       | 66/236 [04:35<09:31,  3.36s/it]
test ppl:  28%|██▊       | 67/236 [04:42<12:33,  4.46s/it]
test ppl:  29%|██▉       | 68/236 [04:49<14:37,  5.22s/it]
test ppl:  29%|██▉       | 69/236 [04:56<16:01,  5.76s/it]
test ppl:  30%|██▉       | 70/236 [04:58<12:45,  4.61s/it]
test ppl:  30%|███       | 71/236 [05:02<12:24,  4.52s/it]
test ppl:  31%|███       | 72/236 [05:07<12:21,  4.52s/it]
test ppl:  31%|███       | 73/236 [05:13<13:56,  5.13s/it]
test ppl:  31%|███▏      | 74/236 [05:15<11:09,  4.13s/it]
test ppl:  32%|███▏      | 75/236 [05:22<13:24,  4.99s/it]
test ppl:  32%|███▏      | 76/236 [05:26<12:38,  4.74s/it]
test ppl:  33%|███▎      | 77/236 [05:29<10:57,  4.13s/it]
test ppl:  33%|███▎      | 78/236 [05:32<09:46,  3.71s/it]
test ppl:  33%|███▎      | 79/236 [05:36<10:28,  4.00s/it]
test ppl:  34%|███▍      | 80/236 [05:39<09:03,  3.49s/it]
test ppl:  34%|███▍      | 81/236 [05:46<11:43,  4.54s/it]
test ppl:  35%|███▍      | 82/236 [05:52<13:27,  5.24s/it]
test ppl:  35%|███▌      | 83/236 [05:55<11:11,  4.39s/it]
test ppl:  36%|███▌      | 84/236 [05:57<09:29,  3.74s/it]
test ppl:  36%|███▌      | 85/236 [06:02<10:18,  4.10s/it]
test ppl:  36%|███▋      | 86/236 [06:04<08:53,  3.56s/it]
test ppl:  37%|███▋      | 87/236 [06:07<08:02,  3.24s/it]
test ppl:  37%|███▋      | 88/236 [06:14<10:45,  4.36s/it]
test ppl:  38%|███▊      | 89/236 [06:21<12:37,  5.16s/it]
test ppl:  38%|███▊      | 90/236 [06:28<13:53,  5.71s/it]
test ppl:  39%|███▊      | 91/236 [06:34<13:53,  5.75s/it]
test ppl:  39%|███▉      | 92/236 [06:37<12:03,  5.03s/it]
test ppl:  39%|███▉      | 93/236 [06:44<13:22,  5.61s/it]
test ppl:  40%|███▉      | 94/236 [06:51<14:15,  6.02s/it]
test ppl:  40%|████      | 95/236 [06:54<12:18,  5.24s/it]
test ppl:  41%|████      | 96/236 [06:58<11:00,  4.72s/it]
test ppl:  41%|████      | 97/236 [07:05<12:30,  5.40s/it]
test ppl:  42%|████▏     | 98/236 [07:12<13:31,  5.88s/it]
test ppl:  42%|████▏     | 99/236 [07:19<14:12,  6.22s/it]
test ppl:  42%|████▏     | 100/236 [07:20<10:56,  4.83s/it]
test ppl:  43%|████▎     | 101/236 [07:27<12:06,  5.38s/it]
test ppl:  43%|████▎     | 102/236 [07:31<11:18,  5.06s/it]
test ppl:  44%|████▎     | 103/236 [07:33<08:59,  4.05s/it]
test ppl:  44%|████▍     | 104/236 [07:38<09:35,  4.36s/it]
test ppl:  44%|████▍     | 105/236 [07:43<10:05,  4.63s/it]
test ppl:  45%|████▍     | 106/236 [07:50<11:12,  5.17s/it]
test ppl:  45%|████▌     | 107/236 [07:52<09:15,  4.30s/it]
test ppl:  46%|████▌     | 108/236 [07:59<10:47,  5.06s/it]
test ppl:  46%|████▌     | 109/236 [08:04<10:31,  4.97s/it]
test ppl:  47%|████▋     | 110/236 [08:06<08:39,  4.12s/it]
test ppl:  47%|████▋     | 111/236 [08:11<08:59,  4.32s/it]
test ppl:  47%|████▋     | 112/236 [08:15<08:45,  4.24s/it]
test ppl:  48%|████▊     | 113/236 [08:17<07:22,  3.60s/it]
test ppl:  48%|████▊     | 114/236 [08:21<07:31,  3.70s/it]
test ppl:  49%|████▊     | 115/236 [08:28<09:28,  4.69s/it]
test ppl:  49%|████▉     | 116/236 [08:35<10:46,  5.39s/it]
test ppl:  50%|████▉     | 117/236 [08:37<08:47,  4.43s/it]
test ppl:  50%|█████     | 118/236 [08:42<09:13,  4.69s/it]
test ppl:  50%|█████     | 119/236 [08:48<09:41,  4.97s/it]
test ppl:  51%|█████     | 120/236 [08:49<07:38,  3.96s/it]
test ppl:  51%|█████▏    | 121/236 [08:56<09:19,  4.87s/it]
test ppl:  52%|█████▏    | 122/236 [09:02<09:43,  5.12s/it]
test ppl:  52%|█████▏    | 123/236 [09:05<08:11,  4.35s/it]
test ppl:  53%|█████▎    | 124/236 [09:08<07:31,  4.03s/it]
test ppl:  53%|█████▎    | 125/236 [09:15<09:06,  4.93s/it]
test ppl:  53%|█████▎    | 126/236 [09:19<08:44,  4.77s/it]
test ppl:  54%|█████▍    | 127/236 [09:22<07:25,  4.09s/it]
test ppl:  54%|█████▍    | 128/236 [09:25<06:36,  3.67s/it]
test ppl:  55%|█████▍    | 129/236 [09:28<06:25,  3.60s/it]
test ppl:  55%|█████▌    | 130/236 [09:31<06:08,  3.48s/it]
test ppl:  56%|█████▌    | 131/236 [09:38<07:56,  4.53s/it]
test ppl:  56%|█████▌    | 132/236 [09:41<07:02,  4.06s/it]
test ppl:  56%|█████▋    | 133/236 [09:46<07:16,  4.24s/it]
test ppl:  57%|█████▋    | 134/236 [09:51<07:24,  4.36s/it]
test ppl:  57%|█████▋    | 135/236 [09:58<08:40,  5.15s/it]
test ppl:  58%|█████▊    | 136/236 [09:59<06:45,  4.05s/it]
test ppl:  58%|█████▊    | 137/236 [10:06<08:09,  4.94s/it]
test ppl:  58%|█████▊    | 138/236 [10:10<07:31,  4.60s/it]
test ppl:  59%|█████▉    | 139/236 [10:13<06:42,  4.15s/it]
test ppl:  59%|█████▉    | 140/236 [10:15<05:36,  3.50s/it]
test ppl:  60%|█████▉    | 141/236 [10:18<05:31,  3.49s/it]
test ppl:  60%|██████    | 142/236 [10:21<05:00,  3.19s/it]
test ppl:  61%|██████    | 143/236 [10:27<06:25,  4.15s/it]
test ppl:  61%|██████    | 144/236 [10:31<05:56,  3.88s/it]
test ppl:  61%|██████▏   | 145/236 [10:37<07:13,  4.77s/it]
test ppl:  62%|██████▏   | 146/236 [10:43<07:25,  4.95s/it]
test ppl:  62%|██████▏   | 147/236 [10:50<08:16,  5.58s/it]
test ppl:  63%|██████▎   | 148/236 [10:57<08:52,  6.05s/it]
test ppl:  63%|██████▎   | 149/236 [11:01<07:53,  5.44s/it]
test ppl:  64%|██████▎   | 150/236 [11:08<08:28,  5.91s/it]
test ppl:  64%|██████▍   | 151/236 [11:15<08:50,  6.24s/it]
test ppl:  64%|██████▍   | 152/236 [11:22<09:02,  6.46s/it]
test ppl:  65%|██████▍   | 153/236 [11:29<09:09,  6.62s/it]
test ppl:  65%|██████▌   | 154/236 [11:32<07:33,  5.53s/it]
test ppl:  66%|██████▌   | 155/236 [11:35<06:28,  4.80s/it]
test ppl:  66%|██████▌   | 156/236 [11:38<05:30,  4.13s/it]
test ppl:  67%|██████▋   | 157/236 [11:40<04:50,  3.68s/it]
test ppl:  67%|██████▋   | 158/236 [11:47<06:05,  4.68s/it]
test ppl:  67%|██████▋   | 159/236 [11:54<06:54,  5.38s/it]
test ppl:  68%|██████▊   | 160/236 [11:56<05:17,  4.18s/it]
test ppl:  68%|██████▊   | 161/236 [11:57<04:16,  3.42s/it]
test ppl:  69%|██████▊   | 162/236 [12:01<04:19,  3.51s/it]
test ppl:  69%|██████▉   | 163/236 [12:04<04:05,  3.36s/it]
test ppl:  69%|██████▉   | 164/236 [12:08<04:07,  3.43s/it]
test ppl:  70%|██████▉   | 165/236 [12:13<04:48,  4.07s/it]
test ppl:  70%|███████   | 166/236 [12:15<04:07,  3.53s/it]
test ppl:  71%|███████   | 167/236 [12:17<03:27,  3.00s/it]
test ppl:  71%|███████   | 168/236 [12:24<04:45,  4.20s/it]
test ppl:  72%|███████▏  | 169/236 [12:30<05:09,  4.62s/it]
test ppl:  72%|███████▏  | 170/236 [12:37<05:52,  5.35s/it]
test ppl:  72%|███████▏  | 171/236 [12:38<04:34,  4.22s/it]
test ppl:  73%|███████▎  | 172/236 [12:45<05:23,  5.06s/it]
test ppl:  73%|███████▎  | 173/236 [12:49<05:00,  4.76s/it]
test ppl:  74%|███████▎  | 174/236 [12:57<05:37,  5.44s/it]
test ppl:  74%|███████▍  | 175/236 [12:59<04:32,  4.46s/it]
test ppl:  75%|███████▍  | 176/236 [13:05<04:55,  4.93s/it]
test ppl:  75%|███████▌  | 177/236 [13:12<05:28,  5.56s/it]
test ppl:  75%|███████▌  | 178/236 [13:19<05:48,  6.02s/it]
test ppl:  76%|███████▌  | 179/236 [13:26<06:00,  6.32s/it]
test ppl:  76%|███████▋  | 180/236 [13:33<06:00,  6.44s/it]
test ppl:  77%|███████▋  | 181/236 [13:39<05:47,  6.33s/it]
test ppl:  77%|███████▋  | 182/236 [13:41<04:30,  5.02s/it]
test ppl:  78%|███████▊  | 183/236 [13:43<03:43,  4.22s/it]
test ppl:  78%|███████▊  | 184/236 [13:45<03:00,  3.47s/it]
test ppl:  78%|███████▊  | 185/236 [13:49<03:15,  3.83s/it]
test ppl:  79%|███████▉  | 186/236 [13:52<02:51,  3.42s/it]
test ppl:  79%|███████▉  | 187/236 [13:59<03:45,  4.60s/it]
test ppl:  80%|███████▉  | 188/236 [14:06<04:19,  5.42s/it]
test ppl:  80%|████████  | 189/236 [14:14<04:40,  5.97s/it]
test ppl:  81%|████████  | 190/236 [14:18<04:14,  5.54s/it]
test ppl:  81%|████████  | 191/236 [14:23<03:57,  5.29s/it]
test ppl:  81%|████████▏ | 192/236 [14:26<03:25,  4.68s/it]
test ppl:  82%|████████▏ | 193/236 [14:34<03:55,  5.47s/it]
test ppl:  82%|████████▏ | 194/236 [14:37<03:21,  4.80s/it]
test ppl:  83%|████████▎ | 195/236 [14:40<03:02,  4.46s/it]
test ppl:  83%|████████▎ | 196/236 [14:43<02:33,  3.84s/it]
test ppl:  83%|████████▎ | 197/236 [14:45<02:14,  3.44s/it]
test ppl:  84%|████████▍ | 198/236 [14:52<02:51,  4.51s/it]
test ppl:  84%|████████▍ | 199/236 [14:56<02:32,  4.12s/it]
test ppl:  85%|████████▍ | 200/236 [15:03<02:58,  4.97s/it]
test ppl:  85%|████████▌ | 201/236 [15:05<02:27,  4.20s/it]
test ppl:  86%|████████▌ | 202/236 [15:12<02:51,  5.03s/it]
test ppl:  86%|████████▌ | 203/236 [15:19<03:05,  5.62s/it]
test ppl:  86%|████████▋ | 204/236 [15:21<02:22,  4.46s/it]
test ppl:  87%|████████▋ | 205/236 [15:28<02:42,  5.23s/it]
test ppl:  87%|████████▋ | 206/236 [15:32<02:25,  4.84s/it]
test ppl:  88%|████████▊ | 207/236 [15:39<02:38,  5.48s/it]
test ppl:  88%|████████▊ | 208/236 [15:42<02:18,  4.95s/it]
test ppl:  89%|████████▊ | 209/236 [15:49<02:30,  5.58s/it]
test ppl:  89%|████████▉ | 210/236 [15:52<02:03,  4.75s/it]
test ppl:  89%|████████▉ | 211/236 [15:57<02:01,  4.85s/it]
test ppl:  90%|████████▉ | 212/236 [16:04<02:11,  5.48s/it]
test ppl:  90%|█████████ | 213/236 [16:11<02:16,  5.93s/it]
test ppl:  91%|█████████ | 214/236 [16:13<01:43,  4.73s/it]
test ppl:  91%|█████████ | 215/236 [16:20<01:53,  5.41s/it]
test ppl:  92%|█████████▏| 216/236 [16:23<01:33,  4.70s/it]
test ppl:  92%|█████████▏| 217/236 [16:29<01:37,  5.15s/it]
test ppl:  92%|█████████▏| 218/236 [16:32<01:17,  4.32s/it]
test ppl:  93%|█████████▎| 219/236 [16:38<01:21,  4.78s/it]
test ppl:  93%|█████████▎| 220/236 [16:43<01:21,  5.10s/it]
test ppl:  94%|█████████▎| 221/236 [16:46<01:05,  4.37s/it]
test ppl:  94%|█████████▍| 222/236 [16:52<01:07,  4.81s/it]
test ppl:  94%|█████████▍| 223/236 [16:58<01:06,  5.12s/it]
test ppl:  95%|█████████▍| 224/236 [16:59<00:48,  4.05s/it]
test ppl:  95%|█████████▌| 225/236 [17:05<00:50,  4.58s/it]
test ppl:  96%|█████████▌| 226/236 [17:09<00:42,  4.26s/it]
test ppl:  96%|█████████▌| 227/236 [17:12<00:34,  3.84s/it]
test ppl:  97%|█████████▋| 228/236 [17:13<00:26,  3.26s/it]
test ppl:  97%|█████████▋| 229/236 [17:19<00:28,  4.02s/it]
test ppl:  97%|█████████▋| 230/236 [17:23<00:23,  3.85s/it]
test ppl:  98%|█████████▊| 231/236 [17:26<00:18,  3.71s/it]
test ppl:  98%|█████████▊| 232/236 [17:28<00:12,  3.12s/it]
test ppl:  99%|█████████▊| 233/236 [17:30<00:08,  2.82s/it]
test ppl:  99%|█████████▉| 234/236 [17:32<00:05,  2.55s/it]
test ppl: 100%|█████████▉| 235/236 [17:38<00:03,  3.53s/it]
test ppl: 100%|██████████| 236/236 [17:38<00:00,  2.67s/it]
test ppl: 100%|██████████| 236/236 [17:38<00:00,  4.49s/it]
10/13/2024 01:17:15 - INFO - __main__ -    em: 0.2078
10/13/2024 01:17:15 - INFO - __main__ -   Finish and take 19m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/32_0.4_80_eval_results.json
32 0.4 80:  em: 0.2078

--------------------------------------------------------------------------------
Running experiment with knn_temp=80, lmbda=0.4, k=64
2024-10-13 01:17:21.967435: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-13 01:17:21.987022: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-13 01:17:22.009127: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-13 01:17:22.015864: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-13 01:17:22.031881: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-13 01:17:23.024835: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/13/2024 01:17:24 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.4, knn_temp=80, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/13/2024 01:17:24 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:41:20,  2.19it/s]
Adding feature api:   4%|▍         | 7315/187062 [00:00<00:10, 17451.57it/s]
Adding feature api:   8%|▊         | 15771/187062 [00:00<00:04, 34509.56it/s]
Adding feature api:  13%|█▎        | 23932/187062 [00:00<00:03, 47056.32it/s]
Adding feature api:  17%|█▋        | 32376/187062 [00:00<00:02, 57360.51it/s]
Adding feature api:  22%|██▏       | 40843/187062 [00:00<00:02, 65073.62it/s]
Adding feature api:  26%|██▋       | 49167/187062 [00:01<00:01, 70295.86it/s]
Adding feature api:  31%|███       | 57640/187062 [00:01<00:01, 74497.60it/s]
Adding feature api:  35%|███▌      | 65893/187062 [00:01<00:01, 76856.35it/s]
Adding feature api:  40%|███▉      | 74386/187062 [00:01<00:01, 79239.95it/s]
Adding feature api:  44%|████▍     | 82919/187062 [00:01<00:01, 81045.35it/s]
Adding feature api:  49%|████▉     | 91389/187062 [00:01<00:01, 82130.87it/s]
Adding feature api:  53%|█████▎    | 99778/187062 [00:01<00:01, 82110.38it/s]
Adding feature api:  58%|█████▊    | 108160/187062 [00:01<00:00, 82617.32it/s]
Adding feature api:  62%|██████▏   | 116549/187062 [00:01<00:00, 82993.81it/s]
Adding feature api:  67%|██████▋   | 125027/187062 [00:01<00:00, 83523.99it/s]
Adding feature api:  71%|███████▏  | 133423/187062 [00:02<00:00, 83124.27it/s]
Adding feature api:  76%|███████▌  | 141935/187062 [00:02<00:00, 83718.25it/s]
Adding feature api:  80%|████████  | 150438/187062 [00:02<00:00, 84108.34it/s]
Adding feature api:  85%|████████▍ | 158880/187062 [00:02<00:00, 84198.92it/s]
Adding feature api:  89%|████████▉ | 167354/187062 [00:02<00:00, 84360.36it/s]
Adding feature api:  94%|█████████▍| 175798/187062 [00:02<00:00, 83718.83it/s]
Adding feature api:  98%|█████████▊| 184177/187062 [00:02<00:00, 57648.94it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64508.61it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:53:03,  2.18it/s]
Adding feature datatype:   4%|▍         | 7112/187062 [00:00<00:10, 16861.79it/s]
Adding feature datatype:   8%|▊         | 15201/187062 [00:00<00:05, 33061.48it/s]
Adding feature datatype:  12%|█▏        | 23337/187062 [00:00<00:03, 45882.57it/s]
Adding feature datatype:  17%|█▋        | 31180/187062 [00:00<00:02, 54830.65it/s]
Adding feature datatype:  21%|██        | 39351/187062 [00:00<00:02, 62408.64it/s]
Adding feature datatype:  25%|██▌       | 47537/187062 [00:01<00:02, 67992.52it/s]
Adding feature datatype:  30%|██▉       | 55690/187062 [00:01<00:01, 71928.56it/s]
Adding feature datatype:  34%|███▍      | 63876/187062 [00:01<00:01, 74843.34it/s]
Adding feature datatype:  38%|███▊      | 71846/187062 [00:01<00:01, 76074.85it/s]
Adding feature datatype:  43%|████▎     | 80078/187062 [00:01<00:01, 77922.00it/s]
Adding feature datatype:  47%|████▋     | 88259/187062 [00:01<00:01, 79076.70it/s]
Adding feature datatype:  52%|█████▏    | 96381/187062 [00:01<00:01, 79713.64it/s]
Adding feature datatype:  56%|█████▌    | 104542/187062 [00:01<00:01, 79375.66it/s]
Adding feature datatype:  60%|██████    | 112725/187062 [00:01<00:00, 80102.90it/s]
Adding feature datatype:  65%|██████▍   | 120982/187062 [00:01<00:00, 80834.66it/s]
Adding feature datatype:  69%|██████▉   | 129120/187062 [00:02<00:00, 80996.01it/s]
Adding feature datatype:  73%|███████▎  | 137315/187062 [00:02<00:00, 81278.07it/s]
Adding feature datatype:  78%|███████▊  | 145532/187062 [00:02<00:00, 81541.63it/s]
Adding feature datatype:  82%|████████▏ | 153702/187062 [00:02<00:00, 80807.19it/s]
Adding feature datatype:  87%|████████▋ | 161925/187062 [00:02<00:00, 81229.23it/s]
Adding feature datatype:  91%|█████████ | 170130/187062 [00:02<00:00, 81471.02it/s]
Adding feature datatype:  95%|█████████▌| 178284/187062 [00:02<00:00, 78270.39it/s]
Adding feature datatype: 100%|█████████▉| 186142/187062 [00:02<00:00, 52615.02it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 62794.88it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:37:56,  2.20it/s]
Adding feature literal:   4%|▍         | 7059/187062 [00:00<00:10, 16871.92it/s]
Adding feature literal:   8%|▊         | 15152/187062 [00:00<00:05, 33176.89it/s]
Adding feature literal:  12%|█▏        | 23306/187062 [00:00<00:03, 46072.04it/s]
Adding feature literal:  17%|█▋        | 31421/187062 [00:00<00:02, 55746.67it/s]
Adding feature literal:  21%|██        | 39541/187062 [00:00<00:02, 62940.40it/s]
Adding feature literal:  25%|██▌       | 47693/187062 [00:01<00:02, 68283.72it/s]
Adding feature literal:  30%|██▉       | 55841/187062 [00:01<00:01, 72125.44it/s]
Adding feature literal:  34%|███▍      | 63934/187062 [00:01<00:01, 74710.21it/s]
Adding feature literal:  39%|███▊      | 72084/187062 [00:01<00:01, 76715.86it/s]
Adding feature literal:  43%|████▎     | 80095/187062 [00:01<00:01, 75874.49it/s]
Adding feature literal:  47%|████▋     | 87920/187062 [00:01<00:01, 74656.41it/s]
Adding feature literal:  51%|█████     | 95554/187062 [00:01<00:01, 73838.68it/s]
Adding feature literal:  55%|█████▌    | 103149/187062 [00:01<00:01, 74446.74it/s]
Adding feature literal:  59%|█████▉    | 111278/187062 [00:01<00:00, 76444.75it/s]
Adding feature literal:  64%|██████▍   | 119419/187062 [00:01<00:00, 77904.45it/s]
Adding feature literal:  68%|██████▊   | 127542/187062 [00:02<00:00, 78888.86it/s]
Adding feature literal:  73%|███████▎  | 135626/187062 [00:02<00:00, 79468.28it/s]
Adding feature literal:  77%|███████▋  | 143693/187062 [00:02<00:00, 79825.51it/s]
Adding feature literal:  81%|████████  | 151815/187062 [00:02<00:00, 80241.28it/s]
Adding feature literal:  85%|████████▌ | 159915/187062 [00:02<00:00, 80467.00it/s]
Adding feature literal:  90%|████████▉ | 168082/187062 [00:02<00:00, 80825.57it/s]
Adding feature literal:  94%|█████████▍| 176188/187062 [00:02<00:00, 80893.85it/s]
Adding feature literal:  99%|█████████▊| 184282/187062 [00:02<00:00, 55363.20it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:03<00:00, 62024.89it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:45:03,  2.19it/s]
Adding feature operator:   4%|▍         | 7124/187062 [00:00<00:10, 16962.50it/s]
Adding feature operator:   8%|▊         | 15281/187062 [00:00<00:05, 33360.69it/s]
Adding feature operator:  13%|█▎        | 23439/187062 [00:00<00:03, 46190.98it/s]
Adding feature operator:  17%|█▋        | 31631/187062 [00:00<00:02, 56029.96it/s]
Adding feature operator:  21%|██▏       | 39844/187062 [00:00<00:02, 63399.05it/s]
Adding feature operator:  26%|██▌       | 48099/187062 [00:01<00:02, 68903.05it/s]
Adding feature operator:  30%|███       | 56358/187062 [00:01<00:01, 72884.45it/s]
Adding feature operator:  35%|███▍      | 64581/187062 [00:01<00:01, 75626.07it/s]
Adding feature operator:  39%|███▉      | 72811/187062 [00:01<00:01, 77595.20it/s]
Adding feature operator:  43%|████▎     | 81091/187062 [00:01<00:01, 79139.55it/s]
Adding feature operator:  48%|████▊     | 89359/187062 [00:01<00:01, 80193.11it/s]
Adding feature operator:  52%|█████▏    | 97624/187062 [00:01<00:01, 80923.40it/s]
Adding feature operator:  57%|█████▋    | 105886/187062 [00:01<00:00, 81427.76it/s]
Adding feature operator:  61%|██████    | 114139/187062 [00:01<00:00, 81756.26it/s]
Adding feature operator:  65%|██████▌   | 122375/187062 [00:01<00:00, 81769.88it/s]
Adding feature operator:  70%|██████▉   | 130594/187062 [00:02<00:00, 81790.93it/s]
Adding feature operator:  74%|███████▍  | 138847/187062 [00:02<00:00, 82009.48it/s]
Adding feature operator:  79%|███████▊  | 147069/187062 [00:02<00:00, 81973.35it/s]
Adding feature operator:  83%|████████▎ | 155281/187062 [00:02<00:00, 81867.35it/s]
Adding feature operator:  87%|████████▋ | 163554/187062 [00:02<00:00, 82124.61it/s]
Adding feature operator:  92%|█████████▏| 171809/187062 [00:02<00:00, 82250.24it/s]
Adding feature operator:  96%|█████████▌| 180040/187062 [00:02<00:00, 71038.56it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63449.05it/s]
[2024-10-13 01:18:08,360] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/13/2024 01:18:09 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/13/2024 01:18:09 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 42/6548 [00:00<00:16, 403.78 examples/s]
Map:   1%|▏         | 83/6548 [00:00<00:31, 205.41 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:24, 265.98 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 317.64 examples/s]
Map:   3%|▎         | 220/6548 [00:00<00:18, 345.82 examples/s]
Map:   4%|▍         | 271/6548 [00:00<00:18, 340.03 examples/s]
Map:   5%|▍         | 309/6548 [00:01<00:20, 306.16 examples/s]
Map:   5%|▌         | 348/6548 [00:01<00:19, 324.80 examples/s]
Map:   6%|▌         | 391/6548 [00:01<00:17, 350.52 examples/s]
Map:   7%|▋         | 435/6548 [00:01<00:16, 370.90 examples/s]
Map:   7%|▋         | 488/6548 [00:01<00:17, 347.44 examples/s]
Map:   8%|▊         | 532/6548 [00:01<00:16, 368.48 examples/s]
Map:   9%|▉         | 587/6548 [00:01<00:16, 364.81 examples/s]
Map:  10%|▉         | 625/6548 [00:01<00:18, 321.48 examples/s]
Map:  10%|█         | 666/6548 [00:02<00:17, 341.58 examples/s]
Map:  11%|█         | 711/6548 [00:02<00:15, 366.67 examples/s]
Map:  12%|█▏        | 759/6548 [00:02<00:14, 392.97 examples/s]
Map:  12%|█▏        | 813/6548 [00:02<00:13, 426.89 examples/s]
Map:  13%|█▎        | 876/6548 [00:02<00:14, 404.13 examples/s]
Map:  14%|█▍        | 920/6548 [00:02<00:15, 354.36 examples/s]
Map:  15%|█▍        | 969/6548 [00:02<00:14, 382.17 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:24, 224.48 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 249.97 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:19, 284.22 examples/s]
Map:  18%|█▊        | 1146/6548 [00:03<00:16, 322.06 examples/s]
Map:  18%|█▊        | 1185/6548 [00:03<00:16, 331.57 examples/s]
Map:  19%|█▉        | 1228/6548 [00:03<00:15, 344.02 examples/s]
Map:  19%|█▉        | 1267/6548 [00:03<00:14, 352.36 examples/s]
Map:  20%|██        | 1315/6548 [00:03<00:15, 334.09 examples/s]
Map:  21%|██        | 1359/6548 [00:04<00:16, 307.21 examples/s]
Map:  21%|██▏       | 1407/6548 [00:04<00:16, 303.43 examples/s]
Map:  22%|██▏       | 1459/6548 [00:04<00:16, 301.02 examples/s]
Map:  23%|██▎       | 1511/6548 [00:04<00:17, 280.27 examples/s]
Map:  24%|██▍       | 1556/6548 [00:04<00:18, 275.43 examples/s]
Map:  24%|██▍       | 1592/6548 [00:04<00:17, 291.30 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:19, 256.14 examples/s]
Map:  26%|██▌       | 1676/6548 [00:05<00:20, 239.65 examples/s]
Map:  26%|██▌       | 1717/6548 [00:05<00:17, 270.43 examples/s]
Map:  27%|██▋       | 1766/6548 [00:05<00:15, 313.62 examples/s]
Map:  28%|██▊       | 1807/6548 [00:05<00:14, 331.08 examples/s]
Map:  28%|██▊       | 1849/6548 [00:05<00:13, 351.82 examples/s]
Map:  29%|██▉       | 1899/6548 [00:05<00:13, 338.88 examples/s]
Map:  30%|██▉       | 1936/6548 [00:06<00:13, 336.12 examples/s]
Map:  30%|███       | 1983/6548 [00:06<00:12, 366.25 examples/s]
Map:  31%|███       | 2027/6548 [00:06<00:19, 226.15 examples/s]
Map:  31%|███▏      | 2062/6548 [00:06<00:18, 247.94 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 268.92 examples/s]
Map:  33%|███▎      | 2142/6548 [00:06<00:17, 258.02 examples/s]
Map:  33%|███▎      | 2181/6548 [00:07<00:15, 280.87 examples/s]
Map:  34%|███▍      | 2214/6548 [00:07<00:14, 289.63 examples/s]
Map:  35%|███▍      | 2265/6548 [00:07<00:14, 298.86 examples/s]
Map:  35%|███▌      | 2311/6548 [00:07<00:14, 298.77 examples/s]
Map:  36%|███▌      | 2355/6548 [00:07<00:13, 305.85 examples/s]
Map:  37%|███▋      | 2391/6548 [00:07<00:13, 317.12 examples/s]
Map:  37%|███▋      | 2434/6548 [00:07<00:12, 341.65 examples/s]
Map:  38%|███▊      | 2478/6548 [00:07<00:12, 316.20 examples/s]
Map:  38%|███▊      | 2517/6548 [00:08<00:12, 332.36 examples/s]
Map:  39%|███▉      | 2562/6548 [00:08<00:11, 355.03 examples/s]
Map:  40%|███▉      | 2607/6548 [00:08<00:10, 376.97 examples/s]
Map:  41%|████      | 2652/6548 [00:08<00:09, 393.88 examples/s]
Map:  41%|████      | 2695/6548 [00:08<00:11, 349.78 examples/s]
Map:  42%|████▏     | 2749/6548 [00:08<00:10, 348.90 examples/s]
Map:  43%|████▎     | 2789/6548 [00:08<00:10, 351.43 examples/s]
Map:  43%|████▎     | 2828/6548 [00:08<00:12, 294.59 examples/s]
Map:  44%|████▎     | 2861/6548 [00:09<00:12, 302.06 examples/s]
Map:  44%|████▍     | 2900/6548 [00:09<00:12, 301.02 examples/s]
Map:  45%|████▌     | 2949/6548 [00:09<00:12, 292.06 examples/s]
Map:  46%|████▌     | 2982/6548 [00:09<00:12, 295.00 examples/s]
Map:  46%|████▌     | 3023/6548 [00:09<00:21, 167.59 examples/s]
Map:  47%|████▋     | 3053/6548 [00:10<00:19, 183.93 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 210.62 examples/s]
Map:  48%|████▊     | 3134/6548 [00:10<00:13, 253.19 examples/s]
Map:  48%|████▊     | 3174/6548 [00:10<00:13, 255.12 examples/s]
Map:  49%|████▉     | 3219/6548 [00:10<00:13, 254.80 examples/s]
Map:  50%|████▉     | 3255/6548 [00:10<00:12, 273.14 examples/s]
Map:  50%|█████     | 3286/6548 [00:10<00:11, 278.53 examples/s]
Map:  51%|█████     | 3331/6548 [00:10<00:10, 311.21 examples/s]
Map:  52%|█████▏    | 3380/6548 [00:11<00:10, 304.95 examples/s]
Map:  52%|█████▏    | 3421/6548 [00:11<00:11, 283.23 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 274.57 examples/s]
Map:  53%|█████▎    | 3492/6548 [00:11<00:11, 259.12 examples/s]
Map:  54%|█████▍    | 3543/6548 [00:11<00:09, 309.99 examples/s]
Map:  55%|█████▍    | 3591/6548 [00:11<00:08, 345.38 examples/s]
Map:  55%|█████▌    | 3628/6548 [00:11<00:08, 349.95 examples/s]
Map:  56%|█████▌    | 3667/6548 [00:12<00:08, 350.66 examples/s]
Map:  57%|█████▋    | 3712/6548 [00:12<00:07, 375.80 examples/s]
Map:  57%|█████▋    | 3752/6548 [00:12<00:07, 367.75 examples/s]
Map:  58%|█████▊    | 3799/6548 [00:12<00:06, 394.78 examples/s]
Map:  59%|█████▊    | 3845/6548 [00:12<00:08, 311.04 examples/s]
Map:  59%|█████▉    | 3882/6548 [00:12<00:08, 316.88 examples/s]
Map:  60%|█████▉    | 3917/6548 [00:12<00:08, 324.01 examples/s]
Map:  60%|██████    | 3956/6548 [00:12<00:07, 331.29 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 234.60 examples/s]
Map:  62%|██████▏   | 4055/6548 [00:13<00:08, 295.92 examples/s]
Map:  63%|██████▎   | 4096/6548 [00:13<00:07, 319.86 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 328.69 examples/s]
Map:  64%|██████▍   | 4194/6548 [00:13<00:07, 329.23 examples/s]
Map:  65%|██████▍   | 4231/6548 [00:13<00:07, 324.19 examples/s]
Map:  65%|██████▌   | 4273/6548 [00:13<00:06, 338.89 examples/s]
Map:  66%|██████▌   | 4317/6548 [00:14<00:06, 358.70 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:14<00:06, 339.40 examples/s]
Map:  67%|██████▋   | 4405/6548 [00:14<00:06, 346.24 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:05, 375.36 examples/s]
Map:  69%|██████▊   | 4496/6548 [00:14<00:06, 322.84 examples/s]
Map:  69%|██████▉   | 4545/6548 [00:14<00:06, 315.97 examples/s]
Map:  70%|███████   | 4584/6548 [00:14<00:06, 311.51 examples/s]
Map:  71%|███████   | 4626/6548 [00:14<00:05, 333.11 examples/s]
Map:  71%|███████▏  | 4668/6548 [00:15<00:05, 339.15 examples/s]
Map:  72%|███████▏  | 4725/6548 [00:15<00:05, 351.14 examples/s]
Map:  73%|███████▎  | 4767/6548 [00:15<00:04, 363.27 examples/s]
Map:  74%|███████▎  | 4819/6548 [00:15<00:04, 399.67 examples/s]
Map:  75%|███████▍  | 4886/6548 [00:15<00:04, 367.04 examples/s]
Map:  75%|███████▌  | 4933/6548 [00:15<00:04, 379.86 examples/s]
Map:  76%|███████▌  | 4981/6548 [00:15<00:03, 396.30 examples/s]
Map:  77%|███████▋  | 5038/6548 [00:16<00:05, 252.06 examples/s]
Map:  78%|███████▊  | 5081/6548 [00:16<00:05, 258.28 examples/s]
Map:  78%|███████▊  | 5117/6548 [00:16<00:05, 267.79 examples/s]
Map:  79%|███████▊  | 5155/6548 [00:16<00:04, 283.41 examples/s]
Map:  79%|███████▉  | 5188/6548 [00:16<00:04, 272.28 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:16<00:04, 288.96 examples/s]
Map:  80%|████████  | 5256/6548 [00:17<00:04, 296.10 examples/s]
Map:  81%|████████  | 5312/6548 [00:17<00:03, 362.25 examples/s]
Map:  82%|████████▏ | 5363/6548 [00:17<00:03, 311.80 examples/s]
Map:  83%|████████▎ | 5408/6548 [00:17<00:03, 302.33 examples/s]
Map:  83%|████████▎ | 5453/6548 [00:17<00:03, 331.05 examples/s]
Map:  84%|████████▍ | 5500/6548 [00:17<00:03, 321.87 examples/s]
Map:  85%|████████▍ | 5538/6548 [00:17<00:03, 333.85 examples/s]
Map:  85%|████████▌ | 5580/6548 [00:18<00:03, 301.98 examples/s]
Map:  86%|████████▌ | 5619/6548 [00:18<00:02, 321.02 examples/s]
Map:  87%|████████▋ | 5666/6548 [00:18<00:02, 314.23 examples/s]
Map:  87%|████████▋ | 5703/6548 [00:18<00:02, 318.95 examples/s]
Map:  88%|████████▊ | 5744/6548 [00:18<00:02, 339.32 examples/s]
Map:  88%|████████▊ | 5781/6548 [00:18<00:02, 343.21 examples/s]
Map:  89%|████████▉ | 5825/6548 [00:18<00:02, 346.74 examples/s]
Map:  90%|████████▉ | 5866/6548 [00:18<00:01, 356.16 examples/s]
Map:  90%|█████████ | 5907/6548 [00:18<00:01, 367.97 examples/s]
Map:  91%|█████████ | 5960/6548 [00:19<00:01, 359.31 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 228.23 examples/s]
Map:  92%|█████████▏| 6041/6548 [00:19<00:01, 261.21 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 289.74 examples/s]
Map:  94%|█████████▎| 6124/6548 [00:19<00:01, 282.87 examples/s]
Map:  94%|█████████▍| 6166/6548 [00:19<00:01, 297.72 examples/s]
Map:  95%|█████████▍| 6207/6548 [00:20<00:01, 319.72 examples/s]
Map:  95%|█████████▌| 6242/6548 [00:20<00:00, 322.07 examples/s]
Map:  96%|█████████▌| 6277/6548 [00:20<00:00, 320.36 examples/s]
Map:  97%|█████████▋| 6322/6548 [00:20<00:00, 348.88 examples/s]
Map:  97%|█████████▋| 6367/6548 [00:20<00:00, 361.11 examples/s]
Map:  98%|█████████▊| 6410/6548 [00:20<00:00, 376.44 examples/s]
Map:  99%|█████████▊| 6455/6548 [00:20<00:00, 394.87 examples/s]
Map:  99%|█████████▉| 6515/6548 [00:20<00:00, 385.08 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 311.48 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 319.29 examples/s]
Map:   8%|▊         | 73/903 [00:00<00:02, 341.61 examples/s]
Map:  13%|█▎        | 120/903 [00:00<00:02, 321.01 examples/s]
Map:  18%|█▊        | 165/903 [00:00<00:02, 359.99 examples/s]
Map:  23%|██▎       | 210/903 [00:00<00:01, 379.57 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 386.27 examples/s]
Map:  34%|███▍      | 310/903 [00:00<00:01, 383.30 examples/s]
Map:  39%|███▉      | 353/903 [00:00<00:01, 346.63 examples/s]
Map:  43%|████▎     | 390/903 [00:01<00:01, 286.08 examples/s]
Map:  48%|████▊     | 432/903 [00:01<00:01, 315.60 examples/s]
Map:  52%|█████▏    | 470/903 [00:01<00:01, 289.72 examples/s]
Map:  56%|█████▌    | 502/903 [00:01<00:01, 281.02 examples/s]
Map:  61%|██████    | 548/903 [00:01<00:01, 323.14 examples/s]
Map:  66%|██████▌   | 593/903 [00:01<00:00, 352.22 examples/s]
Map:  70%|███████   | 636/903 [00:01<00:00, 361.62 examples/s]
Map:  75%|███████▍  | 677/903 [00:01<00:00, 369.76 examples/s]
Map:  82%|████████▏ | 736/903 [00:02<00:00, 372.89 examples/s]
Map:  86%|████████▌ | 778/903 [00:02<00:00, 376.25 examples/s]
Map:  91%|█████████ | 822/903 [00:02<00:00, 389.53 examples/s]
Map:  95%|█████████▌| 862/903 [00:02<00:00, 370.94 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 224.60 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 317.70 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 37/1882 [00:00<00:06, 285.61 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 347.21 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 338.31 examples/s]
Map:   8%|▊         | 159/1882 [00:00<00:04, 355.97 examples/s]
Map:  11%|█         | 206/1882 [00:00<00:05, 330.06 examples/s]
Map:  13%|█▎        | 251/1882 [00:00<00:04, 363.15 examples/s]
Map:  16%|█▌        | 301/1882 [00:00<00:04, 345.24 examples/s]
Map:  19%|█▊        | 351/1882 [00:01<00:04, 337.03 examples/s]
Map:  21%|██        | 393/1882 [00:01<00:04, 314.48 examples/s]
Map:  23%|██▎       | 432/1882 [00:01<00:04, 292.31 examples/s]
Map:  25%|██▍       | 469/1882 [00:01<00:04, 304.28 examples/s]
Map:  27%|██▋       | 507/1882 [00:01<00:04, 311.55 examples/s]
Map:  29%|██▉       | 542/1882 [00:01<00:04, 319.36 examples/s]
Map:  31%|███       | 586/1882 [00:01<00:03, 349.25 examples/s]
Map:  34%|███▍      | 644/1882 [00:01<00:03, 404.68 examples/s]
Map:  37%|███▋      | 704/1882 [00:02<00:03, 389.53 examples/s]
Map:  40%|███▉      | 744/1882 [00:02<00:02, 391.04 examples/s]
Map:  42%|████▏     | 788/1882 [00:02<00:03, 351.25 examples/s]
Map:  44%|████▍     | 825/1882 [00:02<00:02, 353.64 examples/s]
Map:  47%|████▋     | 882/1882 [00:02<00:02, 358.96 examples/s]
Map:  49%|████▉     | 922/1882 [00:02<00:02, 362.36 examples/s]
Map:  52%|█████▏    | 973/1882 [00:02<00:02, 395.77 examples/s]
Map:  54%|█████▍    | 1016/1882 [00:03<00:03, 237.30 examples/s]
Map:  56%|█████▌    | 1053/1882 [00:03<00:03, 258.79 examples/s]
Map:  58%|█████▊    | 1098/1882 [00:03<00:02, 263.79 examples/s]
Map:  60%|██████    | 1135/1882 [00:03<00:02, 278.87 examples/s]
Map:  62%|██████▏   | 1171/1882 [00:03<00:02, 296.15 examples/s]
Map:  64%|██████▍   | 1206/1882 [00:03<00:02, 270.85 examples/s]
Map:  66%|██████▌   | 1244/1882 [00:03<00:02, 293.64 examples/s]
Map:  68%|██████▊   | 1280/1882 [00:03<00:01, 306.37 examples/s]
Map:  71%|███████   | 1334/1882 [00:04<00:01, 353.98 examples/s]
Map:  73%|███████▎  | 1381/1882 [00:04<00:01, 334.73 examples/s]
Map:  76%|███████▌  | 1426/1882 [00:04<00:01, 299.32 examples/s]
Map:  78%|███████▊  | 1470/1882 [00:04<00:01, 296.48 examples/s]
Map:  80%|████████  | 1507/1882 [00:04<00:01, 264.80 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 278.65 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:04<00:00, 302.98 examples/s]
Map:  86%|████████▋ | 1626/1882 [00:05<00:00, 333.14 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 332.98 examples/s]
Map:  90%|█████████ | 1698/1882 [00:05<00:00, 335.36 examples/s]
Map:  92%|█████████▏| 1734/1882 [00:05<00:00, 287.51 examples/s]
Map:  94%|█████████▍| 1771/1882 [00:05<00:00, 298.73 examples/s]
Map:  97%|█████████▋| 1826/1882 [00:05<00:00, 315.41 examples/s]
Map:  99%|█████████▉| 1869/1882 [00:05<00:00, 340.78 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 309.33 examples/s]
10/13/2024 01:19:11 - INFO - __main__ -     ***** Testing *****
10/13/2024 01:19:11 - INFO - __main__ -     Batch size = 8
10/13/2024 01:19:11 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/13/2024 01:19:12 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/13/2024 01:19:12 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/13/2024 01:19:13 - INFO - knnlm -   Reading datastore took 0.9659721851348877 s
10/13/2024 01:19:14 - INFO - knnlm -   Moving index to GPU took 0.9212887287139893 s
10/13/2024 01:19:14 - INFO - __main__ -   ******************************break-into
10/13/2024 01:19:14 - INFO - __main__ -     ***** Running acc evaluation *****
10/13/2024 01:19:14 - INFO - __main__ -     Num examples = 236
10/13/2024 01:19:14 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:26,  7.77s/it]
test ppl:   1%|          | 2/236 [00:09<16:48,  4.31s/it]
test ppl:   1%|▏         | 3/236 [00:11<11:42,  3.02s/it]
test ppl:   2%|▏         | 4/236 [00:16<15:53,  4.11s/it]
test ppl:   2%|▏         | 5/236 [00:22<18:09,  4.72s/it]
test ppl:   3%|▎         | 6/236 [00:28<19:28,  5.08s/it]
test ppl:   3%|▎         | 7/236 [00:30<15:22,  4.03s/it]
test ppl:   3%|▎         | 8/236 [00:35<16:39,  4.39s/it]
test ppl:   4%|▍         | 9/236 [00:41<18:16,  4.83s/it]
test ppl:   4%|▍         | 10/236 [00:47<19:21,  5.14s/it]
test ppl:   5%|▍         | 11/236 [00:49<16:37,  4.44s/it]
test ppl:   5%|▌         | 12/236 [00:55<18:06,  4.85s/it]
test ppl:   6%|▌         | 13/236 [01:01<19:06,  5.14s/it]
test ppl:   6%|▌         | 14/236 [01:03<15:51,  4.29s/it]
test ppl:   6%|▋         | 15/236 [01:05<13:12,  3.58s/it]
test ppl:   7%|▋         | 16/236 [01:07<11:13,  3.06s/it]
test ppl:   7%|▋         | 17/236 [01:13<14:09,  3.88s/it]
test ppl:   8%|▊         | 18/236 [01:15<11:41,  3.22s/it]
test ppl:   8%|▊         | 19/236 [01:19<12:54,  3.57s/it]
test ppl:   8%|▊         | 20/236 [01:21<10:52,  3.02s/it]
test ppl:   9%|▉         | 21/236 [01:23<10:05,  2.82s/it]
test ppl:   9%|▉         | 22/236 [01:29<13:14,  3.71s/it]
test ppl:  10%|▉         | 23/236 [01:31<11:52,  3.35s/it]
test ppl:  10%|█         | 24/236 [01:34<10:43,  3.04s/it]
test ppl:  11%|█         | 25/236 [01:40<13:37,  3.87s/it]
test ppl:  11%|█         | 26/236 [01:45<15:36,  4.46s/it]
test ppl:  11%|█▏        | 27/236 [01:50<15:10,  4.36s/it]
test ppl:  12%|█▏        | 28/236 [01:51<11:50,  3.42s/it]
test ppl:  12%|█▏        | 29/236 [01:53<10:37,  3.08s/it]
test ppl:  13%|█▎        | 30/236 [01:55<08:57,  2.61s/it]
test ppl:  13%|█▎        | 31/236 [01:57<08:16,  2.42s/it]
test ppl:  14%|█▎        | 32/236 [01:59<08:36,  2.53s/it]
test ppl:  14%|█▍        | 33/236 [02:02<08:56,  2.64s/it]
test ppl:  14%|█▍        | 34/236 [02:06<10:14,  3.04s/it]
test ppl:  15%|█▍        | 35/236 [02:09<09:38,  2.88s/it]
test ppl:  15%|█▌        | 36/236 [02:15<12:32,  3.76s/it]
test ppl:  16%|█▌        | 37/236 [02:20<14:32,  4.38s/it]
test ppl:  16%|█▌        | 38/236 [02:22<12:09,  3.68s/it]
test ppl:  17%|█▋        | 39/236 [02:24<09:56,  3.03s/it]
test ppl:  17%|█▋        | 40/236 [02:27<09:32,  2.92s/it]
test ppl:  17%|█▋        | 41/236 [02:28<08:26,  2.60s/it]
test ppl:  18%|█▊        | 42/236 [02:34<11:32,  3.57s/it]
test ppl:  18%|█▊        | 43/236 [02:40<13:39,  4.24s/it]
test ppl:  19%|█▊        | 44/236 [02:42<11:27,  3.58s/it]
test ppl:  19%|█▉        | 45/236 [02:44<09:50,  3.09s/it]
test ppl:  19%|█▉        | 46/236 [02:51<13:11,  4.16s/it]
test ppl:  20%|█▉        | 47/236 [02:52<10:40,  3.39s/it]
test ppl:  20%|██        | 48/236 [02:58<12:52,  4.11s/it]
test ppl:  21%|██        | 49/236 [03:02<12:55,  4.15s/it]
test ppl:  21%|██        | 50/236 [03:08<14:28,  4.67s/it]
test ppl:  22%|██▏       | 51/236 [03:14<15:28,  5.02s/it]
test ppl:  22%|██▏       | 52/236 [03:20<16:08,  5.26s/it]
test ppl:  22%|██▏       | 53/236 [03:25<15:36,  5.11s/it]
test ppl:  23%|██▎       | 54/236 [03:26<12:14,  4.04s/it]
test ppl:  23%|██▎       | 55/236 [03:32<13:34,  4.50s/it]
test ppl:  24%|██▎       | 56/236 [03:35<12:28,  4.16s/it]
test ppl:  24%|██▍       | 57/236 [03:37<10:45,  3.60s/it]
test ppl:  25%|██▍       | 58/236 [03:40<09:24,  3.17s/it]
test ppl:  25%|██▌       | 59/236 [03:45<11:44,  3.98s/it]
test ppl:  25%|██▌       | 60/236 [03:48<10:47,  3.68s/it]
test ppl:  26%|██▌       | 61/236 [03:54<12:34,  4.31s/it]
test ppl:  26%|██▋       | 62/236 [03:58<12:17,  4.24s/it]
test ppl:  27%|██▋       | 63/236 [04:01<11:19,  3.93s/it]
test ppl:  27%|██▋       | 64/236 [04:03<09:30,  3.32s/it]
test ppl:  28%|██▊       | 65/236 [04:05<07:43,  2.71s/it]
test ppl:  28%|██▊       | 66/236 [04:08<07:55,  2.79s/it]
test ppl:  28%|██▊       | 67/236 [04:13<10:25,  3.70s/it]
test ppl:  29%|██▉       | 68/236 [04:19<12:07,  4.33s/it]
test ppl:  29%|██▉       | 69/236 [04:25<13:17,  4.78s/it]
test ppl:  30%|██▉       | 70/236 [04:27<10:34,  3.82s/it]
test ppl:  30%|███       | 71/236 [04:32<12:01,  4.37s/it]
test ppl:  31%|███       | 72/236 [04:36<11:28,  4.20s/it]
test ppl:  31%|███       | 73/236 [04:40<11:10,  4.11s/it]
test ppl:  31%|███▏      | 74/236 [04:42<08:58,  3.33s/it]
test ppl:  32%|███▏      | 75/236 [04:47<10:54,  4.07s/it]
test ppl:  32%|███▏      | 76/236 [04:51<10:22,  3.89s/it]
test ppl:  33%|███▎      | 77/236 [04:53<09:00,  3.40s/it]
test ppl:  33%|███▎      | 78/236 [04:55<07:45,  2.95s/it]
test ppl:  33%|███▎      | 79/236 [04:59<08:27,  3.23s/it]
test ppl:  34%|███▍      | 80/236 [05:01<07:21,  2.83s/it]
test ppl:  34%|███▍      | 81/236 [05:07<09:36,  3.72s/it]
test ppl:  35%|███▍      | 82/236 [05:12<11:11,  4.36s/it]
test ppl:  35%|███▌      | 83/236 [05:14<09:18,  3.65s/it]
test ppl:  36%|███▌      | 84/236 [05:16<07:53,  3.12s/it]
test ppl:  36%|███▌      | 85/236 [05:20<08:34,  3.41s/it]
test ppl:  36%|███▋      | 86/236 [05:22<07:23,  2.96s/it]
test ppl:  37%|███▋      | 87/236 [05:24<06:41,  2.69s/it]
test ppl:  37%|███▋      | 88/236 [05:30<08:57,  3.63s/it]
test ppl:  38%|███▊      | 89/236 [05:36<10:30,  4.29s/it]
test ppl:  38%|███▊      | 90/236 [05:42<11:32,  4.75s/it]
test ppl:  39%|███▊      | 91/236 [05:47<11:32,  4.78s/it]
test ppl:  39%|███▉      | 92/236 [05:49<10:01,  4.18s/it]
test ppl:  39%|███▉      | 93/236 [05:55<11:07,  4.67s/it]
test ppl:  40%|███▉      | 94/236 [06:01<11:51,  5.01s/it]
test ppl:  40%|████      | 95/236 [06:04<10:13,  4.35s/it]
test ppl:  41%|████      | 96/236 [06:07<09:08,  3.92s/it]
test ppl:  41%|████      | 97/236 [06:13<10:23,  4.48s/it]
test ppl:  42%|████▏     | 98/236 [06:18<11:13,  4.88s/it]
test ppl:  42%|████▏     | 99/236 [06:24<11:46,  5.16s/it]
test ppl:  42%|████▏     | 100/236 [06:26<09:04,  4.01s/it]
test ppl:  43%|████▎     | 101/236 [06:31<10:13,  4.54s/it]
test ppl:  43%|████▎     | 102/236 [06:35<09:30,  4.26s/it]
test ppl:  44%|████▎     | 103/236 [06:37<07:45,  3.50s/it]
test ppl:  44%|████▍     | 104/236 [06:41<08:10,  3.71s/it]
test ppl:  44%|████▍     | 105/236 [06:45<08:14,  3.78s/it]
test ppl:  45%|████▍     | 106/236 [06:50<09:11,  4.24s/it]
test ppl:  45%|████▌     | 107/236 [06:52<07:53,  3.67s/it]
test ppl:  46%|████▌     | 108/236 [06:58<09:05,  4.26s/it]
test ppl:  46%|████▌     | 109/236 [07:02<08:49,  4.17s/it]
test ppl:  47%|████▋     | 110/236 [07:05<07:40,  3.66s/it]
test ppl:  47%|████▋     | 111/236 [07:08<07:47,  3.74s/it]
test ppl:  47%|████▋     | 112/236 [07:12<07:29,  3.62s/it]
test ppl:  48%|████▊     | 113/236 [07:14<06:16,  3.06s/it]
test ppl:  48%|████▊     | 114/236 [07:18<07:11,  3.53s/it]
test ppl:  49%|████▊     | 115/236 [07:24<08:29,  4.21s/it]
test ppl:  49%|████▉     | 116/236 [07:30<09:23,  4.69s/it]
test ppl:  50%|████▉     | 117/236 [07:32<07:36,  3.84s/it]
test ppl:  50%|█████     | 118/236 [07:36<07:47,  3.96s/it]
test ppl:  50%|█████     | 119/236 [07:39<07:19,  3.75s/it]
test ppl:  51%|█████     | 120/236 [07:40<05:50,  3.02s/it]
test ppl:  51%|█████▏    | 121/236 [07:46<07:22,  3.85s/it]
test ppl:  52%|█████▏    | 122/236 [07:51<07:48,  4.11s/it]
test ppl:  52%|█████▏    | 123/236 [07:53<06:37,  3.52s/it]
test ppl:  53%|█████▎    | 124/236 [07:56<06:07,  3.28s/it]
test ppl:  53%|█████▎    | 125/236 [08:02<07:28,  4.04s/it]
test ppl:  53%|█████▎    | 126/236 [08:05<07:11,  3.92s/it]
test ppl:  54%|█████▍    | 127/236 [08:07<06:07,  3.37s/it]
test ppl:  54%|█████▍    | 128/236 [08:10<05:27,  3.03s/it]
test ppl:  55%|█████▍    | 129/236 [08:12<05:18,  2.98s/it]
test ppl:  55%|█████▌    | 130/236 [08:16<05:20,  3.02s/it]
test ppl:  56%|█████▌    | 131/236 [08:21<06:45,  3.86s/it]
test ppl:  56%|█████▌    | 132/236 [08:24<05:57,  3.44s/it]
test ppl:  56%|█████▋    | 133/236 [08:28<06:07,  3.57s/it]
test ppl:  57%|█████▋    | 134/236 [08:33<07:03,  4.15s/it]
test ppl:  57%|█████▋    | 135/236 [08:38<07:06,  4.22s/it]
test ppl:  58%|█████▊    | 136/236 [08:39<05:33,  3.33s/it]
test ppl:  58%|█████▊    | 137/236 [08:45<06:44,  4.09s/it]
test ppl:  58%|█████▊    | 138/236 [08:48<06:13,  3.81s/it]
test ppl:  59%|█████▉    | 139/236 [08:50<05:33,  3.44s/it]
test ppl:  59%|█████▉    | 140/236 [08:52<04:39,  2.91s/it]
test ppl:  60%|█████▉    | 141/236 [08:55<04:35,  2.90s/it]
test ppl:  60%|██████    | 142/236 [08:57<04:09,  2.65s/it]
test ppl:  61%|██████    | 143/236 [09:03<05:35,  3.61s/it]
test ppl:  61%|██████    | 144/236 [09:06<05:07,  3.34s/it]
test ppl:  61%|██████▏   | 145/236 [09:11<06:08,  4.05s/it]
test ppl:  62%|██████▏   | 146/236 [09:16<06:21,  4.24s/it]
test ppl:  62%|██████▏   | 147/236 [09:22<06:59,  4.71s/it]
test ppl:  63%|██████▎   | 148/236 [09:28<07:26,  5.08s/it]
test ppl:  63%|██████▎   | 149/236 [09:31<06:35,  4.55s/it]
test ppl:  64%|██████▎   | 150/236 [09:37<07:05,  4.94s/it]
test ppl:  64%|██████▍   | 151/236 [09:43<07:22,  5.20s/it]
test ppl:  64%|██████▍   | 152/236 [09:49<07:32,  5.38s/it]
test ppl:  65%|██████▍   | 153/236 [09:54<07:28,  5.40s/it]
test ppl:  65%|██████▌   | 154/236 [09:57<06:11,  4.53s/it]
test ppl:  66%|██████▌   | 155/236 [09:59<05:19,  3.94s/it]
test ppl:  66%|██████▌   | 156/236 [10:01<04:32,  3.40s/it]
test ppl:  67%|██████▋   | 157/236 [10:03<04:00,  3.04s/it]
test ppl:  67%|██████▋   | 158/236 [10:09<05:02,  3.87s/it]
test ppl:  67%|██████▋   | 159/236 [10:15<05:42,  4.45s/it]
test ppl:  68%|██████▊   | 160/236 [10:16<04:23,  3.46s/it]
test ppl:  68%|██████▊   | 161/236 [10:18<03:32,  2.83s/it]
test ppl:  69%|██████▊   | 162/236 [10:21<03:35,  2.91s/it]
test ppl:  69%|██████▉   | 163/236 [10:23<03:23,  2.79s/it]
test ppl:  69%|██████▉   | 164/236 [10:27<03:48,  3.17s/it]
test ppl:  70%|██████▉   | 165/236 [10:31<04:03,  3.44s/it]
test ppl:  70%|███████   | 166/236 [10:33<03:27,  2.97s/it]
test ppl:  71%|███████   | 167/236 [10:35<02:53,  2.52s/it]
test ppl:  71%|███████   | 168/236 [10:40<03:57,  3.50s/it]
test ppl:  72%|███████▏  | 169/236 [10:46<04:31,  4.05s/it]
test ppl:  72%|███████▏  | 170/236 [10:52<05:03,  4.59s/it]
test ppl:  72%|███████▏  | 171/236 [10:53<03:54,  3.61s/it]
test ppl:  73%|███████▎  | 172/236 [10:59<04:33,  4.27s/it]
test ppl:  73%|███████▎  | 173/236 [11:02<04:12,  4.02s/it]
test ppl:  74%|███████▎  | 174/236 [11:08<04:42,  4.55s/it]
test ppl:  74%|███████▍  | 175/236 [11:10<03:47,  3.73s/it]
test ppl:  75%|███████▍  | 176/236 [11:15<04:09,  4.16s/it]
test ppl:  75%|███████▌  | 177/236 [11:21<04:34,  4.66s/it]
test ppl:  75%|███████▌  | 178/236 [11:27<04:51,  5.02s/it]
test ppl:  76%|███████▌  | 179/236 [11:32<05:00,  5.26s/it]
test ppl:  76%|███████▋  | 180/236 [11:37<04:42,  5.05s/it]
test ppl:  77%|███████▋  | 181/236 [11:43<04:49,  5.27s/it]
test ppl:  77%|███████▋  | 182/236 [11:45<03:49,  4.25s/it]
test ppl:  78%|███████▊  | 183/236 [11:47<03:13,  3.65s/it]
test ppl:  78%|███████▊  | 184/236 [11:48<02:33,  2.96s/it]
test ppl:  78%|███████▊  | 185/236 [11:52<02:42,  3.19s/it]
test ppl:  79%|███████▉  | 186/236 [11:54<02:21,  2.83s/it]
test ppl:  79%|███████▉  | 187/236 [12:00<03:03,  3.74s/it]
test ppl:  80%|███████▉  | 188/236 [12:06<03:29,  4.37s/it]
test ppl:  80%|████████  | 189/236 [12:12<03:45,  4.81s/it]
test ppl:  81%|████████  | 190/236 [12:16<03:32,  4.62s/it]
test ppl:  81%|████████  | 191/236 [12:20<03:23,  4.53s/it]
test ppl:  81%|████████▏ | 192/236 [12:23<02:53,  3.95s/it]
test ppl:  82%|████████▏ | 193/236 [12:28<03:13,  4.51s/it]
test ppl:  82%|████████▏ | 194/236 [12:31<02:45,  3.93s/it]
test ppl:  83%|████████▎ | 195/236 [12:34<02:30,  3.66s/it]
test ppl:  83%|████████▎ | 196/236 [12:36<02:06,  3.17s/it]
test ppl:  83%|████████▎ | 197/236 [12:38<01:51,  2.85s/it]
test ppl:  84%|████████▍ | 198/236 [12:44<02:21,  3.74s/it]
test ppl:  84%|████████▍ | 199/236 [12:47<02:06,  3.42s/it]
test ppl:  85%|████████▍ | 200/236 [12:52<02:28,  4.13s/it]
test ppl:  85%|████████▌ | 201/236 [12:54<02:02,  3.49s/it]
test ppl:  86%|████████▌ | 202/236 [13:00<02:22,  4.18s/it]
test ppl:  86%|████████▌ | 203/236 [13:06<02:34,  4.67s/it]
test ppl:  86%|████████▋ | 204/236 [13:07<01:58,  3.71s/it]
test ppl:  87%|████████▋ | 205/236 [13:13<02:15,  4.36s/it]
test ppl:  87%|████████▋ | 206/236 [13:17<02:01,  4.03s/it]
test ppl:  88%|████████▊ | 207/236 [13:22<02:12,  4.57s/it]
test ppl:  88%|████████▊ | 208/236 [13:26<01:58,  4.24s/it]
test ppl:  89%|████████▊ | 209/236 [13:32<02:07,  4.73s/it]
test ppl:  89%|████████▉ | 210/236 [13:34<01:44,  4.01s/it]
test ppl:  89%|████████▉ | 211/236 [13:38<01:37,  3.92s/it]
test ppl:  90%|████████▉ | 212/236 [13:44<01:47,  4.48s/it]
test ppl:  90%|█████████ | 213/236 [13:49<01:52,  4.87s/it]
test ppl:  91%|█████████ | 214/236 [13:51<01:23,  3.81s/it]
test ppl:  91%|█████████ | 215/236 [13:57<01:32,  4.41s/it]
test ppl:  92%|█████████▏| 216/236 [13:58<01:11,  3.58s/it]
test ppl:  92%|█████████▏| 217/236 [14:04<01:21,  4.28s/it]
test ppl:  92%|█████████▏| 218/236 [14:06<01:04,  3.58s/it]
test ppl:  93%|█████████▎| 219/236 [14:12<01:12,  4.26s/it]
test ppl:  93%|█████████▎| 220/236 [14:18<01:15,  4.73s/it]
test ppl:  94%|█████████▎| 221/236 [14:20<01:01,  4.10s/it]
test ppl:  94%|█████████▍| 222/236 [14:26<01:04,  4.62s/it]
test ppl:  94%|█████████▍| 223/236 [14:32<01:04,  4.99s/it]
test ppl:  95%|█████████▍| 224/236 [14:34<00:47,  3.96s/it]
test ppl:  95%|█████████▌| 225/236 [14:40<00:50,  4.57s/it]
test ppl:  96%|█████████▌| 226/236 [14:43<00:42,  4.28s/it]
test ppl:  96%|█████████▌| 227/236 [14:46<00:34,  3.84s/it]
test ppl:  97%|█████████▋| 228/236 [14:48<00:26,  3.26s/it]
test ppl:  97%|█████████▋| 229/236 [14:54<00:28,  4.02s/it]
test ppl:  97%|█████████▋| 230/236 [14:57<00:23,  3.86s/it]
test ppl:  98%|█████████▊| 231/236 [15:01<00:18,  3.70s/it]
test ppl:  98%|█████████▊| 232/236 [15:02<00:12,  3.16s/it]
test ppl:  99%|█████████▊| 233/236 [15:05<00:08,  2.85s/it]
test ppl:  99%|█████████▉| 234/236 [15:06<00:04,  2.36s/it]
test ppl: 100%|█████████▉| 235/236 [15:12<00:03,  3.40s/it]
test ppl: 100%|██████████| 236/236 [15:12<00:00,  2.57s/it]
test ppl: 100%|██████████| 236/236 [15:12<00:00,  3.87s/it]
10/13/2024 01:34:27 - INFO - __main__ -    em: 0.2067
10/13/2024 01:34:27 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/64_0.4_80_eval_results.json
64 0.4 80:  em: 0.2067

--------------------------------------------------------------------------------
Running experiment with knn_temp=80, lmbda=0.6, k=16
2024-10-13 01:34:34.325772: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-13 01:34:34.345569: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-13 01:34:34.367763: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-13 01:34:34.374538: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-13 01:34:34.390724: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-13 01:34:35.389409: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/13/2024 01:34:36 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=16, lmbda=0.6, knn_temp=80, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/13/2024 01:34:36 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:47:31,  2.18it/s]
Adding feature api:   4%|▍         | 7059/187062 [00:00<00:10, 16785.24it/s]
Adding feature api:   8%|▊         | 15443/187062 [00:00<00:05, 33787.00it/s]
Adding feature api:  13%|█▎        | 23893/187062 [00:00<00:03, 47270.64it/s]
Adding feature api:  17%|█▋        | 32310/187062 [00:00<00:02, 57426.97it/s]
Adding feature api:  22%|██▏       | 40533/187062 [00:00<00:02, 64426.53it/s]
Adding feature api:  26%|██▌       | 48985/187062 [00:01<00:01, 70199.96it/s]
Adding feature api:  31%|███       | 57436/187062 [00:01<00:01, 74362.02it/s]
Adding feature api:  35%|███▌      | 65861/187062 [00:01<00:01, 77263.45it/s]
Adding feature api:  40%|███▉      | 74086/187062 [00:01<00:01, 77717.63it/s]
Adding feature api:  44%|████▍     | 82203/187062 [00:01<00:01, 76653.89it/s]
Adding feature api:  48%|████▊     | 90111/187062 [00:01<00:01, 75985.29it/s]
Adding feature api:  52%|█████▏    | 97878/187062 [00:01<00:01, 75510.25it/s]
Adding feature api:  56%|█████▋    | 105546/187062 [00:01<00:01, 74610.53it/s]
Adding feature api:  60%|██████    | 113089/187062 [00:01<00:00, 74482.02it/s]
Adding feature api:  64%|██████▍   | 120594/187062 [00:01<00:00, 74473.49it/s]
Adding feature api:  68%|██████▊   | 128081/187062 [00:02<00:00, 74358.27it/s]
Adding feature api:  73%|███████▎  | 136348/187062 [00:02<00:00, 76456.71it/s]
Adding feature api:  77%|███████▋  | 144860/187062 [00:02<00:00, 79012.94it/s]
Adding feature api:  82%|████████▏ | 153365/187062 [00:02<00:00, 80803.66it/s]
Adding feature api:  87%|████████▋ | 161898/187062 [00:02<00:00, 82150.14it/s]
Adding feature api:  91%|█████████ | 170328/187062 [00:02<00:00, 82790.43it/s]
Adding feature api:  95%|█████████▌| 178616/187062 [00:02<00:00, 77772.68it/s]
Adding feature api: 100%|█████████▉| 186461/187062 [00:02<00:00, 52885.91it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 62372.91it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<24:48:36,  2.09it/s]
Adding feature datatype:   4%|▍         | 7082/187062 [00:00<00:11, 16308.22it/s]
Adding feature datatype:   8%|▊         | 15204/187062 [00:00<00:05, 32375.64it/s]
Adding feature datatype:  12%|█▏        | 23054/187062 [00:00<00:03, 44424.66it/s]
Adding feature datatype:  17%|█▋        | 31244/187062 [00:00<00:02, 54608.88it/s]
Adding feature datatype:  21%|██        | 39468/187062 [00:00<00:02, 62334.10it/s]
Adding feature datatype:  25%|██▌       | 47680/187062 [00:01<00:02, 67981.42it/s]
Adding feature datatype:  30%|██▉       | 55908/187062 [00:01<00:01, 72121.13it/s]
Adding feature datatype:  34%|███▍      | 64086/187062 [00:01<00:01, 74946.05it/s]
Adding feature datatype:  39%|███▊      | 72091/187062 [00:01<00:01, 76078.32it/s]
Adding feature datatype:  43%|████▎     | 80279/187062 [00:01<00:01, 77788.91it/s]
Adding feature datatype:  47%|████▋     | 88443/187062 [00:01<00:01, 78928.56it/s]
Adding feature datatype:  52%|█████▏    | 96655/187062 [00:01<00:01, 79875.58it/s]
Adding feature datatype:  56%|█████▌    | 104770/187062 [00:01<00:01, 79553.04it/s]
Adding feature datatype:  60%|██████    | 112988/187062 [00:01<00:00, 80330.53it/s]
Adding feature datatype:  65%|██████▍   | 121214/187062 [00:01<00:00, 80903.79it/s]
Adding feature datatype:  69%|██████▉   | 129373/187062 [00:02<00:00, 81107.80it/s]
Adding feature datatype:  74%|███████▎  | 137516/187062 [00:02<00:00, 80385.99it/s]
Adding feature datatype:  78%|███████▊  | 145726/187062 [00:02<00:00, 80894.08it/s]
Adding feature datatype:  82%|████████▏ | 153939/187062 [00:02<00:00, 81260.73it/s]
Adding feature datatype:  87%|████████▋ | 162114/187062 [00:02<00:00, 81405.69it/s]
Adding feature datatype:  91%|█████████ | 170264/187062 [00:02<00:00, 81413.42it/s]
Adding feature datatype:  95%|█████████▌| 178412/187062 [00:02<00:00, 77477.75it/s]
Adding feature datatype: 100%|█████████▉| 186204/187062 [00:02<00:00, 52383.53it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 62425.62it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:43:25,  2.19it/s]
Adding feature literal:   4%|▍         | 7121/187062 [00:00<00:10, 16969.80it/s]
Adding feature literal:   8%|▊         | 15205/187062 [00:00<00:05, 33190.91it/s]
Adding feature literal:  12%|█▏        | 23349/187062 [00:00<00:03, 46035.89it/s]
Adding feature literal:  17%|█▋        | 31525/187062 [00:00<00:02, 55877.97it/s]
Adding feature literal:  21%|██        | 39671/187062 [00:00<00:02, 63102.60it/s]
Adding feature literal:  26%|██▌       | 47852/187062 [00:01<00:02, 68478.99it/s]
Adding feature literal:  30%|██▉       | 56057/187062 [00:01<00:01, 72428.59it/s]
Adding feature literal:  34%|███▍      | 64274/187062 [00:01<00:01, 75287.82it/s]
Adding feature literal:  39%|███▊      | 72482/187062 [00:01<00:01, 77293.38it/s]
Adding feature literal:  43%|████▎     | 80555/187062 [00:01<00:01, 77081.86it/s]
Adding feature literal:  47%|████▋     | 88775/187062 [00:01<00:01, 78587.28it/s]
Adding feature literal:  52%|█████▏    | 96918/187062 [00:01<00:01, 79427.43it/s]
Adding feature literal:  56%|█████▌    | 105095/187062 [00:01<00:01, 80122.20it/s]
Adding feature literal:  61%|██████    | 113303/187062 [00:01<00:00, 80705.00it/s]
Adding feature literal:  65%|██████▍   | 121512/187062 [00:01<00:00, 81117.97it/s]
Adding feature literal:  69%|██████▉   | 129681/187062 [00:02<00:00, 81285.35it/s]
Adding feature literal:  74%|███████▎  | 137851/187062 [00:02<00:00, 81406.64it/s]
Adding feature literal:  78%|███████▊  | 146013/187062 [00:02<00:00, 81467.90it/s]
Adding feature literal:  82%|████████▏ | 154221/187062 [00:02<00:00, 81650.29it/s]
Adding feature literal:  87%|████████▋ | 162401/187062 [00:02<00:00, 81692.86it/s]
Adding feature literal:  91%|█████████ | 170631/187062 [00:02<00:00, 81872.69it/s]
Adding feature literal:  96%|█████████▌| 178824/187062 [00:02<00:00, 76051.14it/s]
Adding feature literal: 100%|█████████▉| 186516/187062 [00:02<00:00, 52164.79it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63039.33it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:42:57,  2.19it/s]
Adding feature operator:   4%|▍         | 7119/187062 [00:00<00:10, 16969.45it/s]
Adding feature operator:   8%|▊         | 15200/187062 [00:00<00:05, 33186.06it/s]
Adding feature operator:  13%|█▎        | 23410/187062 [00:00<00:03, 46208.76it/s]
Adding feature operator:  17%|█▋        | 31640/187062 [00:00<00:02, 56152.90it/s]
Adding feature operator:  21%|██▏       | 39863/187062 [00:00<00:02, 63516.86it/s]
Adding feature operator:  26%|██▌       | 48072/187062 [00:01<00:02, 68854.34it/s]
Adding feature operator:  30%|███       | 56313/187062 [00:01<00:01, 72798.13it/s]
Adding feature operator:  34%|███▍      | 64481/187062 [00:01<00:01, 75403.99it/s]
Adding feature operator:  39%|███▉      | 72604/187062 [00:01<00:01, 77122.98it/s]
Adding feature operator:  43%|████▎     | 80797/187062 [00:01<00:01, 78548.94it/s]
Adding feature operator:  48%|████▊     | 89024/187062 [00:01<00:01, 79654.63it/s]
Adding feature operator:  52%|█████▏    | 97253/187062 [00:01<00:01, 80439.24it/s]
Adding feature operator:  56%|█████▋    | 105503/187062 [00:01<00:01, 81051.72it/s]
Adding feature operator:  61%|██████    | 113770/187062 [00:01<00:00, 81534.41it/s]
Adding feature operator:  65%|██████▌   | 121998/187062 [00:01<00:00, 81756.01it/s]
Adding feature operator:  70%|██████▉   | 130216/187062 [00:02<00:00, 81754.06it/s]
Adding feature operator:  74%|███████▍  | 138430/187062 [00:02<00:00, 81866.36it/s]
Adding feature operator:  78%|███████▊  | 146679/187062 [00:02<00:00, 82050.46it/s]
Adding feature operator:  83%|████████▎ | 154927/187062 [00:02<00:00, 82176.10it/s]
Adding feature operator:  87%|████████▋ | 163155/187062 [00:02<00:00, 81834.46it/s]
Adding feature operator:  92%|█████████▏| 171346/187062 [00:02<00:00, 81815.14it/s]
Adding feature operator:  96%|█████████▌| 179533/187062 [00:02<00:00, 72751.80it/s]
Adding feature operator: 100%|█████████▉| 186997/187062 [00:02<00:00, 51753.34it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63319.98it/s]
[2024-10-13 01:35:20,636] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/13/2024 01:35:22 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/13/2024 01:35:22 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 43/6548 [00:00<00:15, 417.78 examples/s]
Map:   2%|▏         | 108/6548 [00:00<00:25, 251.67 examples/s]
Map:   2%|▏         | 152/6548 [00:00<00:21, 301.26 examples/s]
Map:   3%|▎         | 197/6548 [00:00<00:19, 326.20 examples/s]
Map:   4%|▍         | 247/6548 [00:00<00:17, 367.64 examples/s]
Map:   5%|▍         | 302/6548 [00:00<00:18, 337.74 examples/s]
Map:   5%|▌         | 351/6548 [00:01<00:18, 328.69 examples/s]
Map:   6%|▌         | 399/6548 [00:01<00:16, 362.37 examples/s]
Map:   7%|▋         | 456/6548 [00:01<00:16, 362.83 examples/s]
Map:   8%|▊         | 511/6548 [00:01<00:16, 358.59 examples/s]
Map:   9%|▊         | 565/6548 [00:01<00:15, 397.09 examples/s]
Map:   9%|▉         | 618/6548 [00:01<00:16, 365.07 examples/s]
Map:  10%|█         | 666/6548 [00:01<00:17, 340.92 examples/s]
Map:  11%|█         | 710/6548 [00:02<00:16, 360.63 examples/s]
Map:  12%|█▏        | 758/6548 [00:02<00:15, 384.82 examples/s]
Map:  12%|█▏        | 813/6548 [00:02<00:13, 419.11 examples/s]
Map:  13%|█▎        | 876/6548 [00:02<00:13, 410.29 examples/s]
Map:  14%|█▍        | 931/6548 [00:02<00:14, 390.01 examples/s]
Map:  15%|█▌        | 985/6548 [00:02<00:15, 369.25 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:22, 250.17 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:20, 271.53 examples/s]
Map:  17%|█▋        | 1122/6548 [00:03<00:17, 305.03 examples/s]
Map:  18%|█▊        | 1162/6548 [00:03<00:16, 323.71 examples/s]
Map:  18%|█▊        | 1205/6548 [00:03<00:15, 345.31 examples/s]
Map:  19%|█▉        | 1262/6548 [00:03<00:14, 354.65 examples/s]
Map:  20%|█▉        | 1301/6548 [00:03<00:14, 361.40 examples/s]
Map:  21%|██        | 1348/6548 [00:03<00:15, 339.70 examples/s]
Map:  21%|██        | 1387/6548 [00:04<00:16, 310.27 examples/s]
Map:  22%|██▏       | 1430/6548 [00:04<00:15, 330.87 examples/s]
Map:  23%|██▎       | 1474/6548 [00:04<00:17, 284.03 examples/s]
Map:  23%|██▎       | 1510/6548 [00:04<00:16, 296.99 examples/s]
Map:  24%|██▎       | 1542/6548 [00:04<00:17, 292.68 examples/s]
Map:  24%|██▍       | 1576/6548 [00:04<00:16, 303.95 examples/s]
Map:  25%|██▍       | 1611/6548 [00:04<00:17, 275.58 examples/s]
Map:  25%|██▌       | 1640/6548 [00:04<00:17, 276.11 examples/s]
Map:  26%|██▌       | 1684/6548 [00:05<00:19, 249.13 examples/s]
Map:  26%|██▋       | 1724/6548 [00:05<00:17, 282.22 examples/s]
Map:  27%|██▋       | 1767/6548 [00:05<00:15, 309.66 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 325.67 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:13, 339.45 examples/s]
Map:  29%|██▉       | 1906/6548 [00:05<00:13, 338.15 examples/s]
Map:  30%|██▉       | 1947/6548 [00:05<00:13, 351.88 examples/s]
Map:  30%|███       | 1984/6548 [00:06<00:12, 352.67 examples/s]
Map:  31%|███       | 2031/6548 [00:06<00:20, 220.58 examples/s]
Map:  32%|███▏      | 2071/6548 [00:06<00:17, 252.54 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 263.20 examples/s]
Map:  33%|███▎      | 2141/6548 [00:06<00:17, 257.40 examples/s]
Map:  33%|███▎      | 2191/6548 [00:06<00:15, 276.12 examples/s]
Map:  34%|███▍      | 2229/6548 [00:07<00:15, 277.72 examples/s]
Map:  35%|███▍      | 2271/6548 [00:07<00:15, 272.10 examples/s]
Map:  35%|███▌      | 2310/6548 [00:07<00:14, 294.63 examples/s]
Map:  36%|███▌      | 2350/6548 [00:07<00:13, 319.31 examples/s]
Map:  37%|███▋      | 2402/6548 [00:07<00:12, 326.66 examples/s]
Map:  37%|███▋      | 2438/6548 [00:07<00:13, 313.23 examples/s]
Map:  38%|███▊      | 2472/6548 [00:07<00:12, 317.96 examples/s]
Map:  38%|███▊      | 2511/6548 [00:07<00:12, 335.71 examples/s]
Map:  39%|███▉      | 2553/6548 [00:07<00:11, 351.06 examples/s]
Map:  40%|███▉      | 2598/6548 [00:08<00:10, 375.93 examples/s]
Map:  40%|████      | 2639/6548 [00:08<00:10, 382.34 examples/s]
Map:  41%|████      | 2698/6548 [00:08<00:10, 365.32 examples/s]
Map:  42%|████▏     | 2737/6548 [00:08<00:10, 356.62 examples/s]
Map:  42%|████▏     | 2775/6548 [00:08<00:10, 359.86 examples/s]
Map:  43%|████▎     | 2826/6548 [00:08<00:10, 346.05 examples/s]
Map:  44%|████▍     | 2879/6548 [00:08<00:12, 294.83 examples/s]
Map:  45%|████▍     | 2922/6548 [00:09<00:13, 269.58 examples/s]
Map:  45%|████▌     | 2964/6548 [00:09<00:12, 292.78 examples/s]
Map:  46%|████▌     | 3000/6548 [00:09<00:21, 167.83 examples/s]
Map:  46%|████▌     | 3027/6548 [00:09<00:19, 181.93 examples/s]
Map:  47%|████▋     | 3062/6548 [00:09<00:16, 209.87 examples/s]
Map:  47%|████▋     | 3098/6548 [00:10<00:14, 238.60 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:12, 268.08 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:12, 261.15 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:13, 255.10 examples/s]
Map:  49%|████▉     | 3238/6548 [00:10<00:12, 274.01 examples/s]
Map:  50%|████▉     | 3272/6548 [00:10<00:11, 286.91 examples/s]
Map:  50%|█████     | 3305/6548 [00:10<00:10, 296.32 examples/s]
Map:  51%|█████     | 3348/6548 [00:10<00:10, 317.74 examples/s]
Map:  52%|█████▏    | 3390/6548 [00:11<00:10, 295.29 examples/s]
Map:  52%|█████▏    | 3431/6548 [00:11<00:10, 285.50 examples/s]
Map:  53%|█████▎    | 3461/6548 [00:11<00:12, 256.42 examples/s]
Map:  53%|█████▎    | 3495/6548 [00:11<00:11, 274.47 examples/s]
Map:  54%|█████▍    | 3545/6548 [00:11<00:09, 327.21 examples/s]
Map:  55%|█████▍    | 3591/6548 [00:11<00:08, 359.15 examples/s]
Map:  56%|█████▌    | 3637/6548 [00:11<00:07, 383.91 examples/s]
Map:  56%|█████▋    | 3697/6548 [00:11<00:07, 382.19 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:12<00:07, 389.66 examples/s]
Map:  58%|█████▊    | 3793/6548 [00:12<00:07, 375.73 examples/s]
Map:  59%|█████▊    | 3832/6548 [00:12<00:08, 330.23 examples/s]
Map:  59%|█████▉    | 3882/6548 [00:12<00:08, 319.76 examples/s]
Map:  60%|█████▉    | 3918/6548 [00:12<00:08, 322.71 examples/s]
Map:  60%|██████    | 3956/6548 [00:12<00:07, 334.35 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 236.35 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 291.68 examples/s]
Map:  63%|██████▎   | 4095/6548 [00:13<00:07, 314.74 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 325.26 examples/s]
Map:  64%|██████▍   | 4185/6548 [00:13<00:07, 307.47 examples/s]
Map:  65%|██████▍   | 4237/6548 [00:13<00:07, 311.21 examples/s]
Map:  65%|██████▌   | 4286/6548 [00:13<00:06, 349.40 examples/s]
Map:  66%|██████▌   | 4326/6548 [00:13<00:06, 361.13 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:14<00:06, 349.68 examples/s]
Map:  68%|██████▊   | 4428/6548 [00:14<00:05, 364.78 examples/s]
Map:  68%|██████▊   | 4470/6548 [00:14<00:06, 334.26 examples/s]
Map:  69%|██████▉   | 4516/6548 [00:14<00:06, 322.23 examples/s]
Map:  70%|██████▉   | 4573/6548 [00:14<00:05, 334.00 examples/s]
Map:  70%|███████   | 4610/6548 [00:14<00:05, 333.80 examples/s]
Map:  71%|███████   | 4658/6548 [00:14<00:05, 366.75 examples/s]
Map:  72%|███████▏  | 4712/6548 [00:15<00:05, 355.80 examples/s]
Map:  73%|███████▎  | 4751/6548 [00:15<00:04, 359.78 examples/s]
Map:  73%|███████▎  | 4808/6548 [00:15<00:04, 409.82 examples/s]
Map:  74%|███████▍  | 4851/6548 [00:15<00:04, 398.57 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 373.31 examples/s]
Map:  76%|███████▌  | 4958/6548 [00:15<00:03, 411.88 examples/s]
Map:  77%|███████▋  | 5013/6548 [00:16<00:06, 245.09 examples/s]
Map:  77%|███████▋  | 5055/6548 [00:16<00:05, 274.20 examples/s]
Map:  78%|███████▊  | 5101/6548 [00:16<00:05, 282.41 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 289.04 examples/s]
Map:  80%|███████▉  | 5207/6548 [00:16<00:04, 296.22 examples/s]
Map:  80%|████████  | 5246/6548 [00:16<00:04, 312.22 examples/s]
Map:  81%|████████  | 5286/6548 [00:16<00:03, 327.99 examples/s]
Map:  81%|████████▏ | 5335/6548 [00:16<00:03, 321.02 examples/s]
Map:  82%|████████▏ | 5388/6548 [00:17<00:03, 319.56 examples/s]
Map:  83%|████████▎ | 5430/6548 [00:17<00:03, 303.25 examples/s]
Map:  84%|████████▎ | 5472/6548 [00:17<00:03, 324.97 examples/s]
Map:  84%|████████▍ | 5509/6548 [00:17<00:03, 329.73 examples/s]
Map:  85%|████████▍ | 5552/6548 [00:17<00:02, 354.48 examples/s]
Map:  86%|████████▌ | 5610/6548 [00:17<00:02, 318.67 examples/s]
Map:  86%|████████▌ | 5647/6548 [00:17<00:02, 325.82 examples/s]
Map:  87%|████████▋ | 5697/6548 [00:18<00:02, 317.02 examples/s]
Map:  88%|████████▊ | 5740/6548 [00:18<00:02, 337.75 examples/s]
Map:  88%|████████▊ | 5781/6548 [00:18<00:02, 343.86 examples/s]
Map:  89%|████████▉ | 5825/6548 [00:18<00:02, 345.69 examples/s]
Map:  90%|████████▉ | 5864/6548 [00:18<00:01, 355.84 examples/s]
Map:  90%|█████████ | 5901/6548 [00:18<00:01, 359.12 examples/s]
Map:  91%|█████████ | 5939/6548 [00:18<00:01, 351.97 examples/s]
Map:  92%|█████████▏| 5992/6548 [00:18<00:01, 348.81 examples/s]
Map:  92%|█████████▏| 6042/6548 [00:19<00:02, 239.19 examples/s]
Map:  93%|█████████▎| 6074/6548 [00:19<00:01, 252.72 examples/s]
Map:  93%|█████████▎| 6120/6548 [00:19<00:01, 262.53 examples/s]
Map:  94%|█████████▍| 6156/6548 [00:19<00:01, 282.56 examples/s]
Map:  95%|█████████▍| 6190/6548 [00:19<00:01, 292.41 examples/s]
Map:  95%|█████████▌| 6234/6548 [00:19<00:00, 326.71 examples/s]
Map:  96%|█████████▌| 6270/6548 [00:19<00:00, 329.68 examples/s]
Map:  96%|█████████▋| 6310/6548 [00:20<00:00, 333.96 examples/s]
Map:  97%|█████████▋| 6365/6548 [00:20<00:00, 378.10 examples/s]
Map:  98%|█████████▊| 6415/6548 [00:20<00:00, 354.38 examples/s]
Map:  99%|█████████▊| 6462/6548 [00:20<00:00, 381.04 examples/s]
Map:  99%|█████████▉| 6512/6548 [00:20<00:00, 356.62 examples/s]
Map: 100%|██████████| 6548/6548 [00:20<00:00, 314.64 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   3%|▎         | 29/903 [00:00<00:03, 269.37 examples/s]
Map:   7%|▋         | 64/903 [00:00<00:02, 310.84 examples/s]
Map:  11%|█         | 98/903 [00:00<00:02, 312.02 examples/s]
Map:  15%|█▌        | 139/903 [00:00<00:02, 335.68 examples/s]
Map:  21%|██        | 187/903 [00:00<00:01, 382.81 examples/s]
Map:  25%|██▌       | 230/903 [00:00<00:01, 381.89 examples/s]
Map:  30%|███       | 271/903 [00:00<00:01, 387.03 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 383.88 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 322.95 examples/s]
Map:  43%|████▎     | 392/903 [00:01<00:01, 285.43 examples/s]
Map:  48%|████▊     | 433/903 [00:01<00:01, 311.81 examples/s]
Map:  53%|█████▎    | 475/903 [00:01<00:01, 291.64 examples/s]
Map:  59%|█████▊    | 530/903 [00:01<00:01, 313.80 examples/s]
Map:  63%|██████▎   | 570/903 [00:01<00:01, 328.27 examples/s]
Map:  68%|██████▊   | 614/903 [00:01<00:00, 351.85 examples/s]
Map:  72%|███████▏  | 654/903 [00:01<00:00, 360.54 examples/s]
Map:  77%|███████▋  | 697/903 [00:02<00:00, 377.16 examples/s]
Map:  82%|████████▏ | 743/903 [00:02<00:00, 396.60 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 389.94 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 387.97 examples/s]
Map:  98%|█████████▊| 886/903 [00:02<00:00, 375.71 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 320.95 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 36/1882 [00:00<00:06, 281.06 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 350.00 examples/s]
Map:   6%|▌         | 117/1882 [00:00<00:05, 336.86 examples/s]
Map:   9%|▉         | 170/1882 [00:00<00:05, 333.61 examples/s]
Map:  11%|█         | 211/1882 [00:00<00:05, 305.13 examples/s]
Map:  14%|█▍        | 259/1882 [00:00<00:04, 347.42 examples/s]
Map:  16%|█▌        | 304/1882 [00:00<00:04, 328.69 examples/s]
Map:  18%|█▊        | 345/1882 [00:01<00:04, 340.36 examples/s]
Map:  20%|██        | 381/1882 [00:01<00:04, 303.12 examples/s]
Map:  23%|██▎       | 427/1882 [00:01<00:04, 295.31 examples/s]
Map:  25%|██▍       | 469/1882 [00:01<00:04, 311.53 examples/s]
Map:  27%|██▋       | 507/1882 [00:01<00:04, 317.99 examples/s]
Map:  29%|██▉       | 543/1882 [00:01<00:04, 326.05 examples/s]
Map:  31%|███       | 587/1882 [00:01<00:03, 353.40 examples/s]
Map:  34%|███▍      | 644/1882 [00:01<00:03, 407.55 examples/s]
Map:  37%|███▋      | 704/1882 [00:02<00:03, 389.29 examples/s]
Map:  41%|████      | 768/1882 [00:02<00:02, 395.52 examples/s]
Map:  44%|████▍     | 826/1882 [00:02<00:02, 352.79 examples/s]
Map:  46%|████▌     | 867/1882 [00:02<00:02, 359.80 examples/s]
Map:  48%|████▊     | 908/1882 [00:02<00:02, 363.79 examples/s]
Map:  50%|█████     | 948/1882 [00:02<00:02, 370.65 examples/s]
Map:  53%|█████▎    | 990/1882 [00:02<00:02, 382.02 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 242.15 examples/s]
Map:  58%|█████▊    | 1086/1882 [00:03<00:03, 259.54 examples/s]
Map:  60%|█████▉    | 1120/1882 [00:03<00:02, 272.28 examples/s]
Map:  62%|██████▏   | 1172/1882 [00:03<00:02, 292.69 examples/s]
Map:  65%|██████▌   | 1224/1882 [00:03<00:02, 269.14 examples/s]
Map:  67%|██████▋   | 1256/1882 [00:03<00:02, 272.20 examples/s]
Map:  69%|██████▉   | 1304/1882 [00:04<00:01, 315.90 examples/s]
Map:  72%|███████▏  | 1346/1882 [00:04<00:01, 329.34 examples/s]
Map:  74%|███████▍  | 1393/1882 [00:04<00:01, 315.77 examples/s]
Map:  76%|███████▌  | 1431/1882 [00:04<00:01, 287.57 examples/s]
Map:  78%|███████▊  | 1473/1882 [00:04<00:01, 312.12 examples/s]
Map:  80%|████████  | 1506/1882 [00:04<00:01, 276.65 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 265.81 examples/s]
Map:  84%|████████▍ | 1583/1882 [00:05<00:01, 293.82 examples/s]
Map:  86%|████████▋ | 1626/1882 [00:05<00:00, 325.41 examples/s]
Map:  88%|████████▊ | 1663/1882 [00:05<00:00, 325.99 examples/s]
Map:  91%|█████████ | 1713/1882 [00:05<00:00, 323.48 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 279.85 examples/s]
Map:  95%|█████████▍| 1785/1882 [00:05<00:00, 283.30 examples/s]
Map:  97%|█████████▋| 1830/1882 [00:05<00:00, 321.53 examples/s]
Map: 100%|█████████▉| 1875/1882 [00:05<00:00, 350.66 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 307.75 examples/s]
10/13/2024 01:36:24 - INFO - __main__ -     ***** Testing *****
10/13/2024 01:36:24 - INFO - __main__ -     Batch size = 8
10/13/2024 01:36:24 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/13/2024 01:36:24 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/13/2024 01:36:24 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/13/2024 01:36:25 - INFO - knnlm -   Reading datastore took 0.9645650386810303 s
10/13/2024 01:36:26 - INFO - knnlm -   Moving index to GPU took 0.961442232131958 s
10/13/2024 01:36:26 - INFO - __main__ -   ******************************break-into
10/13/2024 01:36:26 - INFO - __main__ -     ***** Running acc evaluation *****
10/13/2024 01:36:26 - INFO - __main__ -     Num examples = 236
10/13/2024 01:36:26 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:40,  7.83s/it]
test ppl:   1%|          | 2/236 [00:09<16:50,  4.32s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:16,  3.16s/it]
test ppl:   2%|▏         | 4/236 [00:13<10:28,  2.71s/it]
test ppl:   2%|▏         | 5/236 [00:20<16:25,  4.27s/it]
test ppl:   3%|▎         | 6/236 [00:27<19:58,  5.21s/it]
test ppl:   3%|▎         | 7/236 [00:29<15:45,  4.13s/it]
test ppl:   3%|▎         | 8/236 [00:33<15:53,  4.18s/it]
test ppl:   4%|▍         | 9/236 [00:39<17:06,  4.52s/it]
test ppl:   4%|▍         | 10/236 [00:42<16:18,  4.33s/it]
test ppl:   5%|▍         | 11/236 [00:46<15:52,  4.23s/it]
test ppl:   5%|▌         | 12/236 [00:52<17:39,  4.73s/it]
test ppl:   6%|▌         | 13/236 [00:58<18:49,  5.07s/it]
test ppl:   6%|▌         | 14/236 [01:04<19:39,  5.31s/it]
test ppl:   6%|▋         | 15/236 [01:06<16:07,  4.38s/it]
test ppl:   7%|▋         | 16/236 [01:08<13:16,  3.62s/it]
test ppl:   7%|▋         | 17/236 [01:14<15:39,  4.29s/it]
test ppl:   8%|▊         | 18/236 [01:20<17:16,  4.75s/it]
test ppl:   8%|▊         | 19/236 [01:26<18:22,  5.08s/it]
test ppl:   8%|▊         | 20/236 [01:28<15:34,  4.33s/it]
test ppl:   9%|▉         | 21/236 [01:31<13:27,  3.76s/it]
test ppl:   9%|▉         | 22/236 [01:36<15:38,  4.39s/it]
test ppl:  10%|▉         | 23/236 [01:40<14:55,  4.20s/it]
test ppl:  10%|█         | 24/236 [01:42<12:43,  3.60s/it]
test ppl:  11%|█         | 25/236 [01:44<10:42,  3.04s/it]
test ppl:  11%|█         | 26/236 [01:50<13:36,  3.89s/it]
test ppl:  11%|█▏        | 27/236 [01:54<13:07,  3.77s/it]
test ppl:  12%|█▏        | 28/236 [01:55<10:23,  3.00s/it]
test ppl:  12%|█▏        | 29/236 [01:57<09:36,  2.79s/it]
test ppl:  13%|█▎        | 30/236 [01:59<08:16,  2.41s/it]
test ppl:  13%|█▎        | 31/236 [02:01<07:47,  2.28s/it]
test ppl:  14%|█▎        | 32/236 [02:03<07:54,  2.33s/it]
test ppl:  14%|█▍        | 33/236 [02:05<07:59,  2.36s/it]
test ppl:  14%|█▍        | 34/236 [02:08<08:03,  2.40s/it]
test ppl:  15%|█▍        | 35/236 [02:10<08:08,  2.43s/it]
test ppl:  15%|█▌        | 36/236 [02:16<11:30,  3.45s/it]
test ppl:  16%|█▌        | 37/236 [02:22<13:50,  4.17s/it]
test ppl:  16%|█▌        | 38/236 [02:24<11:40,  3.54s/it]
test ppl:  17%|█▋        | 39/236 [02:26<09:53,  3.01s/it]
test ppl:  17%|█▋        | 40/236 [02:28<08:27,  2.59s/it]
test ppl:  17%|█▋        | 41/236 [02:29<07:41,  2.37s/it]
test ppl:  18%|█▊        | 42/236 [02:35<11:03,  3.42s/it]
test ppl:  18%|█▊        | 43/236 [02:41<13:20,  4.15s/it]
test ppl:  19%|█▊        | 44/236 [02:43<11:31,  3.60s/it]
test ppl:  19%|█▉        | 45/236 [02:45<09:46,  3.07s/it]
test ppl:  19%|█▉        | 46/236 [02:51<12:22,  3.91s/it]
test ppl:  20%|█▉        | 47/236 [02:53<10:03,  3.19s/it]
test ppl:  20%|██        | 48/236 [02:59<12:29,  3.99s/it]
test ppl:  21%|██        | 49/236 [03:02<12:13,  3.92s/it]
test ppl:  21%|██        | 50/236 [03:08<14:02,  4.53s/it]
test ppl:  22%|██▏       | 51/236 [03:14<15:12,  4.93s/it]
test ppl:  22%|██▏       | 52/236 [03:20<15:58,  5.21s/it]
test ppl:  22%|██▏       | 53/236 [03:23<13:53,  4.55s/it]
test ppl:  23%|██▎       | 54/236 [03:25<11:03,  3.65s/it]
test ppl:  23%|██▎       | 55/236 [03:30<12:53,  4.27s/it]
test ppl:  24%|██▎       | 56/236 [03:34<12:01,  4.01s/it]
test ppl:  24%|██▍       | 57/236 [03:36<10:25,  3.50s/it]
test ppl:  25%|██▍       | 58/236 [03:38<09:17,  3.13s/it]
test ppl:  25%|██▌       | 59/236 [03:44<11:38,  3.95s/it]
test ppl:  25%|██▌       | 60/236 [03:47<10:51,  3.70s/it]
test ppl:  26%|██▌       | 61/236 [03:53<12:40,  4.35s/it]
test ppl:  26%|██▋       | 62/236 [03:57<12:20,  4.25s/it]
test ppl:  27%|██▋       | 63/236 [04:00<10:43,  3.72s/it]
test ppl:  27%|██▋       | 64/236 [04:01<08:47,  3.06s/it]
test ppl:  28%|██▊       | 65/236 [04:02<07:14,  2.54s/it]
test ppl:  28%|██▊       | 66/236 [04:05<07:36,  2.68s/it]
test ppl:  28%|██▊       | 67/236 [04:11<10:15,  3.64s/it]
test ppl:  29%|██▉       | 68/236 [04:17<11:35,  4.14s/it]
test ppl:  29%|██▉       | 69/236 [04:21<11:50,  4.25s/it]
test ppl:  30%|██▉       | 70/236 [04:22<09:18,  3.36s/it]
test ppl:  30%|███       | 71/236 [04:26<09:37,  3.50s/it]
test ppl:  31%|███       | 72/236 [04:32<11:03,  4.04s/it]
test ppl:  31%|███       | 73/236 [04:34<09:57,  3.67s/it]
test ppl:  31%|███▏      | 74/236 [04:36<08:09,  3.02s/it]
test ppl:  32%|███▏      | 75/236 [04:42<10:22,  3.86s/it]
test ppl:  32%|███▏      | 76/236 [04:48<11:54,  4.47s/it]
test ppl:  33%|███▎      | 77/236 [04:50<10:05,  3.81s/it]
test ppl:  33%|███▎      | 78/236 [04:52<08:24,  3.19s/it]
test ppl:  33%|███▎      | 79/236 [04:55<08:55,  3.41s/it]
test ppl:  34%|███▍      | 80/236 [04:57<07:41,  2.96s/it]
test ppl:  34%|███▍      | 81/236 [05:03<09:51,  3.82s/it]
test ppl:  35%|███▍      | 82/236 [05:09<11:23,  4.44s/it]
test ppl:  35%|███▌      | 83/236 [05:12<09:55,  3.89s/it]
test ppl:  36%|███▌      | 84/236 [05:14<08:43,  3.45s/it]
test ppl:  36%|███▌      | 85/236 [05:18<09:15,  3.68s/it]
test ppl:  36%|███▋      | 86/236 [05:20<07:51,  3.14s/it]
test ppl:  37%|███▋      | 87/236 [05:23<07:27,  3.00s/it]
test ppl:  37%|███▋      | 88/236 [05:29<09:29,  3.85s/it]
test ppl:  38%|███▊      | 89/236 [05:31<08:02,  3.28s/it]
test ppl:  38%|███▊      | 90/236 [05:37<09:51,  4.05s/it]
test ppl:  39%|███▊      | 91/236 [05:42<10:28,  4.33s/it]
test ppl:  39%|███▉      | 92/236 [05:44<09:17,  3.87s/it]
test ppl:  39%|███▉      | 93/236 [05:50<10:37,  4.46s/it]
test ppl:  40%|███▉      | 94/236 [05:56<11:32,  4.88s/it]
test ppl:  40%|████      | 95/236 [05:59<10:28,  4.46s/it]
test ppl:  41%|████      | 96/236 [06:03<09:54,  4.25s/it]
test ppl:  41%|████      | 97/236 [06:09<10:56,  4.73s/it]
test ppl:  42%|████▏     | 98/236 [06:15<11:38,  5.06s/it]
test ppl:  42%|████▏     | 99/236 [06:21<12:06,  5.30s/it]
test ppl:  42%|████▏     | 100/236 [06:22<09:19,  4.11s/it]
test ppl:  43%|████▎     | 101/236 [06:28<10:26,  4.64s/it]
test ppl:  43%|████▎     | 102/236 [06:32<09:53,  4.43s/it]
test ppl:  44%|████▎     | 103/236 [06:33<07:49,  3.53s/it]
test ppl:  44%|████▍     | 104/236 [06:38<08:14,  3.74s/it]
test ppl:  44%|████▍     | 105/236 [06:42<08:18,  3.81s/it]
test ppl:  45%|████▍     | 106/236 [06:47<09:16,  4.28s/it]
test ppl:  45%|████▌     | 107/236 [06:49<07:50,  3.65s/it]
test ppl:  46%|████▌     | 108/236 [06:54<08:29,  3.98s/it]
test ppl:  46%|████▌     | 109/236 [06:59<08:50,  4.18s/it]
test ppl:  47%|████▋     | 110/236 [07:00<07:09,  3.41s/it]
test ppl:  47%|████▋     | 111/236 [07:06<08:38,  4.15s/it]
test ppl:  47%|████▋     | 112/236 [07:12<09:37,  4.66s/it]
test ppl:  48%|████▊     | 113/236 [07:14<07:46,  3.79s/it]
test ppl:  48%|████▊     | 114/236 [07:17<07:37,  3.75s/it]
test ppl:  49%|████▊     | 115/236 [07:23<08:50,  4.38s/it]
test ppl:  49%|████▉     | 116/236 [07:29<09:40,  4.84s/it]
test ppl:  50%|████▉     | 117/236 [07:31<07:48,  3.94s/it]
test ppl:  50%|█████     | 118/236 [07:36<08:28,  4.31s/it]
test ppl:  50%|█████     | 119/236 [07:38<07:05,  3.63s/it]
test ppl:  51%|█████     | 120/236 [07:40<05:48,  3.00s/it]
test ppl:  51%|█████▏    | 121/236 [07:42<05:34,  2.91s/it]
test ppl:  52%|█████▏    | 122/236 [07:48<07:12,  3.79s/it]
test ppl:  52%|█████▏    | 123/236 [07:50<06:11,  3.29s/it]
test ppl:  53%|█████▎    | 124/236 [07:53<06:04,  3.26s/it]
test ppl:  53%|█████▎    | 125/236 [07:59<07:27,  4.04s/it]
test ppl:  53%|█████▎    | 126/236 [08:04<07:47,  4.25s/it]
test ppl:  54%|█████▍    | 127/236 [08:06<06:32,  3.60s/it]
test ppl:  54%|█████▍    | 128/236 [08:08<05:32,  3.08s/it]
test ppl:  55%|█████▍    | 129/236 [08:11<05:14,  2.94s/it]
test ppl:  55%|█████▌    | 130/236 [08:14<05:15,  2.98s/it]
test ppl:  56%|█████▌    | 131/236 [08:20<06:43,  3.84s/it]
test ppl:  56%|█████▌    | 132/236 [08:22<05:56,  3.43s/it]
test ppl:  56%|█████▋    | 133/236 [08:26<06:09,  3.59s/it]
test ppl:  57%|█████▋    | 134/236 [08:29<06:00,  3.54s/it]
test ppl:  57%|█████▋    | 135/236 [08:33<06:00,  3.57s/it]
test ppl:  58%|█████▊    | 136/236 [08:34<04:46,  2.87s/it]
test ppl:  58%|█████▊    | 137/236 [08:40<06:14,  3.78s/it]
test ppl:  58%|█████▊    | 138/236 [08:44<05:57,  3.65s/it]
test ppl:  59%|█████▉    | 139/236 [08:45<04:59,  3.09s/it]
test ppl:  59%|█████▉    | 140/236 [08:47<04:16,  2.68s/it]
test ppl:  60%|█████▉    | 141/236 [08:51<04:47,  3.02s/it]
test ppl:  60%|██████    | 142/236 [08:53<04:18,  2.75s/it]
test ppl:  61%|██████    | 143/236 [08:59<05:43,  3.69s/it]
test ppl:  61%|██████    | 144/236 [09:02<05:12,  3.40s/it]
test ppl:  61%|██████▏   | 145/236 [09:07<06:16,  4.14s/it]
test ppl:  62%|██████▏   | 146/236 [09:13<06:38,  4.42s/it]
test ppl:  62%|██████▏   | 147/236 [09:18<07:12,  4.86s/it]
test ppl:  63%|██████▎   | 148/236 [09:24<07:36,  5.19s/it]
test ppl:  63%|██████▎   | 149/236 [09:30<07:49,  5.40s/it]
test ppl:  64%|██████▎   | 150/236 [09:36<07:56,  5.54s/it]
test ppl:  64%|██████▍   | 151/236 [09:42<07:59,  5.64s/it]
test ppl:  64%|██████▍   | 152/236 [09:48<07:58,  5.69s/it]
test ppl:  65%|██████▍   | 153/236 [09:54<07:56,  5.74s/it]
test ppl:  65%|██████▌   | 154/236 [09:56<06:33,  4.80s/it]
test ppl:  66%|██████▌   | 155/236 [09:59<05:34,  4.13s/it]
test ppl:  66%|██████▌   | 156/236 [10:01<04:47,  3.60s/it]
test ppl:  67%|██████▋   | 157/236 [10:03<04:11,  3.18s/it]
test ppl:  67%|██████▋   | 158/236 [10:09<05:10,  3.98s/it]
test ppl:  67%|██████▋   | 159/236 [10:11<04:09,  3.24s/it]
test ppl:  68%|██████▊   | 160/236 [10:12<03:19,  2.62s/it]
test ppl:  68%|██████▊   | 161/236 [10:13<02:43,  2.18s/it]
test ppl:  69%|██████▊   | 162/236 [10:16<03:02,  2.46s/it]
test ppl:  69%|██████▉   | 163/236 [10:19<03:01,  2.48s/it]
test ppl:  69%|██████▉   | 164/236 [10:22<03:12,  2.67s/it]
test ppl:  70%|██████▉   | 165/236 [10:25<03:23,  2.86s/it]
test ppl:  70%|███████   | 166/236 [10:27<02:56,  2.52s/it]
test ppl:  71%|███████   | 167/236 [10:28<02:32,  2.21s/it]
test ppl:  71%|███████   | 168/236 [10:30<02:26,  2.16s/it]
test ppl:  72%|███████▏  | 169/236 [10:36<03:23,  3.04s/it]
test ppl:  72%|███████▏  | 170/236 [10:41<04:17,  3.90s/it]
test ppl:  72%|███████▏  | 171/236 [10:43<03:23,  3.13s/it]
test ppl:  73%|███████▎  | 172/236 [10:49<04:13,  3.95s/it]
test ppl:  73%|███████▎  | 173/236 [10:52<03:57,  3.77s/it]
test ppl:  74%|███████▎  | 174/236 [10:58<04:33,  4.41s/it]
test ppl:  74%|███████▍  | 175/236 [11:04<04:55,  4.85s/it]
test ppl:  75%|███████▍  | 176/236 [11:10<05:09,  5.15s/it]
test ppl:  75%|███████▌  | 177/236 [11:16<05:17,  5.38s/it]
test ppl:  75%|███████▌  | 178/236 [11:21<05:21,  5.54s/it]
test ppl:  76%|███████▌  | 179/236 [11:27<05:21,  5.65s/it]
test ppl:  76%|███████▋  | 180/236 [11:33<05:19,  5.71s/it]
test ppl:  77%|███████▋  | 181/236 [11:39<05:16,  5.76s/it]
test ppl:  77%|███████▋  | 182/236 [11:41<04:08,  4.60s/it]
test ppl:  78%|███████▊  | 183/236 [11:43<03:15,  3.70s/it]
test ppl:  78%|███████▊  | 184/236 [11:44<02:40,  3.08s/it]
test ppl:  78%|███████▊  | 185/236 [11:49<03:00,  3.55s/it]
test ppl:  79%|███████▉  | 186/236 [11:51<02:34,  3.08s/it]
test ppl:  79%|███████▉  | 187/236 [11:52<02:09,  2.65s/it]
test ppl:  80%|███████▉  | 188/236 [11:58<02:53,  3.62s/it]
test ppl:  80%|████████  | 189/236 [12:04<03:22,  4.30s/it]
test ppl:  81%|████████  | 190/236 [12:08<03:16,  4.28s/it]
test ppl:  81%|████████  | 191/236 [12:12<03:05,  4.13s/it]
test ppl:  81%|████████▏ | 192/236 [12:15<02:41,  3.68s/it]
test ppl:  82%|████████▏ | 193/236 [12:21<03:06,  4.34s/it]
test ppl:  82%|████████▏ | 194/236 [12:23<02:40,  3.82s/it]
test ppl:  83%|████████▎ | 195/236 [12:25<02:11,  3.20s/it]
test ppl:  83%|████████▎ | 196/236 [12:27<01:53,  2.84s/it]
test ppl:  83%|████████▎ | 197/236 [12:29<01:42,  2.63s/it]
test ppl:  84%|████████▍ | 198/236 [12:35<02:17,  3.61s/it]
test ppl:  84%|████████▍ | 199/236 [12:38<02:04,  3.37s/it]
test ppl:  85%|████████▍ | 200/236 [12:44<02:28,  4.12s/it]
test ppl:  85%|████████▌ | 201/236 [12:46<02:08,  3.66s/it]
test ppl:  86%|████████▌ | 202/236 [12:52<02:26,  4.31s/it]
test ppl:  86%|████████▌ | 203/236 [12:58<02:38,  4.79s/it]
test ppl:  86%|████████▋ | 204/236 [13:00<02:07,  3.97s/it]
test ppl:  87%|████████▋ | 205/236 [13:06<02:21,  4.57s/it]
test ppl:  87%|████████▋ | 206/236 [13:09<02:05,  4.19s/it]
test ppl:  88%|████████▊ | 207/236 [13:15<02:16,  4.70s/it]
test ppl:  88%|████████▊ | 208/236 [13:18<01:54,  4.11s/it]
test ppl:  89%|████████▊ | 209/236 [13:24<02:05,  4.66s/it]
test ppl:  89%|████████▉ | 210/236 [13:26<01:43,  3.97s/it]
test ppl:  89%|████████▉ | 211/236 [13:30<01:39,  4.00s/it]
test ppl:  90%|████████▉ | 212/236 [13:35<01:41,  4.23s/it]
test ppl:  90%|█████████ | 213/236 [13:41<01:48,  4.72s/it]
test ppl:  91%|█████████ | 214/236 [13:43<01:23,  3.79s/it]
test ppl:  91%|█████████ | 215/236 [13:49<01:32,  4.43s/it]
test ppl:  92%|█████████▏| 216/236 [13:50<01:11,  3.60s/it]
test ppl:  92%|█████████▏| 217/236 [13:56<01:21,  4.31s/it]
test ppl:  92%|█████████▏| 218/236 [13:59<01:09,  3.84s/it]
test ppl:  93%|█████████▎| 219/236 [14:05<01:15,  4.47s/it]
test ppl:  93%|█████████▎| 220/236 [14:11<01:18,  4.89s/it]
test ppl:  94%|█████████▎| 221/236 [14:13<00:59,  3.95s/it]
test ppl:  94%|█████████▍| 222/236 [14:18<01:03,  4.53s/it]
test ppl:  94%|█████████▍| 223/236 [14:24<01:04,  4.93s/it]
test ppl:  95%|█████████▍| 224/236 [14:25<00:45,  3.79s/it]
test ppl:  95%|█████████▌| 225/236 [14:30<00:43,  3.93s/it]
test ppl:  96%|█████████▌| 226/236 [14:32<00:35,  3.53s/it]
test ppl:  96%|█████████▌| 227/236 [14:35<00:29,  3.30s/it]
test ppl:  97%|█████████▋| 228/236 [14:37<00:22,  2.81s/it]
test ppl:  97%|█████████▋| 229/236 [14:43<00:26,  3.73s/it]
test ppl:  97%|█████████▋| 230/236 [14:47<00:23,  3.88s/it]
test ppl:  98%|█████████▊| 231/236 [14:50<00:18,  3.75s/it]
test ppl:  98%|█████████▊| 232/236 [14:52<00:12,  3.19s/it]
test ppl:  99%|█████████▊| 233/236 [14:55<00:09,  3.09s/it]
test ppl:  99%|█████████▉| 234/236 [14:56<00:05,  2.53s/it]
test ppl: 100%|█████████▉| 235/236 [15:02<00:03,  3.53s/it]
test ppl: 100%|██████████| 236/236 [15:03<00:00,  2.67s/it]
test ppl: 100%|██████████| 236/236 [15:03<00:00,  3.83s/it]
10/13/2024 01:51:29 - INFO - __main__ -    em: 0.1961
10/13/2024 01:51:29 - INFO - __main__ -   Finish and take 16m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/16_0.6_80_eval_results.json
16 0.6 80:  em: 0.1961

--------------------------------------------------------------------------------
Running experiment with knn_temp=80, lmbda=0.6, k=32
2024-10-13 01:51:37.015528: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-13 01:51:37.034980: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-13 01:51:37.056856: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-13 01:51:37.063471: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-13 01:51:37.079327: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-13 01:51:38.066439: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/13/2024 01:51:39 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=32, lmbda=0.6, knn_temp=80, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/13/2024 01:51:39 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:48:38,  2.18it/s]
Adding feature api:   4%|▍         | 7321/187062 [00:00<00:10, 17397.92it/s]
Adding feature api:   8%|▊         | 15463/187062 [00:00<00:05, 33624.11it/s]
Adding feature api:  13%|█▎        | 23847/187062 [00:00<00:03, 46971.61it/s]
Adding feature api:  17%|█▋        | 32304/187062 [00:00<00:02, 57318.86it/s]
Adding feature api:  22%|██▏       | 40740/187062 [00:00<00:02, 64949.60it/s]
Adding feature api:  26%|██▌       | 48864/187062 [00:01<00:01, 69628.41it/s]
Adding feature api:  31%|███       | 57287/187062 [00:01<00:01, 73876.67it/s]
Adding feature api:  35%|███▌      | 65682/187062 [00:01<00:01, 76833.38it/s]
Adding feature api:  40%|███▉      | 74133/187062 [00:01<00:01, 79101.44it/s]
Adding feature api:  44%|████▍     | 82521/187062 [00:01<00:01, 80518.43it/s]
Adding feature api:  49%|████▊     | 90823/187062 [00:01<00:01, 80940.94it/s]
Adding feature api:  53%|█████▎    | 99303/187062 [00:01<00:01, 82088.30it/s]
Adding feature api:  58%|█████▊    | 107708/187062 [00:01<00:00, 82672.25it/s]
Adding feature api:  62%|██████▏   | 116159/187062 [00:01<00:00, 83218.47it/s]
Adding feature api:  67%|██████▋   | 124542/187062 [00:01<00:00, 82886.21it/s]
Adding feature api:  71%|███████   | 132993/187062 [00:02<00:00, 83368.06it/s]
Adding feature api:  76%|███████▌  | 141437/187062 [00:02<00:00, 83685.50it/s]
Adding feature api:  80%|████████  | 149856/187062 [00:02<00:00, 83834.37it/s]
Adding feature api:  85%|████████▍ | 158255/187062 [00:02<00:00, 83413.84it/s]
Adding feature api:  89%|████████▉ | 166721/187062 [00:02<00:00, 83784.37it/s]
Adding feature api:  94%|█████████▎| 175185/187062 [00:02<00:00, 84037.76it/s]
Adding feature api:  98%|█████████▊| 183595/187062 [00:02<00:00, 58130.39it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 64167.35it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<24:00:03,  2.16it/s]
Adding feature datatype:   4%|▍         | 7111/187062 [00:00<00:10, 16796.76it/s]
Adding feature datatype:   8%|▊         | 14904/187062 [00:00<00:05, 32220.87it/s]
Adding feature datatype:  12%|█▏        | 23053/187062 [00:00<00:03, 45273.26it/s]
Adding feature datatype:  17%|█▋        | 31228/187062 [00:00<00:02, 55287.01it/s]
Adding feature datatype:  21%|██        | 39402/187062 [00:00<00:02, 62737.38it/s]
Adding feature datatype:  25%|██▌       | 47592/187062 [00:01<00:02, 68234.11it/s]
Adding feature datatype:  30%|██▉       | 55790/187062 [00:01<00:01, 72229.04it/s]
Adding feature datatype:  34%|███▍      | 63699/187062 [00:01<00:01, 74073.56it/s]
Adding feature datatype:  38%|███▊      | 71911/187062 [00:01<00:01, 76443.97it/s]
Adding feature datatype:  43%|████▎     | 80068/187062 [00:01<00:01, 77960.90it/s]
Adding feature datatype:  47%|████▋     | 88273/187062 [00:01<00:01, 79174.46it/s]
Adding feature datatype:  52%|█████▏    | 96496/187062 [00:01<00:01, 80083.26it/s]
Adding feature datatype:  56%|█████▌    | 104626/187062 [00:01<00:01, 79570.41it/s]
Adding feature datatype:  60%|██████    | 112815/187062 [00:01<00:00, 80257.65it/s]
Adding feature datatype:  65%|██████▍   | 120963/187062 [00:01<00:00, 80619.31it/s]
Adding feature datatype:  69%|██████▉   | 129124/187062 [00:02<00:00, 80913.25it/s]
Adding feature datatype:  73%|███████▎  | 137337/187062 [00:02<00:00, 81273.83it/s]
Adding feature datatype:  78%|███████▊  | 145538/187062 [00:02<00:00, 81493.02it/s]
Adding feature datatype:  82%|████████▏ | 153703/187062 [00:02<00:00, 80640.02it/s]
Adding feature datatype:  87%|████████▋ | 161931/187062 [00:02<00:00, 81124.38it/s]
Adding feature datatype:  91%|█████████ | 170131/187062 [00:02<00:00, 81383.27it/s]
Adding feature datatype:  95%|█████████▌| 178276/187062 [00:02<00:00, 78299.29it/s]
Adding feature datatype: 100%|█████████▉| 186135/187062 [00:02<00:00, 52191.80it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 62652.63it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:50:54,  2.18it/s]
Adding feature literal:   4%|▍         | 7167/187062 [00:00<00:10, 17011.53it/s]
Adding feature literal:   8%|▊         | 15313/187062 [00:00<00:05, 33330.47it/s]
Adding feature literal:  13%|█▎        | 23500/187062 [00:00<00:03, 46223.17it/s]
Adding feature literal:  17%|█▋        | 31655/187062 [00:00<00:02, 55940.03it/s]
Adding feature literal:  21%|██▏       | 39888/187062 [00:00<00:02, 63382.66it/s]
Adding feature literal:  26%|██▌       | 48128/187062 [00:01<00:02, 68844.34it/s]
Adding feature literal:  30%|███       | 56384/187062 [00:01<00:01, 72833.50it/s]
Adding feature literal:  35%|███▍      | 64647/187062 [00:01<00:01, 75706.64it/s]
Adding feature literal:  39%|███▉      | 72899/187062 [00:01<00:01, 77717.45it/s]
Adding feature literal:  43%|████▎     | 81019/187062 [00:01<00:01, 77805.60it/s]
Adding feature literal:  48%|████▊     | 89216/187062 [00:01<00:01, 79032.76it/s]
Adding feature literal:  52%|█████▏    | 97495/187062 [00:01<00:01, 80144.02it/s]
Adding feature literal:  57%|█████▋    | 105730/187062 [00:01<00:01, 80798.28it/s]
Adding feature literal:  61%|██████    | 113961/187062 [00:01<00:00, 81247.80it/s]
Adding feature literal:  65%|██████▌   | 122187/187062 [00:01<00:00, 81549.37it/s]
Adding feature literal:  70%|██████▉   | 130423/187062 [00:02<00:00, 81790.87it/s]
Adding feature literal:  74%|███████▍  | 138689/187062 [00:02<00:00, 82049.31it/s]
Adding feature literal:  79%|███████▊  | 146963/187062 [00:02<00:00, 82255.02it/s]
Adding feature literal:  83%|████████▎ | 155204/187062 [00:02<00:00, 82225.17it/s]
Adding feature literal:  87%|████████▋ | 163437/187062 [00:02<00:00, 82173.37it/s]
Adding feature literal:  92%|█████████▏| 171722/187062 [00:02<00:00, 82374.34it/s]
Adding feature literal:  96%|█████████▌| 179965/187062 [00:02<00:00, 71180.82it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 63258.61it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:56:56,  2.17it/s]
Adding feature operator:   4%|▍         | 7132/187062 [00:00<00:10, 16874.22it/s]
Adding feature operator:   8%|▊         | 15309/187062 [00:00<00:05, 33267.96it/s]
Adding feature operator:  13%|█▎        | 23466/187062 [00:00<00:03, 46075.42it/s]
Adding feature operator:  17%|█▋        | 31694/187062 [00:00<00:02, 56020.87it/s]
Adding feature operator:  21%|██▏       | 39929/187062 [00:00<00:02, 63439.92it/s]
Adding feature operator:  26%|██▌       | 48160/187062 [00:01<00:02, 68854.12it/s]
Adding feature operator:  30%|███       | 56365/187062 [00:01<00:01, 72690.74it/s]
Adding feature operator:  35%|███▍      | 64664/187062 [00:01<00:01, 75712.45it/s]
Adding feature operator:  39%|███▉      | 72885/187062 [00:01<00:01, 77629.10it/s]
Adding feature operator:  43%|████▎     | 81142/187062 [00:01<00:01, 79092.59it/s]
Adding feature operator:  48%|████▊     | 89433/187062 [00:01<00:01, 80227.11it/s]
Adding feature operator:  52%|█████▏    | 97703/187062 [00:01<00:01, 80963.20it/s]
Adding feature operator:  57%|█████▋    | 105922/187062 [00:01<00:00, 81251.31it/s]
Adding feature operator:  61%|██████    | 114133/187062 [00:01<00:00, 81381.73it/s]
Adding feature operator:  65%|██████▌   | 122352/187062 [00:01<00:00, 81621.26it/s]
Adding feature operator:  70%|██████▉   | 130596/187062 [00:02<00:00, 81865.55it/s]
Adding feature operator:  74%|███████▍  | 138875/187062 [00:02<00:00, 82139.45it/s]
Adding feature operator:  79%|███████▊  | 147154/187062 [00:02<00:00, 82332.93it/s]
Adding feature operator:  83%|████████▎ | 155436/187062 [00:02<00:00, 82477.42it/s]
Adding feature operator:  88%|████████▊ | 163698/187062 [00:02<00:00, 82516.89it/s]
Adding feature operator:  92%|█████████▏| 171968/187062 [00:02<00:00, 82569.81it/s]
Adding feature operator:  96%|█████████▋| 180230/187062 [00:02<00:00, 70455.40it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 63378.82it/s]
[2024-10-13 01:52:23,464] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/13/2024 01:52:24 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/13/2024 01:52:24 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 40/6548 [00:00<00:17, 381.20 examples/s]
Map:   1%|▏         | 90/6548 [00:00<00:28, 226.12 examples/s]
Map:   2%|▏         | 126/6548 [00:00<00:25, 253.53 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 305.07 examples/s]
Map:   4%|▎         | 232/6548 [00:00<00:19, 326.03 examples/s]
Map:   4%|▍         | 287/6548 [00:00<00:19, 320.74 examples/s]
Map:   5%|▍         | 325/6548 [00:01<00:22, 281.50 examples/s]
Map:   6%|▌         | 364/6548 [00:01<00:20, 300.83 examples/s]
Map:   6%|▋         | 416/6548 [00:01<00:17, 351.82 examples/s]
Map:   7%|▋         | 458/6548 [00:01<00:19, 320.10 examples/s]
Map:   8%|▊         | 502/6548 [00:01<00:19, 306.97 examples/s]
Map:   8%|▊         | 555/6548 [00:01<00:16, 356.39 examples/s]
Map:   9%|▉         | 597/6548 [00:01<00:16, 365.82 examples/s]
Map:  10%|█         | 658/6548 [00:02<00:18, 324.37 examples/s]
Map:  11%|█         | 703/6548 [00:02<00:16, 349.83 examples/s]
Map:  12%|█▏        | 767/6548 [00:02<00:15, 371.79 examples/s]
Map:  12%|█▏        | 816/6548 [00:02<00:14, 397.87 examples/s]
Map:  13%|█▎        | 872/6548 [00:02<00:14, 380.45 examples/s]
Map:  14%|█▍        | 920/6548 [00:02<00:16, 344.92 examples/s]
Map:  15%|█▍        | 970/6548 [00:02<00:16, 339.05 examples/s]
Map:  16%|█▌        | 1015/6548 [00:03<00:24, 227.39 examples/s]
Map:  16%|█▌        | 1055/6548 [00:03<00:21, 252.85 examples/s]
Map:  17%|█▋        | 1099/6548 [00:03<00:18, 286.84 examples/s]
Map:  18%|█▊        | 1146/6548 [00:03<00:16, 324.46 examples/s]
Map:  18%|█▊        | 1205/6548 [00:03<00:15, 341.98 examples/s]
Map:  19%|█▉        | 1262/6548 [00:03<00:15, 349.10 examples/s]
Map:  20%|█▉        | 1301/6548 [00:04<00:14, 357.10 examples/s]
Map:  21%|██        | 1350/6548 [00:04<00:15, 328.58 examples/s]
Map:  21%|██        | 1391/6548 [00:04<00:16, 305.66 examples/s]
Map:  22%|██▏       | 1430/6548 [00:04<00:15, 322.05 examples/s]
Map:  22%|██▏       | 1473/6548 [00:04<00:19, 263.03 examples/s]
Map:  23%|██▎       | 1508/6548 [00:04<00:18, 272.45 examples/s]
Map:  24%|██▎       | 1547/6548 [00:04<00:18, 266.45 examples/s]
Map:  24%|██▍       | 1584/6548 [00:05<00:17, 288.68 examples/s]
Map:  25%|██▍       | 1616/6548 [00:05<00:18, 260.25 examples/s]
Map:  25%|██▌       | 1647/6548 [00:05<00:18, 259.01 examples/s]
Map:  26%|██▌       | 1675/6548 [00:05<00:18, 257.89 examples/s]
Map:  26%|██▌       | 1716/6548 [00:05<00:16, 291.10 examples/s]
Map:  27%|██▋       | 1761/6548 [00:05<00:14, 330.66 examples/s]
Map:  28%|██▊       | 1803/6548 [00:05<00:13, 353.31 examples/s]
Map:  28%|██▊       | 1842/6548 [00:05<00:13, 359.92 examples/s]
Map:  29%|██▉       | 1887/6548 [00:06<00:14, 330.88 examples/s]
Map:  29%|██▉       | 1927/6548 [00:06<00:13, 346.83 examples/s]
Map:  30%|███       | 1967/6548 [00:06<00:12, 358.41 examples/s]
Map:  31%|███       | 2018/6548 [00:06<00:18, 240.06 examples/s]
Map:  31%|███▏      | 2049/6548 [00:06<00:18, 249.16 examples/s]
Map:  32%|███▏      | 2092/6548 [00:06<00:15, 281.89 examples/s]
Map:  32%|███▏      | 2126/6548 [00:06<00:15, 290.73 examples/s]
Map:  33%|███▎      | 2171/6548 [00:07<00:15, 276.24 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:14, 289.30 examples/s]
Map:  34%|███▍      | 2255/6548 [00:07<00:15, 282.51 examples/s]
Map:  35%|███▍      | 2287/6548 [00:07<00:14, 284.64 examples/s]
Map:  36%|███▌      | 2331/6548 [00:07<00:13, 320.48 examples/s]
Map:  36%|███▋      | 2384/6548 [00:07<00:12, 328.51 examples/s]
Map:  37%|███▋      | 2436/6548 [00:07<00:12, 332.44 examples/s]
Map:  38%|███▊      | 2477/6548 [00:08<00:13, 303.53 examples/s]
Map:  38%|███▊      | 2517/6548 [00:08<00:12, 319.84 examples/s]
Map:  39%|███▉      | 2556/6548 [00:08<00:11, 335.06 examples/s]
Map:  40%|███▉      | 2599/6548 [00:08<00:11, 357.34 examples/s]
Map:  40%|████      | 2640/6548 [00:08<00:10, 357.00 examples/s]
Map:  41%|████      | 2694/6548 [00:08<00:11, 336.07 examples/s]
Map:  42%|████▏     | 2749/6548 [00:08<00:11, 341.94 examples/s]
Map:  43%|████▎     | 2789/6548 [00:08<00:10, 346.35 examples/s]
Map:  43%|████▎     | 2828/6548 [00:09<00:12, 288.46 examples/s]
Map:  44%|████▍     | 2872/6548 [00:09<00:12, 286.78 examples/s]
Map:  44%|████▍     | 2903/6548 [00:09<00:12, 289.32 examples/s]
Map:  45%|████▌     | 2953/6548 [00:09<00:12, 298.18 examples/s]
Map:  46%|████▌     | 2988/6548 [00:09<00:11, 308.12 examples/s]
Map:  46%|████▌     | 3027/6548 [00:10<00:20, 173.08 examples/s]
Map:  47%|████▋     | 3058/6548 [00:10<00:18, 191.41 examples/s]
Map:  47%|████▋     | 3091/6548 [00:10<00:16, 208.78 examples/s]
Map:  48%|████▊     | 3132/6548 [00:10<00:13, 244.65 examples/s]
Map:  48%|████▊     | 3171/6548 [00:10<00:13, 241.27 examples/s]
Map:  49%|████▉     | 3201/6548 [00:10<00:13, 249.08 examples/s]
Map:  50%|████▉     | 3243/6548 [00:10<00:13, 246.52 examples/s]
Map:  50%|████▉     | 3273/6548 [00:10<00:12, 256.81 examples/s]
Map:  51%|█████     | 3308/6548 [00:11<00:11, 273.55 examples/s]
Map:  51%|█████     | 3348/6548 [00:11<00:10, 298.07 examples/s]
Map:  52%|█████▏    | 3380/6548 [00:11<00:10, 292.00 examples/s]
Map:  52%|█████▏    | 3422/6548 [00:11<00:11, 278.53 examples/s]
Map:  53%|█████▎    | 3454/6548 [00:11<00:11, 269.35 examples/s]
Map:  53%|█████▎    | 3495/6548 [00:11<00:11, 261.61 examples/s]
Map:  54%|█████▍    | 3544/6548 [00:11<00:09, 314.12 examples/s]
Map:  55%|█████▍    | 3591/6548 [00:11<00:08, 347.20 examples/s]
Map:  56%|█████▌    | 3636/6548 [00:12<00:07, 372.56 examples/s]
Map:  56%|█████▋    | 3696/6548 [00:12<00:07, 376.54 examples/s]
Map:  57%|█████▋    | 3740/6548 [00:12<00:07, 381.78 examples/s]
Map:  58%|█████▊    | 3794/6548 [00:12<00:07, 372.39 examples/s]
Map:  59%|█████▉    | 3849/6548 [00:12<00:08, 324.97 examples/s]
Map:  59%|█████▉    | 3887/6548 [00:12<00:08, 329.62 examples/s]
Map:  60%|█████▉    | 3923/6548 [00:12<00:08, 315.76 examples/s]
Map:  60%|██████    | 3956/6548 [00:13<00:08, 317.61 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:11, 227.51 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 286.12 examples/s]
Map:  63%|██████▎   | 4096/6548 [00:13<00:07, 313.30 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 325.55 examples/s]
Map:  64%|██████▍   | 4193/6548 [00:13<00:07, 327.16 examples/s]
Map:  65%|██████▍   | 4231/6548 [00:13<00:07, 323.10 examples/s]
Map:  65%|██████▌   | 4274/6548 [00:14<00:06, 344.65 examples/s]
Map:  66%|██████▌   | 4312/6548 [00:14<00:06, 349.61 examples/s]
Map:  67%|██████▋   | 4368/6548 [00:14<00:06, 347.59 examples/s]
Map:  67%|██████▋   | 4405/6548 [00:14<00:06, 349.53 examples/s]
Map:  68%|██████▊   | 4455/6548 [00:14<00:05, 375.47 examples/s]
Map:  69%|██████▊   | 4497/6548 [00:14<00:06, 326.87 examples/s]
Map:  69%|██████▉   | 4538/6548 [00:14<00:06, 308.45 examples/s]
Map:  70%|██████▉   | 4573/6548 [00:15<00:06, 316.55 examples/s]
Map:  70%|███████   | 4610/6548 [00:15<00:06, 322.10 examples/s]
Map:  71%|███████   | 4659/6548 [00:15<00:05, 363.55 examples/s]
Map:  72%|███████▏  | 4716/6548 [00:15<00:04, 366.97 examples/s]
Map:  73%|███████▎  | 4754/6548 [00:15<00:04, 368.31 examples/s]
Map:  73%|███████▎  | 4809/6548 [00:15<00:04, 414.14 examples/s]
Map:  74%|███████▍  | 4853/6548 [00:15<00:04, 352.63 examples/s]
Map:  75%|███████▍  | 4904/6548 [00:15<00:04, 368.77 examples/s]
Map:  76%|███████▌  | 4957/6548 [00:15<00:03, 407.43 examples/s]
Map:  76%|███████▋  | 5000/6548 [00:16<00:06, 244.65 examples/s]
Map:  77%|███████▋  | 5052/6548 [00:16<00:05, 266.69 examples/s]
Map:  78%|███████▊  | 5100/6548 [00:16<00:05, 274.66 examples/s]
Map:  78%|███████▊  | 5136/6548 [00:16<00:05, 263.32 examples/s]
Map:  79%|███████▉  | 5177/6548 [00:16<00:04, 285.71 examples/s]
Map:  80%|███████▉  | 5224/6548 [00:17<00:04, 290.58 examples/s]
Map:  80%|████████  | 5256/6548 [00:17<00:04, 296.37 examples/s]
Map:  81%|████████  | 5312/6548 [00:17<00:03, 357.12 examples/s]
Map:  82%|████████▏ | 5357/6548 [00:17<00:03, 298.53 examples/s]
Map:  82%|████████▏ | 5392/6548 [00:17<00:03, 290.29 examples/s]
Map:  83%|████████▎ | 5447/6548 [00:17<00:03, 311.46 examples/s]
Map:  84%|████████▍ | 5485/6548 [00:17<00:03, 325.07 examples/s]
Map:  85%|████████▍ | 5543/6548 [00:18<00:02, 335.40 examples/s]
Map:  85%|████████▌ | 5585/6548 [00:18<00:03, 304.14 examples/s]
Map:  86%|████████▌ | 5638/6548 [00:18<00:02, 351.12 examples/s]
Map:  87%|████████▋ | 5681/6548 [00:18<00:02, 307.40 examples/s]
Map:  87%|████████▋ | 5720/6548 [00:18<00:02, 324.94 examples/s]
Map:  88%|████████▊ | 5761/6548 [00:18<00:02, 341.27 examples/s]
Map:  89%|████████▊ | 5801/6548 [00:18<00:02, 344.38 examples/s]
Map:  89%|████████▉ | 5855/6548 [00:18<00:02, 343.27 examples/s]
Map:  90%|█████████ | 5906/6548 [00:19<00:01, 335.25 examples/s]
Map:  91%|█████████ | 5960/6548 [00:19<00:01, 338.23 examples/s]
Map:  92%|█████████▏| 6000/6548 [00:19<00:02, 226.09 examples/s]
Map:  92%|█████████▏| 6040/6548 [00:19<00:01, 255.89 examples/s]
Map:  93%|█████████▎| 6082/6548 [00:19<00:01, 285.67 examples/s]
Map:  93%|█████████▎| 6120/6548 [00:20<00:01, 269.15 examples/s]
Map:  94%|█████████▍| 6155/6548 [00:20<00:01, 286.17 examples/s]
Map:  95%|█████████▍| 6190/6548 [00:20<00:01, 297.03 examples/s]
Map:  95%|█████████▌| 6228/6548 [00:20<00:01, 315.12 examples/s]
Map:  96%|█████████▌| 6265/6548 [00:20<00:00, 327.86 examples/s]
Map:  96%|█████████▋| 6306/6548 [00:20<00:00, 348.40 examples/s]
Map:  97%|█████████▋| 6367/6548 [00:20<00:00, 363.20 examples/s]
Map:  98%|█████████▊| 6411/6548 [00:20<00:00, 380.73 examples/s]
Map:  99%|█████████▊| 6458/6548 [00:20<00:00, 402.49 examples/s]
Map:  99%|█████████▉| 6515/6548 [00:21<00:00, 388.47 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 308.24 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 333.34 examples/s]
Map:   8%|▊         | 74/903 [00:00<00:02, 353.19 examples/s]
Map:  12%|█▏        | 112/903 [00:00<00:02, 331.26 examples/s]
Map:  17%|█▋        | 150/903 [00:00<00:02, 344.45 examples/s]
Map:  22%|██▏       | 199/903 [00:00<00:01, 391.17 examples/s]
Map:  29%|██▊       | 258/903 [00:00<00:01, 390.34 examples/s]
Map:  35%|███▍      | 312/903 [00:00<00:01, 376.44 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 317.28 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 297.71 examples/s]
Map:  51%|█████     | 460/903 [00:01<00:01, 299.71 examples/s]
Map:  54%|█████▍    | 491/903 [00:01<00:01, 299.83 examples/s]
Map:  60%|█████▉    | 538/903 [00:01<00:01, 334.35 examples/s]
Map:  65%|██████▌   | 587/903 [00:01<00:00, 365.50 examples/s]
Map:  71%|███████   | 643/903 [00:01<00:00, 366.00 examples/s]
Map:  77%|███████▋  | 691/903 [00:01<00:00, 381.10 examples/s]
Map:  82%|████████▏ | 736/903 [00:02<00:00, 389.85 examples/s]
Map:  87%|████████▋ | 785/903 [00:02<00:00, 360.23 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 366.46 examples/s]
Map:  96%|█████████▌| 865/903 [00:02<00:00, 370.41 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 215.93 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 317.98 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 35/1882 [00:00<00:06, 264.84 examples/s]
Map:   4%|▍         | 80/1882 [00:00<00:05, 340.70 examples/s]
Map:   6%|▋         | 119/1882 [00:00<00:05, 335.58 examples/s]
Map:   8%|▊         | 157/1882 [00:00<00:04, 349.91 examples/s]
Map:  10%|█         | 194/1882 [00:00<00:04, 354.78 examples/s]
Map:  12%|█▏        | 231/1882 [00:00<00:04, 350.61 examples/s]
Map:  14%|█▍        | 272/1882 [00:00<00:04, 367.03 examples/s]
Map:  16%|█▋        | 309/1882 [00:00<00:04, 358.48 examples/s]
Map:  19%|█▉        | 354/1882 [00:01<00:04, 329.70 examples/s]
Map:  21%|██        | 392/1882 [00:01<00:04, 298.32 examples/s]
Map:  23%|██▎       | 433/1882 [00:01<00:05, 280.25 examples/s]
Map:  26%|██▌       | 489/1882 [00:01<00:04, 301.67 examples/s]
Map:  28%|██▊       | 532/1882 [00:01<00:04, 282.16 examples/s]
Map:  30%|███       | 570/1882 [00:01<00:04, 303.24 examples/s]
Map:  33%|███▎      | 615/1882 [00:01<00:03, 335.72 examples/s]
Map:  35%|███▍      | 656/1882 [00:02<00:03, 351.89 examples/s]
Map:  37%|███▋      | 699/1882 [00:02<00:03, 363.84 examples/s]
Map:  39%|███▉      | 737/1882 [00:02<00:03, 367.51 examples/s]
Map:  42%|████▏     | 793/1882 [00:02<00:03, 354.37 examples/s]
Map:  44%|████▍     | 831/1882 [00:02<00:02, 359.48 examples/s]
Map:  47%|████▋     | 885/1882 [00:02<00:02, 354.36 examples/s]
Map:  49%|████▉     | 924/1882 [00:02<00:02, 360.87 examples/s]
Map:  52%|█████▏    | 975/1882 [00:02<00:02, 396.86 examples/s]
Map:  54%|█████▍    | 1016/1882 [00:03<00:03, 233.38 examples/s]
Map:  56%|█████▌    | 1053/1882 [00:03<00:03, 256.79 examples/s]
Map:  58%|█████▊    | 1091/1882 [00:03<00:02, 275.65 examples/s]
Map:  61%|██████    | 1140/1882 [00:03<00:02, 286.03 examples/s]
Map:  62%|██████▏   | 1176/1882 [00:03<00:02, 301.30 examples/s]
Map:  65%|██████▍   | 1214/1882 [00:03<00:02, 283.85 examples/s]
Map:  67%|██████▋   | 1255/1882 [00:03<00:02, 311.58 examples/s]
Map:  69%|██████▉   | 1296/1882 [00:04<00:01, 334.72 examples/s]
Map:  71%|███████   | 1340/1882 [00:04<00:01, 357.27 examples/s]
Map:  74%|███████▎  | 1385/1882 [00:04<00:01, 332.68 examples/s]
Map:  76%|███████▌  | 1426/1882 [00:04<00:01, 299.38 examples/s]
Map:  78%|███████▊  | 1467/1882 [00:04<00:01, 324.92 examples/s]
Map:  80%|████████  | 1509/1882 [00:04<00:01, 264.53 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 276.03 examples/s]
Map:  84%|████████▎ | 1576/1882 [00:05<00:01, 282.49 examples/s]
Map:  86%|████████▌ | 1619/1882 [00:05<00:00, 314.63 examples/s]
Map:  89%|████████▊ | 1666/1882 [00:05<00:00, 297.88 examples/s]
Map:  91%|█████████ | 1715/1882 [00:05<00:00, 305.44 examples/s]
Map:  93%|█████████▎| 1752/1882 [00:05<00:00, 267.73 examples/s]
Map:  95%|█████████▍| 1781/1882 [00:05<00:00, 271.42 examples/s]
Map:  97%|█████████▋| 1824/1882 [00:05<00:00, 304.23 examples/s]
Map:  99%|█████████▉| 1868/1882 [00:05<00:00, 336.72 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 304.47 examples/s]
10/13/2024 01:53:27 - INFO - __main__ -     ***** Testing *****
10/13/2024 01:53:27 - INFO - __main__ -     Batch size = 8
10/13/2024 01:53:27 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/13/2024 01:53:28 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/13/2024 01:53:28 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/13/2024 01:53:29 - INFO - knnlm -   Reading datastore took 0.9691095352172852 s
10/13/2024 01:53:30 - INFO - knnlm -   Moving index to GPU took 0.9521162509918213 s
10/13/2024 01:53:30 - INFO - __main__ -   ******************************break-into
10/13/2024 01:53:30 - INFO - __main__ -     ***** Running acc evaluation *****
10/13/2024 01:53:30 - INFO - __main__ -     Num examples = 236
10/13/2024 01:53:30 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:08<33:38,  8.59s/it]
test ppl:   1%|          | 2/236 [00:10<17:58,  4.61s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:26,  3.20s/it]
test ppl:   2%|▏         | 4/236 [00:17<16:42,  4.32s/it]
test ppl:   2%|▏         | 5/236 [00:25<20:46,  5.40s/it]
test ppl:   3%|▎         | 6/236 [00:31<21:15,  5.55s/it]
test ppl:   3%|▎         | 7/236 [00:33<17:12,  4.51s/it]
test ppl:   3%|▎         | 8/236 [00:39<18:42,  4.92s/it]
test ppl:   4%|▍         | 9/236 [00:41<15:17,  4.04s/it]
test ppl:   4%|▍         | 10/236 [00:45<15:13,  4.04s/it]
test ppl:   5%|▍         | 11/236 [00:47<12:50,  3.43s/it]
test ppl:   5%|▌         | 12/236 [00:53<15:32,  4.16s/it]
test ppl:   6%|▌         | 13/236 [00:59<17:20,  4.67s/it]
test ppl:   6%|▌         | 14/236 [01:05<18:35,  5.02s/it]
test ppl:   6%|▋         | 15/236 [01:06<14:20,  3.90s/it]
test ppl:   7%|▋         | 16/236 [01:08<12:38,  3.45s/it]
test ppl:   7%|▋         | 17/236 [01:14<15:12,  4.17s/it]
test ppl:   8%|▊         | 18/236 [01:16<13:15,  3.65s/it]
test ppl:   8%|▊         | 19/236 [01:22<15:34,  4.31s/it]
test ppl:   8%|▊         | 20/236 [01:24<12:46,  3.55s/it]
test ppl:   9%|▉         | 21/236 [01:27<12:02,  3.36s/it]
test ppl:   9%|▉         | 22/236 [01:33<14:40,  4.11s/it]
test ppl:  10%|▉         | 23/236 [01:35<12:53,  3.63s/it]
test ppl:  10%|█         | 24/236 [01:38<11:19,  3.21s/it]
test ppl:  11%|█         | 25/236 [01:43<14:05,  4.01s/it]
test ppl:  11%|█         | 26/236 [01:49<15:58,  4.56s/it]
test ppl:  11%|█▏        | 27/236 [01:53<14:43,  4.23s/it]
test ppl:  12%|█▏        | 28/236 [01:54<11:29,  3.32s/it]
test ppl:  12%|█▏        | 29/236 [01:56<10:23,  3.01s/it]
test ppl:  13%|█▎        | 30/236 [01:58<08:49,  2.57s/it]
test ppl:  13%|█▎        | 31/236 [02:00<08:11,  2.40s/it]
test ppl:  14%|█▎        | 32/236 [02:03<08:41,  2.56s/it]
test ppl:  14%|█▍        | 33/236 [02:05<08:32,  2.53s/it]
test ppl:  14%|█▍        | 34/236 [02:09<09:58,  2.96s/it]
test ppl:  15%|█▍        | 35/236 [02:12<09:28,  2.83s/it]
test ppl:  15%|█▌        | 36/236 [02:18<12:26,  3.73s/it]
test ppl:  16%|█▌        | 37/236 [02:23<14:30,  4.37s/it]
test ppl:  16%|█▌        | 38/236 [02:25<12:08,  3.68s/it]
test ppl:  17%|█▋        | 39/236 [02:27<10:10,  3.10s/it]
test ppl:  17%|█▋        | 40/236 [02:29<08:24,  2.57s/it]
test ppl:  17%|█▋        | 41/236 [02:30<07:39,  2.35s/it]
test ppl:  18%|█▊        | 42/236 [02:36<11:01,  3.41s/it]
test ppl:  18%|█▊        | 43/236 [02:42<13:18,  4.14s/it]
test ppl:  19%|█▊        | 44/236 [02:44<11:29,  3.59s/it]
test ppl:  19%|█▉        | 45/236 [02:46<09:52,  3.10s/it]
test ppl:  19%|█▉        | 46/236 [02:52<12:29,  3.94s/it]
test ppl:  20%|█▉        | 47/236 [02:54<10:08,  3.22s/it]
test ppl:  20%|██        | 48/236 [03:00<12:33,  4.01s/it]
test ppl:  21%|██        | 49/236 [03:03<11:55,  3.83s/it]
test ppl:  21%|██        | 50/236 [03:09<13:48,  4.45s/it]
test ppl:  22%|██▏       | 51/236 [03:15<15:01,  4.87s/it]
test ppl:  22%|██▏       | 52/236 [03:21<15:50,  5.16s/it]
test ppl:  22%|██▏       | 53/236 [03:27<16:21,  5.37s/it]
test ppl:  23%|██▎       | 54/236 [03:28<12:47,  4.22s/it]
test ppl:  23%|██▎       | 55/236 [03:34<14:00,  4.65s/it]
test ppl:  24%|██▎       | 56/236 [03:37<12:48,  4.27s/it]
test ppl:  24%|██▍       | 57/236 [03:39<10:59,  3.68s/it]
test ppl:  25%|██▍       | 58/236 [03:42<09:40,  3.26s/it]
test ppl:  25%|██▌       | 59/236 [03:48<11:55,  4.04s/it]
test ppl:  25%|██▌       | 60/236 [03:51<11:09,  3.81s/it]
test ppl:  26%|██▌       | 61/236 [03:57<12:53,  4.42s/it]
test ppl:  26%|██▋       | 62/236 [04:03<14:04,  4.85s/it]
test ppl:  27%|██▋       | 63/236 [04:05<11:55,  4.13s/it]
test ppl:  27%|██▋       | 64/236 [04:07<09:37,  3.36s/it]
test ppl:  28%|██▊       | 65/236 [04:08<07:48,  2.74s/it]
test ppl:  28%|██▊       | 66/236 [04:11<08:03,  2.84s/it]
test ppl:  28%|██▊       | 67/236 [04:17<10:33,  3.75s/it]
test ppl:  29%|██▉       | 68/236 [04:23<12:16,  4.38s/it]
test ppl:  29%|██▉       | 69/236 [04:28<13:25,  4.83s/it]
test ppl:  30%|██▉       | 70/236 [04:34<14:12,  5.13s/it]
test ppl:  30%|███       | 71/236 [04:38<13:07,  4.77s/it]
test ppl:  31%|███       | 72/236 [04:41<11:17,  4.13s/it]
test ppl:  31%|███       | 73/236 [04:47<12:38,  4.65s/it]
test ppl:  31%|███▏      | 74/236 [04:48<10:01,  3.71s/it]
test ppl:  32%|███▏      | 75/236 [04:54<11:40,  4.35s/it]
test ppl:  32%|███▏      | 76/236 [04:57<10:29,  3.93s/it]
test ppl:  33%|███▎      | 77/236 [04:59<09:06,  3.43s/it]
test ppl:  33%|███▎      | 78/236 [05:01<07:42,  2.93s/it]
test ppl:  33%|███▎      | 79/236 [05:05<08:25,  3.22s/it]
test ppl:  34%|███▍      | 80/236 [05:07<07:06,  2.73s/it]
test ppl:  34%|███▍      | 81/236 [05:12<09:27,  3.66s/it]
test ppl:  35%|███▍      | 82/236 [05:18<11:07,  4.33s/it]
test ppl:  35%|███▌      | 83/236 [05:22<10:15,  4.02s/it]
test ppl:  36%|███▌      | 84/236 [05:24<08:45,  3.45s/it]
test ppl:  36%|███▌      | 85/236 [05:28<09:15,  3.68s/it]
test ppl:  36%|███▋      | 86/236 [05:30<07:35,  3.04s/it]
test ppl:  37%|███▋      | 87/236 [05:32<06:50,  2.76s/it]
test ppl:  37%|███▋      | 88/236 [05:37<09:05,  3.69s/it]
test ppl:  38%|███▊      | 89/236 [05:43<10:37,  4.34s/it]
test ppl:  38%|███▊      | 90/236 [05:49<11:39,  4.79s/it]
test ppl:  39%|███▊      | 91/236 [05:54<11:39,  4.83s/it]
test ppl:  39%|███▉      | 92/236 [05:57<10:07,  4.22s/it]
test ppl:  39%|███▉      | 93/236 [06:03<11:13,  4.71s/it]
test ppl:  40%|███▉      | 94/236 [06:09<11:53,  5.02s/it]
test ppl:  40%|████      | 95/236 [06:11<10:06,  4.30s/it]
test ppl:  41%|████      | 96/236 [06:14<09:04,  3.89s/it]
test ppl:  41%|████      | 97/236 [06:20<10:22,  4.48s/it]
test ppl:  42%|████▏     | 98/236 [06:26<11:15,  4.89s/it]
test ppl:  42%|████▏     | 99/236 [06:32<11:51,  5.19s/it]
test ppl:  42%|████▏     | 100/236 [06:33<09:08,  4.03s/it]
test ppl:  43%|████▎     | 101/236 [06:39<10:17,  4.57s/it]
test ppl:  43%|████▎     | 102/236 [06:43<09:46,  4.38s/it]
test ppl:  44%|████▎     | 103/236 [06:44<07:44,  3.49s/it]
test ppl:  44%|████▍     | 104/236 [06:48<08:10,  3.72s/it]
test ppl:  44%|████▍     | 105/236 [06:52<08:16,  3.79s/it]
test ppl:  45%|████▍     | 106/236 [06:58<09:15,  4.27s/it]
test ppl:  45%|████▌     | 107/236 [07:00<07:40,  3.57s/it]
test ppl:  46%|████▌     | 108/236 [07:03<07:34,  3.55s/it]
test ppl:  46%|████▌     | 109/236 [07:08<08:35,  4.06s/it]
test ppl:  47%|████▋     | 110/236 [07:10<06:57,  3.32s/it]
test ppl:  47%|████▋     | 111/236 [07:14<07:32,  3.62s/it]
test ppl:  47%|████▋     | 112/236 [07:19<08:19,  4.03s/it]
test ppl:  48%|████▊     | 113/236 [07:21<06:51,  3.35s/it]
test ppl:  48%|████▊     | 114/236 [07:25<07:01,  3.46s/it]
test ppl:  49%|████▊     | 115/236 [07:31<08:25,  4.18s/it]
test ppl:  49%|████▉     | 116/236 [07:37<09:22,  4.69s/it]
test ppl:  50%|████▉     | 117/236 [07:38<07:36,  3.83s/it]
test ppl:  50%|█████     | 118/236 [07:44<08:18,  4.22s/it]
test ppl:  50%|█████     | 119/236 [07:47<07:30,  3.85s/it]
test ppl:  51%|█████     | 120/236 [07:48<06:04,  3.14s/it]
test ppl:  51%|█████▏    | 121/236 [07:52<06:41,  3.49s/it]
test ppl:  52%|█████▏    | 122/236 [07:58<07:58,  4.20s/it]
test ppl:  52%|█████▏    | 123/236 [08:00<06:43,  3.57s/it]
test ppl:  53%|█████▎    | 124/236 [08:03<06:03,  3.25s/it]
test ppl:  53%|█████▎    | 125/236 [08:09<07:26,  4.02s/it]
test ppl:  53%|█████▎    | 126/236 [08:13<07:29,  4.09s/it]
test ppl:  54%|█████▍    | 127/236 [08:15<06:13,  3.42s/it]
test ppl:  54%|█████▍    | 128/236 [08:17<05:19,  2.96s/it]
test ppl:  55%|█████▍    | 129/236 [08:19<05:12,  2.92s/it]
test ppl:  55%|█████▌    | 130/236 [08:22<05:14,  2.97s/it]
test ppl:  56%|█████▌    | 131/236 [08:28<06:43,  3.84s/it]
test ppl:  56%|█████▌    | 132/236 [08:34<07:42,  4.45s/it]
test ppl:  56%|█████▋    | 133/236 [08:38<07:20,  4.28s/it]
test ppl:  57%|█████▋    | 134/236 [08:42<06:49,  4.01s/it]
test ppl:  57%|█████▋    | 135/236 [08:47<07:41,  4.57s/it]
test ppl:  58%|█████▊    | 136/236 [08:49<05:59,  3.59s/it]
test ppl:  58%|█████▊    | 137/236 [08:55<07:04,  4.28s/it]
test ppl:  58%|█████▊    | 138/236 [08:58<06:41,  4.10s/it]
test ppl:  59%|█████▉    | 139/236 [09:00<05:30,  3.40s/it]
test ppl:  59%|█████▉    | 140/236 [09:02<04:37,  2.90s/it]
test ppl:  60%|█████▉    | 141/236 [09:06<05:04,  3.20s/it]
test ppl:  60%|██████    | 142/236 [09:08<04:32,  2.90s/it]
test ppl:  61%|██████    | 143/236 [09:12<05:07,  3.31s/it]
test ppl:  61%|██████    | 144/236 [09:15<04:49,  3.15s/it]
test ppl:  61%|██████▏   | 145/236 [09:19<05:16,  3.48s/it]
test ppl:  62%|██████▏   | 146/236 [09:24<05:59,  3.99s/it]
test ppl:  62%|██████▏   | 147/236 [09:30<06:51,  4.62s/it]
test ppl:  63%|██████▎   | 148/236 [09:37<07:27,  5.08s/it]
test ppl:  63%|██████▎   | 149/236 [09:43<07:44,  5.34s/it]
test ppl:  64%|██████▎   | 150/236 [09:48<07:53,  5.51s/it]
test ppl:  64%|██████▍   | 151/236 [09:54<07:56,  5.61s/it]
test ppl:  64%|██████▍   | 152/236 [10:00<07:57,  5.68s/it]
test ppl:  65%|██████▍   | 153/236 [10:06<07:56,  5.74s/it]
test ppl:  65%|██████▌   | 154/236 [10:07<06:05,  4.46s/it]
test ppl:  66%|██████▌   | 155/236 [10:10<05:15,  3.89s/it]
test ppl:  66%|██████▌   | 156/236 [10:12<04:35,  3.44s/it]
test ppl:  67%|██████▋   | 157/236 [10:15<04:02,  3.07s/it]
test ppl:  67%|██████▋   | 158/236 [10:20<05:04,  3.91s/it]
test ppl:  67%|██████▋   | 159/236 [10:26<05:45,  4.49s/it]
test ppl:  68%|██████▊   | 160/236 [10:28<04:25,  3.50s/it]
test ppl:  68%|██████▊   | 161/236 [10:29<03:33,  2.84s/it]
test ppl:  69%|██████▊   | 162/236 [10:32<03:36,  2.93s/it]
test ppl:  69%|██████▉   | 163/236 [10:34<03:25,  2.81s/it]
test ppl:  69%|██████▉   | 164/236 [10:38<03:48,  3.17s/it]
test ppl:  70%|██████▉   | 165/236 [10:41<03:41,  3.12s/it]
test ppl:  70%|███████   | 166/236 [10:43<03:05,  2.65s/it]
test ppl:  71%|███████   | 167/236 [10:45<02:38,  2.30s/it]
test ppl:  71%|███████   | 168/236 [10:50<03:48,  3.36s/it]
test ppl:  72%|███████▏  | 169/236 [10:55<04:04,  3.65s/it]
test ppl:  72%|███████▏  | 170/236 [11:01<04:45,  4.32s/it]
test ppl:  72%|███████▏  | 171/236 [11:02<03:43,  3.43s/it]
test ppl:  73%|███████▎  | 172/236 [11:08<04:26,  4.16s/it]
test ppl:  73%|███████▎  | 173/236 [11:11<04:11,  3.99s/it]
test ppl:  74%|███████▎  | 174/236 [11:17<04:42,  4.56s/it]
test ppl:  74%|███████▍  | 175/236 [11:23<05:02,  4.95s/it]
test ppl:  75%|███████▍  | 176/236 [11:29<05:13,  5.22s/it]
test ppl:  75%|███████▌  | 177/236 [11:35<05:20,  5.43s/it]
test ppl:  75%|███████▌  | 178/236 [11:41<05:23,  5.57s/it]
test ppl:  76%|███████▌  | 179/236 [11:47<05:23,  5.68s/it]
test ppl:  76%|███████▋  | 180/236 [11:52<05:07,  5.49s/it]
test ppl:  77%|███████▋  | 181/236 [11:57<04:55,  5.38s/it]
test ppl:  77%|███████▋  | 182/236 [11:59<03:53,  4.33s/it]
test ppl:  78%|███████▊  | 183/236 [12:00<03:05,  3.51s/it]
test ppl:  78%|███████▊  | 184/236 [12:02<02:29,  2.87s/it]
test ppl:  78%|███████▊  | 185/236 [12:06<02:42,  3.19s/it]
test ppl:  79%|███████▉  | 186/236 [12:08<02:20,  2.81s/it]
test ppl:  79%|███████▉  | 187/236 [12:09<02:00,  2.47s/it]
test ppl:  80%|███████▉  | 188/236 [12:15<02:47,  3.49s/it]
test ppl:  80%|████████  | 189/236 [12:21<03:17,  4.21s/it]
test ppl:  81%|████████  | 190/236 [12:25<03:14,  4.22s/it]
test ppl:  81%|████████  | 191/236 [12:30<03:10,  4.24s/it]
test ppl:  81%|████████▏ | 192/236 [12:32<02:47,  3.81s/it]
test ppl:  82%|████████▏ | 193/236 [12:34<02:16,  3.18s/it]
test ppl:  82%|████████▏ | 194/236 [12:37<02:06,  3.01s/it]
test ppl:  83%|████████▎ | 195/236 [12:40<02:03,  3.02s/it]
test ppl:  83%|████████▎ | 196/236 [12:42<01:49,  2.73s/it]
test ppl:  83%|████████▎ | 197/236 [12:44<01:39,  2.54s/it]
test ppl:  84%|████████▍ | 198/236 [12:50<02:14,  3.54s/it]
test ppl:  84%|████████▍ | 199/236 [12:53<02:02,  3.32s/it]
test ppl:  85%|████████▍ | 200/236 [12:58<02:26,  4.08s/it]
test ppl:  85%|████████▌ | 201/236 [13:01<02:07,  3.63s/it]
test ppl:  86%|████████▌ | 202/236 [13:07<02:25,  4.29s/it]
test ppl:  86%|████████▌ | 203/236 [13:13<02:37,  4.76s/it]
test ppl:  86%|████████▋ | 204/236 [13:14<02:03,  3.86s/it]
test ppl:  87%|████████▋ | 205/236 [13:20<02:15,  4.36s/it]
test ppl:  87%|████████▋ | 206/236 [13:23<02:00,  4.03s/it]
test ppl:  88%|████████▊ | 207/236 [13:29<02:12,  4.58s/it]
test ppl:  88%|████████▊ | 208/236 [13:32<01:53,  4.04s/it]
test ppl:  89%|████████▊ | 209/236 [13:38<02:04,  4.62s/it]
test ppl:  89%|████████▉ | 210/236 [13:40<01:42,  3.93s/it]
test ppl:  89%|████████▉ | 211/236 [13:45<01:44,  4.18s/it]
test ppl:  90%|████████▉ | 212/236 [13:50<01:47,  4.49s/it]
test ppl:  90%|█████████ | 213/236 [13:56<01:52,  4.90s/it]
test ppl:  91%|█████████ | 214/236 [13:57<01:24,  3.83s/it]
test ppl:  91%|█████████ | 215/236 [14:03<01:33,  4.45s/it]
test ppl:  92%|█████████▏| 216/236 [14:05<01:12,  3.61s/it]
test ppl:  92%|█████████▏| 217/236 [14:11<01:20,  4.22s/it]
test ppl:  92%|█████████▏| 218/236 [14:12<01:03,  3.52s/it]
test ppl:  93%|█████████▎| 219/236 [14:18<01:12,  4.24s/it]
test ppl:  93%|█████████▎| 220/236 [14:24<01:15,  4.73s/it]
test ppl:  94%|█████████▎| 221/236 [14:26<00:57,  3.83s/it]
test ppl:  94%|█████████▍| 222/236 [14:32<01:02,  4.44s/it]
test ppl:  94%|█████████▍| 223/236 [14:38<01:03,  4.87s/it]
test ppl:  95%|█████████▍| 224/236 [14:40<00:50,  4.17s/it]
test ppl:  95%|█████████▌| 225/236 [14:44<00:45,  4.18s/it]
test ppl:  96%|█████████▌| 226/236 [14:47<00:37,  3.73s/it]
test ppl:  96%|█████████▌| 227/236 [14:50<00:30,  3.43s/it]
test ppl:  97%|█████████▋| 228/236 [14:52<00:23,  2.91s/it]
test ppl:  97%|█████████▋| 229/236 [14:53<00:17,  2.52s/it]
test ppl:  97%|█████████▋| 230/236 [14:57<00:18,  3.03s/it]
test ppl:  98%|█████████▊| 231/236 [15:01<00:15,  3.15s/it]
test ppl:  98%|█████████▊| 232/236 [15:03<00:11,  2.76s/it]
test ppl:  99%|█████████▊| 233/236 [15:06<00:08,  2.79s/it]
test ppl:  99%|█████████▉| 234/236 [15:07<00:04,  2.32s/it]
test ppl: 100%|█████████▉| 235/236 [15:13<00:03,  3.38s/it]
test ppl: 100%|██████████| 236/236 [15:13<00:00,  2.56s/it]
test ppl: 100%|██████████| 236/236 [15:13<00:00,  3.87s/it]
10/13/2024 02:08:44 - INFO - __main__ -    em: 0.2035
10/13/2024 02:08:44 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/32_0.6_80_eval_results.json
32 0.6 80:  em: 0.2035

--------------------------------------------------------------------------------
Running experiment with knn_temp=80, lmbda=0.6, k=64
2024-10-13 02:08:51.030568: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-10-13 02:08:51.050145: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-10-13 02:08:51.072003: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-10-13 02:08:51.078656: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-13 02:08:51.094645: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-10-13 02:08:52.088463: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
10/13/2024 02:08:53 - INFO - __main__ -   Namespace(dstore_size=507357, dstore_dir='knn_cache', dimension=768, knn_keytype=None, knn_sim_func=None, move_dstore_to_mem=False, knn_gpu=True, recompute_dists=False, k=64, lmbda=0.6, knn_temp=80, probe=128, pattern_store=True, use_pattern=True, store_knn=False, build_index=False, no_load_keys=False, retomaton=True, cluster_dstore=False, no_pointer=False, min_knns=10, max_knns=99999, num_clusters=1000000, sample_size=40000000, members=None, task='repair', sub_task='none', lang='', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=30, patience=5, cache_path='None', summary_dir='tensorboard', data_dir='None', res_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5', res_fn='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/repair_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=False, do_eval_bleu=False, flowgnn_data=True, flowgnn_model=True, model_path='/home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin', model_name_or_path='Salesforce/codet5-base', output_dir='/home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='Salesforce/codet5-base', max_source_length=512, max_target_length=256, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=16, eval_batch_size=8, gradient_accumulation_steps=1, learning_rate=0.0002, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=500, local_rank=-1, seed=4)
10/13/2024 02:08:53 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 64
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(

Adding feature api:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature api:   0%|          | 1/187062 [00:00<23:39:12,  2.20it/s]
Adding feature api:   4%|▍         | 7496/187062 [00:00<00:10, 17904.23it/s]
Adding feature api:   9%|▊         | 16078/187062 [00:00<00:04, 35182.36it/s]
Adding feature api:  13%|█▎        | 24729/187062 [00:00<00:03, 48863.20it/s]
Adding feature api:  18%|█▊        | 33328/187062 [00:00<00:02, 59101.55it/s]
Adding feature api:  22%|██▏       | 41960/187062 [00:00<00:02, 66793.55it/s]
Adding feature api:  27%|██▋       | 50597/187062 [00:01<00:01, 72422.50it/s]
Adding feature api:  32%|███▏      | 59282/187062 [00:01<00:01, 76622.66it/s]
Adding feature api:  36%|███▋      | 67938/187062 [00:01<00:01, 79540.56it/s]
Adding feature api:  41%|████      | 76552/187062 [00:01<00:01, 81490.92it/s]
Adding feature api:  46%|████▌     | 85219/187062 [00:01<00:01, 83027.79it/s]
Adding feature api:  50%|█████     | 93912/187062 [00:01<00:01, 84187.05it/s]
Adding feature api:  55%|█████▍    | 102511/187062 [00:01<00:01, 84166.87it/s]
Adding feature api:  59%|█████▉    | 111208/187062 [00:01<00:00, 84999.87it/s]
Adding feature api:  64%|██████▍   | 119848/187062 [00:01<00:00, 85415.88it/s]
Adding feature api:  69%|██████▊   | 128489/187062 [00:01<00:00, 85711.10it/s]
Adding feature api:  73%|███████▎  | 137137/187062 [00:02<00:00, 85940.22it/s]
Adding feature api:  78%|███████▊  | 145820/187062 [00:02<00:00, 86205.35it/s]
Adding feature api:  83%|████████▎ | 154520/187062 [00:02<00:00, 86440.53it/s]
Adding feature api:  87%|████████▋ | 163208/187062 [00:02<00:00, 86569.42it/s]
Adding feature api:  92%|█████████▏| 171929/187062 [00:02<00:00, 86757.94it/s]
Adding feature api:  97%|█████████▋| 180613/187062 [00:02<00:00, 71879.19it/s]
Adding feature api: 100%|██████████| 187062/187062 [00:02<00:00, 65814.89it/s]

Adding feature datatype:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature datatype:   0%|          | 1/187062 [00:00<23:35:03,  2.20it/s]
Adding feature datatype:   4%|▍         | 7251/187062 [00:00<00:10, 17357.72it/s]
Adding feature datatype:   8%|▊         | 15501/187062 [00:00<00:05, 33957.48it/s]
Adding feature datatype:  13%|█▎        | 23820/187062 [00:00<00:03, 47095.47it/s]
Adding feature datatype:  17%|█▋        | 32172/187062 [00:00<00:02, 57148.97it/s]
Adding feature datatype:  22%|██▏       | 40533/187062 [00:00<00:02, 64631.60it/s]
Adding feature datatype:  26%|██▌       | 48880/187062 [00:01<00:01, 70050.55it/s]
Adding feature datatype:  31%|███       | 57264/187062 [00:01<00:01, 74066.16it/s]
Adding feature datatype:  35%|███▌      | 65590/187062 [00:01<00:01, 76767.03it/s]
Adding feature datatype:  40%|███▉      | 73946/187062 [00:01<00:01, 78772.50it/s]
Adding feature datatype:  44%|████▍     | 82246/187062 [00:01<00:01, 80026.35it/s]
Adding feature datatype:  48%|████▊     | 90522/187062 [00:01<00:01, 80838.25it/s]
Adding feature datatype:  53%|█████▎    | 98894/187062 [00:01<00:01, 81697.57it/s]
Adding feature datatype:  57%|█████▋    | 107258/187062 [00:01<00:00, 82276.45it/s]
Adding feature datatype:  62%|██████▏   | 115613/187062 [00:01<00:00, 82656.76it/s]
Adding feature datatype:  66%|██████▋   | 123955/187062 [00:01<00:00, 82883.99it/s]
Adding feature datatype:  71%|███████   | 132318/187062 [00:02<00:00, 83106.47it/s]
Adding feature datatype:  75%|███████▌  | 140703/187062 [00:02<00:00, 83328.29it/s]
Adding feature datatype:  80%|███████▉  | 149076/187062 [00:02<00:00, 83446.72it/s]
Adding feature datatype:  84%|████████▍ | 157436/187062 [00:02<00:00, 83443.19it/s]
Adding feature datatype:  89%|████████▊ | 165791/187062 [00:02<00:00, 83406.62it/s]
Adding feature datatype:  93%|█████████▎| 174140/187062 [00:02<00:00, 83429.54it/s]
Adding feature datatype:  98%|█████████▊| 182488/187062 [00:02<00:00, 61220.90it/s]
Adding feature datatype: 100%|██████████| 187062/187062 [00:02<00:00, 64138.22it/s]

Adding feature literal:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature literal:   0%|          | 1/187062 [00:00<23:18:45,  2.23it/s]
Adding feature literal:   4%|▍         | 7160/187062 [00:00<00:10, 17291.08it/s]
Adding feature literal:   8%|▊         | 15366/187062 [00:00<00:05, 33903.81it/s]
Adding feature literal:  13%|█▎        | 23649/187062 [00:00<00:03, 47022.70it/s]
Adding feature literal:  17%|█▋        | 31931/187062 [00:00<00:02, 56936.25it/s]
Adding feature literal:  21%|██▏       | 40203/187062 [00:00<00:02, 64243.42it/s]
Adding feature literal:  26%|██▌       | 48504/187062 [00:01<00:01, 69652.14it/s]
Adding feature literal:  30%|███       | 56793/187062 [00:01<00:01, 73512.83it/s]
Adding feature literal:  35%|███▍      | 65129/187062 [00:01<00:01, 76406.44it/s]
Adding feature literal:  39%|███▉      | 73250/187062 [00:01<00:01, 77747.21it/s]
Adding feature literal:  44%|████▎     | 81552/187062 [00:01<00:01, 79309.93it/s]
Adding feature literal:  48%|████▊     | 89872/187062 [00:01<00:01, 80466.34it/s]
Adding feature literal:  52%|█████▏    | 98088/187062 [00:01<00:01, 78299.54it/s]
Adding feature literal:  57%|█████▋    | 106049/187062 [00:01<00:01, 76908.97it/s]
Adding feature literal:  61%|██████    | 113834/187062 [00:01<00:00, 76094.32it/s]
Adding feature literal:  65%|██████▍   | 121509/187062 [00:01<00:00, 75434.27it/s]
Adding feature literal:  69%|██████▉   | 129097/187062 [00:02<00:00, 74768.52it/s]
Adding feature literal:  73%|███████▎  | 136605/187062 [00:02<00:00, 74423.14it/s]
Adding feature literal:  77%|███████▋  | 144918/187062 [00:02<00:00, 76967.55it/s]
Adding feature literal:  82%|████████▏ | 153222/187062 [00:02<00:00, 78754.80it/s]
Adding feature literal:  86%|████████▋ | 161544/187062 [00:02<00:00, 80074.57it/s]
Adding feature literal:  91%|█████████ | 169852/187062 [00:02<00:00, 80967.00it/s]
Adding feature literal:  95%|█████████▌| 177960/187062 [00:02<00:00, 79837.73it/s]
Adding feature literal:  99%|█████████▉| 185955/187062 [00:02<00:00, 52798.75it/s]
Adding feature literal: 100%|██████████| 187062/187062 [00:02<00:00, 62424.78it/s]

Adding feature operator:   0%|          | 0/187062 [00:00<?, ?it/s]
Adding feature operator:   0%|          | 1/187062 [00:00<23:14:10,  2.24it/s]
Adding feature operator:   4%|▍         | 7256/187062 [00:00<00:10, 17566.82it/s]
Adding feature operator:   8%|▊         | 15528/187062 [00:00<00:04, 34309.28it/s]
Adding feature operator:  13%|█▎        | 23883/187062 [00:00<00:03, 47530.71it/s]
Adding feature operator:  17%|█▋        | 32245/187062 [00:00<00:02, 57534.62it/s]
Adding feature operator:  22%|██▏       | 40613/187062 [00:00<00:02, 64951.56it/s]
Adding feature operator:  26%|██▌       | 48780/187062 [00:01<00:01, 69770.70it/s]
Adding feature operator:  31%|███       | 57177/187062 [00:01<00:01, 73910.55it/s]
Adding feature operator:  35%|███▌      | 65567/187062 [00:01<00:01, 76846.16it/s]
Adding feature operator:  40%|███▉      | 73986/187062 [00:01<00:01, 79016.65it/s]
Adding feature operator:  44%|████▍     | 82381/187062 [00:01<00:01, 80480.82it/s]
Adding feature operator:  49%|████▊     | 90806/187062 [00:01<00:01, 81601.62it/s]
Adding feature operator:  53%|█████▎    | 99186/187062 [00:01<00:01, 82256.90it/s]
Adding feature operator:  58%|█████▊    | 107575/187062 [00:01<00:00, 82741.67it/s]
Adding feature operator:  62%|██████▏   | 115989/187062 [00:01<00:00, 83159.48it/s]
Adding feature operator:  67%|██████▋   | 124433/187062 [00:01<00:00, 83542.06it/s]
Adding feature operator:  71%|███████   | 132867/187062 [00:02<00:00, 83778.79it/s]
Adding feature operator:  76%|███████▌  | 141298/187062 [00:02<00:00, 83936.54it/s]
Adding feature operator:  80%|████████  | 149743/187062 [00:02<00:00, 84087.63it/s]
Adding feature operator:  85%|████████▍ | 158167/187062 [00:02<00:00, 83341.06it/s]
Adding feature operator:  89%|████████▉ | 166563/187062 [00:02<00:00, 83524.18it/s]
Adding feature operator:  94%|█████████▎| 174924/187062 [00:02<00:00, 83462.49it/s]
Adding feature operator:  98%|█████████▊| 183276/187062 [00:02<00:00, 59398.29it/s]
Adding feature operator: 100%|██████████| 187062/187062 [00:02<00:00, 64507.54it/s]
[2024-10-13 02:09:36,901] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/pytorch_lightning/utilities/cli.py:95: LightningDeprecationWarning: `LightningCLI`'s registries were deprecated in v1.7 and will be removed in v1.9. Now any imported subclass is automatically available by name in `LightningCLI` without any need to explicitly register it.
  rank_zero_deprecation(_deprecate_registry_message)
10/13/2024 02:09:38 - INFO - __main__ -   ACTIVATING FLOWGNN MODEL
/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
10/13/2024 02:09:38 - INFO - __main__ -   FlowGNN output dim: 512
Columns in the CSV file: Index(['graph_id'], dtype='object')
9333
filtered_test_data: 1882

Map:   0%|          | 0/6548 [00:00<?, ? examples/s]
Map:   1%|          | 39/6548 [00:00<00:18, 349.11 examples/s]
Map:   1%|▏         | 90/6548 [00:00<00:29, 216.84 examples/s]
Map:   2%|▏         | 127/6548 [00:00<00:24, 259.54 examples/s]
Map:   3%|▎         | 177/6548 [00:00<00:20, 314.87 examples/s]
Map:   3%|▎         | 225/6548 [00:00<00:17, 360.47 examples/s]
Map:   4%|▍         | 286/6548 [00:00<00:17, 362.75 examples/s]
Map:   5%|▍         | 325/6548 [00:01<00:20, 306.81 examples/s]
Map:   6%|▌         | 373/6548 [00:01<00:20, 308.58 examples/s]
Map:   6%|▋         | 424/6548 [00:01<00:17, 352.22 examples/s]
Map:   7%|▋         | 472/6548 [00:01<00:18, 321.79 examples/s]
Map:   8%|▊         | 532/6548 [00:01<00:17, 343.61 examples/s]
Map:   9%|▉         | 575/6548 [00:01<00:16, 360.40 examples/s]
Map:   9%|▉         | 622/6548 [00:01<00:17, 338.46 examples/s]
Map:  10%|█         | 658/6548 [00:02<00:17, 337.75 examples/s]
Map:  11%|█         | 705/6548 [00:02<00:15, 368.84 examples/s]
Map:  12%|█▏        | 765/6548 [00:02<00:15, 374.70 examples/s]
Map:  12%|█▏        | 816/6548 [00:02<00:14, 406.75 examples/s]
Map:  13%|█▎        | 868/6548 [00:02<00:14, 382.63 examples/s]
Map:  14%|█▍        | 908/6548 [00:02<00:15, 375.85 examples/s]
Map:  14%|█▍        | 947/6548 [00:02<00:14, 375.08 examples/s]
Map:  15%|█▌        | 993/6548 [00:02<00:16, 333.00 examples/s]
Map:  16%|█▌        | 1038/6548 [00:03<00:24, 226.97 examples/s]
Map:  16%|█▋        | 1077/6548 [00:03<00:21, 254.04 examples/s]
Map:  17%|█▋        | 1122/6548 [00:03<00:18, 293.22 examples/s]
Map:  18%|█▊        | 1162/6548 [00:03<00:17, 315.37 examples/s]
Map:  18%|█▊        | 1205/6548 [00:03<00:15, 339.82 examples/s]
Map:  19%|█▉        | 1259/6548 [00:03<00:15, 343.07 examples/s]
Map:  20%|█▉        | 1296/6548 [00:03<00:15, 341.11 examples/s]
Map:  20%|██        | 1342/6548 [00:04<00:16, 320.63 examples/s]
Map:  21%|██        | 1388/6548 [00:04<00:16, 305.74 examples/s]
Map:  22%|██▏       | 1427/6548 [00:04<00:16, 318.45 examples/s]
Map:  22%|██▏       | 1461/6548 [00:04<00:18, 279.77 examples/s]
Map:  23%|██▎       | 1491/6548 [00:04<00:17, 281.33 examples/s]
Map:  23%|██▎       | 1526/6548 [00:04<00:17, 295.10 examples/s]
Map:  24%|██▍       | 1574/6548 [00:04<00:17, 286.96 examples/s]
Map:  25%|██▍       | 1610/6548 [00:05<00:18, 263.11 examples/s]
Map:  25%|██▌       | 1644/6548 [00:05<00:18, 268.72 examples/s]
Map:  26%|██▌       | 1688/6548 [00:05<00:19, 246.15 examples/s]
Map:  26%|██▋       | 1727/6548 [00:05<00:17, 275.66 examples/s]
Map:  27%|██▋       | 1771/6548 [00:05<00:15, 312.70 examples/s]
Map:  28%|██▊       | 1811/6548 [00:05<00:14, 317.80 examples/s]
Map:  28%|██▊       | 1852/6548 [00:05<00:14, 320.48 examples/s]
Map:  29%|██▉       | 1906/6548 [00:06<00:14, 325.71 examples/s]
Map:  30%|██▉       | 1961/6548 [00:06<00:13, 335.23 examples/s]
Map:  31%|███       | 2000/6548 [00:06<00:20, 226.54 examples/s]
Map:  31%|███       | 2030/6548 [00:06<00:18, 238.38 examples/s]
Map:  32%|███▏      | 2065/6548 [00:06<00:17, 259.95 examples/s]
Map:  32%|███▏      | 2104/6548 [00:06<00:16, 271.60 examples/s]
Map:  33%|███▎      | 2141/6548 [00:07<00:17, 255.31 examples/s]
Map:  33%|███▎      | 2173/6548 [00:07<00:16, 268.81 examples/s]
Map:  34%|███▍      | 2213/6548 [00:07<00:15, 279.40 examples/s]
Map:  34%|███▍      | 2252/6548 [00:07<00:16, 263.85 examples/s]
Map:  35%|███▍      | 2282/6548 [00:07<00:16, 258.40 examples/s]
Map:  35%|███▌      | 2319/6548 [00:07<00:14, 283.43 examples/s]
Map:  36%|███▌      | 2355/6548 [00:07<00:14, 282.50 examples/s]
Map:  37%|███▋      | 2391/6548 [00:07<00:13, 300.60 examples/s]
Map:  37%|███▋      | 2434/6548 [00:07<00:12, 332.97 examples/s]
Map:  38%|███▊      | 2478/6548 [00:08<00:13, 307.35 examples/s]
Map:  38%|███▊      | 2517/6548 [00:08<00:12, 325.64 examples/s]
Map:  39%|███▉      | 2562/6548 [00:08<00:11, 351.08 examples/s]
Map:  40%|███▉      | 2607/6548 [00:08<00:10, 375.29 examples/s]
Map:  41%|████      | 2652/6548 [00:08<00:09, 393.49 examples/s]
Map:  41%|████▏     | 2711/6548 [00:08<00:11, 346.51 examples/s]
Map:  42%|████▏     | 2770/6548 [00:08<00:10, 358.31 examples/s]
Map:  43%|████▎     | 2811/6548 [00:09<00:11, 322.30 examples/s]
Map:  43%|████▎     | 2846/6548 [00:09<00:12, 286.89 examples/s]
Map:  44%|████▍     | 2880/6548 [00:09<00:12, 295.82 examples/s]
Map:  45%|████▍     | 2926/6548 [00:09<00:12, 287.91 examples/s]
Map:  45%|████▌     | 2963/6548 [00:09<00:11, 301.83 examples/s]
Map:  46%|████▌     | 3000/6548 [00:10<00:21, 164.30 examples/s]
Map:  46%|████▌     | 3026/6548 [00:10<00:19, 178.45 examples/s]
Map:  47%|████▋     | 3062/6548 [00:10<00:16, 208.84 examples/s]
Map:  47%|████▋     | 3098/6548 [00:10<00:14, 237.77 examples/s]
Map:  48%|████▊     | 3138/6548 [00:10<00:12, 267.88 examples/s]
Map:  48%|████▊     | 3172/6548 [00:10<00:12, 270.26 examples/s]
Map:  49%|████▉     | 3203/6548 [00:10<00:12, 262.30 examples/s]
Map:  50%|████▉     | 3245/6548 [00:10<00:12, 260.55 examples/s]
Map:  50%|█████     | 3280/6548 [00:11<00:11, 277.55 examples/s]
Map:  51%|█████     | 3322/6548 [00:11<00:10, 307.61 examples/s]
Map:  51%|█████▏    | 3368/6548 [00:11<00:10, 304.45 examples/s]
Map:  52%|█████▏    | 3404/6548 [00:11<00:11, 281.32 examples/s]
Map:  53%|█████▎    | 3445/6548 [00:11<00:10, 304.89 examples/s]
Map:  53%|█████▎    | 3479/6548 [00:11<00:11, 269.11 examples/s]
Map:  54%|█████▍    | 3524/6548 [00:11<00:09, 310.56 examples/s]
Map:  54%|█████▍    | 3566/6548 [00:11<00:08, 333.11 examples/s]
Map:  55%|█████▌    | 3614/6548 [00:12<00:07, 367.95 examples/s]
Map:  56%|█████▌    | 3662/6548 [00:12<00:08, 340.17 examples/s]
Map:  57%|█████▋    | 3706/6548 [00:12<00:07, 363.99 examples/s]
Map:  57%|█████▋    | 3763/6548 [00:12<00:07, 365.97 examples/s]
Map:  58%|█████▊    | 3807/6548 [00:12<00:07, 377.27 examples/s]
Map:  59%|█████▉    | 3864/6548 [00:12<00:08, 315.04 examples/s]
Map:  60%|█████▉    | 3912/6548 [00:12<00:07, 348.35 examples/s]
Map:  60%|██████    | 3956/6548 [00:13<00:07, 324.74 examples/s]
Map:  61%|██████    | 4000/6548 [00:13<00:10, 239.98 examples/s]
Map:  62%|██████▏   | 4054/6548 [00:13<00:08, 293.37 examples/s]
Map:  63%|██████▎   | 4096/6548 [00:13<00:07, 317.65 examples/s]
Map:  63%|██████▎   | 4135/6548 [00:13<00:07, 328.11 examples/s]
Map:  64%|██████▍   | 4187/6548 [00:13<00:07, 314.35 examples/s]
Map:  65%|██████▍   | 4236/6548 [00:14<00:06, 330.64 examples/s]
Map:  65%|██████▌   | 4282/6548 [00:14<00:06, 355.84 examples/s]
Map:  66%|██████▌   | 4325/6548 [00:14<00:06, 367.75 examples/s]
Map:  67%|██████▋   | 4383/6548 [00:14<00:06, 354.91 examples/s]
Map:  68%|██████▊   | 4426/6548 [00:14<00:05, 367.02 examples/s]
Map:  68%|██████▊   | 4469/6548 [00:14<00:06, 333.59 examples/s]
Map:  69%|██████▉   | 4516/6548 [00:14<00:06, 320.51 examples/s]
Map:  70%|██████▉   | 4571/6548 [00:14<00:06, 324.14 examples/s]
Map:  70%|███████   | 4606/6548 [00:15<00:06, 320.08 examples/s]
Map:  71%|███████   | 4645/6548 [00:15<00:05, 330.14 examples/s]
Map:  71%|███████▏  | 4681/6548 [00:15<00:05, 330.74 examples/s]
Map:  72%|███████▏  | 4730/6548 [00:15<00:05, 354.86 examples/s]
Map:  73%|███████▎  | 4776/6548 [00:15<00:04, 379.15 examples/s]
Map:  74%|███████▎  | 4826/6548 [00:15<00:04, 391.50 examples/s]
Map:  74%|███████▍  | 4875/6548 [00:15<00:04, 356.10 examples/s]
Map:  75%|███████▌  | 4913/6548 [00:15<00:04, 361.50 examples/s]
Map:  76%|███████▌  | 4970/6548 [00:16<00:03, 412.11 examples/s]
Map:  77%|███████▋  | 5013/6548 [00:16<00:06, 236.94 examples/s]
Map:  77%|███████▋  | 5057/6548 [00:16<00:05, 264.73 examples/s]
Map:  78%|███████▊  | 5107/6548 [00:16<00:05, 277.64 examples/s]
Map:  79%|███████▊  | 5156/6548 [00:16<00:04, 285.99 examples/s]
Map:  80%|███████▉  | 5207/6548 [00:17<00:04, 295.56 examples/s]
Map:  80%|████████  | 5247/6548 [00:17<00:04, 313.46 examples/s]
Map:  81%|████████  | 5304/6548 [00:17<00:03, 328.29 examples/s]
Map:  82%|████████▏ | 5346/6548 [00:17<00:04, 293.21 examples/s]
Map:  82%|████████▏ | 5388/6548 [00:17<00:03, 317.42 examples/s]
Map:  83%|████████▎ | 5429/6548 [00:17<00:03, 298.84 examples/s]
Map:  83%|████████▎ | 5466/6548 [00:17<00:03, 309.69 examples/s]
Map:  84%|████████▍ | 5504/6548 [00:17<00:03, 319.84 examples/s]
Map:  85%|████████▍ | 5548/6548 [00:18<00:02, 345.63 examples/s]
Map:  85%|████████▌ | 5594/6548 [00:18<00:02, 323.82 examples/s]
Map:  86%|████████▌ | 5642/6548 [00:18<00:02, 358.90 examples/s]
Map:  87%|████████▋ | 5684/6548 [00:18<00:02, 324.70 examples/s]
Map:  87%|████████▋ | 5723/6548 [00:18<00:02, 335.77 examples/s]
Map:  88%|████████▊ | 5768/6548 [00:18<00:02, 362.50 examples/s]
Map:  89%|████████▉ | 5825/6548 [00:18<00:02, 360.04 examples/s]
Map:  90%|████████▉ | 5866/6548 [00:18<00:01, 367.41 examples/s]
Map:  90%|█████████ | 5909/6548 [00:19<00:01, 380.44 examples/s]
Map:  91%|█████████ | 5964/6548 [00:19<00:01, 350.58 examples/s]
Map:  92%|█████████▏| 6027/6548 [00:19<00:02, 241.20 examples/s]
Map:  93%|█████████▎| 6073/6548 [00:19<00:01, 254.80 examples/s]
Map:  93%|█████████▎| 6121/6548 [00:19<00:01, 267.14 examples/s]
Map:  94%|█████████▍| 6172/6548 [00:20<00:01, 283.43 examples/s]
Map:  95%|█████████▍| 6212/6548 [00:20<00:01, 305.19 examples/s]
Map:  95%|█████████▌| 6252/6548 [00:20<00:00, 323.33 examples/s]
Map:  96%|█████████▋| 6308/6548 [00:20<00:00, 336.12 examples/s]
Map:  97%|█████████▋| 6346/6548 [00:20<00:00, 342.64 examples/s]
Map:  98%|█████████▊| 6385/6548 [00:20<00:00, 344.85 examples/s]
Map:  98%|█████████▊| 6421/6548 [00:20<00:00, 343.96 examples/s]
Map:  99%|█████████▉| 6471/6548 [00:20<00:00, 376.96 examples/s]
Map:  99%|█████████▉| 6515/6548 [00:20<00:00, 375.55 examples/s]
Map: 100%|██████████| 6548/6548 [00:21<00:00, 308.86 examples/s]

Map:   0%|          | 0/903 [00:00<?, ? examples/s]
Map:   4%|▍         | 36/903 [00:00<00:02, 323.61 examples/s]
Map:   8%|▊         | 73/903 [00:00<00:02, 347.99 examples/s]
Map:  13%|█▎        | 121/903 [00:00<00:02, 327.68 examples/s]
Map:  18%|█▊        | 167/903 [00:00<00:02, 365.82 examples/s]
Map:  23%|██▎       | 211/903 [00:00<00:01, 386.09 examples/s]
Map:  28%|██▊       | 252/903 [00:00<00:01, 392.06 examples/s]
Map:  34%|███▍      | 311/903 [00:00<00:01, 383.81 examples/s]
Map:  40%|███▉      | 357/903 [00:01<00:01, 337.88 examples/s]
Map:  46%|████▌     | 412/903 [00:01<00:01, 320.12 examples/s]
Map:  50%|█████     | 455/903 [00:01<00:01, 305.20 examples/s]
Map:  54%|█████▍    | 487/903 [00:01<00:01, 303.15 examples/s]
Map:  59%|█████▉    | 536/903 [00:01<00:01, 342.04 examples/s]
Map:  66%|██████▌   | 594/903 [00:01<00:00, 355.51 examples/s]
Map:  70%|███████   | 633/903 [00:01<00:00, 362.25 examples/s]
Map:  74%|███████▍  | 672/903 [00:01<00:00, 365.05 examples/s]
Map:  79%|███████▉  | 716/903 [00:02<00:00, 373.56 examples/s]
Map:  85%|████████▍ | 766/903 [00:02<00:00, 395.85 examples/s]
Map:  91%|█████████▏| 826/903 [00:02<00:00, 383.51 examples/s]
Map:  96%|█████████▋| 871/903 [00:02<00:00, 397.56 examples/s]
Map: 100%|██████████| 903/903 [00:02<00:00, 328.24 examples/s]

Map:   0%|          | 0/1882 [00:00<?, ? examples/s]
Map:   2%|▏         | 38/1882 [00:00<00:06, 303.76 examples/s]
Map:   4%|▍         | 82/1882 [00:00<00:04, 375.41 examples/s]
Map:   7%|▋         | 135/1882 [00:00<00:05, 349.36 examples/s]
Map:  10%|▉         | 180/1882 [00:00<00:04, 380.76 examples/s]
Map:  13%|█▎        | 236/1882 [00:00<00:04, 376.70 examples/s]
Map:  15%|█▌        | 290/1882 [00:00<00:04, 357.55 examples/s]
Map:  18%|█▊        | 333/1882 [00:00<00:04, 372.85 examples/s]
Map:  20%|█▉        | 375/1882 [00:01<00:04, 323.64 examples/s]
Map:  22%|██▏       | 414/1882 [00:01<00:04, 297.30 examples/s]
Map:  24%|██▍       | 448/1882 [00:01<00:04, 302.97 examples/s]
Map:  26%|██▌       | 493/1882 [00:01<00:04, 338.12 examples/s]
Map:  29%|██▉       | 543/1882 [00:01<00:04, 325.00 examples/s]
Map:  31%|███       | 586/1882 [00:01<00:03, 349.77 examples/s]
Map:  34%|███▍      | 638/1882 [00:01<00:03, 385.60 examples/s]
Map:  37%|███▋      | 691/1882 [00:01<00:03, 368.10 examples/s]
Map:  39%|███▉      | 732/1882 [00:02<00:03, 370.21 examples/s]
Map:  41%|████      | 773/1882 [00:02<00:03, 357.33 examples/s]
Map:  44%|████▍     | 826/1882 [00:02<00:03, 348.32 examples/s]
Map:  46%|████▌     | 867/1882 [00:02<00:02, 356.39 examples/s]
Map:  48%|████▊     | 908/1882 [00:02<00:02, 362.16 examples/s]
Map:  51%|█████     | 957/1882 [00:02<00:02, 394.96 examples/s]
Map:  53%|█████▎    | 1000/1882 [00:03<00:03, 245.62 examples/s]
Map:  55%|█████▌    | 1038/1882 [00:03<00:03, 270.03 examples/s]
Map:  57%|█████▋    | 1073/1882 [00:03<00:02, 281.29 examples/s]
Map:  60%|█████▉    | 1123/1882 [00:03<00:02, 291.08 examples/s]
Map:  61%|██████▏   | 1156/1882 [00:03<00:02, 296.87 examples/s]
Map:  63%|██████▎   | 1190/1882 [00:03<00:02, 272.54 examples/s]
Map:  65%|██████▌   | 1229/1882 [00:03<00:02, 299.21 examples/s]
Map:  68%|██████▊   | 1282/1882 [00:03<00:01, 315.14 examples/s]
Map:  71%|███████   | 1335/1882 [00:04<00:01, 355.50 examples/s]
Map:  74%|███████▎  | 1386/1882 [00:04<00:01, 332.21 examples/s]
Map:  76%|███████▌  | 1430/1882 [00:04<00:01, 299.79 examples/s]
Map:  78%|███████▊  | 1471/1882 [00:04<00:01, 320.78 examples/s]
Map:  80%|████████  | 1507/1882 [00:04<00:01, 282.31 examples/s]
Map:  82%|████████▏ | 1543/1882 [00:04<00:01, 292.17 examples/s]
Map:  84%|████████▍ | 1581/1882 [00:04<00:00, 306.57 examples/s]
Map:  86%|████████▌ | 1622/1882 [00:04<00:00, 328.88 examples/s]
Map:  88%|████████▊ | 1660/1882 [00:05<00:00, 332.11 examples/s]
Map:  91%|█████████ | 1710/1882 [00:05<00:00, 324.64 examples/s]
Map:  93%|█████████▎| 1748/1882 [00:05<00:00, 277.95 examples/s]
Map:  95%|█████████▍| 1787/1882 [00:05<00:00, 268.14 examples/s]
Map:  98%|█████████▊| 1835/1882 [00:05<00:00, 312.53 examples/s]
Map: 100%|█████████▉| 1878/1882 [00:05<00:00, 336.90 examples/s]
Map: 100%|██████████| 1882/1882 [00:06<00:00, 312.03 examples/s]
10/13/2024 02:10:40 - INFO - __main__ -     ***** Testing *****
10/13/2024 02:10:40 - INFO - __main__ -     Batch size = 8
10/13/2024 02:10:40 - INFO - __main__ -   Reload model from /home/l1/qingao/DeepDFA/CodeT5/home/hdd/qingao/RMGArepair/saved_model/step5_nodes200_dec_enc_dec_gnnf_wd1e-4/pytorch_model.bin
/home/l1/qingao/DeepDFA/CodeT5/run_gen.py:545: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path,map_location=torch.device('cuda:0')))
10/13/2024 02:10:40 - INFO - retomaton -   Found the following cluster members files: ['knn_cache/members_t5_507357_768_5000000_200.pkl']
10/13/2024 02:10:40 - INFO - retomaton -   Using members file knn_cache/members_t5_507357_768_5000000_200.pkl
10/13/2024 02:10:41 - INFO - knnlm -   Reading datastore took 0.9080164432525635 s
10/13/2024 02:10:42 - INFO - knnlm -   Moving index to GPU took 0.9826335906982422 s
10/13/2024 02:10:42 - INFO - __main__ -   ******************************break-into
10/13/2024 02:10:42 - INFO - __main__ -     ***** Running acc evaluation *****
10/13/2024 02:10:42 - INFO - __main__ -     Num examples = 236
10/13/2024 02:10:42 - INFO - __main__ -     Batch size = 8
***************************using retomaton
******************************break-into
using pattern store to enchance patch generation

test ppl:   0%|          | 0/236 [00:00<?, ?it/s]/root/miniconda3/envs/deepdfa2/lib/python3.10/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)

test ppl:   0%|          | 1/236 [00:07<30:17,  7.73s/it]
test ppl:   1%|          | 2/236 [00:09<17:29,  4.49s/it]
test ppl:   1%|▏         | 3/236 [00:11<12:13,  3.15s/it]
test ppl:   2%|▏         | 4/236 [00:17<16:40,  4.31s/it]
test ppl:   2%|▏         | 5/236 [00:23<18:51,  4.90s/it]
test ppl:   3%|▎         | 6/236 [00:29<20:09,  5.26s/it]
test ppl:   3%|▎         | 7/236 [00:31<15:55,  4.17s/it]
test ppl:   3%|▎         | 8/236 [00:36<17:08,  4.51s/it]
test ppl:   4%|▍         | 9/236 [00:42<18:42,  4.95s/it]
test ppl:   4%|▍         | 10/236 [00:48<19:48,  5.26s/it]
test ppl:   5%|▍         | 11/236 [00:50<16:03,  4.28s/it]
test ppl:   5%|▌         | 12/236 [00:56<17:47,  4.76s/it]
test ppl:   6%|▌         | 13/236 [01:02<18:53,  5.08s/it]
test ppl:   6%|▌         | 14/236 [01:08<19:39,  5.31s/it]
test ppl:   6%|▋         | 15/236 [01:09<15:06,  4.10s/it]
test ppl:   7%|▋         | 16/236 [01:11<12:34,  3.43s/it]
test ppl:   7%|▋         | 17/236 [01:15<13:11,  3.62s/it]
test ppl:   8%|▊         | 18/236 [01:18<12:29,  3.44s/it]
test ppl:   8%|▊         | 19/236 [01:24<15:00,  4.15s/it]
test ppl:   8%|▊         | 20/236 [01:25<12:21,  3.43s/it]
test ppl:   9%|▉         | 21/236 [01:28<11:33,  3.23s/it]
test ppl:   9%|▉         | 22/236 [01:34<14:16,  4.00s/it]
test ppl:  10%|▉         | 23/236 [01:36<12:34,  3.54s/it]
test ppl:  10%|█         | 24/236 [01:39<11:35,  3.28s/it]
test ppl:  11%|█         | 25/236 [01:45<14:11,  4.04s/it]
test ppl:  11%|█         | 26/236 [01:51<15:59,  4.57s/it]
test ppl:  11%|█▏        | 27/236 [01:54<14:41,  4.22s/it]
test ppl:  12%|█▏        | 28/236 [01:55<11:29,  3.32s/it]
test ppl:  12%|█▏        | 29/236 [01:57<10:04,  2.92s/it]
test ppl:  13%|█▎        | 30/236 [01:59<08:35,  2.50s/it]
test ppl:  13%|█▎        | 31/236 [02:01<08:00,  2.34s/it]
test ppl:  14%|█▎        | 32/236 [02:03<08:14,  2.43s/it]
test ppl:  14%|█▍        | 33/236 [02:09<11:39,  3.45s/it]
test ppl:  14%|█▍        | 34/236 [02:13<12:06,  3.60s/it]
test ppl:  15%|█▍        | 35/236 [02:19<14:15,  4.26s/it]
test ppl:  15%|█▌        | 36/236 [02:25<15:44,  4.72s/it]
test ppl:  16%|█▌        | 37/236 [02:31<16:45,  5.05s/it]
test ppl:  16%|█▌        | 38/236 [02:33<13:41,  4.15s/it]
test ppl:  17%|█▋        | 39/236 [02:34<10:57,  3.34s/it]
test ppl:  17%|█▋        | 40/236 [02:35<08:56,  2.74s/it]
test ppl:  17%|█▋        | 41/236 [02:37<08:01,  2.47s/it]
test ppl:  18%|█▊        | 42/236 [02:43<11:15,  3.48s/it]
test ppl:  18%|█▊        | 43/236 [02:49<13:25,  4.18s/it]
test ppl:  19%|█▊        | 44/236 [02:51<11:17,  3.53s/it]
test ppl:  19%|█▉        | 45/236 [02:53<09:43,  3.05s/it]
test ppl:  19%|█▉        | 46/236 [02:59<12:19,  3.89s/it]
test ppl:  20%|█▉        | 47/236 [03:00<10:00,  3.18s/it]
test ppl:  20%|██        | 48/236 [03:06<12:23,  3.95s/it]
test ppl:  21%|██        | 49/236 [03:12<14:02,  4.51s/it]
test ppl:  21%|██        | 50/236 [03:18<15:13,  4.91s/it]
test ppl:  22%|██▏       | 51/236 [03:24<16:00,  5.19s/it]
test ppl:  22%|██▏       | 52/236 [03:29<16:28,  5.37s/it]
test ppl:  22%|██▏       | 53/236 [03:33<15:11,  4.98s/it]
test ppl:  23%|██▎       | 54/236 [03:35<11:57,  3.94s/it]
test ppl:  23%|██▎       | 55/236 [03:40<13:21,  4.43s/it]
test ppl:  24%|██▎       | 56/236 [03:44<12:18,  4.11s/it]
test ppl:  24%|██▍       | 57/236 [03:46<10:36,  3.55s/it]
test ppl:  25%|██▍       | 58/236 [03:48<09:23,  3.17s/it]
test ppl:  25%|██▌       | 59/236 [03:54<11:40,  3.96s/it]
test ppl:  25%|██▌       | 60/236 [03:57<10:57,  3.73s/it]
test ppl:  26%|██▌       | 61/236 [04:03<12:41,  4.35s/it]
test ppl:  26%|██▋       | 62/236 [04:09<13:51,  4.78s/it]
test ppl:  27%|██▋       | 63/236 [04:11<11:44,  4.07s/it]
test ppl:  27%|██▋       | 64/236 [04:13<09:29,  3.31s/it]
test ppl:  28%|██▊       | 65/236 [04:14<07:43,  2.71s/it]
test ppl:  28%|██▊       | 66/236 [04:17<07:53,  2.78s/it]
test ppl:  28%|██▊       | 67/236 [04:23<10:23,  3.69s/it]
test ppl:  29%|██▉       | 68/236 [04:29<12:06,  4.32s/it]
test ppl:  29%|██▉       | 69/236 [04:35<13:15,  4.76s/it]
test ppl:  30%|██▉       | 70/236 [04:40<14:00,  5.06s/it]
test ppl:  30%|███       | 71/236 [04:44<12:34,  4.57s/it]
test ppl:  31%|███       | 72/236 [04:47<11:48,  4.32s/it]
test ppl:  31%|███       | 73/236 [04:53<12:54,  4.75s/it]
test ppl:  31%|███▏      | 74/236 [04:55<10:11,  3.78s/it]
test ppl:  32%|███▏      | 75/236 [05:01<11:44,  4.38s/it]
test ppl:  32%|███▏      | 76/236 [05:06<12:28,  4.68s/it]
test ppl:  33%|███▎      | 77/236 [05:10<11:41,  4.41s/it]
test ppl:  33%|███▎      | 78/236 [05:12<09:55,  3.77s/it]
test ppl:  33%|███▎      | 79/236 [05:16<09:56,  3.80s/it]
test ppl:  34%|███▍      | 80/236 [05:17<08:08,  3.13s/it]
test ppl:  34%|███▍      | 81/236 [05:23<10:07,  3.92s/it]
test ppl:  35%|███▍      | 82/236 [05:29<11:31,  4.49s/it]
test ppl:  35%|███▌      | 83/236 [05:35<12:28,  4.89s/it]
test ppl:  36%|███▌      | 84/236 [05:36<09:56,  3.92s/it]
test ppl:  36%|███▌      | 85/236 [05:41<10:02,  3.99s/it]
test ppl:  36%|███▋      | 86/236 [05:43<08:36,  3.44s/it]
test ppl:  37%|███▋      | 87/236 [05:45<07:31,  3.03s/it]
test ppl:  37%|███▋      | 88/236 [05:51<09:30,  3.86s/it]
test ppl:  38%|███▊      | 89/236 [05:56<10:52,  4.44s/it]
test ppl:  38%|███▊      | 90/236 [06:02<11:46,  4.84s/it]
test ppl:  39%|███▊      | 91/236 [06:07<11:41,  4.84s/it]
test ppl:  39%|███▉      | 92/236 [06:10<10:07,  4.22s/it]
test ppl:  39%|███▉      | 93/236 [06:16<11:09,  4.68s/it]
test ppl:  40%|███▉      | 94/236 [06:21<11:47,  4.98s/it]
test ppl:  40%|████      | 95/236 [06:24<10:01,  4.27s/it]
test ppl:  41%|████      | 96/236 [06:27<08:59,  3.85s/it]
test ppl:  41%|████      | 97/236 [06:33<10:16,  4.43s/it]
test ppl:  42%|████▏     | 98/236 [06:38<11:09,  4.85s/it]
test ppl:  42%|████▏     | 99/236 [06:44<11:43,  5.14s/it]
test ppl:  42%|████▏     | 100/236 [06:45<09:02,  3.99s/it]
test ppl:  43%|████▎     | 101/236 [06:51<10:11,  4.53s/it]
test ppl:  43%|████▎     | 102/236 [06:55<09:45,  4.37s/it]
test ppl:  44%|████▎     | 103/236 [06:57<07:42,  3.48s/it]
test ppl:  44%|████▍     | 104/236 [07:01<08:07,  3.69s/it]
test ppl:  44%|████▍     | 105/236 [07:05<08:11,  3.75s/it]
test ppl:  45%|████▍     | 106/236 [07:10<09:09,  4.23s/it]
test ppl:  45%|████▌     | 107/236 [07:16<10:08,  4.71s/it]
test ppl:  46%|████▌     | 108/236 [07:20<09:57,  4.67s/it]
test ppl:  46%|████▌     | 109/236 [07:26<10:37,  5.02s/it]
test ppl:  47%|████▋     | 110/236 [07:28<08:22,  3.99s/it]
test ppl:  47%|████▋     | 111/236 [07:32<08:15,  3.96s/it]
test ppl:  47%|████▋     | 112/236 [07:38<09:19,  4.51s/it]
test ppl:  48%|████▊     | 113/236 [07:39<07:32,  3.68s/it]
test ppl:  48%|████▊     | 114/236 [07:43<07:28,  3.68s/it]
test ppl:  49%|████▊     | 115/236 [07:49<08:41,  4.31s/it]
test ppl:  49%|████▉     | 116/236 [07:55<09:30,  4.75s/it]
test ppl:  50%|████▉     | 117/236 [07:56<07:41,  3.88s/it]
test ppl:  50%|█████     | 118/236 [08:02<08:45,  4.45s/it]
test ppl:  50%|█████     | 119/236 [08:05<07:52,  4.04s/it]
test ppl:  51%|█████     | 120/236 [08:07<06:13,  3.22s/it]
test ppl:  51%|█████▏    | 121/236 [08:12<07:38,  3.98s/it]
test ppl:  52%|█████▏    | 122/236 [08:18<08:35,  4.52s/it]
test ppl:  52%|█████▏    | 123/236 [08:24<09:14,  4.90s/it]
test ppl:  53%|█████▎    | 124/236 [08:26<07:36,  4.07s/it]
test ppl:  53%|█████▎    | 125/236 [08:32<08:29,  4.59s/it]
test ppl:  53%|█████▎    | 126/236 [08:35<07:53,  4.30s/it]
test ppl:  54%|█████▍    | 127/236 [08:41<08:38,  4.75s/it]
test ppl:  54%|█████▍    | 128/236 [08:43<07:00,  3.89s/it]
test ppl:  55%|█████▍    | 129/236 [08:46<06:21,  3.57s/it]
test ppl:  55%|█████▌    | 130/236 [08:49<05:51,  3.31s/it]
test ppl:  56%|█████▌    | 131/236 [08:55<07:06,  4.06s/it]
test ppl:  56%|█████▌    | 132/236 [09:00<07:55,  4.57s/it]
test ppl:  56%|█████▋    | 133/236 [09:04<07:28,  4.36s/it]
test ppl:  57%|█████▋    | 134/236 [09:08<07:06,  4.18s/it]
test ppl:  57%|█████▋    | 135/236 [09:14<07:51,  4.66s/it]
test ppl:  58%|█████▊    | 136/236 [09:15<06:06,  3.66s/it]
test ppl:  58%|█████▊    | 137/236 [09:21<07:07,  4.31s/it]
test ppl:  58%|█████▊    | 138/236 [09:24<06:41,  4.10s/it]
test ppl:  59%|█████▉    | 139/236 [09:26<05:29,  3.40s/it]
test ppl:  59%|█████▉    | 140/236 [09:28<04:36,  2.88s/it]
test ppl:  60%|█████▉    | 141/236 [09:32<04:59,  3.15s/it]
test ppl:  60%|██████    | 142/236 [09:34<04:26,  2.84s/it]
test ppl:  61%|██████    | 143/236 [09:40<05:46,  3.73s/it]
test ppl:  61%|██████    | 144/236 [09:42<05:13,  3.41s/it]
test ppl:  61%|██████▏   | 145/236 [09:47<05:34,  3.68s/it]
test ppl:  62%|██████▏   | 146/236 [09:52<06:18,  4.20s/it]
test ppl:  62%|██████▏   | 147/236 [09:58<06:57,  4.69s/it]
test ppl:  63%|██████▎   | 148/236 [10:04<07:25,  5.06s/it]
test ppl:  63%|██████▎   | 149/236 [10:10<07:39,  5.29s/it]
test ppl:  64%|██████▎   | 150/236 [10:15<07:47,  5.44s/it]
test ppl:  64%|██████▍   | 151/236 [10:21<07:51,  5.55s/it]
test ppl:  64%|██████▍   | 152/236 [10:27<07:52,  5.62s/it]
test ppl:  65%|██████▍   | 153/236 [10:31<07:16,  5.25s/it]
test ppl:  65%|██████▌   | 154/236 [10:33<05:37,  4.11s/it]
test ppl:  66%|██████▌   | 155/236 [10:35<04:56,  3.66s/it]
test ppl:  66%|██████▌   | 156/236 [10:38<04:21,  3.27s/it]
test ppl:  67%|██████▋   | 157/236 [10:39<03:34,  2.72s/it]
test ppl:  67%|██████▋   | 158/236 [10:45<04:44,  3.65s/it]
test ppl:  67%|██████▋   | 159/236 [10:51<05:30,  4.29s/it]
test ppl:  68%|██████▊   | 160/236 [10:53<04:33,  3.59s/it]
test ppl:  68%|██████▊   | 161/236 [10:54<03:39,  2.92s/it]
test ppl:  69%|██████▊   | 162/236 [10:56<03:17,  2.67s/it]
test ppl:  69%|██████▉   | 163/236 [10:58<02:50,  2.34s/it]
test ppl:  69%|██████▉   | 164/236 [11:02<03:31,  2.94s/it]
test ppl:  70%|██████▉   | 165/236 [11:06<03:50,  3.25s/it]
test ppl:  70%|███████   | 166/236 [11:08<03:10,  2.72s/it]
test ppl:  71%|███████   | 167/236 [11:09<02:41,  2.34s/it]
test ppl:  71%|███████   | 168/236 [11:13<03:17,  2.91s/it]
test ppl:  72%|███████▏  | 169/236 [11:18<03:42,  3.32s/it]
test ppl:  72%|███████▏  | 170/236 [11:23<04:28,  4.07s/it]
test ppl:  72%|███████▏  | 171/236 [11:25<03:31,  3.25s/it]
test ppl:  73%|███████▎  | 172/236 [11:30<04:16,  4.01s/it]
test ppl:  73%|███████▎  | 173/236 [11:33<03:44,  3.57s/it]
test ppl:  74%|███████▎  | 174/236 [11:39<04:23,  4.24s/it]
test ppl:  74%|███████▍  | 175/236 [11:41<03:34,  3.52s/it]
test ppl:  75%|███████▍  | 176/236 [11:46<04:11,  4.19s/it]
test ppl:  75%|███████▌  | 177/236 [11:52<04:36,  4.69s/it]
test ppl:  75%|███████▌  | 178/236 [11:58<04:52,  5.03s/it]
test ppl:  76%|███████▌  | 179/236 [12:04<05:00,  5.27s/it]
test ppl:  76%|███████▋  | 180/236 [12:09<04:47,  5.14s/it]
test ppl:  77%|███████▋  | 181/236 [12:14<04:40,  5.10s/it]
test ppl:  77%|███████▋  | 182/236 [12:16<03:43,  4.13s/it]
test ppl:  78%|███████▊  | 183/236 [12:17<02:58,  3.36s/it]
test ppl:  78%|███████▊  | 184/236 [12:19<02:24,  2.77s/it]
test ppl:  78%|███████▊  | 185/236 [12:24<03:08,  3.70s/it]
test ppl:  79%|███████▉  | 186/236 [12:26<02:37,  3.15s/it]
test ppl:  79%|███████▉  | 187/236 [12:32<03:14,  3.97s/it]
test ppl:  80%|███████▉  | 188/236 [12:38<03:37,  4.53s/it]
test ppl:  80%|████████  | 189/236 [12:44<03:51,  4.92s/it]
test ppl:  81%|████████  | 190/236 [12:49<03:47,  4.95s/it]
test ppl:  81%|████████  | 191/236 [12:53<03:26,  4.59s/it]
test ppl:  81%|████████▏ | 192/236 [12:55<02:55,  3.99s/it]
test ppl:  82%|████████▏ | 193/236 [13:01<03:15,  4.54s/it]
test ppl:  82%|████████▏ | 194/236 [13:04<02:45,  3.95s/it]
test ppl:  83%|████████▎ | 195/236 [13:06<02:21,  3.45s/it]
test ppl:  83%|████████▎ | 196/236 [13:08<02:00,  3.02s/it]
test ppl:  83%|████████▎ | 197/236 [13:10<01:46,  2.74s/it]
test ppl:  84%|████████▍ | 198/236 [13:16<02:18,  3.66s/it]
test ppl:  84%|████████▍ | 199/236 [13:18<02:04,  3.37s/it]
test ppl:  85%|████████▍ | 200/236 [13:24<02:27,  4.09s/it]
test ppl:  85%|████████▌ | 201/236 [13:27<02:06,  3.63s/it]
test ppl:  86%|████████▌ | 202/236 [13:33<02:24,  4.26s/it]
test ppl:  86%|████████▌ | 203/236 [13:38<02:36,  4.74s/it]
test ppl:  86%|████████▋ | 204/236 [13:40<02:02,  3.83s/it]
test ppl:  87%|████████▋ | 205/236 [13:46<02:17,  4.44s/it]
test ppl:  87%|████████▋ | 206/236 [13:49<02:02,  4.07s/it]
test ppl:  88%|████████▊ | 207/236 [13:55<02:13,  4.59s/it]
test ppl:  88%|████████▊ | 208/236 [13:58<01:52,  4.03s/it]
test ppl:  89%|████████▊ | 209/236 [14:04<02:03,  4.59s/it]
test ppl:  89%|████████▉ | 210/236 [14:06<01:41,  3.90s/it]
test ppl:  89%|████████▉ | 211/236 [14:11<01:43,  4.14s/it]
test ppl:  90%|████████▉ | 212/236 [14:15<01:43,  4.29s/it]
test ppl:  90%|█████████ | 213/236 [14:21<01:49,  4.74s/it]
test ppl:  91%|█████████ | 214/236 [14:22<01:21,  3.72s/it]
test ppl:  91%|█████████ | 215/236 [14:28<01:31,  4.35s/it]
test ppl:  92%|█████████▏| 216/236 [14:30<01:10,  3.54s/it]
test ppl:  92%|█████████▏| 217/236 [14:36<01:20,  4.24s/it]
test ppl:  92%|█████████▏| 218/236 [14:42<01:24,  4.71s/it]
test ppl:  93%|█████████▎| 219/236 [14:47<01:25,  5.05s/it]
test ppl:  93%|█████████▎| 220/236 [14:53<01:24,  5.28s/it]
test ppl:  94%|█████████▎| 221/236 [14:55<01:03,  4.24s/it]
test ppl:  94%|█████████▍| 222/236 [15:01<01:05,  4.71s/it]
test ppl:  94%|█████████▍| 223/236 [15:07<01:05,  5.04s/it]
test ppl:  95%|█████████▍| 224/236 [15:09<00:49,  4.16s/it]
test ppl:  95%|█████████▌| 225/236 [15:15<00:51,  4.65s/it]
test ppl:  96%|█████████▌| 226/236 [15:17<00:40,  4.04s/it]
test ppl:  96%|█████████▌| 227/236 [15:21<00:35,  3.92s/it]
test ppl:  97%|█████████▋| 228/236 [15:23<00:26,  3.31s/it]
test ppl:  97%|█████████▋| 229/236 [15:28<00:28,  4.06s/it]
test ppl:  97%|█████████▋| 230/236 [15:32<00:23,  3.86s/it]
test ppl:  98%|█████████▊| 231/236 [15:35<00:18,  3.70s/it]
test ppl:  98%|█████████▊| 232/236 [15:37<00:12,  3.13s/it]
test ppl:  99%|█████████▊| 233/236 [15:40<00:09,  3.04s/it]
test ppl:  99%|█████████▉| 234/236 [15:41<00:04,  2.46s/it]
test ppl: 100%|█████████▉| 235/236 [15:47<00:03,  3.46s/it]
test ppl: 100%|██████████| 236/236 [15:47<00:00,  2.62s/it]
test ppl: 100%|██████████| 236/236 [15:47<00:00,  4.02s/it]
10/13/2024 02:26:30 - INFO - __main__ -    em: 0.2040
10/13/2024 02:26:30 - INFO - __main__ -   Finish and take 17m
successfully save result to /home/hdd/qingao/DeepDFA/CodeT5/saved_models/repair/codeT5/remota/64_0.6_80_eval_results.json
64 0.6 80:  em: 0.2040

--------------------------------------------------------------------------------
